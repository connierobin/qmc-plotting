Rank =    0  Free Memory = 88697 MB
Rank =    1  Free Memory = 88697 MB
Rank =    2  Free Memory = 88697 MB
Rank =    3  Free Memory = 88697 MB
Rank =    4  Free Memory = 88697 MB
Rank =    5  Free Memory = 88696 MB
Rank =    6  Free Memory = 88696 MB
Rank =    7  Free Memory = 88696 MB
Rank =    8  Free Memory = 88696 MB
Rank =    9  Free Memory = 88696 MB
Rank =   10  Free Memory = 88696 MB
Rank =   11  Free Memory = 88696 MB
Rank =   12  Free Memory = 88696 MB
Rank =   13  Free Memory = 88696 MB
Rank =   14  Free Memory = 88695 MB
Rank =   15  Free Memory = 88680 MB
Rank =   16  Free Memory = 88680 MB
Rank =   17  Free Memory = 88680 MB
Rank =   18  Free Memory = 88680 MB
Rank =   19  Free Memory = 88680 MB
Rank =   20  Free Memory = 88680 MB
Rank =   21  Free Memory = 88680 MB
Rank =   22  Free Memory = 88680 MB
Rank =   23  Free Memory = 88680 MB
Rank =   24  Free Memory = 88680 MB
Rank =   25  Free Memory = 88680 MB
Rank =   26  Free Memory = 88680 MB
Rank =   27  Free Memory = 88680 MB
Rank =   28  Free Memory = 88680 MB
Rank =   29  Free Memory = 88680 MB
Rank =   30  Free Memory = 88680 MB
Rank =   31  Free Memory = 88680 MB
Rank =   32  Free Memory = 90034 MB
Rank =   33  Free Memory = 90034 MB
Rank =   34  Free Memory = 90034 MB
Rank =   35  Free Memory = 90034 MB
Rank =   36  Free Memory = 90034 MB
Rank =   37  Free Memory = 90034 MB
Rank =   38  Free Memory = 90034 MB
Rank =   39  Free Memory = 90034 MB
Rank =   40  Free Memory = 90034 MB
Rank =   41  Free Memory = 90034 MB
Rank =   42  Free Memory = 90034 MB
Rank =   43  Free Memory = 90034 MB
Rank =   44  Free Memory = 90034 MB
Rank =   45  Free Memory = 90034 MB
Rank =   46  Free Memory = 90034 MB
Rank =   47  Free Memory = 90034 MB
Rank =   48  Free Memory = 90034 MB
Rank =   49  Free Memory = 90034 MB
Rank =   50  Free Memory = 90034 MB
Rank =   51  Free Memory = 90034 MB
Rank =   52  Free Memory = 90034 MB
Rank =   53  Free Memory = 90034 MB
Rank =   54  Free Memory = 90034 MB
Rank =   55  Free Memory = 90034 MB
Rank =   56  Free Memory = 90034 MB
Rank =   57  Free Memory = 90034 MB
Rank =   58  Free Memory = 90034 MB
Rank =   59  Free Memory = 90034 MB
Rank =   60  Free Memory = 90034 MB
Rank =   61  Free Memory = 90034 MB
Rank =   62  Free Memory = 90034 MB
Rank =   63  Free Memory = 90034 MB
Rank =   64  Free Memory = 83779 MB
Rank =   65  Free Memory = 83779 MB
Rank =   66  Free Memory = 83779 MB
Rank =   67  Free Memory = 83779 MB
Rank =   68  Free Memory = 83779 MB
Rank =   69  Free Memory = 83779 MB
Rank =   70  Free Memory = 83779 MB
Rank =   71  Free Memory = 83779 MB
Rank =   72  Free Memory = 83779 MB
Rank =   73  Free Memory = 83779 MB
Rank =   74  Free Memory = 83779 MB
Rank =   75  Free Memory = 83779 MB
Rank =   76  Free Memory = 83779 MB
Rank =   77  Free Memory = 83779 MB
Rank =   78  Free Memory = 83779 MB
Rank =   79  Free Memory = 83779 MB
Rank =   80  Free Memory = 83779 MB
Rank =   81  Free Memory = 83779 MB
Rank =   82  Free Memory = 83779 MB
Rank =   83  Free Memory = 83779 MB
Rank =   84  Free Memory = 83779 MB
Rank =   85  Free Memory = 83779 MB
Rank =   86  Free Memory = 83779 MB
Rank =   87  Free Memory = 83779 MB
Rank =   88  Free Memory = 83779 MB
Rank =   89  Free Memory = 83779 MB
Rank =   90  Free Memory = 83779 MB
Rank =   91  Free Memory = 83779 MB
Rank =   92  Free Memory = 83779 MB
Rank =   93  Free Memory = 83779 MB
Rank =   94  Free Memory = 83779 MB
Rank =   95  Free Memory = 83779 MB
Rank =   96  Free Memory = 88935 MB
Rank =   97  Free Memory = 88935 MB
Rank =   98  Free Memory = 88935 MB
Rank =   99  Free Memory = 88935 MB
Rank =  100  Free Memory = 88935 MB
Rank =  101  Free Memory = 88935 MB
Rank =  102  Free Memory = 88935 MB
Rank =  103  Free Memory = 88935 MB
Rank =  104  Free Memory = 88935 MB
Rank =  105  Free Memory = 88935 MB
Rank =  106  Free Memory = 88935 MB
Rank =  107  Free Memory = 88935 MB
Rank =  108  Free Memory = 88935 MB
Rank =  109  Free Memory = 88935 MB
Rank =  110  Free Memory = 88935 MB
Rank =  111  Free Memory = 88935 MB
Rank =  112  Free Memory = 88935 MB
Rank =  113  Free Memory = 88935 MB
Rank =  114  Free Memory = 88935 MB
Rank =  115  Free Memory = 88935 MB
Rank =  116  Free Memory = 88935 MB
Rank =  117  Free Memory = 88935 MB
Rank =  118  Free Memory = 88935 MB
Rank =  119  Free Memory = 88935 MB
Rank =  120  Free Memory = 88935 MB
Rank =  121  Free Memory = 88935 MB
Rank =  122  Free Memory = 88935 MB
Rank =  123  Free Memory = 88935 MB
Rank =  124  Free Memory = 88935 MB
Rank =  125  Free Memory = 88935 MB
Rank =  126  Free Memory = 88935 MB
Rank =  127  Free Memory = 88935 MB
  Input file(s): opt_form_gs_tett_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run001f.xml

  Project = FORM
  date    = 2023-03-18 20:37:52 PDT
  host    = n0029.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 912

  Range of prime numbers to use as seeds over processors and threads = 7129-8297


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.624554e-01    1         1  ON     0
     uu_1                 1.011863e-01    1         1  ON     1
     uu_2                 3.659226e-03    1         1  ON     2
     uu_3                -5.375161e-02    1         1  ON     3
     uu_4                -8.591702e-02    1         1  ON     4
     uu_5                -1.029990e-01    1         1  ON     5
     uu_6                -1.108447e-01    1         1  ON     6
     uu_7                -1.087609e-01    1         1  ON     7
     uu_8                -9.325173e-02    1         1  ON     8
     uu_9                -5.957390e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.378549e-01    1         1  ON     0
     ud_1                 9.967815e-02    1         1  ON     1
     ud_2                -1.443990e-02    1         1  ON     2
     ud_3                -7.376538e-02    1         1  ON     3
     ud_4                -1.061181e-01    1         1  ON     4
     ud_5                -1.224040e-01    1         1  ON     5
     ud_6                -1.277130e-01    1         1  ON     6
     ud_7                -1.191873e-01    1         1  ON     7
     ud_8                -9.272569e-02    1         1  ON     8
     ud_9                -4.447679e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.563379e-01    1         1  ON     0
     eC_1                -3.182912e-01    1         1  ON     1
     eC_2                -6.732177e-02    1         1  ON     2
     eC_3                 9.506706e-02    1         1  ON     3
     eC_4                 1.375986e-01    1         1  ON     4
     eC_5                 1.931335e-01    1         1  ON     5
     eC_6                 2.098757e-01    1         1  ON     6
     eC_7                 1.661996e-01    1         1  ON     7
     eC_8                 3.840237e-02    1         1  ON     8
     eC_9                 1.377137e-03    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.227972e-01    1         1  ON     0
     eO_1                -5.297360e-01    1         1  ON     1
     eO_2                -1.492259e-01    1         1  ON     2
     eO_3                 1.025706e-01    1         1  ON     3
     eO_4                 2.270539e-01    1         1  ON     4
     eO_5                 3.212686e-01    1         1  ON     5
     eO_6                 3.347758e-01    1         1  ON     6
     eO_7                 3.060194e-01    1         1  ON     7
     eO_8                 1.433530e-01    1         1  ON     8
     eO_9                 3.830540e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.277008e-01    1         1  ON     0
     eH1_1                -3.779999e-02    1         1  ON     1
     eH1_2                -1.874707e-02    1         1  ON     2
     eH1_3                -3.712827e-02    1         1  ON     3
     eH1_4                -1.241675e-02    1         1  ON     4
     eH1_5                 8.974315e-03    1         1  ON     5
     eH1_6                 5.391205e-02    1         1  ON     6
     eH1_7                 6.334551e-02    1         1  ON     7
     eH1_8                 6.498479e-02    1         1  ON     8
     eH1_9                 4.352531e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.183001e-01    1         1  ON     0
     eH2_1                -2.576170e-02    1         1  ON     1
     eH2_2                -1.319036e-02    1         1  ON     2
     eH2_3                -3.560919e-02    1         1  ON     3
     eH2_4                -1.653925e-02    1         1  ON     4
     eH2_5                 7.920534e-03    1         1  ON     5
     eH2_6                 4.215155e-02    1         1  ON     6
     eH2_7                 4.045401e-02    1         1  ON     7
     eH2_8                 5.493390e-02    1         1  ON     8
     eH2_9                 5.404523e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.767113e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 5.1411e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7905
    reference variance = 0.416746
====================================================
  Execution time = 4.6668e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4094e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4784e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440984060626
                                         uncertainty =       0.002699995490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440984060626
                                         uncertainty =       0.002699995490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469544091
  error estimate for blocks of size 2^( 2) =       0.000494279444
  error estimate for blocks of size 2^( 3) =       0.000517671417
  error estimate for blocks of size 2^( 4) =       0.000534303723
  error estimate for blocks of size 2^( 5) =       0.000545949800
  error estimate for blocks of size 2^( 6) =       0.000553129062
  error estimate for blocks of size 2^( 7) =       0.000557169214

      target function =      -0.752941720185
              le_mean =     -22.815652072995
             les_mean =     520.994922601498
             stat err =       0.000547637950
             autocorr =       1.360298796673
   target nu stat err =       0.000547637950
   target dn stat err =       0.002426278566
      target stat err =       0.002180155456
              std dev =       0.664035621028
             le_variance =       0.440943305994


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281565207300e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752947019338       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752987883594       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.753021379868       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.753029870203       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.753034874687       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.753041158620       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.753046900842       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.753050954493       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.753054023513       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.753057127388       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.753059692411       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.753062769229       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.753064340865       residual = 9.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.753067854146       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.753070738414       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.753072915557       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.753074345518       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.753076729816       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.753077612698       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.753078899546       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.753079783572       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.753080592077       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.753081034077       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.753081078991       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.753081351757       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.753081536102       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.753081647782       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.753081613454       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.753081646627       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.753081639049       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.753081682366       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.753081680626       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.753081676901       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 3.756334e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752947019338       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752959035597       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752968771870       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752971276696       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752972752910       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752974531357       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752976119077       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752977235510       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752978099447       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752979028326       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.752979732965       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.752980506885       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.752981009424       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.752982017501       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.752982862055       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.752983333417       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.752983680008       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.752984288660       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752984488345       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.752984776850       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.752984976938       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.752985173423       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.752985276355       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.752985270902       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.752985321089       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.752985343572       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.752985369571       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.752985362519       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752985367130       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.752985362397       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.752985374411       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.752985374120       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.008050e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752947019338       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752950161831       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752952698431       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752953354861       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752953741732       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752954201531       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752954608047       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752954895949       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752955121356       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752955362254       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.752955543014       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.752955736115       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.752955872156       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.752956131416       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.752956354021       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.752956463523       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.752956549263       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.752956701413       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752956749509       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.752956819206       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.752956867854       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.752956916467       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.752956941368       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.752956938941       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.752956950459       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.752956954671       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.752956961023       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.752956959409       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752956960333       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.752956959001       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.752956962028       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.752956961946       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 2.571491e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1642e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.624088e-01                 1 1 ON  0
uu_1  1.011916e-01                 1 1 ON  1
uu_2  3.638540e-03                 1 1 ON  2
uu_3  -5.379836e-02                1 1 ON  3
uu_4  -8.595836e-02                1 1 ON  4
uu_5  -1.030703e-01                1 1 ON  5
uu_6  -1.109190e-01                1 1 ON  6
uu_7  -1.087491e-01                1 1 ON  7
uu_8  -9.305068e-02                1 1 ON  8
uu_9  -5.938454e-02                1 1 ON  9
ud_0  3.382787e-01                 1 1 ON  10
ud_1  9.991508e-02                 1 1 ON  11
ud_2  -1.438519e-02                1 1 ON  12
ud_3  -7.375836e-02                1 1 ON  13
ud_4  -1.061208e-01                1 1 ON  14
ud_5  -1.224391e-01                1 1 ON  15
ud_6  -1.277761e-01                1 1 ON  16
ud_7  -1.192756e-01                1 1 ON  17
ud_8  -9.284458e-02                1 1 ON  18
ud_9  -4.474916e-02                1 1 ON  19
eC_0  -4.566147e-01                1 1 ON  20
eC_1  -3.184399e-01                1 1 ON  21
eC_2  -6.754434e-02                1 1 ON  22
eC_3  9.475144e-02                 1 1 ON  23
eC_4  1.374698e-01                 1 1 ON  24
eC_5  1.931745e-01                 1 1 ON  25
eC_6  2.101277e-01                 1 1 ON  26
eC_7  1.667223e-01                 1 1 ON  27
eC_8  3.869765e-02                 1 1 ON  28
eC_9  1.366685e-03                 1 1 ON  29
eO_0  -8.238053e-01                1 1 ON  30
eO_1  -5.303316e-01                1 1 ON  31
eO_2  -1.494840e-01                1 1 ON  32
eO_3  1.025840e-01                 1 1 ON  33
eO_4  2.272774e-01                 1 1 ON  34
eO_5  3.215171e-01                 1 1 ON  35
eO_6  3.349932e-01                 1 1 ON  36
eO_7  3.062382e-01                 1 1 ON  37
eO_8  1.441960e-01                 1 1 ON  38
eO_9  3.842723e-02                 1 1 ON  39
eH1_0 -1.277476e-01                1 1 ON  40
eH1_1 -3.772785e-02                1 1 ON  41
eH1_2 -1.875419e-02                1 1 ON  42
eH1_3 -3.716658e-02                1 1 ON  43
eH1_4 -1.243863e-02                1 1 ON  44
eH1_5 9.217752e-03                 1 1 ON  45
eH1_6 5.376212e-02                 1 1 ON  46
eH1_7 6.303024e-02                 1 1 ON  47
eH1_8 6.495073e-02                 1 1 ON  48
eH1_9 4.374385e-02                 1 1 ON  49
eH2_0 -1.185902e-01                1 1 ON  50
eH2_1 -2.616249e-02                1 1 ON  51
eH2_2 -1.332397e-02                1 1 ON  52
eH2_3 -3.564510e-02                1 1 ON  53
eH2_4 -1.639468e-02                1 1 ON  54
eH2_5 8.062513e-03                 1 1 ON  55
eH2_6 4.221725e-02                 1 1 ON  56
eH2_7 4.062733e-02                 1 1 ON  57
eH2_8 5.485085e-02                 1 1 ON  58
eH2_9 5.431676e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7818
    reference variance = 0.256708
====================================================
  Execution time = 4.3333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5739e-01
  Total weights = 2.0000e+06
  Execution time = 3.6180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457357081172
                                         uncertainty =       0.005219882942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457357081172
                                         uncertainty =       0.005219882942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478211875
  error estimate for blocks of size 2^( 2) =       0.000503084900
  error estimate for blocks of size 2^( 3) =       0.000526556574
  error estimate for blocks of size 2^( 4) =       0.000543586979
  error estimate for blocks of size 2^( 5) =       0.000553765359
  error estimate for blocks of size 2^( 6) =       0.000561316174
  error estimate for blocks of size 2^( 7) =       0.000567054180

      target function =      -0.739066125139
              le_mean =     -22.814749276473
             les_mean =     520.970157515259
             stat err =       0.000556430673
             autocorr =       1.353883859880
   target nu stat err =       0.000556430673
   target dn stat err =       0.005342821481
      target stat err =       0.004468505346
              std dev =       0.676293719935
             le_variance =       0.457373195624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457419662012
                                         uncertainty =       0.005235206479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457419662012
                                         uncertainty =       0.005235206479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478244385
  error estimate for blocks of size 2^( 2) =       0.000502967984
  error estimate for blocks of size 2^( 3) =       0.000526303351
  error estimate for blocks of size 2^( 4) =       0.000543240509
  error estimate for blocks of size 2^( 5) =       0.000553352868
  error estimate for blocks of size 2^( 6) =       0.000560877761
  error estimate for blocks of size 2^( 7) =       0.000566591087

      target function =      -0.739014434863
              le_mean =     -22.814750497141
             les_mean =     520.970275400874
             stat err =       0.000556015556
             autocorr =       1.351680742883
   target nu stat err =       0.000556015556
   target dn stat err =       0.005358955997
      target stat err =       0.004481060953
              std dev =       0.676339694829
             le_variance =       0.457435382802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457385476819
                                         uncertainty =       0.005228574410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457385476819
                                         uncertainty =       0.005228574410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478226608
  error estimate for blocks of size 2^( 2) =       0.000503014638
  error estimate for blocks of size 2^( 3) =       0.000526409401
  error estimate for blocks of size 2^( 4) =       0.000543387698
  error estimate for blocks of size 2^( 5) =       0.000553529565
  error estimate for blocks of size 2^( 6) =       0.000561066566
  error estimate for blocks of size 2^( 7) =       0.000566790904

      target function =      -0.739042712490
              le_mean =     -22.814748739318
             les_mean =     520.970161185864
             stat err =       0.000556193683
             autocorr =       1.352647495973
   target nu stat err =       0.000556193683
   target dn stat err =       0.005351995419
      target stat err =       0.004475707849
              std dev =       0.676314554304
             le_variance =       0.457401376364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457359812212
                                         uncertainty =       0.005221006798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457359812212
                                         uncertainty =       0.005221006798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478213289
  error estimate for blocks of size 2^( 2) =       0.000503075263
  error estimate for blocks of size 2^( 3) =       0.000526536967
  error estimate for blocks of size 2^( 4) =       0.000543560634
  error estimate for blocks of size 2^( 5) =       0.000553734309
  error estimate for blocks of size 2^( 6) =       0.000561283364
  error estimate for blocks of size 2^( 7) =       0.000567019612

      target function =      -0.739063881274
              le_mean =     -22.814749033147
             les_mean =     520.970149115972
             stat err =       0.000556399480
             autocorr =       1.353724067091
   target nu stat err =       0.000556399480
   target dn stat err =       0.005344008534
      target stat err =       0.004469445488
              std dev =       0.676295718750
             le_variance =       0.457375899199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739066125139        initial  <--
     2.5000e-01     2.5000e+00             3.7563e-03        -0.739014434863
     1.0000e+00     1.0000e+01             1.0080e-03        -0.739042712490
     4.0000e+00     4.0000e+01             2.5715e-04        -0.739063881274

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3326
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2298e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2786e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8417
    reference variance = 0.378513
====================================================
  Execution time = 4.4348e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5025e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794007973
                                         uncertainty =       0.003437497543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794007973
                                         uncertainty =       0.003437497543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472720931
  error estimate for blocks of size 2^( 2) =       0.000497309788
  error estimate for blocks of size 2^( 3) =       0.000520150501
  error estimate for blocks of size 2^( 4) =       0.000538026196
  error estimate for blocks of size 2^( 5) =       0.000549384605
  error estimate for blocks of size 2^( 6) =       0.000553524083
  error estimate for blocks of size 2^( 7) =       0.000559157832

      target function =      -0.747826216492
              le_mean =     -22.815242623352
             les_mean =     520.982225896064
             stat err =       0.000550023179
             autocorr =       1.353793171807
   target nu stat err =       0.000550023179
   target dn stat err =       0.003227242022
      target stat err =       0.002808658305
              std dev =       0.668528351759
             le_variance =       0.446930157105


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281524262335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747835782758       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747839369277       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747843183803       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747844193184       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747845376439       residual = 5.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747846029212       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747847686615       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747847972066       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747848473443       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747849160561       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747849372240       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747849730997       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747850288945       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747850815623       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747851223400       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747851394427       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747851540919       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747851727952       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747851958590       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747852196372       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747852315076       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747852349613       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747852426384       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747852459305       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747852513402       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747852512646       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747852544337       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747852558972       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747852554998       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747852552101       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747852538475       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747852540010       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 5.507736e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747835782758       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747836695881       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747837664572       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747837922701       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747838221299       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747838387239       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747838806172       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747838879828       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747839006600       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747839180953       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747839233796       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747839324926       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747839465171       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747839597854       residual = 5.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747839700857       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747839740334       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747839779382       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747839826332       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747839884112       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747839943617       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747839972926       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747839982663       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747840000203       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747840017161       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747840022724       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747840021524       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747840029523       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747840033012       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747840032072       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747840031215       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747840027966       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747840028368       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.387090e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747835782758       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747836012093       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747836255226       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747836320127       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747836394955       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747836436620       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747836541640       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747836560200       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747836591987       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747836635736       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747836648941       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747836671817       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747836706928       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747836740155       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747836765972       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747836775664       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747836785568       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747836797305       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747836811754       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747836826633       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747836833933       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747836836432       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747836840650       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747836845653       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747836845793       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747836846581       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747836848111       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747836848895       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747836848675       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747836848441       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747836847646       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747836847748       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 3.474178e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9419e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.624776e-01 1 1  ON 0
 uu_1                 1.012001e-01 1 1  ON 1
 uu_2                 3.662367e-03 1 1  ON 2
 uu_3                -5.375816e-02 1 1  ON 3
 uu_4                -8.592965e-02 1 1  ON 4
 uu_5                -1.030205e-01 1 1  ON 5
 uu_6                -1.108681e-01 1 1  ON 6
 uu_7                -1.087657e-01 1 1  ON 7
 uu_8                -9.324488e-02 1 1  ON 8
 uu_9                -5.955517e-02 1 1  ON 9
 ud_0                 3.378940e-01 1 1  ON 10
 ud_1                 9.970044e-02 1 1  ON 11
 ud_2                -1.443362e-02 1 1  ON 12
 ud_3                -7.376691e-02 1 1  ON 13
 ud_4                -1.061250e-01 1 1  ON 14
 ud_5                -1.224142e-01 1 1  ON 15
 ud_6                -1.277213e-01 1 1  ON 16
 ud_7                -1.191956e-01 1 1  ON 17
 ud_8                -9.273807e-02 1 1  ON 18
 ud_9                -4.450922e-02 1 1  ON 19
 eC_0                -4.563917e-01 1 1  ON 20
 eC_1                -3.183152e-01 1 1  ON 21
 eC_2                -6.734963e-02 1 1  ON 22
 eC_3                 9.504246e-02 1 1  ON 23
 eC_4                 1.376090e-01 1 1  ON 24
 eC_5                 1.931732e-01 1 1  ON 25
 eC_6                 2.098845e-01 1 1  ON 26
 eC_7                 1.662501e-01 1 1  ON 27
 eC_8                 3.842555e-02 1 1  ON 28
 eC_9                 1.374888e-03 1 1  ON 29
 eO_0                -8.229360e-01 1 1  ON 30
 eO_1                -5.298307e-01 1 1  ON 31
 eO_2                -1.492710e-01 1 1  ON 32
 eO_3                 1.025720e-01 1 1  ON 33
 eO_4                 2.271007e-01 1 1  ON 34
 eO_5                 3.213334e-01 1 1  ON 35
 eO_6                 3.348057e-01 1 1  ON 36
 eO_7                 3.060545e-01 1 1  ON 37
 eO_8                 1.434302e-01 1 1  ON 38
 eO_9                 3.832724e-02 1 1  ON 39
eH1_0                -1.276927e-01 1 1  ON 40
eH1_1                -3.778426e-02 1 1  ON 41
eH1_2                -1.873936e-02 1 1  ON 42
eH1_3                -3.712551e-02 1 1  ON 43
eH1_4                -1.241038e-02 1 1  ON 44
eH1_5                 9.008474e-03 1 1  ON 45
eH1_6                 5.388661e-02 1 1  ON 46
eH1_7                 6.329856e-02 1 1  ON 47
eH1_8                 6.496217e-02 1 1  ON 48
eH1_9                 4.353754e-02 1 1  ON 49
eH2_0                -1.183253e-01 1 1  ON 50
eH2_1                -2.579862e-02 1 1  ON 51
eH2_2                -1.321326e-02 1 1  ON 52
eH2_3                -3.563036e-02 1 1  ON 53
eH2_4                -1.652992e-02 1 1  ON 54
eH2_5                 7.932727e-03 1 1  ON 55
eH2_6                 4.216800e-02 1 1  ON 56
eH2_7                 4.048425e-02 1 1  ON 57
eH2_8                 5.494960e-02 1 1  ON 58
eH2_9                 5.406449e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.9746
    reference variance = 3.51864
====================================================
  Execution time = 4.5222e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4717e-01
  Total weights = 2.0000e+06
  Execution time = 3.6139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447028478437
                                         uncertainty =       0.002561765315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447028478437
                                         uncertainty =       0.002561765315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472844248
  error estimate for blocks of size 2^( 2) =       0.000498190337
  error estimate for blocks of size 2^( 3) =       0.000522323131
  error estimate for blocks of size 2^( 4) =       0.000540379503
  error estimate for blocks of size 2^( 5) =       0.000550940696
  error estimate for blocks of size 2^( 6) =       0.000558620904
  error estimate for blocks of size 2^( 7) =       0.000562688772

      target function =      -0.747637733553
              le_mean =     -22.814874088290
             les_mean =     520.965642806756
             stat err =       0.000553157469
             autocorr =       1.368552115567
   target nu stat err =       0.000553157469
   target dn stat err =       0.002637568934
      target stat err =       0.002321988212
              std dev =       0.668702748454
             le_variance =       0.447163365789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059137688
                                         uncertainty =       0.002562869543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447059137688
                                         uncertainty =       0.002562869543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472860528
  error estimate for blocks of size 2^( 2) =       0.000498188151
  error estimate for blocks of size 2^( 3) =       0.000522302920
  error estimate for blocks of size 2^( 4) =       0.000540346312
  error estimate for blocks of size 2^( 5) =       0.000550900313
  error estimate for blocks of size 2^( 6) =       0.000558577975
  error estimate for blocks of size 2^( 7) =       0.000562645889

      target function =      -0.747611627780
              le_mean =     -22.814874185624
             les_mean =     520.965678040656
             stat err =       0.000553117622
             autocorr =       1.368260735186
   target nu stat err =       0.000553117622
   target dn stat err =       0.002638417356
      target stat err =       0.002322512513
              std dev =       0.668725772195
             le_variance =       0.447194158398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447043926758
                                         uncertainty =       0.002562325295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447043926758
                                         uncertainty =       0.002562325295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472852452
  error estimate for blocks of size 2^( 2) =       0.000498189186
  error estimate for blocks of size 2^( 3) =       0.000522312857
  error estimate for blocks of size 2^( 4) =       0.000540362664
  error estimate for blocks of size 2^( 5) =       0.000550920225
  error estimate for blocks of size 2^( 6) =       0.000558599154
  error estimate for blocks of size 2^( 7) =       0.000562667046

      target function =      -0.747624579225
              le_mean =     -22.814874119348
             les_mean =     520.965659739917
             stat err =       0.000553137272
             autocorr =       1.368404700569
   target nu stat err =       0.000553137272
   target dn stat err =       0.002637999147
      target stat err =       0.002322254517
              std dev =       0.668714349927
             le_variance =       0.447178881799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447030406647
                                         uncertainty =       0.002561835554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447030406647
                                         uncertainty =       0.002561835554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472845272
  error estimate for blocks of size 2^( 2) =       0.000498190187
  error estimate for blocks of size 2^( 3) =       0.000522321837
  error estimate for blocks of size 2^( 4) =       0.000540377386
  error estimate for blocks of size 2^( 5) =       0.000550938124
  error estimate for blocks of size 2^( 6) =       0.000558618171
  error estimate for blocks of size 2^( 7) =       0.000562686043

      target function =      -0.747636091639
              le_mean =     -22.814874090209
             les_mean =     520.965644831019
             stat err =       0.000553154931
             autocorr =       1.368533630710
   target nu stat err =       0.000553154931
   target dn stat err =       0.002637622889
      target stat err =       0.002322021650
              std dev =       0.668704196556
             le_variance =       0.447165302492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747637733553        initial  <--
     2.5000e+00     2.5000e+01             5.5077e-04        -0.747611627780
     1.0000e+01     1.0000e+02             1.3871e-04        -0.747624579225
     4.0000e+01     4.0000e+02             3.4742e-05        -0.747636091639

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.1927
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2262e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2847e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7431
    reference variance = 0.308263
====================================================
  Execution time = 4.3886e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6038e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5177e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460384411009
                                         uncertainty =       0.007997933236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460384411009
                                         uncertainty =       0.007997933236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479778978
  error estimate for blocks of size 2^( 2) =       0.000504284322
  error estimate for blocks of size 2^( 3) =       0.000527377954
  error estimate for blocks of size 2^( 4) =       0.000544252302
  error estimate for blocks of size 2^( 5) =       0.000556581367
  error estimate for blocks of size 2^( 6) =       0.000561917436
  error estimate for blocks of size 2^( 7) =       0.000566205078

      target function =      -0.736582674285
              le_mean =     -22.813994515210
             les_mean =     520.938721244751
             stat err =       0.000557239046
             autocorr =       1.348964903326
   target nu stat err =       0.000557239046
   target dn stat err =       0.007729538056
      target stat err =       0.006381786239
              std dev =       0.678509937210
             le_variance =       0.460375734893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281399451521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736637154227       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736637511065       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736637891441       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736637971136       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736638070051       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736638109912       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736638139008       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736638177020       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736638231753       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736638260231       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736638289854       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736638321027       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736638336560       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736638361520       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736638387196       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736638416880       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736638420782       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736638439954       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736638443220       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736638454391       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736638457963       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736638460983       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736638462937       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736638466570       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736638470509       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736638471362       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736638473890       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736638474135       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736638474598       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736638474128       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736638474107       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 3.662851e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736637154227       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736637243595       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736637338871       residual = 7.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736637358811       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736637383579       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736637393551       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736637400815       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736637410343       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736637424035       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736637431164       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736637438583       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736637446391       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736637450271       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736637456520       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736637462941       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736637470367       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736637471339       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736637476131       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736637476952       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736637479742       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736637480634       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736637481387       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736637481874       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736637482782       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736637483764       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736637483977       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736637484608       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736637484670       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736637484783       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736637484666       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736637484661       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 9.163848e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736637154227       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736637176579       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736637200409       residual = 7.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736637205395       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736637211590       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736637214083       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736637215898       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736637218282       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736637221705       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736637223489       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736637225345       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736637227296       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736637228266       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736637229829       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736637231435       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736637233292       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736637233533       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736637234733       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736637234938       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736637235635       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736637235859       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736637236045       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736637236169       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736637236394       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736637236641       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736637236693       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736637236852       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736637236867       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736637236894       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736637236865       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736637236865       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 2.291383e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248220 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9105e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.624556e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.658843e-03 1 1  ON 2
 uu_3                -5.375233e-02 1 1  ON 3
 uu_4                -8.591771e-02 1 1  ON 4
 uu_5                -1.030002e-01 1 1  ON 5
 uu_6                -1.108459e-01 1 1  ON 6
 uu_7                -1.087612e-01 1 1  ON 7
 uu_8                -9.325049e-02 1 1  ON 8
 uu_9                -5.957033e-02 1 1  ON 9
 ud_0                 3.378590e-01 1 1  ON 10
 ud_1                 9.968042e-02 1 1  ON 11
 ud_2                -1.443917e-02 1 1  ON 12
 ud_3                -7.376491e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224045e-01 1 1  ON 15
 ud_6                -1.277140e-01 1 1  ON 16
 ud_7                -1.191878e-01 1 1  ON 17
 ud_8                -9.272872e-02 1 1  ON 18
 ud_9                -4.448062e-02 1 1  ON 19
 eC_0                -4.563423e-01 1 1  ON 20
 eC_1                -3.182943e-01 1 1  ON 21
 eC_2                -6.732497e-02 1 1  ON 22
 eC_3                 9.506437e-02 1 1  ON 23
 eC_4                 1.376015e-01 1 1  ON 24
 eC_5                 1.931367e-01 1 1  ON 25
 eC_6                 2.098769e-01 1 1  ON 26
 eC_7                 1.662035e-01 1 1  ON 27
 eC_8                 3.840502e-02 1 1  ON 28
 eC_9                 1.376864e-03 1 1  ON 29
 eO_0                -8.228064e-01 1 1  ON 30
 eO_1                -5.297422e-01 1 1  ON 31
 eO_2                -1.492285e-01 1 1  ON 32
 eO_3                 1.025698e-01 1 1  ON 33
 eO_4                 2.270557e-01 1 1  ON 34
 eO_5                 3.212725e-01 1 1  ON 35
 eO_6                 3.347775e-01 1 1  ON 36
 eO_7                 3.060213e-01 1 1  ON 37
 eO_8                 1.433594e-01 1 1  ON 38
 eO_9                 3.830820e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.780090e-02 1 1  ON 41
eH1_2                -1.874893e-02 1 1  ON 42
eH1_3                -3.713031e-02 1 1  ON 43
eH1_4                -1.241767e-02 1 1  ON 44
eH1_5                 8.975918e-03 1 1  ON 45
eH1_6                 5.390969e-02 1 1  ON 46
eH1_7                 6.334968e-02 1 1  ON 47
eH1_8                 6.498612e-02 1 1  ON 48
eH1_9                 4.352586e-02 1 1  ON 49
eH2_0                -1.183015e-01 1 1  ON 50
eH2_1                -2.576352e-02 1 1  ON 51
eH2_2                -1.319055e-02 1 1  ON 52
eH2_3                -3.560841e-02 1 1  ON 53
eH2_4                -1.653613e-02 1 1  ON 54
eH2_5                 7.920301e-03 1 1  ON 55
eH2_6                 4.214888e-02 1 1  ON 56
eH2_7                 4.045378e-02 1 1  ON 57
eH2_8                 5.493449e-02 1 1  ON 58
eH2_9                 5.404666e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8996
    reference variance = 0.420704
====================================================
  Execution time = 4.5260e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4771e-01
  Total weights = 2.0000e+06
  Execution time = 3.6143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447698474968
                                         uncertainty =       0.002797269380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447698474968
                                         uncertainty =       0.002797269380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473132995
  error estimate for blocks of size 2^( 2) =       0.000498775878
  error estimate for blocks of size 2^( 3) =       0.000522400522
  error estimate for blocks of size 2^( 4) =       0.000539714698
  error estimate for blocks of size 2^( 5) =       0.000550406018
  error estimate for blocks of size 2^( 6) =       0.000556079430
  error estimate for blocks of size 2^( 7) =       0.000560869537

      target function =      -0.747170762892
              le_mean =     -22.815120310984
             les_mean =     520.977424242920
             stat err =       0.000551767421
             autocorr =       1.360021068659
   target nu stat err =       0.000551767421
   target dn stat err =       0.002659792452
      target stat err =       0.002337764963
              std dev =       0.669111098482
             le_variance =       0.447709662112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447699707030
                                         uncertainty =       0.002797361788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447699707030
                                         uncertainty =       0.002797361788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473133648
  error estimate for blocks of size 2^( 2) =       0.000498775036
  error estimate for blocks of size 2^( 3) =       0.000522398261
  error estimate for blocks of size 2^( 4) =       0.000539711471
  error estimate for blocks of size 2^( 5) =       0.000550402300
  error estimate for blocks of size 2^( 6) =       0.000556075393
  error estimate for blocks of size 2^( 7) =       0.000560865577

      target function =      -0.747169717041
              le_mean =     -22.815120280005
             les_mean =     520.977424064419
             stat err =       0.000551763685
             autocorr =       1.359998903245
   target nu stat err =       0.000551763685
   target dn stat err =       0.002659869580
      target stat err =       0.002337820349
              std dev =       0.669112021404
             le_variance =       0.447710897187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447699091128
                                         uncertainty =       0.002797315654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447699091128
                                         uncertainty =       0.002797315654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473133321
  error estimate for blocks of size 2^( 2) =       0.000498775456
  error estimate for blocks of size 2^( 3) =       0.000522399390
  error estimate for blocks of size 2^( 4) =       0.000539713082
  error estimate for blocks of size 2^( 5) =       0.000550404156
  error estimate for blocks of size 2^( 6) =       0.000556077409
  error estimate for blocks of size 2^( 7) =       0.000560867554

      target function =      -0.747170239857
              le_mean =     -22.815120295353
             les_mean =     520.977424147354
             stat err =       0.000551765550
             autocorr =       1.360009972219
   target nu stat err =       0.000551765550
   target dn stat err =       0.002659831072
      target stat err =       0.002337792700
              std dev =       0.669111560041
             le_variance =       0.447710279781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447698551932
                                         uncertainty =       0.002797275167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447698551932
                                         uncertainty =       0.002797275167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473133036
  error estimate for blocks of size 2^( 2) =       0.000498775825
  error estimate for blocks of size 2^( 3) =       0.000522400380
  error estimate for blocks of size 2^( 4) =       0.000539714496
  error estimate for blocks of size 2^( 5) =       0.000550405785
  error estimate for blocks of size 2^( 6) =       0.000556079177
  error estimate for blocks of size 2^( 7) =       0.000560869289

      target function =      -0.747170697560
              le_mean =     -22.815120309014
             les_mean =     520.977424230183
             stat err =       0.000551767187
             autocorr =       1.360019681158
   target nu stat err =       0.000551767187
   target dn stat err =       0.002659797281
      target stat err =       0.002337768431
              std dev =       0.669111156135
             le_variance =       0.447709739265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747170762892        initial  <--
     2.5000e+01     2.5000e+02             3.6629e-05        -0.747169717041
     1.0000e+02     1.0000e+03             9.1638e-06        -0.747170239857
     4.0000e+02     4.0000e+03             2.2914e-06        -0.747170697560

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2412
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2235e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2839e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7259
    reference variance = 0.350657
====================================================
  Execution time = 4.4181e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5440e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4778e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454427134448
                                         uncertainty =       0.006245983401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454427134448
                                         uncertainty =       0.006245983401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476654944
  error estimate for blocks of size 2^( 2) =       0.000501490624
  error estimate for blocks of size 2^( 3) =       0.000525387468
  error estimate for blocks of size 2^( 4) =       0.000543197020
  error estimate for blocks of size 2^( 5) =       0.000554253559
  error estimate for blocks of size 2^( 6) =       0.000561662501
  error estimate for blocks of size 2^( 7) =       0.000564933527

      target function =      -0.741551533784
              le_mean =     -22.813904290117
             les_mean =     520.928628602952
             stat err =       0.000556011652
             autocorr =       1.360691216102
   target nu stat err =       0.000556011652
   target dn stat err =       0.005825989918
      target stat err =       0.004891274921
              std dev =       0.674091886565
             le_variance =       0.454399871533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281390429012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741582985519       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741583025047       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741583059421       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741583074189       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741583086009       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741583096602       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741583105584       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741583114375       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741583118334       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741583124481       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741583129730       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741583134478       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741583138305       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741583143563       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741583144235       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741583147034       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741583150641       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741583152088       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741583153915       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741583154670       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741583155407       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741583156087       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741583156424       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741583156915       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741583157786       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741583158150       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741583158234       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741583158164       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741583158242       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741583158207       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741583158208       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741583158207       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741583158218       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 4.689028e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741582985519       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741582995403       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741583003998       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741583007690       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741583010647       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741583013294       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741583015538       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741583017736       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741583018729       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741583020265       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741583021577       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741583022764       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741583023721       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741583025033       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741583025207       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741583025901       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741583026802       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741583027169       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741583027621       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741583027812       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741583027996       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741583028166       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741583028252       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741583028378       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741583028587       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741583028681       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741583028698       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741583028683       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741583028703       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741583028694       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741583028701       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741583028694       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741583028702       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 1.172328e-06

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741582985519       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741582987990       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741582990139       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741582991063       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741582991799       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741582992467       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741582993027       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741582993580       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741582993819       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741582994203       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741582994537       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741582994818       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741582995085       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741582995406       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741582995441       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741582995616       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741582995843       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741582995937       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741582996052       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741582996089       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741582996138       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741582996179       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741582996207       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741582996229       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741582996291       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741582996316       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741582996319       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741582996332       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741582996315       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741582996306       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741582996323       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741582996316       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741582996301       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+03 is 2.930863e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9006e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.624555e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659172e-03 1 1  ON 2
 uu_3                -5.375172e-02 1 1  ON 3
 uu_4                -8.591713e-02 1 1  ON 4
 uu_5                -1.029992e-01 1 1  ON 5
 uu_6                -1.108449e-01 1 1  ON 6
 uu_7                -1.087608e-01 1 1  ON 7
 uu_8                -9.325140e-02 1 1  ON 8
 uu_9                -5.957355e-02 1 1  ON 9
 ud_0                 3.378552e-01 1 1  ON 10
 ud_1                 9.967837e-02 1 1  ON 11
 ud_2                -1.443988e-02 1 1  ON 12
 ud_3                -7.376539e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224041e-01 1 1  ON 15
 ud_6                -1.277131e-01 1 1  ON 16
 ud_7                -1.191875e-01 1 1  ON 17
 ud_8                -9.272597e-02 1 1  ON 18
 ud_9                -4.447684e-02 1 1  ON 19
 eC_0                -4.563383e-01 1 1  ON 20
 eC_1                -3.182915e-01 1 1  ON 21
 eC_2                -6.732217e-02 1 1  ON 22
 eC_3                 9.506670e-02 1 1  ON 23
 eC_4                 1.375988e-01 1 1  ON 24
 eC_5                 1.931340e-01 1 1  ON 25
 eC_6                 2.098758e-01 1 1  ON 26
 eC_7                 1.662001e-01 1 1  ON 27
 eC_8                 3.840254e-02 1 1  ON 28
 eC_9                 1.377092e-03 1 1  ON 29
 eO_0                -8.227984e-01 1 1  ON 30
 eO_1                -5.297369e-01 1 1  ON 31
 eO_2                -1.492262e-01 1 1  ON 32
 eO_3                 1.025705e-01 1 1  ON 33
 eO_4                 2.270541e-01 1 1  ON 34
 eO_5                 3.212691e-01 1 1  ON 35
 eO_6                 3.347763e-01 1 1  ON 36
 eO_7                 3.060198e-01 1 1  ON 37
 eO_8                 1.433537e-01 1 1  ON 38
 eO_9                 3.830560e-02 1 1  ON 39
eH1_0                -1.277006e-01 1 1  ON 40
eH1_1                -3.779975e-02 1 1  ON 41
eH1_2                -1.874703e-02 1 1  ON 42
eH1_3                -3.712821e-02 1 1  ON 43
eH1_4                -1.241673e-02 1 1  ON 44
eH1_5                 8.974377e-03 1 1  ON 45
eH1_6                 5.391152e-02 1 1  ON 46
eH1_7                 6.334527e-02 1 1  ON 47
eH1_8                 6.498473e-02 1 1  ON 48
eH1_9                 4.352549e-02 1 1  ON 49
eH2_0                -1.183005e-01 1 1  ON 50
eH2_1                -2.576222e-02 1 1  ON 51
eH2_2                -1.319061e-02 1 1  ON 52
eH2_3                -3.560923e-02 1 1  ON 53
eH2_4                -1.653903e-02 1 1  ON 54
eH2_5                 7.920728e-03 1 1  ON 55
eH2_6                 4.215158e-02 1 1  ON 56
eH2_7                 4.045448e-02 1 1  ON 57
eH2_8                 5.493403e-02 1 1  ON 58
eH2_9                 5.404536e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8344
    reference variance = 0.559947
====================================================
  Execution time = 4.3900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5051e-01
  Total weights = 2.0000e+06
  Execution time = 3.6003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450566174420
                                         uncertainty =       0.003462485305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450566174420
                                         uncertainty =       0.003462485305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474612783
  error estimate for blocks of size 2^( 2) =       0.000499419234
  error estimate for blocks of size 2^( 3) =       0.000522540066
  error estimate for blocks of size 2^( 4) =       0.000540135075
  error estimate for blocks of size 2^( 5) =       0.000550099287
  error estimate for blocks of size 2^( 6) =       0.000554481857
  error estimate for blocks of size 2^( 7) =       0.000556851377

      target function =      -0.744807919647
              le_mean =     -22.814569161508
             les_mean =     520.955080387064
             stat err =       0.000550391899
             autocorr =       1.344823236468
   target nu stat err =       0.000550391899
   target dn stat err =       0.003659231155
      target stat err =       0.003138968923
              std dev =       0.671203834218
             le_variance =       0.450514587069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450566299503
                                         uncertainty =       0.003462495152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450566299503
                                         uncertainty =       0.003462495152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474612848
  error estimate for blocks of size 2^( 2) =       0.000499419104
  error estimate for blocks of size 2^( 3) =       0.000522539751
  error estimate for blocks of size 2^( 4) =       0.000540134614
  error estimate for blocks of size 2^( 5) =       0.000550098713
  error estimate for blocks of size 2^( 6) =       0.000554481225
  error estimate for blocks of size 2^( 7) =       0.000556850739

      target function =      -0.744807814820
              le_mean =     -22.814569157618
             les_mean =     520.955080334212
             stat err =       0.000550391323
             autocorr =       1.344820047395
   target nu stat err =       0.000550391323
   target dn stat err =       0.003659243188
      target stat err =       0.003138977828
              std dev =       0.671203927081
             le_variance =       0.450514711729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450566236964
                                         uncertainty =       0.003462490229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450566236964
                                         uncertainty =       0.003462490229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474612816
  error estimate for blocks of size 2^( 2) =       0.000499419169
  error estimate for blocks of size 2^( 3) =       0.000522539909
  error estimate for blocks of size 2^( 4) =       0.000540134845
  error estimate for blocks of size 2^( 5) =       0.000550099000
  error estimate for blocks of size 2^( 6) =       0.000554481541
  error estimate for blocks of size 2^( 7) =       0.000556851058

      target function =      -0.744807867231
              le_mean =     -22.814569159561
             les_mean =     520.955080360528
             stat err =       0.000550391611
             autocorr =       1.344821641772
   target nu stat err =       0.000550391611
   target dn stat err =       0.003659237172
      target stat err =       0.003138973376
              std dev =       0.671203880651
             le_variance =       0.450514649401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450566182237
                                         uncertainty =       0.003462485920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450566182237
                                         uncertainty =       0.003462485920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474612787
  error estimate for blocks of size 2^( 2) =       0.000499419226
  error estimate for blocks of size 2^( 3) =       0.000522540046
  error estimate for blocks of size 2^( 4) =       0.000540135047
  error estimate for blocks of size 2^( 5) =       0.000550099251
  error estimate for blocks of size 2^( 6) =       0.000554481818
  error estimate for blocks of size 2^( 7) =       0.000556851337

      target function =      -0.744807913095
              le_mean =     -22.814569161265
             les_mean =     520.955080383734
             stat err =       0.000550391863
             autocorr =       1.344823037131
   target nu stat err =       0.000550391863
   target dn stat err =       0.003659231907
      target stat err =       0.003138969480
              std dev =       0.671203840022
             le_variance =       0.450514594860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744807919647        initial  <--
     2.5000e+02     2.5000e+03             4.6890e-06        -0.744807814820
     1.0000e+03     1.0000e+04             1.1723e-06        -0.744807867231
     4.0000e+03     4.0000e+04             2.9309e-07        -0.744807913095

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8455
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2086e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8356
    reference variance = 0.582123
====================================================
  Execution time = 4.5628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5185e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4941e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451831038369
                                         uncertainty =       0.003310696060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451831038369
                                         uncertainty =       0.003310696060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475314603
  error estimate for blocks of size 2^( 2) =       0.000499852926
  error estimate for blocks of size 2^( 3) =       0.000523352019
  error estimate for blocks of size 2^( 4) =       0.000541406594
  error estimate for blocks of size 2^( 5) =       0.000550343860
  error estimate for blocks of size 2^( 6) =       0.000555688208
  error estimate for blocks of size 2^( 7) =       0.000556869703

      target function =      -0.743672859738
              le_mean =     -22.815254946898
             les_mean =     520.987706010530
             stat err =       0.000551077091
             autocorr =       1.344195383146
   target nu stat err =       0.000551077091
   target dn stat err =       0.003756407633
      target stat err =       0.003212974087
              std dev =       0.672196358600
             le_variance =       0.451847944515


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281525494690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743685674835       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743685678306       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743685682387       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743685683765       residual = 8.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743685685270       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743685686161       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743685687121       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743685687627       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743685688090       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743685688523       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743685689092       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743685689691       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743685690035       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743685690438       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743685690821       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743685691149       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743685691277       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743685691692       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743685691907       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743685692215       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743685692267       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743685692343       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743685692360       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743685692406       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743685692460       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743685692482       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743685692484       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743685692489       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743685692479       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743685692480       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743685692482       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743685692485       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 5.727158e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743685674835       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743685675703       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743685676723       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743685677068       residual = 8.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743685677448       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743685677685       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743685677906       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743685678029       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743685678164       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743685678255       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743685678399       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743685678582       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743685678625       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743685678745       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743685678823       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743685678911       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743685678957       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743685679063       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743685679086       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743685679186       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743685679138       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743685679209       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743685679232       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743685679245       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743685679182       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743685679238       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743685679250       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743685679248       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743685679173       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743685679251       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743685679221       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743685679175       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+04 is 1.431788e-07

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743685674835       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743685675052       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743685675307       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743685675391       residual = 8.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743685675538       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743685675532       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743685675545       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743685675676       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743685675612       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743685675656       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743685675653       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743685675727       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743685675762       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743685675837       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743685675756       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743685675878       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743685675807       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743685675841       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743685675857       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743685675900       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743685675940       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743685676014       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743685676041       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743685675964       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743685675902       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743685675892       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743685675900       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743685676012       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743685675892       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743685675951       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743685675981       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743685675860       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+04 is 3.579471e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320515 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0614e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659205e-03 1 1  ON 2
 uu_3                -5.375163e-02 1 1  ON 3
 uu_4                -8.591704e-02 1 1  ON 4
 uu_5                -1.029991e-01 1 1  ON 5
 uu_6                -1.108448e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325170e-02 1 1  ON 8
 uu_9                -5.957385e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967817e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272571e-02 1 1  ON 18
 ud_9                -4.447689e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732178e-02 1 1  ON 22
 eC_3                 9.506703e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931334e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661997e-01 1 1  ON 27
 eC_8                 3.840240e-02 1 1  ON 28
 eC_9                 1.377145e-03 1 1  ON 29
 eO_0                -8.227974e-01 1 1  ON 30
 eO_1                -5.297361e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433532e-01 1 1  ON 38
 eO_9                 3.830544e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874709e-02 1 1  ON 42
eH1_3                -3.712828e-02 1 1  ON 43
eH1_4                -1.241676e-02 1 1  ON 44
eH1_5                 8.974352e-03 1 1  ON 45
eH1_6                 5.391204e-02 1 1  ON 46
eH1_7                 6.334550e-02 1 1  ON 47
eH1_8                 6.498477e-02 1 1  ON 48
eH1_9                 4.352533e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576174e-02 1 1  ON 51
eH2_2                -1.319038e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653923e-02 1 1  ON 54
eH2_5                 7.920551e-03 1 1  ON 55
eH2_6                 4.215157e-02 1 1  ON 56
eH2_7                 4.045403e-02 1 1  ON 57
eH2_8                 5.493389e-02 1 1  ON 58
eH2_9                 5.404524e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7639
    reference variance = 0.301718
====================================================
  Execution time = 4.3886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5007e-01
  Total weights = 2.0000e+06
  Execution time = 3.5760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450051191976
                                         uncertainty =       0.003719746568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450051191976
                                         uncertainty =       0.003719746568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474378861
  error estimate for blocks of size 2^( 2) =       0.000499362475
  error estimate for blocks of size 2^( 3) =       0.000522201038
  error estimate for blocks of size 2^( 4) =       0.000539433501
  error estimate for blocks of size 2^( 5) =       0.000550228986
  error estimate for blocks of size 2^( 6) =       0.000556373630
  error estimate for blocks of size 2^( 7) =       0.000558304345

      target function =      -0.745178631468
              le_mean =     -22.814647170066
             les_mean =     520.958195877692
             stat err =       0.000551085116
             autocorr =       1.349542934866
   target nu stat err =       0.000551085116
   target dn stat err =       0.003824629402
      target stat err =       0.003279151951
              std dev =       0.670873019372
             le_variance =       0.450070608121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450051209446
                                         uncertainty =       0.003719748235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450051209446
                                         uncertainty =       0.003719748235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474378871
  error estimate for blocks of size 2^( 2) =       0.000499362467
  error estimate for blocks of size 2^( 3) =       0.000522201015
  error estimate for blocks of size 2^( 4) =       0.000539433465
  error estimate for blocks of size 2^( 5) =       0.000550228943
  error estimate for blocks of size 2^( 6) =       0.000556373579
  error estimate for blocks of size 2^( 7) =       0.000558304292

      target function =      -0.745178616719
              le_mean =     -22.814647169617
             les_mean =     520.958195874723
             stat err =       0.000551085070
             autocorr =       1.349542657537
   target nu stat err =       0.000551085070
   target dn stat err =       0.003824630875
      target stat err =       0.003279153028
              std dev =       0.670873032428
             le_variance =       0.450070625639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450051200711
                                         uncertainty =       0.003719747402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450051200711
                                         uncertainty =       0.003719747402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474378866
  error estimate for blocks of size 2^( 2) =       0.000499362471
  error estimate for blocks of size 2^( 3) =       0.000522201026
  error estimate for blocks of size 2^( 4) =       0.000539433483
  error estimate for blocks of size 2^( 5) =       0.000550228965
  error estimate for blocks of size 2^( 6) =       0.000556373604
  error estimate for blocks of size 2^( 7) =       0.000558304319

      target function =      -0.745178624094
              le_mean =     -22.814647169842
             les_mean =     520.958195876206
             stat err =       0.000551085093
             autocorr =       1.349542796199
   target nu stat err =       0.000551085093
   target dn stat err =       0.003824630139
      target stat err =       0.003279152489
              std dev =       0.670873025900
             le_variance =       0.450070616880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450051193068
                                         uncertainty =       0.003719746673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450051193068
                                         uncertainty =       0.003719746673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474378862
  error estimate for blocks of size 2^( 2) =       0.000499362475
  error estimate for blocks of size 2^( 3) =       0.000522201036
  error estimate for blocks of size 2^( 4) =       0.000539433499
  error estimate for blocks of size 2^( 5) =       0.000550228984
  error estimate for blocks of size 2^( 6) =       0.000556373626
  error estimate for blocks of size 2^( 7) =       0.000558304342

      target function =      -0.745178630546
              le_mean =     -22.814647170038
             les_mean =     520.958195877506
             stat err =       0.000551085113
             autocorr =       1.349542917530
   target nu stat err =       0.000551085113
   target dn stat err =       0.003824629495
      target stat err =       0.003279152018
              std dev =       0.670873020188
             le_variance =       0.450070609216


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745178631468        initial  <--
     2.5000e+03     2.5000e+04             5.7272e-07        -0.745178616719
     1.0000e+04     1.0000e+05             1.4318e-07        -0.745178624094
     4.0000e+04     4.0000e+05             3.5795e-08        -0.745178630546

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.7126
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2233e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8977
    reference variance = 0.278046
====================================================
  Execution time = 4.6571e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5014e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4936e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449982080203
                                         uncertainty =       0.004218515893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449982080203
                                         uncertainty =       0.004218515893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474416615
  error estimate for blocks of size 2^( 2) =       0.000499505777
  error estimate for blocks of size 2^( 3) =       0.000522691400
  error estimate for blocks of size 2^( 4) =       0.000539224549
  error estimate for blocks of size 2^( 5) =       0.000549328879
  error estimate for blocks of size 2^( 6) =       0.000555868585
  error estimate for blocks of size 2^( 7) =       0.000560070425

      target function =      -0.745122387276
              le_mean =     -22.814207169210
             les_mean =     520.938190783405
             stat err =       0.000551123110
             autocorr =       1.349514215742
   target nu stat err =       0.000551123110
   target dn stat err =       0.004388150744
      target stat err =       0.003742945966
              std dev =       0.670926410893
             le_variance =       0.450142248834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281420716921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745139986462       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745139986883       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745139987338       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745139987478       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745139987648       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745139987653       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745139987844       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745139987915       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745139987959       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745139987956       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745139988058       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745139988101       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745139988155       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745139988226       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745139988286       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745139988280       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745139988352       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745139988344       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745139988389       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745139988400       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745139988365       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745139988453       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745139988305       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745139988359       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745139988510       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745139988379       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745139988368       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745139988400       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745139988442       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745139988328       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745139988462       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745139988299       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745139988166       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 6.173594e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745139986462       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745139986568       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745139986681       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745139986716       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745139986604       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745139987051       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745139986837       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745139986915       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745139986759       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745139986767       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745139986944       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745139986927       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745139986993       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745139986807       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745139987136       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745139987103       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745139986777       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745139986824       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745139987015       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745139986841       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745139986839       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745139986943       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745139987082       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745139986966       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745139986892       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745139986742       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745139987035       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745139986796       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745139987181       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745139986954       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745139986831       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745139987102       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745139987313       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+05 is 1.543400e-08

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745139986462       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745139986489       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745139986517       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745139986526       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745139986843       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745139986447       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745139986497       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745139986691       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745139986325       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745139986148       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745139987131       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745139987102       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745139987261       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745139986858       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745139986677       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745139986734       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745139986910       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745139986053       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745139987024       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745139987421       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745139988321       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745139986423       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745139986833       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745139987915       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745139985592       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745139987031       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745139985823       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745139987077       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745139985505       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745139987304       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745139987361       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745139986922       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745139986684       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+05 is 3.858500e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1554e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659227e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967816e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272570e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227973e-01 1 1  ON 30
 eO_1                -5.297361e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779998e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974317e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8116
    reference variance = 0.302175
====================================================
  Execution time = 4.3535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4527e-01
  Total weights = 2.0000e+06
  Execution time = 3.5895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445298186907
                                         uncertainty =       0.002381749266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445298186907
                                         uncertainty =       0.002381749266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471844690
  error estimate for blocks of size 2^( 2) =       0.000497178835
  error estimate for blocks of size 2^( 3) =       0.000521131109
  error estimate for blocks of size 2^( 4) =       0.000539060335
  error estimate for blocks of size 2^( 5) =       0.000548761766
  error estimate for blocks of size 2^( 6) =       0.000553724627
  error estimate for blocks of size 2^( 7) =       0.000559407076

      target function =      -0.749235633485
              le_mean =     -22.815397630096
             les_mean =     520.987643618938
             stat err =       0.000550238451
             autocorr =       1.359889838081
   target nu stat err =       0.000550238451
   target dn stat err =       0.002423175240
      target stat err =       0.002157119032
              std dev =       0.667289159342
             le_variance =       0.445274822176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445298188651
                                         uncertainty =       0.002381749396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445298188651
                                         uncertainty =       0.002381749396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471844691
  error estimate for blocks of size 2^( 2) =       0.000497178834
  error estimate for blocks of size 2^( 3) =       0.000521131106
  error estimate for blocks of size 2^( 4) =       0.000539060331
  error estimate for blocks of size 2^( 5) =       0.000548761760
  error estimate for blocks of size 2^( 6) =       0.000553724621
  error estimate for blocks of size 2^( 7) =       0.000559407070

      target function =      -0.749235632001
              le_mean =     -22.815397630139
             les_mean =     520.987643622650
             stat err =       0.000550238445
             autocorr =       1.359889804991
   target nu stat err =       0.000550238445
   target dn stat err =       0.002423175337
      target stat err =       0.002157119102
              std dev =       0.667289160647
             le_variance =       0.445274823916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445298187779
                                         uncertainty =       0.002381749331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445298187779
                                         uncertainty =       0.002381749331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471844690
  error estimate for blocks of size 2^( 2) =       0.000497178835
  error estimate for blocks of size 2^( 3) =       0.000521131108
  error estimate for blocks of size 2^( 4) =       0.000539060333
  error estimate for blocks of size 2^( 5) =       0.000548761763
  error estimate for blocks of size 2^( 6) =       0.000553724624
  error estimate for blocks of size 2^( 7) =       0.000559407073

      target function =      -0.749235632743
              le_mean =     -22.815397630118
             les_mean =     520.987643620794
             stat err =       0.000550238448
             autocorr =       1.359889821537
   target nu stat err =       0.000550238448
   target dn stat err =       0.002423175288
      target stat err =       0.002157119067
              std dev =       0.667289159994
             le_variance =       0.445274823046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445298187016
                                         uncertainty =       0.002381749274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445298187016
                                         uncertainty =       0.002381749274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471844690
  error estimate for blocks of size 2^( 2) =       0.000497178835
  error estimate for blocks of size 2^( 3) =       0.000521131109
  error estimate for blocks of size 2^( 4) =       0.000539060335
  error estimate for blocks of size 2^( 5) =       0.000548761765
  error estimate for blocks of size 2^( 6) =       0.000553724626
  error estimate for blocks of size 2^( 7) =       0.000559407076

      target function =      -0.749235633393
              le_mean =     -22.815397630099
             les_mean =     520.987643619170
             stat err =       0.000550238451
             autocorr =       1.359889836022
   target nu stat err =       0.000550238451
   target dn stat err =       0.002423175246
      target stat err =       0.002157119036
              std dev =       0.667289159424
             le_variance =       0.445274822285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749235633485        initial  <--
     2.5000e+04     2.5000e+05             6.1736e-08        -0.749235632001
     1.0000e+05     1.0000e+06             1.5434e-08        -0.749235632743
     4.0000e+05     4.0000e+06             3.8585e-09        -0.749235633393

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4277
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2299e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8047
    reference variance = 0.411916
====================================================
  Execution time = 4.4179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5820e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4928e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458252961173
                                         uncertainty =       0.007989912470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458252961173
                                         uncertainty =       0.007989912470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478643274
  error estimate for blocks of size 2^( 2) =       0.000503421407
  error estimate for blocks of size 2^( 3) =       0.000526480939
  error estimate for blocks of size 2^( 4) =       0.000543841129
  error estimate for blocks of size 2^( 5) =       0.000554355551
  error estimate for blocks of size 2^( 6) =       0.000558338561
  error estimate for blocks of size 2^( 7) =       0.000560962275

      target function =      -0.738343114621
              le_mean =     -22.815104255038
             les_mean =     520.987180706472
             stat err =       0.000554374379
             autocorr =       1.341474373786
   target nu stat err =       0.000554374379
   target dn stat err =       0.007751654679
      target stat err =       0.006440880004
              std dev =       0.676903809486
             le_variance =       0.458198767297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281510425504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738398637958       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738398638028       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738398638079       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738398637962       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738398638116       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738398637962       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738398638144       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738398638486       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738398639055       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738398638243       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738398638521       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738398637332       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.738398638637       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.738398638456       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.738398638438       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738398638210       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.738398638809       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.738398638090       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.738398638024       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.738398637677       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738398638809       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.738398638242       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.738398637535       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.738398638506       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.738398638846       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.738398638315       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.738398639121       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.738398638126       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.738398638549       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.738398637983       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.738398639172       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.738398636840       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.738398637072       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.738398638143       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+05 is 6.518208e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738398637958       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738398637975       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738398637988       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738398637720       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738398637998       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738398639033       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738398638005       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738398638008       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738398637099       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738398638118       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738398636983       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738398638745       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.738398635830       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.738398637516       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.738398637919       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738398636638       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.738398640009       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.738398638029       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.738398636853       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.738398639178       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738398640126       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.738398640858       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.738398639423       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.738398635798       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.738398638795       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.738398636479       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.738398637756       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.738398638758       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.738398635675       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.738398634169       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.738398642612       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.738398640026       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.738398639677       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.738398643865       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+06 is 1.629552e-09

solving harmonic davidson linear method for identity shift 4.0000e+06, overlap shift 4.0000e+07 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738398637958       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738398637962       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738398637966       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738398637967       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738398637968       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738398637969       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738398637970       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738398637971       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738398637971       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738398642143       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738398642468       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738398640336       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.738398636049       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.738398642327       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.738398640998       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738398633250       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.738398648327       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.738398634027       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.738398647104       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.738398632263       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738398631550       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.738398631656       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.738398634702       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.738398626744       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.738398631013       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.738398619695       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.738398647675       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.738398640194       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.738398635881       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.738398636325       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.738398626512       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.738398657950       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.738398622006       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.738398648080       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+06 is 4.073883e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399846 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9202e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227973e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.9175
    reference variance = 0.319028
====================================================
  Execution time = 4.3547e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5035e-01
  Total weights = 2.0000e+06
  Execution time = 3.5884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450448510297
                                         uncertainty =       0.004687575248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450448510297
                                         uncertainty =       0.004687575248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474525346
  error estimate for blocks of size 2^( 2) =       0.000499208005
  error estimate for blocks of size 2^( 3) =       0.000522655634
  error estimate for blocks of size 2^( 4) =       0.000538991938
  error estimate for blocks of size 2^( 5) =       0.000549823999
  error estimate for blocks of size 2^( 6) =       0.000555401631
  error estimate for blocks of size 2^( 7) =       0.000559910788

      target function =      -0.744918181974
              le_mean =     -22.815706845407
             les_mean =     521.006827238908
             stat err =       0.000551032089
             autocorr =       1.348450321071
   target nu stat err =       0.000551032089
   target dn stat err =       0.004472401410
      target stat err =       0.003819444817
              std dev =       0.671080180406
             le_variance =       0.450348608533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450448510548
                                         uncertainty =       0.004687575259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450448510548
                                         uncertainty =       0.004687575259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474525346
  error estimate for blocks of size 2^( 2) =       0.000499208005
  error estimate for blocks of size 2^( 3) =       0.000522655633
  error estimate for blocks of size 2^( 4) =       0.000538991937
  error estimate for blocks of size 2^( 5) =       0.000549823998
  error estimate for blocks of size 2^( 6) =       0.000555401630
  error estimate for blocks of size 2^( 7) =       0.000559910787

      target function =      -0.744918181764
              le_mean =     -22.815706845402
             les_mean =     521.006827238930
             stat err =       0.000551032088
             autocorr =       1.348450318204
   target nu stat err =       0.000551032088
   target dn stat err =       0.004472401420
      target stat err =       0.003819444823
              std dev =       0.671080180592
             le_variance =       0.450348608784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450448510423
                                         uncertainty =       0.004687575254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450448510423
                                         uncertainty =       0.004687575254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474525346
  error estimate for blocks of size 2^( 2) =       0.000499208005
  error estimate for blocks of size 2^( 3) =       0.000522655633
  error estimate for blocks of size 2^( 4) =       0.000538991938
  error estimate for blocks of size 2^( 5) =       0.000549823999
  error estimate for blocks of size 2^( 6) =       0.000555401630
  error estimate for blocks of size 2^( 7) =       0.000559910788

      target function =      -0.744918181869
              le_mean =     -22.815706845404
             les_mean =     521.006827238919
             stat err =       0.000551032089
             autocorr =       1.348450319647
   target nu stat err =       0.000551032089
   target dn stat err =       0.004472401415
      target stat err =       0.003819444820
              std dev =       0.671080180499
             le_variance =       0.450348608658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450448510313
                                         uncertainty =       0.004687575249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450448510313
                                         uncertainty =       0.004687575249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474525346
  error estimate for blocks of size 2^( 2) =       0.000499208005
  error estimate for blocks of size 2^( 3) =       0.000522655633
  error estimate for blocks of size 2^( 4) =       0.000538991938
  error estimate for blocks of size 2^( 5) =       0.000549823999
  error estimate for blocks of size 2^( 6) =       0.000555401631
  error estimate for blocks of size 2^( 7) =       0.000559910788

      target function =      -0.744918181961
              le_mean =     -22.815706845407
             les_mean =     521.006827238909
             stat err =       0.000551032089
             autocorr =       1.348450320891
   target nu stat err =       0.000551032089
   target dn stat err =       0.004472401411
      target stat err =       0.003819444817
              std dev =       0.671080180417
             le_variance =       0.450348608549


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744918181974        initial  <--
     2.5000e+05     2.5000e+06             6.5182e-09        -0.744918181764
     1.0000e+06     1.0000e+07             1.6296e-09        -0.744918181869
     4.0000e+06     4.0000e+07             4.0739e-10        -0.744918181961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4282
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2065e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8403
    reference variance = 0.276886
====================================================
  Execution time = 4.4112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5129e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4805e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451419297260
                                         uncertainty =       0.004487101956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451419297260
                                         uncertainty =       0.004487101956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475021596
  error estimate for blocks of size 2^( 2) =       0.000500306926
  error estimate for blocks of size 2^( 3) =       0.000523270392
  error estimate for blocks of size 2^( 4) =       0.000541251662
  error estimate for blocks of size 2^( 5) =       0.000552055513
  error estimate for blocks of size 2^( 6) =       0.000559235141
  error estimate for blocks of size 2^( 7) =       0.000562951665

      target function =      -0.744129106680
              le_mean =     -22.815381734291
             les_mean =     520.992934489527
             stat err =       0.000553873495
             autocorr =       1.359547723375
   target nu stat err =       0.000553873495
   target dn stat err =       0.004857934264
      target stat err =       0.004130059150
              std dev =       0.671781983793
             le_variance =       0.451291033749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281538173429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744150563615       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744150563620       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744150563623       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744150563625       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744150563625       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744150563626       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744150563626       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744150563627       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744150563627       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744150563627       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744150563628       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744150563628       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744150563628       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744150563628       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744150563132       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744150570229       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744150563790       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744150563191       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744150565628       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744150561377       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744150566502       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744150562482       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744150570560       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744150558652       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744150561208       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744150559914       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744150564235       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744150573817       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744150570830       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744150571193       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744150570864       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744150559385       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 3.632356e-10

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744150563615       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744150563616       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744150563617       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744150563617       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744150560702       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744150563618       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744150563618       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744150563618       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744150563618       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744150563618       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744150541046       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744150572396       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744150537178       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744150619689       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744150572838       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744150551821       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744150520402       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744150573849       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744150552531       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744150545057       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744150526186       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744150548246       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744150518017       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744150545541       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744150548205       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744150588569       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744150569676       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744150571624       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744150536951       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744150536600       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744150499501       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744150566870       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+07 is 9.080989e-11

solving harmonic davidson linear method for identity shift 4.0000e+07, overlap shift 4.0000e+08 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744150563615       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744150563615       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744150563615       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744150563616       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744150563616       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744150563616       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744150563616       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744150595538       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744150570438       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744150483403       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744150691978       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744150691760       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744150357936       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744150547814       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744150518314       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744150547801       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744150454690       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744150426742       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744150579165       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744150650703       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744150571286       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744150625164       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744150695071       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744150661872       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744150422914       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744150435328       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744150483212       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744150576241       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744150531634       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744150557400       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744150590197       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744150469202       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+07 is 2.270249e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.434756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8961e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7589
    reference variance = 0.299678
====================================================
  Execution time = 4.5877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4801e-01
  Total weights = 2.0000e+06
  Execution time = 3.6010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448040466064
                                         uncertainty =       0.003133002936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448040466064
                                         uncertainty =       0.003133002936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473291988
  error estimate for blocks of size 2^( 2) =       0.000498085886
  error estimate for blocks of size 2^( 3) =       0.000521941710
  error estimate for blocks of size 2^( 4) =       0.000538641560
  error estimate for blocks of size 2^( 5) =       0.000549539300
  error estimate for blocks of size 2^( 6) =       0.000557435002
  error estimate for blocks of size 2^( 7) =       0.000561560920

      target function =      -0.746907347482
              le_mean =     -22.815413721944
             les_mean =     520.991113691532
             stat err =       0.000551794195
             autocorr =       1.359239383888
   target nu stat err =       0.000551794195
   target dn stat err =       0.003251963535
      target stat err =       0.002823513377
              std dev =       0.669335948584
             le_variance =       0.448010612067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448040466048
                                         uncertainty =       0.003133002937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448040466048
                                         uncertainty =       0.003133002937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473291988
  error estimate for blocks of size 2^( 2) =       0.000498085886
  error estimate for blocks of size 2^( 3) =       0.000521941710
  error estimate for blocks of size 2^( 4) =       0.000538641560
  error estimate for blocks of size 2^( 5) =       0.000549539300
  error estimate for blocks of size 2^( 6) =       0.000557435002
  error estimate for blocks of size 2^( 7) =       0.000561560920

      target function =      -0.746907347496
              le_mean =     -22.815413721943
             les_mean =     520.991113691480
             stat err =       0.000551794195
             autocorr =       1.359239383679
   target nu stat err =       0.000551794195
   target dn stat err =       0.003251963535
      target stat err =       0.002823513378
              std dev =       0.669335948572
             le_variance =       0.448010612051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448040466056
                                         uncertainty =       0.003133002937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448040466056
                                         uncertainty =       0.003133002937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473291988
  error estimate for blocks of size 2^( 2) =       0.000498085886
  error estimate for blocks of size 2^( 3) =       0.000521941710
  error estimate for blocks of size 2^( 4) =       0.000538641560
  error estimate for blocks of size 2^( 5) =       0.000549539300
  error estimate for blocks of size 2^( 6) =       0.000557435002
  error estimate for blocks of size 2^( 7) =       0.000561560920

      target function =      -0.746907347489
              le_mean =     -22.815413721944
             les_mean =     520.991113691506
             stat err =       0.000551794195
             autocorr =       1.359239383781
   target nu stat err =       0.000551794195
   target dn stat err =       0.003251963535
      target stat err =       0.002823513378
              std dev =       0.669335948578
             le_variance =       0.448010612059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448040466063
                                         uncertainty =       0.003133002936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448040466063
                                         uncertainty =       0.003133002936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473291988
  error estimate for blocks of size 2^( 2) =       0.000498085886
  error estimate for blocks of size 2^( 3) =       0.000521941710
  error estimate for blocks of size 2^( 4) =       0.000538641560
  error estimate for blocks of size 2^( 5) =       0.000549539300
  error estimate for blocks of size 2^( 6) =       0.000557435002
  error estimate for blocks of size 2^( 7) =       0.000561560920

      target function =      -0.746907347483
              le_mean =     -22.815413721944
             les_mean =     520.991113691529
             stat err =       0.000551794195
             autocorr =       1.359239383875
   target nu stat err =       0.000551794195
   target dn stat err =       0.003251963535
      target stat err =       0.002823513377
              std dev =       0.669335948584
             le_variance =       0.448010612066


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746907347482        initial
     2.5000e+06     2.5000e+07             3.6324e-10        -0.746907347496  <--
     1.0000e+07     1.0000e+08             9.0810e-11        -0.746907347489
     4.0000e+07     4.0000e+08             2.2702e-11        -0.746907347483

*****************************************************************************
Applying the update for shift_i =   2.5000e+06     and shift_s =   2.5000e+07
*****************************************************************************

  Execution time = 6.3825e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2279e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.9067
    reference variance = 0.382295
====================================================
  Execution time = 4.4984e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5131e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450011025883
                                         uncertainty =       0.005037027566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450011025883
                                         uncertainty =       0.005037027566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474341239
  error estimate for blocks of size 2^( 2) =       0.000499034952
  error estimate for blocks of size 2^( 3) =       0.000522305835
  error estimate for blocks of size 2^( 4) =       0.000539491874
  error estimate for blocks of size 2^( 5) =       0.000551459313
  error estimate for blocks of size 2^( 6) =       0.000558922013
  error estimate for blocks of size 2^( 7) =       0.000562163536

      target function =      -0.745235311113
              le_mean =     -22.814477681859
             les_mean =     520.950390892281
             stat err =       0.000553009184
             autocorr =       1.359198609489
   target nu stat err =       0.000553009184
   target dn stat err =       0.004672025186
      target stat err =       0.003981759494
              std dev =       0.670819812788
             le_variance =       0.449999221228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281447768186e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745255331343       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745255331357       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745255331371       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745255331375       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745255331377       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745255331380       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745255331383       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745255331387       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745255332103       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745255331758       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745255333906       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745255332314       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745255332326       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745255332289       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745255334231       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745255330504       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745255330876       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745255331432       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745255331162       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745255330133       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745255327931       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745255330994       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745255332993       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745255330795       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745255331514       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745255329246       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745255331149       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745255332635       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745255332966       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745255331260       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745255331724       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745255330207       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+05 is 1.605806e-09

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745255331343       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745255331346       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745255331350       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745255331351       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745255331478       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745255331352       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745255334614       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745255332619       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745255330929       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745255332633       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745255336018       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745255335017       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745255333453       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745255329924       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745255336332       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745255335418       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745255331634       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745255323898       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745255332109       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745255330310       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745255342945       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745255329461       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745255330146       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745255338993       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745255334131       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745255331907       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745255321651       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745255331925       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745255330947       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745255317343       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745255323128       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745255342980       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 4.014520e-10

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745255331343       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745255331344       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745255331345       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745255331345       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745255331345       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745255334797       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745255331345       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745255331346       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745255331346       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745255333283       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745255325552       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745255328521       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745255331002       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745255319774       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745255354772       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745255337171       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745255328925       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745255320229       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745255364972       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745255347645       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745255345295       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745255321346       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745255342892       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745255340759       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745255342289       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745255349363       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745255346262       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745255361536       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745255295324       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745255333682       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745255336519       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745255344954       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+07 is 1.003623e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.469637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0161e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227973e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920535e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.813
    reference variance = 0.276917
====================================================
  Execution time = 4.3857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5127e-01
  Total weights = 2.0000e+06
  Execution time = 3.5936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451236768422
                                         uncertainty =       0.002910929113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451236768422
                                         uncertainty =       0.002910929113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475012787
  error estimate for blocks of size 2^( 2) =       0.000499819696
  error estimate for blocks of size 2^( 3) =       0.000523967956
  error estimate for blocks of size 2^( 4) =       0.000540962136
  error estimate for blocks of size 2^( 5) =       0.000551025081
  error estimate for blocks of size 2^( 6) =       0.000557661044
  error estimate for blocks of size 2^( 7) =       0.000560561302

      target function =      -0.744157035384
              le_mean =     -22.815338684604
             les_mean =     520.990953362266
             stat err =       0.000552552391
             autocorr =       1.353120034830
   target nu stat err =       0.000552552391
   target dn stat err =       0.003079985931
      target stat err =       0.002662432360
              std dev =       0.671769525012
             le_variance =       0.451274294734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451236768423
                                         uncertainty =       0.002910929117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451236768423
                                         uncertainty =       0.002910929117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475012787
  error estimate for blocks of size 2^( 2) =       0.000499819696
  error estimate for blocks of size 2^( 3) =       0.000523967956
  error estimate for blocks of size 2^( 4) =       0.000540962136
  error estimate for blocks of size 2^( 5) =       0.000551025081
  error estimate for blocks of size 2^( 6) =       0.000557661044
  error estimate for blocks of size 2^( 7) =       0.000560561302

      target function =      -0.744157035384
              le_mean =     -22.815338684603
             les_mean =     520.990953362242
             stat err =       0.000552552391
             autocorr =       1.353120033758
   target nu stat err =       0.000552552391
   target dn stat err =       0.003079985934
      target stat err =       0.002662432362
              std dev =       0.671769525012
             le_variance =       0.451274294735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451236768423
                                         uncertainty =       0.002910929115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451236768423
                                         uncertainty =       0.002910929115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475012787
  error estimate for blocks of size 2^( 2) =       0.000499819696
  error estimate for blocks of size 2^( 3) =       0.000523967956
  error estimate for blocks of size 2^( 4) =       0.000540962136
  error estimate for blocks of size 2^( 5) =       0.000551025081
  error estimate for blocks of size 2^( 6) =       0.000557661044
  error estimate for blocks of size 2^( 7) =       0.000560561302

      target function =      -0.744157035384
              le_mean =     -22.815338684603
             les_mean =     520.990953362254
             stat err =       0.000552552391
             autocorr =       1.353120034293
   target nu stat err =       0.000552552391
   target dn stat err =       0.003079985932
      target stat err =       0.002662432361
              std dev =       0.671769525012
             le_variance =       0.451274294734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451236768423
                                         uncertainty =       0.002910929113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451236768423
                                         uncertainty =       0.002910929113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475012787
  error estimate for blocks of size 2^( 2) =       0.000499819696
  error estimate for blocks of size 2^( 3) =       0.000523967956
  error estimate for blocks of size 2^( 4) =       0.000540962136
  error estimate for blocks of size 2^( 5) =       0.000551025081
  error estimate for blocks of size 2^( 6) =       0.000557661044
  error estimate for blocks of size 2^( 7) =       0.000560561302

      target function =      -0.744157035384
              le_mean =     -22.815338684604
             les_mean =     520.990953362264
             stat err =       0.000552552391
             autocorr =       1.353120034775
   target nu stat err =       0.000552552391
   target dn stat err =       0.003079985931
      target stat err =       0.002662432360
              std dev =       0.671769525012
             le_variance =       0.451274294734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744157035384        initial  <--
     6.2500e+05     6.2500e+06             1.6058e-09        -0.744157035384
     2.5000e+06     2.5000e+07             4.0145e-10        -0.744157035384
     1.0000e+07     1.0000e+08             1.0036e-10        -0.744157035384

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.9926
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2316e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8117
    reference variance = 0.375234
====================================================
  Execution time = 4.4469e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4909e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4899e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449195993603
                                         uncertainty =       0.003561658396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449195993603
                                         uncertainty =       0.003561658396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473862250
  error estimate for blocks of size 2^( 2) =       0.000498772176
  error estimate for blocks of size 2^( 3) =       0.000521603931
  error estimate for blocks of size 2^( 4) =       0.000538663148
  error estimate for blocks of size 2^( 5) =       0.000549030751
  error estimate for blocks of size 2^( 6) =       0.000554288132
  error estimate for blocks of size 2^( 7) =       0.000557088910

      target function =      -0.746000865562
              le_mean =     -22.814839955849
             les_mean =     520.966012850297
             stat err =       0.000549767735
             autocorr =       1.346028553705
   target nu stat err =       0.000549767735
   target dn stat err =       0.003812020479
      target stat err =       0.003276492361
              std dev =       0.670142420558
             le_variance =       0.449090863831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281483995585e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746014246510       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746014246512       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746014246514       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746014251450       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746014246514       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746014248559       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746014246515       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746014237494       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746014243886       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746014246515       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746014245372       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746014233504       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746014231650       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746014255677       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746014236524       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746014260229       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746014237901       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746014236719       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746014234199       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746014233827       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746014243109       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746014250125       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746014248502       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746014232408       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746014258658       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746014261321       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746014260213       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746014252115       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746014252750       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746014246113       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746014247585       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746014221686       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746014271217       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+06 is 1.858417e-10

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746014246510       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746014246510       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746014246511       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746014246511       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746014241226       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746014267609       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746014238697       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746014251726       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746014203807       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746014228909       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746014276164       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746014128316       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746014224420       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746014255748       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746014178794       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746014324931       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746014246397       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746014212600       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746014272977       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746014209556       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746014225337       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746014233312       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746014234106       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746014282012       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746014187587       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746014188817       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746014304720       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746014248534       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746014267103       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746014265572       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746014218940       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746014240911       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746014233015       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+07 is 4.645977e-11

solving harmonic davidson linear method for identity shift 1.0000e+08, overlap shift 1.0000e+09 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746014246510       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746014246510       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746014246510       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746014246510       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746014241209       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746014171698       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746014242202       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746014246510       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746014246510       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746013980724       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746014097976       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746014246510       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746014239587       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746014335367       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746014310827       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746014043578       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746014400593       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746014271351       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746014063209       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746014561473       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746014352170       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746014421295       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746014155153       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746014379252       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746014296223       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746014257278       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746014384519       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746014204365       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746014382904       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746014210429       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746013918162       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746014699892       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746014649932       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+08 is 1.161432e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.507507 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9415e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7643
    reference variance = 0.418994
====================================================
  Execution time = 4.3047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4776e-01
  Total weights = 2.0000e+06
  Execution time = 3.5837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447822808096
                                         uncertainty =       0.003303869211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447822808096
                                         uncertainty =       0.003303869211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159261
  error estimate for blocks of size 2^( 2) =       0.000498059993
  error estimate for blocks of size 2^( 3) =       0.000521590290
  error estimate for blocks of size 2^( 4) =       0.000539016269
  error estimate for blocks of size 2^( 5) =       0.000549761773
  error estimate for blocks of size 2^( 6) =       0.000553958863
  error estimate for blocks of size 2^( 7) =       0.000558281056

      target function =      -0.747118953962
              le_mean =     -22.815552666446
             les_mean =     520.997202623773
             stat err =       0.000550254490
             autocorr =       1.352422854948
   target nu stat err =       0.000550254490
   target dn stat err =       0.003048789017
      target stat err =       0.002657647041
              std dev =       0.669148243880
             le_variance =       0.447759372288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447822808099
                                         uncertainty =       0.003303869211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447822808099
                                         uncertainty =       0.003303869211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159261
  error estimate for blocks of size 2^( 2) =       0.000498059993
  error estimate for blocks of size 2^( 3) =       0.000521590290
  error estimate for blocks of size 2^( 4) =       0.000539016269
  error estimate for blocks of size 2^( 5) =       0.000549761773
  error estimate for blocks of size 2^( 6) =       0.000553958863
  error estimate for blocks of size 2^( 7) =       0.000558281056

      target function =      -0.747118953960
              le_mean =     -22.815552666446
             les_mean =     520.997202623784
             stat err =       0.000550254490
             autocorr =       1.352422854837
   target nu stat err =       0.000550254490
   target dn stat err =       0.003048789017
      target stat err =       0.002657647041
              std dev =       0.669148243882
             le_variance =       0.447759372290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447822808097
                                         uncertainty =       0.003303869211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447822808097
                                         uncertainty =       0.003303869211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159261
  error estimate for blocks of size 2^( 2) =       0.000498059993
  error estimate for blocks of size 2^( 3) =       0.000521590290
  error estimate for blocks of size 2^( 4) =       0.000539016269
  error estimate for blocks of size 2^( 5) =       0.000549761773
  error estimate for blocks of size 2^( 6) =       0.000553958863
  error estimate for blocks of size 2^( 7) =       0.000558281056

      target function =      -0.747118953961
              le_mean =     -22.815552666446
             les_mean =     520.997202623779
             stat err =       0.000550254490
             autocorr =       1.352422854889
   target nu stat err =       0.000550254490
   target dn stat err =       0.003048789017
      target stat err =       0.002657647041
              std dev =       0.669148243881
             le_variance =       0.447759372289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447822808096
                                         uncertainty =       0.003303869211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447822808096
                                         uncertainty =       0.003303869211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159261
  error estimate for blocks of size 2^( 2) =       0.000498059993
  error estimate for blocks of size 2^( 3) =       0.000521590290
  error estimate for blocks of size 2^( 4) =       0.000539016269
  error estimate for blocks of size 2^( 5) =       0.000549761773
  error estimate for blocks of size 2^( 6) =       0.000553958863
  error estimate for blocks of size 2^( 7) =       0.000558281056

      target function =      -0.747118953962
              le_mean =     -22.815552666446
             les_mean =     520.997202623774
             stat err =       0.000550254490
             autocorr =       1.352422854937
   target nu stat err =       0.000550254490
   target dn stat err =       0.003048789017
      target stat err =       0.002657647041
              std dev =       0.669148243881
             le_variance =       0.447759372288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747118953962        initial  <--
     6.2500e+06     6.2500e+07             1.8584e-10        -0.747118953960
     2.5000e+07     2.5000e+08             4.6460e-11        -0.747118953961
     1.0000e+08     1.0000e+09             1.1614e-11        -0.747118953962

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9028
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2033e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7171
    reference variance = 0.280206
====================================================
  Execution time = 4.5429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4824e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453544152739
                                         uncertainty =       0.005082713107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453544152739
                                         uncertainty =       0.005082713107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476219109
  error estimate for blocks of size 2^( 2) =       0.000501337347
  error estimate for blocks of size 2^( 3) =       0.000524064038
  error estimate for blocks of size 2^( 4) =       0.000541050066
  error estimate for blocks of size 2^( 5) =       0.000552731423
  error estimate for blocks of size 2^( 6) =       0.000558631819
  error estimate for blocks of size 2^( 7) =       0.000562746352

      target function =      -0.742223406537
              le_mean =     -22.815128779322
             les_mean =     520.983670269984
             stat err =       0.000553789915
             autocorr =       1.352310588352
   target nu stat err =       0.000553789915
   target dn stat err =       0.005041314210
      target stat err =       0.004259141548
              std dev =       0.673475522750
             le_variance =       0.453569279743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281512877932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742247034694       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742247034694       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742247034694       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742247034694       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742247034696       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742247093181       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742247014637       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742247030372       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742246922235       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742246994581       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742247042797       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742246813864       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742246957042       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742247127323       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742246835392       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742247253575       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742247206575       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742246961561       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742247057209       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742247073161       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742247072486       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742247147779       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742246995896       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742247050802       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742246947757       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742246977552       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742247002643       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742247020912       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742247136649       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742247199608       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742246743680       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742247226458       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742247036343       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+07 is 1.526975e-11

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742247034694       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742247034694       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742247034694       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742247026204       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742247032683       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742247365909       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742247270394       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742246886406       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742247196529       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742247029258       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742247007963       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742247203358       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742246592267       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742246485838       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742246648519       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742246924021       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742247043650       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742247144353       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742247229607       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742246693592       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742246518372       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742247107281       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742247069089       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742247113222       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742246294384       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742247592279       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742247700947       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742246769724       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742247127934       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742246743993       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742246284038       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742244113162       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742246600381       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+08 is 3.817435e-12

solving harmonic davidson linear method for identity shift 1.0000e+09, overlap shift 1.0000e+10 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742247034694       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742247034694       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742247034694       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742247034694       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742246808677       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742245689219       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742247265016       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742247814294       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742248780261       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742247319889       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742245772923       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742244494870       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742246925575       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742244990212       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742245922943       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742249680999       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742250387926       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742246484723       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742245518742       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742244853076       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742246142983       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742245332251       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742248294526       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742245828220       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742250237981       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742245562034       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742245114145       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742243917452       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742247596080       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742246674523       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742250595786       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742245137858       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742244479849       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742244893530       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+09 is 9.551395e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.546713 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0302e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7527
    reference variance = 0.355198
====================================================
  Execution time = 4.3296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5344e-01
  Total weights = 2.0000e+06
  Execution time = 3.5958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453400772020
                                         uncertainty =       0.005174167151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453400772020
                                         uncertainty =       0.005174167151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476151420
  error estimate for blocks of size 2^( 2) =       0.000500739623
  error estimate for blocks of size 2^( 3) =       0.000524418573
  error estimate for blocks of size 2^( 4) =       0.000541971047
  error estimate for blocks of size 2^( 5) =       0.000552430128
  error estimate for blocks of size 2^( 6) =       0.000558577773
  error estimate for blocks of size 2^( 7) =       0.000559419044

      target function =      -0.742333353054
              le_mean =     -22.814797388899
             les_mean =     520.968420019117
             stat err =       0.000553099498
             autocorr =       1.349324360744
   target nu stat err =       0.000553099498
   target dn stat err =       0.005664316879
      target stat err =       0.004773748036
              std dev =       0.673379795751
             le_variance =       0.453440349326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453400772021
                                         uncertainty =       0.005174167151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453400772021
                                         uncertainty =       0.005174167151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476151420
  error estimate for blocks of size 2^( 2) =       0.000500739623
  error estimate for blocks of size 2^( 3) =       0.000524418573
  error estimate for blocks of size 2^( 4) =       0.000541971047
  error estimate for blocks of size 2^( 5) =       0.000552430128
  error estimate for blocks of size 2^( 6) =       0.000558577773
  error estimate for blocks of size 2^( 7) =       0.000559419044

      target function =      -0.742333353053
              le_mean =     -22.814797388899
             les_mean =     520.968420019118
             stat err =       0.000553099498
             autocorr =       1.349324360729
   target nu stat err =       0.000553099498
   target dn stat err =       0.005664316879
      target stat err =       0.004773748036
              std dev =       0.673379795752
             le_variance =       0.453440349327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453400772020
                                         uncertainty =       0.005174167151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453400772020
                                         uncertainty =       0.005174167151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476151420
  error estimate for blocks of size 2^( 2) =       0.000500739623
  error estimate for blocks of size 2^( 3) =       0.000524418573
  error estimate for blocks of size 2^( 4) =       0.000541971047
  error estimate for blocks of size 2^( 5) =       0.000552430128
  error estimate for blocks of size 2^( 6) =       0.000558577773
  error estimate for blocks of size 2^( 7) =       0.000559419044

      target function =      -0.742333353053
              le_mean =     -22.814797388899
             les_mean =     520.968420019118
             stat err =       0.000553099498
             autocorr =       1.349324360740
   target nu stat err =       0.000553099498
   target dn stat err =       0.005664316879
      target stat err =       0.004773748036
              std dev =       0.673379795752
             le_variance =       0.453440349326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453400772020
                                         uncertainty =       0.005174167151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453400772020
                                         uncertainty =       0.005174167151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476151420
  error estimate for blocks of size 2^( 2) =       0.000500739623
  error estimate for blocks of size 2^( 3) =       0.000524418573
  error estimate for blocks of size 2^( 4) =       0.000541971047
  error estimate for blocks of size 2^( 5) =       0.000552430128
  error estimate for blocks of size 2^( 6) =       0.000558577773
  error estimate for blocks of size 2^( 7) =       0.000559419044

      target function =      -0.742333353054
              le_mean =     -22.814797388899
             les_mean =     520.968420019117
             stat err =       0.000553099498
             autocorr =       1.349324360733
   target nu stat err =       0.000553099498
   target dn stat err =       0.005664316879
      target stat err =       0.004773748036
              std dev =       0.673379795751
             le_variance =       0.453440349326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742333353054        initial  <--
     6.2500e+07     6.2500e+08             1.5270e-11        -0.742333353053
     2.5000e+08     2.5000e+09             3.8174e-12        -0.742333353053
     1.0000e+09     1.0000e+10             9.5514e-13        -0.742333353054

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2126
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2152e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8924
    reference variance = 0.564919
====================================================
  Execution time = 4.4155e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4151e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4977e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441316070823
                                         uncertainty =       0.002401353605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441316070823
                                         uncertainty =       0.002401353605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469844905
  error estimate for blocks of size 2^( 2) =       0.000495245741
  error estimate for blocks of size 2^( 3) =       0.000519071205
  error estimate for blocks of size 2^( 4) =       0.000536994113
  error estimate for blocks of size 2^( 5) =       0.000548297378
  error estimate for blocks of size 2^( 6) =       0.000554552498
  error estimate for blocks of size 2^( 7) =       0.000558311862

      target function =      -0.752460456884
              le_mean =     -22.815114546568
             les_mean =     520.970960021490
             stat err =       0.000549538963
             autocorr =       1.368005791968
   target nu stat err =       0.000549538963
   target dn stat err =       0.002478093597
      target stat err =       0.002218986970
              std dev =       0.664461036650
             le_variance =       0.441508469226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281511454657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752466010845       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752466010845       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752466010845       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752466010845       residual = 6.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752466161274       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752465953114       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752465983260       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752466389168       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752466675361       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752465883714       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.752467815706       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.752466457127       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.752466900210       residual = 8.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.752466188758       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.752466054145       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.752467567425       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.752467267513       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.752465644752       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752463667708       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.752464764167       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.752464300455       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.752466846166       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.752465365027       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.752463969787       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.752464429670       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.752465713112       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.752466878045       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.752465191971       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752466470222       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.752464638465       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.752464485954       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.752467610681       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.752468149510       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+08 is 1.869462e-12

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752466010845       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752466010845       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752466010845       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752466010846       residual = 6.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752465632309       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752466439531       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752469115335       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752462981172       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752465627658       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752470003647       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.752462301212       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.752471574600       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.752466612281       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.752471397858       residual = 7.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.752469674272       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.752465293590       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.752468854107       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.752462658889       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752470011396       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.752459096363       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.752466590507       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.752469563867       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.752467973562       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.752465949742       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.752462691726       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.752460191172       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.752473302842       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.752478023088       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752461620574       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.752459899504       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.752460489822       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.752472804468       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.752457607738       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.752461699179       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.752464110410       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 4.677257e-13

solving harmonic davidson linear method for identity shift 1.0000e+10, overlap shift 1.0000e+11 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752466010845       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752466010845       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752466010845       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752469177380       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752466012486       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752466010845       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752466010845       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752459040690       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752456446144       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752490815979       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.752458113533       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.752430229274       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.752489074117       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.752480303344       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.752461656215       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.752491741315       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.752460945177       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.752451375600       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752466227893       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.752432902886       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.752448129274       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.752463228674       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.752485658377       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.752466274962       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.752480160845       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.752438345326       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.752464467097       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.752485635854       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752450333381       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.752461518821       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.752482229387       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.752501197201       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.752486373015       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.752434634820       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.752484324040       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.752413988122       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.752465197639       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.752473037875       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.752478250111       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.752681416115       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.752306315667       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.752191602968       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.752519234794       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.752313080004       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.752330630540       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.752552116243       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.752411427192       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.751872522435       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.753568108412       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.752764074269       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.752071864379       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.752464965434       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.750609118662       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.751361934962       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.758891853999       residual = 1.96e-02           smallest_sin_value = 9.97e-01
davidson iteration   55 stopping due to small subspace S singular value of 8.48e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+10 is 1.167377e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.638313 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9233e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8837
    reference variance = 0.479363
====================================================
  Execution time = 4.3553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5600e-01
  Total weights = 2.0000e+06
  Execution time = 3.5967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455877322087
                                         uncertainty =       0.004528214239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455877322087
                                         uncertainty =       0.004528214239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477495345
  error estimate for blocks of size 2^( 2) =       0.000503111620
  error estimate for blocks of size 2^( 3) =       0.000526263425
  error estimate for blocks of size 2^( 4) =       0.000543354577
  error estimate for blocks of size 2^( 5) =       0.000553366236
  error estimate for blocks of size 2^( 6) =       0.000559873514
  error estimate for blocks of size 2^( 7) =       0.000563793956

      target function =      -0.740210219708
              le_mean =     -22.814618356494
             les_mean =     520.962814134331
             stat err =       0.000555097071
             autocorr =       1.351448766219
   target nu stat err =       0.000555097071
   target dn stat err =       0.004874820139
      target stat err =       0.004096511560
              std dev =       0.675280393496
             le_variance =       0.456003609840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455877322087
                                         uncertainty =       0.004528214239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455877322087
                                         uncertainty =       0.004528214239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477495345
  error estimate for blocks of size 2^( 2) =       0.000503111620
  error estimate for blocks of size 2^( 3) =       0.000526263425
  error estimate for blocks of size 2^( 4) =       0.000543354577
  error estimate for blocks of size 2^( 5) =       0.000553366236
  error estimate for blocks of size 2^( 6) =       0.000559873514
  error estimate for blocks of size 2^( 7) =       0.000563793956

      target function =      -0.740210219708
              le_mean =     -22.814618356494
             les_mean =     520.962814134331
             stat err =       0.000555097071
             autocorr =       1.351448766217
   target nu stat err =       0.000555097071
   target dn stat err =       0.004874820139
      target stat err =       0.004096511560
              std dev =       0.675280393496
             le_variance =       0.456003609840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455877322087
                                         uncertainty =       0.004528214239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455877322087
                                         uncertainty =       0.004528214239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477495345
  error estimate for blocks of size 2^( 2) =       0.000503111620
  error estimate for blocks of size 2^( 3) =       0.000526263425
  error estimate for blocks of size 2^( 4) =       0.000543354577
  error estimate for blocks of size 2^( 5) =       0.000553366236
  error estimate for blocks of size 2^( 6) =       0.000559873514
  error estimate for blocks of size 2^( 7) =       0.000563793956

      target function =      -0.740210219708
              le_mean =     -22.814618356494
             les_mean =     520.962814134331
             stat err =       0.000555097071
             autocorr =       1.351448766218
   target nu stat err =       0.000555097071
   target dn stat err =       0.004874820139
      target stat err =       0.004096511560
              std dev =       0.675280393496
             le_variance =       0.456003609840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455877322087
                                         uncertainty =       0.004528214239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455877322087
                                         uncertainty =       0.004528214239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477495345
  error estimate for blocks of size 2^( 2) =       0.000503111620
  error estimate for blocks of size 2^( 3) =       0.000526263425
  error estimate for blocks of size 2^( 4) =       0.000543354577
  error estimate for blocks of size 2^( 5) =       0.000553366236
  error estimate for blocks of size 2^( 6) =       0.000559873514
  error estimate for blocks of size 2^( 7) =       0.000563793956

      target function =      -0.740210219708
              le_mean =     -22.814618356494
             les_mean =     520.962814134331
             stat err =       0.000555097071
             autocorr =       1.351448766221
   target nu stat err =       0.000555097071
   target dn stat err =       0.004874820139
      target stat err =       0.004096511560
              std dev =       0.675280393496
             le_variance =       0.456003609840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740210219708        initial  <--
     6.2500e+08     6.2500e+09             1.8695e-12        -0.740210219708
     2.5000e+09     2.5000e+10             4.6773e-13        -0.740210219708
     1.0000e+10     1.0000e+11             1.1674e-13        -0.740210219708

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4857
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2073e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7244
    reference variance = 0.312248
====================================================
  Execution time = 4.3718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4344e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4794e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443517565447
                                         uncertainty =       0.002643792550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443517565447
                                         uncertainty =       0.002643792550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470869088
  error estimate for blocks of size 2^( 2) =       0.000495846664
  error estimate for blocks of size 2^( 3) =       0.000519753689
  error estimate for blocks of size 2^( 4) =       0.000537491863
  error estimate for blocks of size 2^( 5) =       0.000547647203
  error estimate for blocks of size 2^( 6) =       0.000555222878
  error estimate for blocks of size 2^( 7) =       0.000559431166

      target function =      -0.750808694044
              le_mean =     -22.814964676069
             les_mean =     520.966048344154
             stat err =       0.000549948278
             autocorr =       1.364090963912
   target nu stat err =       0.000549948278
   target dn stat err =       0.002864354481
      target stat err =       0.002527706351
              std dev =       0.665909449982
             le_variance =       0.443435395576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281496467607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750816269052       residual = 6.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750816269052       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750816269052       residual = 8.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750816269052       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750816269052       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750816313947       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750812375641       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750811370642       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750814408052       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750820496381       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750820720083       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750815473569       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750810476266       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750824605862       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750814316303       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750818202178       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750816685375       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750823722103       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750799996436       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750819990776       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750844654070       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750817352263       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750822925437       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750824280491       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750811614634       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750798877071       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750810454391       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750822593634       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750824089922       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750818953535       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750793621602       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750829271546       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750789765631       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750828941391       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750815685213       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750744262154       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750855841106       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750805287829       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750810458459       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750761076706       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750801310090       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750710594339       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750794222945       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750871100146       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750811917270       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750903478066       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.750807610925       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750643148828       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750802857311       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.750715318885       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.755174891056       residual = 8.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.751539069885       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.751585275308       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.750565962717       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.751227389976       residual = 7.54e-04           smallest_sin_value = 9.99e-01
davidson iteration   55 stopping due to small subspace S singular value of 8.45e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+09 is 1.733690e-13

solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750816269052       residual = 6.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750816269052       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750816269052       residual = 8.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750816269051       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750816269001       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750816506532       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750800865659       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750839519282       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750865620239       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750812881159       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750790080552       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750851849762       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750769379193       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750800458848       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750839845840       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750784570862       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750814946632       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750777375911       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750817249741       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750805251493       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750795871593       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750754229788       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750830017037       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750846729755       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750776311506       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750806701540       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750816827229       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750794781980       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750881501363       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750868311314       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.750839785937       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750759803944       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750818747039       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750812607999       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750796860777       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750813692700       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750864699364       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.750756412764       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750969799092       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750531492518       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750524877126       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750324243018       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.750619081901       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.751152086686       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.750569123083       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.751005379043       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.751201812880       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750625228624       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.750865942761       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.751962631714       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.753946465748       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.751274706031       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.757383270428       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.755745905126       residual = 1.18e-02           smallest_sin_value = 9.97e-01
davidson iteration   54 stopping due to small subspace S singular value of 8.63e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+10 is 4.295311e-14

solving harmonic davidson linear method for identity shift 1.0000e+11, overlap shift 1.0000e+12 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750816269052       residual = 6.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750816269052       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750816269052       residual = 8.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750816269052       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750816269052       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750827215492       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750813937377       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750961111881       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750778356286       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750751017995       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750866627224       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750697364367       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750716849271       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750836541601       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751087602098       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750685359902       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750929628085       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750885742059       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750877004606       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750741545389       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750457067767       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750864008959       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750627902114       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751105248594       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.750750590826       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751126720979       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750692557938       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750934664232       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751246260049       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.750683228317       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751301548179       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750854158768       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.751079004990       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.752011215557       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750272605109       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.750425404027       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750925723972       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.751189168933       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.750357315942       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.751073148366       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749636958911       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.750809992272       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.751245801841       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.749562598222       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.751384354278       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.752575847074       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748264271580       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.752713560762       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.749756534158       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.741458104268       residual = 5.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747899941789       residual = 3.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.743607312312       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748154072244       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.623991703914       residual = 8.76e+00           smallest_sin_value = 9.97e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+11 is 1.024084e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.809146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8693e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6981
    reference variance = 1.15391
====================================================
  Execution time = 4.5968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4378e-01
  Total weights = 2.0000e+06
  Execution time = 3.6043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443760579011
                                         uncertainty =       0.002098689100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443760579011
                                         uncertainty =       0.002098689100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471054728
  error estimate for blocks of size 2^( 2) =       0.000496158157
  error estimate for blocks of size 2^( 3) =       0.000519573927
  error estimate for blocks of size 2^( 4) =       0.000536941203
  error estimate for blocks of size 2^( 5) =       0.000548181999
  error estimate for blocks of size 2^( 6) =       0.000554217370
  error estimate for blocks of size 2^( 7) =       0.000555789918

      target function =      -0.750506987698
              le_mean =     -22.815356088139
             les_mean =     520.984258320822
             stat err =       0.000548782623
             autocorr =       1.357244112895
   target nu stat err =       0.000548782623
   target dn stat err =       0.002510976410
      target stat err =       0.002235478483
              std dev =       0.666171985408
             le_variance =       0.443785114143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443760579011
                                         uncertainty =       0.002098689100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443760579011
                                         uncertainty =       0.002098689100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471054728
  error estimate for blocks of size 2^( 2) =       0.000496158157
  error estimate for blocks of size 2^( 3) =       0.000519573927
  error estimate for blocks of size 2^( 4) =       0.000536941203
  error estimate for blocks of size 2^( 5) =       0.000548181999
  error estimate for blocks of size 2^( 6) =       0.000554217370
  error estimate for blocks of size 2^( 7) =       0.000555789918

      target function =      -0.750506987698
              le_mean =     -22.815356088139
             les_mean =     520.984258320822
             stat err =       0.000548782623
             autocorr =       1.357244112894
   target nu stat err =       0.000548782623
   target dn stat err =       0.002510976410
      target stat err =       0.002235478483
              std dev =       0.666171985408
             le_variance =       0.443785114143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443760579011
                                         uncertainty =       0.002098689100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443760579011
                                         uncertainty =       0.002098689100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471054728
  error estimate for blocks of size 2^( 2) =       0.000496158157
  error estimate for blocks of size 2^( 3) =       0.000519573927
  error estimate for blocks of size 2^( 4) =       0.000536941203
  error estimate for blocks of size 2^( 5) =       0.000548181999
  error estimate for blocks of size 2^( 6) =       0.000554217370
  error estimate for blocks of size 2^( 7) =       0.000555789918

      target function =      -0.750506987698
              le_mean =     -22.815356088139
             les_mean =     520.984258320822
             stat err =       0.000548782623
             autocorr =       1.357244112895
   target nu stat err =       0.000548782623
   target dn stat err =       0.002510976410
      target stat err =       0.002235478483
              std dev =       0.666171985408
             le_variance =       0.443785114143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443760579011
                                         uncertainty =       0.002098689100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443760579011
                                         uncertainty =       0.002098689100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471054728
  error estimate for blocks of size 2^( 2) =       0.000496158157
  error estimate for blocks of size 2^( 3) =       0.000519573927
  error estimate for blocks of size 2^( 4) =       0.000536941203
  error estimate for blocks of size 2^( 5) =       0.000548181999
  error estimate for blocks of size 2^( 6) =       0.000554217370
  error estimate for blocks of size 2^( 7) =       0.000555789918

      target function =      -0.750506987698
              le_mean =     -22.815356088139
             les_mean =     520.984258320822
             stat err =       0.000548782623
             autocorr =       1.357244112895
   target nu stat err =       0.000548782623
   target dn stat err =       0.002510976410
      target stat err =       0.002235478483
              std dev =       0.666171985408
             le_variance =       0.443785114143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750506987698        initial  <--
     6.2500e+09     6.2500e+10             1.7337e-13        -0.750506987698
     2.5000e+10     2.5000e+11             4.2953e-14        -0.750506987698
     1.0000e+11     1.0000e+12             1.0241e-14        -0.750506987698

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9385
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2264e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.9518
    reference variance = 0.445408
====================================================
  Execution time = 4.5245e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5437e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4922e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454365251417
                                         uncertainty =       0.004000422897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454365251417
                                         uncertainty =       0.004000422897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476637590
  error estimate for blocks of size 2^( 2) =       0.000501635434
  error estimate for blocks of size 2^( 3) =       0.000525012102
  error estimate for blocks of size 2^( 4) =       0.000542364244
  error estimate for blocks of size 2^( 5) =       0.000552666893
  error estimate for blocks of size 2^( 6) =       0.000557686075
  error estimate for blocks of size 2^( 7) =       0.000558741033

      target function =      -0.741548962390
              le_mean =     -22.815804048186
             les_mean =     521.015280922798
             stat err =       0.000552864561
             autocorr =       1.345429433221
   target nu stat err =       0.000552864561
   target dn stat err =       0.004040505618
      target stat err =       0.003431069107
              std dev =       0.674067344393
             le_variance =       0.454366784777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281580404819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741563750551       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741563750551       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741563750551       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741563750549       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741560027832       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741561168998       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741437816768       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741603001887       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741546732194       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741523257699       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741651659336       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741432164694       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741679607356       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741634807975       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741632472880       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741511497130       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741632142339       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741608779251       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741325174194       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741574585054       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741481488548       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741639395379       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741577079526       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741763846368       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741513526859       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741602781576       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741560280402       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741511600254       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741517419269       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741456093997       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741563197471       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741661202152       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741554379177       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.741151486934       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741100161220       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741576517604       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.740930746772       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741116448043       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741560174029       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741867284770       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.741877490438       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741166230053       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741412915668       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.740358446217       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741968709532       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.740092370457       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742541795459       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.743531495106       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.740810492227       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748525411390       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.740025629702       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.730411626268       residual = 5.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.742797726322       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.719317769581       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.708733073396       residual = 1.40e+00           smallest_sin_value = 9.95e-01
davidson iteration   55 stopping due to small subspace S singular value of 6.79e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+10 is 1.325883e-14

solving harmonic davidson linear method for identity shift 2.5000e+11, overlap shift 2.5000e+12 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741563750551       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741563750551       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741563750551       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741563750551       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741571276085       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741524397054       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741571378660       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742196514609       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742422457662       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741834079561       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741108466653       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741698489123       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741088964093       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741903245821       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742446052069       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741444231942       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741158904115       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740874916863       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741742183009       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741707699262       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741261416073       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741514079440       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739788432746       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740172292722       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743378739675       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741621980764       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741165055325       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742168432200       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741004002571       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742139603438       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740282198354       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742012607546       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741363296124       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742816118000       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.739928281046       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742100170975       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.738415833334       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743587162501       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.738971498420       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.738146664663       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742283584343       residual = 9.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.736959677866       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.739839204702       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.734509318939       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745878227447       residual = 9.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744196115386       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746235742978       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.732358386891       residual = 3.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743343126408       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.717525240419       residual = 3.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.769140879464       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.827793752285       residual = 3.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.664529026751       residual = 2.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.051714671382       residual = 4.83e+01           smallest_sin_value = 9.91e-01
davidson iteration   54 stopping due to small subspace S singular value of 7.64e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+11 is 2.678795e-15

solving harmonic davidson linear method for identity shift 1.0000e+12, overlap shift 1.0000e+13 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741563750551       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741563750551       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741563750551       residual = 6.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741563750551       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741563750436       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741563735909       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741462302437       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739734918633       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740308810430       residual = 7.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741338467028       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739439350606       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739109718559       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741166974893       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742455791373       residual = 7.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742818116986       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743484708057       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742150346107       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741272135532       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743019301473       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742099387279       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740601827398       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740464960929       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744423428617       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741482823887       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741418963360       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742709551852       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743198537854       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743437956445       residual = 4.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.738283383530       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.737141288797       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741462604819       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.735206138834       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.739453899357       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746671268603       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.737164343989       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.755071583861       residual = 9.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.751301268088       residual = 4.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749663328721       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.715376269991       residual = 3.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743289984504       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.769463061401       residual = 3.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.728623645365       residual = 9.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.751602110515       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.736714787745       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.732858132356       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.727802514822       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745127677880       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748060326991       residual = 7.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.824937903702       residual = 4.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.701681664768       residual = 8.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.546186422486       residual = 1.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.794130847908       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.816046389617       residual = 2.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.532159085877       residual = 3.29e+02           smallest_sin_value = 9.90e-01
davidson iteration   54 stopping due to small subspace S singular value of 6.43e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+12 is 1.526414e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.982993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0350e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7966
    reference variance = 0.267101
====================================================
  Execution time = 4.4901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5748e-01
  Total weights = 2.0000e+06
  Execution time = 4.0387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457407453391
                                         uncertainty =       0.011360882399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457407453391
                                         uncertainty =       0.011360882399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478266088
  error estimate for blocks of size 2^( 2) =       0.000503330721
  error estimate for blocks of size 2^( 3) =       0.000526577477
  error estimate for blocks of size 2^( 4) =       0.000542958609
  error estimate for blocks of size 2^( 5) =       0.000553937863
  error estimate for blocks of size 2^( 6) =       0.000562106113
  error estimate for blocks of size 2^( 7) =       0.000566116882

      target function =      -0.738888683113
              le_mean =     -22.814844720648
             les_mean =     520.974616300105
             stat err =       0.000556279867
             autocorr =       1.352843341415
   target nu stat err =       0.000556279867
   target dn stat err =       0.011117756045
      target stat err =       0.009226544673
              std dev =       0.676370387842
             le_variance =       0.457476901549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457407453391
                                         uncertainty =       0.011360882399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457407453391
                                         uncertainty =       0.011360882399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478266088
  error estimate for blocks of size 2^( 2) =       0.000503330721
  error estimate for blocks of size 2^( 3) =       0.000526577477
  error estimate for blocks of size 2^( 4) =       0.000542958609
  error estimate for blocks of size 2^( 5) =       0.000553937863
  error estimate for blocks of size 2^( 6) =       0.000562106113
  error estimate for blocks of size 2^( 7) =       0.000566116882

      target function =      -0.738888683113
              le_mean =     -22.814844720648
             les_mean =     520.974616300105
             stat err =       0.000556279867
             autocorr =       1.352843341415
   target nu stat err =       0.000556279867
   target dn stat err =       0.011117756045
      target stat err =       0.009226544673
              std dev =       0.676370387842
             le_variance =       0.457476901549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457407453391
                                         uncertainty =       0.011360882399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457407453391
                                         uncertainty =       0.011360882399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478266088
  error estimate for blocks of size 2^( 2) =       0.000503330721
  error estimate for blocks of size 2^( 3) =       0.000526577477
  error estimate for blocks of size 2^( 4) =       0.000542958609
  error estimate for blocks of size 2^( 5) =       0.000553937863
  error estimate for blocks of size 2^( 6) =       0.000562106113
  error estimate for blocks of size 2^( 7) =       0.000566116882

      target function =      -0.738888683113
              le_mean =     -22.814844720648
             les_mean =     520.974616300105
             stat err =       0.000556279867
             autocorr =       1.352843341415
   target nu stat err =       0.000556279867
   target dn stat err =       0.011117756045
      target stat err =       0.009226544673
              std dev =       0.676370387842
             le_variance =       0.457476901549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457407453391
                                         uncertainty =       0.011360882399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457407453391
                                         uncertainty =       0.011360882399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478266088
  error estimate for blocks of size 2^( 2) =       0.000503330721
  error estimate for blocks of size 2^( 3) =       0.000526577477
  error estimate for blocks of size 2^( 4) =       0.000542958609
  error estimate for blocks of size 2^( 5) =       0.000553937863
  error estimate for blocks of size 2^( 6) =       0.000562106113
  error estimate for blocks of size 2^( 7) =       0.000566116882

      target function =      -0.738888683113
              le_mean =     -22.814844720648
             les_mean =     520.974616300105
             stat err =       0.000556279867
             autocorr =       1.352843341411
   target nu stat err =       0.000556279867
   target dn stat err =       0.011117756045
      target stat err =       0.009226544673
              std dev =       0.676370387842
             le_variance =       0.457476901549


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738888683113        initial  <--
     6.2500e+10     6.2500e+11             1.3259e-14        -0.738888683113
     2.5000e+11     2.5000e+12             2.6788e-15        -0.738888683113
     1.0000e+12     1.0000e+13             1.5264e-16        -0.738888683113

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2448
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2360e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8482
    reference variance = 0.395624
====================================================
  Execution time = 4.5383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5866e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4613e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458722369911
                                         uncertainty =       0.006806073024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458722369911
                                         uncertainty =       0.006806073024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478882270
  error estimate for blocks of size 2^( 2) =       0.000503620500
  error estimate for blocks of size 2^( 3) =       0.000527889053
  error estimate for blocks of size 2^( 4) =       0.000545733690
  error estimate for blocks of size 2^( 5) =       0.000557224877
  error estimate for blocks of size 2^( 6) =       0.000562269294
  error estimate for blocks of size 2^( 7) =       0.000566596661

      target function =      -0.737982925118
              le_mean =     -22.814689858039
             les_mean =     520.968729546373
             stat err =       0.000557956131
             autocorr =       1.357508605298
   target nu stat err =       0.000557956131
   target dn stat err =       0.007381983580
      target stat err =       0.006127197012
              std dev =       0.677241801122
             le_variance =       0.458656457187


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281468985804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738032643745       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738032643745       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738032643745       residual = 9.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738032643745       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738032643475       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738032784095       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739402167850       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738317533939       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737667372875       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738287769585       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739195733071       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737446256387       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.737816166099       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.737920850310       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.737345290092       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738494532658       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.738244947922       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736920465181       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739920621117       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.738585752460       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.735468399142       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.738334552127       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742435594378       residual = 9.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.737933250829       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739940460413       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.738510513145       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736103595506       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743500472249       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736872516667       residual = 7.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.738901822199       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741007427728       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.739933139109       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.736228034533       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.730862284973       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.736013545118       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.736067996539       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742151462159       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.728995866593       residual = 4.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.725365996379       residual = 7.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.737727311731       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.720156365340       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.739172563352       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744802132979       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.734565118482       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.766813931634       residual = 4.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747016894999       residual = 4.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.729904201435       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.785693241398       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.662998136655       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.271420169070       residual = 1.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.753917711851       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.730564872903       residual = 7.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   52 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+11 is 1.258884e-15

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738032643745       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738032643745       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738032643745       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739276895191       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739466853435       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738641907847       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737775850299       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731779161522       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741315031948       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737689985566       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735512041336       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741848309373       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740795029143       residual = 8.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.733080626764       residual = 9.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.729049585049       residual = 4.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.732607259028       residual = 2.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.730304050308       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.735594068159       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740412641593       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.729133878513       residual = 4.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747500675095       residual = 4.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.732428914463       residual = 3.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743322113015       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750391897143       residual = 9.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734838588878       residual = 8.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.721990245928       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739948308956       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.738616890253       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752829745029       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.755305897155       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.702568042759       residual = 5.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.714871491356       residual = 2.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.757545443687       residual = 1.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.723704825564       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.737596666689       residual = 7.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.722966017401       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.690352453487       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.727205861480       residual = 6.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.721021572214       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748151487032       residual = 8.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.729148369829       residual = 5.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.694662531862       residual = 9.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.659158832716       residual = 3.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.780004633591       residual = 8.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742252189666       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.753316699176       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.800520878734       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.791773405985       residual = 7.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.359826733475       residual = 1.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -2.611123974710       residual = 1.85e+03           smallest_sin_value = 9.97e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+12 is 6.197898e-17

solving harmonic davidson linear method for identity shift 1.0000e+13, overlap shift 1.0000e+14 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738032643745       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738032643745       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.081130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0105e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7652
    reference variance = 0.42785
====================================================
  Execution time = 4.5135e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4392e-01
  Total weights = 2.0000e+06
  Execution time = 3.5993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443933395779
                                         uncertainty =       0.003035091842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443933395779
                                         uncertainty =       0.003035091842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471126121
  error estimate for blocks of size 2^( 2) =       0.000496166184
  error estimate for blocks of size 2^( 3) =       0.000519805367
  error estimate for blocks of size 2^( 4) =       0.000536715415
  error estimate for blocks of size 2^( 5) =       0.000548547632
  error estimate for blocks of size 2^( 6) =       0.000556102117
  error estimate for blocks of size 2^( 7) =       0.000558994761

      target function =      -0.750396871744
              le_mean =     -22.814642441163
             les_mean =     520.951829140242
             stat err =       0.000550089981
             autocorr =       1.363305235209
   target nu stat err =       0.000550089981
   target dn stat err =       0.003195777023
      target stat err =       0.002798781687
              std dev =       0.666272950154
             le_variance =       0.443919644107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443933395779
                                         uncertainty =       0.003035091842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443933395779
                                         uncertainty =       0.003035091842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471126121
  error estimate for blocks of size 2^( 2) =       0.000496166184
  error estimate for blocks of size 2^( 3) =       0.000519805367
  error estimate for blocks of size 2^( 4) =       0.000536715415
  error estimate for blocks of size 2^( 5) =       0.000548547632
  error estimate for blocks of size 2^( 6) =       0.000556102117
  error estimate for blocks of size 2^( 7) =       0.000558994761

      target function =      -0.750396871744
              le_mean =     -22.814642441163
             les_mean =     520.951829140242
             stat err =       0.000550089981
             autocorr =       1.363305235209
   target nu stat err =       0.000550089981
   target dn stat err =       0.003195777023
      target stat err =       0.002798781687
              std dev =       0.666272950154
             le_variance =       0.443919644107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443933395779
                                         uncertainty =       0.003035091842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443933395779
                                         uncertainty =       0.003035091842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471126121
  error estimate for blocks of size 2^( 2) =       0.000496166184
  error estimate for blocks of size 2^( 3) =       0.000519805367
  error estimate for blocks of size 2^( 4) =       0.000536715415
  error estimate for blocks of size 2^( 5) =       0.000548547632
  error estimate for blocks of size 2^( 6) =       0.000556102117
  error estimate for blocks of size 2^( 7) =       0.000558994761

      target function =      -0.750396871744
              le_mean =     -22.814642441163
             les_mean =     520.951829140242
             stat err =       0.000550089981
             autocorr =       1.363305235203
   target nu stat err =       0.000550089981
   target dn stat err =       0.003195777023
      target stat err =       0.002798781687
              std dev =       0.666272950154
             le_variance =       0.443919644107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443933395779
                                         uncertainty =       0.003035091842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443933395779
                                         uncertainty =       0.003035091842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471126121
  error estimate for blocks of size 2^( 2) =       0.000496166184
  error estimate for blocks of size 2^( 3) =       0.000519805367
  error estimate for blocks of size 2^( 4) =       0.000536715415
  error estimate for blocks of size 2^( 5) =       0.000548547632
  error estimate for blocks of size 2^( 6) =       0.000556102117
  error estimate for blocks of size 2^( 7) =       0.000558994761

      target function =      -0.750396871744
              le_mean =     -22.814642441163
             les_mean =     520.951829140242
             stat err =       0.000550089981
             autocorr =       1.363305235209
   target nu stat err =       0.000550089981
   target dn stat err =       0.003195777023
      target stat err =       0.002798781687
              std dev =       0.666272950154
             le_variance =       0.443919644107


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750396871744        initial
     6.2500e+11     6.2500e+12             1.2589e-15        -0.750396871744
     2.5000e+12     2.5000e+13             6.1979e-17        -0.750396871744  <--
     1.0000e+13     1.0000e+14             0.0000e+00        -0.750396871744

*****************************************************************************
Applying the update for shift_i =   2.5000e+12     and shift_s =   2.5000e+13
*****************************************************************************

  Execution time = 6.3094e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2321e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.9314
    reference variance = 0.350695
====================================================
  Execution time = 4.6227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5162e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4825e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451632884993
                                         uncertainty =       0.007539709547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451632884993
                                         uncertainty =       0.007539709547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475193763
  error estimate for blocks of size 2^( 2) =       0.000500543773
  error estimate for blocks of size 2^( 3) =       0.000523833453
  error estimate for blocks of size 2^( 4) =       0.000541016984
  error estimate for blocks of size 2^( 5) =       0.000553015093
  error estimate for blocks of size 2^( 6) =       0.000558415055
  error estimate for blocks of size 2^( 7) =       0.000561941807

      target function =      -0.743825287547
              le_mean =     -22.815125590238
             les_mean =     520.981573698006
             stat err =       0.000553597235
             autocorr =       1.357207840409
   target nu stat err =       0.000553597235
   target dn stat err =       0.007699807138
      target stat err =       0.006493244530
              std dev =       0.672025464912
             le_variance =       0.451618225490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281512559024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743881327950       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743881327950       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743881327950       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743881327950       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743881327950       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743881327950       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743881327950       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745182783588       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743975299253       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744569565951       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742856156715       residual = 8.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745672614844       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742513438239       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742993236715       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743460932793       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743336008554       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745190664444       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743273043940       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744246643674       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743368574763       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.733999848565       residual = 4.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742366836244       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742148865401       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743502322849       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743517669718       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743390179440       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745206789454       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739419413915       residual = 9.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741962674887       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744193337829       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736659698366       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749844660266       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740779376423       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.751015406752       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743297134359       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742710765746       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741820131638       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.739053203807       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.732911629112       residual = 5.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.751589330903       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749110699111       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741761673602       residual = 3.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.753400932479       residual = 4.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747699090590       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.757634609411       residual = 8.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.696421977658       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745130897832       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.770301591152       residual = 4.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.742352043793       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.703423356824       residual = 7.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.556742327708       residual = 1.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.827571193560       residual = 3.36e+00           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.714998796179       residual = 6.20e+00           smallest_sin_value = 9.92e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+11 is 1.589463e-15

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743881327950       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743881327950       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743881327950       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743912108974       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745976755203       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745475181443       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743224685494       residual = 9.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743451764090       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744915578820       residual = 7.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745672934739       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745667341377       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744765074947       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.738504093636       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740941047989       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751666255418       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.753692466456       residual = 5.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741172765114       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746132444492       residual = 7.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739785602895       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743000728382       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744834423444       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739064326284       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736121925844       residual = 4.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745033929380       residual = 4.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739975363826       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748206088935       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743211621993       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.731142468869       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742156955856       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.713339890784       residual = 4.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743015354438       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.724287954242       residual = 2.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740525307797       residual = 9.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.756159380888       residual = 7.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.751632491739       residual = 6.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.739075840374       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.727425193877       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.773320024411       residual = 4.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.719706625700       residual = 3.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.778817869778       residual = 6.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.733051257777       residual = 1.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.754233834113       residual = 5.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.715071863600       residual = 4.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748902973008       residual = 6.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.707596461851       residual = 8.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.681372560806       residual = 3.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.772960898909       residual = 3.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.677081820538       residual = 1.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.631180269486       residual = 6.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.505241089278       residual = 2.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.539480301284       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.375174534561       residual = 2.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -3.746762110498       residual = 4.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -2.999965225308       residual = 2.33e+03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =       0.078975725191       residual = 4.52e+02           smallest_sin_value = 9.92e-01
davidson iteration   55 stopping due to small subspace S singular value of 6.96e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+12 is 1.036466e-16

solving harmonic davidson linear method for identity shift 1.0000e+13, overlap shift 1.0000e+14 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743881327950       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743881327950       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.198566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1180e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7645
    reference variance = 0.388397
====================================================
  Execution time = 4.3166e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6203e-01
  Total weights = 2.0000e+06
  Execution time = 3.5955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462084865459
                                         uncertainty =       0.006394249133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462084865459
                                         uncertainty =       0.006394249133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480641611
  error estimate for blocks of size 2^( 2) =       0.000505475435
  error estimate for blocks of size 2^( 3) =       0.000528708589
  error estimate for blocks of size 2^( 4) =       0.000546236982
  error estimate for blocks of size 2^( 5) =       0.000556878615
  error estimate for blocks of size 2^( 6) =       0.000564606928
  error estimate for blocks of size 2^( 7) =       0.000567615145

      target function =      -0.735229519981
              le_mean =     -22.814277938768
             les_mean =     520.953310353261
             stat err =       0.000558834418
             autocorr =       1.351834599683
   target nu stat err =       0.000558834418
   target dn stat err =       0.006626682582
      target stat err =       0.005463025899
              std dev =       0.679729885278
             le_variance =       0.462032716939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462084865459
                                         uncertainty =       0.006394249133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462084865459
                                         uncertainty =       0.006394249133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480641611
  error estimate for blocks of size 2^( 2) =       0.000505475435
  error estimate for blocks of size 2^( 3) =       0.000528708589
  error estimate for blocks of size 2^( 4) =       0.000546236982
  error estimate for blocks of size 2^( 5) =       0.000556878615
  error estimate for blocks of size 2^( 6) =       0.000564606928
  error estimate for blocks of size 2^( 7) =       0.000567615145

      target function =      -0.735229519981
              le_mean =     -22.814277938768
             les_mean =     520.953310353261
             stat err =       0.000558834418
             autocorr =       1.351834599681
   target nu stat err =       0.000558834418
   target dn stat err =       0.006626682582
      target stat err =       0.005463025899
              std dev =       0.679729885278
             le_variance =       0.462032716939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462084865459
                                         uncertainty =       0.006394249133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462084865459
                                         uncertainty =       0.006394249133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480641611
  error estimate for blocks of size 2^( 2) =       0.000505475435
  error estimate for blocks of size 2^( 3) =       0.000528708589
  error estimate for blocks of size 2^( 4) =       0.000546236982
  error estimate for blocks of size 2^( 5) =       0.000556878615
  error estimate for blocks of size 2^( 6) =       0.000564606928
  error estimate for blocks of size 2^( 7) =       0.000567615145

      target function =      -0.735229519981
              le_mean =     -22.814277938768
             les_mean =     520.953310353261
             stat err =       0.000558834418
             autocorr =       1.351834599681
   target nu stat err =       0.000558834418
   target dn stat err =       0.006626682582
      target stat err =       0.005463025899
              std dev =       0.679729885278
             le_variance =       0.462032716939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462084865459
                                         uncertainty =       0.006394249133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462084865459
                                         uncertainty =       0.006394249133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480641611
  error estimate for blocks of size 2^( 2) =       0.000505475435
  error estimate for blocks of size 2^( 3) =       0.000528708589
  error estimate for blocks of size 2^( 4) =       0.000546236982
  error estimate for blocks of size 2^( 5) =       0.000556878615
  error estimate for blocks of size 2^( 6) =       0.000564606928
  error estimate for blocks of size 2^( 7) =       0.000567615145

      target function =      -0.735229519981
              le_mean =     -22.814277938768
             les_mean =     520.953310353261
             stat err =       0.000558834418
             autocorr =       1.351834599683
   target nu stat err =       0.000558834418
   target dn stat err =       0.006626682582
      target stat err =       0.005463025899
              std dev =       0.679729885278
             le_variance =       0.462032716939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.735229519981        initial  <--
     6.2500e+11     6.2500e+12             1.5895e-15        -0.735229519981
     2.5000e+12     2.5000e+13             1.0365e-16        -0.735229519981
     1.0000e+13     1.0000e+14             0.0000e+00        -0.735229519981

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0929
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2228e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.782
    reference variance = 0.678615
====================================================
  Execution time = 4.6253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4915e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4955e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449136752074
                                         uncertainty =       0.003344081494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449136752074
                                         uncertainty =       0.003344081494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473891895
  error estimate for blocks of size 2^( 2) =       0.000499251276
  error estimate for blocks of size 2^( 3) =       0.000522322450
  error estimate for blocks of size 2^( 4) =       0.000539559118
  error estimate for blocks of size 2^( 5) =       0.000551101766
  error estimate for blocks of size 2^( 6) =       0.000557633924
  error estimate for blocks of size 2^( 7) =       0.000562185038

      target function =      -0.745973057238
              le_mean =     -22.813869614778
             les_mean =     520.921793631795
             stat err =       0.000552619962
             autocorr =       1.359861175651
   target nu stat err =       0.000552619962
   target dn stat err =       0.003410610855
      target stat err =       0.002940737294
              std dev =       0.670184345005
             le_variance =       0.449147056290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281386961478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745983684634       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745983684634       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.40e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+13, overlap shift 2.5000e+14 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745983684634       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745983684634       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+14, overlap shift 1.0000e+15 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745983684634       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745983684634       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.199653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1220e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.9213
    reference variance = 0.321753
====================================================
  Execution time = 4.3944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4886e-01
  Total weights = 2.0000e+06
  Execution time = 3.6020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448751311412
                                         uncertainty =       0.003436007842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448751311412
                                         uncertainty =       0.003436007842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473739515
  error estimate for blocks of size 2^( 2) =       0.000498799767
  error estimate for blocks of size 2^( 3) =       0.000522350389
  error estimate for blocks of size 2^( 4) =       0.000539204979
  error estimate for blocks of size 2^( 5) =       0.000550051321
  error estimate for blocks of size 2^( 6) =       0.000554982702
  error estimate for blocks of size 2^( 7) =       0.000556971712

      target function =      -0.746195345311
              le_mean =     -22.814999722910
             les_mean =     520.973070387417
             stat err =       0.000550302679
             autocorr =       1.349348193188
   target nu stat err =       0.000550302679
   target dn stat err =       0.003659340028
      target stat err =       0.003152573603
              std dev =       0.669968846652
             le_variance =       0.448858255485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448751311412
                                         uncertainty =       0.003436007842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448751311412
                                         uncertainty =       0.003436007842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473739515
  error estimate for blocks of size 2^( 2) =       0.000498799767
  error estimate for blocks of size 2^( 3) =       0.000522350389
  error estimate for blocks of size 2^( 4) =       0.000539204979
  error estimate for blocks of size 2^( 5) =       0.000550051321
  error estimate for blocks of size 2^( 6) =       0.000554982702
  error estimate for blocks of size 2^( 7) =       0.000556971712

      target function =      -0.746195345311
              le_mean =     -22.814999722910
             les_mean =     520.973070387417
             stat err =       0.000550302679
             autocorr =       1.349348193188
   target nu stat err =       0.000550302679
   target dn stat err =       0.003659340028
      target stat err =       0.003152573603
              std dev =       0.669968846652
             le_variance =       0.448858255485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448751311412
                                         uncertainty =       0.003436007842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448751311412
                                         uncertainty =       0.003436007842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473739515
  error estimate for blocks of size 2^( 2) =       0.000498799767
  error estimate for blocks of size 2^( 3) =       0.000522350389
  error estimate for blocks of size 2^( 4) =       0.000539204979
  error estimate for blocks of size 2^( 5) =       0.000550051321
  error estimate for blocks of size 2^( 6) =       0.000554982702
  error estimate for blocks of size 2^( 7) =       0.000556971712

      target function =      -0.746195345311
              le_mean =     -22.814999722910
             les_mean =     520.973070387417
             stat err =       0.000550302679
             autocorr =       1.349348193188
   target nu stat err =       0.000550302679
   target dn stat err =       0.003659340028
      target stat err =       0.003152573603
              std dev =       0.669968846652
             le_variance =       0.448858255485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448751311412
                                         uncertainty =       0.003436007842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448751311412
                                         uncertainty =       0.003436007842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473739515
  error estimate for blocks of size 2^( 2) =       0.000498799767
  error estimate for blocks of size 2^( 3) =       0.000522350389
  error estimate for blocks of size 2^( 4) =       0.000539204979
  error estimate for blocks of size 2^( 5) =       0.000550051321
  error estimate for blocks of size 2^( 6) =       0.000554982702
  error estimate for blocks of size 2^( 7) =       0.000556971712

      target function =      -0.746195345311
              le_mean =     -22.814999722910
             les_mean =     520.973070387417
             stat err =       0.000550302679
             autocorr =       1.349348193188
   target nu stat err =       0.000550302679
   target dn stat err =       0.003659340028
      target stat err =       0.003152573603
              std dev =       0.669968846652
             le_variance =       0.448858255485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746195345311        initial  <--
     6.2500e+12     6.2500e+13             0.0000e+00        -0.746195345311
     2.5000e+13     2.5000e+14             0.0000e+00        -0.746195345311
     1.0000e+14     1.0000e+15             0.0000e+00        -0.746195345311

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8980
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2312e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8727
    reference variance = 0.479562
====================================================
  Execution time = 4.4654e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4911e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4827e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449122778188
                                         uncertainty =       0.003952364568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449122778188
                                         uncertainty =       0.003952364568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473874710
  error estimate for blocks of size 2^( 2) =       0.000499345155
  error estimate for blocks of size 2^( 3) =       0.000522648020
  error estimate for blocks of size 2^( 4) =       0.000539598396
  error estimate for blocks of size 2^( 5) =       0.000552216669
  error estimate for blocks of size 2^( 6) =       0.000559479202
  error estimate for blocks of size 2^( 7) =       0.000563022065

      target function =      -0.746002398583
              le_mean =     -22.813560172271
             les_mean =     520.907641990650
             stat err =       0.000553579083
             autocorr =       1.364684567638
   target nu stat err =       0.000553579083
   target dn stat err =       0.003850413853
      target stat err =       0.003302727774
              std dev =       0.670160041606
             le_variance =       0.449114481365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281356017227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746016152389       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746016152389       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746016152389       residual = 8.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746016152389       residual = 3.59e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.729237418598       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890789463802       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.761666901653       residual = 4.68e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.709285517390       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.647617195002       residual = 5.45e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.621750275779       residual = 7.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.702231582886       residual = 2.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.847730786740       residual = 8.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916369435586       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751554815106       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918215282282       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.514839418628       residual = 2.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949241836646       residual = 2.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.641278511077       residual = 6.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.634104670852       residual = 7.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.811966342613       residual = 2.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.752426909253       residual = 1.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.863033444852       residual = 6.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.004336755118       residual = 3.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.061702003781       residual = 1.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.194403385618       residual = 9.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.814759359614       residual = 2.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.913267978856       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.407877838921       residual = 5.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741671374849       residual = 4.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.292442584921       residual = 1.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.132922602279       residual = 1.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.046152890582       residual = 3.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.164627182411       residual = 9.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.304515008770       residual = 2.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.655019173786       residual = 4.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.044032858241       residual = 2.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.087802991077       residual = 8.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.497871107459       residual = 6.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.363352714084       residual = 7.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.529660153774       residual = 5.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.284032073022       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.204755954109       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.102640943099       residual = 7.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.578859197794       residual = 5.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.675158341482       residual = 4.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.598613492025       residual = 3.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -2.266076372668       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =       1.366594500423       residual = 3.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -5.758344106008       residual = 1.07e+04           smallest_sin_value = 1.00e+00
davidson iteration   49 stopping due to too large eigenvalue change
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+13 is 1.519911e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+14, overlap shift 2.5000e+15 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746016152389       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746016152389       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746016152389       residual = 7.40e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746016152389       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.755849183080       residual = 8.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746017589344       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.700819195220       residual = 9.47e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.808868226084       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.609268082410       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.840892924047       residual = 5.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.660912151829       residual = 5.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.757335608613       residual = 2.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.169606401412       residual = 1.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.854936350214       residual = 5.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       2.447673230103       residual = 4.79e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.024100944111       residual = 5.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       0.844686344200       residual = 1.39e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -2.044887715600       residual = 8.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.469602543385       residual = 5.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.065253560908       residual = 8.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.019794039955       residual = 1.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.569801329346       residual = 3.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.408348272996       residual = 2.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.497616277007       residual = 3.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.310125395209       residual = 1.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.817898866722       residual = 6.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.332176803057       residual = 1.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       0.591013533407       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.029728146957       residual = 1.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       3.631962595579       residual = 9.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.666305316858       residual = 1.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.838960128750       residual = 2.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -6.639314677793       residual = 1.67e+04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.271490256725       residual = 1.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -4.993059228772       residual = 8.64e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -2.456286339748       residual = 1.43e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -2.345271504225       residual = 1.78e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       0.182366836789       residual = 1.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       2.612408882979       residual = 5.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       1.735341534382       residual = 3.98e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -5.953553691344       residual = 1.35e+04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -5.665762487314       residual = 1.32e+04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =       4.992288541059       residual = 1.63e+04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =       0.344647071226       residual = 1.96e+03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       2.542160915637       residual = 6.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =       8.200958789225       residual = 3.68e+04           smallest_sin_value = 1.00e+00
davidson iteration   46 stopping due to too large eigenvalue change
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+14 is 7.332814e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+15, overlap shift 1.0000e+16 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746016152389       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746016152389       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746016152389       residual = 3.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.971855421922       residual = 2.39e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.692640027220       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.594588600920       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.245731662616       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.234564471650       residual = 3.02e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.073072389841       residual = 2.59e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.309825400904       residual = 4.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       0.490127205744       residual = 1.44e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -2.328185180335       residual = 1.59e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.309123700343       residual = 5.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -2.807554493322       residual = 2.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       2.995848654597       residual = 6.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.713489110289       residual = 7.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -2.467563837332       residual = 1.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.637216418090       residual = 2.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -8.221770153909       residual = 2.67e+04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.752579868529       residual = 1.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.220797918004       residual = 2.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -2.676963021600       residual = 2.65e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -7.662857527512       residual = 2.28e+04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       0.141245140980       residual = 6.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -3.199174781604       residual = 3.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -3.377705304031       residual = 5.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -2.454609306679       residual = 1.59e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -3.348851794634       residual = 5.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -4.001982239724       residual = 6.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       3.244047627774       residual = 1.00e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       5.036064982388       residual = 1.66e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -4.806290539989       residual = 9.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -5.421030266698       residual = 1.09e+04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       2.754521564124       residual = 9.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       8.517957923208       residual = 4.36e+04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -6.826843270708       residual = 2.11e+04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       2.750085964008       residual = 1.54e+04           smallest_sin_value = 1.00e+00
davidson iteration   37 stopping due to too large eigenvalue change
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+15 is 9.499442e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.302691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1197e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8398
    reference variance = 0.411885
====================================================
  Execution time = 4.3525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4635e-01
  Total weights = 2.0000e+06
  Execution time = 3.5920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446381771529
                                         uncertainty =       0.002751111814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446381771529
                                         uncertainty =       0.002751111814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472411579
  error estimate for blocks of size 2^( 2) =       0.000497975254
  error estimate for blocks of size 2^( 3) =       0.000521748516
  error estimate for blocks of size 2^( 4) =       0.000539632628
  error estimate for blocks of size 2^( 5) =       0.000549740177
  error estimate for blocks of size 2^( 6) =       0.000556943498
  error estimate for blocks of size 2^( 7) =       0.000559798140

      target function =      -0.748327676857
              le_mean =     -22.815149489371
             les_mean =     520.977391398721
             stat err =       0.000551528611
             autocorr =       1.362997394346
   target nu stat err =       0.000551528611
   target dn stat err =       0.002606874097
      target stat err =       0.002301488466
              std dev =       0.668090861752
             le_variance =       0.446345399556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446381771529
                                         uncertainty =       0.002751111814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446381771529
                                         uncertainty =       0.002751111814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472411579
  error estimate for blocks of size 2^( 2) =       0.000497975254
  error estimate for blocks of size 2^( 3) =       0.000521748516
  error estimate for blocks of size 2^( 4) =       0.000539632628
  error estimate for blocks of size 2^( 5) =       0.000549740177
  error estimate for blocks of size 2^( 6) =       0.000556943498
  error estimate for blocks of size 2^( 7) =       0.000559798140

      target function =      -0.748327676857
              le_mean =     -22.815149489371
             les_mean =     520.977391398721
             stat err =       0.000551528611
             autocorr =       1.362997394346
   target nu stat err =       0.000551528611
   target dn stat err =       0.002606874097
      target stat err =       0.002301488466
              std dev =       0.668090861752
             le_variance =       0.446345399556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446381771529
                                         uncertainty =       0.002751111814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446381771529
                                         uncertainty =       0.002751111814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472411579
  error estimate for blocks of size 2^( 2) =       0.000497975254
  error estimate for blocks of size 2^( 3) =       0.000521748516
  error estimate for blocks of size 2^( 4) =       0.000539632628
  error estimate for blocks of size 2^( 5) =       0.000549740177
  error estimate for blocks of size 2^( 6) =       0.000556943498
  error estimate for blocks of size 2^( 7) =       0.000559798140

      target function =      -0.748327676857
              le_mean =     -22.815149489371
             les_mean =     520.977391398721
             stat err =       0.000551528611
             autocorr =       1.362997394346
   target nu stat err =       0.000551528611
   target dn stat err =       0.002606874097
      target stat err =       0.002301488466
              std dev =       0.668090861752
             le_variance =       0.446345399556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446381771529
                                         uncertainty =       0.002751111814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446381771529
                                         uncertainty =       0.002751111814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472411579
  error estimate for blocks of size 2^( 2) =       0.000497975254
  error estimate for blocks of size 2^( 3) =       0.000521748516
  error estimate for blocks of size 2^( 4) =       0.000539632628
  error estimate for blocks of size 2^( 5) =       0.000549740177
  error estimate for blocks of size 2^( 6) =       0.000556943498
  error estimate for blocks of size 2^( 7) =       0.000559798140

      target function =      -0.748327676857
              le_mean =     -22.815149489371
             les_mean =     520.977391398721
             stat err =       0.000551528611
             autocorr =       1.362997394346
   target nu stat err =       0.000551528611
   target dn stat err =       0.002606874097
      target stat err =       0.002301488466
              std dev =       0.668090861752
             le_variance =       0.446345399556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748327676857        initial  <--
     6.2500e+13     6.2500e+14             1.5199e-18        -0.748327676857
     2.5000e+14     2.5000e+15             7.3328e-19        -0.748327676857
     1.0000e+15     1.0000e+16             9.4994e-20        -0.748327676857

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4401
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2264e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8002
    reference variance = 0.491089
====================================================
  Execution time = 4.3648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4769e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447680811099
                                         uncertainty =       0.002865391214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447680811099
                                         uncertainty =       0.002865391214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473107682
  error estimate for blocks of size 2^( 2) =       0.000498171098
  error estimate for blocks of size 2^( 3) =       0.000521632678
  error estimate for blocks of size 2^( 4) =       0.000539655281
  error estimate for blocks of size 2^( 5) =       0.000550496334
  error estimate for blocks of size 2^( 6) =       0.000555572287
  error estimate for blocks of size 2^( 7) =       0.000559524824

      target function =      -0.747210914709
              le_mean =     -22.814991664697
             les_mean =     520.971506193969
             stat err =       0.000551312181
             autocorr =       1.357923102334
   target nu stat err =       0.000551312181
   target dn stat err =       0.003090522818
      target stat err =       0.002690666703
              std dev =       0.669075300403
             le_variance =       0.447661757610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281499166470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747219727277       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747219727277       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+15, overlap shift 2.5000e+16 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747219727277       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747219727277       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747219727277       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -1.029132105340       residual = 3.64e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.194816006049       residual = 9.33e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -2.120305553746       residual = 3.21e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       1.100769600825       residual = 2.03e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.204372642186       residual = 3.17e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       0.421186385085       residual = 2.09e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.163495544992       residual = 1.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -2.047287600934       residual = 1.73e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.557259609634       residual = 1.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =       1.507018514837       residual = 3.56e+03           smallest_sin_value = 1.00e+00
davidson iteration   13 stopping due to too large eigenvalue change
davidson solver did not converge after         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+15 is 2.437570e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+16, overlap shift 1.0000e+17 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747219727277       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747219727277       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747219727277       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747219727277       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+16 is 2.076210e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.305764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8430e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.819
    reference variance = 0.257901
====================================================
  Execution time = 4.5168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4545e-01
  Total weights = 2.0000e+06
  Execution time = 3.5949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445516052583
                                         uncertainty =       0.002784711677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445516052583
                                         uncertainty =       0.002784711677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471937653
  error estimate for blocks of size 2^( 2) =       0.000497041146
  error estimate for blocks of size 2^( 3) =       0.000520491295
  error estimate for blocks of size 2^( 4) =       0.000538116784
  error estimate for blocks of size 2^( 5) =       0.000549210723
  error estimate for blocks of size 2^( 6) =       0.000555804522
  error estimate for blocks of size 2^( 7) =       0.000559804884

      target function =      -0.749097626317
              le_mean =     -22.814361380457
             les_mean =     520.940535271727
             stat err =       0.000550734229
             autocorr =       1.361804865387
   target nu stat err =       0.000550734229
   target dn stat err =       0.002956800883
      target stat err =       0.002590685737
              std dev =       0.667420629268
             le_variance =       0.445450296373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445516052583
                                         uncertainty =       0.002784711677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445516052583
                                         uncertainty =       0.002784711677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471937653
  error estimate for blocks of size 2^( 2) =       0.000497041146
  error estimate for blocks of size 2^( 3) =       0.000520491295
  error estimate for blocks of size 2^( 4) =       0.000538116784
  error estimate for blocks of size 2^( 5) =       0.000549210723
  error estimate for blocks of size 2^( 6) =       0.000555804522
  error estimate for blocks of size 2^( 7) =       0.000559804884

      target function =      -0.749097626317
              le_mean =     -22.814361380457
             les_mean =     520.940535271727
             stat err =       0.000550734229
             autocorr =       1.361804865387
   target nu stat err =       0.000550734229
   target dn stat err =       0.002956800883
      target stat err =       0.002590685737
              std dev =       0.667420629268
             le_variance =       0.445450296373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445516052583
                                         uncertainty =       0.002784711677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445516052583
                                         uncertainty =       0.002784711677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471937653
  error estimate for blocks of size 2^( 2) =       0.000497041146
  error estimate for blocks of size 2^( 3) =       0.000520491295
  error estimate for blocks of size 2^( 4) =       0.000538116784
  error estimate for blocks of size 2^( 5) =       0.000549210723
  error estimate for blocks of size 2^( 6) =       0.000555804522
  error estimate for blocks of size 2^( 7) =       0.000559804884

      target function =      -0.749097626317
              le_mean =     -22.814361380457
             les_mean =     520.940535271727
             stat err =       0.000550734229
             autocorr =       1.361804865387
   target nu stat err =       0.000550734229
   target dn stat err =       0.002956800883
      target stat err =       0.002590685737
              std dev =       0.667420629268
             le_variance =       0.445450296373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445516052583
                                         uncertainty =       0.002784711677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445516052583
                                         uncertainty =       0.002784711677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471937653
  error estimate for blocks of size 2^( 2) =       0.000497041146
  error estimate for blocks of size 2^( 3) =       0.000520491295
  error estimate for blocks of size 2^( 4) =       0.000538116784
  error estimate for blocks of size 2^( 5) =       0.000549210723
  error estimate for blocks of size 2^( 6) =       0.000555804522
  error estimate for blocks of size 2^( 7) =       0.000559804884

      target function =      -0.749097626317
              le_mean =     -22.814361380457
             les_mean =     520.940535271727
             stat err =       0.000550734229
             autocorr =       1.361804865387
   target nu stat err =       0.000550734229
   target dn stat err =       0.002956800883
      target stat err =       0.002590685737
              std dev =       0.667420629268
             le_variance =       0.445450296373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749097626317        initial  <--
     6.2500e+14     6.2500e+15             0.0000e+00        -0.749097626317
     2.5000e+15     2.5000e+16             2.4376e-20        -0.749097626317
     1.0000e+16     1.0000e+17             2.0762e-20        -0.749097626317

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0946
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2153e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8773
    reference variance = 0.406919
====================================================
  Execution time = 4.3848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5344e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4834e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453419627642
                                         uncertainty =       0.006401934905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453419627642
                                         uncertainty =       0.006401934905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476152072
  error estimate for blocks of size 2^( 2) =       0.000501306122
  error estimate for blocks of size 2^( 3) =       0.000524913649
  error estimate for blocks of size 2^( 4) =       0.000542292672
  error estimate for blocks of size 2^( 5) =       0.000553553509
  error estimate for blocks of size 2^( 6) =       0.000559206013
  error estimate for blocks of size 2^( 7) =       0.000559779693

      target function =      -0.742312380825
              le_mean =     -22.815391132252
             les_mean =     520.995513881929
             stat err =       0.000553707972
             autocorr =       1.352291117685
   target nu stat err =       0.000553707972
   target dn stat err =       0.006156340082
      target stat err =       0.005186138321
              std dev =       0.673380717717
             le_variance =       0.453441590993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281539113225e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+15, overlap shift 6.2500e+16 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742347416051       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742347416051       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+16, overlap shift 2.5000e+17 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742347416051       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742347416051       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+17, overlap shift 1.0000e+18 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742347416051       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742347416051       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.306895 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8694e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7149
    reference variance = 0.378089
====================================================
  Execution time = 4.3246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4720e-01
  Total weights = 2.0000e+06
  Execution time = 3.5998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447013651877
                                         uncertainty =       0.002443875188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447013651877
                                         uncertainty =       0.002443875188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472862572
  error estimate for blocks of size 2^( 2) =       0.000498435629
  error estimate for blocks of size 2^( 3) =       0.000521786475
  error estimate for blocks of size 2^( 4) =       0.000538744051
  error estimate for blocks of size 2^( 5) =       0.000548256614
  error estimate for blocks of size 2^( 6) =       0.000555248235
  error estimate for blocks of size 2^( 7) =       0.000559153415

      target function =      -0.747597579120
              le_mean =     -22.815491131039
             les_mean =     520.993833350487
             stat err =       0.000550350579
             autocorr =       1.354593461586
   target nu stat err =       0.000550350579
   target dn stat err =       0.002759101292
      target stat err =       0.002422529785
              std dev =       0.668728662135
             le_variance =       0.447198023561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447013651877
                                         uncertainty =       0.002443875188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447013651877
                                         uncertainty =       0.002443875188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472862572
  error estimate for blocks of size 2^( 2) =       0.000498435629
  error estimate for blocks of size 2^( 3) =       0.000521786475
  error estimate for blocks of size 2^( 4) =       0.000538744051
  error estimate for blocks of size 2^( 5) =       0.000548256614
  error estimate for blocks of size 2^( 6) =       0.000555248235
  error estimate for blocks of size 2^( 7) =       0.000559153415

      target function =      -0.747597579120
              le_mean =     -22.815491131039
             les_mean =     520.993833350487
             stat err =       0.000550350579
             autocorr =       1.354593461586
   target nu stat err =       0.000550350579
   target dn stat err =       0.002759101292
      target stat err =       0.002422529785
              std dev =       0.668728662135
             le_variance =       0.447198023561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447013651877
                                         uncertainty =       0.002443875188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447013651877
                                         uncertainty =       0.002443875188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472862572
  error estimate for blocks of size 2^( 2) =       0.000498435629
  error estimate for blocks of size 2^( 3) =       0.000521786475
  error estimate for blocks of size 2^( 4) =       0.000538744051
  error estimate for blocks of size 2^( 5) =       0.000548256614
  error estimate for blocks of size 2^( 6) =       0.000555248235
  error estimate for blocks of size 2^( 7) =       0.000559153415

      target function =      -0.747597579120
              le_mean =     -22.815491131039
             les_mean =     520.993833350487
             stat err =       0.000550350579
             autocorr =       1.354593461586
   target nu stat err =       0.000550350579
   target dn stat err =       0.002759101292
      target stat err =       0.002422529785
              std dev =       0.668728662135
             le_variance =       0.447198023561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447013651877
                                         uncertainty =       0.002443875188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447013651877
                                         uncertainty =       0.002443875188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472862572
  error estimate for blocks of size 2^( 2) =       0.000498435629
  error estimate for blocks of size 2^( 3) =       0.000521786475
  error estimate for blocks of size 2^( 4) =       0.000538744051
  error estimate for blocks of size 2^( 5) =       0.000548256614
  error estimate for blocks of size 2^( 6) =       0.000555248235
  error estimate for blocks of size 2^( 7) =       0.000559153415

      target function =      -0.747597579120
              le_mean =     -22.815491131039
             les_mean =     520.993833350487
             stat err =       0.000550350579
             autocorr =       1.354593461586
   target nu stat err =       0.000550350579
   target dn stat err =       0.002759101292
      target stat err =       0.002422529785
              std dev =       0.668728662135
             le_variance =       0.447198023561


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747597579120        initial  <--
     6.2500e+15     6.2500e+16             0.0000e+00        -0.747597579120
     2.5000e+16     2.5000e+17             0.0000e+00        -0.747597579120
     1.0000e+17     1.0000e+18             0.0000e+00        -0.747597579120

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4708
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2117e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7871
    reference variance = 0.399252
====================================================
  Execution time = 4.5093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4803e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4944e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448082262539
                                         uncertainty =       0.002676101411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448082262539
                                         uncertainty =       0.002676101411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473304456
  error estimate for blocks of size 2^( 2) =       0.000498499116
  error estimate for blocks of size 2^( 3) =       0.000522101939
  error estimate for blocks of size 2^( 4) =       0.000538338483
  error estimate for blocks of size 2^( 5) =       0.000549376519
  error estimate for blocks of size 2^( 6) =       0.000557873517
  error estimate for blocks of size 2^( 7) =       0.000561405420

      target function =      -0.746903059492
              le_mean =     -22.814724007014
             les_mean =     520.959665508423
             stat err =       0.000551748485
             autocorr =       1.358942595137
   target nu stat err =       0.000551748485
   target dn stat err =       0.002585616514
      target stat err =       0.002274353406
              std dev =       0.669353580867
             le_variance =       0.448034216219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472400701e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+16, overlap shift 6.2500e+17 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746908965148       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746908965148       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746908965148       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746908965148       residual = 1.64e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746908964976       residual = 3.19e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       2.749871160129       residual = 5.65e+03           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+16 is 2.508604e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+17, overlap shift 2.5000e+18 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746908965148       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746908965148       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746908965148       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746908965148       residual = 1.79e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.537439947887       residual = 9.95e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746706125393       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+17 is 6.271510e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+18, overlap shift 1.0000e+19 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746908965148       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746908965148       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746908965148       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746908965148       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+18 is 1.567877e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.308995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0050e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.819
    reference variance = 0.501369
====================================================
  Execution time = 4.3437e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5241e-01
  Total weights = 2.0000e+06
  Execution time = 3.5847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452385483716
                                         uncertainty =       0.003675237474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452385483716
                                         uncertainty =       0.003675237474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475608517
  error estimate for blocks of size 2^( 2) =       0.000501025534
  error estimate for blocks of size 2^( 3) =       0.000523931011
  error estimate for blocks of size 2^( 4) =       0.000540773140
  error estimate for blocks of size 2^( 5) =       0.000551200663
  error estimate for blocks of size 2^( 6) =       0.000558654472
  error estimate for blocks of size 2^( 7) =       0.000560150665

      target function =      -0.743200557203
              le_mean =     -22.815420862502
             les_mean =     520.995835829155
             stat err =       0.000552694735
             autocorr =       1.350427921838
   target nu stat err =       0.000552694735
   target dn stat err =       0.003719228306
      target stat err =       0.003179562841
              std dev =       0.672612014678
             le_variance =       0.452406922289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452385483716
                                         uncertainty =       0.003675237474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452385483716
                                         uncertainty =       0.003675237474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475608517
  error estimate for blocks of size 2^( 2) =       0.000501025534
  error estimate for blocks of size 2^( 3) =       0.000523931011
  error estimate for blocks of size 2^( 4) =       0.000540773140
  error estimate for blocks of size 2^( 5) =       0.000551200663
  error estimate for blocks of size 2^( 6) =       0.000558654472
  error estimate for blocks of size 2^( 7) =       0.000560150665

      target function =      -0.743200557203
              le_mean =     -22.815420862502
             les_mean =     520.995835829155
             stat err =       0.000552694735
             autocorr =       1.350427921836
   target nu stat err =       0.000552694735
   target dn stat err =       0.003719228306
      target stat err =       0.003179562841
              std dev =       0.672612014678
             le_variance =       0.452406922289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452385483716
                                         uncertainty =       0.003675237474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452385483716
                                         uncertainty =       0.003675237474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475608517
  error estimate for blocks of size 2^( 2) =       0.000501025534
  error estimate for blocks of size 2^( 3) =       0.000523931011
  error estimate for blocks of size 2^( 4) =       0.000540773140
  error estimate for blocks of size 2^( 5) =       0.000551200663
  error estimate for blocks of size 2^( 6) =       0.000558654472
  error estimate for blocks of size 2^( 7) =       0.000560150665

      target function =      -0.743200557203
              le_mean =     -22.815420862502
             les_mean =     520.995835829155
             stat err =       0.000552694735
             autocorr =       1.350427921836
   target nu stat err =       0.000552694735
   target dn stat err =       0.003719228306
      target stat err =       0.003179562841
              std dev =       0.672612014678
             le_variance =       0.452406922289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452385483716
                                         uncertainty =       0.003675237474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452385483716
                                         uncertainty =       0.003675237474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475608517
  error estimate for blocks of size 2^( 2) =       0.000501025534
  error estimate for blocks of size 2^( 3) =       0.000523931011
  error estimate for blocks of size 2^( 4) =       0.000540773140
  error estimate for blocks of size 2^( 5) =       0.000551200663
  error estimate for blocks of size 2^( 6) =       0.000558654472
  error estimate for blocks of size 2^( 7) =       0.000560150665

      target function =      -0.743200557203
              le_mean =     -22.815420862502
             les_mean =     520.995835829155
             stat err =       0.000552694735
             autocorr =       1.350427921836
   target nu stat err =       0.000552694735
   target dn stat err =       0.003719228306
      target stat err =       0.003179562841
              std dev =       0.672612014678
             le_variance =       0.452406922289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743200557203        initial  <--
     6.2500e+16     6.2500e+17             2.5086e-21        -0.743200557203
     2.5000e+17     2.5000e+18             6.2715e-22        -0.743200557203
     1.0000e+18     1.0000e+19             1.5679e-22        -0.743200557203

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3203
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2138e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7995
    reference variance = 0.333275
====================================================
  Execution time = 4.5805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4735e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4926e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447393002537
                                         uncertainty =       0.002974933875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447393002537
                                         uncertainty =       0.002974933875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472942361
  error estimate for blocks of size 2^( 2) =       0.000498514034
  error estimate for blocks of size 2^( 3) =       0.000521871347
  error estimate for blocks of size 2^( 4) =       0.000539522559
  error estimate for blocks of size 2^( 5) =       0.000551121425
  error estimate for blocks of size 2^( 6) =       0.000558725555
  error estimate for blocks of size 2^( 7) =       0.000561365414

      target function =      -0.747479519616
              le_mean =     -22.814797585777
             les_mean =     520.962337610107
             stat err =       0.000552683738
             autocorr =       1.365642242826
   target nu stat err =       0.000552683738
   target dn stat err =       0.003036422124
      target stat err =       0.002647562957
              std dev =       0.668841501255
             le_variance =       0.447348953801


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281479758578e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+17, overlap shift 6.2500e+18 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747487832806       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747487832806       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+18, overlap shift 2.5000e+19 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747487832806       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747487832806       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+19, overlap shift 1.0000e+20 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747487832806       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747487832806       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.310073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0742e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8016
    reference variance = 0.278842
====================================================
  Execution time = 4.2936e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5721e-01
  Total weights = 2.0000e+06
  Execution time = 3.6008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457240869679
                                         uncertainty =       0.006108243897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457240869679
                                         uncertainty =       0.006108243897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478126194
  error estimate for blocks of size 2^( 2) =       0.000503401839
  error estimate for blocks of size 2^( 3) =       0.000526345722
  error estimate for blocks of size 2^( 4) =       0.000543903899
  error estimate for blocks of size 2^( 5) =       0.000554679848
  error estimate for blocks of size 2^( 6) =       0.000560553441
  error estimate for blocks of size 2^( 7) =       0.000561966317

      target function =      -0.739206377623
              le_mean =     -22.814168526266
             les_mean =     520.943494631082
             stat err =       0.000555275876
             autocorr =       1.348753355868
   target nu stat err =       0.000555275876
   target dn stat err =       0.006375234946
      target stat err =       0.005313753819
              std dev =       0.676172548120
             le_variance =       0.457209314831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457240869679
                                         uncertainty =       0.006108243897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457240869679
                                         uncertainty =       0.006108243897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478126194
  error estimate for blocks of size 2^( 2) =       0.000503401839
  error estimate for blocks of size 2^( 3) =       0.000526345722
  error estimate for blocks of size 2^( 4) =       0.000543903899
  error estimate for blocks of size 2^( 5) =       0.000554679848
  error estimate for blocks of size 2^( 6) =       0.000560553441
  error estimate for blocks of size 2^( 7) =       0.000561966317

      target function =      -0.739206377623
              le_mean =     -22.814168526266
             les_mean =     520.943494631082
             stat err =       0.000555275876
             autocorr =       1.348753355864
   target nu stat err =       0.000555275876
   target dn stat err =       0.006375234946
      target stat err =       0.005313753819
              std dev =       0.676172548120
             le_variance =       0.457209314831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457240869679
                                         uncertainty =       0.006108243897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457240869679
                                         uncertainty =       0.006108243897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478126194
  error estimate for blocks of size 2^( 2) =       0.000503401839
  error estimate for blocks of size 2^( 3) =       0.000526345722
  error estimate for blocks of size 2^( 4) =       0.000543903899
  error estimate for blocks of size 2^( 5) =       0.000554679848
  error estimate for blocks of size 2^( 6) =       0.000560553441
  error estimate for blocks of size 2^( 7) =       0.000561966317

      target function =      -0.739206377623
              le_mean =     -22.814168526266
             les_mean =     520.943494631082
             stat err =       0.000555275876
             autocorr =       1.348753355864
   target nu stat err =       0.000555275876
   target dn stat err =       0.006375234946
      target stat err =       0.005313753819
              std dev =       0.676172548120
             le_variance =       0.457209314831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457240869679
                                         uncertainty =       0.006108243897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457240869679
                                         uncertainty =       0.006108243897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478126194
  error estimate for blocks of size 2^( 2) =       0.000503401839
  error estimate for blocks of size 2^( 3) =       0.000526345722
  error estimate for blocks of size 2^( 4) =       0.000543903899
  error estimate for blocks of size 2^( 5) =       0.000554679848
  error estimate for blocks of size 2^( 6) =       0.000560553441
  error estimate for blocks of size 2^( 7) =       0.000561966317

      target function =      -0.739206377623
              le_mean =     -22.814168526266
             les_mean =     520.943494631082
             stat err =       0.000555275876
             autocorr =       1.348753355864
   target nu stat err =       0.000555275876
   target dn stat err =       0.006375234946
      target stat err =       0.005313753819
              std dev =       0.676172548120
             le_variance =       0.457209314831


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739206377623        initial  <--
     6.2500e+17     6.2500e+18             0.0000e+00        -0.739206377623
     2.5000e+18     2.5000e+19             0.0000e+00        -0.739206377623
     1.0000e+19     1.0000e+20             0.0000e+00        -0.739206377623

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8877
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2164e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.912
    reference variance = 0.549604
====================================================
  Execution time = 4.4429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5221e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5001e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452242726898
                                         uncertainty =       0.004240648457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452242726898
                                         uncertainty =       0.004240648457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475506705
  error estimate for blocks of size 2^( 2) =       0.000500615507
  error estimate for blocks of size 2^( 3) =       0.000524350951
  error estimate for blocks of size 2^( 4) =       0.000542484944
  error estimate for blocks of size 2^( 5) =       0.000552553602
  error estimate for blocks of size 2^( 6) =       0.000557792731
  error estimate for blocks of size 2^( 7) =       0.000563201152

      target function =      -0.743384554094
              le_mean =     -22.814312987039
             les_mean =     520.945090097384
             stat err =       0.000554008107
             autocorr =       1.357434708678
   target nu stat err =       0.000554008107
   target dn stat err =       0.004100997401
      target stat err =       0.003490065366
              std dev =       0.672468031131
             le_variance =       0.452213252893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281431298704e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+18, overlap shift 6.2500e+19 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743399862035       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743399862035       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+19, overlap shift 2.5000e+20 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743399862035       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743399862035       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+20, overlap shift 1.0000e+21 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743399862035       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743399862035       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.311178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9441e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7778
    reference variance = 0.433348
====================================================
  Execution time = 4.3080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4641e-01
  Total weights = 2.0000e+06
  Execution time = 3.5984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446301761960
                                         uncertainty =       0.003576218899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446301761960
                                         uncertainty =       0.003576218899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472445457
  error estimate for blocks of size 2^( 2) =       0.000497934487
  error estimate for blocks of size 2^( 3) =       0.000521762144
  error estimate for blocks of size 2^( 4) =       0.000538591434
  error estimate for blocks of size 2^( 5) =       0.000548609632
  error estimate for blocks of size 2^( 6) =       0.000554494367
  error estimate for blocks of size 2^( 7) =       0.000559518687

      target function =      -0.748269918060
              le_mean =     -22.815219356421
             les_mean =     520.980643478229
             stat err =       0.000550303530
             autocorr =       1.356754413977
   target nu stat err =       0.000550303530
   target dn stat err =       0.003039280019
      target stat err =       0.002656428391
              std dev =       0.668138772897
             le_variance =       0.446409419849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446301761960
                                         uncertainty =       0.003576218899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446301761960
                                         uncertainty =       0.003576218899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472445457
  error estimate for blocks of size 2^( 2) =       0.000497934487
  error estimate for blocks of size 2^( 3) =       0.000521762144
  error estimate for blocks of size 2^( 4) =       0.000538591434
  error estimate for blocks of size 2^( 5) =       0.000548609632
  error estimate for blocks of size 2^( 6) =       0.000554494367
  error estimate for blocks of size 2^( 7) =       0.000559518687

      target function =      -0.748269918060
              le_mean =     -22.815219356421
             les_mean =     520.980643478229
             stat err =       0.000550303530
             autocorr =       1.356754413977
   target nu stat err =       0.000550303530
   target dn stat err =       0.003039280019
      target stat err =       0.002656428391
              std dev =       0.668138772897
             le_variance =       0.446409419849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446301761960
                                         uncertainty =       0.003576218899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446301761960
                                         uncertainty =       0.003576218899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472445457
  error estimate for blocks of size 2^( 2) =       0.000497934487
  error estimate for blocks of size 2^( 3) =       0.000521762144
  error estimate for blocks of size 2^( 4) =       0.000538591434
  error estimate for blocks of size 2^( 5) =       0.000548609632
  error estimate for blocks of size 2^( 6) =       0.000554494367
  error estimate for blocks of size 2^( 7) =       0.000559518687

      target function =      -0.748269918060
              le_mean =     -22.815219356421
             les_mean =     520.980643478229
             stat err =       0.000550303530
             autocorr =       1.356754413977
   target nu stat err =       0.000550303530
   target dn stat err =       0.003039280019
      target stat err =       0.002656428391
              std dev =       0.668138772897
             le_variance =       0.446409419849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446301761960
                                         uncertainty =       0.003576218899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446301761960
                                         uncertainty =       0.003576218899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472445457
  error estimate for blocks of size 2^( 2) =       0.000497934487
  error estimate for blocks of size 2^( 3) =       0.000521762144
  error estimate for blocks of size 2^( 4) =       0.000538591434
  error estimate for blocks of size 2^( 5) =       0.000548609632
  error estimate for blocks of size 2^( 6) =       0.000554494367
  error estimate for blocks of size 2^( 7) =       0.000559518687

      target function =      -0.748269918060
              le_mean =     -22.815219356421
             les_mean =     520.980643478229
             stat err =       0.000550303530
             autocorr =       1.356754413977
   target nu stat err =       0.000550303530
   target dn stat err =       0.003039280019
      target stat err =       0.002656428391
              std dev =       0.668138772897
             le_variance =       0.446409419849


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748269918060        initial  <--
     6.2500e+18     6.2500e+19             0.0000e+00        -0.748269918060
     2.5000e+19     2.5000e+20             0.0000e+00        -0.748269918060
     1.0000e+20     1.0000e+21             0.0000e+00        -0.748269918060

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0416
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2049e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8904
    reference variance = 0.363593
====================================================
  Execution time = 4.4213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4507e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4548e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445007846997
                                         uncertainty =       0.003288531821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445007846997
                                         uncertainty =       0.003288531821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471734274
  error estimate for blocks of size 2^( 2) =       0.000496815510
  error estimate for blocks of size 2^( 3) =       0.000520159598
  error estimate for blocks of size 2^( 4) =       0.000538474174
  error estimate for blocks of size 2^( 5) =       0.000549428491
  error estimate for blocks of size 2^( 6) =       0.000553859515
  error estimate for blocks of size 2^( 7) =       0.000558122561

      target function =      -0.749408504926
              le_mean =     -22.815416951695
             les_mean =     520.988316908041
             stat err =       0.000549971185
             autocorr =       1.359205143625
   target nu stat err =       0.000549971185
   target dn stat err =       0.003246380022
      target stat err =       0.002836904499
              std dev =       0.667133008405
             le_variance =       0.445066450903


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281541695169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+19, overlap shift 6.2500e+20 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749418147351       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749418147351       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+20, overlap shift 2.5000e+21 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749418147351       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749418147351       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+21, overlap shift 1.0000e+22 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749418147351       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749418147351       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.312276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8772e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8486
    reference variance = 0.545523
====================================================
  Execution time = 4.5058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4624e-01
  Total weights = 2.0000e+06
  Execution time = 3.5949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446124070598
                                         uncertainty =       0.004146039685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446124070598
                                         uncertainty =       0.004146039685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472357342
  error estimate for blocks of size 2^( 2) =       0.000497434296
  error estimate for blocks of size 2^( 3) =       0.000520210635
  error estimate for blocks of size 2^( 4) =       0.000537943256
  error estimate for blocks of size 2^( 5) =       0.000548485877
  error estimate for blocks of size 2^( 6) =       0.000554447004
  error estimate for blocks of size 2^( 7) =       0.000557989027

      target function =      -0.748409007424
              le_mean =     -22.814793775876
             les_mean =     520.961057730258
             stat err =       0.000549716291
             autocorr =       1.354365475383
   target nu stat err =       0.000549716291
   target dn stat err =       0.004241831790
      target stat err =       0.003656167058
              std dev =       0.668014159737
             le_variance =       0.446242917610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446124070598
                                         uncertainty =       0.004146039685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446124070598
                                         uncertainty =       0.004146039685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472357342
  error estimate for blocks of size 2^( 2) =       0.000497434296
  error estimate for blocks of size 2^( 3) =       0.000520210635
  error estimate for blocks of size 2^( 4) =       0.000537943256
  error estimate for blocks of size 2^( 5) =       0.000548485877
  error estimate for blocks of size 2^( 6) =       0.000554447004
  error estimate for blocks of size 2^( 7) =       0.000557989027

      target function =      -0.748409007424
              le_mean =     -22.814793775876
             les_mean =     520.961057730258
             stat err =       0.000549716291
             autocorr =       1.354365475383
   target nu stat err =       0.000549716291
   target dn stat err =       0.004241831790
      target stat err =       0.003656167058
              std dev =       0.668014159737
             le_variance =       0.446242917610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446124070598
                                         uncertainty =       0.004146039685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446124070598
                                         uncertainty =       0.004146039685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472357342
  error estimate for blocks of size 2^( 2) =       0.000497434296
  error estimate for blocks of size 2^( 3) =       0.000520210635
  error estimate for blocks of size 2^( 4) =       0.000537943256
  error estimate for blocks of size 2^( 5) =       0.000548485877
  error estimate for blocks of size 2^( 6) =       0.000554447004
  error estimate for blocks of size 2^( 7) =       0.000557989027

      target function =      -0.748409007424
              le_mean =     -22.814793775876
             les_mean =     520.961057730258
             stat err =       0.000549716291
             autocorr =       1.354365475383
   target nu stat err =       0.000549716291
   target dn stat err =       0.004241831790
      target stat err =       0.003656167058
              std dev =       0.668014159737
             le_variance =       0.446242917610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446124070598
                                         uncertainty =       0.004146039685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446124070598
                                         uncertainty =       0.004146039685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472357342
  error estimate for blocks of size 2^( 2) =       0.000497434296
  error estimate for blocks of size 2^( 3) =       0.000520210635
  error estimate for blocks of size 2^( 4) =       0.000537943256
  error estimate for blocks of size 2^( 5) =       0.000548485877
  error estimate for blocks of size 2^( 6) =       0.000554447004
  error estimate for blocks of size 2^( 7) =       0.000557989027

      target function =      -0.748409007424
              le_mean =     -22.814793775876
             les_mean =     520.961057730258
             stat err =       0.000549716291
             autocorr =       1.354365475383
   target nu stat err =       0.000549716291
   target dn stat err =       0.004241831790
      target stat err =       0.003656167058
              std dev =       0.668014159737
             le_variance =       0.446242917610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748409007424        initial  <--
     6.2500e+19     6.2500e+20             0.0000e+00        -0.748409007424
     2.5000e+20     2.5000e+21             0.0000e+00        -0.748409007424
     1.0000e+21     1.0000e+22             0.0000e+00        -0.748409007424

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0038
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2178e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8977
    reference variance = 0.684976
====================================================
  Execution time = 4.3890e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4766e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452348376494
                                         uncertainty =       0.004645030519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452348376494
                                         uncertainty =       0.004645030519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475593516
  error estimate for blocks of size 2^( 2) =       0.000500552149
  error estimate for blocks of size 2^( 3) =       0.000523986654
  error estimate for blocks of size 2^( 4) =       0.000541319105
  error estimate for blocks of size 2^( 5) =       0.000550965371
  error estimate for blocks of size 2^( 6) =       0.000556424691
  error estimate for blocks of size 2^( 7) =       0.000558310439

      target function =      -0.743221537996
              le_mean =     -22.815192370592
             les_mean =     520.985381065126
             stat err =       0.000551754901
             autocorr =       1.345924039826
   target nu stat err =       0.000551754901
   target dn stat err =       0.004754190941
      target stat err =       0.004032632045
              std dev =       0.672590799968
             le_variance =       0.452378384202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281519237059e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+20, overlap shift 6.2500e+21 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743242240105       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743242240105       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743242240105       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+20 is 1.688446e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+21, overlap shift 2.5000e+22 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743242240105       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743242240105       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743242240105       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+21 is 4.221115e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+22, overlap shift 1.0000e+23 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743242240105       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743242240105       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743242240105       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743242240105       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+22 is 1.852597e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.313729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8668e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8665
    reference variance = 0.407636
====================================================
  Execution time = 4.3330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5470e-01
  Total weights = 2.0000e+06
  Execution time = 3.5963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454746955492
                                         uncertainty =       0.007264611740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454746955492
                                         uncertainty =       0.007264611740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476811514
  error estimate for blocks of size 2^( 2) =       0.000501934103
  error estimate for blocks of size 2^( 3) =       0.000524898270
  error estimate for blocks of size 2^( 4) =       0.000542907359
  error estimate for blocks of size 2^( 5) =       0.000553746158
  error estimate for blocks of size 2^( 6) =       0.000560390361
  error estimate for blocks of size 2^( 7) =       0.000563474295

      target function =      -0.741262143158
              le_mean =     -22.814994854874
             les_mean =     520.978688441168
             stat err =       0.000555129543
             autocorr =       1.355486548801
   target nu stat err =       0.000555129543
   target dn stat err =       0.007062511901
      target stat err =       0.005919151690
              std dev =       0.674313310416
             le_variance =       0.454698440604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454746955492
                                         uncertainty =       0.007264611740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454746955492
                                         uncertainty =       0.007264611740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476811514
  error estimate for blocks of size 2^( 2) =       0.000501934103
  error estimate for blocks of size 2^( 3) =       0.000524898270
  error estimate for blocks of size 2^( 4) =       0.000542907359
  error estimate for blocks of size 2^( 5) =       0.000553746158
  error estimate for blocks of size 2^( 6) =       0.000560390361
  error estimate for blocks of size 2^( 7) =       0.000563474295

      target function =      -0.741262143158
              le_mean =     -22.814994854874
             les_mean =     520.978688441168
             stat err =       0.000555129543
             autocorr =       1.355486548806
   target nu stat err =       0.000555129543
   target dn stat err =       0.007062511901
      target stat err =       0.005919151690
              std dev =       0.674313310416
             le_variance =       0.454698440604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454746955492
                                         uncertainty =       0.007264611740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454746955492
                                         uncertainty =       0.007264611740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476811514
  error estimate for blocks of size 2^( 2) =       0.000501934103
  error estimate for blocks of size 2^( 3) =       0.000524898270
  error estimate for blocks of size 2^( 4) =       0.000542907359
  error estimate for blocks of size 2^( 5) =       0.000553746158
  error estimate for blocks of size 2^( 6) =       0.000560390361
  error estimate for blocks of size 2^( 7) =       0.000563474295

      target function =      -0.741262143158
              le_mean =     -22.814994854874
             les_mean =     520.978688441168
             stat err =       0.000555129543
             autocorr =       1.355486548806
   target nu stat err =       0.000555129543
   target dn stat err =       0.007062511901
      target stat err =       0.005919151690
              std dev =       0.674313310416
             le_variance =       0.454698440604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454746955492
                                         uncertainty =       0.007264611740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454746955492
                                         uncertainty =       0.007264611740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476811514
  error estimate for blocks of size 2^( 2) =       0.000501934103
  error estimate for blocks of size 2^( 3) =       0.000524898270
  error estimate for blocks of size 2^( 4) =       0.000542907359
  error estimate for blocks of size 2^( 5) =       0.000553746158
  error estimate for blocks of size 2^( 6) =       0.000560390361
  error estimate for blocks of size 2^( 7) =       0.000563474295

      target function =      -0.741262143158
              le_mean =     -22.814994854874
             les_mean =     520.978688441168
             stat err =       0.000555129543
             autocorr =       1.355486548806
   target nu stat err =       0.000555129543
   target dn stat err =       0.007062511901
      target stat err =       0.005919151690
              std dev =       0.674313310416
             le_variance =       0.454698440604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741262143158        initial  <--
     6.2500e+20     6.2500e+21             1.6884e-25        -0.741262143158
     2.5000e+21     2.5000e+22             4.2211e-26        -0.741262143158
     1.0000e+22     1.0000e+23             1.8526e-26        -0.741262143158

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3227
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2200e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8575
    reference variance = 0.370486
====================================================
  Execution time = 4.4324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4673e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442315219711
                                         uncertainty =       0.002584565744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442315219711
                                         uncertainty =       0.002584565744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470237310
  error estimate for blocks of size 2^( 2) =       0.000495647600
  error estimate for blocks of size 2^( 3) =       0.000518907759
  error estimate for blocks of size 2^( 4) =       0.000536435379
  error estimate for blocks of size 2^( 5) =       0.000547335654
  error estimate for blocks of size 2^( 6) =       0.000551677165
  error estimate for blocks of size 2^( 7) =       0.000552679375

      target function =      -0.751831131916
              le_mean =     -22.814681605721
             les_mean =     520.951942804009
             stat err =       0.000547031893
             autocorr =       1.353290791619
   target nu stat err =       0.000547031893
   target dn stat err =       0.002567678569
      target stat err =       0.002286925233
              std dev =       0.665015980807
             le_variance =       0.442246254728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281468160572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+21, overlap shift 6.2500e+22 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751837014340       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751837014340       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751837014340       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+21 is 1.703869e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+22, overlap shift 2.5000e+23 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751837014340       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751837014340       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751837014340       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+22 is 4.259674e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+23, overlap shift 1.0000e+24 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751837014340       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751837014340       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751837014340       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+23 is 1.064918e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.315113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9010e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8998
    reference variance = 0.332232
====================================================
  Execution time = 4.3703e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4533e-01
  Total weights = 2.0000e+06
  Execution time = 3.6055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445341957604
                                         uncertainty =       0.002123997817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445341957604
                                         uncertainty =       0.002123997817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471872121
  error estimate for blocks of size 2^( 2) =       0.000496843645
  error estimate for blocks of size 2^( 3) =       0.000520473115
  error estimate for blocks of size 2^( 4) =       0.000538021275
  error estimate for blocks of size 2^( 5) =       0.000549473403
  error estimate for blocks of size 2^( 6) =       0.000556298441
  error estimate for blocks of size 2^( 7) =       0.000560201308

      target function =      -0.749192107660
              le_mean =     -22.815373330798
             les_mean =     520.986586597588
             stat err =       0.000550998607
             autocorr =       1.363491275396
   target nu stat err =       0.000550998607
   target dn stat err =       0.002383329548
      target stat err =       0.002124594648
              std dev =       0.667327952787
             le_variance =       0.445326596571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445341957604
                                         uncertainty =       0.002123997817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445341957604
                                         uncertainty =       0.002123997817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471872121
  error estimate for blocks of size 2^( 2) =       0.000496843645
  error estimate for blocks of size 2^( 3) =       0.000520473115
  error estimate for blocks of size 2^( 4) =       0.000538021275
  error estimate for blocks of size 2^( 5) =       0.000549473403
  error estimate for blocks of size 2^( 6) =       0.000556298441
  error estimate for blocks of size 2^( 7) =       0.000560201308

      target function =      -0.749192107660
              le_mean =     -22.815373330798
             les_mean =     520.986586597588
             stat err =       0.000550998607
             autocorr =       1.363491275396
   target nu stat err =       0.000550998607
   target dn stat err =       0.002383329548
      target stat err =       0.002124594648
              std dev =       0.667327952787
             le_variance =       0.445326596571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445341957604
                                         uncertainty =       0.002123997817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445341957604
                                         uncertainty =       0.002123997817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471872121
  error estimate for blocks of size 2^( 2) =       0.000496843645
  error estimate for blocks of size 2^( 3) =       0.000520473115
  error estimate for blocks of size 2^( 4) =       0.000538021275
  error estimate for blocks of size 2^( 5) =       0.000549473403
  error estimate for blocks of size 2^( 6) =       0.000556298441
  error estimate for blocks of size 2^( 7) =       0.000560201308

      target function =      -0.749192107660
              le_mean =     -22.815373330798
             les_mean =     520.986586597588
             stat err =       0.000550998607
             autocorr =       1.363491275396
   target nu stat err =       0.000550998607
   target dn stat err =       0.002383329548
      target stat err =       0.002124594648
              std dev =       0.667327952787
             le_variance =       0.445326596571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445341957604
                                         uncertainty =       0.002123997817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445341957604
                                         uncertainty =       0.002123997817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471872121
  error estimate for blocks of size 2^( 2) =       0.000496843645
  error estimate for blocks of size 2^( 3) =       0.000520473115
  error estimate for blocks of size 2^( 4) =       0.000538021275
  error estimate for blocks of size 2^( 5) =       0.000549473403
  error estimate for blocks of size 2^( 6) =       0.000556298441
  error estimate for blocks of size 2^( 7) =       0.000560201308

      target function =      -0.749192107660
              le_mean =     -22.815373330798
             les_mean =     520.986586597588
             stat err =       0.000550998607
             autocorr =       1.363491275396
   target nu stat err =       0.000550998607
   target dn stat err =       0.002383329548
      target stat err =       0.002124594648
              std dev =       0.667327952787
             le_variance =       0.445326596571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749192107660        initial  <--
     6.2500e+21     6.2500e+22             1.7039e-26        -0.749192107660
     2.5000e+22     2.5000e+23             4.2597e-27        -0.749192107660
     1.0000e+23     1.0000e+24             1.0649e-27        -0.749192107660

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6827
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2070e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8319
    reference variance = 0.407774
====================================================
  Execution time = 4.5687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5264e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4664e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452679346650
                                         uncertainty =       0.004116525088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452679346650
                                         uncertainty =       0.004116525088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475731740
  error estimate for blocks of size 2^( 2) =       0.000500650939
  error estimate for blocks of size 2^( 3) =       0.000524336521
  error estimate for blocks of size 2^( 4) =       0.000542636108
  error estimate for blocks of size 2^( 5) =       0.000553475910
  error estimate for blocks of size 2^( 6) =       0.000559158128
  error estimate for blocks of size 2^( 7) =       0.000560859307

      target function =      -0.743016714311
              le_mean =     -22.814675734231
             les_mean =     520.962070009292
             stat err =       0.000554032363
             autocorr =       1.356269552813
   target nu stat err =       0.000554032363
   target dn stat err =       0.004312740574
      target stat err =       0.003663093883
              std dev =       0.672786279204
             le_variance =       0.452641377485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281467573423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+22, overlap shift 6.2500e+23 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743033605554       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743033605554       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+23, overlap shift 2.5000e+24 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743033605554       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743033605554       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743033605554       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+23 is 3.499960e-28

solving harmonic davidson linear method for identity shift 1.0000e+24, overlap shift 1.0000e+25 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743033605554       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743033605554       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743033605554       residual = 6.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+24 is 8.749901e-29

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.316379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0362e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7726
    reference variance = 0.301396
====================================================
  Execution time = 4.3249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4552e-01
  Total weights = 2.0000e+06
  Execution time = 3.6032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445432577131
                                         uncertainty =       0.002666387492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445432577131
                                         uncertainty =       0.002666387492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471972149
  error estimate for blocks of size 2^( 2) =       0.000497376027
  error estimate for blocks of size 2^( 3) =       0.000521202401
  error estimate for blocks of size 2^( 4) =       0.000538474019
  error estimate for blocks of size 2^( 5) =       0.000549540223
  error estimate for blocks of size 2^( 6) =       0.000556966744
  error estimate for blocks of size 2^( 7) =       0.000556846201

      target function =      -0.749036011165
              le_mean =     -22.814990233649
             les_mean =     520.969294557146
             stat err =       0.000550456797
             autocorr =       1.360234337554
   target nu stat err =       0.000550456797
   target dn stat err =       0.002537004765
      target stat err =       0.002247630109
              std dev =       0.667469413831
             le_variance =       0.445515418400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445432577131
                                         uncertainty =       0.002666387492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445432577131
                                         uncertainty =       0.002666387492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471972149
  error estimate for blocks of size 2^( 2) =       0.000497376027
  error estimate for blocks of size 2^( 3) =       0.000521202401
  error estimate for blocks of size 2^( 4) =       0.000538474019
  error estimate for blocks of size 2^( 5) =       0.000549540223
  error estimate for blocks of size 2^( 6) =       0.000556966744
  error estimate for blocks of size 2^( 7) =       0.000556846201

      target function =      -0.749036011165
              le_mean =     -22.814990233649
             les_mean =     520.969294557146
             stat err =       0.000550456797
             autocorr =       1.360234337554
   target nu stat err =       0.000550456797
   target dn stat err =       0.002537004765
      target stat err =       0.002247630109
              std dev =       0.667469413831
             le_variance =       0.445515418400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445432577131
                                         uncertainty =       0.002666387492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445432577131
                                         uncertainty =       0.002666387492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471972149
  error estimate for blocks of size 2^( 2) =       0.000497376027
  error estimate for blocks of size 2^( 3) =       0.000521202401
  error estimate for blocks of size 2^( 4) =       0.000538474019
  error estimate for blocks of size 2^( 5) =       0.000549540223
  error estimate for blocks of size 2^( 6) =       0.000556966744
  error estimate for blocks of size 2^( 7) =       0.000556846201

      target function =      -0.749036011165
              le_mean =     -22.814990233649
             les_mean =     520.969294557146
             stat err =       0.000550456797
             autocorr =       1.360234337554
   target nu stat err =       0.000550456797
   target dn stat err =       0.002537004765
      target stat err =       0.002247630109
              std dev =       0.667469413831
             le_variance =       0.445515418400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445432577131
                                         uncertainty =       0.002666387492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445432577131
                                         uncertainty =       0.002666387492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471972149
  error estimate for blocks of size 2^( 2) =       0.000497376027
  error estimate for blocks of size 2^( 3) =       0.000521202401
  error estimate for blocks of size 2^( 4) =       0.000538474019
  error estimate for blocks of size 2^( 5) =       0.000549540223
  error estimate for blocks of size 2^( 6) =       0.000556966744
  error estimate for blocks of size 2^( 7) =       0.000556846201

      target function =      -0.749036011165
              le_mean =     -22.814990233649
             les_mean =     520.969294557146
             stat err =       0.000550456797
             autocorr =       1.360234337554
   target nu stat err =       0.000550456797
   target dn stat err =       0.002537004765
      target stat err =       0.002247630109
              std dev =       0.667469413831
             le_variance =       0.445515418400


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749036011165        initial  <--
     6.2500e+22     6.2500e+23             0.0000e+00        -0.749036011165
     2.5000e+23     2.5000e+24             3.5000e-28        -0.749036011165
     1.0000e+24     1.0000e+25             8.7499e-29        -0.749036011165

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2082
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2158e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7696
    reference variance = 0.298715
====================================================
  Execution time = 4.5642e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4711e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4997e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447190661326
                                         uncertainty =       0.002599665130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447190661326
                                         uncertainty =       0.002599665130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472817634
  error estimate for blocks of size 2^( 2) =       0.000498173254
  error estimate for blocks of size 2^( 3) =       0.000521051278
  error estimate for blocks of size 2^( 4) =       0.000538629120
  error estimate for blocks of size 2^( 5) =       0.000548969186
  error estimate for blocks of size 2^( 6) =       0.000555713467
  error estimate for blocks of size 2^( 7) =       0.000559761039

      target function =      -0.747679798549
              le_mean =     -22.814890465886
             les_mean =     520.966339776767
             stat err =       0.000550768203
             autocorr =       1.356907954842
   target nu stat err =       0.000550768203
   target dn stat err =       0.002687926451
      target stat err =       0.002362713581
              std dev =       0.668665110462
             le_variance =       0.447113029950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281489046589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+23, overlap shift 6.2500e+24 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747686300834       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747686300834       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+24, overlap shift 2.5000e+25 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747686300834       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747686300834       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+24 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+25, overlap shift 1.0000e+26 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747686300834       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747686300834       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+25 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.317471 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0651e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8385
    reference variance = 0.308212
====================================================
  Execution time = 4.3085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4729e-01
  Total weights = 2.0000e+06
  Execution time = 3.5953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446710615381
                                         uncertainty =       0.002640423362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446710615381
                                         uncertainty =       0.002640423362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472913830
  error estimate for blocks of size 2^( 2) =       0.000497672468
  error estimate for blocks of size 2^( 3) =       0.000520949797
  error estimate for blocks of size 2^( 4) =       0.000539022662
  error estimate for blocks of size 2^( 5) =       0.000550223742
  error estimate for blocks of size 2^( 6) =       0.000556785592
  error estimate for blocks of size 2^( 7) =       0.000560312349

      target function =      -0.747537139662
              le_mean =     -22.814103954114
             les_mean =     520.930633987532
             stat err =       0.000551586086
             autocorr =       1.360387318258
   target nu stat err =       0.000551586086
   target dn stat err =       0.002742481256
      target stat err =       0.002403836273
              std dev =       0.668801152847
             le_variance =       0.447294982049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446710615381
                                         uncertainty =       0.002640423362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446710615381
                                         uncertainty =       0.002640423362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472913830
  error estimate for blocks of size 2^( 2) =       0.000497672468
  error estimate for blocks of size 2^( 3) =       0.000520949797
  error estimate for blocks of size 2^( 4) =       0.000539022662
  error estimate for blocks of size 2^( 5) =       0.000550223742
  error estimate for blocks of size 2^( 6) =       0.000556785592
  error estimate for blocks of size 2^( 7) =       0.000560312349

      target function =      -0.747537139662
              le_mean =     -22.814103954114
             les_mean =     520.930633987532
             stat err =       0.000551586086
             autocorr =       1.360387318258
   target nu stat err =       0.000551586086
   target dn stat err =       0.002742481256
      target stat err =       0.002403836273
              std dev =       0.668801152847
             le_variance =       0.447294982049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446710615381
                                         uncertainty =       0.002640423362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446710615381
                                         uncertainty =       0.002640423362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472913830
  error estimate for blocks of size 2^( 2) =       0.000497672468
  error estimate for blocks of size 2^( 3) =       0.000520949797
  error estimate for blocks of size 2^( 4) =       0.000539022662
  error estimate for blocks of size 2^( 5) =       0.000550223742
  error estimate for blocks of size 2^( 6) =       0.000556785592
  error estimate for blocks of size 2^( 7) =       0.000560312349

      target function =      -0.747537139662
              le_mean =     -22.814103954114
             les_mean =     520.930633987532
             stat err =       0.000551586086
             autocorr =       1.360387318258
   target nu stat err =       0.000551586086
   target dn stat err =       0.002742481256
      target stat err =       0.002403836273
              std dev =       0.668801152847
             le_variance =       0.447294982049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446710615381
                                         uncertainty =       0.002640423362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446710615381
                                         uncertainty =       0.002640423362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472913830
  error estimate for blocks of size 2^( 2) =       0.000497672468
  error estimate for blocks of size 2^( 3) =       0.000520949797
  error estimate for blocks of size 2^( 4) =       0.000539022662
  error estimate for blocks of size 2^( 5) =       0.000550223742
  error estimate for blocks of size 2^( 6) =       0.000556785592
  error estimate for blocks of size 2^( 7) =       0.000560312349

      target function =      -0.747537139662
              le_mean =     -22.814103954114
             les_mean =     520.930633987532
             stat err =       0.000551586086
             autocorr =       1.360387318258
   target nu stat err =       0.000551586086
   target dn stat err =       0.002742481256
      target stat err =       0.002403836273
              std dev =       0.668801152847
             le_variance =       0.447294982049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747537139662        initial  <--
     6.2500e+23     6.2500e+24             0.0000e+00        -0.747537139662
     2.5000e+24     2.5000e+25             0.0000e+00        -0.747537139662
     1.0000e+25     1.0000e+26             0.0000e+00        -0.747537139662

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9980
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2166e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8111
    reference variance = 0.491248
====================================================
  Execution time = 4.3925e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4823e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4614e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447678738192
                                         uncertainty =       0.003070728649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447678738192
                                         uncertainty =       0.003070728649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473407391
  error estimate for blocks of size 2^( 2) =       0.000498593308
  error estimate for blocks of size 2^( 3) =       0.000522812302
  error estimate for blocks of size 2^( 4) =       0.000540325577
  error estimate for blocks of size 2^( 5) =       0.000551416580
  error estimate for blocks of size 2^( 6) =       0.000558216272
  error estimate for blocks of size 2^( 7) =       0.000562666342

      target function =      -0.746749571297
              le_mean =     -22.813830893885
             les_mean =     520.919108947299
             stat err =       0.000553156193
             autocorr =       1.365291822032
   target nu stat err =       0.000553156193
   target dn stat err =       0.003152201096
      target stat err =       0.002733864399
              std dev =       0.669499153561
             le_variance =       0.448229116618


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281383089389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+24, overlap shift 6.2500e+25 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746758535348       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746758535348       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+25, overlap shift 2.5000e+26 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746758535348       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746758535348       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+26, overlap shift 1.0000e+27 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746758535348       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746758535348       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.318602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8550e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7058
    reference variance = 0.654777
====================================================
  Execution time = 4.5016e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4270e-01
  Total weights = 2.0000e+06
  Execution time = 3.5835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442761843088
                                         uncertainty =       0.002445953874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442761843088
                                         uncertainty =       0.002445953874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470480325
  error estimate for blocks of size 2^( 2) =       0.000495395812
  error estimate for blocks of size 2^( 3) =       0.000518774887
  error estimate for blocks of size 2^( 4) =       0.000536378508
  error estimate for blocks of size 2^( 5) =       0.000547732159
  error estimate for blocks of size 2^( 6) =       0.000553496907
  error estimate for blocks of size 2^( 7) =       0.000557091197

      target function =      -0.751434290684
              le_mean =     -22.815155443157
             les_mean =     520.974021147299
             stat err =       0.000548674693
             autocorr =       1.360025103943
   target nu stat err =       0.000548674693
   target dn stat err =       0.002642457829
      target stat err =       0.002348436974
              std dev =       0.665359657059
             le_variance =       0.442703473242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442761843088
                                         uncertainty =       0.002445953874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442761843088
                                         uncertainty =       0.002445953874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470480325
  error estimate for blocks of size 2^( 2) =       0.000495395812
  error estimate for blocks of size 2^( 3) =       0.000518774887
  error estimate for blocks of size 2^( 4) =       0.000536378508
  error estimate for blocks of size 2^( 5) =       0.000547732159
  error estimate for blocks of size 2^( 6) =       0.000553496907
  error estimate for blocks of size 2^( 7) =       0.000557091197

      target function =      -0.751434290684
              le_mean =     -22.815155443157
             les_mean =     520.974021147299
             stat err =       0.000548674693
             autocorr =       1.360025103943
   target nu stat err =       0.000548674693
   target dn stat err =       0.002642457829
      target stat err =       0.002348436974
              std dev =       0.665359657059
             le_variance =       0.442703473242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442761843088
                                         uncertainty =       0.002445953874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442761843088
                                         uncertainty =       0.002445953874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470480325
  error estimate for blocks of size 2^( 2) =       0.000495395812
  error estimate for blocks of size 2^( 3) =       0.000518774887
  error estimate for blocks of size 2^( 4) =       0.000536378508
  error estimate for blocks of size 2^( 5) =       0.000547732159
  error estimate for blocks of size 2^( 6) =       0.000553496907
  error estimate for blocks of size 2^( 7) =       0.000557091197

      target function =      -0.751434290684
              le_mean =     -22.815155443157
             les_mean =     520.974021147299
             stat err =       0.000548674693
             autocorr =       1.360025103943
   target nu stat err =       0.000548674693
   target dn stat err =       0.002642457829
      target stat err =       0.002348436974
              std dev =       0.665359657059
             le_variance =       0.442703473242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442761843088
                                         uncertainty =       0.002445953874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442761843088
                                         uncertainty =       0.002445953874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470480325
  error estimate for blocks of size 2^( 2) =       0.000495395812
  error estimate for blocks of size 2^( 3) =       0.000518774887
  error estimate for blocks of size 2^( 4) =       0.000536378508
  error estimate for blocks of size 2^( 5) =       0.000547732159
  error estimate for blocks of size 2^( 6) =       0.000553496907
  error estimate for blocks of size 2^( 7) =       0.000557091197

      target function =      -0.751434290684
              le_mean =     -22.815155443157
             les_mean =     520.974021147299
             stat err =       0.000548674693
             autocorr =       1.360025103943
   target nu stat err =       0.000548674693
   target dn stat err =       0.002642457829
      target stat err =       0.002348436974
              std dev =       0.665359657059
             le_variance =       0.442703473242


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751434290684        initial  <--
     6.2500e+24     6.2500e+25             0.0000e+00        -0.751434290684
     2.5000e+25     2.5000e+26             0.0000e+00        -0.751434290684
     1.0000e+26     1.0000e+27             0.0000e+00        -0.751434290684

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8860
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2144e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7826
    reference variance = 0.351386
====================================================
  Execution time = 4.3940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4618e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4832e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446161415297
                                         uncertainty =       0.003845619424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446161415297
                                         uncertainty =       0.003845619424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472321958
  error estimate for blocks of size 2^( 2) =       0.000497499377
  error estimate for blocks of size 2^( 3) =       0.000521036304
  error estimate for blocks of size 2^( 4) =       0.000538086329
  error estimate for blocks of size 2^( 5) =       0.000547964433
  error estimate for blocks of size 2^( 6) =       0.000553619039
  error estimate for blocks of size 2^( 7) =       0.000554970129

      target function =      -0.748470378794
              le_mean =     -22.814627346526
             les_mean =     520.953396802202
             stat err =       0.000548659982
             autocorr =       1.349367660867
   target nu stat err =       0.000548659982
   target dn stat err =       0.003980292319
      target stat err =       0.003436969246
              std dev =       0.667964119130
             le_variance =       0.446176064445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281462734653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+25, overlap shift 6.2500e+26 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748485246842       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748485246842       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+25 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+26, overlap shift 2.5000e+27 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748485246842       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748485246842       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+27, overlap shift 1.0000e+28 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748485246842       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748485246842       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+27 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.319691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8784e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.848
    reference variance = 0.296624
====================================================
  Execution time = 4.5132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4538e-01
  Total weights = 2.0000e+06
  Execution time = 3.6299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445398513133
                                         uncertainty =       0.003292245913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445398513133
                                         uncertainty =       0.003292245913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471900653
  error estimate for blocks of size 2^( 2) =       0.000497169096
  error estimate for blocks of size 2^( 3) =       0.000520923664
  error estimate for blocks of size 2^( 4) =       0.000537879955
  error estimate for blocks of size 2^( 5) =       0.000548540794
  error estimate for blocks of size 2^( 6) =       0.000555555338
  error estimate for blocks of size 2^( 7) =       0.000558607778

      target function =      -0.749137011462
              le_mean =     -22.815706941216
             les_mean =     521.001863457197
             stat err =       0.000550145966
             autocorr =       1.359110318125
   target nu stat err =       0.000550145966
   target dn stat err =       0.003185092906
      target stat err =       0.002785277217
              std dev =       0.667368303456
             le_variance =       0.445380452457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445398513133
                                         uncertainty =       0.003292245913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445398513133
                                         uncertainty =       0.003292245913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471900653
  error estimate for blocks of size 2^( 2) =       0.000497169096
  error estimate for blocks of size 2^( 3) =       0.000520923664
  error estimate for blocks of size 2^( 4) =       0.000537879955
  error estimate for blocks of size 2^( 5) =       0.000548540794
  error estimate for blocks of size 2^( 6) =       0.000555555338
  error estimate for blocks of size 2^( 7) =       0.000558607778

      target function =      -0.749137011462
              le_mean =     -22.815706941216
             les_mean =     521.001863457197
             stat err =       0.000550145966
             autocorr =       1.359110318125
   target nu stat err =       0.000550145966
   target dn stat err =       0.003185092906
      target stat err =       0.002785277217
              std dev =       0.667368303456
             le_variance =       0.445380452457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445398513133
                                         uncertainty =       0.003292245913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445398513133
                                         uncertainty =       0.003292245913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471900653
  error estimate for blocks of size 2^( 2) =       0.000497169096
  error estimate for blocks of size 2^( 3) =       0.000520923664
  error estimate for blocks of size 2^( 4) =       0.000537879955
  error estimate for blocks of size 2^( 5) =       0.000548540794
  error estimate for blocks of size 2^( 6) =       0.000555555338
  error estimate for blocks of size 2^( 7) =       0.000558607778

      target function =      -0.749137011462
              le_mean =     -22.815706941216
             les_mean =     521.001863457197
             stat err =       0.000550145966
             autocorr =       1.359110318125
   target nu stat err =       0.000550145966
   target dn stat err =       0.003185092906
      target stat err =       0.002785277217
              std dev =       0.667368303456
             le_variance =       0.445380452457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445398513133
                                         uncertainty =       0.003292245913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445398513133
                                         uncertainty =       0.003292245913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471900653
  error estimate for blocks of size 2^( 2) =       0.000497169096
  error estimate for blocks of size 2^( 3) =       0.000520923664
  error estimate for blocks of size 2^( 4) =       0.000537879955
  error estimate for blocks of size 2^( 5) =       0.000548540794
  error estimate for blocks of size 2^( 6) =       0.000555555338
  error estimate for blocks of size 2^( 7) =       0.000558607778

      target function =      -0.749137011462
              le_mean =     -22.815706941216
             les_mean =     521.001863457197
             stat err =       0.000550145966
             autocorr =       1.359110318125
   target nu stat err =       0.000550145966
   target dn stat err =       0.003185092906
      target stat err =       0.002785277217
              std dev =       0.667368303456
             le_variance =       0.445380452457


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749137011462        initial  <--
     6.2500e+25     6.2500e+26             0.0000e+00        -0.749137011462
     2.5000e+26     2.5000e+27             0.0000e+00        -0.749137011462
     1.0000e+27     1.0000e+28             0.0000e+00        -0.749137011462

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0373
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2183e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8253
    reference variance = 0.384976
====================================================
  Execution time = 4.3493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6291e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4784e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462988076592
                                         uncertainty =       0.015207521870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462988076592
                                         uncertainty =       0.015207521870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481098551
  error estimate for blocks of size 2^( 2) =       0.000506062906
  error estimate for blocks of size 2^( 3) =       0.000528645321
  error estimate for blocks of size 2^( 4) =       0.000545817785
  error estimate for blocks of size 2^( 5) =       0.000555622980
  error estimate for blocks of size 2^( 6) =       0.000561085975
  error estimate for blocks of size 2^( 7) =       0.000565055664

      target function =      -0.734290514032
              le_mean =     -22.815309399514
             les_mean =     521.001254394906
             stat err =       0.000556895601
             autocorr =       1.339921876177
   target nu stat err =       0.000556895601
   target dn stat err =       0.015613138164
      target stat err =       0.012793192080
              std dev =       0.680376095103
             le_variance =       0.462911630788


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281530939951e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+26, overlap shift 6.2500e+27 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734513861408       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734513861408       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734513861418       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+26 is 2.741180e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+27, overlap shift 2.5000e+28 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734513861408       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734513861408       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734513861408       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+27 is 6.852951e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+28, overlap shift 1.0000e+29 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734513861408       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734513861408       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734513861408       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+28 is 1.713238e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.321085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8289e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7789
    reference variance = 0.404357
====================================================
  Execution time = 4.2899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5562e-01
  Total weights = 2.0000e+06
  Execution time = 3.6025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455515257546
                                         uncertainty =       0.005990251885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455515257546
                                         uncertainty =       0.005990251885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477294738
  error estimate for blocks of size 2^( 2) =       0.000502226541
  error estimate for blocks of size 2^( 3) =       0.000524595978
  error estimate for blocks of size 2^( 4) =       0.000541943247
  error estimate for blocks of size 2^( 5) =       0.000554714248
  error estimate for blocks of size 2^( 6) =       0.000560429847
  error estimate for blocks of size 2^( 7) =       0.000562891807

      target function =      -0.740514501591
              le_mean =     -22.814775451512
             les_mean =     520.969599209081
             stat err =       0.000554994787
             autocorr =       1.352086619726
   target nu stat err =       0.000554994787
   target dn stat err =       0.005834499212
      target stat err =       0.004891029681
              std dev =       0.674996691826
             le_variance =       0.455620533976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455515257546
                                         uncertainty =       0.005990251885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455515257546
                                         uncertainty =       0.005990251885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477294738
  error estimate for blocks of size 2^( 2) =       0.000502226541
  error estimate for blocks of size 2^( 3) =       0.000524595978
  error estimate for blocks of size 2^( 4) =       0.000541943247
  error estimate for blocks of size 2^( 5) =       0.000554714248
  error estimate for blocks of size 2^( 6) =       0.000560429847
  error estimate for blocks of size 2^( 7) =       0.000562891807

      target function =      -0.740514501591
              le_mean =     -22.814775451512
             les_mean =     520.969599209081
             stat err =       0.000554994787
             autocorr =       1.352086619726
   target nu stat err =       0.000554994787
   target dn stat err =       0.005834499212
      target stat err =       0.004891029681
              std dev =       0.674996691826
             le_variance =       0.455620533976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455515257546
                                         uncertainty =       0.005990251885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455515257546
                                         uncertainty =       0.005990251885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477294738
  error estimate for blocks of size 2^( 2) =       0.000502226541
  error estimate for blocks of size 2^( 3) =       0.000524595978
  error estimate for blocks of size 2^( 4) =       0.000541943247
  error estimate for blocks of size 2^( 5) =       0.000554714248
  error estimate for blocks of size 2^( 6) =       0.000560429847
  error estimate for blocks of size 2^( 7) =       0.000562891807

      target function =      -0.740514501591
              le_mean =     -22.814775451512
             les_mean =     520.969599209081
             stat err =       0.000554994787
             autocorr =       1.352086619726
   target nu stat err =       0.000554994787
   target dn stat err =       0.005834499212
      target stat err =       0.004891029681
              std dev =       0.674996691826
             le_variance =       0.455620533976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455515257546
                                         uncertainty =       0.005990251885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455515257546
                                         uncertainty =       0.005990251885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477294738
  error estimate for blocks of size 2^( 2) =       0.000502226541
  error estimate for blocks of size 2^( 3) =       0.000524595978
  error estimate for blocks of size 2^( 4) =       0.000541943247
  error estimate for blocks of size 2^( 5) =       0.000554714248
  error estimate for blocks of size 2^( 6) =       0.000560429847
  error estimate for blocks of size 2^( 7) =       0.000562891807

      target function =      -0.740514501591
              le_mean =     -22.814775451512
             les_mean =     520.969599209081
             stat err =       0.000554994787
             autocorr =       1.352086619726
   target nu stat err =       0.000554994787
   target dn stat err =       0.005834499212
      target stat err =       0.004891029681
              std dev =       0.674996691826
             le_variance =       0.455620533976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740514501591        initial  <--
     6.2500e+26     6.2500e+27             2.7412e-31        -0.740514501591
     2.5000e+27     2.5000e+28             6.8530e-32        -0.740514501591
     1.0000e+28     1.0000e+29             1.7132e-32        -0.740514501591

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8837
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1918e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8375
    reference variance = 0.405311
====================================================
  Execution time = 4.5138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4701e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4683e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447030446172
                                         uncertainty =       0.003879135738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447030446172
                                         uncertainty =       0.003879135738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472765365
  error estimate for blocks of size 2^( 2) =       0.000497499820
  error estimate for blocks of size 2^( 3) =       0.000520494121
  error estimate for blocks of size 2^( 4) =       0.000537569259
  error estimate for blocks of size 2^( 5) =       0.000548154693
  error estimate for blocks of size 2^( 6) =       0.000553367338
  error estimate for blocks of size 2^( 7) =       0.000557868502

      target function =      -0.747744562569
              le_mean =     -22.815660842550
             les_mean =     521.001393639844
             stat err =       0.000549239948
             autocorr =       1.349686578551
   target nu stat err =       0.000549239948
   target dn stat err =       0.003735659375
      target stat err =       0.003231909303
              std dev =       0.668591191305
             le_variance =       0.447014181091


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281566084255e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+27, overlap shift 6.2500e+28 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747757536480       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747757536480       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+28, overlap shift 2.5000e+29 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747757536480       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747757536480       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+29, overlap shift 1.0000e+30 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747757536480       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747757536480       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.322213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9833e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8323
    reference variance = 0.734108
====================================================
  Execution time = 4.3594e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4944e-01
  Total weights = 2.0000e+06
  Execution time = 3.6143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449378482489
                                         uncertainty =       0.003844711414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449378482489
                                         uncertainty =       0.003844711414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474044879
  error estimate for blocks of size 2^( 2) =       0.000499042547
  error estimate for blocks of size 2^( 3) =       0.000522515131
  error estimate for blocks of size 2^( 4) =       0.000540158024
  error estimate for blocks of size 2^( 5) =       0.000550836509
  error estimate for blocks of size 2^( 6) =       0.000556440945
  error estimate for blocks of size 2^( 7) =       0.000561525742

      target function =      -0.745693824372
              le_mean =     -22.815445085557
             les_mean =     520.993971322850
             stat err =       0.000552240305
             autocorr =       1.357116968194
   target nu stat err =       0.000552240305
   target dn stat err =       0.004276054238
      target stat err =       0.003662605318
              std dev =       0.670400697702
             le_variance =       0.449437095479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449378482489
                                         uncertainty =       0.003844711414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449378482489
                                         uncertainty =       0.003844711414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474044879
  error estimate for blocks of size 2^( 2) =       0.000499042547
  error estimate for blocks of size 2^( 3) =       0.000522515131
  error estimate for blocks of size 2^( 4) =       0.000540158024
  error estimate for blocks of size 2^( 5) =       0.000550836509
  error estimate for blocks of size 2^( 6) =       0.000556440945
  error estimate for blocks of size 2^( 7) =       0.000561525742

      target function =      -0.745693824372
              le_mean =     -22.815445085557
             les_mean =     520.993971322850
             stat err =       0.000552240305
             autocorr =       1.357116968194
   target nu stat err =       0.000552240305
   target dn stat err =       0.004276054238
      target stat err =       0.003662605318
              std dev =       0.670400697702
             le_variance =       0.449437095479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449378482489
                                         uncertainty =       0.003844711414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449378482489
                                         uncertainty =       0.003844711414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474044879
  error estimate for blocks of size 2^( 2) =       0.000499042547
  error estimate for blocks of size 2^( 3) =       0.000522515131
  error estimate for blocks of size 2^( 4) =       0.000540158024
  error estimate for blocks of size 2^( 5) =       0.000550836509
  error estimate for blocks of size 2^( 6) =       0.000556440945
  error estimate for blocks of size 2^( 7) =       0.000561525742

      target function =      -0.745693824372
              le_mean =     -22.815445085557
             les_mean =     520.993971322850
             stat err =       0.000552240305
             autocorr =       1.357116968194
   target nu stat err =       0.000552240305
   target dn stat err =       0.004276054238
      target stat err =       0.003662605318
              std dev =       0.670400697702
             le_variance =       0.449437095479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449378482489
                                         uncertainty =       0.003844711414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449378482489
                                         uncertainty =       0.003844711414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474044879
  error estimate for blocks of size 2^( 2) =       0.000499042547
  error estimate for blocks of size 2^( 3) =       0.000522515131
  error estimate for blocks of size 2^( 4) =       0.000540158024
  error estimate for blocks of size 2^( 5) =       0.000550836509
  error estimate for blocks of size 2^( 6) =       0.000556440945
  error estimate for blocks of size 2^( 7) =       0.000561525742

      target function =      -0.745693824372
              le_mean =     -22.815445085557
             les_mean =     520.993971322850
             stat err =       0.000552240305
             autocorr =       1.357116968194
   target nu stat err =       0.000552240305
   target dn stat err =       0.004276054238
      target stat err =       0.003662605318
              std dev =       0.670400697702
             le_variance =       0.449437095479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745693824372        initial  <--
     6.2500e+27     6.2500e+28             0.0000e+00        -0.745693824372
     2.5000e+28     2.5000e+29             0.0000e+00        -0.745693824372
     1.0000e+29     1.0000e+30             0.0000e+00        -0.745693824372

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6010
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2144e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7653
    reference variance = 0.460311
====================================================
  Execution time = 4.4931e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.7735e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4821e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477365875902
                                         uncertainty =       0.026367960180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477365875902
                                         uncertainty =       0.026367960180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488543626
  error estimate for blocks of size 2^( 2) =       0.000512913404
  error estimate for blocks of size 2^( 3) =       0.000535783816
  error estimate for blocks of size 2^( 4) =       0.000552651286
  error estimate for blocks of size 2^( 5) =       0.000562533675
  error estimate for blocks of size 2^( 6) =       0.000569857880
  error estimate for blocks of size 2^( 7) =       0.000574246802

      target function =      -0.722314624763
              le_mean =     -22.814539619670
             les_mean =     520.980567568105
             stat err =       0.000564822411
             autocorr =       1.336648258563
   target nu stat err =       0.000564822411
   target dn stat err =       0.026370440661
      target stat err =       0.020879838617
              std dev =       0.690905021907
             le_variance =       0.477349749297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281453961967e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+28, overlap shift 6.2500e+29 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.722920368383       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.722920368383       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+29, overlap shift 2.5000e+30 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.722920368383       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.722920368383       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+30, overlap shift 1.0000e+31 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.722920368383       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.722920368383       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.323421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9763e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7768
    reference variance = 0.242404
====================================================
  Execution time = 4.2937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4243e-01
  Total weights = 2.0000e+06
  Execution time = 3.5991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442444074388
                                         uncertainty =       0.002619357828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442444074388
                                         uncertainty =       0.002619357828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470336183
  error estimate for blocks of size 2^( 2) =       0.000495217488
  error estimate for blocks of size 2^( 3) =       0.000519460921
  error estimate for blocks of size 2^( 4) =       0.000535646499
  error estimate for blocks of size 2^( 5) =       0.000547615732
  error estimate for blocks of size 2^( 6) =       0.000552640375
  error estimate for blocks of size 2^( 7) =       0.000554870028

      target function =      -0.751661870485
              le_mean =     -22.815498419565
             les_mean =     520.989400161826
             stat err =       0.000547693159
             autocorr =       1.355994261956
   target nu stat err =       0.000547693159
   target dn stat err =       0.002865462887
      target stat err =       0.002535615541
              std dev =       0.665155808704
             le_variance =       0.442432249853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442444074388
                                         uncertainty =       0.002619357828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442444074388
                                         uncertainty =       0.002619357828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470336183
  error estimate for blocks of size 2^( 2) =       0.000495217488
  error estimate for blocks of size 2^( 3) =       0.000519460921
  error estimate for blocks of size 2^( 4) =       0.000535646499
  error estimate for blocks of size 2^( 5) =       0.000547615732
  error estimate for blocks of size 2^( 6) =       0.000552640375
  error estimate for blocks of size 2^( 7) =       0.000554870028

      target function =      -0.751661870485
              le_mean =     -22.815498419565
             les_mean =     520.989400161826
             stat err =       0.000547693159
             autocorr =       1.355994261956
   target nu stat err =       0.000547693159
   target dn stat err =       0.002865462887
      target stat err =       0.002535615541
              std dev =       0.665155808704
             le_variance =       0.442432249853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442444074388
                                         uncertainty =       0.002619357828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442444074388
                                         uncertainty =       0.002619357828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470336183
  error estimate for blocks of size 2^( 2) =       0.000495217488
  error estimate for blocks of size 2^( 3) =       0.000519460921
  error estimate for blocks of size 2^( 4) =       0.000535646499
  error estimate for blocks of size 2^( 5) =       0.000547615732
  error estimate for blocks of size 2^( 6) =       0.000552640375
  error estimate for blocks of size 2^( 7) =       0.000554870028

      target function =      -0.751661870485
              le_mean =     -22.815498419565
             les_mean =     520.989400161826
             stat err =       0.000547693159
             autocorr =       1.355994261956
   target nu stat err =       0.000547693159
   target dn stat err =       0.002865462887
      target stat err =       0.002535615541
              std dev =       0.665155808704
             le_variance =       0.442432249853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442444074388
                                         uncertainty =       0.002619357828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442444074388
                                         uncertainty =       0.002619357828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470336183
  error estimate for blocks of size 2^( 2) =       0.000495217488
  error estimate for blocks of size 2^( 3) =       0.000519460921
  error estimate for blocks of size 2^( 4) =       0.000535646499
  error estimate for blocks of size 2^( 5) =       0.000547615732
  error estimate for blocks of size 2^( 6) =       0.000552640375
  error estimate for blocks of size 2^( 7) =       0.000554870028

      target function =      -0.751661870485
              le_mean =     -22.815498419565
             les_mean =     520.989400161826
             stat err =       0.000547693159
             autocorr =       1.355994261956
   target nu stat err =       0.000547693159
   target dn stat err =       0.002865462887
      target stat err =       0.002535615541
              std dev =       0.665155808704
             le_variance =       0.442432249853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751661870485        initial  <--
     6.2500e+28     6.2500e+29             0.0000e+00        -0.751661870485
     2.5000e+29     2.5000e+30             0.0000e+00        -0.751661870485
     1.0000e+30     1.0000e+31             0.0000e+00        -0.751661870485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9999
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2077e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8634
    reference variance = 0.310292
====================================================
  Execution time = 4.3881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4735e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447020499629
                                         uncertainty =       0.003659364899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447020499629
                                         uncertainty =       0.003659364899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472800076
  error estimate for blocks of size 2^( 2) =       0.000497863927
  error estimate for blocks of size 2^( 3) =       0.000521870405
  error estimate for blocks of size 2^( 4) =       0.000539152152
  error estimate for blocks of size 2^( 5) =       0.000549019017
  error estimate for blocks of size 2^( 6) =       0.000554845982
  error estimate for blocks of size 2^( 7) =       0.000559581622

      target function =      -0.747706134798
              le_mean =     -22.814686019884
             les_mean =     520.956977785952
             stat err =       0.000550649693
             autocorr =       1.356424821043
   target nu stat err =       0.000550649693
   target dn stat err =       0.003558052534
      target stat err =       0.003079558910
              std dev =       0.668640279684
             le_variance =       0.447079823616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281468601988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+29, overlap shift 6.2500e+30 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747717632667       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747717632667       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747717632912       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+29 is 1.552246e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+30, overlap shift 2.5000e+31 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747717632667       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747717632667       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747717631981       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+30 is 3.880614e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+31, overlap shift 1.0000e+32 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747717632667       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747717632667       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747717633843       residual = 4.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+31 is 9.701536e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.324812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8628e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7336
    reference variance = 0.310378
====================================================
  Execution time = 4.5402e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5253e-01
  Total weights = 2.0000e+06
  Execution time = 3.5987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452580123484
                                         uncertainty =       0.003621080748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452580123484
                                         uncertainty =       0.003621080748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475674159
  error estimate for blocks of size 2^( 2) =       0.000500857215
  error estimate for blocks of size 2^( 3) =       0.000523813490
  error estimate for blocks of size 2^( 4) =       0.000541908157
  error estimate for blocks of size 2^( 5) =       0.000551767879
  error estimate for blocks of size 2^( 6) =       0.000558744206
  error estimate for blocks of size 2^( 7) =       0.000562265150

      target function =      -0.743103907240
              le_mean =     -22.815010628589
             les_mean =     520.977241566615
             stat err =       0.000553671348
             autocorr =       1.354830555206
   target nu stat err =       0.000553671348
   target dn stat err =       0.003899613160
      target stat err =       0.003325269367
              std dev =       0.672704846312
             le_variance =       0.452531810252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452580123484
                                         uncertainty =       0.003621080748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452580123484
                                         uncertainty =       0.003621080748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475674159
  error estimate for blocks of size 2^( 2) =       0.000500857215
  error estimate for blocks of size 2^( 3) =       0.000523813490
  error estimate for blocks of size 2^( 4) =       0.000541908157
  error estimate for blocks of size 2^( 5) =       0.000551767879
  error estimate for blocks of size 2^( 6) =       0.000558744206
  error estimate for blocks of size 2^( 7) =       0.000562265150

      target function =      -0.743103907240
              le_mean =     -22.815010628589
             les_mean =     520.977241566615
             stat err =       0.000553671348
             autocorr =       1.354830555206
   target nu stat err =       0.000553671348
   target dn stat err =       0.003899613160
      target stat err =       0.003325269367
              std dev =       0.672704846312
             le_variance =       0.452531810252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452580123484
                                         uncertainty =       0.003621080748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452580123484
                                         uncertainty =       0.003621080748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475674159
  error estimate for blocks of size 2^( 2) =       0.000500857215
  error estimate for blocks of size 2^( 3) =       0.000523813490
  error estimate for blocks of size 2^( 4) =       0.000541908157
  error estimate for blocks of size 2^( 5) =       0.000551767879
  error estimate for blocks of size 2^( 6) =       0.000558744206
  error estimate for blocks of size 2^( 7) =       0.000562265150

      target function =      -0.743103907240
              le_mean =     -22.815010628589
             les_mean =     520.977241566615
             stat err =       0.000553671348
             autocorr =       1.354830555206
   target nu stat err =       0.000553671348
   target dn stat err =       0.003899613160
      target stat err =       0.003325269367
              std dev =       0.672704846312
             le_variance =       0.452531810252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452580123484
                                         uncertainty =       0.003621080748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452580123484
                                         uncertainty =       0.003621080748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475674159
  error estimate for blocks of size 2^( 2) =       0.000500857215
  error estimate for blocks of size 2^( 3) =       0.000523813490
  error estimate for blocks of size 2^( 4) =       0.000541908157
  error estimate for blocks of size 2^( 5) =       0.000551767879
  error estimate for blocks of size 2^( 6) =       0.000558744206
  error estimate for blocks of size 2^( 7) =       0.000562265150

      target function =      -0.743103907240
              le_mean =     -22.815010628589
             les_mean =     520.977241566615
             stat err =       0.000553671348
             autocorr =       1.354830555206
   target nu stat err =       0.000553671348
   target dn stat err =       0.003899613160
      target stat err =       0.003325269367
              std dev =       0.672704846312
             le_variance =       0.452531810252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743103907240        initial  <--
     6.2500e+29     6.2500e+30             1.5522e-34        -0.743103907240
     2.5000e+30     2.5000e+31             3.8806e-35        -0.743103907240
     1.0000e+31     1.0000e+32             9.7015e-36        -0.743103907240

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3434
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2198e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8459
    reference variance = 0.488009
====================================================
  Execution time = 4.3658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4533e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4850e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445177164153
                                         uncertainty =       0.003051607897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445177164153
                                         uncertainty =       0.003051607897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471876150
  error estimate for blocks of size 2^( 2) =       0.000497276172
  error estimate for blocks of size 2^( 3) =       0.000521386851
  error estimate for blocks of size 2^( 4) =       0.000539328175
  error estimate for blocks of size 2^( 5) =       0.000551210599
  error estimate for blocks of size 2^( 6) =       0.000556795729
  error estimate for blocks of size 2^( 7) =       0.000560349963

      target function =      -0.749199465308
              le_mean =     -22.814138785973
             les_mean =     520.930262524879
             stat err =       0.000551921116
             autocorr =       1.368037384713
   target nu stat err =       0.000551921116
   target dn stat err =       0.002906091461
      target stat err =       0.002549005505
              std dev =       0.667333651101
             le_variance =       0.445334201891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281413878597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+30, overlap shift 6.2500e+31 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749207050947       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749207050947       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+31, overlap shift 2.5000e+32 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749207050947       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749207050947       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+32, overlap shift 1.0000e+33 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749207050947       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749207050947       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.325961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8520e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8591
    reference variance = 1.54193
====================================================
  Execution time = 4.4825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5263e-01
  Total weights = 2.0000e+06
  Execution time = 3.5999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452593694487
                                         uncertainty =       0.004919291668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452593694487
                                         uncertainty =       0.004919291668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475723303
  error estimate for blocks of size 2^( 2) =       0.000500291913
  error estimate for blocks of size 2^( 3) =       0.000523387643
  error estimate for blocks of size 2^( 4) =       0.000540475631
  error estimate for blocks of size 2^( 5) =       0.000551200294
  error estimate for blocks of size 2^( 6) =       0.000557368023
  error estimate for blocks of size 2^( 7) =       0.000561962970

      target function =      -0.742983795341
              le_mean =     -22.816182439202
             les_mean =     521.030806194967
             stat err =       0.000552751730
             autocorr =       1.350054711908
   target nu stat err =       0.000552751730
   target dn stat err =       0.005490576776
      target stat err =       0.004647595172
              std dev =       0.672774347267
             le_variance =       0.452625322341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452593694487
                                         uncertainty =       0.004919291668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452593694487
                                         uncertainty =       0.004919291668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475723303
  error estimate for blocks of size 2^( 2) =       0.000500291913
  error estimate for blocks of size 2^( 3) =       0.000523387643
  error estimate for blocks of size 2^( 4) =       0.000540475631
  error estimate for blocks of size 2^( 5) =       0.000551200294
  error estimate for blocks of size 2^( 6) =       0.000557368023
  error estimate for blocks of size 2^( 7) =       0.000561962970

      target function =      -0.742983795341
              le_mean =     -22.816182439202
             les_mean =     521.030806194967
             stat err =       0.000552751730
             autocorr =       1.350054711908
   target nu stat err =       0.000552751730
   target dn stat err =       0.005490576776
      target stat err =       0.004647595172
              std dev =       0.672774347267
             le_variance =       0.452625322341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452593694487
                                         uncertainty =       0.004919291668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452593694487
                                         uncertainty =       0.004919291668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475723303
  error estimate for blocks of size 2^( 2) =       0.000500291913
  error estimate for blocks of size 2^( 3) =       0.000523387643
  error estimate for blocks of size 2^( 4) =       0.000540475631
  error estimate for blocks of size 2^( 5) =       0.000551200294
  error estimate for blocks of size 2^( 6) =       0.000557368023
  error estimate for blocks of size 2^( 7) =       0.000561962970

      target function =      -0.742983795341
              le_mean =     -22.816182439202
             les_mean =     521.030806194967
             stat err =       0.000552751730
             autocorr =       1.350054711908
   target nu stat err =       0.000552751730
   target dn stat err =       0.005490576776
      target stat err =       0.004647595172
              std dev =       0.672774347267
             le_variance =       0.452625322341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452593694487
                                         uncertainty =       0.004919291668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452593694487
                                         uncertainty =       0.004919291668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475723303
  error estimate for blocks of size 2^( 2) =       0.000500291913
  error estimate for blocks of size 2^( 3) =       0.000523387643
  error estimate for blocks of size 2^( 4) =       0.000540475631
  error estimate for blocks of size 2^( 5) =       0.000551200294
  error estimate for blocks of size 2^( 6) =       0.000557368023
  error estimate for blocks of size 2^( 7) =       0.000561962970

      target function =      -0.742983795341
              le_mean =     -22.816182439202
             les_mean =     521.030806194967
             stat err =       0.000552751730
             autocorr =       1.350054711908
   target nu stat err =       0.000552751730
   target dn stat err =       0.005490576776
      target stat err =       0.004647595172
              std dev =       0.672774347267
             le_variance =       0.452625322341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742983795341        initial  <--
     6.2500e+30     6.2500e+31             0.0000e+00        -0.742983795341
     2.5000e+31     2.5000e+32             0.0000e+00        -0.742983795341
     1.0000e+32     1.0000e+33             0.0000e+00        -0.742983795341

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.7723
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2130e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8025
    reference variance = 0.34223
====================================================
  Execution time = 4.3424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5006e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447354676679
                                         uncertainty =       0.004674233260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447354676679
                                         uncertainty =       0.004674233260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472916175
  error estimate for blocks of size 2^( 2) =       0.000498542950
  error estimate for blocks of size 2^( 3) =       0.000522725987
  error estimate for blocks of size 2^( 4) =       0.000540632967
  error estimate for blocks of size 2^( 5) =       0.000552041852
  error estimate for blocks of size 2^( 6) =       0.000559608578
  error estimate for blocks of size 2^( 7) =       0.000561974538

      target function =      -0.747513682100
              le_mean =     -22.814420349930
             les_mean =     520.945075097696
             stat err =       0.000553564484
             autocorr =       1.370149949744
   target nu stat err =       0.000553564484
   target dn stat err =       0.004811708269
      target stat err =       0.004122468724
              std dev =       0.668804469225
             le_variance =       0.447299418056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281442034993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+31, overlap shift 6.2500e+32 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747535654353       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747535654353       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+32, overlap shift 2.5000e+33 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747535654353       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747535654353       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+33, overlap shift 1.0000e+34 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747535654353       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747535654353       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.327089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8441e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7244
    reference variance = 0.27667
====================================================
  Execution time = 4.3122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4707e-01
  Total weights = 2.0000e+06
  Execution time = 3.5944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447163069569
                                         uncertainty =       0.003058747556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447163069569
                                         uncertainty =       0.003058747556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472797125
  error estimate for blocks of size 2^( 2) =       0.000498136161
  error estimate for blocks of size 2^( 3) =       0.000521671184
  error estimate for blocks of size 2^( 4) =       0.000538795123
  error estimate for blocks of size 2^( 5) =       0.000549333077
  error estimate for blocks of size 2^( 6) =       0.000556872106
  error estimate for blocks of size 2^( 7) =       0.000560277253

      target function =      -0.747707046712
              le_mean =     -22.815147812087
             les_mean =     520.978043705761
             stat err =       0.000551319390
             autocorr =       1.359743152381
   target nu stat err =       0.000551319390
   target dn stat err =       0.002990364871
      target stat err =       0.002612227008
              std dev =       0.668636105748
             le_variance =       0.447074241910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447163069569
                                         uncertainty =       0.003058747556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447163069569
                                         uncertainty =       0.003058747556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472797125
  error estimate for blocks of size 2^( 2) =       0.000498136161
  error estimate for blocks of size 2^( 3) =       0.000521671184
  error estimate for blocks of size 2^( 4) =       0.000538795123
  error estimate for blocks of size 2^( 5) =       0.000549333077
  error estimate for blocks of size 2^( 6) =       0.000556872106
  error estimate for blocks of size 2^( 7) =       0.000560277253

      target function =      -0.747707046712
              le_mean =     -22.815147812087
             les_mean =     520.978043705761
             stat err =       0.000551319390
             autocorr =       1.359743152381
   target nu stat err =       0.000551319390
   target dn stat err =       0.002990364871
      target stat err =       0.002612227008
              std dev =       0.668636105748
             le_variance =       0.447074241910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447163069569
                                         uncertainty =       0.003058747556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447163069569
                                         uncertainty =       0.003058747556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472797125
  error estimate for blocks of size 2^( 2) =       0.000498136161
  error estimate for blocks of size 2^( 3) =       0.000521671184
  error estimate for blocks of size 2^( 4) =       0.000538795123
  error estimate for blocks of size 2^( 5) =       0.000549333077
  error estimate for blocks of size 2^( 6) =       0.000556872106
  error estimate for blocks of size 2^( 7) =       0.000560277253

      target function =      -0.747707046712
              le_mean =     -22.815147812087
             les_mean =     520.978043705761
             stat err =       0.000551319390
             autocorr =       1.359743152381
   target nu stat err =       0.000551319390
   target dn stat err =       0.002990364871
      target stat err =       0.002612227008
              std dev =       0.668636105748
             le_variance =       0.447074241910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447163069569
                                         uncertainty =       0.003058747556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447163069569
                                         uncertainty =       0.003058747556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472797125
  error estimate for blocks of size 2^( 2) =       0.000498136161
  error estimate for blocks of size 2^( 3) =       0.000521671184
  error estimate for blocks of size 2^( 4) =       0.000538795123
  error estimate for blocks of size 2^( 5) =       0.000549333077
  error estimate for blocks of size 2^( 6) =       0.000556872106
  error estimate for blocks of size 2^( 7) =       0.000560277253

      target function =      -0.747707046712
              le_mean =     -22.815147812087
             les_mean =     520.978043705761
             stat err =       0.000551319390
             autocorr =       1.359743152381
   target nu stat err =       0.000551319390
   target dn stat err =       0.002990364871
      target stat err =       0.002612227008
              std dev =       0.668636105748
             le_variance =       0.447074241910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747707046712        initial  <--
     6.2500e+31     6.2500e+32             0.0000e+00        -0.747707046712
     2.5000e+32     2.5000e+33             0.0000e+00        -0.747707046712
     1.0000e+33     1.0000e+34             0.0000e+00        -0.747707046712

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0422
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1949e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8602
    reference variance = 0.360718
====================================================
  Execution time = 4.5866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4751e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267976859
                                         uncertainty =       0.002231800292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267976859
                                         uncertainty =       0.002231800292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470733659
  error estimate for blocks of size 2^( 2) =       0.000496850481
  error estimate for blocks of size 2^( 3) =       0.000520307433
  error estimate for blocks of size 2^( 4) =       0.000538015826
  error estimate for blocks of size 2^( 5) =       0.000549129943
  error estimate for blocks of size 2^( 6) =       0.000554673717
  error estimate for blocks of size 2^( 7) =       0.000553563207

      target function =      -0.751028262078
              le_mean =     -22.815027052038
             les_mean =     520.968639519410
             stat err =       0.000548845673
             autocorr =       1.359408506743
   target nu stat err =       0.000548845673
   target dn stat err =       0.002462626164
      target stat err =       0.002197678566
              std dev =       0.665717925098
             le_variance =       0.443180355797


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281502705204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+32, overlap shift 6.2500e+33 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751033697036       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751033697036       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751033697036       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+32 is 1.842303e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+33, overlap shift 2.5000e+34 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751033697036       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751033697036       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751033697036       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+33 is 4.605756e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+34, overlap shift 1.0000e+35 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751033697036       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751033697036       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751033697036       residual = 6.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+34 is 1.151439e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.328463 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0628e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8109
    reference variance = 0.34198
====================================================
  Execution time = 4.3148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5051e-01
  Total weights = 2.0000e+06
  Execution time = 3.6440e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450570422994
                                         uncertainty =       0.003222965750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450570422994
                                         uncertainty =       0.003222965750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474608588
  error estimate for blocks of size 2^( 2) =       0.000499426614
  error estimate for blocks of size 2^( 3) =       0.000521729179
  error estimate for blocks of size 2^( 4) =       0.000538649566
  error estimate for blocks of size 2^( 5) =       0.000549393690
  error estimate for blocks of size 2^( 6) =       0.000555990060
  error estimate for blocks of size 2^( 7) =       0.000561263961

      target function =      -0.744831762764
              le_mean =     -22.813727071975
             les_mean =     520.916649312650
             stat err =       0.000551324319
             autocorr =       1.349407485315
   target nu stat err =       0.000551324319
   target dn stat err =       0.003456200747
      target stat err =       0.002968433613
              std dev =       0.671197901761
             le_variance =       0.450506623329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450570422994
                                         uncertainty =       0.003222965750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450570422994
                                         uncertainty =       0.003222965750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474608588
  error estimate for blocks of size 2^( 2) =       0.000499426614
  error estimate for blocks of size 2^( 3) =       0.000521729179
  error estimate for blocks of size 2^( 4) =       0.000538649566
  error estimate for blocks of size 2^( 5) =       0.000549393690
  error estimate for blocks of size 2^( 6) =       0.000555990060
  error estimate for blocks of size 2^( 7) =       0.000561263961

      target function =      -0.744831762764
              le_mean =     -22.813727071975
             les_mean =     520.916649312650
             stat err =       0.000551324319
             autocorr =       1.349407485315
   target nu stat err =       0.000551324319
   target dn stat err =       0.003456200747
      target stat err =       0.002968433613
              std dev =       0.671197901761
             le_variance =       0.450506623329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450570422994
                                         uncertainty =       0.003222965750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450570422994
                                         uncertainty =       0.003222965750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474608588
  error estimate for blocks of size 2^( 2) =       0.000499426614
  error estimate for blocks of size 2^( 3) =       0.000521729179
  error estimate for blocks of size 2^( 4) =       0.000538649566
  error estimate for blocks of size 2^( 5) =       0.000549393690
  error estimate for blocks of size 2^( 6) =       0.000555990060
  error estimate for blocks of size 2^( 7) =       0.000561263961

      target function =      -0.744831762764
              le_mean =     -22.813727071975
             les_mean =     520.916649312650
             stat err =       0.000551324319
             autocorr =       1.349407485315
   target nu stat err =       0.000551324319
   target dn stat err =       0.003456200747
      target stat err =       0.002968433613
              std dev =       0.671197901761
             le_variance =       0.450506623329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450570422994
                                         uncertainty =       0.003222965750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450570422994
                                         uncertainty =       0.003222965750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474608588
  error estimate for blocks of size 2^( 2) =       0.000499426614
  error estimate for blocks of size 2^( 3) =       0.000521729179
  error estimate for blocks of size 2^( 4) =       0.000538649566
  error estimate for blocks of size 2^( 5) =       0.000549393690
  error estimate for blocks of size 2^( 6) =       0.000555990060
  error estimate for blocks of size 2^( 7) =       0.000561263961

      target function =      -0.744831762764
              le_mean =     -22.813727071975
             les_mean =     520.916649312650
             stat err =       0.000551324319
             autocorr =       1.349407485315
   target nu stat err =       0.000551324319
   target dn stat err =       0.003456200747
      target stat err =       0.002968433613
              std dev =       0.671197901761
             le_variance =       0.450506623329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744831762764        initial  <--
     6.2500e+32     6.2500e+33             1.8423e-37        -0.744831762764
     2.5000e+33     2.5000e+34             4.6058e-38        -0.744831762764
     1.0000e+34     1.0000e+35             1.1514e-38        -0.744831762764

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1994
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2183e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.732
    reference variance = 0.542277
====================================================
  Execution time = 4.6056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4353e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4989e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443482819413
                                         uncertainty =       0.002518388598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443482819413
                                         uncertainty =       0.002518388598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470919316
  error estimate for blocks of size 2^( 2) =       0.000496173116
  error estimate for blocks of size 2^( 3) =       0.000519848080
  error estimate for blocks of size 2^( 4) =       0.000537887209
  error estimate for blocks of size 2^( 5) =       0.000548806592
  error estimate for blocks of size 2^( 6) =       0.000552290465
  error estimate for blocks of size 2^( 7) =       0.000556194533

      target function =      -0.750737813462
              le_mean =     -22.814126877736
             les_mean =     520.927914975143
             stat err =       0.000548794700
             autocorr =       1.358084549742
   target nu stat err =       0.000548794700
   target dn stat err =       0.002690204374
      target stat err =       0.002379935816
              std dev =       0.665980482815
             le_variance =       0.443530003490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281412687774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+33, overlap shift 6.2500e+34 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750744320197       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750744320197       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+34, overlap shift 2.5000e+35 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750744320197       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750744320197       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+35, overlap shift 1.0000e+36 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750744320197       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750744320197       residual = 5.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.329585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1058e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7077
    reference variance = 0.414478
====================================================
  Execution time = 4.3257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5423e-01
  Total weights = 2.0000e+06
  Execution time = 3.6585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454304714606
                                         uncertainty =       0.005085003120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454304714606
                                         uncertainty =       0.005085003120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476568235
  error estimate for blocks of size 2^( 2) =       0.000501241344
  error estimate for blocks of size 2^( 3) =       0.000523872824
  error estimate for blocks of size 2^( 4) =       0.000541306235
  error estimate for blocks of size 2^( 5) =       0.000551942778
  error estimate for blocks of size 2^( 6) =       0.000559847660
  error estimate for blocks of size 2^( 7) =       0.000564303463

      target function =      -0.741680471624
              le_mean =     -22.814607522294
             les_mean =     520.960550734862
             stat err =       0.000554350034
             autocorr =       1.353062860577
   target nu stat err =       0.000554350034
   target dn stat err =       0.005065899350
      target stat err =       0.004269992019
              std dev =       0.673969261652
             le_variance =       0.454234565652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454304714606
                                         uncertainty =       0.005085003120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454304714606
                                         uncertainty =       0.005085003120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476568235
  error estimate for blocks of size 2^( 2) =       0.000501241344
  error estimate for blocks of size 2^( 3) =       0.000523872824
  error estimate for blocks of size 2^( 4) =       0.000541306235
  error estimate for blocks of size 2^( 5) =       0.000551942778
  error estimate for blocks of size 2^( 6) =       0.000559847660
  error estimate for blocks of size 2^( 7) =       0.000564303463

      target function =      -0.741680471624
              le_mean =     -22.814607522294
             les_mean =     520.960550734862
             stat err =       0.000554350034
             autocorr =       1.353062860577
   target nu stat err =       0.000554350034
   target dn stat err =       0.005065899350
      target stat err =       0.004269992019
              std dev =       0.673969261652
             le_variance =       0.454234565652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454304714606
                                         uncertainty =       0.005085003120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454304714606
                                         uncertainty =       0.005085003120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476568235
  error estimate for blocks of size 2^( 2) =       0.000501241344
  error estimate for blocks of size 2^( 3) =       0.000523872824
  error estimate for blocks of size 2^( 4) =       0.000541306235
  error estimate for blocks of size 2^( 5) =       0.000551942778
  error estimate for blocks of size 2^( 6) =       0.000559847660
  error estimate for blocks of size 2^( 7) =       0.000564303463

      target function =      -0.741680471624
              le_mean =     -22.814607522294
             les_mean =     520.960550734862
             stat err =       0.000554350034
             autocorr =       1.353062860577
   target nu stat err =       0.000554350034
   target dn stat err =       0.005065899350
      target stat err =       0.004269992019
              std dev =       0.673969261652
             le_variance =       0.454234565652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454304714606
                                         uncertainty =       0.005085003120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454304714606
                                         uncertainty =       0.005085003120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476568235
  error estimate for blocks of size 2^( 2) =       0.000501241344
  error estimate for blocks of size 2^( 3) =       0.000523872824
  error estimate for blocks of size 2^( 4) =       0.000541306235
  error estimate for blocks of size 2^( 5) =       0.000551942778
  error estimate for blocks of size 2^( 6) =       0.000559847660
  error estimate for blocks of size 2^( 7) =       0.000564303463

      target function =      -0.741680471624
              le_mean =     -22.814607522294
             les_mean =     520.960550734862
             stat err =       0.000554350034
             autocorr =       1.353062860577
   target nu stat err =       0.000554350034
   target dn stat err =       0.005065899350
      target stat err =       0.004269992019
              std dev =       0.673969261652
             le_variance =       0.454234565652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741680471624        initial  <--
     6.2500e+33     6.2500e+34             0.0000e+00        -0.741680471624
     2.5000e+34     2.5000e+35             0.0000e+00        -0.741680471624
     1.0000e+35     1.0000e+36             0.0000e+00        -0.741680471624

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3291
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2239e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.627
    reference variance = 0.968662
====================================================
  Execution time = 4.3643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4820e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4720e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447757603683
                                         uncertainty =       0.003360664693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447757603683
                                         uncertainty =       0.003360664693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473394540
  error estimate for blocks of size 2^( 2) =       0.000498504382
  error estimate for blocks of size 2^( 3) =       0.000522039197
  error estimate for blocks of size 2^( 4) =       0.000539232897
  error estimate for blocks of size 2^( 5) =       0.000549733638
  error estimate for blocks of size 2^( 6) =       0.000556497237
  error estimate for blocks of size 2^( 7) =       0.000559487920

      target function =      -0.746750529639
              le_mean =     -22.814802073226
             les_mean =     520.963398197222
             stat err =       0.000551237923
             autocorr =       1.355912567558
   target nu stat err =       0.000551237923
   target dn stat err =       0.003776137683
      target stat err =       0.003253305603
              std dev =       0.669480978692
             le_variance =       0.448204780831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281480207323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+34, overlap shift 6.2500e+35 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746763412120       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746763412120       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+35, overlap shift 2.5000e+36 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746763412120       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746763412120       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+36, overlap shift 1.0000e+37 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746763412120       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746763412120       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.330708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8374e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7826
    reference variance = 0.380107
====================================================
  Execution time = 4.5960e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5846e-01
  Total weights = 2.0000e+06
  Execution time = 3.5944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458516258949
                                         uncertainty =       0.006810619999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458516258949
                                         uncertainty =       0.006810619999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478777700
  error estimate for blocks of size 2^( 2) =       0.000503536025
  error estimate for blocks of size 2^( 3) =       0.000526638130
  error estimate for blocks of size 2^( 4) =       0.000543030423
  error estimate for blocks of size 2^( 5) =       0.000553909360
  error estimate for blocks of size 2^( 6) =       0.000561614343
  error estimate for blocks of size 2^( 7) =       0.000564667934

      target function =      -0.738144340084
              le_mean =     -22.814924205335
             les_mean =     520.979222438470
             stat err =       0.000555805515
             autocorr =       1.347652356207
   target nu stat err =       0.000555805515
   target dn stat err =       0.007153217557
      target stat err =       0.005943738782
              std dev =       0.677093917042
             le_variance =       0.458456172495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458516258949
                                         uncertainty =       0.006810619999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458516258949
                                         uncertainty =       0.006810619999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478777700
  error estimate for blocks of size 2^( 2) =       0.000503536025
  error estimate for blocks of size 2^( 3) =       0.000526638130
  error estimate for blocks of size 2^( 4) =       0.000543030423
  error estimate for blocks of size 2^( 5) =       0.000553909360
  error estimate for blocks of size 2^( 6) =       0.000561614343
  error estimate for blocks of size 2^( 7) =       0.000564667934

      target function =      -0.738144340084
              le_mean =     -22.814924205335
             les_mean =     520.979222438470
             stat err =       0.000555805515
             autocorr =       1.347652356207
   target nu stat err =       0.000555805515
   target dn stat err =       0.007153217557
      target stat err =       0.005943738782
              std dev =       0.677093917042
             le_variance =       0.458456172495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458516258949
                                         uncertainty =       0.006810619999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458516258949
                                         uncertainty =       0.006810619999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478777700
  error estimate for blocks of size 2^( 2) =       0.000503536025
  error estimate for blocks of size 2^( 3) =       0.000526638130
  error estimate for blocks of size 2^( 4) =       0.000543030423
  error estimate for blocks of size 2^( 5) =       0.000553909360
  error estimate for blocks of size 2^( 6) =       0.000561614343
  error estimate for blocks of size 2^( 7) =       0.000564667934

      target function =      -0.738144340084
              le_mean =     -22.814924205335
             les_mean =     520.979222438470
             stat err =       0.000555805515
             autocorr =       1.347652356207
   target nu stat err =       0.000555805515
   target dn stat err =       0.007153217557
      target stat err =       0.005943738782
              std dev =       0.677093917042
             le_variance =       0.458456172495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458516258949
                                         uncertainty =       0.006810619999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458516258949
                                         uncertainty =       0.006810619999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478777700
  error estimate for blocks of size 2^( 2) =       0.000503536025
  error estimate for blocks of size 2^( 3) =       0.000526638130
  error estimate for blocks of size 2^( 4) =       0.000543030423
  error estimate for blocks of size 2^( 5) =       0.000553909360
  error estimate for blocks of size 2^( 6) =       0.000561614343
  error estimate for blocks of size 2^( 7) =       0.000564667934

      target function =      -0.738144340084
              le_mean =     -22.814924205335
             les_mean =     520.979222438470
             stat err =       0.000555805515
             autocorr =       1.347652356207
   target nu stat err =       0.000555805515
   target dn stat err =       0.007153217557
      target stat err =       0.005943738782
              std dev =       0.677093917042
             le_variance =       0.458456172495


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738144340084        initial  <--
     6.2500e+34     6.2500e+35             0.0000e+00        -0.738144340084
     2.5000e+35     2.5000e+36             0.0000e+00        -0.738144340084
     1.0000e+36     1.0000e+37             0.0000e+00        -0.738144340084

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8821
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2226e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8197
    reference variance = 0.338359
====================================================
  Execution time = 4.3962e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4661e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4859e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446591038794
                                         uncertainty =       0.003268232647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446591038794
                                         uncertainty =       0.003268232647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472553768
  error estimate for blocks of size 2^( 2) =       0.000497748488
  error estimate for blocks of size 2^( 3) =       0.000521873323
  error estimate for blocks of size 2^( 4) =       0.000539468635
  error estimate for blocks of size 2^( 5) =       0.000550773324
  error estimate for blocks of size 2^( 6) =       0.000558199915
  error estimate for blocks of size 2^( 7) =       0.000559939815

      target function =      -0.748109231364
              le_mean =     -22.814292878079
             les_mean =     520.938573430314
             stat err =       0.000552095422
             autocorr =       1.364978566089
   target nu stat err =       0.000552095422
   target dn stat err =       0.003230782594
      target stat err =       0.002810134991
              std dev =       0.668291947327
             le_variance =       0.446614126863


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429287808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+35, overlap shift 6.2500e+36 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748118231188       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748118231188       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+35 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+36, overlap shift 2.5000e+37 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748118231188       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748118231188       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+36 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+37, overlap shift 1.0000e+38 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748118231188       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748118231188       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+37 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.331800 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8832e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8641
    reference variance = 0.333289
====================================================
  Execution time = 4.5204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4143e-01
  Total weights = 2.0000e+06
  Execution time = 3.5935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345483439
                                         uncertainty =       0.002415770607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345483439
                                         uncertainty =       0.002415770607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469803527
  error estimate for blocks of size 2^( 2) =       0.000495320870
  error estimate for blocks of size 2^( 3) =       0.000518952754
  error estimate for blocks of size 2^( 4) =       0.000536432589
  error estimate for blocks of size 2^( 5) =       0.000548415431
  error estimate for blocks of size 2^( 6) =       0.000555443020
  error estimate for blocks of size 2^( 7) =       0.000558694642

      target function =      -0.752531626579
              le_mean =     -22.814628568441
             les_mean =     520.948707203831
             stat err =       0.000549746421
             autocorr =       1.369280030103
   target nu stat err =       0.000549746421
   target dn stat err =       0.002439419406
      target stat err =       0.002185996598
              std dev =       0.664402520047
             le_variance =       0.441430708645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345483439
                                         uncertainty =       0.002415770607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345483439
                                         uncertainty =       0.002415770607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469803527
  error estimate for blocks of size 2^( 2) =       0.000495320870
  error estimate for blocks of size 2^( 3) =       0.000518952754
  error estimate for blocks of size 2^( 4) =       0.000536432589
  error estimate for blocks of size 2^( 5) =       0.000548415431
  error estimate for blocks of size 2^( 6) =       0.000555443020
  error estimate for blocks of size 2^( 7) =       0.000558694642

      target function =      -0.752531626579
              le_mean =     -22.814628568441
             les_mean =     520.948707203831
             stat err =       0.000549746421
             autocorr =       1.369280030103
   target nu stat err =       0.000549746421
   target dn stat err =       0.002439419406
      target stat err =       0.002185996598
              std dev =       0.664402520047
             le_variance =       0.441430708645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345483439
                                         uncertainty =       0.002415770607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345483439
                                         uncertainty =       0.002415770607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469803527
  error estimate for blocks of size 2^( 2) =       0.000495320870
  error estimate for blocks of size 2^( 3) =       0.000518952754
  error estimate for blocks of size 2^( 4) =       0.000536432589
  error estimate for blocks of size 2^( 5) =       0.000548415431
  error estimate for blocks of size 2^( 6) =       0.000555443020
  error estimate for blocks of size 2^( 7) =       0.000558694642

      target function =      -0.752531626579
              le_mean =     -22.814628568441
             les_mean =     520.948707203831
             stat err =       0.000549746421
             autocorr =       1.369280030103
   target nu stat err =       0.000549746421
   target dn stat err =       0.002439419406
      target stat err =       0.002185996598
              std dev =       0.664402520047
             le_variance =       0.441430708645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345483439
                                         uncertainty =       0.002415770607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441345483439
                                         uncertainty =       0.002415770607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469803527
  error estimate for blocks of size 2^( 2) =       0.000495320870
  error estimate for blocks of size 2^( 3) =       0.000518952754
  error estimate for blocks of size 2^( 4) =       0.000536432589
  error estimate for blocks of size 2^( 5) =       0.000548415431
  error estimate for blocks of size 2^( 6) =       0.000555443020
  error estimate for blocks of size 2^( 7) =       0.000558694642

      target function =      -0.752531626579
              le_mean =     -22.814628568441
             les_mean =     520.948707203831
             stat err =       0.000549746421
             autocorr =       1.369280030103
   target nu stat err =       0.000549746421
   target dn stat err =       0.002439419406
      target stat err =       0.002185996598
              std dev =       0.664402520047
             le_variance =       0.441430708645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752531626579        initial  <--
     6.2500e+35     6.2500e+36             0.0000e+00        -0.752531626579
     2.5000e+36     2.5000e+37             0.0000e+00        -0.752531626579
     1.0000e+37     1.0000e+38             0.0000e+00        -0.752531626579

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.1186
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2196e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.891
    reference variance = 0.58099
====================================================
  Execution time = 4.3645e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5367e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5036e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453715428269
                                         uncertainty =       0.005777063621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453715428269
                                         uncertainty =       0.005777063621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476270879
  error estimate for blocks of size 2^( 2) =       0.000501598525
  error estimate for blocks of size 2^( 3) =       0.000524939772
  error estimate for blocks of size 2^( 4) =       0.000541739160
  error estimate for blocks of size 2^( 5) =       0.000552786513
  error estimate for blocks of size 2^( 6) =       0.000558593052
  error estimate for blocks of size 2^( 7) =       0.000562491910

      target function =      -0.742145428425
              le_mean =     -22.815023568472
             les_mean =     520.978968102593
             stat err =       0.000553902659
             autocorr =       1.352567178554
   target nu stat err =       0.000553902659
   target dn stat err =       0.004887483648
      target stat err =       0.004130497974
              std dev =       0.673548735812
             le_variance =       0.453667899514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281502356847e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+36, overlap shift 6.2500e+37 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742167163052       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742167163052       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742167163640       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+36 is 1.137558e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+37, overlap shift 2.5000e+38 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742167163052       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742167163052       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742167159915       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+37 is 2.843895e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+38, overlap shift 1.0000e+39 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742167163052       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742167163052       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742167159915       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+38 is 7.109738e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.333217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8692e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7159
    reference variance = 0.341176
====================================================
  Execution time = 4.3069e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4837e-01
  Total weights = 2.0000e+06
  Execution time = 3.5774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448332459986
                                         uncertainty =       0.003284325536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448332459986
                                         uncertainty =       0.003284325536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473481064
  error estimate for blocks of size 2^( 2) =       0.000498917723
  error estimate for blocks of size 2^( 3) =       0.000522168117
  error estimate for blocks of size 2^( 4) =       0.000539470485
  error estimate for blocks of size 2^( 5) =       0.000551509259
  error estimate for blocks of size 2^( 6) =       0.000557946736
  error estimate for blocks of size 2^( 7) =       0.000562040677

      target function =      -0.746619113870
              le_mean =     -22.814515746197
             les_mean =     520.950497144765
             stat err =       0.000552741789
             autocorr =       1.362822737406
   target nu stat err =       0.000552741789
   target dn stat err =       0.003398858107
      target stat err =       0.002938929447
              std dev =       0.669603341899
             le_variance =       0.448368635482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448332459986
                                         uncertainty =       0.003284325536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448332459986
                                         uncertainty =       0.003284325536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473481064
  error estimate for blocks of size 2^( 2) =       0.000498917723
  error estimate for blocks of size 2^( 3) =       0.000522168117
  error estimate for blocks of size 2^( 4) =       0.000539470485
  error estimate for blocks of size 2^( 5) =       0.000551509259
  error estimate for blocks of size 2^( 6) =       0.000557946736
  error estimate for blocks of size 2^( 7) =       0.000562040677

      target function =      -0.746619113870
              le_mean =     -22.814515746197
             les_mean =     520.950497144765
             stat err =       0.000552741789
             autocorr =       1.362822737406
   target nu stat err =       0.000552741789
   target dn stat err =       0.003398858107
      target stat err =       0.002938929447
              std dev =       0.669603341899
             le_variance =       0.448368635482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448332459986
                                         uncertainty =       0.003284325536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448332459986
                                         uncertainty =       0.003284325536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473481064
  error estimate for blocks of size 2^( 2) =       0.000498917723
  error estimate for blocks of size 2^( 3) =       0.000522168117
  error estimate for blocks of size 2^( 4) =       0.000539470485
  error estimate for blocks of size 2^( 5) =       0.000551509259
  error estimate for blocks of size 2^( 6) =       0.000557946736
  error estimate for blocks of size 2^( 7) =       0.000562040677

      target function =      -0.746619113870
              le_mean =     -22.814515746197
             les_mean =     520.950497144765
             stat err =       0.000552741789
             autocorr =       1.362822737406
   target nu stat err =       0.000552741789
   target dn stat err =       0.003398858107
      target stat err =       0.002938929447
              std dev =       0.669603341899
             le_variance =       0.448368635482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448332459986
                                         uncertainty =       0.003284325536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448332459986
                                         uncertainty =       0.003284325536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473481064
  error estimate for blocks of size 2^( 2) =       0.000498917723
  error estimate for blocks of size 2^( 3) =       0.000522168117
  error estimate for blocks of size 2^( 4) =       0.000539470485
  error estimate for blocks of size 2^( 5) =       0.000551509259
  error estimate for blocks of size 2^( 6) =       0.000557946736
  error estimate for blocks of size 2^( 7) =       0.000562040677

      target function =      -0.746619113870
              le_mean =     -22.814515746197
             les_mean =     520.950497144765
             stat err =       0.000552741789
             autocorr =       1.362822737406
   target nu stat err =       0.000552741789
   target dn stat err =       0.003398858107
      target stat err =       0.002938929447
              std dev =       0.669603341899
             le_variance =       0.448368635482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746619113870        initial  <--
     6.2500e+36     6.2500e+37             1.1376e-41        -0.746619113870
     2.5000e+37     2.5000e+38             2.8439e-42        -0.746619113870
     1.0000e+38     1.0000e+39             7.1097e-43        -0.746619113870

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9444
  </log>
  <optVariables href="FORM.s040.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2266e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7794
    reference variance = 0.410187
====================================================
  Execution time = 4.4215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5101e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4733e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450993529135
                                         uncertainty =       0.004255238178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450993529135
                                         uncertainty =       0.004255238178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474873149
  error estimate for blocks of size 2^( 2) =       0.000500125458
  error estimate for blocks of size 2^( 3) =       0.000523910183
  error estimate for blocks of size 2^( 4) =       0.000541466878
  error estimate for blocks of size 2^( 5) =       0.000551659751
  error estimate for blocks of size 2^( 6) =       0.000557640760
  error estimate for blocks of size 2^( 7) =       0.000560905383

      target function =      -0.744397652168
              le_mean =     -22.814070233439
             les_mean =     520.932809405329
             stat err =       0.000552918193
             autocorr =       1.355709168965
   target nu stat err =       0.000552918193
   target dn stat err =       0.004240444896
      target stat err =       0.003613156218
              std dev =       0.671572047164
             le_variance =       0.451009014532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281407023344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+37, overlap shift 6.2500e+38 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744414284971       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744414284971       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+38, overlap shift 2.5000e+39 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744414284971       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744414284971       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+39, overlap shift 1.0000e+40 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744414284971       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744414284971       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.334378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8962e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.9374
    reference variance = 0.343499
====================================================
  Execution time = 4.3508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4722e-01
  Total weights = 2.0000e+06
  Execution time = 3.5905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447165063376
                                         uncertainty =       0.003860808735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447165063376
                                         uncertainty =       0.003860808735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472874269
  error estimate for blocks of size 2^( 2) =       0.000497782358
  error estimate for blocks of size 2^( 3) =       0.000521649197
  error estimate for blocks of size 2^( 4) =       0.000539175012
  error estimate for blocks of size 2^( 5) =       0.000550099337
  error estimate for blocks of size 2^( 6) =       0.000556234759
  error estimate for blocks of size 2^( 7) =       0.000559689256

      target function =      -0.747576944062
              le_mean =     -22.815223253829
             les_mean =     520.981632046110
             stat err =       0.000551299591
             autocorr =       1.359201908791
   target nu stat err =       0.000551299591
   target dn stat err =       0.003739895156
      target stat err =       0.003232318922
              std dev =       0.668745203842
             le_variance =       0.447220147661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447165063376
                                         uncertainty =       0.003860808735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447165063376
                                         uncertainty =       0.003860808735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472874269
  error estimate for blocks of size 2^( 2) =       0.000497782358
  error estimate for blocks of size 2^( 3) =       0.000521649197
  error estimate for blocks of size 2^( 4) =       0.000539175012
  error estimate for blocks of size 2^( 5) =       0.000550099337
  error estimate for blocks of size 2^( 6) =       0.000556234759
  error estimate for blocks of size 2^( 7) =       0.000559689256

      target function =      -0.747576944062
              le_mean =     -22.815223253829
             les_mean =     520.981632046110
             stat err =       0.000551299591
             autocorr =       1.359201908794
   target nu stat err =       0.000551299591
   target dn stat err =       0.003739895156
      target stat err =       0.003232318922
              std dev =       0.668745203842
             le_variance =       0.447220147661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447165063376
                                         uncertainty =       0.003860808735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447165063376
                                         uncertainty =       0.003860808735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472874269
  error estimate for blocks of size 2^( 2) =       0.000497782358
  error estimate for blocks of size 2^( 3) =       0.000521649197
  error estimate for blocks of size 2^( 4) =       0.000539175012
  error estimate for blocks of size 2^( 5) =       0.000550099337
  error estimate for blocks of size 2^( 6) =       0.000556234759
  error estimate for blocks of size 2^( 7) =       0.000559689256

      target function =      -0.747576944062
              le_mean =     -22.815223253829
             les_mean =     520.981632046110
             stat err =       0.000551299591
             autocorr =       1.359201908794
   target nu stat err =       0.000551299591
   target dn stat err =       0.003739895156
      target stat err =       0.003232318922
              std dev =       0.668745203842
             le_variance =       0.447220147661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447165063376
                                         uncertainty =       0.003860808735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447165063376
                                         uncertainty =       0.003860808735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472874269
  error estimate for blocks of size 2^( 2) =       0.000497782358
  error estimate for blocks of size 2^( 3) =       0.000521649197
  error estimate for blocks of size 2^( 4) =       0.000539175012
  error estimate for blocks of size 2^( 5) =       0.000550099337
  error estimate for blocks of size 2^( 6) =       0.000556234759
  error estimate for blocks of size 2^( 7) =       0.000559689256

      target function =      -0.747576944062
              le_mean =     -22.815223253829
             les_mean =     520.981632046110
             stat err =       0.000551299591
             autocorr =       1.359201908794
   target nu stat err =       0.000551299591
   target dn stat err =       0.003739895156
      target stat err =       0.003232318922
              std dev =       0.668745203842
             le_variance =       0.447220147661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747576944062        initial  <--
     6.2500e+37     6.2500e+38             0.0000e+00        -0.747576944062
     2.5000e+38     2.5000e+39             0.0000e+00        -0.747576944062
     1.0000e+39     1.0000e+40             0.0000e+00        -0.747576944062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4073
  </log>
  <optVariables href="FORM.s041.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2038e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8923
    reference variance = 0.437845
====================================================
  Execution time = 4.5789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5029e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4767e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450332431361
                                         uncertainty =       0.003809229327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450332431361
                                         uncertainty =       0.003809229327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474495320
  error estimate for blocks of size 2^( 2) =       0.000499453455
  error estimate for blocks of size 2^( 3) =       0.000523181023
  error estimate for blocks of size 2^( 4) =       0.000539931706
  error estimate for blocks of size 2^( 5) =       0.000550554888
  error estimate for blocks of size 2^( 6) =       0.000556313879
  error estimate for blocks of size 2^( 7) =       0.000560714110

      target function =      -0.744994703001
              le_mean =     -22.814628100837
             les_mean =     520.957546772645
             stat err =       0.000551878646
             autocorr =       1.352767972103
   target nu stat err =       0.000551878646
   target dn stat err =       0.003601735990
      target stat err =       0.003093727784
              std dev =       0.671037717502
             le_variance =       0.450291618310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281462810084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+38, overlap shift 6.2500e+39 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745006416496       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745006416496       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+39, overlap shift 2.5000e+40 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745006416496       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745006416496       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+40, overlap shift 1.0000e+41 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745006416496       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745006416496       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.335516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0567e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7713
    reference variance = 0.360029
====================================================
  Execution time = 4.3451e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5304e-01
  Total weights = 2.0000e+06
  Execution time = 3.5769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452976660504
                                         uncertainty =       0.003986060604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452976660504
                                         uncertainty =       0.003986060604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475941052
  error estimate for blocks of size 2^( 2) =       0.000501014090
  error estimate for blocks of size 2^( 3) =       0.000525118793
  error estimate for blocks of size 2^( 4) =       0.000542452484
  error estimate for blocks of size 2^( 5) =       0.000553831744
  error estimate for blocks of size 2^( 6) =       0.000559513400
  error estimate for blocks of size 2^( 7) =       0.000564142089

      target function =      -0.742678877824
              le_mean =     -22.814796496384
             les_mean =     520.967978715503
             stat err =       0.000554984929
             autocorr =       1.359740542956
   target nu stat err =       0.000554984929
   target dn stat err =       0.004482629500
      target stat err =       0.003800750496
              std dev =       0.673082291111
             le_variance =       0.453039770607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452976660504
                                         uncertainty =       0.003986060604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452976660504
                                         uncertainty =       0.003986060604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475941052
  error estimate for blocks of size 2^( 2) =       0.000501014090
  error estimate for blocks of size 2^( 3) =       0.000525118793
  error estimate for blocks of size 2^( 4) =       0.000542452484
  error estimate for blocks of size 2^( 5) =       0.000553831744
  error estimate for blocks of size 2^( 6) =       0.000559513400
  error estimate for blocks of size 2^( 7) =       0.000564142089

      target function =      -0.742678877824
              le_mean =     -22.814796496384
             les_mean =     520.967978715503
             stat err =       0.000554984929
             autocorr =       1.359740542956
   target nu stat err =       0.000554984929
   target dn stat err =       0.004482629500
      target stat err =       0.003800750496
              std dev =       0.673082291111
             le_variance =       0.453039770607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452976660504
                                         uncertainty =       0.003986060604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452976660504
                                         uncertainty =       0.003986060604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475941052
  error estimate for blocks of size 2^( 2) =       0.000501014090
  error estimate for blocks of size 2^( 3) =       0.000525118793
  error estimate for blocks of size 2^( 4) =       0.000542452484
  error estimate for blocks of size 2^( 5) =       0.000553831744
  error estimate for blocks of size 2^( 6) =       0.000559513400
  error estimate for blocks of size 2^( 7) =       0.000564142089

      target function =      -0.742678877824
              le_mean =     -22.814796496384
             les_mean =     520.967978715503
             stat err =       0.000554984929
             autocorr =       1.359740542956
   target nu stat err =       0.000554984929
   target dn stat err =       0.004482629500
      target stat err =       0.003800750496
              std dev =       0.673082291111
             le_variance =       0.453039770607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452976660504
                                         uncertainty =       0.003986060604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452976660504
                                         uncertainty =       0.003986060604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475941052
  error estimate for blocks of size 2^( 2) =       0.000501014090
  error estimate for blocks of size 2^( 3) =       0.000525118793
  error estimate for blocks of size 2^( 4) =       0.000542452484
  error estimate for blocks of size 2^( 5) =       0.000553831744
  error estimate for blocks of size 2^( 6) =       0.000559513400
  error estimate for blocks of size 2^( 7) =       0.000564142089

      target function =      -0.742678877824
              le_mean =     -22.814796496384
             les_mean =     520.967978715503
             stat err =       0.000554984929
             autocorr =       1.359740542956
   target nu stat err =       0.000554984929
   target dn stat err =       0.004482629500
      target stat err =       0.003800750496
              std dev =       0.673082291111
             le_variance =       0.453039770607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742678877824        initial  <--
     6.2500e+38     6.2500e+39             0.0000e+00        -0.742678877824
     2.5000e+39     2.5000e+40             0.0000e+00        -0.742678877824
     1.0000e+40     1.0000e+41             0.0000e+00        -0.742678877824

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3060
  </log>
  <optVariables href="FORM.s042.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2188e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8221
    reference variance = 0.299735
====================================================
  Execution time = 4.4043e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4986e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5053e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449758765807
                                         uncertainty =       0.004302834137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449758765807
                                         uncertainty =       0.004302834137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474266183
  error estimate for blocks of size 2^( 2) =       0.000499184709
  error estimate for blocks of size 2^( 3) =       0.000522400789
  error estimate for blocks of size 2^( 4) =       0.000538998420
  error estimate for blocks of size 2^( 5) =       0.000550534450
  error estimate for blocks of size 2^( 6) =       0.000556031897
  error estimate for blocks of size 2^( 7) =       0.000559153933

      target function =      -0.745341508239
              le_mean =     -22.815358472002
             les_mean =     520.990438805190
             stat err =       0.000551179675
             autocorr =       1.350647662463
   target nu stat err =       0.000551179675
   target dn stat err =       0.004268256685
      target stat err =       0.003652032383
              std dev =       0.670713667778
             le_variance =       0.449856824145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281535847200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+39, overlap shift 6.2500e+40 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745358273243       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745358273243       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+40, overlap shift 2.5000e+41 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745358273243       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745358273243       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+41, overlap shift 1.0000e+42 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745358273243       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745358273243       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.336623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9109e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7895
    reference variance = 0.317948
====================================================
  Execution time = 4.3309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5112e-01
  Total weights = 2.0000e+06
  Execution time = 3.5872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451058111988
                                         uncertainty =       0.003621286518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451058111988
                                         uncertainty =       0.003621286518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474930663
  error estimate for blocks of size 2^( 2) =       0.000500301947
  error estimate for blocks of size 2^( 3) =       0.000523639793
  error estimate for blocks of size 2^( 4) =       0.000541239211
  error estimate for blocks of size 2^( 5) =       0.000552825415
  error estimate for blocks of size 2^( 6) =       0.000559134589
  error estimate for blocks of size 2^( 7) =       0.000563533553

      target function =      -0.744276758519
              le_mean =     -22.815629008071
             les_mean =     521.004045078239
             stat err =       0.000554183192
             autocorr =       1.361589769424
   target nu stat err =       0.000554183192
   target dn stat err =       0.003860344513
      target stat err =       0.003306394657
              std dev =       0.671653385214
             le_variance =       0.451118269870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451058111988
                                         uncertainty =       0.003621286518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451058111988
                                         uncertainty =       0.003621286518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474930663
  error estimate for blocks of size 2^( 2) =       0.000500301947
  error estimate for blocks of size 2^( 3) =       0.000523639793
  error estimate for blocks of size 2^( 4) =       0.000541239211
  error estimate for blocks of size 2^( 5) =       0.000552825415
  error estimate for blocks of size 2^( 6) =       0.000559134589
  error estimate for blocks of size 2^( 7) =       0.000563533553

      target function =      -0.744276758519
              le_mean =     -22.815629008071
             les_mean =     521.004045078239
             stat err =       0.000554183192
             autocorr =       1.361589769424
   target nu stat err =       0.000554183192
   target dn stat err =       0.003860344513
      target stat err =       0.003306394657
              std dev =       0.671653385214
             le_variance =       0.451118269870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451058111988
                                         uncertainty =       0.003621286518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451058111988
                                         uncertainty =       0.003621286518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474930663
  error estimate for blocks of size 2^( 2) =       0.000500301947
  error estimate for blocks of size 2^( 3) =       0.000523639793
  error estimate for blocks of size 2^( 4) =       0.000541239211
  error estimate for blocks of size 2^( 5) =       0.000552825415
  error estimate for blocks of size 2^( 6) =       0.000559134589
  error estimate for blocks of size 2^( 7) =       0.000563533553

      target function =      -0.744276758519
              le_mean =     -22.815629008071
             les_mean =     521.004045078239
             stat err =       0.000554183192
             autocorr =       1.361589769424
   target nu stat err =       0.000554183192
   target dn stat err =       0.003860344513
      target stat err =       0.003306394657
              std dev =       0.671653385214
             le_variance =       0.451118269870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451058111988
                                         uncertainty =       0.003621286518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451058111988
                                         uncertainty =       0.003621286518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474930663
  error estimate for blocks of size 2^( 2) =       0.000500301947
  error estimate for blocks of size 2^( 3) =       0.000523639793
  error estimate for blocks of size 2^( 4) =       0.000541239211
  error estimate for blocks of size 2^( 5) =       0.000552825415
  error estimate for blocks of size 2^( 6) =       0.000559134589
  error estimate for blocks of size 2^( 7) =       0.000563533553

      target function =      -0.744276758519
              le_mean =     -22.815629008071
             les_mean =     521.004045078239
             stat err =       0.000554183192
             autocorr =       1.361589769424
   target nu stat err =       0.000554183192
   target dn stat err =       0.003860344513
      target stat err =       0.003306394657
              std dev =       0.671653385214
             le_variance =       0.451118269870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744276758519        initial  <--
     6.2500e+39     6.2500e+40             0.0000e+00        -0.744276758519
     2.5000e+40     2.5000e+41             0.0000e+00        -0.744276758519
     1.0000e+41     1.0000e+42             0.0000e+00        -0.744276758519

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1946
  </log>
  <optVariables href="FORM.s043.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2031e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8788
    reference variance = 0.403987
====================================================
  Execution time = 4.4030e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.3971e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5058e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439703116293
                                         uncertainty =       0.002768352731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439703116293
                                         uncertainty =       0.002768352731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468885308
  error estimate for blocks of size 2^( 2) =       0.000494079879
  error estimate for blocks of size 2^( 3) =       0.000517885832
  error estimate for blocks of size 2^( 4) =       0.000535251824
  error estimate for blocks of size 2^( 5) =       0.000545964732
  error estimate for blocks of size 2^( 6) =       0.000553036666
  error estimate for blocks of size 2^( 7) =       0.000557428690

      target function =      -0.754016205084
              le_mean =     -22.814295787081
             les_mean =     520.931798905449
             stat err =       0.000547920478
             autocorr =       1.365531785277
   target nu stat err =       0.000547920478
   target dn stat err =       0.002440854507
      target stat err =       0.002193756877
              std dev =       0.663103962335
             le_variance =       0.439706864865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429578708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+40, overlap shift 6.2500e+41 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.754021581549       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.754021581549       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.753906250000       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+40 is 1.631423e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+41, overlap shift 2.5000e+42 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.754021581549       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.754021581549       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.753906250000       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+41 is 4.078556e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+42, overlap shift 1.0000e+43 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.754021581549       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.754021581549       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.337934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9099e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7996
    reference variance = 0.420977
====================================================
  Execution time = 4.5216e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5559e-01
  Total weights = 2.0000e+06
  Execution time = 3.6024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455597169407
                                         uncertainty =       0.004569497140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455597169407
                                         uncertainty =       0.004569497140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477277496
  error estimate for blocks of size 2^( 2) =       0.000502342042
  error estimate for blocks of size 2^( 3) =       0.000525557388
  error estimate for blocks of size 2^( 4) =       0.000543652014
  error estimate for blocks of size 2^( 5) =       0.000555566275
  error estimate for blocks of size 2^( 6) =       0.000560622261
  error estimate for blocks of size 2^( 7) =       0.000564791737

      target function =      -0.740578099733
              le_mean =     -22.813900724286
             les_mean =     520.929653646613
             stat err =       0.000556158072
             autocorr =       1.357858683580
   target nu stat err =       0.000556158072
   target dn stat err =       0.004380454943
      target stat err =       0.003690990873
              std dev =       0.674972308202
             le_variance =       0.455587616840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455597169407
                                         uncertainty =       0.004569497140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455597169407
                                         uncertainty =       0.004569497140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477277496
  error estimate for blocks of size 2^( 2) =       0.000502342042
  error estimate for blocks of size 2^( 3) =       0.000525557388
  error estimate for blocks of size 2^( 4) =       0.000543652014
  error estimate for blocks of size 2^( 5) =       0.000555566275
  error estimate for blocks of size 2^( 6) =       0.000560622261
  error estimate for blocks of size 2^( 7) =       0.000564791737

      target function =      -0.740578099733
              le_mean =     -22.813900724286
             les_mean =     520.929653646613
             stat err =       0.000556158072
             autocorr =       1.357858683580
   target nu stat err =       0.000556158072
   target dn stat err =       0.004380454943
      target stat err =       0.003690990873
              std dev =       0.674972308202
             le_variance =       0.455587616840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455597169407
                                         uncertainty =       0.004569497140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455597169407
                                         uncertainty =       0.004569497140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477277496
  error estimate for blocks of size 2^( 2) =       0.000502342042
  error estimate for blocks of size 2^( 3) =       0.000525557388
  error estimate for blocks of size 2^( 4) =       0.000543652014
  error estimate for blocks of size 2^( 5) =       0.000555566275
  error estimate for blocks of size 2^( 6) =       0.000560622261
  error estimate for blocks of size 2^( 7) =       0.000564791737

      target function =      -0.740578099733
              le_mean =     -22.813900724286
             les_mean =     520.929653646613
             stat err =       0.000556158072
             autocorr =       1.357858683580
   target nu stat err =       0.000556158072
   target dn stat err =       0.004380454943
      target stat err =       0.003690990873
              std dev =       0.674972308202
             le_variance =       0.455587616840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455597169407
                                         uncertainty =       0.004569497140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455597169407
                                         uncertainty =       0.004569497140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477277496
  error estimate for blocks of size 2^( 2) =       0.000502342042
  error estimate for blocks of size 2^( 3) =       0.000525557388
  error estimate for blocks of size 2^( 4) =       0.000543652014
  error estimate for blocks of size 2^( 5) =       0.000555566275
  error estimate for blocks of size 2^( 6) =       0.000560622261
  error estimate for blocks of size 2^( 7) =       0.000564791737

      target function =      -0.740578099733
              le_mean =     -22.813900724286
             les_mean =     520.929653646613
             stat err =       0.000556158072
             autocorr =       1.357858683580
   target nu stat err =       0.000556158072
   target dn stat err =       0.004380454943
      target stat err =       0.003690990873
              std dev =       0.674972308202
             le_variance =       0.455587616840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740578099733        initial  <--
     6.2500e+40     6.2500e+41             1.6314e-45        -0.740578099733
     2.5000e+41     2.5000e+42             4.0786e-46        -0.740578099733
     1.0000e+42     1.0000e+43             0.0000e+00        -0.740578099733

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.1727
  </log>
  <optVariables href="FORM.s044.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2228e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8376
    reference variance = 0.249212
====================================================
  Execution time = 4.3740e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4451e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4918e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444600465070
                                         uncertainty =       0.002660222834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444600465070
                                         uncertainty =       0.002660222834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471438593
  error estimate for blocks of size 2^( 2) =       0.000496271913
  error estimate for blocks of size 2^( 3) =       0.000519346923
  error estimate for blocks of size 2^( 4) =       0.000536798431
  error estimate for blocks of size 2^( 5) =       0.000548175477
  error estimate for blocks of size 2^( 6) =       0.000554453382
  error estimate for blocks of size 2^( 7) =       0.000555843681

      target function =      -0.749889287021
              le_mean =     -22.815183551305
             les_mean =     520.977108951239
             stat err =       0.000548817743
             autocorr =       1.355208206797
   target nu stat err =       0.000548817743
   target dn stat err =       0.002895048261
      target stat err =       0.002547607900
              std dev =       0.666714851898
             le_variance =       0.444508693741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281518355131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+41, overlap shift 6.2500e+42 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749896948945       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749896948945       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749896948945       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+41 is 2.063875e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+42, overlap shift 2.5000e+43 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749896948945       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749896948945       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749896948945       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749896948945       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749893495867       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749895404773       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 6.97e+11           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+42 is 8.439281e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+43, overlap shift 1.0000e+44 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749896948945       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749896948945       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749896948945       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749896948945       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749893495867       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749895404773       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 6.97e+11           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+43 is 2.109820e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.340213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8670e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.7716
    reference variance = 0.258645
====================================================
  Execution time = 4.3665e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5855e-01
  Total weights = 2.0000e+06
  Execution time = 3.5935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458624983950
                                         uncertainty =       0.006512082520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458624983950
                                         uncertainty =       0.006512082520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478825222
  error estimate for blocks of size 2^( 2) =       0.000503700756
  error estimate for blocks of size 2^( 3) =       0.000526913664
  error estimate for blocks of size 2^( 4) =       0.000543638179
  error estimate for blocks of size 2^( 5) =       0.000554331194
  error estimate for blocks of size 2^( 6) =       0.000559807554
  error estimate for blocks of size 2^( 7) =       0.000562892976

      target function =      -0.738042941167
              le_mean =     -22.816055650363
             les_mean =     521.030942397691
             stat err =       0.000555167476
             autocorr =       1.344293172053
   target nu stat err =       0.000555167476
   target dn stat err =       0.006437276148
      target stat err =       0.005363323815
              std dev =       0.677161123007
             le_variance =       0.458547186512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458624983950
                                         uncertainty =       0.006512082520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458624983950
                                         uncertainty =       0.006512082520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478825222
  error estimate for blocks of size 2^( 2) =       0.000503700756
  error estimate for blocks of size 2^( 3) =       0.000526913664
  error estimate for blocks of size 2^( 4) =       0.000543638179
  error estimate for blocks of size 2^( 5) =       0.000554331194
  error estimate for blocks of size 2^( 6) =       0.000559807554
  error estimate for blocks of size 2^( 7) =       0.000562892976

      target function =      -0.738042941167
              le_mean =     -22.816055650363
             les_mean =     521.030942397691
             stat err =       0.000555167476
             autocorr =       1.344293172053
   target nu stat err =       0.000555167476
   target dn stat err =       0.006437276148
      target stat err =       0.005363323815
              std dev =       0.677161123007
             le_variance =       0.458547186512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458624983950
                                         uncertainty =       0.006512082520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458624983950
                                         uncertainty =       0.006512082520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478825222
  error estimate for blocks of size 2^( 2) =       0.000503700756
  error estimate for blocks of size 2^( 3) =       0.000526913664
  error estimate for blocks of size 2^( 4) =       0.000543638179
  error estimate for blocks of size 2^( 5) =       0.000554331194
  error estimate for blocks of size 2^( 6) =       0.000559807554
  error estimate for blocks of size 2^( 7) =       0.000562892976

      target function =      -0.738042941167
              le_mean =     -22.816055650363
             les_mean =     521.030942397691
             stat err =       0.000555167476
             autocorr =       1.344293172053
   target nu stat err =       0.000555167476
   target dn stat err =       0.006437276148
      target stat err =       0.005363323815
              std dev =       0.677161123007
             le_variance =       0.458547186512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458624983950
                                         uncertainty =       0.006512082520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458624983950
                                         uncertainty =       0.006512082520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478825222
  error estimate for blocks of size 2^( 2) =       0.000503700756
  error estimate for blocks of size 2^( 3) =       0.000526913664
  error estimate for blocks of size 2^( 4) =       0.000543638179
  error estimate for blocks of size 2^( 5) =       0.000554331194
  error estimate for blocks of size 2^( 6) =       0.000559807554
  error estimate for blocks of size 2^( 7) =       0.000562892976

      target function =      -0.738042941167
              le_mean =     -22.816055650363
             les_mean =     521.030942397691
             stat err =       0.000555167476
             autocorr =       1.344293172053
   target nu stat err =       0.000555167476
   target dn stat err =       0.006437276148
      target stat err =       0.005363323815
              std dev =       0.677161123007
             le_variance =       0.458547186512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738042941167        initial  <--
     6.2500e+41     6.2500e+42             2.0639e-46        -0.738042941167
     2.5000e+42     2.5000e+43             8.4393e-47        -0.738042941167
     1.0000e+43     1.0000e+44             2.1098e-47        -0.738042941167

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8718
  </log>
  <optVariables href="FORM.s045.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2255e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.832
    reference variance = 0.240189
====================================================
  Execution time = 4.4102e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4751e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4799e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447214893296
                                         uncertainty =       0.002510179311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447214893296
                                         uncertainty =       0.002510179311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473025970
  error estimate for blocks of size 2^( 2) =       0.000498027782
  error estimate for blocks of size 2^( 3) =       0.000520888356
  error estimate for blocks of size 2^( 4) =       0.000538480605
  error estimate for blocks of size 2^( 5) =       0.000549089594
  error estimate for blocks of size 2^( 6) =       0.000554686779
  error estimate for blocks of size 2^( 7) =       0.000554642392

      target function =      -0.747330166155
              le_mean =     -22.815790113538
             les_mean =     521.007785418769
             stat err =       0.000549224843
             autocorr =       1.348125660768
   target nu stat err =       0.000549224843
   target dn stat err =       0.002765281570
      target stat err =       0.002426690011
              std dev =       0.668959742812
             le_variance =       0.447507137504


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281579011354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+42, overlap shift 6.2500e+43 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747337003139       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747337003139       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747337003139       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+42 is 2.073226e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+43, overlap shift 2.5000e+44 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747337003139       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747337003139       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747337003139       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+43 is 5.183066e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+44, overlap shift 1.0000e+45 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747337003139       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747337003139       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747337003139       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+44 is 1.295766e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.341628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8913e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7508
    reference variance = 0.345232
====================================================
  Execution time = 4.3158e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4671e-01
  Total weights = 2.0000e+06
  Execution time = 3.5921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794720646
                                         uncertainty =       0.002738868261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794720646
                                         uncertainty =       0.002738868261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472604666
  error estimate for blocks of size 2^( 2) =       0.000497817919
  error estimate for blocks of size 2^( 3) =       0.000521021740
  error estimate for blocks of size 2^( 4) =       0.000538276614
  error estimate for blocks of size 2^( 5) =       0.000548866933
  error estimate for blocks of size 2^( 6) =       0.000554591743
  error estimate for blocks of size 2^( 7) =       0.000559718675

      target function =      -0.748032906441
              le_mean =     -22.813921012477
             les_mean =     520.921702080791
             stat err =       0.000550363491
             autocorr =       1.356135934255
   target nu stat err =       0.000550363491
   target dn stat err =       0.003138315365
      target stat err =       0.002731220135
              std dev =       0.668363928267
             le_variance =       0.446710340608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794720646
                                         uncertainty =       0.002738868261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794720646
                                         uncertainty =       0.002738868261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472604666
  error estimate for blocks of size 2^( 2) =       0.000497817919
  error estimate for blocks of size 2^( 3) =       0.000521021740
  error estimate for blocks of size 2^( 4) =       0.000538276614
  error estimate for blocks of size 2^( 5) =       0.000548866933
  error estimate for blocks of size 2^( 6) =       0.000554591743
  error estimate for blocks of size 2^( 7) =       0.000559718675

      target function =      -0.748032906441
              le_mean =     -22.813921012477
             les_mean =     520.921702080791
             stat err =       0.000550363491
             autocorr =       1.356135934255
   target nu stat err =       0.000550363491
   target dn stat err =       0.003138315365
      target stat err =       0.002731220135
              std dev =       0.668363928267
             le_variance =       0.446710340608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794720646
                                         uncertainty =       0.002738868261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794720646
                                         uncertainty =       0.002738868261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472604666
  error estimate for blocks of size 2^( 2) =       0.000497817919
  error estimate for blocks of size 2^( 3) =       0.000521021740
  error estimate for blocks of size 2^( 4) =       0.000538276614
  error estimate for blocks of size 2^( 5) =       0.000548866933
  error estimate for blocks of size 2^( 6) =       0.000554591743
  error estimate for blocks of size 2^( 7) =       0.000559718675

      target function =      -0.748032906441
              le_mean =     -22.813921012477
             les_mean =     520.921702080791
             stat err =       0.000550363491
             autocorr =       1.356135934255
   target nu stat err =       0.000550363491
   target dn stat err =       0.003138315365
      target stat err =       0.002731220135
              std dev =       0.668363928267
             le_variance =       0.446710340608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794720646
                                         uncertainty =       0.002738868261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446794720646
                                         uncertainty =       0.002738868261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472604666
  error estimate for blocks of size 2^( 2) =       0.000497817919
  error estimate for blocks of size 2^( 3) =       0.000521021740
  error estimate for blocks of size 2^( 4) =       0.000538276614
  error estimate for blocks of size 2^( 5) =       0.000548866933
  error estimate for blocks of size 2^( 6) =       0.000554591743
  error estimate for blocks of size 2^( 7) =       0.000559718675

      target function =      -0.748032906441
              le_mean =     -22.813921012477
             les_mean =     520.921702080791
             stat err =       0.000550363491
             autocorr =       1.356135934255
   target nu stat err =       0.000550363491
   target dn stat err =       0.003138315365
      target stat err =       0.002731220135
              std dev =       0.668363928267
             le_variance =       0.446710340608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748032906441        initial  <--
     6.2500e+42     6.2500e+43             2.0732e-47        -0.748032906441
     2.5000e+43     2.5000e+44             5.1831e-48        -0.748032906441
     1.0000e+44     1.0000e+45             1.2958e-48        -0.748032906441

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0524
  </log>
  <optVariables href="FORM.s046.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1997e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7652
    reference variance = 0.427918
====================================================
  Execution time = 4.5867e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4471e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4917e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444756655646
                                         uncertainty =       0.003166107249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444756655646
                                         uncertainty =       0.003166107249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471546978
  error estimate for blocks of size 2^( 2) =       0.000496492645
  error estimate for blocks of size 2^( 3) =       0.000520457010
  error estimate for blocks of size 2^( 4) =       0.000537117754
  error estimate for blocks of size 2^( 5) =       0.000547679584
  error estimate for blocks of size 2^( 6) =       0.000553259132
  error estimate for blocks of size 2^( 7) =       0.000555217010

      target function =      -0.749712952449
              le_mean =     -22.815290755715
             les_mean =     520.982205150782
             stat err =       0.000548318370
             autocorr =       1.352121318259
   target nu stat err =       0.000548318370
   target dn stat err =       0.002982128993
      target stat err =       0.002618793719
              std dev =       0.666868131880
             le_variance =       0.444713105317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281529075572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+43, overlap shift 6.2500e+44 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749721161720       residual = 5.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749721161720       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+43 is 1.688083e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+44, overlap shift 2.5000e+45 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749721161720       residual = 5.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749721161720       residual = 5.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+45, overlap shift 1.0000e+46 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749721161720       residual = 5.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749721161720       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+45 is 1.055052e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.342932 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0796e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.739
    reference variance = 0.368386
====================================================
  Execution time = 4.3431e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5267e-01
  Total weights = 2.0000e+06
  Execution time = 3.6075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452642144761
                                         uncertainty =       0.003570764226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452642144761
                                         uncertainty =       0.003570764226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475745937
  error estimate for blocks of size 2^( 2) =       0.000501044501
  error estimate for blocks of size 2^( 3) =       0.000523977424
  error estimate for blocks of size 2^( 4) =       0.000541256379
  error estimate for blocks of size 2^( 5) =       0.000552946466
  error estimate for blocks of size 2^( 6) =       0.000557610562
  error estimate for blocks of size 2^( 7) =       0.000559740391

      target function =      -0.743002894098
              le_mean =     -22.814424487934
             les_mean =     520.950632882027
             stat err =       0.000552888449
             autocorr =       1.350594131490
   target nu stat err =       0.000552888449
   target dn stat err =       0.003864900386
      target stat err =       0.003292740570
              std dev =       0.672806356040
             le_variance =       0.452668392727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452642144761
                                         uncertainty =       0.003570764226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452642144761
                                         uncertainty =       0.003570764226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475745937
  error estimate for blocks of size 2^( 2) =       0.000501044501
  error estimate for blocks of size 2^( 3) =       0.000523977424
  error estimate for blocks of size 2^( 4) =       0.000541256379
  error estimate for blocks of size 2^( 5) =       0.000552946466
  error estimate for blocks of size 2^( 6) =       0.000557610562
  error estimate for blocks of size 2^( 7) =       0.000559740391

      target function =      -0.743002894098
              le_mean =     -22.814424487934
             les_mean =     520.950632882027
             stat err =       0.000552888449
             autocorr =       1.350594131498
   target nu stat err =       0.000552888449
   target dn stat err =       0.003864900386
      target stat err =       0.003292740570
              std dev =       0.672806356040
             le_variance =       0.452668392727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452642144761
                                         uncertainty =       0.003570764226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452642144761
                                         uncertainty =       0.003570764226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475745937
  error estimate for blocks of size 2^( 2) =       0.000501044501
  error estimate for blocks of size 2^( 3) =       0.000523977424
  error estimate for blocks of size 2^( 4) =       0.000541256379
  error estimate for blocks of size 2^( 5) =       0.000552946466
  error estimate for blocks of size 2^( 6) =       0.000557610562
  error estimate for blocks of size 2^( 7) =       0.000559740391

      target function =      -0.743002894098
              le_mean =     -22.814424487934
             les_mean =     520.950632882027
             stat err =       0.000552888449
             autocorr =       1.350594131498
   target nu stat err =       0.000552888449
   target dn stat err =       0.003864900386
      target stat err =       0.003292740570
              std dev =       0.672806356040
             le_variance =       0.452668392727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452642144761
                                         uncertainty =       0.003570764226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452642144761
                                         uncertainty =       0.003570764226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475745937
  error estimate for blocks of size 2^( 2) =       0.000501044501
  error estimate for blocks of size 2^( 3) =       0.000523977424
  error estimate for blocks of size 2^( 4) =       0.000541256379
  error estimate for blocks of size 2^( 5) =       0.000552946466
  error estimate for blocks of size 2^( 6) =       0.000557610562
  error estimate for blocks of size 2^( 7) =       0.000559740391

      target function =      -0.743002894098
              le_mean =     -22.814424487934
             les_mean =     520.950632882027
             stat err =       0.000552888449
             autocorr =       1.350594131498
   target nu stat err =       0.000552888449
   target dn stat err =       0.003864900386
      target stat err =       0.003292740570
              std dev =       0.672806356040
             le_variance =       0.452668392727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743002894098        initial  <--
     6.2500e+43     6.2500e+44             1.6881e-48        -0.743002894098
     2.5000e+44     2.5000e+45             0.0000e+00        -0.743002894098
     1.0000e+45     1.0000e+46             1.0551e-49        -0.743002894098

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4136
  </log>
  <optVariables href="FORM.s047.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2222e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8453
    reference variance = 0.386431
====================================================
  Execution time = 4.4230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4328e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5242e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443229600488
                                         uncertainty =       0.002256207952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443229600488
                                         uncertainty =       0.002256207952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470787717
  error estimate for blocks of size 2^( 2) =       0.000495687501
  error estimate for blocks of size 2^( 3) =       0.000519483260
  error estimate for blocks of size 2^( 4) =       0.000537066080
  error estimate for blocks of size 2^( 5) =       0.000549867412
  error estimate for blocks of size 2^( 6) =       0.000556658111
  error estimate for blocks of size 2^( 7) =       0.000562996816

      target function =      -0.750942300437
              le_mean =     -22.814997385376
             les_mean =     520.967387622452
             stat err =       0.000551647105
             autocorr =       1.373006012289
   target nu stat err =       0.000551647105
   target dn stat err =       0.002307515936
      target stat err =       0.002071221628
              std dev =       0.665794374692
             le_variance =       0.443282149372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281499738538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+44, overlap shift 6.2500e+45 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750946949270       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750946949270       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+45, overlap shift 2.5000e+46 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750946949270       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750946949270       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+46, overlap shift 1.0000e+47 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750946949270       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750946949270       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.344082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9484e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8582
    reference variance = 0.503408
====================================================
  Execution time = 4.3459e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4113e-01
  Total weights = 2.0000e+06
  Execution time = 3.5920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441070896928
                                         uncertainty =       0.002656990437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441070896928
                                         uncertainty =       0.002656990437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469642147
  error estimate for blocks of size 2^( 2) =       0.000494943018
  error estimate for blocks of size 2^( 3) =       0.000518714514
  error estimate for blocks of size 2^( 4) =       0.000536386883
  error estimate for blocks of size 2^( 5) =       0.000546356656
  error estimate for blocks of size 2^( 6) =       0.000552413342
  error estimate for blocks of size 2^( 7) =       0.000553491398

      target function =      -0.752791713016
              le_mean =     -22.814236119101
             les_mean =     520.930496969280
             stat err =       0.000547162070
             autocorr =       1.357368725629
   target nu stat err =       0.000547162070
   target dn stat err =       0.003056833304
      target stat err =       0.002697560593
              std dev =       0.664174293194
             le_variance =       0.441127491739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441070896928
                                         uncertainty =       0.002656990437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441070896928
                                         uncertainty =       0.002656990437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469642147
  error estimate for blocks of size 2^( 2) =       0.000494943018
  error estimate for blocks of size 2^( 3) =       0.000518714514
  error estimate for blocks of size 2^( 4) =       0.000536386883
  error estimate for blocks of size 2^( 5) =       0.000546356656
  error estimate for blocks of size 2^( 6) =       0.000552413342
  error estimate for blocks of size 2^( 7) =       0.000553491398

      target function =      -0.752791713016
              le_mean =     -22.814236119101
             les_mean =     520.930496969280
             stat err =       0.000547162070
             autocorr =       1.357368725629
   target nu stat err =       0.000547162070
   target dn stat err =       0.003056833304
      target stat err =       0.002697560593
              std dev =       0.664174293194
             le_variance =       0.441127491739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441070896928
                                         uncertainty =       0.002656990437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441070896928
                                         uncertainty =       0.002656990437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469642147
  error estimate for blocks of size 2^( 2) =       0.000494943018
  error estimate for blocks of size 2^( 3) =       0.000518714514
  error estimate for blocks of size 2^( 4) =       0.000536386883
  error estimate for blocks of size 2^( 5) =       0.000546356656
  error estimate for blocks of size 2^( 6) =       0.000552413342
  error estimate for blocks of size 2^( 7) =       0.000553491398

      target function =      -0.752791713016
              le_mean =     -22.814236119101
             les_mean =     520.930496969280
             stat err =       0.000547162070
             autocorr =       1.357368725629
   target nu stat err =       0.000547162070
   target dn stat err =       0.003056833304
      target stat err =       0.002697560593
              std dev =       0.664174293194
             le_variance =       0.441127491739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441070896928
                                         uncertainty =       0.002656990437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441070896928
                                         uncertainty =       0.002656990437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469642147
  error estimate for blocks of size 2^( 2) =       0.000494943018
  error estimate for blocks of size 2^( 3) =       0.000518714514
  error estimate for blocks of size 2^( 4) =       0.000536386883
  error estimate for blocks of size 2^( 5) =       0.000546356656
  error estimate for blocks of size 2^( 6) =       0.000552413342
  error estimate for blocks of size 2^( 7) =       0.000553491398

      target function =      -0.752791713016
              le_mean =     -22.814236119101
             les_mean =     520.930496969280
             stat err =       0.000547162070
             autocorr =       1.357368725629
   target nu stat err =       0.000547162070
   target dn stat err =       0.003056833304
      target stat err =       0.002697560593
              std dev =       0.664174293194
             le_variance =       0.441127491739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752791713016        initial  <--
     6.2500e+44     6.2500e+45             0.0000e+00        -0.752791713016
     2.5000e+45     2.5000e+46             0.0000e+00        -0.752791713016
     1.0000e+46     1.0000e+47             0.0000e+00        -0.752791713016

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3624
  </log>
  <optVariables href="FORM.s048.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2085e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8446
    reference variance = 0.52693
====================================================
  Execution time = 4.3838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4902e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4737e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449105051327
                                         uncertainty =       0.004814149026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449105051327
                                         uncertainty =       0.004814149026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473823273
  error estimate for blocks of size 2^( 2) =       0.000499204120
  error estimate for blocks of size 2^( 3) =       0.000523319189
  error estimate for blocks of size 2^( 4) =       0.000541073679
  error estimate for blocks of size 2^( 5) =       0.000551673778
  error estimate for blocks of size 2^( 6) =       0.000558439054
  error estimate for blocks of size 2^( 7) =       0.000561050137

      target function =      -0.746062670056
              le_mean =     -22.814470473468
             les_mean =     520.949079749190
             stat err =       0.000553059162
             autocorr =       1.362418100877
   target nu stat err =       0.000553059162
   target dn stat err =       0.004713528458
      target stat err =       0.004025046162
              std dev =       0.670087299487
             le_variance =       0.449016988934


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281447047347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+45, overlap shift 6.2500e+46 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746083147107       residual = 8.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746083147107       residual = 8.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+46, overlap shift 2.5000e+47 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746083147107       residual = 8.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746083147107       residual = 8.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+47, overlap shift 1.0000e+48 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746083147107       residual = 8.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746083147107       residual = 8.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.345186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8587e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8587
    reference variance = 0.469987
====================================================
  Execution time = 4.5208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5711e-01
  Total weights = 2.0000e+06
  Execution time = 3.6112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457074567232
                                         uncertainty =       0.005849879735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457074567232
                                         uncertainty =       0.005849879735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478071793
  error estimate for blocks of size 2^( 2) =       0.000503253825
  error estimate for blocks of size 2^( 3) =       0.000526717937
  error estimate for blocks of size 2^( 4) =       0.000544033018
  error estimate for blocks of size 2^( 5) =       0.000554221819
  error estimate for blocks of size 2^( 6) =       0.000560522636
  error estimate for blocks of size 2^( 7) =       0.000565084673

      target function =      -0.739293830911
              le_mean =     -22.814340134711
             les_mean =     520.951220832097
             stat err =       0.000555965537
             autocorr =       1.352413514215
   target nu stat err =       0.000555965537
   target dn stat err =       0.005905660738
      target stat err =       0.004930429839
              std dev =       0.676095613315
             le_variance =       0.457105278344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457074567232
                                         uncertainty =       0.005849879735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457074567232
                                         uncertainty =       0.005849879735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478071793
  error estimate for blocks of size 2^( 2) =       0.000503253825
  error estimate for blocks of size 2^( 3) =       0.000526717937
  error estimate for blocks of size 2^( 4) =       0.000544033018
  error estimate for blocks of size 2^( 5) =       0.000554221819
  error estimate for blocks of size 2^( 6) =       0.000560522636
  error estimate for blocks of size 2^( 7) =       0.000565084673

      target function =      -0.739293830911
              le_mean =     -22.814340134711
             les_mean =     520.951220832097
             stat err =       0.000555965537
             autocorr =       1.352413514215
   target nu stat err =       0.000555965537
   target dn stat err =       0.005905660738
      target stat err =       0.004930429839
              std dev =       0.676095613315
             le_variance =       0.457105278344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457074567232
                                         uncertainty =       0.005849879735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457074567232
                                         uncertainty =       0.005849879735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478071793
  error estimate for blocks of size 2^( 2) =       0.000503253825
  error estimate for blocks of size 2^( 3) =       0.000526717937
  error estimate for blocks of size 2^( 4) =       0.000544033018
  error estimate for blocks of size 2^( 5) =       0.000554221819
  error estimate for blocks of size 2^( 6) =       0.000560522636
  error estimate for blocks of size 2^( 7) =       0.000565084673

      target function =      -0.739293830911
              le_mean =     -22.814340134711
             les_mean =     520.951220832097
             stat err =       0.000555965537
             autocorr =       1.352413514215
   target nu stat err =       0.000555965537
   target dn stat err =       0.005905660738
      target stat err =       0.004930429839
              std dev =       0.676095613315
             le_variance =       0.457105278344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457074567232
                                         uncertainty =       0.005849879735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457074567232
                                         uncertainty =       0.005849879735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478071793
  error estimate for blocks of size 2^( 2) =       0.000503253825
  error estimate for blocks of size 2^( 3) =       0.000526717937
  error estimate for blocks of size 2^( 4) =       0.000544033018
  error estimate for blocks of size 2^( 5) =       0.000554221819
  error estimate for blocks of size 2^( 6) =       0.000560522636
  error estimate for blocks of size 2^( 7) =       0.000565084673

      target function =      -0.739293830911
              le_mean =     -22.814340134711
             les_mean =     520.951220832097
             stat err =       0.000555965537
             autocorr =       1.352413514215
   target nu stat err =       0.000555965537
   target dn stat err =       0.005905660738
      target stat err =       0.004930429839
              std dev =       0.676095613315
             le_variance =       0.457105278344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739293830911        initial  <--
     6.2500e+45     6.2500e+46             0.0000e+00        -0.739293830911
     2.5000e+46     2.5000e+47             0.0000e+00        -0.739293830911
     1.0000e+47     1.0000e+48             0.0000e+00        -0.739293830911

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2282
  </log>
  <optVariables href="FORM.s049.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2182e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.9689
    reference variance = 0.68492
====================================================
  Execution time = 4.4095e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4349e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4593e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443567098851
                                         uncertainty =       0.002427318479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443567098851
                                         uncertainty =       0.002427318479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470897464
  error estimate for blocks of size 2^( 2) =       0.000495648095
  error estimate for blocks of size 2^( 3) =       0.000519396885
  error estimate for blocks of size 2^( 4) =       0.000536984853
  error estimate for blocks of size 2^( 5) =       0.000547452174
  error estimate for blocks of size 2^( 6) =       0.000552388613
  error estimate for blocks of size 2^( 7) =       0.000552806134

      target function =      -0.750774551884
              le_mean =     -22.814065072736
             les_mean =     520.925053764920
             stat err =       0.000547407944
             autocorr =       1.351355106211
   target nu stat err =       0.000547407944
   target dn stat err =       0.002514053205
      target stat err =       0.002234722058
              std dev =       0.665949580384
             le_variance =       0.443488843614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281406507274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+46, overlap shift 6.2500e+47 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750780067906       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750780067906       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -1.000000000000       residual = 2.86e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750780067906       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+46 is 1.393520e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+47, overlap shift 2.5000e+48 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750780067906       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750780067906       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750780067906       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+47 is 3.483800e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+48, overlap shift 1.0000e+49 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750780067906       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750780067906       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750780067906       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+48 is 8.709500e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.346671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8703e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8115
    reference variance = 0.32126
====================================================
  Execution time = 4.3835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5746e-01
  Total weights = 2.0000e+06
  Execution time = 4.1287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457530471140
                                         uncertainty =       0.007512619311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457530471140
                                         uncertainty =       0.007512619311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478257088
  error estimate for blocks of size 2^( 2) =       0.000503192176
  error estimate for blocks of size 2^( 3) =       0.000526116251
  error estimate for blocks of size 2^( 4) =       0.000542662260
  error estimate for blocks of size 2^( 5) =       0.000551877692
  error estimate for blocks of size 2^( 6) =       0.000558783197
  error estimate for blocks of size 2^( 7) =       0.000562275665

      target function =      -0.738970022066
              le_mean =     -22.814850162584
             les_mean =     520.974847397240
             stat err =       0.000553899703
             autocorr =       1.341341724801
   target nu stat err =       0.000553899703
   target dn stat err =       0.007232606384
      target stat err =       0.006021473812
              std dev =       0.676357660413
             le_variance =       0.457459684799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457530471140
                                         uncertainty =       0.007512619311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457530471140
                                         uncertainty =       0.007512619311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478257088
  error estimate for blocks of size 2^( 2) =       0.000503192176
  error estimate for blocks of size 2^( 3) =       0.000526116251
  error estimate for blocks of size 2^( 4) =       0.000542662260
  error estimate for blocks of size 2^( 5) =       0.000551877692
  error estimate for blocks of size 2^( 6) =       0.000558783197
  error estimate for blocks of size 2^( 7) =       0.000562275665

      target function =      -0.738970022066
              le_mean =     -22.814850162584
             les_mean =     520.974847397240
             stat err =       0.000553899703
             autocorr =       1.341341724797
   target nu stat err =       0.000553899703
   target dn stat err =       0.007232606384
      target stat err =       0.006021473812
              std dev =       0.676357660413
             le_variance =       0.457459684799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457530471140
                                         uncertainty =       0.007512619311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457530471140
                                         uncertainty =       0.007512619311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478257088
  error estimate for blocks of size 2^( 2) =       0.000503192176
  error estimate for blocks of size 2^( 3) =       0.000526116251
  error estimate for blocks of size 2^( 4) =       0.000542662260
  error estimate for blocks of size 2^( 5) =       0.000551877692
  error estimate for blocks of size 2^( 6) =       0.000558783197
  error estimate for blocks of size 2^( 7) =       0.000562275665

      target function =      -0.738970022066
              le_mean =     -22.814850162584
             les_mean =     520.974847397240
             stat err =       0.000553899703
             autocorr =       1.341341724797
   target nu stat err =       0.000553899703
   target dn stat err =       0.007232606384
      target stat err =       0.006021473812
              std dev =       0.676357660413
             le_variance =       0.457459684799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457530471140
                                         uncertainty =       0.007512619311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457530471140
                                         uncertainty =       0.007512619311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478257088
  error estimate for blocks of size 2^( 2) =       0.000503192176
  error estimate for blocks of size 2^( 3) =       0.000526116251
  error estimate for blocks of size 2^( 4) =       0.000542662260
  error estimate for blocks of size 2^( 5) =       0.000551877692
  error estimate for blocks of size 2^( 6) =       0.000558783197
  error estimate for blocks of size 2^( 7) =       0.000562275665

      target function =      -0.738970022066
              le_mean =     -22.814850162584
             les_mean =     520.974847397240
             stat err =       0.000553899703
             autocorr =       1.341341724797
   target nu stat err =       0.000553899703
   target dn stat err =       0.007232606384
      target stat err =       0.006021473812
              std dev =       0.676357660413
             le_variance =       0.457459684799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738970022066        initial  <--
     6.2500e+46     6.2500e+47             1.3935e-51        -0.738970022066
     2.5000e+47     2.5000e+48             3.4838e-52        -0.738970022066
     1.0000e+48     1.0000e+49             8.7095e-53        -0.738970022066

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4411
  </log>
  <optVariables href="FORM.s050.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2115e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8342
    reference variance = 0.350473
====================================================
  Execution time = 4.4736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4637e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4759e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446441966761
                                         uncertainty =       0.004150037878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446441966761
                                         uncertainty =       0.004150037878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472422539
  error estimate for blocks of size 2^( 2) =       0.000498014017
  error estimate for blocks of size 2^( 3) =       0.000521790689
  error estimate for blocks of size 2^( 4) =       0.000539874191
  error estimate for blocks of size 2^( 5) =       0.000551254095
  error estimate for blocks of size 2^( 6) =       0.000557701516
  error estimate for blocks of size 2^( 7) =       0.000561515057

      target function =      -0.748304363068
              le_mean =     -22.814684622719
             les_mean =     520.956200321157
             stat err =       0.000552586215
             autocorr =       1.368166256257
   target nu stat err =       0.000552586215
   target dn stat err =       0.004493665969
      target stat err =       0.003865911996
              std dev =       0.668106361442
             le_variance =       0.446366110199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281468462272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+47, overlap shift 6.2500e+48 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748323062228       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748323062228       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748323062228       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+47 is 1.988800e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+48, overlap shift 2.5000e+49 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748323062228       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748323062228       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748323062228       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+48 is 4.971999e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+49, overlap shift 1.0000e+50 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748323062228       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748323062228       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748323062228       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+49 is 1.243000e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.348040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9507e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6767
    reference variance = 0.515476
====================================================
  Execution time = 4.3269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4968e-01
  Total weights = 2.0000e+06
  Execution time = 3.6084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449742383491
                                         uncertainty =       0.004451712784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449742383491
                                         uncertainty =       0.004451712784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474172401
  error estimate for blocks of size 2^( 2) =       0.000498993532
  error estimate for blocks of size 2^( 3) =       0.000522702491
  error estimate for blocks of size 2^( 4) =       0.000539890273
  error estimate for blocks of size 2^( 5) =       0.000550991133
  error estimate for blocks of size 2^( 6) =       0.000557577997
  error estimate for blocks of size 2^( 7) =       0.000558213082

      target function =      -0.745508415453
              le_mean =     -22.814369460217
             les_mean =     520.945132573669
             stat err =       0.000551668121
             autocorr =       1.353577829711
   target nu stat err =       0.000551668121
   target dn stat err =       0.004487853326
      target stat err =       0.003830624320
              std dev =       0.670581040007
             le_variance =       0.449678931216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449742383491
                                         uncertainty =       0.004451712784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449742383491
                                         uncertainty =       0.004451712784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474172401
  error estimate for blocks of size 2^( 2) =       0.000498993532
  error estimate for blocks of size 2^( 3) =       0.000522702491
  error estimate for blocks of size 2^( 4) =       0.000539890273
  error estimate for blocks of size 2^( 5) =       0.000550991133
  error estimate for blocks of size 2^( 6) =       0.000557577997
  error estimate for blocks of size 2^( 7) =       0.000558213081

      target function =      -0.745508415453
              le_mean =     -22.814369460217
             les_mean =     520.945132573669
             stat err =       0.000551668121
             autocorr =       1.353577829707
   target nu stat err =       0.000551668121
   target dn stat err =       0.004487853326
      target stat err =       0.003830624320
              std dev =       0.670581040007
             le_variance =       0.449678931216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449742383491
                                         uncertainty =       0.004451712784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449742383491
                                         uncertainty =       0.004451712784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474172401
  error estimate for blocks of size 2^( 2) =       0.000498993532
  error estimate for blocks of size 2^( 3) =       0.000522702491
  error estimate for blocks of size 2^( 4) =       0.000539890273
  error estimate for blocks of size 2^( 5) =       0.000550991133
  error estimate for blocks of size 2^( 6) =       0.000557577997
  error estimate for blocks of size 2^( 7) =       0.000558213081

      target function =      -0.745508415453
              le_mean =     -22.814369460217
             les_mean =     520.945132573669
             stat err =       0.000551668121
             autocorr =       1.353577829707
   target nu stat err =       0.000551668121
   target dn stat err =       0.004487853326
      target stat err =       0.003830624320
              std dev =       0.670581040007
             le_variance =       0.449678931216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449742383491
                                         uncertainty =       0.004451712784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449742383491
                                         uncertainty =       0.004451712784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474172401
  error estimate for blocks of size 2^( 2) =       0.000498993532
  error estimate for blocks of size 2^( 3) =       0.000522702491
  error estimate for blocks of size 2^( 4) =       0.000539890273
  error estimate for blocks of size 2^( 5) =       0.000550991133
  error estimate for blocks of size 2^( 6) =       0.000557577997
  error estimate for blocks of size 2^( 7) =       0.000558213081

      target function =      -0.745508415453
              le_mean =     -22.814369460217
             les_mean =     520.945132573669
             stat err =       0.000551668121
             autocorr =       1.353577829707
   target nu stat err =       0.000551668121
   target dn stat err =       0.004487853326
      target stat err =       0.003830624320
              std dev =       0.670581040007
             le_variance =       0.449678931216


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745508415453        initial  <--
     6.2500e+47     6.2500e+48             1.9888e-52        -0.745508415453
     2.5000e+48     2.5000e+49             4.9720e-53        -0.745508415453
     1.0000e+49     1.0000e+50             1.2430e-53        -0.745508415453

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3118
  </log>
  <optVariables href="FORM.s051.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2082e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8938
    reference variance = 0.474973
====================================================
  Execution time = 4.6065e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5196e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4771e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451977156752
                                         uncertainty =       0.004066657770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451977156752
                                         uncertainty =       0.004066657770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475374139
  error estimate for blocks of size 2^( 2) =       0.000500824440
  error estimate for blocks of size 2^( 3) =       0.000524523649
  error estimate for blocks of size 2^( 4) =       0.000541150995
  error estimate for blocks of size 2^( 5) =       0.000552601299
  error estimate for blocks of size 2^( 6) =       0.000558546545
  error estimate for blocks of size 2^( 7) =       0.000563591129

      target function =      -0.743564202513
              le_mean =     -22.815737398118
             les_mean =     521.009833938055
             stat err =       0.000553972492
             autocorr =       1.358017279165
   target nu stat err =       0.000553972492
   target dn stat err =       0.004090536380
      target stat err =       0.003490630521
              std dev =       0.672280554641
             le_variance =       0.451961144148


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281573739812e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+48, overlap shift 6.2500e+49 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743579682141       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743579682141       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743579682141       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743579682141       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743579682141       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743579662375       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 9.37e+13           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+48 is 3.563263e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+49, overlap shift 2.5000e+50 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743579682141       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743579682141       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743579682141       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743579682138       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.85e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+49 is 6.910811e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+50, overlap shift 1.0000e+51 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743579682141       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743579682141       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743579682141       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.58e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743526466729       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+50 is 1.739271e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.350248 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0848e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8609
    reference variance = 0.429644
====================================================
  Execution time = 4.3191e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4863e-01
  Total weights = 2.0000e+06
  Execution time = 3.5984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448540979319
                                         uncertainty =       0.003704690150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448540979319
                                         uncertainty =       0.003704690150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473620498
  error estimate for blocks of size 2^( 2) =       0.000498699957
  error estimate for blocks of size 2^( 3) =       0.000522217291
  error estimate for blocks of size 2^( 4) =       0.000539876863
  error estimate for blocks of size 2^( 5) =       0.000550640130
  error estimate for blocks of size 2^( 6) =       0.000554727992
  error estimate for blocks of size 2^( 7) =       0.000557522649

      target function =      -0.746397818601
              le_mean =     -22.814241742360
             les_mean =     520.938258806270
             stat err =       0.000550691908
             autocorr =       1.351936865243
   target nu stat err =       0.000550691908
   target dn stat err =       0.003824786509
      target stat err =       0.003287722615
              std dev =       0.669800531317
             le_variance =       0.448632751752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448540979319
                                         uncertainty =       0.003704690150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448540979319
                                         uncertainty =       0.003704690150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473620498
  error estimate for blocks of size 2^( 2) =       0.000498699957
  error estimate for blocks of size 2^( 3) =       0.000522217291
  error estimate for blocks of size 2^( 4) =       0.000539876863
  error estimate for blocks of size 2^( 5) =       0.000550640130
  error estimate for blocks of size 2^( 6) =       0.000554727992
  error estimate for blocks of size 2^( 7) =       0.000557522649

      target function =      -0.746397818601
              le_mean =     -22.814241742360
             les_mean =     520.938258806270
             stat err =       0.000550691908
             autocorr =       1.351936865243
   target nu stat err =       0.000550691908
   target dn stat err =       0.003824786509
      target stat err =       0.003287722615
              std dev =       0.669800531317
             le_variance =       0.448632751752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448540979319
                                         uncertainty =       0.003704690150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448540979319
                                         uncertainty =       0.003704690150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473620498
  error estimate for blocks of size 2^( 2) =       0.000498699957
  error estimate for blocks of size 2^( 3) =       0.000522217291
  error estimate for blocks of size 2^( 4) =       0.000539876863
  error estimate for blocks of size 2^( 5) =       0.000550640130
  error estimate for blocks of size 2^( 6) =       0.000554727992
  error estimate for blocks of size 2^( 7) =       0.000557522649

      target function =      -0.746397818601
              le_mean =     -22.814241742360
             les_mean =     520.938258806270
             stat err =       0.000550691908
             autocorr =       1.351936865243
   target nu stat err =       0.000550691908
   target dn stat err =       0.003824786509
      target stat err =       0.003287722615
              std dev =       0.669800531317
             le_variance =       0.448632751752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448540979319
                                         uncertainty =       0.003704690150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448540979319
                                         uncertainty =       0.003704690150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473620498
  error estimate for blocks of size 2^( 2) =       0.000498699957
  error estimate for blocks of size 2^( 3) =       0.000522217291
  error estimate for blocks of size 2^( 4) =       0.000539876863
  error estimate for blocks of size 2^( 5) =       0.000550640130
  error estimate for blocks of size 2^( 6) =       0.000554727992
  error estimate for blocks of size 2^( 7) =       0.000557522649

      target function =      -0.746397818601
              le_mean =     -22.814241742360
             les_mean =     520.938258806270
             stat err =       0.000550691908
             autocorr =       1.351936865243
   target nu stat err =       0.000550691908
   target dn stat err =       0.003824786509
      target stat err =       0.003287722615
              std dev =       0.669800531317
             le_variance =       0.448632751752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746397818601        initial  <--
     6.2500e+48     6.2500e+49             3.5633e-53        -0.746397818601
     2.5000e+49     2.5000e+50             6.9108e-54        -0.746397818601
     1.0000e+50     1.0000e+51             1.7393e-54        -0.746397818601

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1445
  </log>
  <optVariables href="FORM.s052.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2200e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8634
    reference variance = 0.291084
====================================================
  Execution time = 4.5782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6149e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4914e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461636540167
                                         uncertainty =       0.009837753122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461636540167
                                         uncertainty =       0.009837753122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480359821
  error estimate for blocks of size 2^( 2) =       0.000505147752
  error estimate for blocks of size 2^( 3) =       0.000528360700
  error estimate for blocks of size 2^( 4) =       0.000546387388
  error estimate for blocks of size 2^( 5) =       0.000558205838
  error estimate for blocks of size 2^( 6) =       0.000563436385
  error estimate for blocks of size 2^( 7) =       0.000566067404

      target function =      -0.735591861728
              le_mean =     -22.815394662786
             les_mean =     521.003724502553
             stat err =       0.000558524254
             autocorr =       1.351919168686
   target nu stat err =       0.000558524254
   target dn stat err =       0.009548174979
      target stat err =       0.007866432037
              std dev =       0.679331373203
             le_variance =       0.461491114618


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281539466279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+49, overlap shift 6.2500e+50 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735675743740       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735675743740       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+50, overlap shift 2.5000e+51 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735675743740       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735675743740       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+51, overlap shift 1.0000e+52 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735675743740       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735675743740       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.351370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0708e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8884
    reference variance = 0.673217
====================================================
  Execution time = 4.3353e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4462e-01
  Total weights = 2.0000e+06
  Execution time = 3.5797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444595171405
                                         uncertainty =       0.003890180662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444595171405
                                         uncertainty =       0.003890180662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471499657
  error estimate for blocks of size 2^( 2) =       0.000496352775
  error estimate for blocks of size 2^( 3) =       0.000520036754
  error estimate for blocks of size 2^( 4) =       0.000536492936
  error estimate for blocks of size 2^( 5) =       0.000547663665
  error estimate for blocks of size 2^( 6) =       0.000554038332
  error estimate for blocks of size 2^( 7) =       0.000558082077

      target function =      -0.749784346373
              le_mean =     -22.815249773489
             les_mean =     520.980245858314
             stat err =       0.000549069252
             autocorr =       1.356099278889
   target nu stat err =       0.000549069252
   target dn stat err =       0.003779108524
      target stat err =       0.003283553332
              std dev =       0.666801210208
             le_variance =       0.444623853935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444595171405
                                         uncertainty =       0.003890180662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444595171405
                                         uncertainty =       0.003890180662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471499657
  error estimate for blocks of size 2^( 2) =       0.000496352775
  error estimate for blocks of size 2^( 3) =       0.000520036754
  error estimate for blocks of size 2^( 4) =       0.000536492936
  error estimate for blocks of size 2^( 5) =       0.000547663665
  error estimate for blocks of size 2^( 6) =       0.000554038332
  error estimate for blocks of size 2^( 7) =       0.000558082077

      target function =      -0.749784346373
              le_mean =     -22.815249773489
             les_mean =     520.980245858314
             stat err =       0.000549069252
             autocorr =       1.356099278889
   target nu stat err =       0.000549069252
   target dn stat err =       0.003779108524
      target stat err =       0.003283553332
              std dev =       0.666801210208
             le_variance =       0.444623853935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444595171405
                                         uncertainty =       0.003890180662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444595171405
                                         uncertainty =       0.003890180662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471499657
  error estimate for blocks of size 2^( 2) =       0.000496352775
  error estimate for blocks of size 2^( 3) =       0.000520036754
  error estimate for blocks of size 2^( 4) =       0.000536492936
  error estimate for blocks of size 2^( 5) =       0.000547663665
  error estimate for blocks of size 2^( 6) =       0.000554038332
  error estimate for blocks of size 2^( 7) =       0.000558082077

      target function =      -0.749784346373
              le_mean =     -22.815249773489
             les_mean =     520.980245858314
             stat err =       0.000549069252
             autocorr =       1.356099278889
   target nu stat err =       0.000549069252
   target dn stat err =       0.003779108524
      target stat err =       0.003283553332
              std dev =       0.666801210208
             le_variance =       0.444623853935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444595171405
                                         uncertainty =       0.003890180662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444595171405
                                         uncertainty =       0.003890180662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471499657
  error estimate for blocks of size 2^( 2) =       0.000496352775
  error estimate for blocks of size 2^( 3) =       0.000520036754
  error estimate for blocks of size 2^( 4) =       0.000536492936
  error estimate for blocks of size 2^( 5) =       0.000547663665
  error estimate for blocks of size 2^( 6) =       0.000554038332
  error estimate for blocks of size 2^( 7) =       0.000558082077

      target function =      -0.749784346373
              le_mean =     -22.815249773489
             les_mean =     520.980245858314
             stat err =       0.000549069252
             autocorr =       1.356099278889
   target nu stat err =       0.000549069252
   target dn stat err =       0.003779108524
      target stat err =       0.003283553332
              std dev =       0.666801210208
             le_variance =       0.444623853935


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749784346373        initial  <--
     6.2500e+49     6.2500e+50             0.0000e+00        -0.749784346373
     2.5000e+50     2.5000e+51             0.0000e+00        -0.749784346373
     1.0000e+51     1.0000e+52             0.0000e+00        -0.749784346373

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2024
  </log>
  <optVariables href="FORM.s053.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2192e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8064
    reference variance = 0.270442
====================================================
  Execution time = 4.4159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4325e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4831e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443157400044
                                         uncertainty =       0.002765292679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443157400044
                                         uncertainty =       0.002765292679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470771840
  error estimate for blocks of size 2^( 2) =       0.000496134405
  error estimate for blocks of size 2^( 3) =       0.000519589166
  error estimate for blocks of size 2^( 4) =       0.000538552410
  error estimate for blocks of size 2^( 5) =       0.000550014984
  error estimate for blocks of size 2^( 6) =       0.000556532932
  error estimate for blocks of size 2^( 7) =       0.000558290252

      target function =      -0.750964342510
              le_mean =     -22.815068611908
             les_mean =     520.970607794509
             stat err =       0.000550847644
             autocorr =       1.369121656388
   target nu stat err =       0.000550847644
   target dn stat err =       0.002850468154
      target stat err =       0.002517868381
              std dev =       0.665771920438
             le_variance =       0.443252250043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281506861191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+50, overlap shift 6.2500e+51 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750971728831       residual = 6.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750971728831       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750971728831       residual = 6.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+50 is 1.785326e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+51, overlap shift 2.5000e+52 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750971728831       residual = 6.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750971728831       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750971728831       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+51 is 4.761942e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+52, overlap shift 1.0000e+53 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750971728831       residual = 6.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750971728831       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750971728831       residual = 6.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+52 is 1.115829e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.352747 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9001e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8507
    reference variance = 0.47246
====================================================
  Execution time = 4.4947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4704e-01
  Total weights = 2.0000e+06
  Execution time = 3.6036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978497850
                                         uncertainty =       0.003202542626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978497850
                                         uncertainty =       0.003202542626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472779541
  error estimate for blocks of size 2^( 2) =       0.000497842746
  error estimate for blocks of size 2^( 3) =       0.000521152933
  error estimate for blocks of size 2^( 4) =       0.000538534528
  error estimate for blocks of size 2^( 5) =       0.000550158819
  error estimate for blocks of size 2^( 6) =       0.000556839113
  error estimate for blocks of size 2^( 7) =       0.000563891928

      target function =      -0.747734403061
              le_mean =     -22.815144244011
             les_mean =     520.977847639954
             stat err =       0.000552356097
             autocorr =       1.364963238893
   target nu stat err =       0.000552356097
   target dn stat err =       0.003126972187
      target stat err =       0.002725314534
              std dev =       0.668611238659
             le_variance =       0.447040988462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978497850
                                         uncertainty =       0.003202542626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978497850
                                         uncertainty =       0.003202542626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472779541
  error estimate for blocks of size 2^( 2) =       0.000497842746
  error estimate for blocks of size 2^( 3) =       0.000521152933
  error estimate for blocks of size 2^( 4) =       0.000538534528
  error estimate for blocks of size 2^( 5) =       0.000550158819
  error estimate for blocks of size 2^( 6) =       0.000556839113
  error estimate for blocks of size 2^( 7) =       0.000563891928

      target function =      -0.747734403061
              le_mean =     -22.815144244011
             les_mean =     520.977847639954
             stat err =       0.000552356097
             autocorr =       1.364963238893
   target nu stat err =       0.000552356097
   target dn stat err =       0.003126972187
      target stat err =       0.002725314534
              std dev =       0.668611238659
             le_variance =       0.447040988462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978497850
                                         uncertainty =       0.003202542626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978497850
                                         uncertainty =       0.003202542626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472779541
  error estimate for blocks of size 2^( 2) =       0.000497842746
  error estimate for blocks of size 2^( 3) =       0.000521152933
  error estimate for blocks of size 2^( 4) =       0.000538534528
  error estimate for blocks of size 2^( 5) =       0.000550158819
  error estimate for blocks of size 2^( 6) =       0.000556839113
  error estimate for blocks of size 2^( 7) =       0.000563891928

      target function =      -0.747734403061
              le_mean =     -22.815144244011
             les_mean =     520.977847639954
             stat err =       0.000552356097
             autocorr =       1.364963238893
   target nu stat err =       0.000552356097
   target dn stat err =       0.003126972187
      target stat err =       0.002725314534
              std dev =       0.668611238659
             le_variance =       0.447040988462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978497850
                                         uncertainty =       0.003202542626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446978497850
                                         uncertainty =       0.003202542626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472779541
  error estimate for blocks of size 2^( 2) =       0.000497842746
  error estimate for blocks of size 2^( 3) =       0.000521152933
  error estimate for blocks of size 2^( 4) =       0.000538534528
  error estimate for blocks of size 2^( 5) =       0.000550158819
  error estimate for blocks of size 2^( 6) =       0.000556839113
  error estimate for blocks of size 2^( 7) =       0.000563891928

      target function =      -0.747734403061
              le_mean =     -22.815144244011
             les_mean =     520.977847639954
             stat err =       0.000552356097
             autocorr =       1.364963238893
   target nu stat err =       0.000552356097
   target dn stat err =       0.003126972187
      target stat err =       0.002725314534
              std dev =       0.668611238659
             le_variance =       0.447040988462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747734403061        initial  <--
     6.2500e+50     6.2500e+51             1.7853e-55        -0.747734403061
     2.5000e+51     2.5000e+52             4.7619e-56        -0.747734403061
     1.0000e+52     1.0000e+53             1.1158e-56        -0.747734403061

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.9110
  </log>
  <optVariables href="FORM.s054.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2192e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.833
    reference variance = 0.382567
====================================================
  Execution time = 4.4039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4689e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4714e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446999690197
                                         uncertainty =       0.002753059639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446999690197
                                         uncertainty =       0.002753059639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472701227
  error estimate for blocks of size 2^( 2) =       0.000497908208
  error estimate for blocks of size 2^( 3) =       0.000521462880
  error estimate for blocks of size 2^( 4) =       0.000537905582
  error estimate for blocks of size 2^( 5) =       0.000548705639
  error estimate for blocks of size 2^( 6) =       0.000554499157
  error estimate for blocks of size 2^( 7) =       0.000558150030

      target function =      -0.747871056573
              le_mean =     -22.814549168350
             les_mean =     520.950546432146
             stat err =       0.000549815102
             autocorr =       1.352881847682
   target nu stat err =       0.000549815102
   target dn stat err =       0.002805080413
      target stat err =       0.002458311944
              std dev =       0.668500486546
             le_variance =       0.446892900512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281454916835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+51, overlap shift 6.2500e+52 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747878151844       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747878151844       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+52, overlap shift 2.5000e+53 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747878151844       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747878151844       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+53, overlap shift 1.0000e+54 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747878151844       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747878151844       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.353858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8764e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7804
    reference variance = 0.412971
====================================================
  Execution time = 4.4986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4670e-01
  Total weights = 2.0000e+06
  Execution time = 3.5895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446684747287
                                         uncertainty =       0.004697954260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446684747287
                                         uncertainty =       0.004697954260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472599061
  error estimate for blocks of size 2^( 2) =       0.000497879478
  error estimate for blocks of size 2^( 3) =       0.000521314568
  error estimate for blocks of size 2^( 4) =       0.000538623804
  error estimate for blocks of size 2^( 5) =       0.000549678393
  error estimate for blocks of size 2^( 6) =       0.000557047141
  error estimate for blocks of size 2^( 7) =       0.000560133418

      target function =      -0.748018965541
              le_mean =     -22.814568758706
             les_mean =     520.951247167088
             stat err =       0.000551370689
             autocorr =       1.361136379383
   target nu stat err =       0.000551370689
   target dn stat err =       0.004930960158
      target stat err =       0.004228536329
              std dev =       0.668356001496
             le_variance =       0.446699744736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446684747287
                                         uncertainty =       0.004697954260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446684747287
                                         uncertainty =       0.004697954260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472599061
  error estimate for blocks of size 2^( 2) =       0.000497879478
  error estimate for blocks of size 2^( 3) =       0.000521314568
  error estimate for blocks of size 2^( 4) =       0.000538623804
  error estimate for blocks of size 2^( 5) =       0.000549678393
  error estimate for blocks of size 2^( 6) =       0.000557047141
  error estimate for blocks of size 2^( 7) =       0.000560133418

      target function =      -0.748018965541
              le_mean =     -22.814568758706
             les_mean =     520.951247167088
             stat err =       0.000551370689
             autocorr =       1.361136379383
   target nu stat err =       0.000551370689
   target dn stat err =       0.004930960158
      target stat err =       0.004228536329
              std dev =       0.668356001496
             le_variance =       0.446699744736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446684747287
                                         uncertainty =       0.004697954260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446684747287
                                         uncertainty =       0.004697954260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472599061
  error estimate for blocks of size 2^( 2) =       0.000497879478
  error estimate for blocks of size 2^( 3) =       0.000521314568
  error estimate for blocks of size 2^( 4) =       0.000538623804
  error estimate for blocks of size 2^( 5) =       0.000549678393
  error estimate for blocks of size 2^( 6) =       0.000557047141
  error estimate for blocks of size 2^( 7) =       0.000560133418

      target function =      -0.748018965541
              le_mean =     -22.814568758706
             les_mean =     520.951247167088
             stat err =       0.000551370689
             autocorr =       1.361136379383
   target nu stat err =       0.000551370689
   target dn stat err =       0.004930960158
      target stat err =       0.004228536329
              std dev =       0.668356001496
             le_variance =       0.446699744736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446684747287
                                         uncertainty =       0.004697954260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446684747287
                                         uncertainty =       0.004697954260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472599061
  error estimate for blocks of size 2^( 2) =       0.000497879478
  error estimate for blocks of size 2^( 3) =       0.000521314568
  error estimate for blocks of size 2^( 4) =       0.000538623804
  error estimate for blocks of size 2^( 5) =       0.000549678393
  error estimate for blocks of size 2^( 6) =       0.000557047141
  error estimate for blocks of size 2^( 7) =       0.000560133418

      target function =      -0.748018965541
              le_mean =     -22.814568758706
             les_mean =     520.951247167088
             stat err =       0.000551370689
             autocorr =       1.361136379383
   target nu stat err =       0.000551370689
   target dn stat err =       0.004930960158
      target stat err =       0.004228536329
              std dev =       0.668356001496
             le_variance =       0.446699744736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748018965541        initial  <--
     6.2500e+51     6.2500e+52             0.0000e+00        -0.748018965541
     2.5000e+52     2.5000e+53             0.0000e+00        -0.748018965541
     1.0000e+53     1.0000e+54             0.0000e+00        -0.748018965541

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8861
  </log>
  <optVariables href="FORM.s055.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2166e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.9635
    reference variance = 0.523888
====================================================
  Execution time = 4.4308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5332e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4838e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453405906462
                                         uncertainty =       0.003704423356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453405906462
                                         uncertainty =       0.003704423356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476086447
  error estimate for blocks of size 2^( 2) =       0.000501036420
  error estimate for blocks of size 2^( 3) =       0.000524318078
  error estimate for blocks of size 2^( 4) =       0.000541624537
  error estimate for blocks of size 2^( 5) =       0.000552229319
  error estimate for blocks of size 2^( 6) =       0.000559157238
  error estimate for blocks of size 2^( 7) =       0.000561886381

      target function =      -0.742460865179
              le_mean =     -22.814338847177
             les_mean =     520.947373417612
             stat err =       0.000553724369
             autocorr =       1.352744062299
   target nu stat err =       0.000553724369
   target dn stat err =       0.004170523597
      target stat err =       0.003538768533
              std dev =       0.673287910538
             le_variance =       0.453316610477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281433884718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+52, overlap shift 6.2500e+53 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742476551464       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742476551464       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+52 is 1.685366e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+53, overlap shift 2.5000e+54 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742476551464       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742476551464       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.58e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+53 is 4.213416e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+54, overlap shift 1.0000e+55 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742476551464       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742476551464       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742476551464       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742476551464       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 4.52e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742476549552       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 5.55e+17           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+54 is 1.747759e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.355769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9158e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8003
    reference variance = 0.261134
====================================================
  Execution time = 4.3513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4776e-01
  Total weights = 2.0000e+06
  Execution time = 3.6079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447863017057
                                         uncertainty =       0.002756644610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447863017057
                                         uncertainty =       0.002756644610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159748
  error estimate for blocks of size 2^( 2) =       0.000498160558
  error estimate for blocks of size 2^( 3) =       0.000521815908
  error estimate for blocks of size 2^( 4) =       0.000539537494
  error estimate for blocks of size 2^( 5) =       0.000549773321
  error estimate for blocks of size 2^( 6) =       0.000555840142
  error estimate for blocks of size 2^( 7) =       0.000560414881

      target function =      -0.747129552338
              le_mean =     -22.815020906615
             les_mean =     520.972939039403
             stat err =       0.000551391459
             autocorr =       1.358014748432
   target nu stat err =       0.000551391459
   target dn stat err =       0.002638146164
      target stat err =       0.002319395069
              std dev =       0.669148932593
             le_variance =       0.447760293991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447863017057
                                         uncertainty =       0.002756644610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447863017057
                                         uncertainty =       0.002756644610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159748
  error estimate for blocks of size 2^( 2) =       0.000498160558
  error estimate for blocks of size 2^( 3) =       0.000521815908
  error estimate for blocks of size 2^( 4) =       0.000539537494
  error estimate for blocks of size 2^( 5) =       0.000549773321
  error estimate for blocks of size 2^( 6) =       0.000555840142
  error estimate for blocks of size 2^( 7) =       0.000560414881

      target function =      -0.747129552338
              le_mean =     -22.815020906615
             les_mean =     520.972939039403
             stat err =       0.000551391459
             autocorr =       1.358014748432
   target nu stat err =       0.000551391459
   target dn stat err =       0.002638146164
      target stat err =       0.002319395069
              std dev =       0.669148932593
             le_variance =       0.447760293991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447863017057
                                         uncertainty =       0.002756644610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447863017057
                                         uncertainty =       0.002756644610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159748
  error estimate for blocks of size 2^( 2) =       0.000498160558
  error estimate for blocks of size 2^( 3) =       0.000521815908
  error estimate for blocks of size 2^( 4) =       0.000539537494
  error estimate for blocks of size 2^( 5) =       0.000549773321
  error estimate for blocks of size 2^( 6) =       0.000555840142
  error estimate for blocks of size 2^( 7) =       0.000560414881

      target function =      -0.747129552338
              le_mean =     -22.815020906615
             les_mean =     520.972939039403
             stat err =       0.000551391459
             autocorr =       1.358014748432
   target nu stat err =       0.000551391459
   target dn stat err =       0.002638146164
      target stat err =       0.002319395069
              std dev =       0.669148932593
             le_variance =       0.447760293991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447863017057
                                         uncertainty =       0.002756644610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447863017057
                                         uncertainty =       0.002756644610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159748
  error estimate for blocks of size 2^( 2) =       0.000498160558
  error estimate for blocks of size 2^( 3) =       0.000521815908
  error estimate for blocks of size 2^( 4) =       0.000539537494
  error estimate for blocks of size 2^( 5) =       0.000549773321
  error estimate for blocks of size 2^( 6) =       0.000555840142
  error estimate for blocks of size 2^( 7) =       0.000560414881

      target function =      -0.747129552338
              le_mean =     -22.815020906615
             les_mean =     520.972939039403
             stat err =       0.000551391459
             autocorr =       1.358014748432
   target nu stat err =       0.000551391459
   target dn stat err =       0.002638146164
      target stat err =       0.002319395069
              std dev =       0.669148932593
             le_variance =       0.447760293991


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747129552338        initial  <--
     6.2500e+52     6.2500e+53             1.6854e-57        -0.747129552338
     2.5000e+53     2.5000e+54             4.2134e-58        -0.747129552338
     1.0000e+54     1.0000e+55             1.7478e-58        -0.747129552338

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.6459
  </log>
  <optVariables href="FORM.s056.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2481e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8943
    reference variance = 0.402088
====================================================
  Execution time = 4.3702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5215e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452679071711
                                         uncertainty =       0.004316423643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452679071711
                                         uncertainty =       0.004316423643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475705441
  error estimate for blocks of size 2^( 2) =       0.000500477925
  error estimate for blocks of size 2^( 3) =       0.000523586390
  error estimate for blocks of size 2^( 4) =       0.000540740382
  error estimate for blocks of size 2^( 5) =       0.000550827143
  error estimate for blocks of size 2^( 6) =       0.000557529523
  error estimate for blocks of size 2^( 7) =       0.000560723672

      target function =      -0.743053487505
              le_mean =     -22.814844294625
             les_mean =     520.969711295229
             stat err =       0.000552455180
             autocorr =       1.348707777942
   target nu stat err =       0.000552455180
   target dn stat err =       0.004466566678
      target stat err =       0.003791073282
              std dev =       0.672749086623
             le_variance =       0.452591333553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281484429462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+53, overlap shift 6.2500e+54 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743071732827       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743071732827       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.58e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743071732827       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 4.91e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 2.04e+10           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+53 is 2.417251e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+54, overlap shift 2.5000e+55 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743071732827       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743071732827       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+54 is 3.250150e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+55, overlap shift 1.0000e+56 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743071732827       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743071732827       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+55 is 8.125374e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.357325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8930e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7678
    reference variance = 0.901062
====================================================
  Execution time = 4.3482e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5461e-01
  Total weights = 2.0000e+06
  Execution time = 3.6092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454756476972
                                         uncertainty =       0.005055031075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454756476972
                                         uncertainty =       0.005055031075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476767775
  error estimate for blocks of size 2^( 2) =       0.000501325981
  error estimate for blocks of size 2^( 3) =       0.000524532340
  error estimate for blocks of size 2^( 4) =       0.000541597819
  error estimate for blocks of size 2^( 5) =       0.000551572718
  error estimate for blocks of size 2^( 6) =       0.000557299819
  error estimate for blocks of size 2^( 7) =       0.000559809424

      target function =      -0.741332184521
              le_mean =     -22.815803860261
             les_mean =     521.015520584226
             stat err =       0.000552569945
             autocorr =       1.343262011421
   target nu stat err =       0.000552569945
   target dn stat err =       0.005121519762
      target stat err =       0.004319418214
              std dev =       0.674251452815
             le_variance =       0.454615021623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454756476972
                                         uncertainty =       0.005055031075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454756476972
                                         uncertainty =       0.005055031075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476767775
  error estimate for blocks of size 2^( 2) =       0.000501325981
  error estimate for blocks of size 2^( 3) =       0.000524532340
  error estimate for blocks of size 2^( 4) =       0.000541597819
  error estimate for blocks of size 2^( 5) =       0.000551572718
  error estimate for blocks of size 2^( 6) =       0.000557299819
  error estimate for blocks of size 2^( 7) =       0.000559809424

      target function =      -0.741332184521
              le_mean =     -22.815803860261
             les_mean =     521.015520584226
             stat err =       0.000552569945
             autocorr =       1.343262011421
   target nu stat err =       0.000552569945
   target dn stat err =       0.005121519762
      target stat err =       0.004319418214
              std dev =       0.674251452815
             le_variance =       0.454615021623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454756476972
                                         uncertainty =       0.005055031075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454756476972
                                         uncertainty =       0.005055031075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476767775
  error estimate for blocks of size 2^( 2) =       0.000501325981
  error estimate for blocks of size 2^( 3) =       0.000524532340
  error estimate for blocks of size 2^( 4) =       0.000541597819
  error estimate for blocks of size 2^( 5) =       0.000551572718
  error estimate for blocks of size 2^( 6) =       0.000557299819
  error estimate for blocks of size 2^( 7) =       0.000559809424

      target function =      -0.741332184521
              le_mean =     -22.815803860261
             les_mean =     521.015520584226
             stat err =       0.000552569945
             autocorr =       1.343262011421
   target nu stat err =       0.000552569945
   target dn stat err =       0.005121519762
      target stat err =       0.004319418214
              std dev =       0.674251452815
             le_variance =       0.454615021623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454756476972
                                         uncertainty =       0.005055031075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454756476972
                                         uncertainty =       0.005055031075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476767775
  error estimate for blocks of size 2^( 2) =       0.000501325981
  error estimate for blocks of size 2^( 3) =       0.000524532340
  error estimate for blocks of size 2^( 4) =       0.000541597819
  error estimate for blocks of size 2^( 5) =       0.000551572718
  error estimate for blocks of size 2^( 6) =       0.000557299819
  error estimate for blocks of size 2^( 7) =       0.000559809424

      target function =      -0.741332184521
              le_mean =     -22.815803860261
             les_mean =     521.015520584226
             stat err =       0.000552569945
             autocorr =       1.343262011421
   target nu stat err =       0.000552569945
   target dn stat err =       0.005121519762
      target stat err =       0.004319418214
              std dev =       0.674251452815
             le_variance =       0.454615021623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741332184521        initial  <--
     6.2500e+53     6.2500e+54             2.4173e-58        -0.741332184521
     2.5000e+54     2.5000e+55             3.2501e-59        -0.741332184521
     1.0000e+55     1.0000e+56             8.1254e-60        -0.741332184521

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4717
  </log>
  <optVariables href="FORM.s057.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2041e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7886
    reference variance = 0.477764
====================================================
  Execution time = 4.5941e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4608e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4658e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446068963316
                                         uncertainty =       0.002832725553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446068963316
                                         uncertainty =       0.002832725553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472269719
  error estimate for blocks of size 2^( 2) =       0.000497441655
  error estimate for blocks of size 2^( 3) =       0.000520772684
  error estimate for blocks of size 2^( 4) =       0.000537485747
  error estimate for blocks of size 2^( 5) =       0.000548560913
  error estimate for blocks of size 2^( 6) =       0.000555375901
  error estimate for blocks of size 2^( 7) =       0.000558390015

      target function =      -0.748568291726
              le_mean =     -22.814160755270
             les_mean =     520.932008120011
             stat err =       0.000549953144
             autocorr =       1.356035868280
   target nu stat err =       0.000549953144
   target dn stat err =       0.002826781189
      target stat err =       0.002479164784
              std dev =       0.667890242284
             le_variance =       0.446077375738


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281416075527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+54, overlap shift 6.2500e+55 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748575416794       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748575416794       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+55, overlap shift 2.5000e+56 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748575416794       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748575416794       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+56, overlap shift 1.0000e+57 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748575416794       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748575416794       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.358481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0611e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7382
    reference variance = 0.477595
====================================================
  Execution time = 4.3355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4784e-01
  Total weights = 2.0000e+06
  Execution time = 3.6106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447779136860
                                         uncertainty =       0.004003036747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447779136860
                                         uncertainty =       0.004003036747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473202722
  error estimate for blocks of size 2^( 2) =       0.000497621230
  error estimate for blocks of size 2^( 3) =       0.000520760017
  error estimate for blocks of size 2^( 4) =       0.000538264591
  error estimate for blocks of size 2^( 5) =       0.000549462445
  error estimate for blocks of size 2^( 6) =       0.000556703428
  error estimate for blocks of size 2^( 7) =       0.000560653983

      target function =      -0.747056661232
              le_mean =     -22.814684809499
             les_mean =     520.957684365517
             stat err =       0.000551271112
             autocorr =       1.357175467278
   target nu stat err =       0.000551271112
   target dn stat err =       0.004099311927
      target stat err =       0.003524112762
              std dev =       0.669209707531
             le_variance =       0.447841632654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447779136860
                                         uncertainty =       0.004003036747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447779136860
                                         uncertainty =       0.004003036747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473202722
  error estimate for blocks of size 2^( 2) =       0.000497621230
  error estimate for blocks of size 2^( 3) =       0.000520760017
  error estimate for blocks of size 2^( 4) =       0.000538264591
  error estimate for blocks of size 2^( 5) =       0.000549462445
  error estimate for blocks of size 2^( 6) =       0.000556703428
  error estimate for blocks of size 2^( 7) =       0.000560653983

      target function =      -0.747056661232
              le_mean =     -22.814684809499
             les_mean =     520.957684365517
             stat err =       0.000551271112
             autocorr =       1.357175467278
   target nu stat err =       0.000551271112
   target dn stat err =       0.004099311927
      target stat err =       0.003524112762
              std dev =       0.669209707531
             le_variance =       0.447841632654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447779136860
                                         uncertainty =       0.004003036747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447779136860
                                         uncertainty =       0.004003036747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473202722
  error estimate for blocks of size 2^( 2) =       0.000497621230
  error estimate for blocks of size 2^( 3) =       0.000520760017
  error estimate for blocks of size 2^( 4) =       0.000538264591
  error estimate for blocks of size 2^( 5) =       0.000549462445
  error estimate for blocks of size 2^( 6) =       0.000556703428
  error estimate for blocks of size 2^( 7) =       0.000560653983

      target function =      -0.747056661232
              le_mean =     -22.814684809499
             les_mean =     520.957684365517
             stat err =       0.000551271112
             autocorr =       1.357175467278
   target nu stat err =       0.000551271112
   target dn stat err =       0.004099311927
      target stat err =       0.003524112762
              std dev =       0.669209707531
             le_variance =       0.447841632654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447779136860
                                         uncertainty =       0.004003036747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447779136860
                                         uncertainty =       0.004003036747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473202722
  error estimate for blocks of size 2^( 2) =       0.000497621230
  error estimate for blocks of size 2^( 3) =       0.000520760017
  error estimate for blocks of size 2^( 4) =       0.000538264591
  error estimate for blocks of size 2^( 5) =       0.000549462445
  error estimate for blocks of size 2^( 6) =       0.000556703428
  error estimate for blocks of size 2^( 7) =       0.000560653983

      target function =      -0.747056661232
              le_mean =     -22.814684809499
             les_mean =     520.957684365517
             stat err =       0.000551271112
             autocorr =       1.357175467278
   target nu stat err =       0.000551271112
   target dn stat err =       0.004099311927
      target stat err =       0.003524112762
              std dev =       0.669209707531
             le_variance =       0.447841632654


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747056661232        initial  <--
     6.2500e+54     6.2500e+55             0.0000e+00        -0.747056661232
     2.5000e+55     2.5000e+56             0.0000e+00        -0.747056661232
     1.0000e+56     1.0000e+57             0.0000e+00        -0.747056661232

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3649
  </log>
  <optVariables href="FORM.s058.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2198e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.8103
    reference variance = 0.369853
====================================================
  Execution time = 4.3746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5433e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4996e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454163172036
                                         uncertainty =       0.004539607345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454163172036
                                         uncertainty =       0.004539607345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476618349
  error estimate for blocks of size 2^( 2) =       0.000501234078
  error estimate for blocks of size 2^( 3) =       0.000524305398
  error estimate for blocks of size 2^( 4) =       0.000541686801
  error estimate for blocks of size 2^( 5) =       0.000552231099
  error estimate for blocks of size 2^( 6) =       0.000561412178
  error estimate for blocks of size 2^( 7) =       0.000564706223

      target function =      -0.741579205022
              le_mean =     -22.815692701191
             les_mean =     521.010163309782
             stat err =       0.000555009075
             autocorr =       1.355996763099
   target nu stat err =       0.000555009075
   target dn stat err =       0.004451804307
      target stat err =       0.003769428470
              std dev =       0.674040133660
             le_variance =       0.454330101784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281569270119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+55, overlap shift 6.2500e+56 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741597296269       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741597296269       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+56, overlap shift 2.5000e+57 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741597296269       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741597296269       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+57, overlap shift 1.0000e+58 and omega -2.3474e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741597296269       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741597296269       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.359609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8753e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7291
    reference variance = 0.550604
====================================================
  Execution time = 4.2850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5110e-01
  Total weights = 2.0000e+06
  Execution time = 3.6190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451030371613
                                         uncertainty =       0.003755868460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451030371613
                                         uncertainty =       0.003755868460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474923259
  error estimate for blocks of size 2^( 2) =       0.000499936116
  error estimate for blocks of size 2^( 3) =       0.000523685843
  error estimate for blocks of size 2^( 4) =       0.000541775247
  error estimate for blocks of size 2^( 5) =       0.000552344120
  error estimate for blocks of size 2^( 6) =       0.000559862122
  error estimate for blocks of size 2^( 7) =       0.000561273425

      target function =      -0.744310902553
              le_mean =     -22.814498232607
             les_mean =     520.952433583098
             stat err =       0.000553813729
             autocorr =       1.359817283705
   target nu stat err =       0.000553813729
   target dn stat err =       0.004074537972
      target stat err =       0.003477714512
              std dev =       0.671642913339
             le_variance =       0.451104203039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451030371613
                                         uncertainty =       0.003755868460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451030371613
                                         uncertainty =       0.003755868460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474923259
  error estimate for blocks of size 2^( 2) =       0.000499936116
  error estimate for blocks of size 2^( 3) =       0.000523685843
  error estimate for blocks of size 2^( 4) =       0.000541775247
  error estimate for blocks of size 2^( 5) =       0.000552344120
  error estimate for blocks of size 2^( 6) =       0.000559862122
  error estimate for blocks of size 2^( 7) =       0.000561273425

      target function =      -0.744310902553
              le_mean =     -22.814498232607
             les_mean =     520.952433583098
             stat err =       0.000553813729
             autocorr =       1.359817283705
   target nu stat err =       0.000553813729
   target dn stat err =       0.004074537972
      target stat err =       0.003477714512
              std dev =       0.671642913339
             le_variance =       0.451104203039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451030371613
                                         uncertainty =       0.003755868460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451030371613
                                         uncertainty =       0.003755868460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474923259
  error estimate for blocks of size 2^( 2) =       0.000499936116
  error estimate for blocks of size 2^( 3) =       0.000523685843
  error estimate for blocks of size 2^( 4) =       0.000541775247
  error estimate for blocks of size 2^( 5) =       0.000552344120
  error estimate for blocks of size 2^( 6) =       0.000559862122
  error estimate for blocks of size 2^( 7) =       0.000561273425

      target function =      -0.744310902553
              le_mean =     -22.814498232607
             les_mean =     520.952433583098
             stat err =       0.000553813729
             autocorr =       1.359817283705
   target nu stat err =       0.000553813729
   target dn stat err =       0.004074537972
      target stat err =       0.003477714512
              std dev =       0.671642913339
             le_variance =       0.451104203039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451030371613
                                         uncertainty =       0.003755868460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451030371613
                                         uncertainty =       0.003755868460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474923259
  error estimate for blocks of size 2^( 2) =       0.000499936116
  error estimate for blocks of size 2^( 3) =       0.000523685843
  error estimate for blocks of size 2^( 4) =       0.000541775247
  error estimate for blocks of size 2^( 5) =       0.000552344120
  error estimate for blocks of size 2^( 6) =       0.000559862122
  error estimate for blocks of size 2^( 7) =       0.000561273425

      target function =      -0.744310902553
              le_mean =     -22.814498232607
             les_mean =     520.952433583098
             stat err =       0.000553813729
             autocorr =       1.359817283705
   target nu stat err =       0.000553813729
   target dn stat err =       0.004074537972
      target stat err =       0.003477714512
              std dev =       0.671642913339
             le_variance =       0.451104203039


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744310902553        initial  <--
     6.2500e+55     6.2500e+56             0.0000e+00        -0.744310902553
     2.5000e+56     2.5000e+57             0.0000e+00        -0.744310902553
     1.0000e+57     1.0000e+58             0.0000e+00        -0.744310902553

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8739
  </log>
  <optVariables href="FORM.s059.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1963e+02 secs
  Total Execution time = 7.3024e+03 secs

=========================================================
  A new xml input file : FORM.s059.cont.xml
