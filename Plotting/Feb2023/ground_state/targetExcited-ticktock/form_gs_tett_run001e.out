Rank =    0  Free Memory = 88867 MB
Rank =    1  Free Memory = 88867 MB
Rank =    2  Free Memory = 88866 MB
Rank =    3  Free Memory = 88866 MB
Rank =    4  Free Memory = 88866 MB
Rank =    5  Free Memory = 88866 MB
Rank =    6  Free Memory = 88866 MB
Rank =    7  Free Memory = 88866 MB
Rank =    8  Free Memory = 88866 MB
Rank =    9  Free Memory = 88866 MB
Rank =   10  Free Memory = 88865 MB
Rank =   11  Free Memory = 88864 MB
Rank =   12  Free Memory = 88864 MB
Rank =   13  Free Memory = 88864 MB
Rank =   14  Free Memory = 88864 MB
Rank =   15  Free Memory = 88852 MB
Rank =   16  Free Memory = 88851 MB
Rank =   17  Free Memory = 88851 MB
Rank =   18  Free Memory = 88851 MB
Rank =   19  Free Memory = 88851 MB
Rank =   20  Free Memory = 88851 MB
Rank =   21  Free Memory = 88851 MB
Rank =   22  Free Memory = 88851 MB
Rank =   23  Free Memory = 88851 MB
Rank =   24  Free Memory = 88851 MB
Rank =   25  Free Memory = 88851 MB
Rank =   26  Free Memory = 88851 MB
Rank =   27  Free Memory = 88851 MB
Rank =   28  Free Memory = 88851 MB
Rank =   29  Free Memory = 88851 MB
Rank =   30  Free Memory = 88851 MB
Rank =   31  Free Memory = 88851 MB
Rank =   32  Free Memory = 90832 MB
Rank =   33  Free Memory = 90832 MB
Rank =   34  Free Memory = 90832 MB
Rank =   35  Free Memory = 90832 MB
Rank =   36  Free Memory = 90832 MB
Rank =   37  Free Memory = 90831 MB
Rank =   38  Free Memory = 90831 MB
Rank =   39  Free Memory = 90831 MB
Rank =   40  Free Memory = 90831 MB
Rank =   41  Free Memory = 90831 MB
Rank =   42  Free Memory = 90831 MB
Rank =   43  Free Memory = 90831 MB
Rank =   44  Free Memory = 90831 MB
Rank =   45  Free Memory = 90831 MB
Rank =   46  Free Memory = 90831 MB
Rank =   47  Free Memory = 90831 MB
Rank =   48  Free Memory = 90831 MB
Rank =   49  Free Memory = 90831 MB
Rank =   50  Free Memory = 90831 MB
Rank =   51  Free Memory = 90831 MB
Rank =   52  Free Memory = 90831 MB
Rank =   53  Free Memory = 90831 MB
Rank =   54  Free Memory = 90831 MB
Rank =   55  Free Memory = 90831 MB
Rank =   56  Free Memory = 90831 MB
Rank =   57  Free Memory = 90831 MB
Rank =   58  Free Memory = 90831 MB
Rank =   59  Free Memory = 90831 MB
Rank =   60  Free Memory = 90831 MB
Rank =   61  Free Memory = 90831 MB
Rank =   62  Free Memory = 90831 MB
Rank =   63  Free Memory = 90831 MB
Rank =   64  Free Memory = 89739 MB
Rank =   65  Free Memory = 89739 MB
Rank =   66  Free Memory = 89739 MB
Rank =   67  Free Memory = 89739 MB
Rank =   68  Free Memory = 89739 MB
Rank =   69  Free Memory = 89739 MB
Rank =   70  Free Memory = 89739 MB
Rank =   71  Free Memory = 89739 MB
Rank =   72  Free Memory = 89739 MB
Rank =   73  Free Memory = 89739 MB
Rank =   74  Free Memory = 89739 MB
Rank =   75  Free Memory = 89739 MB
Rank =   76  Free Memory = 89739 MB
Rank =   77  Free Memory = 89739 MB
Rank =   78  Free Memory = 89739 MB
Rank =   79  Free Memory = 89739 MB
Rank =   80  Free Memory = 89739 MB
Rank =   81  Free Memory = 89739 MB
Rank =   82  Free Memory = 89739 MB
Rank =   83  Free Memory = 89739 MB
Rank =   84  Free Memory = 89739 MB
Rank =   85  Free Memory = 89739 MB
Rank =   86  Free Memory = 89739 MB
Rank =   87  Free Memory = 89739 MB
Rank =   88  Free Memory = 89739 MB
Rank =   89  Free Memory = 89739 MB
Rank =   90  Free Memory = 89739 MB
Rank =   91  Free Memory = 89739 MB
Rank =   92  Free Memory = 89739 MB
Rank =   93  Free Memory = 89739 MB
Rank =   94  Free Memory = 89739 MB
Rank =   95  Free Memory = 89739 MB
Rank =   96  Free Memory = 89630 MB
Rank =   97  Free Memory = 89630 MB
Rank =   98  Free Memory = 89630 MB
Rank =   99  Free Memory = 89630 MB
Rank =  100  Free Memory = 89630 MB
Rank =  101  Free Memory = 89630 MB
Rank =  102  Free Memory = 89630 MB
Rank =  103  Free Memory = 89630 MB
Rank =  104  Free Memory = 89630 MB
Rank =  105  Free Memory = 89630 MB
Rank =  106  Free Memory = 89630 MB
Rank =  107  Free Memory = 89630 MB
Rank =  108  Free Memory = 89630 MB
Rank =  109  Free Memory = 89630 MB
Rank =  110  Free Memory = 89630 MB
Rank =  111  Free Memory = 89630 MB
Rank =  112  Free Memory = 89630 MB
Rank =  113  Free Memory = 89630 MB
Rank =  114  Free Memory = 89630 MB
Rank =  115  Free Memory = 89630 MB
Rank =  116  Free Memory = 89630 MB
Rank =  117  Free Memory = 89630 MB
Rank =  118  Free Memory = 89630 MB
Rank =  119  Free Memory = 89630 MB
Rank =  120  Free Memory = 89630 MB
Rank =  121  Free Memory = 89630 MB
Rank =  122  Free Memory = 89630 MB
Rank =  123  Free Memory = 89630 MB
Rank =  124  Free Memory = 89630 MB
Rank =  125  Free Memory = 89630 MB
Rank =  126  Free Memory = 89630 MB
Rank =  127  Free Memory = 89630 MB
  Input file(s): opt_form_gs_tett_run001e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run001e.xml

  Project = FORM
  date    = 2023-03-18 14:52:31 PDT
  host    = n0103.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 671

  Range of prime numbers to use as seeds over processors and threads = 5021-6143


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.624554e-01    1         1 OFF
     uu_1                 1.011863e-01    1         1 OFF
     uu_2                 3.659226e-03    1         1 OFF
     uu_3                -5.375161e-02    1         1 OFF
     uu_4                -8.591702e-02    1         1 OFF
     uu_5                -1.029990e-01    1         1 OFF
     uu_6                -1.108447e-01    1         1 OFF
     uu_7                -1.087609e-01    1         1 OFF
     uu_8                -9.325173e-02    1         1 OFF
     uu_9                -5.957390e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.378549e-01    1         1 OFF
     ud_1                 9.967815e-02    1         1 OFF
     ud_2                -1.443990e-02    1         1 OFF
     ud_3                -7.376538e-02    1         1 OFF
     ud_4                -1.061181e-01    1         1 OFF
     ud_5                -1.224040e-01    1         1 OFF
     ud_6                -1.277130e-01    1         1 OFF
     ud_7                -1.191873e-01    1         1 OFF
     ud_8                -9.272569e-02    1         1 OFF
     ud_9                -4.447679e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.563379e-01    1         1 OFF
     eC_1                -3.182912e-01    1         1 OFF
     eC_2                -6.732177e-02    1         1 OFF
     eC_3                 9.506706e-02    1         1 OFF
     eC_4                 1.375986e-01    1         1 OFF
     eC_5                 1.931335e-01    1         1 OFF
     eC_6                 2.098757e-01    1         1 OFF
     eC_7                 1.661996e-01    1         1 OFF
     eC_8                 3.840237e-02    1         1 OFF
     eC_9                 1.377137e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.227972e-01    1         1 OFF
     eO_1                -5.297360e-01    1         1 OFF
     eO_2                -1.492259e-01    1         1 OFF
     eO_3                 1.025706e-01    1         1 OFF
     eO_4                 2.270539e-01    1         1 OFF
     eO_5                 3.212686e-01    1         1 OFF
     eO_6                 3.347758e-01    1         1 OFF
     eO_7                 3.060194e-01    1         1 OFF
     eO_8                 1.433530e-01    1         1 OFF
     eO_9                 3.830540e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.277008e-01    1         1 OFF
     eH1_1                -3.779999e-02    1         1 OFF
     eH1_2                -1.874707e-02    1         1 OFF
     eH1_3                -3.712827e-02    1         1 OFF
     eH1_4                -1.241675e-02    1         1 OFF
     eH1_5                 8.974315e-03    1         1 OFF
     eH1_6                 5.391205e-02    1         1 OFF
     eH1_7                 6.334551e-02    1         1 OFF
     eH1_8                 6.498479e-02    1         1 OFF
     eH1_9                 4.352531e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.183001e-01    1         1 OFF
     eH2_1                -2.576170e-02    1         1 OFF
     eH2_2                -1.319036e-02    1         1 OFF
     eH2_3                -3.560919e-02    1         1 OFF
     eH2_4                -1.653925e-02    1         1 OFF
     eH2_5                 7.920534e-03    1         1 OFF
     eH2_6                 4.215155e-02    1         1 OFF
     eH2_7                 4.045401e-02    1         1 OFF
     eH2_8                 5.493390e-02    1         1 OFF
     eH2_9                 5.404523e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.781052e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 9.0257e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7982
    reference variance = 0.296832
====================================================
  Execution time = 4.3988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4805e-01
  Total weights = 1.964033345e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436419461166
                                         uncertainty =       0.002021871329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436419461166
                                         uncertainty =       0.002021871329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467111002
  error estimate for blocks of size 2^( 2) =       0.000492526160
  error estimate for blocks of size 2^( 3) =       0.000516352681
  error estimate for blocks of size 2^( 4) =       0.000533475102
  error estimate for blocks of size 2^( 5) =       0.000544839222
  error estimate for blocks of size 2^( 6) =       0.000550566090
  error estimate for blocks of size 2^( 7) =       0.000556940971

      target function =      -0.746959769785
              le_mean =     -22.815510375037
             les_mean =     520.995560751491
             stat err =       0.000546455346
             autocorr =       1.368576772668
   target nu stat err =       0.000546455346
   target dn stat err =       0.002868028074
      target stat err =       0.002453443064
              std dev =       0.660594714492
             le_variance =       0.436385376815


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281551037504e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746966914736       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747049328871       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747068258177       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747070701982       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747071019267       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747070937160       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747071268328       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747071306706       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747071296877       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747071298405       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747071294078       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 7.198343e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746966914736       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746990650185       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746995809535       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746996431117       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746996498434       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746996473094       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746996552998       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746996559976       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746996557385       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746996557703       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.030340e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746966914736       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746973082973       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746974401570       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746974557085       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746974572931       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746974566304       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746974586016       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746974587576       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746974586927       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746974587001       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 5.244756e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.5749e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.308170e-01                 3 1 ON  0
ci_02 -3.089450e-02                3 1 ON  1
ci_03 -3.075086e-02                3 1 ON  2
ci_04 2.758264e-02                 3 1 ON  3
ci_05 -2.276570e-02                3 1 ON  4
ci_06 -2.260203e-02                3 1 ON  5
ci_07 2.691921e-02                 3 1 ON  6
ci_08 -6.236109e-03                3 1 ON  7
ci_09 -9.140085e-03                3 1 ON  8
ci_10 -9.174965e-03                3 1 ON  9
ci_11 1.298624e-02                 3 1 ON  10
ci_12 7.537742e-03                 3 1 ON  11
ci_13 1.262163e-02                 3 1 ON  12
ci_14 1.320263e-02                 3 1 ON  13
ci_15 7.039781e-03                 3 1 ON  14
ci_16 7.222669e-03                 3 1 ON  15
ci_17 -7.347919e-03                3 1 ON  16
ci_18 -7.126704e-03                3 1 ON  17
ci_19 9.305142e-03                 3 1 ON  18
ci_20 6.754488e-03                 3 1 ON  19
ci_21 8.769226e-03                 3 1 ON  20
ci_22 8.790143e-03                 3 1 ON  21
ci_23 4.954685e-03                 3 1 ON  22
ci_24 4.335411e-03                 3 1 ON  23
ci_25 3.018956e-03                 3 1 ON  24
ci_26 3.192061e-03                 3 1 ON  25
ci_27 3.322872e-03                 3 1 ON  26
ci_28 2.401864e-03                 3 1 ON  27
ci_29 2.084015e-03                 3 1 ON  28
ci_30 -1.550753e-03                3 1 ON  29
ci_31 -1.595801e-03                3 1 ON  30
ci_32 -1.307988e-03                3 1 ON  31
ci_33 -1.077978e-03                3 1 ON  32
ci_34 1.475354e-03                 3 1 ON  33
ci_35 1.295507e-03                 3 1 ON  34
ci_36 -1.082740e-03                3 1 ON  35
ci_37 -1.091845e-03                3 1 ON  36
ci_38 -4.975954e-04                3 1 ON  37
ci_39 -6.054857e-04                3 1 ON  38
ci_40 -1.649992e-03                3 1 ON  39
ci_41 -1.429631e-03                3 1 ON  40
ci_42 -1.222491e-03                3 1 ON  41
ci_43 -2.614281e-03                3 1 ON  42
ci_44 -1.809550e-03                3 1 ON  43
ci_45 -5.888390e-04                3 1 ON  44
ci_46 -5.238390e-04                3 1 ON  45
ci_47 1.335575e-03                 3 1 ON  46
ci_48 9.105656e-04                 3 1 ON  47
ci_49 -1.001591e-03                3 1 ON  48
ci_50 -7.299656e-04                3 1 ON  49
ci_51 3.527514e-04                 3 1 ON  50
ci_52 3.341547e-04                 3 1 ON  51
ci_53 -6.250059e-04                3 1 ON  52
ci_54 -8.770868e-04                3 1 ON  53
ci_55 -5.964197e-04                3 1 ON  54
ci_56 1.798577e-03                 3 1 ON  55
ci_57 1.823091e-03                 3 1 ON  56
ci_58 -8.506244e-04                3 1 ON  57
ci_59 -1.104529e-03                3 1 ON  58
ci_60 6.056286e-04                 3 1 ON  59
ci_61 5.178717e-04                 3 1 ON  60
ci_62 -2.765656e-04                3 1 ON  61
ci_63 -5.037235e-04                3 1 ON  62
ci_64 -4.155190e-04                3 1 ON  63
ci_65 -4.249446e-04                3 1 ON  64
ci_66 -6.349778e-04                3 1 ON  65
ci_67 -6.276529e-04                3 1 ON  66
ci_68 -6.885994e-04                3 1 ON  67
ci_69 -3.231953e-04                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8109
    reference variance = 0.311287
====================================================
  Execution time = 4.3642e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5011e-01
  Total weights = 1.9639e+06
  Execution time = 5.9614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435944960060
                                         uncertainty =       0.002005152931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435944960060
                                         uncertainty =       0.002005152931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466831115
  error estimate for blocks of size 2^( 2) =       0.000492516373
  error estimate for blocks of size 2^( 3) =       0.000515991236
  error estimate for blocks of size 2^( 4) =       0.000533566161
  error estimate for blocks of size 2^( 5) =       0.000544129833
  error estimate for blocks of size 2^( 6) =       0.000550017228
  error estimate for blocks of size 2^( 7) =       0.000551927156

      target function =      -0.744106270713
              le_mean =     -22.814572689978
             les_mean =     520.956221473383
             stat err =       0.000544910094
             autocorr =       1.362479938135
   target nu stat err =       0.000544910094
   target dn stat err =       0.003614865252
      target stat err =       0.003029727242
              std dev =       0.660198894745
             le_variance =       0.435862580622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435751236613
                                         uncertainty =       0.001986906306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435751236613
                                         uncertainty =       0.001986906306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466727532
  error estimate for blocks of size 2^( 2) =       0.000492451689
  error estimate for blocks of size 2^( 3) =       0.000515965424
  error estimate for blocks of size 2^( 4) =       0.000533570696
  error estimate for blocks of size 2^( 5) =       0.000544160991
  error estimate for blocks of size 2^( 6) =       0.000550066474
  error estimate for blocks of size 2^( 7) =       0.000551995860

      target function =      -0.744698185434
              le_mean =     -22.814576723234
             les_mean =     520.955686768839
             stat err =       0.000544948505
             autocorr =       1.363276947967
   target nu stat err =       0.000544948505
   target dn stat err =       0.003453617500
      target stat err =       0.002904566032
              std dev =       0.660052405239
             le_variance =       0.435669177662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435820617788
                                         uncertainty =       0.001994006502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435820617788
                                         uncertainty =       0.001994006502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466764627
  error estimate for blocks of size 2^( 2) =       0.000492472127
  error estimate for blocks of size 2^( 3) =       0.000515968851
  error estimate for blocks of size 2^( 4) =       0.000533560874
  error estimate for blocks of size 2^( 5) =       0.000544139498
  error estimate for blocks of size 2^( 6) =       0.000550036514
  error estimate for blocks of size 2^( 7) =       0.000551956109

      target function =      -0.745267697526
              le_mean =     -22.814573107338
             les_mean =     520.954829921246
             stat err =       0.000544923249
             autocorr =       1.362933925423
   target nu stat err =       0.000544923249
   target dn stat err =       0.003472060411
      target stat err =       0.002923763234
              std dev =       0.660104866186
             le_variance =       0.435738434362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435950873432
                                         uncertainty =       0.002010523306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435950873432
                                         uncertainty =       0.002010523306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466834314
  error estimate for blocks of size 2^( 2) =       0.000492522146
  error estimate for blocks of size 2^( 3) =       0.000515998764
  error estimate for blocks of size 2^( 4) =       0.000533570713
  error estimate for blocks of size 2^( 5) =       0.000544119801
  error estimate for blocks of size 2^( 6) =       0.000550000547
  error estimate for blocks of size 2^( 7) =       0.000551909238

      target function =      -0.425716030030
              le_mean =     -22.814576036266
             les_mean =     521.455680922095
             stat err =       0.000544900075
             autocorr =       1.362411161354
   target nu stat err =       0.000544900075
   target dn stat err =       0.500615698431
      target stat err =       0.151670772882
              std dev =       0.660203418804
             le_variance =       0.435868554200


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744106270713        initial
     2.5000e-01     2.5000e+00             7.1983e-04        -0.744698185434
     1.0000e+00     1.0000e+01             2.0303e-04        -0.745267697526  <--
     4.0000e+00     4.0000e+01             5.2448e-05        -0.425716030030

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 7.3479e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.308170e-01 3 1  ON 0
ci_02                -3.089450e-02 3 1  ON 1
ci_03                -3.075086e-02 3 1  ON 2
ci_04                 2.758264e-02 3 1  ON 3
ci_05                -2.276570e-02 3 1  ON 4
ci_06                -2.260203e-02 3 1  ON 5
ci_07                 2.691921e-02 3 1  ON 6
ci_08                -6.236109e-03 3 1  ON 7
ci_09                -9.140085e-03 3 1  ON 8
ci_10                -9.174965e-03 3 1  ON 9
ci_11                 1.298624e-02 3 1  ON 10
ci_12                 7.537742e-03 3 1  ON 11
ci_13                 1.262163e-02 3 1  ON 12
ci_14                 1.320263e-02 3 1  ON 13
ci_15                 7.039781e-03 3 1  ON 14
ci_16                 7.222669e-03 3 1  ON 15
ci_17                -7.347919e-03 3 1  ON 16
ci_18                -7.126704e-03 3 1  ON 17
ci_19                 9.305142e-03 3 1  ON 18
ci_20                 6.754488e-03 3 1  ON 19
ci_21                 8.769226e-03 3 1  ON 20
ci_22                 8.790143e-03 3 1  ON 21
ci_23                 4.954685e-03 3 1  ON 22
ci_24                 4.335411e-03 3 1  ON 23
ci_25                 3.018956e-03 3 1  ON 24
ci_26                 3.192061e-03 3 1  ON 25
ci_27                 3.322872e-03 3 1  ON 26
ci_28                 2.401864e-03 3 1  ON 27
ci_29                 2.084015e-03 3 1  ON 28
ci_30                -1.550753e-03 3 1  ON 29
ci_31                -1.595801e-03 3 1  ON 30
ci_32                -1.307988e-03 3 1  ON 31
ci_33                -1.077978e-03 3 1  ON 32
ci_34                 1.475354e-03 3 1  ON 33
ci_35                 1.295507e-03 3 1  ON 34
ci_36                -1.082740e-03 3 1  ON 35
ci_37                -1.091845e-03 3 1  ON 36
ci_38                -4.975954e-04 3 1  ON 37
ci_39                -6.054857e-04 3 1  ON 38
ci_40                -1.649992e-03 3 1  ON 39
ci_41                -1.429631e-03 3 1  ON 40
ci_42                -1.222491e-03 3 1  ON 41
ci_43                -2.614281e-03 3 1  ON 42
ci_44                -1.809550e-03 3 1  ON 43
ci_45                -5.888390e-04 3 1  ON 44
ci_46                -5.238390e-04 3 1  ON 45
ci_47                 1.335575e-03 3 1  ON 46
ci_48                 9.105656e-04 3 1  ON 47
ci_49                -1.001591e-03 3 1  ON 48
ci_50                -7.299656e-04 3 1  ON 49
ci_51                 3.527514e-04 3 1  ON 50
ci_52                 3.341547e-04 3 1  ON 51
ci_53                -6.250059e-04 3 1  ON 52
ci_54                -8.770868e-04 3 1  ON 53
ci_55                -5.964197e-04 3 1  ON 54
ci_56                 1.798577e-03 3 1  ON 55
ci_57                 1.823091e-03 3 1  ON 56
ci_58                -8.506244e-04 3 1  ON 57
ci_59                -1.104529e-03 3 1  ON 58
ci_60                 6.056286e-04 3 1  ON 59
ci_61                 5.178717e-04 3 1  ON 60
ci_62                -2.765656e-04 3 1  ON 61
ci_63                -5.037235e-04 3 1  ON 62
ci_64                -4.155190e-04 3 1  ON 63
ci_65                -4.249446e-04 3 1  ON 64
ci_66                -6.349778e-04 3 1  ON 65
ci_67                -6.276529e-04 3 1  ON 66
ci_68                -6.885994e-04 3 1  ON 67
ci_69                -3.231953e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2924e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2805e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8074
    reference variance = 0.244379
====================================================
  Execution time = 4.3560e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4561e-01
  Total weights = 1.964588350e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434120851147
                                         uncertainty =       0.001724858933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434120851147
                                         uncertainty =       0.001724858933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465910102
  error estimate for blocks of size 2^( 2) =       0.000491598160
  error estimate for blocks of size 2^( 3) =       0.000515562461
  error estimate for blocks of size 2^( 4) =       0.000534037540
  error estimate for blocks of size 2^( 5) =       0.000545432360
  error estimate for blocks of size 2^( 6) =       0.000552330879
  error estimate for blocks of size 2^( 7) =       0.000553357044

      target function =      -0.748984165705
              le_mean =     -22.815037206191
             les_mean =     520.971528090987
             stat err =       0.000546289456
             autocorr =       1.374805885745
   target nu stat err =       0.000546289456
   target dn stat err =       0.002966396406
      target stat err =       0.002544052339
              std dev =       0.658896384804
             le_variance =       0.434144445908


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281503720619e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748991806138       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749045923811       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749053191729       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749055689409       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749056303246       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749056616431       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749056744867       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749056684973       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749056711849       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749056709076       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749056721438       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.592245e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748991806138       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749007321949       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749009298562       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749009955680       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749010099232       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749010171552       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749010199213       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749010184485       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749010190565       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749010189780       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.783772e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748991806138       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748995832879       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748996337801       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748996504042       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748996539067       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748996556686       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748996563286       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748996559639       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748996561112       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748996560912       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.549922e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1223e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.306387e-01 3 1  ON 0
ci_02                -3.076433e-02 3 1  ON 1
ci_03                -3.065547e-02 3 1  ON 2
ci_04                 2.744486e-02 3 1  ON 3
ci_05                -2.272025e-02 3 1  ON 4
ci_06                -2.246471e-02 3 1  ON 5
ci_07                 2.693165e-02 3 1  ON 6
ci_08                -6.166124e-03 3 1  ON 7
ci_09                -9.115090e-03 3 1  ON 8
ci_10                -9.157236e-03 3 1  ON 9
ci_11                 1.300387e-02 3 1  ON 10
ci_12                 7.472453e-03 3 1  ON 11
ci_13                 1.265459e-02 3 1  ON 12
ci_14                 1.314292e-02 3 1  ON 13
ci_15                 6.976386e-03 3 1  ON 14
ci_16                 7.238192e-03 3 1  ON 15
ci_17                -7.286953e-03 3 1  ON 16
ci_18                -7.042670e-03 3 1  ON 17
ci_19                 9.334525e-03 3 1  ON 18
ci_20                 6.722091e-03 3 1  ON 19
ci_21                 8.724225e-03 3 1  ON 20
ci_22                 8.799852e-03 3 1  ON 21
ci_23                 4.949343e-03 3 1  ON 22
ci_24                 4.311146e-03 3 1  ON 23
ci_25                 3.035812e-03 3 1  ON 24
ci_26                 3.192429e-03 3 1  ON 25
ci_27                 3.328361e-03 3 1  ON 26
ci_28                 2.412550e-03 3 1  ON 27
ci_29                 2.063702e-03 3 1  ON 28
ci_30                -1.572441e-03 3 1  ON 29
ci_31                -1.541731e-03 3 1  ON 30
ci_32                -1.266312e-03 3 1  ON 31
ci_33                -1.030547e-03 3 1  ON 32
ci_34                 1.387889e-03 3 1  ON 33
ci_35                 1.316415e-03 3 1  ON 34
ci_36                -1.074429e-03 3 1  ON 35
ci_37                -1.140379e-03 3 1  ON 36
ci_38                -5.064206e-04 3 1  ON 37
ci_39                -5.989134e-04 3 1  ON 38
ci_40                -1.653828e-03 3 1  ON 39
ci_41                -1.348483e-03 3 1  ON 40
ci_42                -1.193766e-03 3 1  ON 41
ci_43                -2.624889e-03 3 1  ON 42
ci_44                -1.802024e-03 3 1  ON 43
ci_45                -5.631882e-04 3 1  ON 44
ci_46                -5.183580e-04 3 1  ON 45
ci_47                 1.329905e-03 3 1  ON 46
ci_48                 9.651357e-04 3 1  ON 47
ci_49                -9.900723e-04 3 1  ON 48
ci_50                -7.241612e-04 3 1  ON 49
ci_51                 3.252366e-04 3 1  ON 50
ci_52                 3.599053e-04 3 1  ON 51
ci_53                -6.487043e-04 3 1  ON 52
ci_54                -8.604541e-04 3 1  ON 53
ci_55                -5.646843e-04 3 1  ON 54
ci_56                 1.802464e-03 3 1  ON 55
ci_57                 1.842295e-03 3 1  ON 56
ci_58                -8.379890e-04 3 1  ON 57
ci_59                -1.145641e-03 3 1  ON 58
ci_60                 4.602366e-04 3 1  ON 59
ci_61                 4.962873e-04 3 1  ON 60
ci_62                -2.288011e-04 3 1  ON 61
ci_63                -5.013199e-04 3 1  ON 62
ci_64                -3.966540e-04 3 1  ON 63
ci_65                -4.087334e-04 3 1  ON 64
ci_66                -6.558523e-04 3 1  ON 65
ci_67                -6.325348e-04 3 1  ON 66
ci_68                -6.974527e-04 3 1  ON 67
ci_69                -3.037465e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.9095
    reference variance = 2.28346
====================================================
  Execution time = 4.5063e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4773e-01
  Total weights = 1.9641e+06
  Execution time = 6.0157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434567255559
                                         uncertainty =       0.002504198005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434567255559
                                         uncertainty =       0.002504198005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466201895
  error estimate for blocks of size 2^( 2) =       0.000491333454
  error estimate for blocks of size 2^( 3) =       0.000514614145
  error estimate for blocks of size 2^( 4) =       0.000532433441
  error estimate for blocks of size 2^( 5) =       0.000544432038
  error estimate for blocks of size 2^( 6) =       0.000550162932
  error estimate for blocks of size 2^( 7) =       0.000554710334

      target function =      -0.745509574804
              le_mean =     -22.814853046536
             les_mean =     520.967310530140
             stat err =       0.000545434686
             autocorr =       1.368791931445
   target nu stat err =       0.000545434686
   target dn stat err =       0.003641870043
      target stat err =       0.003064157398
              std dev =       0.659309042807
             le_variance =       0.434688413927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434457212325
                                         uncertainty =       0.002501576896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434457212325
                                         uncertainty =       0.002501576896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466143063
  error estimate for blocks of size 2^( 2) =       0.000491309621
  error estimate for blocks of size 2^( 3) =       0.000514618474
  error estimate for blocks of size 2^( 4) =       0.000532465578
  error estimate for blocks of size 2^( 5) =       0.000544473477
  error estimate for blocks of size 2^( 6) =       0.000550216682
  error estimate for blocks of size 2^( 7) =       0.000554763681

      target function =      -0.747653939063
              le_mean =     -22.814855534102
             les_mean =     520.964838387716
             stat err =       0.000545479854
             autocorr =       1.369364236916
   target nu stat err =       0.000545479854
   target dn stat err =       0.002717992264
      target stat err =       0.002334775491
              std dev =       0.659225841153
             le_variance =       0.434578709644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434495323155
                                         uncertainty =       0.002502930566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434495323155
                                         uncertainty =       0.002502930566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466163392
  error estimate for blocks of size 2^( 2) =       0.000491314937
  error estimate for blocks of size 2^( 3) =       0.000514611576
  error estimate for blocks of size 2^( 4) =       0.000532447053
  error estimate for blocks of size 2^( 5) =       0.000544450348
  error estimate for blocks of size 2^( 6) =       0.000550187279
  error estimate for blocks of size 2^( 7) =       0.000554732461

      target function =      -0.747579024535
              le_mean =     -22.814853245207
             les_mean =     520.964823602702
             stat err =       0.000545454285
             autocorr =       1.369116441224
   target nu stat err =       0.000545454285
   target dn stat err =       0.002820639196
      target stat err =       0.002416641642
              std dev =       0.659254590883
             le_variance =       0.434616615600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434555779472
                                         uncertainty =       0.002504120776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434555779472
                                         uncertainty =       0.002504120776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466195747
  error estimate for blocks of size 2^( 2) =       0.000491329882
  error estimate for blocks of size 2^( 3) =       0.000514612635
  error estimate for blocks of size 2^( 4) =       0.000532434143
  error estimate for blocks of size 2^( 5) =       0.000544433203
  error estimate for blocks of size 2^( 6) =       0.000550164468
  error estimate for blocks of size 2^( 7) =       0.000554710779

      target function =      -0.746460405941
              le_mean =     -22.814852847957
             les_mean =     520.966152448060
             stat err =       0.000545435648
             autocorr =       1.368832864889
   target nu stat err =       0.000545435648
   target dn stat err =       0.003355524502
      target stat err =       0.002840022486
              std dev =       0.659300347801
             le_variance =       0.434676948610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745509574804        initial
     2.5000e-01     2.5000e+00             6.5922e-04        -0.747653939063  <--
     1.0000e+00     1.0000e+01             1.7838e-04        -0.747579024535
     4.0000e+00     4.0000e+01             4.5499e-05        -0.746460405941

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 7.5217e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.301578e-01 3 1  ON 0
ci_02                -3.043331e-02 3 1  ON 1
ci_03                -3.041631e-02 3 1  ON 2
ci_04                 2.710375e-02 3 1  ON 3
ci_05                -2.260775e-02 3 1  ON 4
ci_06                -2.211594e-02 3 1  ON 5
ci_07                 2.696429e-02 3 1  ON 6
ci_08                -5.990360e-03 3 1  ON 7
ci_09                -9.050563e-03 3 1  ON 8
ci_10                -9.110145e-03 3 1  ON 9
ci_11                 1.305200e-02 3 1  ON 10
ci_12                 7.308218e-03 3 1  ON 11
ci_13                 1.274264e-02 3 1  ON 12
ci_14                 1.297257e-02 3 1  ON 13
ci_15                 6.814105e-03 3 1  ON 14
ci_16                 7.279197e-03 3 1  ON 15
ci_17                -7.129989e-03 3 1  ON 16
ci_18                -6.826179e-03 3 1  ON 17
ci_19                 9.407269e-03 3 1  ON 18
ci_20                 6.640554e-03 3 1  ON 19
ci_21                 8.607020e-03 3 1  ON 20
ci_22                 8.826389e-03 3 1  ON 21
ci_23                 4.937292e-03 3 1  ON 22
ci_24                 4.246991e-03 3 1  ON 23
ci_25                 3.078590e-03 3 1  ON 24
ci_26                 3.193345e-03 3 1  ON 25
ci_27                 3.343614e-03 3 1  ON 26
ci_28                 2.439191e-03 3 1  ON 27
ci_29                 2.010669e-03 3 1  ON 28
ci_30                -1.626088e-03 3 1  ON 29
ci_31                -1.396442e-03 3 1  ON 30
ci_32                -1.164473e-03 3 1  ON 31
ci_33                -9.138949e-04 3 1  ON 32
ci_34                 1.166476e-03 3 1  ON 33
ci_35                 1.372029e-03 3 1  ON 34
ci_36                -1.052599e-03 3 1  ON 35
ci_37                -1.262266e-03 3 1  ON 36
ci_38                -5.290164e-04 3 1  ON 37
ci_39                -5.821507e-04 3 1  ON 38
ci_40                -1.663718e-03 3 1  ON 39
ci_41                -1.147693e-03 3 1  ON 40
ci_42                -1.123684e-03 3 1  ON 41
ci_43                -2.650676e-03 3 1  ON 42
ci_44                -1.781184e-03 3 1  ON 43
ci_45                -4.980360e-04 3 1  ON 44
ci_46                -5.044755e-04 3 1  ON 45
ci_47                 1.315175e-03 3 1  ON 46
ci_48                 1.108916e-03 3 1  ON 47
ci_49                -9.616788e-04 3 1  ON 48
ci_50                -7.099812e-04 3 1  ON 49
ci_51                 2.554705e-04 3 1  ON 50
ci_52                 4.240646e-04 3 1  ON 51
ci_53                -7.065822e-04 3 1  ON 52
ci_54                -8.176747e-04 3 1  ON 53
ci_55                -4.836987e-04 3 1  ON 54
ci_56                 1.812721e-03 3 1  ON 55
ci_57                 1.890382e-03 3 1  ON 56
ci_58                -8.059553e-04 3 1  ON 57
ci_59                -1.248943e-03 3 1  ON 58
ci_60                 5.951389e-05 3 1  ON 59
ci_61                 4.359042e-04 3 1  ON 60
ci_62                -1.117829e-04 3 1  ON 61
ci_63                -4.964870e-04 3 1  ON 62
ci_64                -3.494907e-04 3 1  ON 63
ci_65                -3.679542e-04 3 1  ON 64
ci_66                -7.084990e-04 3 1  ON 65
ci_67                -6.449136e-04 3 1  ON 66
ci_68                -7.206211e-04 3 1  ON 67
ci_69                -2.549337e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2670e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8136
    reference variance = 0.524939
====================================================
  Execution time = 4.4808e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4800e-01
  Total weights = 1.964142340e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436112124657
                                         uncertainty =       0.001995369635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436112124657
                                         uncertainty =       0.001995369635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467011257
  error estimate for blocks of size 2^( 2) =       0.000492201415
  error estimate for blocks of size 2^( 3) =       0.000516057989
  error estimate for blocks of size 2^( 4) =       0.000534377655
  error estimate for blocks of size 2^( 5) =       0.000545507174
  error estimate for blocks of size 2^( 6) =       0.000552669767
  error estimate for blocks of size 2^( 7) =       0.000557748110

      target function =      -0.746995124135
              le_mean =     -22.814898292050
             les_mean =     520.967581407265
             stat err =       0.000547575677
             autocorr =       1.374781246783
   target nu stat err =       0.000547575677
   target dn stat err =       0.003210078445
      target stat err =       0.002727128193
              std dev =       0.660453653105
             le_variance =       0.436199027899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281489829205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747004004949       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747163444221       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747183322678       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747188542419       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747194053279       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747194715931       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747194750986       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747194910672       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747194947852       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747194965822       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747194974417       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 2.799741e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747004004949       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747063665919       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747070106006       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747071637294       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747073137126       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747073203824       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747073181036       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747073214346       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747073219424       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747073222307       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 8.918402e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747004004949       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747021034650       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747022758579       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747023151894       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747023526035       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747023532427       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747023524828       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747023532323       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747023533203       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.395204e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2535e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.292660e-01 3 1  ON 0
ci_02                -2.988209e-02 3 1  ON 1
ci_03                -2.990796e-02 3 1  ON 2
ci_04                 2.704606e-02 3 1  ON 3
ci_05                -2.241170e-02 3 1  ON 4
ci_06                -2.198728e-02 3 1  ON 5
ci_07                 2.712170e-02 3 1  ON 6
ci_08                -5.839036e-03 3 1  ON 7
ci_09                -9.070977e-03 3 1  ON 8
ci_10                -8.845320e-03 3 1  ON 9
ci_11                 1.310372e-02 3 1  ON 10
ci_12                 7.179789e-03 3 1  ON 11
ci_13                 1.276893e-02 3 1  ON 12
ci_14                 1.289024e-02 3 1  ON 13
ci_15                 6.620151e-03 3 1  ON 14
ci_16                 6.976315e-03 3 1  ON 15
ci_17                -7.178353e-03 3 1  ON 16
ci_18                -6.504534e-03 3 1  ON 17
ci_19                 9.365456e-03 3 1  ON 18
ci_20                 6.552570e-03 3 1  ON 19
ci_21                 8.735836e-03 3 1  ON 20
ci_22                 8.632713e-03 3 1  ON 21
ci_23                 4.866656e-03 3 1  ON 22
ci_24                 4.156120e-03 3 1  ON 23
ci_25                 2.991222e-03 3 1  ON 24
ci_26                 3.170735e-03 3 1  ON 25
ci_27                 3.344506e-03 3 1  ON 26
ci_28                 2.246241e-03 3 1  ON 27
ci_29                 1.756217e-03 3 1  ON 28
ci_30                -1.704623e-03 3 1  ON 29
ci_31                -1.121029e-03 3 1  ON 30
ci_32                -1.040534e-03 3 1  ON 31
ci_33                -1.126861e-03 3 1  ON 32
ci_34                 1.150517e-03 3 1  ON 33
ci_35                 1.399682e-03 3 1  ON 34
ci_36                -1.038513e-03 3 1  ON 35
ci_37                -1.178009e-03 3 1  ON 36
ci_38                -6.220264e-04 3 1  ON 37
ci_39                -6.004384e-04 3 1  ON 38
ci_40                -1.627483e-03 3 1  ON 39
ci_41                -1.186197e-03 3 1  ON 40
ci_42                -1.137293e-03 3 1  ON 41
ci_43                -2.593959e-03 3 1  ON 42
ci_44                -2.335794e-03 3 1  ON 43
ci_45                -5.113761e-04 3 1  ON 44
ci_46                -6.498351e-04 3 1  ON 45
ci_47                 1.379894e-03 3 1  ON 46
ci_48                 1.208329e-03 3 1  ON 47
ci_49                -9.941185e-04 3 1  ON 48
ci_50                -7.465425e-04 3 1  ON 49
ci_51                 2.131629e-04 3 1  ON 50
ci_52                 2.925840e-04 3 1  ON 51
ci_53                -6.741422e-04 3 1  ON 52
ci_54                -9.008618e-04 3 1  ON 53
ci_55                -5.462823e-04 3 1  ON 54
ci_56                 2.127451e-03 3 1  ON 55
ci_57                 1.779323e-03 3 1  ON 56
ci_58                -9.281599e-04 3 1  ON 57
ci_59                -1.334920e-03 3 1  ON 58
ci_60                 2.101232e-04 3 1  ON 59
ci_61                 2.677091e-04 3 1  ON 60
ci_62                -3.284960e-04 3 1  ON 61
ci_63                -6.073392e-04 3 1  ON 62
ci_64                -3.239904e-04 3 1  ON 63
ci_65                -2.061804e-04 3 1  ON 64
ci_66                -7.129531e-04 3 1  ON 65
ci_67                -7.389179e-04 3 1  ON 66
ci_68                -9.680023e-04 3 1  ON 67
ci_69                -1.007900e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7463
    reference variance = 0.29845
====================================================
  Execution time = 4.3237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6056e-01
  Total weights = 1.9645e+06
  Execution time = 6.0193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439497768916
                                         uncertainty =       0.001976366063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439497768916
                                         uncertainty =       0.001976366063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468796307
  error estimate for blocks of size 2^( 2) =       0.000494487184
  error estimate for blocks of size 2^( 3) =       0.000517890546
  error estimate for blocks of size 2^( 4) =       0.000535118147
  error estimate for blocks of size 2^( 5) =       0.000545340012
  error estimate for blocks of size 2^( 6) =       0.000553028329
  error estimate for blocks of size 2^( 7) =       0.000557101411

      target function =      -0.646504269302
              le_mean =     -22.814195801887
             les_mean =     521.061103739310
             stat err =       0.000547646975
             autocorr =       1.364686896732
   target nu stat err =       0.000547646975
   target dn stat err =       0.123274337611
      target stat err =       0.077495368577
              std dev =       0.662978095521
             le_variance =       0.439539955141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438568435354
                                         uncertainty =       0.001821309071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438568435354
                                         uncertainty =       0.001821309071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468300178
  error estimate for blocks of size 2^( 2) =       0.000494082568
  error estimate for blocks of size 2^( 3) =       0.000517582950
  error estimate for blocks of size 2^( 4) =       0.000534876352
  error estimate for blocks of size 2^( 5) =       0.000545205266
  error estimate for blocks of size 2^( 6) =       0.000552922605
  error estimate for blocks of size 2^( 7) =       0.000556981575

      target function =      -0.739610505973
              le_mean =     -22.814189230501
             les_mean =     520.944223430919
             stat err =       0.000547496449
             autocorr =       1.366828321207
   target nu stat err =       0.000547496449
   target dn stat err =       0.004624077382
      target stat err =       0.003798317902
              std dev =       0.662276462638
             le_variance =       0.438610112964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581197946
                                         uncertainty =       0.001817753119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438581197946
                                         uncertainty =       0.001817753119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468307144
  error estimate for blocks of size 2^( 2) =       0.000494063115
  error estimate for blocks of size 2^( 3) =       0.000517543544
  error estimate for blocks of size 2^( 4) =       0.000534815682
  error estimate for blocks of size 2^( 5) =       0.000545127754
  error estimate for blocks of size 2^( 6) =       0.000552835518
  error estimate for blocks of size 2^( 7) =       0.000556889326

      target function =      -0.114042677756
              le_mean =     -22.814181093838
             les_mean =     523.787998036940
             stat err =       0.000547417070
             autocorr =       1.366391352707
   target nu stat err =       0.000547417070
   target dn stat err =       2.848308265769
      target stat err =       0.086482119714
              std dev =       0.662286314958
             le_variance =       0.438623162980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959272973
                                         uncertainty =       0.001833719441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959272973
                                         uncertainty =       0.001833719441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468509146
  error estimate for blocks of size 2^( 2) =       0.000494215491
  error estimate for blocks of size 2^( 3) =       0.000517642406
  error estimate for blocks of size 2^( 4) =       0.000534875397
  error estimate for blocks of size 2^( 5) =       0.000545128732
  error estimate for blocks of size 2^( 6) =       0.000552820101
  error estimate for blocks of size 2^( 7) =       0.000556878735

      target function =      -0.707241124500
              le_mean =     -22.814186794571
             les_mean =     520.983566363735
             stat err =       0.000547425741
             autocorr =       1.365256596657
   target nu stat err =       0.000547425741
   target dn stat err =       0.046840626152
      target stat err =       0.034827368691
              std dev =       0.662571987887
             le_variance =       0.439001639133


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.646504269302        initial
     6.2500e-02     6.2500e-01             2.7997e-03        -0.739610505973  <--
     2.5000e-01     2.5000e+00             8.9184e-04        -0.114042677756
     1.0000e+00     1.0000e+01             2.3952e-04        -0.707241124500

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 7.3424e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.273581e-01 3 1  ON 0
ci_02                -2.892718e-02 3 1  ON 1
ci_03                -2.902845e-02 3 1  ON 2
ci_04                 2.695408e-02 3 1  ON 3
ci_05                -2.210389e-02 3 1  ON 4
ci_06                -2.180572e-02 3 1  ON 5
ci_07                 2.742170e-02 3 1  ON 6
ci_08                -5.582346e-03 3 1  ON 7
ci_09                -9.108279e-03 3 1  ON 8
ci_10                -8.363804e-03 3 1  ON 9
ci_11                 1.321618e-02 3 1  ON 10
ci_12                 6.962869e-03 3 1  ON 11
ci_13                 1.284047e-02 3 1  ON 12
ci_14                 1.271164e-02 3 1  ON 13
ci_15                 6.273791e-03 3 1  ON 14
ci_16                 6.440988e-03 3 1  ON 15
ci_17                -7.269576e-03 3 1  ON 16
ci_18                -5.943572e-03 3 1  ON 17
ci_19                 9.296245e-03 3 1  ON 18
ci_20                 6.403130e-03 3 1  ON 19
ci_21                 9.001014e-03 3 1  ON 20
ci_22                 8.255863e-03 3 1  ON 21
ci_23                 4.754851e-03 3 1  ON 22
ci_24                 3.981914e-03 3 1  ON 23
ci_25                 2.851480e-03 3 1  ON 24
ci_26                 3.143507e-03 3 1  ON 25
ci_27                 3.337819e-03 3 1  ON 26
ci_28                 1.907681e-03 3 1  ON 27
ci_29                 1.307098e-03 3 1  ON 28
ci_30                -1.854224e-03 3 1  ON 29
ci_31                -5.563977e-04 3 1  ON 30
ci_32                -8.376743e-04 3 1  ON 31
ci_33                -1.481324e-03 3 1  ON 32
ci_34                 1.136463e-03 3 1  ON 33
ci_35                 1.466298e-03 3 1  ON 34
ci_36                -1.016692e-03 3 1  ON 35
ci_37                -1.037207e-03 3 1  ON 36
ci_38                -7.736995e-04 3 1  ON 37
ci_39                -6.314622e-04 3 1  ON 38
ci_40                -1.563970e-03 3 1  ON 39
ci_41                -1.249483e-03 3 1  ON 40
ci_42                -1.160125e-03 3 1  ON 41
ci_43                -2.486561e-03 3 1  ON 42
ci_44                -3.305933e-03 3 1  ON 43
ci_45                -5.304739e-04 3 1  ON 44
ci_46                -8.882964e-04 3 1  ON 45
ci_47                 1.528877e-03 3 1  ON 46
ci_48                 1.373853e-03 3 1  ON 47
ci_49                -1.047308e-03 3 1  ON 48
ci_50                -8.067761e-04 3 1  ON 49
ci_51                 1.430596e-04 3 1  ON 50
ci_52                 7.378396e-05 3 1  ON 51
ci_53                -6.280182e-04 3 1  ON 52
ci_54                -1.037657e-03 3 1  ON 53
ci_55                -6.515569e-04 3 1  ON 54
ci_56                 2.641668e-03 3 1  ON 55
ci_57                 1.605578e-03 3 1  ON 56
ci_58                -1.127171e-03 3 1  ON 57
ci_59                -1.476633e-03 3 1  ON 58
ci_60                 5.503947e-04 3 1  ON 59
ci_61                -1.254064e-04 3 1  ON 60
ci_62                -6.746269e-04 3 1  ON 61
ci_63                -7.870553e-04 3 1  ON 62
ci_64                -2.751526e-04 3 1  ON 63
ci_65                 6.695548e-05 3 1  ON 64
ci_66                -7.230186e-04 3 1  ON 65
ci_67                -8.948207e-04 3 1  ON 66
ci_68                -1.385319e-03 3 1  ON 67
ci_69                 1.625343e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2597e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7721
    reference variance = 0.614324
====================================================
  Execution time = 4.4173e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5205e-01
  Total weights = 1.964327488e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436369742516
                                         uncertainty =       0.002320376452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436369742516
                                         uncertainty =       0.002320376452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467144671
  error estimate for blocks of size 2^( 2) =       0.000492454666
  error estimate for blocks of size 2^( 3) =       0.000515818520
  error estimate for blocks of size 2^( 4) =       0.000533469127
  error estimate for blocks of size 2^( 5) =       0.000545183396
  error estimate for blocks of size 2^( 6) =       0.000553515820
  error estimate for blocks of size 2^( 7) =       0.000554418668

      target function =      -0.743649160974
              le_mean =     -22.814826089464
             les_mean =     520.968339125566
             stat err =       0.000546646753
             autocorr =       1.369338273611
   target nu stat err =       0.000546646753
   target dn stat err =       0.003903341203
      target stat err =       0.003259965135
              std dev =       0.660642329414
             le_variance =       0.436448287414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281482608946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743662559649       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743810775205       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743844239964       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743849507943       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743852868627       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743854043423       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743854949610       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743854399850       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743854495567       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743854548762       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743854735123       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743854797353       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-02 is 3.322106e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743662559649       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743748857997       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743766224080       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743768408769       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743769581815       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743769789477       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743770058928       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743769869326       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743769910325       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743769933087       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743769981403       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.538502e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743662559649       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743694866904       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743700719606       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743701313580       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743701585792       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743701595468       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743701658862       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743701615510       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743701627647       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743701633962       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.918376e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1951e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.258196e-01 3 1  ON 0
ci_02                -2.826007e-02 3 1  ON 1
ci_03                -2.864572e-02 3 1  ON 2
ci_04                 2.658553e-02 3 1  ON 3
ci_05                -2.175696e-02 3 1  ON 4
ci_06                -2.123261e-02 3 1  ON 5
ci_07                 2.719094e-02 3 1  ON 6
ci_08                -5.087041e-03 3 1  ON 7
ci_09                -8.858082e-03 3 1  ON 8
ci_10                -8.999085e-03 3 1  ON 9
ci_11                 1.280317e-02 3 1  ON 10
ci_12                 7.014685e-03 3 1  ON 11
ci_13                 1.255611e-02 3 1  ON 12
ci_14                 1.342092e-02 3 1  ON 13
ci_15                 6.470932e-03 3 1  ON 14
ci_16                 6.972618e-03 3 1  ON 15
ci_17                -7.604795e-03 3 1  ON 16
ci_18                -6.410882e-03 3 1  ON 17
ci_19                 9.836477e-03 3 1  ON 18
ci_20                 6.041696e-03 3 1  ON 19
ci_21                 8.595425e-03 3 1  ON 20
ci_22                 9.007220e-03 3 1  ON 21
ci_23                 4.247155e-03 3 1  ON 22
ci_24                 4.637722e-03 3 1  ON 23
ci_25                 2.905828e-03 3 1  ON 24
ci_26                 2.761136e-03 3 1  ON 25
ci_27                 3.327938e-03 3 1  ON 26
ci_28                 2.542203e-03 3 1  ON 27
ci_29                 8.407528e-04 3 1  ON 28
ci_30                -1.646734e-03 3 1  ON 29
ci_31                -1.121630e-03 3 1  ON 30
ci_32                -7.557420e-04 3 1  ON 31
ci_33                -1.296299e-03 3 1  ON 32
ci_34                 1.936260e-03 3 1  ON 33
ci_35                 1.394399e-03 3 1  ON 34
ci_36                -1.050829e-03 3 1  ON 35
ci_37                -1.142704e-03 3 1  ON 36
ci_38                -5.965975e-04 3 1  ON 37
ci_39                -7.259130e-04 3 1  ON 38
ci_40                -1.505799e-03 3 1  ON 39
ci_41                -1.710718e-03 3 1  ON 40
ci_42                -1.381135e-03 3 1  ON 41
ci_43                -2.509132e-03 3 1  ON 42
ci_44                -3.194550e-03 3 1  ON 43
ci_45                -5.357584e-04 3 1  ON 44
ci_46                -4.875608e-04 3 1  ON 45
ci_47                 1.388790e-03 3 1  ON 46
ci_48                 1.390489e-03 3 1  ON 47
ci_49                -1.087081e-03 3 1  ON 48
ci_50                -6.643692e-04 3 1  ON 49
ci_51                 1.069556e-04 3 1  ON 50
ci_52                -3.148379e-04 3 1  ON 51
ci_53                -6.123731e-04 3 1  ON 52
ci_54                -1.536108e-03 3 1  ON 53
ci_55                -2.388570e-04 3 1  ON 54
ci_56                 2.033837e-03 3 1  ON 55
ci_57                 1.741277e-03 3 1  ON 56
ci_58                -9.096231e-04 3 1  ON 57
ci_59                -9.301658e-04 3 1  ON 58
ci_60                -1.724566e-05 3 1  ON 59
ci_61                 3.476950e-05 3 1  ON 60
ci_62                -6.966283e-04 3 1  ON 61
ci_63                -5.047758e-04 3 1  ON 62
ci_64                -5.682701e-04 3 1  ON 63
ci_65                 4.593899e-05 3 1  ON 64
ci_66                -1.090809e-03 3 1  ON 65
ci_67                -7.240859e-04 3 1  ON 66
ci_68                -1.238898e-03 3 1  ON 67
ci_69                 3.955957e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.816
    reference variance = 0.422712
====================================================
  Execution time = 4.3567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5051e-01
  Total weights = 1.9642e+06
  Execution time = 6.0089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437491621980
                                         uncertainty =       0.003291021956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437491621980
                                         uncertainty =       0.003291021956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467662071
  error estimate for blocks of size 2^( 2) =       0.000493167480
  error estimate for blocks of size 2^( 3) =       0.000517404161
  error estimate for blocks of size 2^( 4) =       0.000533928172
  error estimate for blocks of size 2^( 5) =       0.000545097613
  error estimate for blocks of size 2^( 6) =       0.000551250955
  error estimate for blocks of size 2^( 7) =       0.000556211138

      target function =      -0.742563302231
              le_mean =     -22.814333510881
             les_mean =     520.947181709090
             stat err =       0.000546621970
             autocorr =       1.366186122245
   target nu stat err =       0.000546621970
   target dn stat err =       0.004564791065
      target stat err =       0.003781120728
              std dev =       0.661374042852
             le_variance =       0.437415624558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438051021205
                                         uncertainty =       0.003353765623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438051021205
                                         uncertainty =       0.003353765623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467959569
  error estimate for blocks of size 2^( 2) =       0.000493503600
  error estimate for blocks of size 2^( 3) =       0.000517800397
  error estimate for blocks of size 2^( 4) =       0.000534373215
  error estimate for blocks of size 2^( 5) =       0.000545604137
  error estimate for blocks of size 2^( 6) =       0.000551578495
  error estimate for blocks of size 2^( 7) =       0.000556411220

      target function =      -0.607857199658
              le_mean =     -22.814341147849
             les_mean =     521.126285959276
             stat err =       0.000546991767
             autocorr =       1.366296368389
   target nu stat err =       0.000546991767
   target dn stat err =       0.156436858628
      target stat err =       0.087498547260
              std dev =       0.661794769482
             le_variance =       0.437972316914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437421330360
                                         uncertainty =       0.003333852253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437421330360
                                         uncertainty =       0.003333852253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467624465
  error estimate for blocks of size 2^( 2) =       0.000493206842
  error estimate for blocks of size 2^( 3) =       0.000517542147
  error estimate for blocks of size 2^( 4) =       0.000534144015
  error estimate for blocks of size 2^( 5) =       0.000545321873
  error estimate for blocks of size 2^( 6) =       0.000551456320
  error estimate for blocks of size 2^( 7) =       0.000556410854

      target function =      -0.730065618170
              le_mean =     -22.814335404110
             les_mean =     520.962763077855
             stat err =       0.000546833266
             autocorr =       1.367462429676
   target nu stat err =       0.000546833266
   target dn stat err =       0.008200847503
      target stat err =       0.006509816403
              std dev =       0.661320860855
             le_variance =       0.437345281002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437388181760
                                         uncertainty =       0.003299694767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437388181760
                                         uncertainty =       0.003299694767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467606942
  error estimate for blocks of size 2^( 2) =       0.000493128004
  error estimate for blocks of size 2^( 3) =       0.000517380791
  error estimate for blocks of size 2^( 4) =       0.000533920320
  error estimate for blocks of size 2^( 5) =       0.000545095903
  error estimate for blocks of size 2^( 6) =       0.000551246470
  error estimate for blocks of size 2^( 7) =       0.000556204421

      target function =      -0.734192773173
              le_mean =     -22.814320784727
             les_mean =     520.956827788466
             stat err =       0.000546616779
             autocorr =       1.366482318590
   target nu stat err =       0.000546616779
   target dn stat err =       0.011705433277
      target stat err =       0.009377641547
              std dev =       0.661296079629
             le_variance =       0.437312504933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742563302231        initial  <--
     1.5625e-02     1.5625e-01             3.3221e-03        -0.607857199658
     6.2500e-02     6.2500e-01             1.5385e-03        -0.730065618170
     2.5000e-01     2.5000e+00             4.9184e-04        -0.734192773173

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.7290
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.273581e-01 3 1  ON 0
ci_02                -2.892718e-02 3 1  ON 1
ci_03                -2.902845e-02 3 1  ON 2
ci_04                 2.695408e-02 3 1  ON 3
ci_05                -2.210389e-02 3 1  ON 4
ci_06                -2.180572e-02 3 1  ON 5
ci_07                 2.742170e-02 3 1  ON 6
ci_08                -5.582346e-03 3 1  ON 7
ci_09                -9.108279e-03 3 1  ON 8
ci_10                -8.363804e-03 3 1  ON 9
ci_11                 1.321618e-02 3 1  ON 10
ci_12                 6.962869e-03 3 1  ON 11
ci_13                 1.284047e-02 3 1  ON 12
ci_14                 1.271164e-02 3 1  ON 13
ci_15                 6.273791e-03 3 1  ON 14
ci_16                 6.440988e-03 3 1  ON 15
ci_17                -7.269576e-03 3 1  ON 16
ci_18                -5.943572e-03 3 1  ON 17
ci_19                 9.296245e-03 3 1  ON 18
ci_20                 6.403130e-03 3 1  ON 19
ci_21                 9.001014e-03 3 1  ON 20
ci_22                 8.255863e-03 3 1  ON 21
ci_23                 4.754851e-03 3 1  ON 22
ci_24                 3.981914e-03 3 1  ON 23
ci_25                 2.851480e-03 3 1  ON 24
ci_26                 3.143507e-03 3 1  ON 25
ci_27                 3.337819e-03 3 1  ON 26
ci_28                 1.907681e-03 3 1  ON 27
ci_29                 1.307098e-03 3 1  ON 28
ci_30                -1.854224e-03 3 1  ON 29
ci_31                -5.563977e-04 3 1  ON 30
ci_32                -8.376743e-04 3 1  ON 31
ci_33                -1.481324e-03 3 1  ON 32
ci_34                 1.136463e-03 3 1  ON 33
ci_35                 1.466298e-03 3 1  ON 34
ci_36                -1.016692e-03 3 1  ON 35
ci_37                -1.037207e-03 3 1  ON 36
ci_38                -7.736995e-04 3 1  ON 37
ci_39                -6.314622e-04 3 1  ON 38
ci_40                -1.563970e-03 3 1  ON 39
ci_41                -1.249483e-03 3 1  ON 40
ci_42                -1.160125e-03 3 1  ON 41
ci_43                -2.486561e-03 3 1  ON 42
ci_44                -3.305933e-03 3 1  ON 43
ci_45                -5.304739e-04 3 1  ON 44
ci_46                -8.882964e-04 3 1  ON 45
ci_47                 1.528877e-03 3 1  ON 46
ci_48                 1.373853e-03 3 1  ON 47
ci_49                -1.047308e-03 3 1  ON 48
ci_50                -8.067761e-04 3 1  ON 49
ci_51                 1.430596e-04 3 1  ON 50
ci_52                 7.378396e-05 3 1  ON 51
ci_53                -6.280182e-04 3 1  ON 52
ci_54                -1.037657e-03 3 1  ON 53
ci_55                -6.515569e-04 3 1  ON 54
ci_56                 2.641668e-03 3 1  ON 55
ci_57                 1.605578e-03 3 1  ON 56
ci_58                -1.127171e-03 3 1  ON 57
ci_59                -1.476633e-03 3 1  ON 58
ci_60                 5.503947e-04 3 1  ON 59
ci_61                -1.254064e-04 3 1  ON 60
ci_62                -6.746269e-04 3 1  ON 61
ci_63                -7.870553e-04 3 1  ON 62
ci_64                -2.751526e-04 3 1  ON 63
ci_65                 6.695548e-05 3 1  ON 64
ci_66                -7.230186e-04 3 1  ON 65
ci_67                -8.948207e-04 3 1  ON 66
ci_68                -1.385319e-03 3 1  ON 67
ci_69                 1.625343e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2569e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8808
    reference variance = 0.22185
====================================================
  Execution time = 4.5506e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4824e-01
  Total weights = 1.964215218e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433709998959
                                         uncertainty =       0.001915941151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433709998959
                                         uncertainty =       0.001915941151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465695314
  error estimate for blocks of size 2^( 2) =       0.000491434255
  error estimate for blocks of size 2^( 3) =       0.000515486504
  error estimate for blocks of size 2^( 4) =       0.000532683162
  error estimate for blocks of size 2^( 5) =       0.000544581028
  error estimate for blocks of size 2^( 6) =       0.000551870252
  error estimate for blocks of size 2^( 7) =       0.000555943820

      target function =      -0.746786565704
              le_mean =     -22.813894514832
             les_mean =     520.922019601935
             stat err =       0.000546269565
             autocorr =       1.375974146332
   target nu stat err =       0.000546269565
   target dn stat err =       0.003605695638
      target stat err =       0.003040965049
              std dev =       0.658592629449
             le_variance =       0.433744251565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281389451483e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746797998312       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746870176834       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746885473449       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746888261277       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746888509744       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746888427053       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746888261474       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746888187096       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746888081650       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746888133394       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746888115793       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746888128181       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 9.184645e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746797998312       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746820059484       residual = 6.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746824530722       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746825269127       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746825306989       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746825275102       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746825228725       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746825209871       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746825188493       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746825200894       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746825196832       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.542632e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746797998312       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746803838560       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746805005100       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746805191626       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746805198906       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746805190160       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746805178315       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746805173639       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746805168717       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746805171733       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746805170754       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 6.525405e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129160 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3257e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.271038e-01 3 1  ON 0
ci_02                -2.889199e-02 3 1  ON 1
ci_03                -2.880363e-02 3 1  ON 2
ci_04                 2.693868e-02 3 1  ON 3
ci_05                -2.209623e-02 3 1  ON 4
ci_06                -2.189111e-02 3 1  ON 5
ci_07                 2.746143e-02 3 1  ON 6
ci_08                -5.535440e-03 3 1  ON 7
ci_09                -9.100844e-03 3 1  ON 8
ci_10                -8.408527e-03 3 1  ON 9
ci_11                 1.315726e-02 3 1  ON 10
ci_12                 6.975025e-03 3 1  ON 11
ci_13                 1.287883e-02 3 1  ON 12
ci_14                 1.252424e-02 3 1  ON 13
ci_15                 6.286680e-03 3 1  ON 14
ci_16                 6.391379e-03 3 1  ON 15
ci_17                -7.163969e-03 3 1  ON 16
ci_18                -6.070340e-03 3 1  ON 17
ci_19                 9.245105e-03 3 1  ON 18
ci_20                 6.333906e-03 3 1  ON 19
ci_21                 9.064264e-03 3 1  ON 20
ci_22                 8.267076e-03 3 1  ON 21
ci_23                 4.703870e-03 3 1  ON 22
ci_24                 3.951135e-03 3 1  ON 23
ci_25                 2.853393e-03 3 1  ON 24
ci_26                 3.152207e-03 3 1  ON 25
ci_27                 3.292367e-03 3 1  ON 26
ci_28                 1.911347e-03 3 1  ON 27
ci_29                 1.321470e-03 3 1  ON 28
ci_30                -1.823689e-03 3 1  ON 29
ci_31                -5.960438e-04 3 1  ON 30
ci_32                -9.080027e-04 3 1  ON 31
ci_33                -1.390560e-03 3 1  ON 32
ci_34                 1.263523e-03 3 1  ON 33
ci_35                 1.367688e-03 3 1  ON 34
ci_36                -1.010098e-03 3 1  ON 35
ci_37                -1.136764e-03 3 1  ON 36
ci_38                -7.435947e-04 3 1  ON 37
ci_39                -6.811232e-04 3 1  ON 38
ci_40                -1.593082e-03 3 1  ON 39
ci_41                -1.183230e-03 3 1  ON 40
ci_42                -1.127782e-03 3 1  ON 41
ci_43                -2.486982e-03 3 1  ON 42
ci_44                -3.165448e-03 3 1  ON 43
ci_45                -4.161784e-04 3 1  ON 44
ci_46                -7.488217e-04 3 1  ON 45
ci_47                 1.583104e-03 3 1  ON 46
ci_48                 1.407296e-03 3 1  ON 47
ci_49                -1.024021e-03 3 1  ON 48
ci_50                -7.994086e-04 3 1  ON 49
ci_51                 1.006778e-04 3 1  ON 50
ci_52                 9.208489e-05 3 1  ON 51
ci_53                -6.610661e-04 3 1  ON 52
ci_54                -1.068815e-03 3 1  ON 53
ci_55                -6.133304e-04 3 1  ON 54
ci_56                 2.532534e-03 3 1  ON 55
ci_57                 1.596006e-03 3 1  ON 56
ci_58                -1.033237e-03 3 1  ON 57
ci_59                -1.452266e-03 3 1  ON 58
ci_60                 4.407533e-04 3 1  ON 59
ci_61                -1.671875e-04 3 1  ON 60
ci_62                -6.379544e-04 3 1  ON 61
ci_63                -7.914882e-04 3 1  ON 62
ci_64                -3.185815e-04 3 1  ON 63
ci_65                 9.705765e-05 3 1  ON 64
ci_66                -7.538792e-04 3 1  ON 65
ci_67                -8.451080e-04 3 1  ON 66
ci_68                -1.274644e-03 3 1  ON 67
ci_69                 2.790507e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8104
    reference variance = 0.391054
====================================================
  Execution time = 4.2782e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4829e-01
  Total weights = 1.9643e+06
  Execution time = 5.9804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433967166525
                                         uncertainty =       0.003197210457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433967166525
                                         uncertainty =       0.003197210457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465781198
  error estimate for blocks of size 2^( 2) =       0.000491153258
  error estimate for blocks of size 2^( 3) =       0.000514672466
  error estimate for blocks of size 2^( 4) =       0.000532621610
  error estimate for blocks of size 2^( 5) =       0.000543557935
  error estimate for blocks of size 2^( 6) =       0.000550120040
  error estimate for blocks of size 2^( 7) =       0.000553021570

      target function =      -0.746807666057
              le_mean =     -22.813450176110
             les_mean =     520.901701909618
             stat err =       0.000544830289
             autocorr =       1.368228335631
   target nu stat err =       0.000544830289
   target dn stat err =       0.005044883670
      target stat err =       0.004210703722
              std dev =       0.658714086603
             le_variance =       0.433904247889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433994635748
                                         uncertainty =       0.003146292564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433994635748
                                         uncertainty =       0.003146292564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465795910
  error estimate for blocks of size 2^( 2) =       0.000491185684
  error estimate for blocks of size 2^( 3) =       0.000514719797
  error estimate for blocks of size 2^( 4) =       0.000532676021
  error estimate for blocks of size 2^( 5) =       0.000543618002
  error estimate for blocks of size 2^( 6) =       0.000550179453
  error estimate for blocks of size 2^( 7) =       0.000553106279

      target function =      -0.743564255327
              le_mean =     -22.813456340296
             les_mean =     520.905922972456
             stat err =       0.000544894939
             autocorr =       1.368466611597
   target nu stat err =       0.000544894939
   target dn stat err =       0.005389181265
      target stat err =       0.004453851710
              std dev =       0.658734893673
             le_variance =       0.433931660143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433955677872
                                         uncertainty =       0.003167242719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433955677872
                                         uncertainty =       0.003167242719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465775010
  error estimate for blocks of size 2^( 2) =       0.000491158064
  error estimate for blocks of size 2^( 3) =       0.000514686056
  error estimate for blocks of size 2^( 4) =       0.000532639535
  error estimate for blocks of size 2^( 5) =       0.000543578073
  error estimate for blocks of size 2^( 6) =       0.000550136126
  error estimate for blocks of size 2^( 7) =       0.000553041979

      target function =      -0.746204680210
              le_mean =     -22.813450895848
             les_mean =     520.902464994121
             stat err =       0.000544848928
             autocorr =       1.368358308520
   target nu stat err =       0.000544848928
   target dn stat err =       0.005076038313
      target stat err =       0.004229415960
              std dev =       0.658705336761
             le_variance =       0.433892720677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433962547059
                                         uncertainty =       0.003193253214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433962547059
                                         uncertainty =       0.003193253214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465778716
  error estimate for blocks of size 2^( 2) =       0.000491152259
  error estimate for blocks of size 2^( 3) =       0.000514672502
  error estimate for blocks of size 2^( 4) =       0.000532622342
  error estimate for blocks of size 2^( 5) =       0.000543558749
  error estimate for blocks of size 2^( 6) =       0.000550120170
  error estimate for blocks of size 2^( 7) =       0.000553021900

      target function =      -0.746737664346
              le_mean =     -22.813449832141
             les_mean =     520.901770964829
             stat err =       0.000544830790
             autocorr =       1.368245435017
   target nu stat err =       0.000544830790
   target dn stat err =       0.005045032085
      target stat err =       0.004210041699
              std dev =       0.658710577038
             le_variance =       0.433899624302


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746807666057        initial  <--
     1.5625e-01     1.5625e+00             9.1846e-04        -0.743564255327
     6.2500e-01     6.2500e+00             2.5426e-04        -0.746204680210
     2.5000e+00     2.5000e+01             6.5254e-05        -0.746737664346

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.8090
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.273581e-01 3 1  ON 0
ci_02                -2.892718e-02 3 1  ON 1
ci_03                -2.902845e-02 3 1  ON 2
ci_04                 2.695408e-02 3 1  ON 3
ci_05                -2.210389e-02 3 1  ON 4
ci_06                -2.180572e-02 3 1  ON 5
ci_07                 2.742170e-02 3 1  ON 6
ci_08                -5.582346e-03 3 1  ON 7
ci_09                -9.108279e-03 3 1  ON 8
ci_10                -8.363804e-03 3 1  ON 9
ci_11                 1.321618e-02 3 1  ON 10
ci_12                 6.962869e-03 3 1  ON 11
ci_13                 1.284047e-02 3 1  ON 12
ci_14                 1.271164e-02 3 1  ON 13
ci_15                 6.273791e-03 3 1  ON 14
ci_16                 6.440988e-03 3 1  ON 15
ci_17                -7.269576e-03 3 1  ON 16
ci_18                -5.943572e-03 3 1  ON 17
ci_19                 9.296245e-03 3 1  ON 18
ci_20                 6.403130e-03 3 1  ON 19
ci_21                 9.001014e-03 3 1  ON 20
ci_22                 8.255863e-03 3 1  ON 21
ci_23                 4.754851e-03 3 1  ON 22
ci_24                 3.981914e-03 3 1  ON 23
ci_25                 2.851480e-03 3 1  ON 24
ci_26                 3.143507e-03 3 1  ON 25
ci_27                 3.337819e-03 3 1  ON 26
ci_28                 1.907681e-03 3 1  ON 27
ci_29                 1.307098e-03 3 1  ON 28
ci_30                -1.854224e-03 3 1  ON 29
ci_31                -5.563977e-04 3 1  ON 30
ci_32                -8.376743e-04 3 1  ON 31
ci_33                -1.481324e-03 3 1  ON 32
ci_34                 1.136463e-03 3 1  ON 33
ci_35                 1.466298e-03 3 1  ON 34
ci_36                -1.016692e-03 3 1  ON 35
ci_37                -1.037207e-03 3 1  ON 36
ci_38                -7.736995e-04 3 1  ON 37
ci_39                -6.314622e-04 3 1  ON 38
ci_40                -1.563970e-03 3 1  ON 39
ci_41                -1.249483e-03 3 1  ON 40
ci_42                -1.160125e-03 3 1  ON 41
ci_43                -2.486561e-03 3 1  ON 42
ci_44                -3.305933e-03 3 1  ON 43
ci_45                -5.304739e-04 3 1  ON 44
ci_46                -8.882964e-04 3 1  ON 45
ci_47                 1.528877e-03 3 1  ON 46
ci_48                 1.373853e-03 3 1  ON 47
ci_49                -1.047308e-03 3 1  ON 48
ci_50                -8.067761e-04 3 1  ON 49
ci_51                 1.430596e-04 3 1  ON 50
ci_52                 7.378396e-05 3 1  ON 51
ci_53                -6.280182e-04 3 1  ON 52
ci_54                -1.037657e-03 3 1  ON 53
ci_55                -6.515569e-04 3 1  ON 54
ci_56                 2.641668e-03 3 1  ON 55
ci_57                 1.605578e-03 3 1  ON 56
ci_58                -1.127171e-03 3 1  ON 57
ci_59                -1.476633e-03 3 1  ON 58
ci_60                 5.503947e-04 3 1  ON 59
ci_61                -1.254064e-04 3 1  ON 60
ci_62                -6.746269e-04 3 1  ON 61
ci_63                -7.870553e-04 3 1  ON 62
ci_64                -2.751526e-04 3 1  ON 63
ci_65                 6.695548e-05 3 1  ON 64
ci_66                -7.230186e-04 3 1  ON 65
ci_67                -8.948207e-04 3 1  ON 66
ci_68                -1.385319e-03 3 1  ON 67
ci_69                 1.625343e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2620e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7581
    reference variance = 0.259398
====================================================
  Execution time = 4.5160e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4782e-01
  Total weights = 1.964209102e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435653463855
                                         uncertainty =       0.002467889516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435653463855
                                         uncertainty =       0.002467889516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466729309
  error estimate for blocks of size 2^( 2) =       0.000492323669
  error estimate for blocks of size 2^( 3) =       0.000516145529
  error estimate for blocks of size 2^( 4) =       0.000533897072
  error estimate for blocks of size 2^( 5) =       0.000544485754
  error estimate for blocks of size 2^( 6) =       0.000551068984
  error estimate for blocks of size 2^( 7) =       0.000554845072

      target function =      -0.747125752303
              le_mean =     -22.813564085791
             les_mean =     520.906531234405
             stat err =       0.000546074220
             autocorr =       1.368904658666
   target nu stat err =       0.000546074220
   target dn stat err =       0.003333737309
      target stat err =       0.002822091205
              std dev =       0.660054918262
             le_variance =       0.435672495122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281356408579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747135365963       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747145115728       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747146072390       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747146254332       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747146324681       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747146327592       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747146316009       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747146317308       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747146317500       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.344829e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747135365963       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747137860771       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747138102783       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747138148178       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747138165573       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747138166085       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747138163261       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747138163584       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747138163610       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.402364e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747135365963       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747135993356       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747136054038       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747136065380       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747136069716       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747136069830       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747136069129       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747136069210       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 8.528055e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2885e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.273240e-01 3 1  ON 0
ci_02                -2.890453e-02 3 1  ON 1
ci_03                -2.901738e-02 3 1  ON 2
ci_04                 2.692919e-02 3 1  ON 3
ci_05                -2.209395e-02 3 1  ON 4
ci_06                -2.182124e-02 3 1  ON 5
ci_07                 2.741684e-02 3 1  ON 6
ci_08                -5.580220e-03 3 1  ON 7
ci_09                -9.086895e-03 3 1  ON 8
ci_10                -8.366417e-03 3 1  ON 9
ci_11                 1.321547e-02 3 1  ON 10
ci_12                 6.951630e-03 3 1  ON 11
ci_13                 1.284117e-02 3 1  ON 12
ci_14                 1.271893e-02 3 1  ON 13
ci_15                 6.272289e-03 3 1  ON 14
ci_16                 6.439095e-03 3 1  ON 15
ci_17                -7.267211e-03 3 1  ON 16
ci_18                -5.947188e-03 3 1  ON 17
ci_19                 9.298221e-03 3 1  ON 18
ci_20                 6.401668e-03 3 1  ON 19
ci_21                 9.002921e-03 3 1  ON 20
ci_22                 8.256340e-03 3 1  ON 21
ci_23                 4.761217e-03 3 1  ON 22
ci_24                 3.982073e-03 3 1  ON 23
ci_25                 2.847005e-03 3 1  ON 24
ci_26                 3.144428e-03 3 1  ON 25
ci_27                 3.332329e-03 3 1  ON 26
ci_28                 1.904527e-03 3 1  ON 27
ci_29                 1.301245e-03 3 1  ON 28
ci_30                -1.847472e-03 3 1  ON 29
ci_31                -5.586432e-04 3 1  ON 30
ci_32                -8.338311e-04 3 1  ON 31
ci_33                -1.475255e-03 3 1  ON 32
ci_34                 1.131044e-03 3 1  ON 33
ci_35                 1.460210e-03 3 1  ON 34
ci_36                -1.020712e-03 3 1  ON 35
ci_37                -1.037255e-03 3 1  ON 36
ci_38                -7.714634e-04 3 1  ON 37
ci_39                -6.270426e-04 3 1  ON 38
ci_40                -1.568300e-03 3 1  ON 39
ci_41                -1.256541e-03 3 1  ON 40
ci_42                -1.166457e-03 3 1  ON 41
ci_43                -2.487802e-03 3 1  ON 42
ci_44                -3.279465e-03 3 1  ON 43
ci_45                -5.333474e-04 3 1  ON 44
ci_46                -8.819176e-04 3 1  ON 45
ci_47                 1.534101e-03 3 1  ON 46
ci_48                 1.374360e-03 3 1  ON 47
ci_49                -1.046814e-03 3 1  ON 48
ci_50                -8.062861e-04 3 1  ON 49
ci_51                 1.432506e-04 3 1  ON 50
ci_52                 8.098199e-05 3 1  ON 51
ci_53                -6.287344e-04 3 1  ON 52
ci_54                -1.034910e-03 3 1  ON 53
ci_55                -6.511030e-04 3 1  ON 54
ci_56                 2.636904e-03 3 1  ON 55
ci_57                 1.608791e-03 3 1  ON 56
ci_58                -1.123677e-03 3 1  ON 57
ci_59                -1.472586e-03 3 1  ON 58
ci_60                 5.510391e-04 3 1  ON 59
ci_61                -1.373911e-04 3 1  ON 60
ci_62                -6.691137e-04 3 1  ON 61
ci_63                -7.777428e-04 3 1  ON 62
ci_64                -2.747494e-04 3 1  ON 63
ci_65                 7.134304e-05 3 1  ON 64
ci_66                -7.191720e-04 3 1  ON 65
ci_67                -8.969824e-04 3 1  ON 66
ci_68                -1.386112e-03 3 1  ON 67
ci_69                 1.567619e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.787
    reference variance = 0.31381
====================================================
  Execution time = 4.3134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5159e-01
  Total weights = 1.9641e+06
  Execution time = 5.9774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435352328602
                                         uncertainty =       0.002114088056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435352328602
                                         uncertainty =       0.002114088056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466516659
  error estimate for blocks of size 2^( 2) =       0.000492204735
  error estimate for blocks of size 2^( 3) =       0.000516146489
  error estimate for blocks of size 2^( 4) =       0.000534278544
  error estimate for blocks of size 2^( 5) =       0.000545283830
  error estimate for blocks of size 2^( 6) =       0.000550136401
  error estimate for blocks of size 2^( 7) =       0.000552087044

      target function =      -0.743774853065
              le_mean =     -22.814939831766
             les_mean =     520.973381694486
             stat err =       0.000545446455
             autocorr =       1.367004463123
   target nu stat err =       0.000545446455
   target dn stat err =       0.003238736092
      target stat err =       0.002726836484
              std dev =       0.659754186912
             le_variance =       0.435275587148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435331807887
                                         uncertainty =       0.002113402989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435331807887
                                         uncertainty =       0.002113402989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466505685
  error estimate for blocks of size 2^( 2) =       0.000492199034
  error estimate for blocks of size 2^( 3) =       0.000516146465
  error estimate for blocks of size 2^( 4) =       0.000534283200
  error estimate for blocks of size 2^( 5) =       0.000545292858
  error estimate for blocks of size 2^( 6) =       0.000550146456
  error estimate for blocks of size 2^( 7) =       0.000552099488

      target function =      -0.744050813291
              le_mean =     -22.814938971136
             les_mean =     520.973006548466
             stat err =       0.000545455501
             autocorr =       1.367114124197
   target nu stat err =       0.000545455501
   target dn stat err =       0.003227591853
      target stat err =       0.002719878245
              std dev =       0.659738666813
             le_variance =       0.435255108488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341662564
                                         uncertainty =       0.002113733621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341662564
                                         uncertainty =       0.002113733621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466510955
  error estimate for blocks of size 2^( 2) =       0.000492201707
  error estimate for blocks of size 2^( 3) =       0.000516146330
  error estimate for blocks of size 2^( 4) =       0.000534280758
  error estimate for blocks of size 2^( 5) =       0.000545288266
  error estimate for blocks of size 2^( 6) =       0.000550141352
  error estimate for blocks of size 2^( 7) =       0.000552093150

      target function =      -0.744051006911
              le_mean =     -22.814939349626
             les_mean =     520.973023597386
             stat err =       0.000545450882
             autocorr =       1.367060083272
   target nu stat err =       0.000545450882
   target dn stat err =       0.003225717187
      target stat err =       0.002718377732
              std dev =       0.659746119810
             le_variance =       0.435264942604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435350963446
                                         uncertainty =       0.002114042778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435350963446
                                         uncertainty =       0.002114042778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466515929
  error estimate for blocks of size 2^( 2) =       0.000492204336
  error estimate for blocks of size 2^( 3) =       0.000516146447
  error estimate for blocks of size 2^( 4) =       0.000534278797
  error estimate for blocks of size 2^( 5) =       0.000545284357
  error estimate for blocks of size 2^( 6) =       0.000550136986
  error estimate for blocks of size 2^( 7) =       0.000552087732

      target function =      -0.744007757825
              le_mean =     -22.814939762343
             les_mean =     520.973095066782
             stat err =       0.000545446968
             autocorr =       1.367011314334
   target nu stat err =       0.000545446968
   target dn stat err =       0.003225441037
      target stat err =       0.002717848917
              std dev =       0.659753154380
             le_variance =       0.435274224714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743774853065        initial
     1.5625e+00     1.5625e+01             1.3448e-04        -0.744050813291
     6.2500e+00     6.2500e+01             3.4024e-05        -0.744051006911  <--
     2.5000e+01     2.5000e+02             8.5281e-06        -0.744007757825

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 7.3160e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.273240e-01 3 1  ON 0
ci_02                -2.890453e-02 3 1  ON 1
ci_03                -2.901738e-02 3 1  ON 2
ci_04                 2.692919e-02 3 1  ON 3
ci_05                -2.209395e-02 3 1  ON 4
ci_06                -2.182124e-02 3 1  ON 5
ci_07                 2.741684e-02 3 1  ON 6
ci_08                -5.580220e-03 3 1  ON 7
ci_09                -9.086895e-03 3 1  ON 8
ci_10                -8.366417e-03 3 1  ON 9
ci_11                 1.321547e-02 3 1  ON 10
ci_12                 6.951630e-03 3 1  ON 11
ci_13                 1.284117e-02 3 1  ON 12
ci_14                 1.271893e-02 3 1  ON 13
ci_15                 6.272289e-03 3 1  ON 14
ci_16                 6.439095e-03 3 1  ON 15
ci_17                -7.267211e-03 3 1  ON 16
ci_18                -5.947188e-03 3 1  ON 17
ci_19                 9.298221e-03 3 1  ON 18
ci_20                 6.401668e-03 3 1  ON 19
ci_21                 9.002921e-03 3 1  ON 20
ci_22                 8.256340e-03 3 1  ON 21
ci_23                 4.761217e-03 3 1  ON 22
ci_24                 3.982073e-03 3 1  ON 23
ci_25                 2.847005e-03 3 1  ON 24
ci_26                 3.144428e-03 3 1  ON 25
ci_27                 3.332329e-03 3 1  ON 26
ci_28                 1.904527e-03 3 1  ON 27
ci_29                 1.301245e-03 3 1  ON 28
ci_30                -1.847472e-03 3 1  ON 29
ci_31                -5.586432e-04 3 1  ON 30
ci_32                -8.338311e-04 3 1  ON 31
ci_33                -1.475255e-03 3 1  ON 32
ci_34                 1.131044e-03 3 1  ON 33
ci_35                 1.460210e-03 3 1  ON 34
ci_36                -1.020712e-03 3 1  ON 35
ci_37                -1.037255e-03 3 1  ON 36
ci_38                -7.714634e-04 3 1  ON 37
ci_39                -6.270426e-04 3 1  ON 38
ci_40                -1.568300e-03 3 1  ON 39
ci_41                -1.256541e-03 3 1  ON 40
ci_42                -1.166457e-03 3 1  ON 41
ci_43                -2.487802e-03 3 1  ON 42
ci_44                -3.279465e-03 3 1  ON 43
ci_45                -5.333474e-04 3 1  ON 44
ci_46                -8.819176e-04 3 1  ON 45
ci_47                 1.534101e-03 3 1  ON 46
ci_48                 1.374360e-03 3 1  ON 47
ci_49                -1.046814e-03 3 1  ON 48
ci_50                -8.062861e-04 3 1  ON 49
ci_51                 1.432506e-04 3 1  ON 50
ci_52                 8.098199e-05 3 1  ON 51
ci_53                -6.287344e-04 3 1  ON 52
ci_54                -1.034910e-03 3 1  ON 53
ci_55                -6.511030e-04 3 1  ON 54
ci_56                 2.636904e-03 3 1  ON 55
ci_57                 1.608791e-03 3 1  ON 56
ci_58                -1.123677e-03 3 1  ON 57
ci_59                -1.472586e-03 3 1  ON 58
ci_60                 5.510391e-04 3 1  ON 59
ci_61                -1.373911e-04 3 1  ON 60
ci_62                -6.691137e-04 3 1  ON 61
ci_63                -7.777428e-04 3 1  ON 62
ci_64                -2.747494e-04 3 1  ON 63
ci_65                 7.134304e-05 3 1  ON 64
ci_66                -7.191720e-04 3 1  ON 65
ci_67                -8.969824e-04 3 1  ON 66
ci_68                -1.386112e-03 3 1  ON 67
ci_69                 1.567619e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2608e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8848
    reference variance = 0.336975
====================================================
  Execution time = 4.4046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4869e-01
  Total weights = 1.964477867e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434529353027
                                         uncertainty =       0.002132107928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434529353027
                                         uncertainty =       0.002132107928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466105142
  error estimate for blocks of size 2^( 2) =       0.000491827523
  error estimate for blocks of size 2^( 3) =       0.000515551160
  error estimate for blocks of size 2^( 4) =       0.000533831790
  error estimate for blocks of size 2^( 5) =       0.000544430026
  error estimate for blocks of size 2^( 6) =       0.000550393491
  error estimate for blocks of size 2^( 7) =       0.000552104089

      target function =      -0.746424500572
              le_mean =     -22.814968046723
             les_mean =     520.971454005251
             stat err =       0.000545189849
             autocorr =       1.368131155708
   target nu stat err =       0.000545189849
   target dn stat err =       0.003246594510
      target stat err =       0.002752217952
              std dev =       0.659172213861
             le_variance =       0.434508007526


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281496804672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746433644468       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746443949006       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746445138598       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746445381319       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746445530213       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746445515821       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746445537987       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746445536588       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746445537658       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 8.875921e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746433644468       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746436281411       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746436582778       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746436643801       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746436681044       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746436677252       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746436682714       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746436682349       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746436682612       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.264478e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746433644468       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746434307617       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746434383209       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746434398485       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746434407796       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746434406836       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746434408196       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746434408104       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746434408170       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 5.690363e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.5296e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.273171e-01 3 1  ON 0
ci_02                -2.888240e-02 3 1  ON 1
ci_03                -2.899779e-02 3 1  ON 2
ci_04                 2.691897e-02 3 1  ON 3
ci_05                -2.208396e-02 3 1  ON 4
ci_06                -2.179860e-02 3 1  ON 5
ci_07                 2.740135e-02 3 1  ON 6
ci_08                -5.571497e-03 3 1  ON 7
ci_09                -9.071451e-03 3 1  ON 8
ci_10                -8.356350e-03 3 1  ON 9
ci_11                 1.321588e-02 3 1  ON 10
ci_12                 6.947075e-03 3 1  ON 11
ci_13                 1.283444e-02 3 1  ON 12
ci_14                 1.270755e-02 3 1  ON 13
ci_15                 6.273771e-03 3 1  ON 14
ci_16                 6.431771e-03 3 1  ON 15
ci_17                -7.256524e-03 3 1  ON 16
ci_18                -5.949263e-03 3 1  ON 17
ci_19                 9.299044e-03 3 1  ON 18
ci_20                 6.397828e-03 3 1  ON 19
ci_21                 9.000870e-03 3 1  ON 20
ci_22                 8.260916e-03 3 1  ON 21
ci_23                 4.757530e-03 3 1  ON 22
ci_24                 3.981248e-03 3 1  ON 23
ci_25                 2.845311e-03 3 1  ON 24
ci_26                 3.145508e-03 3 1  ON 25
ci_27                 3.328083e-03 3 1  ON 26
ci_28                 1.923492e-03 3 1  ON 27
ci_29                 1.300931e-03 3 1  ON 28
ci_30                -1.841344e-03 3 1  ON 29
ci_31                -5.572525e-04 3 1  ON 30
ci_32                -8.443063e-04 3 1  ON 31
ci_33                -1.479475e-03 3 1  ON 32
ci_34                 1.136517e-03 3 1  ON 33
ci_35                 1.472516e-03 3 1  ON 34
ci_36                -1.019761e-03 3 1  ON 35
ci_37                -1.033222e-03 3 1  ON 36
ci_38                -7.715789e-04 3 1  ON 37
ci_39                -6.258564e-04 3 1  ON 38
ci_40                -1.570234e-03 3 1  ON 39
ci_41                -1.249087e-03 3 1  ON 40
ci_42                -1.169829e-03 3 1  ON 41
ci_43                -2.486721e-03 3 1  ON 42
ci_44                -3.263599e-03 3 1  ON 43
ci_45                -5.323321e-04 3 1  ON 44
ci_46                -8.756269e-04 3 1  ON 45
ci_47                 1.539456e-03 3 1  ON 46
ci_48                 1.375810e-03 3 1  ON 47
ci_49                -1.048221e-03 3 1  ON 48
ci_50                -8.113775e-04 3 1  ON 49
ci_51                 1.481497e-04 3 1  ON 50
ci_52                 8.386596e-05 3 1  ON 51
ci_53                -6.340107e-04 3 1  ON 52
ci_54                -1.030356e-03 3 1  ON 53
ci_55                -6.525485e-04 3 1  ON 54
ci_56                 2.632669e-03 3 1  ON 55
ci_57                 1.618145e-03 3 1  ON 56
ci_58                -1.118028e-03 3 1  ON 57
ci_59                -1.475964e-03 3 1  ON 58
ci_60                 5.427518e-04 3 1  ON 59
ci_61                -1.246278e-04 3 1  ON 60
ci_62                -6.668997e-04 3 1  ON 61
ci_63                -7.741006e-04 3 1  ON 62
ci_64                -2.628892e-04 3 1  ON 63
ci_65                 6.551620e-05 3 1  ON 64
ci_66                -7.157980e-04 3 1  ON 65
ci_67                -9.019391e-04 3 1  ON 66
ci_68                -1.382071e-03 3 1  ON 67
ci_69                 1.445443e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8196
    reference variance = 0.448643
====================================================
  Execution time = 4.3234e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4424e-01
  Total weights = 1.9641e+06
  Execution time = 5.9966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432380949443
                                         uncertainty =       0.002069307705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432380949443
                                         uncertainty =       0.002069307705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464963543
  error estimate for blocks of size 2^( 2) =       0.000490710361
  error estimate for blocks of size 2^( 3) =       0.000514523803
  error estimate for blocks of size 2^( 4) =       0.000532237578
  error estimate for blocks of size 2^( 5) =       0.000543495037
  error estimate for blocks of size 2^( 6) =       0.000549183745
  error estimate for blocks of size 2^( 7) =       0.000553095885

      target function =      -0.750106648693
              le_mean =     -22.814316061695
             les_mean =     520.937268308501
             stat err =       0.000544503061
             autocorr =       1.371395904012
   target nu stat err =       0.000544503061
   target dn stat err =       0.002635288654
      target stat err =       0.002280838959
              std dev =       0.657557748339
             le_variance =       0.432382192401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432369593438
                                         uncertainty =       0.002068284710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432369593438
                                         uncertainty =       0.002068284710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464957427
  error estimate for blocks of size 2^( 2) =       0.000490709165
  error estimate for blocks of size 2^( 3) =       0.000514527338
  error estimate for blocks of size 2^( 4) =       0.000532244721
  error estimate for blocks of size 2^( 5) =       0.000543503958
  error estimate for blocks of size 2^( 6) =       0.000549194405
  error estimate for blocks of size 2^( 7) =       0.000553107864

      target function =      -0.750038391626
              le_mean =     -22.814316431985
             les_mean =     520.937367016678
             stat err =       0.000544512737
             autocorr =       1.371480724180
   target nu stat err =       0.000544512737
   target dn stat err =       0.002636164203
      target stat err =       0.002281146854
              std dev =       0.657549098725
             le_variance =       0.432370817234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374960884
                                         uncertainty =       0.002068780161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374960884
                                         uncertainty =       0.002068780161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464960318
  error estimate for blocks of size 2^( 2) =       0.000490709642
  error estimate for blocks of size 2^( 3) =       0.000514525493
  error estimate for blocks of size 2^( 4) =       0.000532241082
  error estimate for blocks of size 2^( 5) =       0.000543499454
  error estimate for blocks of size 2^( 6) =       0.000549189036
  error estimate for blocks of size 2^( 7) =       0.000553101841

      target function =      -0.750117149667
              le_mean =     -22.814316230513
             les_mean =     520.937263431815
             stat err =       0.000544507853
             autocorr =       1.371439068080
   target nu stat err =       0.000544507853
   target dn stat err =       0.002634928428
      target stat err =       0.002280612755
              std dev =       0.657553187421
             le_variance =       0.432376194288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432380174624
                                         uncertainty =       0.002069240900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432380174624
                                         uncertainty =       0.002069240900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464963126
  error estimate for blocks of size 2^( 2) =       0.000490710259
  error estimate for blocks of size 2^( 3) =       0.000514524004
  error estimate for blocks of size 2^( 4) =       0.000532238006
  error estimate for blocks of size 2^( 5) =       0.000543495580
  error estimate for blocks of size 2^( 6) =       0.000549184398
  error estimate for blocks of size 2^( 7) =       0.000553096621

      target function =      -0.750110068514
              le_mean =     -22.814316079689
             les_mean =     520.937265031733
             stat err =       0.000544503651
             autocorr =       1.371401336217
   target nu stat err =       0.000544503651
   target dn stat err =       0.002635230865
      target stat err =       0.002280812767
              std dev =       0.657557158276
             le_variance =       0.432381416399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750106648693        initial
     1.5625e+00     1.5625e+01             8.8759e-05        -0.750038391626
     6.2500e+00     6.2500e+01             2.2645e-05        -0.750117149667  <--
     2.5000e+01     2.5000e+02             5.6904e-06        -0.750110068514

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 7.3332e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.273171e-01 3 1  ON 0
ci_02                -2.888240e-02 3 1  ON 1
ci_03                -2.899779e-02 3 1  ON 2
ci_04                 2.691897e-02 3 1  ON 3
ci_05                -2.208396e-02 3 1  ON 4
ci_06                -2.179860e-02 3 1  ON 5
ci_07                 2.740135e-02 3 1  ON 6
ci_08                -5.571497e-03 3 1  ON 7
ci_09                -9.071451e-03 3 1  ON 8
ci_10                -8.356350e-03 3 1  ON 9
ci_11                 1.321588e-02 3 1  ON 10
ci_12                 6.947075e-03 3 1  ON 11
ci_13                 1.283444e-02 3 1  ON 12
ci_14                 1.270755e-02 3 1  ON 13
ci_15                 6.273771e-03 3 1  ON 14
ci_16                 6.431771e-03 3 1  ON 15
ci_17                -7.256524e-03 3 1  ON 16
ci_18                -5.949263e-03 3 1  ON 17
ci_19                 9.299044e-03 3 1  ON 18
ci_20                 6.397828e-03 3 1  ON 19
ci_21                 9.000870e-03 3 1  ON 20
ci_22                 8.260916e-03 3 1  ON 21
ci_23                 4.757530e-03 3 1  ON 22
ci_24                 3.981248e-03 3 1  ON 23
ci_25                 2.845311e-03 3 1  ON 24
ci_26                 3.145508e-03 3 1  ON 25
ci_27                 3.328083e-03 3 1  ON 26
ci_28                 1.923492e-03 3 1  ON 27
ci_29                 1.300931e-03 3 1  ON 28
ci_30                -1.841344e-03 3 1  ON 29
ci_31                -5.572525e-04 3 1  ON 30
ci_32                -8.443063e-04 3 1  ON 31
ci_33                -1.479475e-03 3 1  ON 32
ci_34                 1.136517e-03 3 1  ON 33
ci_35                 1.472516e-03 3 1  ON 34
ci_36                -1.019761e-03 3 1  ON 35
ci_37                -1.033222e-03 3 1  ON 36
ci_38                -7.715789e-04 3 1  ON 37
ci_39                -6.258564e-04 3 1  ON 38
ci_40                -1.570234e-03 3 1  ON 39
ci_41                -1.249087e-03 3 1  ON 40
ci_42                -1.169829e-03 3 1  ON 41
ci_43                -2.486721e-03 3 1  ON 42
ci_44                -3.263599e-03 3 1  ON 43
ci_45                -5.323321e-04 3 1  ON 44
ci_46                -8.756269e-04 3 1  ON 45
ci_47                 1.539456e-03 3 1  ON 46
ci_48                 1.375810e-03 3 1  ON 47
ci_49                -1.048221e-03 3 1  ON 48
ci_50                -8.113775e-04 3 1  ON 49
ci_51                 1.481497e-04 3 1  ON 50
ci_52                 8.386596e-05 3 1  ON 51
ci_53                -6.340107e-04 3 1  ON 52
ci_54                -1.030356e-03 3 1  ON 53
ci_55                -6.525485e-04 3 1  ON 54
ci_56                 2.632669e-03 3 1  ON 55
ci_57                 1.618145e-03 3 1  ON 56
ci_58                -1.118028e-03 3 1  ON 57
ci_59                -1.475964e-03 3 1  ON 58
ci_60                 5.427518e-04 3 1  ON 59
ci_61                -1.246278e-04 3 1  ON 60
ci_62                -6.668997e-04 3 1  ON 61
ci_63                -7.741006e-04 3 1  ON 62
ci_64                -2.628892e-04 3 1  ON 63
ci_65                 6.551620e-05 3 1  ON 64
ci_66                -7.157980e-04 3 1  ON 65
ci_67                -9.019391e-04 3 1  ON 66
ci_68                -1.382071e-03 3 1  ON 67
ci_69                 1.445443e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2868e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7376
    reference variance = 0.395586
====================================================
  Execution time = 4.4004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4797e-01
  Total weights = 1.964161700e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437545637823
                                         uncertainty =       0.003258387876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437545637823
                                         uncertainty =       0.003258387876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467724119
  error estimate for blocks of size 2^( 2) =       0.000493005954
  error estimate for blocks of size 2^( 3) =       0.000516610839
  error estimate for blocks of size 2^( 4) =       0.000534588374
  error estimate for blocks of size 2^( 5) =       0.000545798380
  error estimate for blocks of size 2^( 6) =       0.000554036665
  error estimate for blocks of size 2^( 7) =       0.000558196591

      target function =      -0.747013007975
              le_mean =     -22.814609209405
             les_mean =     520.954366823924
             stat err =       0.000548155002
             autocorr =       1.373495474567
   target nu stat err =       0.000548155002
   target dn stat err =       0.003131816095
      target stat err =       0.002663101603
              std dev =       0.661461792024
             le_variance =       0.437531702308


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281460920940e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747021607419       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747027463945       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747028309270       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747028485695       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747028603276       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747028617964       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747028612482       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747028606639       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747028607506       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.544306e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747021607419       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747023106541       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747023320280       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747023364398       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747023393617       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747023396865       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747023395545       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747023394113       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747023394326       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.905895e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747021607419       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747021984453       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747022038038       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747022049068       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747022056360       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747022057145       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747022056819       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747022056462       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747022056515       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 9.793370e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1706e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.272781e-01 3 1  ON 0
ci_02                -2.888299e-02 3 1  ON 1
ci_03                -2.899457e-02 3 1  ON 2
ci_04                 2.691069e-02 3 1  ON 3
ci_05                -2.208542e-02 3 1  ON 4
ci_06                -2.178654e-02 3 1  ON 5
ci_07                 2.739226e-02 3 1  ON 6
ci_08                -5.570561e-03 3 1  ON 7
ci_09                -9.067375e-03 3 1  ON 8
ci_10                -8.354406e-03 3 1  ON 9
ci_11                 1.321570e-02 3 1  ON 10
ci_12                 6.952202e-03 3 1  ON 11
ci_13                 1.283324e-02 3 1  ON 12
ci_14                 1.271605e-02 3 1  ON 13
ci_15                 6.266949e-03 3 1  ON 14
ci_16                 6.423600e-03 3 1  ON 15
ci_17                -7.242655e-03 3 1  ON 16
ci_18                -5.936717e-03 3 1  ON 17
ci_19                 9.307864e-03 3 1  ON 18
ci_20                 6.399498e-03 3 1  ON 19
ci_21                 8.998351e-03 3 1  ON 20
ci_22                 8.266779e-03 3 1  ON 21
ci_23                 4.758123e-03 3 1  ON 22
ci_24                 3.987225e-03 3 1  ON 23
ci_25                 2.848047e-03 3 1  ON 24
ci_26                 3.150381e-03 3 1  ON 25
ci_27                 3.330045e-03 3 1  ON 26
ci_28                 1.925011e-03 3 1  ON 27
ci_29                 1.298919e-03 3 1  ON 28
ci_30                -1.838221e-03 3 1  ON 29
ci_31                -5.580778e-04 3 1  ON 30
ci_32                -8.432602e-04 3 1  ON 31
ci_33                -1.472717e-03 3 1  ON 32
ci_34                 1.125927e-03 3 1  ON 33
ci_35                 1.463344e-03 3 1  ON 34
ci_36                -1.016099e-03 3 1  ON 35
ci_37                -1.026307e-03 3 1  ON 36
ci_38                -7.709559e-04 3 1  ON 37
ci_39                -6.243638e-04 3 1  ON 38
ci_40                -1.575089e-03 3 1  ON 39
ci_41                -1.253056e-03 3 1  ON 40
ci_42                -1.159138e-03 3 1  ON 41
ci_43                -2.481182e-03 3 1  ON 42
ci_44                -3.256424e-03 3 1  ON 43
ci_45                -5.344756e-04 3 1  ON 44
ci_46                -8.755950e-04 3 1  ON 45
ci_47                 1.544588e-03 3 1  ON 46
ci_48                 1.377513e-03 3 1  ON 47
ci_49                -1.051395e-03 3 1  ON 48
ci_50                -8.067422e-04 3 1  ON 49
ci_51                 1.448596e-04 3 1  ON 50
ci_52                 9.006565e-05 3 1  ON 51
ci_53                -6.374201e-04 3 1  ON 52
ci_54                -1.027095e-03 3 1  ON 53
ci_55                -6.592299e-04 3 1  ON 54
ci_56                 2.622904e-03 3 1  ON 55
ci_57                 1.612696e-03 3 1  ON 56
ci_58                -1.114185e-03 3 1  ON 57
ci_59                -1.471197e-03 3 1  ON 58
ci_60                 5.324290e-04 3 1  ON 59
ci_61                -1.249058e-04 3 1  ON 60
ci_62                -6.599774e-04 3 1  ON 61
ci_63                -7.701192e-04 3 1  ON 62
ci_64                -2.688300e-04 3 1  ON 63
ci_65                 5.652165e-05 3 1  ON 64
ci_66                -7.132428e-04 3 1  ON 65
ci_67                -9.009401e-04 3 1  ON 66
ci_68                -1.383677e-03 3 1  ON 67
ci_69                 1.375321e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7968
    reference variance = 0.245661
====================================================
  Execution time = 4.5109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5017e-01
  Total weights = 1.9643e+06
  Execution time = 5.9701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436252743047
                                         uncertainty =       0.001972083556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436252743047
                                         uncertainty =       0.001972083556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467019874
  error estimate for blocks of size 2^( 2) =       0.000492401214
  error estimate for blocks of size 2^( 3) =       0.000516024467
  error estimate for blocks of size 2^( 4) =       0.000534346397
  error estimate for blocks of size 2^( 5) =       0.000544523833
  error estimate for blocks of size 2^( 6) =       0.000551788886
  error estimate for blocks of size 2^( 7) =       0.000559694273

      target function =      -0.745237020665
              le_mean =     -22.815399559964
             les_mean =     520.992586441016
             stat err =       0.000547588347
             autocorr =       1.374794136984
   target nu stat err =       0.000547588347
   target dn stat err =       0.002951877547
      target stat err =       0.002509460492
              std dev =       0.660465839325
             le_variance =       0.436215124915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436240021590
                                         uncertainty =       0.001971713847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436240021590
                                         uncertainty =       0.001971713847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467013047
  error estimate for blocks of size 2^( 2) =       0.000492397772
  error estimate for blocks of size 2^( 3) =       0.000516022982
  error estimate for blocks of size 2^( 4) =       0.000534346087
  error estimate for blocks of size 2^( 5) =       0.000544525205
  error estimate for blocks of size 2^( 6) =       0.000551791300
  error estimate for blocks of size 2^( 7) =       0.000559700147

      target function =      -0.708391973000
              le_mean =     -22.815399631364
             les_mean =     521.037484023266
             stat err =       0.000547590685
             autocorr =       1.374846068188
   target nu stat err =       0.000547590685
   target dn stat err =       0.044664928965
      target stat err =       0.033371429033
              std dev =       0.660456184775
             le_variance =       0.436202372008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436245896577
                                         uncertainty =       0.001971889590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436245896577
                                         uncertainty =       0.001971889590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467016200
  error estimate for blocks of size 2^( 2) =       0.000492399139
  error estimate for blocks of size 2^( 3) =       0.000516023590
  error estimate for blocks of size 2^( 4) =       0.000534346193
  error estimate for blocks of size 2^( 5) =       0.000544523931
  error estimate for blocks of size 2^( 6) =       0.000551790379
  error estimate for blocks of size 2^( 7) =       0.000559697356

      target function =      -0.745138665644
              le_mean =     -22.815399377461
             les_mean =     520.992697128104
             stat err =       0.000547589465
             autocorr =       1.374821375647
   target nu stat err =       0.000547589465
   target dn stat err =       0.002986536463
      target stat err =       0.002536564790
              std dev =       0.660460644456
             le_variance =       0.436208262875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436251864128
                                         uncertainty =       0.001972059249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436251864128
                                         uncertainty =       0.001972059249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467019402
  error estimate for blocks of size 2^( 2) =       0.000492400944
  error estimate for blocks of size 2^( 3) =       0.000516024347
  error estimate for blocks of size 2^( 4) =       0.000534346363
  error estimate for blocks of size 2^( 5) =       0.000544523837
  error estimate for blocks of size 2^( 6) =       0.000551789067
  error estimate for blocks of size 2^( 7) =       0.000559694653

      target function =      -0.745235946215
              le_mean =     -22.815399534343
             les_mean =     520.992586547689
             stat err =       0.000547588480
             autocorr =       1.374797579179
   target nu stat err =       0.000547588480
   target dn stat err =       0.002955948388
      target stat err =       0.002512712399
              std dev =       0.660465172486
             le_variance =       0.436214244068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745237020665        initial  <--
     1.5625e+00     1.5625e+01             1.5443e-04        -0.708391973000
     6.2500e+00     6.2500e+01             3.9059e-05        -0.745138665644
     2.5000e+01     2.5000e+02             9.7934e-06        -0.745235946215

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 75.0506
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.273171e-01 3 1  ON 0
ci_02                -2.888240e-02 3 1  ON 1
ci_03                -2.899779e-02 3 1  ON 2
ci_04                 2.691897e-02 3 1  ON 3
ci_05                -2.208396e-02 3 1  ON 4
ci_06                -2.179860e-02 3 1  ON 5
ci_07                 2.740135e-02 3 1  ON 6
ci_08                -5.571497e-03 3 1  ON 7
ci_09                -9.071451e-03 3 1  ON 8
ci_10                -8.356350e-03 3 1  ON 9
ci_11                 1.321588e-02 3 1  ON 10
ci_12                 6.947075e-03 3 1  ON 11
ci_13                 1.283444e-02 3 1  ON 12
ci_14                 1.270755e-02 3 1  ON 13
ci_15                 6.273771e-03 3 1  ON 14
ci_16                 6.431771e-03 3 1  ON 15
ci_17                -7.256524e-03 3 1  ON 16
ci_18                -5.949263e-03 3 1  ON 17
ci_19                 9.299044e-03 3 1  ON 18
ci_20                 6.397828e-03 3 1  ON 19
ci_21                 9.000870e-03 3 1  ON 20
ci_22                 8.260916e-03 3 1  ON 21
ci_23                 4.757530e-03 3 1  ON 22
ci_24                 3.981248e-03 3 1  ON 23
ci_25                 2.845311e-03 3 1  ON 24
ci_26                 3.145508e-03 3 1  ON 25
ci_27                 3.328083e-03 3 1  ON 26
ci_28                 1.923492e-03 3 1  ON 27
ci_29                 1.300931e-03 3 1  ON 28
ci_30                -1.841344e-03 3 1  ON 29
ci_31                -5.572525e-04 3 1  ON 30
ci_32                -8.443063e-04 3 1  ON 31
ci_33                -1.479475e-03 3 1  ON 32
ci_34                 1.136517e-03 3 1  ON 33
ci_35                 1.472516e-03 3 1  ON 34
ci_36                -1.019761e-03 3 1  ON 35
ci_37                -1.033222e-03 3 1  ON 36
ci_38                -7.715789e-04 3 1  ON 37
ci_39                -6.258564e-04 3 1  ON 38
ci_40                -1.570234e-03 3 1  ON 39
ci_41                -1.249087e-03 3 1  ON 40
ci_42                -1.169829e-03 3 1  ON 41
ci_43                -2.486721e-03 3 1  ON 42
ci_44                -3.263599e-03 3 1  ON 43
ci_45                -5.323321e-04 3 1  ON 44
ci_46                -8.756269e-04 3 1  ON 45
ci_47                 1.539456e-03 3 1  ON 46
ci_48                 1.375810e-03 3 1  ON 47
ci_49                -1.048221e-03 3 1  ON 48
ci_50                -8.113775e-04 3 1  ON 49
ci_51                 1.481497e-04 3 1  ON 50
ci_52                 8.386596e-05 3 1  ON 51
ci_53                -6.340107e-04 3 1  ON 52
ci_54                -1.030356e-03 3 1  ON 53
ci_55                -6.525485e-04 3 1  ON 54
ci_56                 2.632669e-03 3 1  ON 55
ci_57                 1.618145e-03 3 1  ON 56
ci_58                -1.118028e-03 3 1  ON 57
ci_59                -1.475964e-03 3 1  ON 58
ci_60                 5.427518e-04 3 1  ON 59
ci_61                -1.246278e-04 3 1  ON 60
ci_62                -6.668997e-04 3 1  ON 61
ci_63                -7.741006e-04 3 1  ON 62
ci_64                -2.628892e-04 3 1  ON 63
ci_65                 6.551620e-05 3 1  ON 64
ci_66                -7.157980e-04 3 1  ON 65
ci_67                -9.019391e-04 3 1  ON 66
ci_68                -1.382071e-03 3 1  ON 67
ci_69                 1.445443e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2683e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8564
    reference variance = 0.630382
====================================================
  Execution time = 4.4221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4842e-01
  Total weights = 1.964168246e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436109468709
                                         uncertainty =       0.002277362811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436109468709
                                         uncertainty =       0.002277362811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466944712
  error estimate for blocks of size 2^( 2) =       0.000491951233
  error estimate for blocks of size 2^( 3) =       0.000515969285
  error estimate for blocks of size 2^( 4) =       0.000534485389
  error estimate for blocks of size 2^( 5) =       0.000545774288
  error estimate for blocks of size 2^( 6) =       0.000551495050
  error estimate for blocks of size 2^( 7) =       0.000556145960

      target function =      -0.746637317112
              le_mean =     -22.813649332020
             les_mean =     520.911013824035
             stat err =       0.000546975172
             autocorr =       1.372158574879
   target nu stat err =       0.000546975172
   target dn stat err =       0.003194277870
      target stat err =       0.002706670035
              std dev =       0.660359544284
             le_variance =       0.436074727727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281364933202e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746646059010       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746646999377       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746647108582       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746647115500       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746647119323       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746647118089       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746647119131       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746647119112       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746647119063       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 1.121762e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746646059010       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746646294678       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746646322017       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746646323742       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746646324698       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746646324389       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746646324650       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746646324645       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746646324633       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 2.811369e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746646059010       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746646117963       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746646124800       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746646125231       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746646125470       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746646125393       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746646125458       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746646125457       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746646125453       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 7.032790e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2043e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.273153e-01 3 1  ON 0
ci_02                -2.888211e-02 3 1  ON 1
ci_03                -2.899768e-02 3 1  ON 2
ci_04                 2.691616e-02 3 1  ON 3
ci_05                -2.208223e-02 3 1  ON 4
ci_06                -2.179766e-02 3 1  ON 5
ci_07                 2.740084e-02 3 1  ON 6
ci_08                -5.571150e-03 3 1  ON 7
ci_09                -9.070272e-03 3 1  ON 8
ci_10                -8.356898e-03 3 1  ON 9
ci_11                 1.321624e-02 3 1  ON 10
ci_12                 6.946969e-03 3 1  ON 11
ci_13                 1.283344e-02 3 1  ON 12
ci_14                 1.270760e-02 3 1  ON 13
ci_15                 6.273911e-03 3 1  ON 14
ci_16                 6.432105e-03 3 1  ON 15
ci_17                -7.255101e-03 3 1  ON 16
ci_18                -5.949215e-03 3 1  ON 17
ci_19                 9.298861e-03 3 1  ON 18
ci_20                 6.397536e-03 3 1  ON 19
ci_21                 9.000468e-03 3 1  ON 20
ci_22                 8.261172e-03 3 1  ON 21
ci_23                 4.757314e-03 3 1  ON 22
ci_24                 3.981953e-03 3 1  ON 23
ci_25                 2.846124e-03 3 1  ON 24
ci_26                 3.146020e-03 3 1  ON 25
ci_27                 3.328032e-03 3 1  ON 26
ci_28                 1.922839e-03 3 1  ON 27
ci_29                 1.301454e-03 3 1  ON 28
ci_30                -1.841012e-03 3 1  ON 29
ci_31                -5.576563e-04 3 1  ON 30
ci_32                -8.437846e-04 3 1  ON 31
ci_33                -1.479532e-03 3 1  ON 32
ci_34                 1.136696e-03 3 1  ON 33
ci_35                 1.470748e-03 3 1  ON 34
ci_36                -1.019863e-03 3 1  ON 35
ci_37                -1.032944e-03 3 1  ON 36
ci_38                -7.712594e-04 3 1  ON 37
ci_39                -6.262749e-04 3 1  ON 38
ci_40                -1.570674e-03 3 1  ON 39
ci_41                -1.248711e-03 3 1  ON 40
ci_42                -1.170444e-03 3 1  ON 41
ci_43                -2.486269e-03 3 1  ON 42
ci_44                -3.262178e-03 3 1  ON 43
ci_45                -5.318544e-04 3 1  ON 44
ci_46                -8.748367e-04 3 1  ON 45
ci_47                 1.539692e-03 3 1  ON 46
ci_48                 1.376175e-03 3 1  ON 47
ci_49                -1.049137e-03 3 1  ON 48
ci_50                -8.113139e-04 3 1  ON 49
ci_51                 1.479564e-04 3 1  ON 50
ci_52                 8.399561e-05 3 1  ON 51
ci_53                -6.338573e-04 3 1  ON 52
ci_54                -1.030033e-03 3 1  ON 53
ci_55                -6.512975e-04 3 1  ON 54
ci_56                 2.631903e-03 3 1  ON 55
ci_57                 1.617958e-03 3 1  ON 56
ci_58                -1.117394e-03 3 1  ON 57
ci_59                -1.474509e-03 3 1  ON 58
ci_60                 5.425473e-04 3 1  ON 59
ci_61                -1.256871e-04 3 1  ON 60
ci_62                -6.666969e-04 3 1  ON 61
ci_63                -7.741232e-04 3 1  ON 62
ci_64                -2.618135e-04 3 1  ON 63
ci_65                 6.563120e-05 3 1  ON 64
ci_66                -7.156283e-04 3 1  ON 65
ci_67                -9.016011e-04 3 1  ON 66
ci_68                -1.381793e-03 3 1  ON 67
ci_69                 1.439043e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.828
    reference variance = 0.352313
====================================================
  Execution time = 4.4064e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4834e-01
  Total weights = 1.9644e+06
  Execution time = 5.9874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436340991666
                                         uncertainty =       0.001966375053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436340991666
                                         uncertainty =       0.001966375053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467051901
  error estimate for blocks of size 2^( 2) =       0.000492651085
  error estimate for blocks of size 2^( 3) =       0.000516180474
  error estimate for blocks of size 2^( 4) =       0.000532967919
  error estimate for blocks of size 2^( 5) =       0.000544067164
  error estimate for blocks of size 2^( 6) =       0.000549330927
  error estimate for blocks of size 2^( 7) =       0.000552972220

      target function =      -0.746712332115
              le_mean =     -22.814394472756
             les_mean =     520.944931635157
             stat err =       0.000544834558
             autocorr =       1.360814739248
   target nu stat err =       0.000544834558
   target dn stat err =       0.002911484980
      target stat err =       0.002482211217
              std dev =       0.660511132351
             le_variance =       0.436274955959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436339938036
                                         uncertainty =       0.001966357183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436339938036
                                         uncertainty =       0.001966357183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467051339
  error estimate for blocks of size 2^( 2) =       0.000492650964
  error estimate for blocks of size 2^( 3) =       0.000516180811
  error estimate for blocks of size 2^( 4) =       0.000532968456
  error estimate for blocks of size 2^( 5) =       0.000544067922
  error estimate for blocks of size 2^( 6) =       0.000549331643
  error estimate for blocks of size 2^( 7) =       0.000552972871

      target function =      -0.746699080595
              le_mean =     -22.814394450332
             les_mean =     520.944946647053
             stat err =       0.000544835223
             autocorr =       1.360821334487
   target nu stat err =       0.000544835223
   target dn stat err =       0.002909864414
      target stat err =       0.002480825873
              std dev =       0.660510338535
             le_variance =       0.436273907311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436340462131
                                         uncertainty =       0.001966366136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436340462131
                                         uncertainty =       0.001966366136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467051619
  error estimate for blocks of size 2^( 2) =       0.000492651023
  error estimate for blocks of size 2^( 3) =       0.000516180642
  error estimate for blocks of size 2^( 4) =       0.000532968188
  error estimate for blocks of size 2^( 5) =       0.000544067543
  error estimate for blocks of size 2^( 6) =       0.000549331289
  error estimate for blocks of size 2^( 7) =       0.000552972550

      target function =      -0.746661875819
              le_mean =     -22.814394461114
             les_mean =     520.944992123884
             stat err =       0.000544834892
             autocorr =       1.360818055419
   target nu stat err =       0.000544834892
   target dn stat err =       0.002911126291
      target stat err =       0.002481598034
              std dev =       0.660510733389
             le_variance =       0.436274428922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436340925249
                                         uncertainty =       0.001966373938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436340925249
                                         uncertainty =       0.001966373938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467051865
  error estimate for blocks of size 2^( 2) =       0.000492651077
  error estimate for blocks of size 2^( 3) =       0.000516180495
  error estimate for blocks of size 2^( 4) =       0.000532967953
  error estimate for blocks of size 2^( 5) =       0.000544067212
  error estimate for blocks of size 2^( 6) =       0.000549330972
  error estimate for blocks of size 2^( 7) =       0.000552972261

      target function =      -0.746712650884
              le_mean =     -22.814394471348
             les_mean =     520.944931186306
             stat err =       0.000544834599
             autocorr =       1.360815153483
   target nu stat err =       0.000544834599
   target dn stat err =       0.002911347862
      target stat err =       0.002482103285
              std dev =       0.660511082311
             le_variance =       0.436274889855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746712332115        initial
     1.5625e+01     1.5625e+02             1.1218e-05        -0.746699080595
     6.2500e+01     6.2500e+02             2.8114e-06        -0.746661875819
     2.5000e+02     2.5000e+03             7.0328e-07        -0.746712650884  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+02     and shift_s =   2.5000e+03
*****************************************************************************

  Execution time = 7.3985e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.273167e-01 3 1  ON 0
ci_02                -2.888232e-02 3 1  ON 1
ci_03                -2.899777e-02 3 1  ON 2
ci_04                 2.691827e-02 3 1  ON 3
ci_05                -2.208352e-02 3 1  ON 4
ci_06                -2.179836e-02 3 1  ON 5
ci_07                 2.740122e-02 3 1  ON 6
ci_08                -5.571410e-03 3 1  ON 7
ci_09                -9.071156e-03 3 1  ON 8
ci_10                -8.356487e-03 3 1  ON 9
ci_11                 1.321597e-02 3 1  ON 10
ci_12                 6.947049e-03 3 1  ON 11
ci_13                 1.283419e-02 3 1  ON 12
ci_14                 1.270757e-02 3 1  ON 13
ci_15                 6.273806e-03 3 1  ON 14
ci_16                 6.431855e-03 3 1  ON 15
ci_17                -7.256168e-03 3 1  ON 16
ci_18                -5.949251e-03 3 1  ON 17
ci_19                 9.298998e-03 3 1  ON 18
ci_20                 6.397755e-03 3 1  ON 19
ci_21                 9.000770e-03 3 1  ON 20
ci_22                 8.260980e-03 3 1  ON 21
ci_23                 4.757476e-03 3 1  ON 22
ci_24                 3.981425e-03 3 1  ON 23
ci_25                 2.845514e-03 3 1  ON 24
ci_26                 3.145636e-03 3 1  ON 25
ci_27                 3.328070e-03 3 1  ON 26
ci_28                 1.923329e-03 3 1  ON 27
ci_29                 1.301062e-03 3 1  ON 28
ci_30                -1.841261e-03 3 1  ON 29
ci_31                -5.573534e-04 3 1  ON 30
ci_32                -8.441758e-04 3 1  ON 31
ci_33                -1.479489e-03 3 1  ON 32
ci_34                 1.136562e-03 3 1  ON 33
ci_35                 1.472074e-03 3 1  ON 34
ci_36                -1.019786e-03 3 1  ON 35
ci_37                -1.033153e-03 3 1  ON 36
ci_38                -7.714990e-04 3 1  ON 37
ci_39                -6.259611e-04 3 1  ON 38
ci_40                -1.570344e-03 3 1  ON 39
ci_41                -1.248993e-03 3 1  ON 40
ci_42                -1.169983e-03 3 1  ON 41
ci_43                -2.486608e-03 3 1  ON 42
ci_44                -3.263243e-03 3 1  ON 43
ci_45                -5.322126e-04 3 1  ON 44
ci_46                -8.754292e-04 3 1  ON 45
ci_47                 1.539515e-03 3 1  ON 46
ci_48                 1.375901e-03 3 1  ON 47
ci_49                -1.048450e-03 3 1  ON 48
ci_50                -8.113616e-04 3 1  ON 49
ci_51                 1.481014e-04 3 1  ON 50
ci_52                 8.389840e-05 3 1  ON 51
ci_53                -6.339724e-04 3 1  ON 52
ci_54                -1.030275e-03 3 1  ON 53
ci_55                -6.522355e-04 3 1  ON 54
ci_56                 2.632477e-03 3 1  ON 55
ci_57                 1.618098e-03 3 1  ON 56
ci_58                -1.117869e-03 3 1  ON 57
ci_59                -1.475600e-03 3 1  ON 58
ci_60                 5.427007e-04 3 1  ON 59
ci_61                -1.248927e-04 3 1  ON 60
ci_62                -6.668490e-04 3 1  ON 61
ci_63                -7.741063e-04 3 1  ON 62
ci_64                -2.626201e-04 3 1  ON 63
ci_65                 6.554497e-05 3 1  ON 64
ci_66                -7.157556e-04 3 1  ON 65
ci_67                -9.018545e-04 3 1  ON 66
ci_68                -1.382001e-03 3 1  ON 67
ci_69                 1.443842e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2617e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6229
    reference variance = 0.589423
====================================================
  Execution time = 4.4156e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6149e-01
  Total weights = 1.964241696e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445722496655
                                         uncertainty =       0.009752786370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445722496655
                                         uncertainty =       0.009752786370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472067662
  error estimate for blocks of size 2^( 2) =       0.000497030208
  error estimate for blocks of size 2^( 3) =       0.000521195895
  error estimate for blocks of size 2^( 4) =       0.000539364447
  error estimate for blocks of size 2^( 5) =       0.000550240084
  error estimate for blocks of size 2^( 6) =       0.000558490672
  error estimate for blocks of size 2^( 7) =       0.000563737572

      target function =      -0.735893463531
              le_mean =     -22.815298877721
             les_mean =     520.999349274338
             stat err =       0.000552958194
             autocorr =       1.372069446164
   target nu stat err =       0.000552958194
   target dn stat err =       0.010692192123
      target stat err =       0.008621730786
              std dev =       0.667604490087
             le_variance =       0.445695755184


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281529887772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735992672739       residual = 6.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735993664700       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735993767317       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735993787794       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735993790431       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735993791316       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735993792333       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735993791952       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735993791860       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 6.533474e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735992672739       residual = 6.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735992920873       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735992946534       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735992951653       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735992952312       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735992952534       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735992952788       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735992952693       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735992952670       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.634153e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735992672739       residual = 6.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735992734781       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735992741197       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735992742477       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735992742642       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735992742697       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735992742760       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735992742737       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735992742730       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 4.085874e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1860e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.273162e-01 3 1  ON 0
ci_02                -2.888342e-02 3 1  ON 1
ci_03                -2.899756e-02 3 1  ON 2
ci_04                 2.691818e-02 3 1  ON 3
ci_05                -2.208333e-02 3 1  ON 4
ci_06                -2.179673e-02 3 1  ON 5
ci_07                 2.740107e-02 3 1  ON 6
ci_08                -5.571123e-03 3 1  ON 7
ci_09                -9.070714e-03 3 1  ON 8
ci_10                -8.355873e-03 3 1  ON 9
ci_11                 1.321601e-02 3 1  ON 10
ci_12                 6.945553e-03 3 1  ON 11
ci_13                 1.283401e-02 3 1  ON 12
ci_14                 1.270748e-02 3 1  ON 13
ci_15                 6.273329e-03 3 1  ON 14
ci_16                 6.431795e-03 3 1  ON 15
ci_17                -7.256074e-03 3 1  ON 16
ci_18                -5.948936e-03 3 1  ON 17
ci_19                 9.299126e-03 3 1  ON 18
ci_20                 6.397767e-03 3 1  ON 19
ci_21                 9.000527e-03 3 1  ON 20
ci_22                 8.260799e-03 3 1  ON 21
ci_23                 4.757573e-03 3 1  ON 22
ci_24                 3.981552e-03 3 1  ON 23
ci_25                 2.845512e-03 3 1  ON 24
ci_26                 3.145552e-03 3 1  ON 25
ci_27                 3.328225e-03 3 1  ON 26
ci_28                 1.923351e-03 3 1  ON 27
ci_29                 1.300339e-03 3 1  ON 28
ci_30                -1.841260e-03 3 1  ON 29
ci_31                -5.574569e-04 3 1  ON 30
ci_32                -8.437127e-04 3 1  ON 31
ci_33                -1.478894e-03 3 1  ON 32
ci_34                 1.136503e-03 3 1  ON 33
ci_35                 1.471250e-03 3 1  ON 34
ci_36                -1.019779e-03 3 1  ON 35
ci_37                -1.033018e-03 3 1  ON 36
ci_38                -7.714323e-04 3 1  ON 37
ci_39                -6.257455e-04 3 1  ON 38
ci_40                -1.570036e-03 3 1  ON 39
ci_41                -1.248744e-03 3 1  ON 40
ci_42                -1.169747e-03 3 1  ON 41
ci_43                -2.486986e-03 3 1  ON 42
ci_44                -3.262421e-03 3 1  ON 43
ci_45                -5.324072e-04 3 1  ON 44
ci_46                -8.753201e-04 3 1  ON 45
ci_47                 1.539675e-03 3 1  ON 46
ci_48                 1.376024e-03 3 1  ON 47
ci_49                -1.048453e-03 3 1  ON 48
ci_50                -8.113372e-04 3 1  ON 49
ci_51                 1.481455e-04 3 1  ON 50
ci_52                 8.364538e-05 3 1  ON 51
ci_53                -6.340405e-04 3 1  ON 52
ci_54                -1.030301e-03 3 1  ON 53
ci_55                -6.523348e-04 3 1  ON 54
ci_56                 2.632311e-03 3 1  ON 55
ci_57                 1.618453e-03 3 1  ON 56
ci_58                -1.117916e-03 3 1  ON 57
ci_59                -1.475111e-03 3 1  ON 58
ci_60                 5.426738e-04 3 1  ON 59
ci_61                -1.248172e-04 3 1  ON 60
ci_62                -6.667660e-04 3 1  ON 61
ci_63                -7.741280e-04 3 1  ON 62
ci_64                -2.623385e-04 3 1  ON 63
ci_65                 6.542756e-05 3 1  ON 64
ci_66                -7.155435e-04 3 1  ON 65
ci_67                -9.016585e-04 3 1  ON 66
ci_68                -1.382032e-03 3 1  ON 67
ci_69                 1.442921e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8774
    reference variance = 0.387857
====================================================
  Execution time = 4.2941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4417e-01
  Total weights = 1.9642e+06
  Execution time = 5.9604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433221960790
                                         uncertainty =       0.001552610935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433221960790
                                         uncertainty =       0.001552610935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465411297
  error estimate for blocks of size 2^( 2) =       0.000491119124
  error estimate for blocks of size 2^( 3) =       0.000515232311
  error estimate for blocks of size 2^( 4) =       0.000532793145
  error estimate for blocks of size 2^( 5) =       0.000543873907
  error estimate for blocks of size 2^( 6) =       0.000551586150
  error estimate for blocks of size 2^( 7) =       0.000558077637

      target function =      -0.750173032436
              le_mean =     -22.814374850592
             les_mean =     520.939874685722
             stat err =       0.000546582709
             autocorr =       1.379233944448
   target nu stat err =       0.000546582709
   target dn stat err =       0.002162572562
      target stat err =       0.001904660105
              std dev =       0.658190968065
             le_variance =       0.433215350442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433221666116
                                         uncertainty =       0.001552619657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433221666116
                                         uncertainty =       0.001552619657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465411141
  error estimate for blocks of size 2^( 2) =       0.000491119106
  error estimate for blocks of size 2^( 3) =       0.000515232411
  error estimate for blocks of size 2^( 4) =       0.000532793261
  error estimate for blocks of size 2^( 5) =       0.000543874017
  error estimate for blocks of size 2^( 6) =       0.000551586370
  error estimate for blocks of size 2^( 7) =       0.000558077667

      target function =      -0.750177863255
              le_mean =     -22.814374858345
             les_mean =     520.939869254191
             stat err =       0.000546582828
             autocorr =       1.379235467008
   target nu stat err =       0.000546582828
   target dn stat err =       0.002162046262
      target stat err =       0.001904267164
              std dev =       0.658190748040
             le_variance =       0.433215060806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433221812876
                                         uncertainty =       0.001552615286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433221812876
                                         uncertainty =       0.001552615286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465411219
  error estimate for blocks of size 2^( 2) =       0.000491119115
  error estimate for blocks of size 2^( 3) =       0.000515232361
  error estimate for blocks of size 2^( 4) =       0.000532793202
  error estimate for blocks of size 2^( 5) =       0.000543873962
  error estimate for blocks of size 2^( 6) =       0.000551586259
  error estimate for blocks of size 2^( 7) =       0.000558077651

      target function =      -0.750175494909
              le_mean =     -22.814374854397
             les_mean =     520.939871910325
             stat err =       0.000546582769
             autocorr =       1.379234706479
   target nu stat err =       0.000546582769
   target dn stat err =       0.002162302737
      target stat err =       0.001904458581
              std dev =       0.658190857616
             le_variance =       0.433215205049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433221942244
                                         uncertainty =       0.001552611477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433221942244
                                         uncertainty =       0.001552611477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465411287
  error estimate for blocks of size 2^( 2) =       0.000491119123
  error estimate for blocks of size 2^( 3) =       0.000515232317
  error estimate for blocks of size 2^( 4) =       0.000532793152
  error estimate for blocks of size 2^( 5) =       0.000543873914
  error estimate for blocks of size 2^( 6) =       0.000551586163
  error estimate for blocks of size 2^( 7) =       0.000558077638

      target function =      -0.750173345430
              le_mean =     -22.814374851060
             les_mean =     520.939874332220
             stat err =       0.000546582717
             autocorr =       1.379234039743
   target nu stat err =       0.000546582717
   target dn stat err =       0.002162538087
      target stat err =       0.001904634348
              std dev =       0.658190954216
             le_variance =       0.433215332211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750173032436        initial
     6.2500e+01     6.2500e+02             6.5335e-06        -0.750177863255  <--
     2.5000e+02     2.5000e+03             1.6342e-06        -0.750175494909
     1.0000e+03     1.0000e+04             4.0859e-07        -0.750173345430

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 7.4383e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.273149e-01 3 1  ON 0
ci_02                -2.888670e-02 3 1  ON 1
ci_03                -2.899693e-02 3 1  ON 2
ci_04                 2.691790e-02 3 1  ON 3
ci_05                -2.208274e-02 3 1  ON 4
ci_06                -2.179183e-02 3 1  ON 5
ci_07                 2.740063e-02 3 1  ON 6
ci_08                -5.570265e-03 3 1  ON 7
ci_09                -9.069386e-03 3 1  ON 8
ci_10                -8.354032e-03 3 1  ON 9
ci_11                 1.321613e-02 3 1  ON 10
ci_12                 6.941070e-03 3 1  ON 11
ci_13                 1.283346e-02 3 1  ON 12
ci_14                 1.270721e-02 3 1  ON 13
ci_15                 6.271901e-03 3 1  ON 14
ci_16                 6.431614e-03 3 1  ON 15
ci_17                -7.255792e-03 3 1  ON 16
ci_18                -5.947990e-03 3 1  ON 17
ci_19                 9.299510e-03 3 1  ON 18
ci_20                 6.397803e-03 3 1  ON 19
ci_21                 8.999799e-03 3 1  ON 20
ci_22                 8.260256e-03 3 1  ON 21
ci_23                 4.757865e-03 3 1  ON 22
ci_24                 3.981933e-03 3 1  ON 23
ci_25                 2.845506e-03 3 1  ON 24
ci_26                 3.145299e-03 3 1  ON 25
ci_27                 3.328689e-03 3 1  ON 26
ci_28                 1.923419e-03 3 1  ON 27
ci_29                 1.298171e-03 3 1  ON 28
ci_30                -1.841254e-03 3 1  ON 29
ci_31                -5.577672e-04 3 1  ON 30
ci_32                -8.423246e-04 3 1  ON 31
ci_33                -1.477111e-03 3 1  ON 32
ci_34                 1.136329e-03 3 1  ON 33
ci_35                 1.468779e-03 3 1  ON 34
ci_36                -1.019758e-03 3 1  ON 35
ci_37                -1.032613e-03 3 1  ON 36
ci_38                -7.712322e-04 3 1  ON 37
ci_39                -6.250991e-04 3 1  ON 38
ci_40                -1.569111e-03 3 1  ON 39
ci_41                -1.247996e-03 3 1  ON 40
ci_42                -1.169039e-03 3 1  ON 41
ci_43                -2.488118e-03 3 1  ON 42
ci_44                -3.259957e-03 3 1  ON 43
ci_45                -5.329906e-04 3 1  ON 44
ci_46                -8.749928e-04 3 1  ON 45
ci_47                 1.540156e-03 3 1  ON 46
ci_48                 1.376393e-03 3 1  ON 47
ci_49                -1.048461e-03 3 1  ON 48
ci_50                -8.112643e-04 3 1  ON 49
ci_51                 1.482776e-04 3 1  ON 50
ci_52                 8.288694e-05 3 1  ON 51
ci_53                -6.342448e-04 3 1  ON 52
ci_54                -1.030380e-03 3 1  ON 53
ci_55                -6.526324e-04 3 1  ON 54
ci_56                 2.631813e-03 3 1  ON 55
ci_57                 1.619515e-03 3 1  ON 56
ci_58                -1.118056e-03 3 1  ON 57
ci_59                -1.473647e-03 3 1  ON 58
ci_60                 5.425932e-04 3 1  ON 59
ci_61                -1.245907e-04 3 1  ON 60
ci_62                -6.665174e-04 3 1  ON 61
ci_63                -7.741933e-04 3 1  ON 62
ci_64                -2.614944e-04 3 1  ON 63
ci_65                 6.507562e-05 3 1  ON 64
ci_66                -7.149077e-04 3 1  ON 65
ci_67                -9.010710e-04 3 1  ON 66
ci_68                -1.382126e-03 3 1  ON 67
ci_69                 1.440160e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2689e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7727
    reference variance = 0.290369
====================================================
  Execution time = 4.2807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4806e-01
  Total weights = 1.964260047e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436461890251
                                         uncertainty =       0.001873425709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436461890251
                                         uncertainty =       0.001873425709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467112477
  error estimate for blocks of size 2^( 2) =       0.000492509591
  error estimate for blocks of size 2^( 3) =       0.000516018184
  error estimate for blocks of size 2^( 4) =       0.000533422474
  error estimate for blocks of size 2^( 5) =       0.000544853123
  error estimate for blocks of size 2^( 6) =       0.000551596449
  error estimate for blocks of size 2^( 7) =       0.000554892612

      target function =      -0.746941321616
              le_mean =     -22.814879471496
             les_mean =     520.966789649888
             stat err =       0.000546191165
             autocorr =       1.367245193113
   target nu stat err =       0.000546191165
   target dn stat err =       0.002864315554
      target stat err =       0.002447976716
              std dev =       0.660596800301
             le_variance =       0.436388132568


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281487947150e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746948364387       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746949376117       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746949488756       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746949507256       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746949521657       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746949528072       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746949526037       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746949526198       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746949526182       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 1.399133e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746948364387       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746948617910       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746948646108       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746948650730       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746948654328       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746948655928       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746948655419       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746948655459       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746948655455       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 3.502288e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746948364387       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746948427805       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746948434857       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746948436012       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746948436911       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746948437311       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746948437184       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746948437194       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746948437193       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 8.758509e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147719 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0470e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.273114e-01 3 1  ON 0
ci_02                -2.888524e-02 3 1  ON 1
ci_03                -2.899633e-02 3 1  ON 2
ci_04                 2.691615e-02 3 1  ON 3
ci_05                -2.208105e-02 3 1  ON 4
ci_06                -2.179114e-02 3 1  ON 5
ci_07                 2.739953e-02 3 1  ON 6
ci_08                -5.570299e-03 3 1  ON 7
ci_09                -9.067757e-03 3 1  ON 8
ci_10                -8.354208e-03 3 1  ON 9
ci_11                 1.321569e-02 3 1  ON 10
ci_12                 6.940337e-03 3 1  ON 11
ci_13                 1.283407e-02 3 1  ON 12
ci_14                 1.270614e-02 3 1  ON 13
ci_15                 6.271822e-03 3 1  ON 14
ci_16                 6.431883e-03 3 1  ON 15
ci_17                -7.255531e-03 3 1  ON 16
ci_18                -5.948745e-03 3 1  ON 17
ci_19                 9.299324e-03 3 1  ON 18
ci_20                 6.397251e-03 3 1  ON 19
ci_21                 8.999762e-03 3 1  ON 20
ci_22                 8.261284e-03 3 1  ON 21
ci_23                 4.757673e-03 3 1  ON 22
ci_24                 3.982812e-03 3 1  ON 23
ci_25                 2.845829e-03 3 1  ON 24
ci_26                 3.145289e-03 3 1  ON 25
ci_27                 3.328424e-03 3 1  ON 26
ci_28                 1.923129e-03 3 1  ON 27
ci_29                 1.299022e-03 3 1  ON 28
ci_30                -1.841163e-03 3 1  ON 29
ci_31                -5.584910e-04 3 1  ON 30
ci_32                -8.427114e-04 3 1  ON 31
ci_33                -1.477776e-03 3 1  ON 32
ci_34                 1.136382e-03 3 1  ON 33
ci_35                 1.467792e-03 3 1  ON 34
ci_36                -1.019851e-03 3 1  ON 35
ci_37                -1.032658e-03 3 1  ON 36
ci_38                -7.709343e-04 3 1  ON 37
ci_39                -6.254676e-04 3 1  ON 38
ci_40                -1.569408e-03 3 1  ON 39
ci_41                -1.247643e-03 3 1  ON 40
ci_42                -1.169969e-03 3 1  ON 41
ci_43                -2.488075e-03 3 1  ON 42
ci_44                -3.256684e-03 3 1  ON 43
ci_45                -5.325472e-04 3 1  ON 44
ci_46                -8.742348e-04 3 1  ON 45
ci_47                 1.540358e-03 3 1  ON 46
ci_48                 1.376632e-03 3 1  ON 47
ci_49                -1.047857e-03 3 1  ON 48
ci_50                -8.114258e-04 3 1  ON 49
ci_51                 1.480570e-04 3 1  ON 50
ci_52                 8.326116e-05 3 1  ON 51
ci_53                -6.343366e-04 3 1  ON 52
ci_54                -1.029980e-03 3 1  ON 53
ci_55                -6.526959e-04 3 1  ON 54
ci_56                 2.631350e-03 3 1  ON 55
ci_57                 1.620158e-03 3 1  ON 56
ci_58                -1.118552e-03 3 1  ON 57
ci_59                -1.472481e-03 3 1  ON 58
ci_60                 5.424099e-04 3 1  ON 59
ci_61                -1.249626e-04 3 1  ON 60
ci_62                -6.664253e-04 3 1  ON 61
ci_63                -7.740126e-04 3 1  ON 62
ci_64                -2.617068e-04 3 1  ON 63
ci_65                 6.403989e-05 3 1  ON 64
ci_66                -7.150740e-04 3 1  ON 65
ci_67                -9.000570e-04 3 1  ON 66
ci_68                -1.382235e-03 3 1  ON 67
ci_69                 1.437737e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8006
    reference variance = 0.48803
====================================================
  Execution time = 4.1646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4700e-01
  Total weights = 1.9643e+06
  Execution time = 5.9002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435810134498
                                         uncertainty =       0.002233947663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435810134498
                                         uncertainty =       0.002233947663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466785973
  error estimate for blocks of size 2^( 2) =       0.000492104051
  error estimate for blocks of size 2^( 3) =       0.000515909343
  error estimate for blocks of size 2^( 4) =       0.000533630676
  error estimate for blocks of size 2^( 5) =       0.000545589521
  error estimate for blocks of size 2^( 6) =       0.000553279309
  error estimate for blocks of size 2^( 7) =       0.000558202590

      target function =      -0.747827661249
              le_mean =     -22.814878726335
             les_mean =     520.965688299449
             stat err =       0.000547675524
             autocorr =       1.376610482272
   target nu stat err =       0.000547675524
   target dn stat err =       0.002590159677
      target stat err =       0.002234252407
              std dev =       0.660135053112
             le_variance =       0.435778288347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435808724804
                                         uncertainty =       0.002234011592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435808724804
                                         uncertainty =       0.002234011592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466785225
  error estimate for blocks of size 2^( 2) =       0.000492103798
  error estimate for blocks of size 2^( 3) =       0.000515909596
  error estimate for blocks of size 2^( 4) =       0.000533631218
  error estimate for blocks of size 2^( 5) =       0.000545590203
  error estimate for blocks of size 2^( 6) =       0.000553279931
  error estimate for blocks of size 2^( 7) =       0.000558203437

      target function =      -0.747820972375
              le_mean =     -22.814878706893
             les_mean =     520.965695467323
             stat err =       0.000547676198
             autocorr =       1.376618273445
   target nu stat err =       0.000547676198
   target dn stat err =       0.002590764167
      target stat err =       0.002234696889
              std dev =       0.660133996610
             le_variance =       0.435776893480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435809426113
                                         uncertainty =       0.002233979639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435809426113
                                         uncertainty =       0.002233979639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466785597
  error estimate for blocks of size 2^( 2) =       0.000492103923
  error estimate for blocks of size 2^( 3) =       0.000515909468
  error estimate for blocks of size 2^( 4) =       0.000533630947
  error estimate for blocks of size 2^( 5) =       0.000545589862
  error estimate for blocks of size 2^( 6) =       0.000553279620
  error estimate for blocks of size 2^( 7) =       0.000558203013

      target function =      -0.747824456199
              le_mean =     -22.814878716278
             les_mean =     520.965691700122
             stat err =       0.000547675860
             autocorr =       1.376614386647
   target nu stat err =       0.000547675860
   target dn stat err =       0.002590459530
      target stat err =       0.002234473539
              std dev =       0.660134522192
             le_variance =       0.435777587390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435810045669
                                         uncertainty =       0.002233951658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435810045669
                                         uncertainty =       0.002233951658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466785925
  error estimate for blocks of size 2^( 2) =       0.000492104035
  error estimate for blocks of size 2^( 3) =       0.000515909359
  error estimate for blocks of size 2^( 4) =       0.000533630710
  error estimate for blocks of size 2^( 5) =       0.000545589564
  error estimate for blocks of size 2^( 6) =       0.000553279348
  error estimate for blocks of size 2^( 7) =       0.000558202643

      target function =      -0.747827275489
              le_mean =     -22.814878725043
             les_mean =     520.965688705048
             stat err =       0.000547675566
             autocorr =       1.376610970668
   target nu stat err =       0.000547675566
   target dn stat err =       0.002590196865
      target stat err =       0.002234279900
              std dev =       0.660134986535
             le_variance =       0.435778200447


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747827661249        initial  <--
     1.5625e+01     1.5625e+02             1.3991e-05        -0.747820972375
     6.2500e+01     6.2500e+02             3.5023e-06        -0.747824456199
     2.5000e+02     2.5000e+03             8.7585e-07        -0.747827275489

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.3694
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.273149e-01 3 1  ON 0
ci_02                -2.888670e-02 3 1  ON 1
ci_03                -2.899693e-02 3 1  ON 2
ci_04                 2.691790e-02 3 1  ON 3
ci_05                -2.208274e-02 3 1  ON 4
ci_06                -2.179183e-02 3 1  ON 5
ci_07                 2.740063e-02 3 1  ON 6
ci_08                -5.570265e-03 3 1  ON 7
ci_09                -9.069386e-03 3 1  ON 8
ci_10                -8.354032e-03 3 1  ON 9
ci_11                 1.321613e-02 3 1  ON 10
ci_12                 6.941070e-03 3 1  ON 11
ci_13                 1.283346e-02 3 1  ON 12
ci_14                 1.270721e-02 3 1  ON 13
ci_15                 6.271901e-03 3 1  ON 14
ci_16                 6.431614e-03 3 1  ON 15
ci_17                -7.255792e-03 3 1  ON 16
ci_18                -5.947990e-03 3 1  ON 17
ci_19                 9.299510e-03 3 1  ON 18
ci_20                 6.397803e-03 3 1  ON 19
ci_21                 8.999799e-03 3 1  ON 20
ci_22                 8.260256e-03 3 1  ON 21
ci_23                 4.757865e-03 3 1  ON 22
ci_24                 3.981933e-03 3 1  ON 23
ci_25                 2.845506e-03 3 1  ON 24
ci_26                 3.145299e-03 3 1  ON 25
ci_27                 3.328689e-03 3 1  ON 26
ci_28                 1.923419e-03 3 1  ON 27
ci_29                 1.298171e-03 3 1  ON 28
ci_30                -1.841254e-03 3 1  ON 29
ci_31                -5.577672e-04 3 1  ON 30
ci_32                -8.423246e-04 3 1  ON 31
ci_33                -1.477111e-03 3 1  ON 32
ci_34                 1.136329e-03 3 1  ON 33
ci_35                 1.468779e-03 3 1  ON 34
ci_36                -1.019758e-03 3 1  ON 35
ci_37                -1.032613e-03 3 1  ON 36
ci_38                -7.712322e-04 3 1  ON 37
ci_39                -6.250991e-04 3 1  ON 38
ci_40                -1.569111e-03 3 1  ON 39
ci_41                -1.247996e-03 3 1  ON 40
ci_42                -1.169039e-03 3 1  ON 41
ci_43                -2.488118e-03 3 1  ON 42
ci_44                -3.259957e-03 3 1  ON 43
ci_45                -5.329906e-04 3 1  ON 44
ci_46                -8.749928e-04 3 1  ON 45
ci_47                 1.540156e-03 3 1  ON 46
ci_48                 1.376393e-03 3 1  ON 47
ci_49                -1.048461e-03 3 1  ON 48
ci_50                -8.112643e-04 3 1  ON 49
ci_51                 1.482776e-04 3 1  ON 50
ci_52                 8.288694e-05 3 1  ON 51
ci_53                -6.342448e-04 3 1  ON 52
ci_54                -1.030380e-03 3 1  ON 53
ci_55                -6.526324e-04 3 1  ON 54
ci_56                 2.631813e-03 3 1  ON 55
ci_57                 1.619515e-03 3 1  ON 56
ci_58                -1.118056e-03 3 1  ON 57
ci_59                -1.473647e-03 3 1  ON 58
ci_60                 5.425932e-04 3 1  ON 59
ci_61                -1.245907e-04 3 1  ON 60
ci_62                -6.665174e-04 3 1  ON 61
ci_63                -7.741933e-04 3 1  ON 62
ci_64                -2.614944e-04 3 1  ON 63
ci_65                 6.507562e-05 3 1  ON 64
ci_66                -7.149077e-04 3 1  ON 65
ci_67                -9.010710e-04 3 1  ON 66
ci_68                -1.382126e-03 3 1  ON 67
ci_69                 1.440160e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2187e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2805e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7632
    reference variance = 0.437129
====================================================
  Execution time = 4.4405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4957e-01
  Total weights = 1.964501347e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435606752685
                                         uncertainty =       0.002018279362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435606752685
                                         uncertainty =       0.002018279362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466675674
  error estimate for blocks of size 2^( 2) =       0.000492199770
  error estimate for blocks of size 2^( 3) =       0.000515959443
  error estimate for blocks of size 2^( 4) =       0.000534035094
  error estimate for blocks of size 2^( 5) =       0.000544842931
  error estimate for blocks of size 2^( 6) =       0.000550305767
  error estimate for blocks of size 2^( 7) =       0.000553124572

      target function =      -0.745693538827
              le_mean =     -22.814435026858
             les_mean =     520.948016762963
             stat err =       0.000545577091
             autocorr =       1.366727474501
   target nu stat err =       0.000545577091
   target dn stat err =       0.002788122274
      target stat err =       0.002377439792
              std dev =       0.659979067468
             le_variance =       0.435572369496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281443502686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745700114128       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745700204254       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745700217604       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745700220458       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745700221159       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745700221507       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745700221726       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745700221773       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745700221791       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745700221777       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 9.796569e-07

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745700114128       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745700136665       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745700140003       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745700140716       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745700140892       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745700140979       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745700141033       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745700141045       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745700141050       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745700141047       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 2.449656e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745700114128       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745700119763       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745700120597       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745700120776       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745700120819       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745700120834       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745700120856       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745700120858       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745700120858       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745700120858       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 6.124462e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2066e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.273147e-01 3 1  ON 0
ci_02                -2.888657e-02 3 1  ON 1
ci_03                -2.899692e-02 3 1  ON 2
ci_04                 2.691780e-02 3 1  ON 3
ci_05                -2.208263e-02 3 1  ON 4
ci_06                -2.179159e-02 3 1  ON 5
ci_07                 2.740054e-02 3 1  ON 6
ci_08                -5.570203e-03 3 1  ON 7
ci_09                -9.069271e-03 3 1  ON 8
ci_10                -8.354025e-03 3 1  ON 9
ci_11                 1.321614e-02 3 1  ON 10
ci_12                 6.941086e-03 3 1  ON 11
ci_13                 1.283341e-02 3 1  ON 12
ci_14                 1.270729e-02 3 1  ON 13
ci_15                 6.271954e-03 3 1  ON 14
ci_16                 6.431647e-03 3 1  ON 15
ci_17                -7.255702e-03 3 1  ON 16
ci_18                -5.947991e-03 3 1  ON 17
ci_19                 9.299498e-03 3 1  ON 18
ci_20                 6.397881e-03 3 1  ON 19
ci_21                 8.999790e-03 3 1  ON 20
ci_22                 8.260355e-03 3 1  ON 21
ci_23                 4.757855e-03 3 1  ON 22
ci_24                 3.982062e-03 3 1  ON 23
ci_25                 2.845477e-03 3 1  ON 24
ci_26                 3.145343e-03 3 1  ON 25
ci_27                 3.328753e-03 3 1  ON 26
ci_28                 1.923409e-03 3 1  ON 27
ci_29                 1.298190e-03 3 1  ON 28
ci_30                -1.841271e-03 3 1  ON 29
ci_31                -5.578842e-04 3 1  ON 30
ci_32                -8.423889e-04 3 1  ON 31
ci_33                -1.477082e-03 3 1  ON 32
ci_34                 1.136318e-03 3 1  ON 33
ci_35                 1.468856e-03 3 1  ON 34
ci_36                -1.019723e-03 3 1  ON 35
ci_37                -1.032558e-03 3 1  ON 36
ci_38                -7.711862e-04 3 1  ON 37
ci_39                -6.251029e-04 3 1  ON 38
ci_40                -1.569081e-03 3 1  ON 39
ci_41                -1.247960e-03 3 1  ON 40
ci_42                -1.168902e-03 3 1  ON 41
ci_43                -2.488008e-03 3 1  ON 42
ci_44                -3.259827e-03 3 1  ON 43
ci_45                -5.330783e-04 3 1  ON 44
ci_46                -8.749040e-04 3 1  ON 45
ci_47                 1.540072e-03 3 1  ON 46
ci_48                 1.376336e-03 3 1  ON 47
ci_49                -1.048446e-03 3 1  ON 48
ci_50                -8.112724e-04 3 1  ON 49
ci_51                 1.482810e-04 3 1  ON 50
ci_52                 8.289948e-05 3 1  ON 51
ci_53                -6.342334e-04 3 1  ON 52
ci_54                -1.030377e-03 3 1  ON 53
ci_55                -6.527185e-04 3 1  ON 54
ci_56                 2.631804e-03 3 1  ON 55
ci_57                 1.619647e-03 3 1  ON 56
ci_58                -1.118075e-03 3 1  ON 57
ci_59                -1.473436e-03 3 1  ON 58
ci_60                 5.425783e-04 3 1  ON 59
ci_61                -1.245174e-04 3 1  ON 60
ci_62                -6.664802e-04 3 1  ON 61
ci_63                -7.742111e-04 3 1  ON 62
ci_64                -2.615372e-04 3 1  ON 63
ci_65                 6.510849e-05 3 1  ON 64
ci_66                -7.149474e-04 3 1  ON 65
ci_67                -9.009634e-04 3 1  ON 66
ci_68                -1.382170e-03 3 1  ON 67
ci_69                 1.439006e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8276
    reference variance = 0.493673
====================================================
  Execution time = 4.1630e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4598e-01
  Total weights = 1.9642e+06
  Execution time = 5.9621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269767512
                                         uncertainty =       0.001875628986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269767512
                                         uncertainty =       0.001875628986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405570
  error estimate for blocks of size 2^( 2) =       0.000491168465
  error estimate for blocks of size 2^( 3) =       0.000515224890
  error estimate for blocks of size 2^( 4) =       0.000533169980
  error estimate for blocks of size 2^( 5) =       0.000545242951
  error estimate for blocks of size 2^( 6) =       0.000551867870
  error estimate for blocks of size 2^( 7) =       0.000553736238

      target function =      -0.748674670025
              le_mean =     -22.814787108247
             les_mean =     520.960486069258
             stat err =       0.000546004260
             autocorr =       1.376350069966
   target nu stat err =       0.000546004260
   target dn stat err =       0.002815134299
      target stat err =       0.002418990076
              std dev =       0.658182868486
             le_variance =       0.433204688369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269712623
                                         uncertainty =       0.001875643620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269712623
                                         uncertainty =       0.001875643620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405540
  error estimate for blocks of size 2^( 2) =       0.000491168468
  error estimate for blocks of size 2^( 3) =       0.000515224929
  error estimate for blocks of size 2^( 4) =       0.000533170039
  error estimate for blocks of size 2^( 5) =       0.000545243019
  error estimate for blocks of size 2^( 6) =       0.000551867948
  error estimate for blocks of size 2^( 7) =       0.000553736323

      target function =      -0.748675025704
              le_mean =     -22.814787112382
             les_mean =     520.960485829989
             stat err =       0.000546004332
             autocorr =       1.376350610446
   target nu stat err =       0.000546004332
   target dn stat err =       0.002815199011
      target stat err =       0.002419044447
              std dev =       0.658182826571
             le_variance =       0.433204633193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269740043
                                         uncertainty =       0.001875636304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269740043
                                         uncertainty =       0.001875636304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405555
  error estimate for blocks of size 2^( 2) =       0.000491168467
  error estimate for blocks of size 2^( 3) =       0.000515224910
  error estimate for blocks of size 2^( 4) =       0.000533170009
  error estimate for blocks of size 2^( 5) =       0.000545242985
  error estimate for blocks of size 2^( 6) =       0.000551867909
  error estimate for blocks of size 2^( 7) =       0.000553736281

      target function =      -0.748674861579
              le_mean =     -22.814787110313
             les_mean =     520.960485933066
             stat err =       0.000546004296
             autocorr =       1.376350340286
   target nu stat err =       0.000546004296
   target dn stat err =       0.002815166596
      target stat err =       0.002419017299
              std dev =       0.658182847510
             le_variance =       0.433204660756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269764076
                                         uncertainty =       0.001875629901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269764076
                                         uncertainty =       0.001875629901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405568
  error estimate for blocks of size 2^( 2) =       0.000491168465
  error estimate for blocks of size 2^( 3) =       0.000515224892
  error estimate for blocks of size 2^( 4) =       0.000533169983
  error estimate for blocks of size 2^( 5) =       0.000545242955
  error estimate for blocks of size 2^( 6) =       0.000551867875
  error estimate for blocks of size 2^( 7) =       0.000553736243

      target function =      -0.748674695555
              le_mean =     -22.814787108505
             les_mean =     520.960486050318
             stat err =       0.000546004264
             autocorr =       1.376350103756
   target nu stat err =       0.000546004264
   target dn stat err =       0.002815138328
      target stat err =       0.002418993482
              std dev =       0.658182865862
             le_variance =       0.433204684915


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748674670025        initial
     1.5625e+02     1.5625e+03             9.7966e-07        -0.748675025704  <--
     6.2500e+02     6.2500e+03             2.4497e-07        -0.748674861579
     2.5000e+03     2.5000e+04             6.1245e-08        -0.748674695555

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 7.1443e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.273140e-01 3 1  ON 0
ci_02                -2.888617e-02 3 1  ON 1
ci_03                -2.899688e-02 3 1  ON 2
ci_04                 2.691751e-02 3 1  ON 3
ci_05                -2.208228e-02 3 1  ON 4
ci_06                -2.179085e-02 3 1  ON 5
ci_07                 2.740027e-02 3 1  ON 6
ci_08                -5.570016e-03 3 1  ON 7
ci_09                -9.068926e-03 3 1  ON 8
ci_10                -8.354005e-03 3 1  ON 9
ci_11                 1.321618e-02 3 1  ON 10
ci_12                 6.941134e-03 3 1  ON 11
ci_13                 1.283325e-02 3 1  ON 12
ci_14                 1.270753e-02 3 1  ON 13
ci_15                 6.272112e-03 3 1  ON 14
ci_16                 6.431747e-03 3 1  ON 15
ci_17                -7.255431e-03 3 1  ON 16
ci_18                -5.947995e-03 3 1  ON 17
ci_19                 9.299463e-03 3 1  ON 18
ci_20                 6.398116e-03 3 1  ON 19
ci_21                 8.999765e-03 3 1  ON 20
ci_22                 8.260653e-03 3 1  ON 21
ci_23                 4.757824e-03 3 1  ON 22
ci_24                 3.982448e-03 3 1  ON 23
ci_25                 2.845391e-03 3 1  ON 24
ci_26                 3.145474e-03 3 1  ON 25
ci_27                 3.328945e-03 3 1  ON 26
ci_28                 1.923381e-03 3 1  ON 27
ci_29                 1.298248e-03 3 1  ON 28
ci_30                -1.841321e-03 3 1  ON 29
ci_31                -5.582353e-04 3 1  ON 30
ci_32                -8.425818e-04 3 1  ON 31
ci_33                -1.476995e-03 3 1  ON 32
ci_34                 1.136285e-03 3 1  ON 33
ci_35                 1.469085e-03 3 1  ON 34
ci_36                -1.019619e-03 3 1  ON 35
ci_37                -1.032393e-03 3 1  ON 36
ci_38                -7.710482e-04 3 1  ON 37
ci_39                -6.251143e-04 3 1  ON 38
ci_40                -1.568990e-03 3 1  ON 39
ci_41                -1.247853e-03 3 1  ON 40
ci_42                -1.168491e-03 3 1  ON 41
ci_43                -2.487678e-03 3 1  ON 42
ci_44                -3.259436e-03 3 1  ON 43
ci_45                -5.333414e-04 3 1  ON 44
ci_46                -8.746374e-04 3 1  ON 45
ci_47                 1.539822e-03 3 1  ON 46
ci_48                 1.376162e-03 3 1  ON 47
ci_49                -1.048400e-03 3 1  ON 48
ci_50                -8.112968e-04 3 1  ON 49
ci_51                 1.482909e-04 3 1  ON 50
ci_52                 8.293708e-05 3 1  ON 51
ci_53                -6.341991e-04 3 1  ON 52
ci_54                -1.030366e-03 3 1  ON 53
ci_55                -6.529766e-04 3 1  ON 54
ci_56                 2.631777e-03 3 1  ON 55
ci_57                 1.620040e-03 3 1  ON 56
ci_58                -1.118132e-03 3 1  ON 57
ci_59                -1.472804e-03 3 1  ON 58
ci_60                 5.425336e-04 3 1  ON 59
ci_61                -1.242975e-04 3 1  ON 60
ci_62                -6.663686e-04 3 1  ON 61
ci_63                -7.742644e-04 3 1  ON 62
ci_64                -2.616653e-04 3 1  ON 63
ci_65                 6.520708e-05 3 1  ON 64
ci_66                -7.150664e-04 3 1  ON 65
ci_67                -9.006406e-04 3 1  ON 66
ci_68                -1.382302e-03 3 1  ON 67
ci_69                 1.435545e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2353e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2804e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8083
    reference variance = 0.259809
====================================================
  Execution time = 4.4894e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5370e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4791e-01
  Total weights = 1.964543031e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443151620
                                         uncertainty =       0.001824398739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433443151620
                                         uncertainty =       0.001824398739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465545643
  error estimate for blocks of size 2^( 2) =       0.000490853722
  error estimate for blocks of size 2^( 3) =       0.000515216537
  error estimate for blocks of size 2^( 4) =       0.000533632044
  error estimate for blocks of size 2^( 5) =       0.000544695513
  error estimate for blocks of size 2^( 6) =       0.000550224310
  error estimate for blocks of size 2^( 7) =       0.000552104148

      target function =      -0.747056365642
              le_mean =     -22.813631643573
             les_mean =     520.909702488106
             stat err =       0.000545164004
             autocorr =       1.371291584151
   target nu stat err =       0.000545164004
   target dn stat err =       0.002707277078
      target stat err =       0.002318297401
              std dev =       0.658380962822
             le_variance =       0.433465492206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281363164357e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747062601067       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747063103655       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747063149825       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747063167085       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747063170644       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747063169940       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747063170992       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747063171491       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747063171783       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747063171830       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 4.521771e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747062601067       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747062726837       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747062738384       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747062742701       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747062743591       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747062743415       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747062743678       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747062743802       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747062743875       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747062743887       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.131373e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747062601067       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747062632517       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747062635404       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747062636484       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747062636706       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747062636662       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747062636728       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747062636759       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747062636777       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747062636780       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 2.829016e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2550e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.273135e-01 3 1  ON 0
ci_02                -2.888548e-02 3 1  ON 1
ci_03                -2.899674e-02 3 1  ON 2
ci_04                 2.691746e-02 3 1  ON 3
ci_05                -2.208139e-02 3 1  ON 4
ci_06                -2.179042e-02 3 1  ON 5
ci_07                 2.740004e-02 3 1  ON 6
ci_08                -5.570033e-03 3 1  ON 7
ci_09                -9.068741e-03 3 1  ON 8
ci_10                -8.354209e-03 3 1  ON 9
ci_11                 1.321595e-02 3 1  ON 10
ci_12                 6.941235e-03 3 1  ON 11
ci_13                 1.283315e-02 3 1  ON 12
ci_14                 1.270723e-02 3 1  ON 13
ci_15                 6.272405e-03 3 1  ON 14
ci_16                 6.431644e-03 3 1  ON 15
ci_17                -7.254300e-03 3 1  ON 16
ci_18                -5.947795e-03 3 1  ON 17
ci_19                 9.299447e-03 3 1  ON 18
ci_20                 6.397307e-03 3 1  ON 19
ci_21                 9.000046e-03 3 1  ON 20
ci_22                 8.260950e-03 3 1  ON 21
ci_23                 4.757832e-03 3 1  ON 22
ci_24                 3.982617e-03 3 1  ON 23
ci_25                 2.845430e-03 3 1  ON 24
ci_26                 3.145351e-03 3 1  ON 25
ci_27                 3.329155e-03 3 1  ON 26
ci_28                 1.923534e-03 3 1  ON 27
ci_29                 1.298125e-03 3 1  ON 28
ci_30                -1.840824e-03 3 1  ON 29
ci_31                -5.584870e-04 3 1  ON 30
ci_32                -8.423690e-04 3 1  ON 31
ci_33                -1.476573e-03 3 1  ON 32
ci_34                 1.135904e-03 3 1  ON 33
ci_35                 1.468815e-03 3 1  ON 34
ci_36                -1.019879e-03 3 1  ON 35
ci_37                -1.032324e-03 3 1  ON 36
ci_38                -7.713887e-04 3 1  ON 37
ci_39                -6.252915e-04 3 1  ON 38
ci_40                -1.569203e-03 3 1  ON 39
ci_41                -1.247585e-03 3 1  ON 40
ci_42                -1.167672e-03 3 1  ON 41
ci_43                -2.487621e-03 3 1  ON 42
ci_44                -3.259526e-03 3 1  ON 43
ci_45                -5.334313e-04 3 1  ON 44
ci_46                -8.745934e-04 3 1  ON 45
ci_47                 1.539680e-03 3 1  ON 46
ci_48                 1.376433e-03 3 1  ON 47
ci_49                -1.048089e-03 3 1  ON 48
ci_50                -8.112974e-04 3 1  ON 49
ci_51                 1.484142e-04 3 1  ON 50
ci_52                 8.302752e-05 3 1  ON 51
ci_53                -6.342085e-04 3 1  ON 52
ci_54                -1.030312e-03 3 1  ON 53
ci_55                -6.528567e-04 3 1  ON 54
ci_56                 2.631285e-03 3 1  ON 55
ci_57                 1.620224e-03 3 1  ON 56
ci_58                -1.117831e-03 3 1  ON 57
ci_59                -1.472263e-03 3 1  ON 58
ci_60                 5.423860e-04 3 1  ON 59
ci_61                -1.247675e-04 3 1  ON 60
ci_62                -6.665264e-04 3 1  ON 61
ci_63                -7.741101e-04 3 1  ON 62
ci_64                -2.621389e-04 3 1  ON 63
ci_65                 6.534611e-05 3 1  ON 64
ci_66                -7.151052e-04 3 1  ON 65
ci_67                -9.006129e-04 3 1  ON 66
ci_68                -1.382378e-03 3 1  ON 67
ci_69                 1.430018e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8937
    reference variance = 0.423065
====================================================
  Execution time = 4.1597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5168e-01
  Total weights = 1.9642e+06
  Execution time = 5.9701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892013342
                                         uncertainty =       0.003182331966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892013342
                                         uncertainty =       0.003182331966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468399628
  error estimate for blocks of size 2^( 2) =       0.000493673091
  error estimate for blocks of size 2^( 3) =       0.000517483706
  error estimate for blocks of size 2^( 4) =       0.000534882225
  error estimate for blocks of size 2^( 5) =       0.000544660953
  error estimate for blocks of size 2^( 6) =       0.000550215002
  error estimate for blocks of size 2^( 7) =       0.000552999451

      target function =      -0.743959206547
              le_mean =     -22.815125926814
             les_mean =     520.981647012688
             stat err =       0.000545689408
             autocorr =       1.357244107794
   target nu stat err =       0.000545689408
   target dn stat err =       0.003564677437
      target stat err =       0.002990801323
              std dev =       0.662417106639
             le_variance =       0.438796423168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891257964
                                         uncertainty =       0.003182181967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891257964
                                         uncertainty =       0.003182181967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468399225
  error estimate for blocks of size 2^( 2) =       0.000493672859
  error estimate for blocks of size 2^( 3) =       0.000517483597
  error estimate for blocks of size 2^( 4) =       0.000534882188
  error estimate for blocks of size 2^( 5) =       0.000544660909
  error estimate for blocks of size 2^( 6) =       0.000550214904
  error estimate for blocks of size 2^( 7) =       0.000552999389

      target function =      -0.743954527012
              le_mean =     -22.815125936796
             les_mean =     520.981653162084
             stat err =       0.000545689348
             autocorr =       1.357246140853
   target nu stat err =       0.000545689348
   target dn stat err =       0.003564749857
      target stat err =       0.002990822788
              std dev =       0.662416537195
             le_variance =       0.438795668750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891634854
                                         uncertainty =       0.003182256879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891634854
                                         uncertainty =       0.003182256879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468399426
  error estimate for blocks of size 2^( 2) =       0.000493672975
  error estimate for blocks of size 2^( 3) =       0.000517483651
  error estimate for blocks of size 2^( 4) =       0.000534882207
  error estimate for blocks of size 2^( 5) =       0.000544660931
  error estimate for blocks of size 2^( 6) =       0.000550214953
  error estimate for blocks of size 2^( 7) =       0.000552999420

      target function =      -0.743956935383
              le_mean =     -22.815125931756
             les_mean =     520.981650001683
             stat err =       0.000545689377
             autocorr =       1.357245125527
   target nu stat err =       0.000545689377
   target dn stat err =       0.003564712896
      target stat err =       0.002990811991
              std dev =       0.662416821314
             le_variance =       0.438796045160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891965972
                                         uncertainty =       0.003182322576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891965972
                                         uncertainty =       0.003182322576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468399603
  error estimate for blocks of size 2^( 2) =       0.000493673077
  error estimate for blocks of size 2^( 3) =       0.000517483699
  error estimate for blocks of size 2^( 4) =       0.000534882223
  error estimate for blocks of size 2^( 5) =       0.000544660950
  error estimate for blocks of size 2^( 6) =       0.000550214996
  error estimate for blocks of size 2^( 7) =       0.000552999447

      target function =      -0.743958929847
              le_mean =     -22.815125927426
             les_mean =     520.981647377299
             stat err =       0.000545689404
             autocorr =       1.357244235063
   target nu stat err =       0.000545689404
   target dn stat err =       0.003564681790
      target stat err =       0.002990802649
              std dev =       0.662417070929
             le_variance =       0.438796375859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743959206547        initial  <--
     3.9062e+01     3.9062e+02             4.5218e-06        -0.743954527012
     1.5625e+02     1.5625e+03             1.1314e-06        -0.743956935383
     6.2500e+02     6.2500e+03             2.8290e-07        -0.743958929847

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.2477
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.273140e-01 3 1  ON 0
ci_02                -2.888617e-02 3 1  ON 1
ci_03                -2.899688e-02 3 1  ON 2
ci_04                 2.691751e-02 3 1  ON 3
ci_05                -2.208228e-02 3 1  ON 4
ci_06                -2.179085e-02 3 1  ON 5
ci_07                 2.740027e-02 3 1  ON 6
ci_08                -5.570016e-03 3 1  ON 7
ci_09                -9.068926e-03 3 1  ON 8
ci_10                -8.354005e-03 3 1  ON 9
ci_11                 1.321618e-02 3 1  ON 10
ci_12                 6.941134e-03 3 1  ON 11
ci_13                 1.283325e-02 3 1  ON 12
ci_14                 1.270753e-02 3 1  ON 13
ci_15                 6.272112e-03 3 1  ON 14
ci_16                 6.431747e-03 3 1  ON 15
ci_17                -7.255431e-03 3 1  ON 16
ci_18                -5.947995e-03 3 1  ON 17
ci_19                 9.299463e-03 3 1  ON 18
ci_20                 6.398116e-03 3 1  ON 19
ci_21                 8.999765e-03 3 1  ON 20
ci_22                 8.260653e-03 3 1  ON 21
ci_23                 4.757824e-03 3 1  ON 22
ci_24                 3.982448e-03 3 1  ON 23
ci_25                 2.845391e-03 3 1  ON 24
ci_26                 3.145474e-03 3 1  ON 25
ci_27                 3.328945e-03 3 1  ON 26
ci_28                 1.923381e-03 3 1  ON 27
ci_29                 1.298248e-03 3 1  ON 28
ci_30                -1.841321e-03 3 1  ON 29
ci_31                -5.582353e-04 3 1  ON 30
ci_32                -8.425818e-04 3 1  ON 31
ci_33                -1.476995e-03 3 1  ON 32
ci_34                 1.136285e-03 3 1  ON 33
ci_35                 1.469085e-03 3 1  ON 34
ci_36                -1.019619e-03 3 1  ON 35
ci_37                -1.032393e-03 3 1  ON 36
ci_38                -7.710482e-04 3 1  ON 37
ci_39                -6.251143e-04 3 1  ON 38
ci_40                -1.568990e-03 3 1  ON 39
ci_41                -1.247853e-03 3 1  ON 40
ci_42                -1.168491e-03 3 1  ON 41
ci_43                -2.487678e-03 3 1  ON 42
ci_44                -3.259436e-03 3 1  ON 43
ci_45                -5.333414e-04 3 1  ON 44
ci_46                -8.746374e-04 3 1  ON 45
ci_47                 1.539822e-03 3 1  ON 46
ci_48                 1.376162e-03 3 1  ON 47
ci_49                -1.048400e-03 3 1  ON 48
ci_50                -8.112968e-04 3 1  ON 49
ci_51                 1.482909e-04 3 1  ON 50
ci_52                 8.293708e-05 3 1  ON 51
ci_53                -6.341991e-04 3 1  ON 52
ci_54                -1.030366e-03 3 1  ON 53
ci_55                -6.529766e-04 3 1  ON 54
ci_56                 2.631777e-03 3 1  ON 55
ci_57                 1.620040e-03 3 1  ON 56
ci_58                -1.118132e-03 3 1  ON 57
ci_59                -1.472804e-03 3 1  ON 58
ci_60                 5.425336e-04 3 1  ON 59
ci_61                -1.242975e-04 3 1  ON 60
ci_62                -6.663686e-04 3 1  ON 61
ci_63                -7.742644e-04 3 1  ON 62
ci_64                -2.616653e-04 3 1  ON 63
ci_65                 6.520708e-05 3 1  ON 64
ci_66                -7.150664e-04 3 1  ON 65
ci_67                -9.006406e-04 3 1  ON 66
ci_68                -1.382302e-03 3 1  ON 67
ci_69                 1.435545e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2389e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8212
    reference variance = 0.343156
====================================================
  Execution time = 4.3309e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4547e-01
  Total weights = 1.964267442e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431928021385
                                         uncertainty =       0.001758075171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431928021385
                                         uncertainty =       0.001758075171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464700532
  error estimate for blocks of size 2^( 2) =       0.000489819190
  error estimate for blocks of size 2^( 3) =       0.000514020170
  error estimate for blocks of size 2^( 4) =       0.000531924084
  error estimate for blocks of size 2^( 5) =       0.000542781211
  error estimate for blocks of size 2^( 6) =       0.000549395663
  error estimate for blocks of size 2^( 7) =       0.000554916699

      target function =      -0.749101187612
              le_mean =     -22.815262596440
             les_mean =     520.981677194223
             stat err =       0.000544754414
             autocorr =       1.374216555040
   target nu stat err =       0.000544754414
   target dn stat err =       0.002589779707
      target stat err =       0.002241679515
              std dev =       0.657185795450
             le_variance =       0.431893169742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281526259644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749106949339       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749106989557       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749106992032       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749106992923       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749106993733       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749106993906       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749106993868       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749106993899       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749106993916       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749106993913       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 4.586160e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749106949339       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749106959395       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749106960013       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749106960236       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749106960439       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749106960482       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749106960472       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749106960480       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749106960484       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749106960479       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 1.146595e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749106949339       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749106951853       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749106952008       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749106952063       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749106952114       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749106952125       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749106952122       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749106952124       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749106952125       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749106952126       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 2.866520e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0965e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.273139e-01 3 1  ON 0
ci_02                -2.888613e-02 3 1  ON 1
ci_03                -2.899688e-02 3 1  ON 2
ci_04                 2.691741e-02 3 1  ON 3
ci_05                -2.208228e-02 3 1  ON 4
ci_06                -2.179079e-02 3 1  ON 5
ci_07                 2.740024e-02 3 1  ON 6
ci_08                -5.570037e-03 3 1  ON 7
ci_09                -9.068911e-03 3 1  ON 8
ci_10                -8.353995e-03 3 1  ON 9
ci_11                 1.321616e-02 3 1  ON 10
ci_12                 6.941156e-03 3 1  ON 11
ci_13                 1.283328e-02 3 1  ON 12
ci_14                 1.270758e-02 3 1  ON 13
ci_15                 6.272102e-03 3 1  ON 14
ci_16                 6.431762e-03 3 1  ON 15
ci_17                -7.255432e-03 3 1  ON 16
ci_18                -5.947989e-03 3 1  ON 17
ci_19                 9.299466e-03 3 1  ON 18
ci_20                 6.398111e-03 3 1  ON 19
ci_21                 8.999760e-03 3 1  ON 20
ci_22                 8.260621e-03 3 1  ON 21
ci_23                 4.757876e-03 3 1  ON 22
ci_24                 3.982462e-03 3 1  ON 23
ci_25                 2.845412e-03 3 1  ON 24
ci_26                 3.145511e-03 3 1  ON 25
ci_27                 3.328930e-03 3 1  ON 26
ci_28                 1.923323e-03 3 1  ON 27
ci_29                 1.298261e-03 3 1  ON 28
ci_30                -1.841324e-03 3 1  ON 29
ci_31                -5.582651e-04 3 1  ON 30
ci_32                -8.425918e-04 3 1  ON 31
ci_33                -1.476987e-03 3 1  ON 32
ci_34                 1.136285e-03 3 1  ON 33
ci_35                 1.469100e-03 3 1  ON 34
ci_36                -1.019584e-03 3 1  ON 35
ci_37                -1.032395e-03 3 1  ON 36
ci_38                -7.710317e-04 3 1  ON 37
ci_39                -6.251107e-04 3 1  ON 38
ci_40                -1.568994e-03 3 1  ON 39
ci_41                -1.247863e-03 3 1  ON 40
ci_42                -1.168502e-03 3 1  ON 41
ci_43                -2.487651e-03 3 1  ON 42
ci_44                -3.259337e-03 3 1  ON 43
ci_45                -5.333346e-04 3 1  ON 44
ci_46                -8.746449e-04 3 1  ON 45
ci_47                 1.539835e-03 3 1  ON 46
ci_48                 1.376148e-03 3 1  ON 47
ci_49                -1.048383e-03 3 1  ON 48
ci_50                -8.113105e-04 3 1  ON 49
ci_51                 1.482696e-04 3 1  ON 50
ci_52                 8.295080e-05 3 1  ON 51
ci_53                -6.341809e-04 3 1  ON 52
ci_54                -1.030322e-03 3 1  ON 53
ci_55                -6.529729e-04 3 1  ON 54
ci_56                 2.631735e-03 3 1  ON 55
ci_57                 1.620064e-03 3 1  ON 56
ci_58                -1.118118e-03 3 1  ON 57
ci_59                -1.472773e-03 3 1  ON 58
ci_60                 5.425721e-04 3 1  ON 59
ci_61                -1.243111e-04 3 1  ON 60
ci_62                -6.663567e-04 3 1  ON 61
ci_63                -7.742305e-04 3 1  ON 62
ci_64                -2.616789e-04 3 1  ON 63
ci_65                 6.520716e-05 3 1  ON 64
ci_66                -7.150819e-04 3 1  ON 65
ci_67                -9.005868e-04 3 1  ON 66
ci_68                -1.382320e-03 3 1  ON 67
ci_69                 1.434852e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8887
    reference variance = 0.269826
====================================================
  Execution time = 4.4193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4568e-01
  Total weights = 1.9643e+06
  Execution time = 5.9187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434077904094
                                         uncertainty =       0.002025912527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434077904094
                                         uncertainty =       0.002025912527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465850379
  error estimate for blocks of size 2^( 2) =       0.000491343214
  error estimate for blocks of size 2^( 3) =       0.000515187777
  error estimate for blocks of size 2^( 4) =       0.000533583342
  error estimate for blocks of size 2^( 5) =       0.000545100645
  error estimate for blocks of size 2^( 6) =       0.000552433272
  error estimate for blocks of size 2^( 7) =       0.000555746454

      target function =      -0.748927953292
              le_mean =     -22.815081405256
             les_mean =     520.973614949657
             stat err =       0.000546715928
             autocorr =       1.377306343832
   target nu stat err =       0.000546715928
   target dn stat err =       0.002635190747
      target stat err =       0.002277089925
              std dev =       0.658811923671
             le_variance =       0.434033150771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434077876256
                                         uncertainty =       0.002025915327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434077876256
                                         uncertainty =       0.002025915327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465850364
  error estimate for blocks of size 2^( 2) =       0.000491343213
  error estimate for blocks of size 2^( 3) =       0.000515187790
  error estimate for blocks of size 2^( 4) =       0.000533583363
  error estimate for blocks of size 2^( 5) =       0.000545100672
  error estimate for blocks of size 2^( 6) =       0.000552433301
  error estimate for blocks of size 2^( 7) =       0.000555746489

      target function =      -0.748927538814
              le_mean =     -22.815081403790
             les_mean =     520.973615380397
             stat err =       0.000546715957
             autocorr =       1.377306574977
   target nu stat err =       0.000546715957
   target dn stat err =       0.002635203106
      target stat err =       0.002277097416
              std dev =       0.658811902715
             le_variance =       0.434033123158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434077890170
                                         uncertainty =       0.002025913927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434077890170
                                         uncertainty =       0.002025913927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465850371
  error estimate for blocks of size 2^( 2) =       0.000491343214
  error estimate for blocks of size 2^( 3) =       0.000515187783
  error estimate for blocks of size 2^( 4) =       0.000533583352
  error estimate for blocks of size 2^( 5) =       0.000545100659
  error estimate for blocks of size 2^( 6) =       0.000552433287
  error estimate for blocks of size 2^( 7) =       0.000555746471

      target function =      -0.748927751498
              le_mean =     -22.815081404522
             les_mean =     520.973615158450
             stat err =       0.000546715942
             autocorr =       1.377306459413
   target nu stat err =       0.000546715942
   target dn stat err =       0.002635196922
      target stat err =       0.002277093698
              std dev =       0.658811913189
             le_variance =       0.434033136960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434077902353
                                         uncertainty =       0.002025912702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434077902353
                                         uncertainty =       0.002025912702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465850378
  error estimate for blocks of size 2^( 2) =       0.000491343214
  error estimate for blocks of size 2^( 3) =       0.000515187778
  error estimate for blocks of size 2^( 4) =       0.000533583343
  error estimate for blocks of size 2^( 5) =       0.000545100647
  error estimate for blocks of size 2^( 6) =       0.000552433274
  error estimate for blocks of size 2^( 7) =       0.000555746456

      target function =      -0.748927928627
              le_mean =     -22.815081405164
             les_mean =     520.973614975080
             stat err =       0.000546715930
             autocorr =       1.377306358285
   target nu stat err =       0.000546715930
   target dn stat err =       0.002635191518
      target stat err =       0.002277090399
              std dev =       0.658811922360
             le_variance =       0.434033149044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748927953292        initial  <--
     3.9062e+02     3.9062e+03             4.5862e-07        -0.748927538814
     1.5625e+03     1.5625e+04             1.1466e-07        -0.748927751498
     6.2500e+03     6.2500e+04             2.8665e-08        -0.748927928627

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 74.0163
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.273140e-01 3 1  ON 0
ci_02                -2.888617e-02 3 1  ON 1
ci_03                -2.899688e-02 3 1  ON 2
ci_04                 2.691751e-02 3 1  ON 3
ci_05                -2.208228e-02 3 1  ON 4
ci_06                -2.179085e-02 3 1  ON 5
ci_07                 2.740027e-02 3 1  ON 6
ci_08                -5.570016e-03 3 1  ON 7
ci_09                -9.068926e-03 3 1  ON 8
ci_10                -8.354005e-03 3 1  ON 9
ci_11                 1.321618e-02 3 1  ON 10
ci_12                 6.941134e-03 3 1  ON 11
ci_13                 1.283325e-02 3 1  ON 12
ci_14                 1.270753e-02 3 1  ON 13
ci_15                 6.272112e-03 3 1  ON 14
ci_16                 6.431747e-03 3 1  ON 15
ci_17                -7.255431e-03 3 1  ON 16
ci_18                -5.947995e-03 3 1  ON 17
ci_19                 9.299463e-03 3 1  ON 18
ci_20                 6.398116e-03 3 1  ON 19
ci_21                 8.999765e-03 3 1  ON 20
ci_22                 8.260653e-03 3 1  ON 21
ci_23                 4.757824e-03 3 1  ON 22
ci_24                 3.982448e-03 3 1  ON 23
ci_25                 2.845391e-03 3 1  ON 24
ci_26                 3.145474e-03 3 1  ON 25
ci_27                 3.328945e-03 3 1  ON 26
ci_28                 1.923381e-03 3 1  ON 27
ci_29                 1.298248e-03 3 1  ON 28
ci_30                -1.841321e-03 3 1  ON 29
ci_31                -5.582353e-04 3 1  ON 30
ci_32                -8.425818e-04 3 1  ON 31
ci_33                -1.476995e-03 3 1  ON 32
ci_34                 1.136285e-03 3 1  ON 33
ci_35                 1.469085e-03 3 1  ON 34
ci_36                -1.019619e-03 3 1  ON 35
ci_37                -1.032393e-03 3 1  ON 36
ci_38                -7.710482e-04 3 1  ON 37
ci_39                -6.251143e-04 3 1  ON 38
ci_40                -1.568990e-03 3 1  ON 39
ci_41                -1.247853e-03 3 1  ON 40
ci_42                -1.168491e-03 3 1  ON 41
ci_43                -2.487678e-03 3 1  ON 42
ci_44                -3.259436e-03 3 1  ON 43
ci_45                -5.333414e-04 3 1  ON 44
ci_46                -8.746374e-04 3 1  ON 45
ci_47                 1.539822e-03 3 1  ON 46
ci_48                 1.376162e-03 3 1  ON 47
ci_49                -1.048400e-03 3 1  ON 48
ci_50                -8.112968e-04 3 1  ON 49
ci_51                 1.482909e-04 3 1  ON 50
ci_52                 8.293708e-05 3 1  ON 51
ci_53                -6.341991e-04 3 1  ON 52
ci_54                -1.030366e-03 3 1  ON 53
ci_55                -6.529766e-04 3 1  ON 54
ci_56                 2.631777e-03 3 1  ON 55
ci_57                 1.620040e-03 3 1  ON 56
ci_58                -1.118132e-03 3 1  ON 57
ci_59                -1.472804e-03 3 1  ON 58
ci_60                 5.425336e-04 3 1  ON 59
ci_61                -1.242975e-04 3 1  ON 60
ci_62                -6.663686e-04 3 1  ON 61
ci_63                -7.742644e-04 3 1  ON 62
ci_64                -2.616653e-04 3 1  ON 63
ci_65                 6.520708e-05 3 1  ON 64
ci_66                -7.150664e-04 3 1  ON 65
ci_67                -9.006406e-04 3 1  ON 66
ci_68                -1.382302e-03 3 1  ON 67
ci_69                 1.435545e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2499e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8766
    reference variance = 0.304911
====================================================
  Execution time = 4.2758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4358e-01
  Total weights = 1.964452244e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429737961860
                                         uncertainty =       0.001692788652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429737961860
                                         uncertainty =       0.001692788652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463514129
  error estimate for blocks of size 2^( 2) =       0.000489137170
  error estimate for blocks of size 2^( 3) =       0.000513104403
  error estimate for blocks of size 2^( 4) =       0.000530676420
  error estimate for blocks of size 2^( 5) =       0.000542017129
  error estimate for blocks of size 2^( 6) =       0.000548427399
  error estimate for blocks of size 2^( 7) =       0.000552834675

      target function =      -0.750672439105
              le_mean =     -22.814830130839
             les_mean =     520.960051077423
             stat err =       0.000543488906
             autocorr =       1.374850299955
   target nu stat err =       0.000543488906
   target dn stat err =       0.003307395217
      target stat err =       0.002831546908
              std dev =       0.655507967401
             le_variance =       0.429690695326


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281483013084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750682111744       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750682114001       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750682114373       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750682114447       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750682114450       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750682114459       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750682114450       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750682114455       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750682114449       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750682114455       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 3.329574e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750682111744       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750682112308       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750682112402       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750682112421       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750682112421       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750682112422       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750682112403       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750682112434       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750682112414       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750682112415       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 8.324002e-09

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750682111744       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750682111885       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750682111909       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750682111902       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750682111879       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750682111919       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750682111868       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750682111934       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750682111857       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750682111981       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+04 is 2.081005e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0436e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.273140e-01 3 1  ON 0
ci_02                -2.888616e-02 3 1  ON 1
ci_03                -2.899688e-02 3 1  ON 2
ci_04                 2.691751e-02 3 1  ON 3
ci_05                -2.208227e-02 3 1  ON 4
ci_06                -2.179084e-02 3 1  ON 5
ci_07                 2.740028e-02 3 1  ON 6
ci_08                -5.570014e-03 3 1  ON 7
ci_09                -9.068921e-03 3 1  ON 8
ci_10                -8.354004e-03 3 1  ON 9
ci_11                 1.321617e-02 3 1  ON 10
ci_12                 6.941131e-03 3 1  ON 11
ci_13                 1.283326e-02 3 1  ON 12
ci_14                 1.270753e-02 3 1  ON 13
ci_15                 6.272114e-03 3 1  ON 14
ci_16                 6.431746e-03 3 1  ON 15
ci_17                -7.255424e-03 3 1  ON 16
ci_18                -5.947995e-03 3 1  ON 17
ci_19                 9.299461e-03 3 1  ON 18
ci_20                 6.398117e-03 3 1  ON 19
ci_21                 8.999763e-03 3 1  ON 20
ci_22                 8.260655e-03 3 1  ON 21
ci_23                 4.757821e-03 3 1  ON 22
ci_24                 3.982452e-03 3 1  ON 23
ci_25                 2.845389e-03 3 1  ON 24
ci_26                 3.145473e-03 3 1  ON 25
ci_27                 3.328945e-03 3 1  ON 26
ci_28                 1.923379e-03 3 1  ON 27
ci_29                 1.298250e-03 3 1  ON 28
ci_30                -1.841319e-03 3 1  ON 29
ci_31                -5.582352e-04 3 1  ON 30
ci_32                -8.425843e-04 3 1  ON 31
ci_33                -1.476993e-03 3 1  ON 32
ci_34                 1.136289e-03 3 1  ON 33
ci_35                 1.469089e-03 3 1  ON 34
ci_36                -1.019618e-03 3 1  ON 35
ci_37                -1.032393e-03 3 1  ON 36
ci_38                -7.710482e-04 3 1  ON 37
ci_39                -6.251120e-04 3 1  ON 38
ci_40                -1.568989e-03 3 1  ON 39
ci_41                -1.247850e-03 3 1  ON 40
ci_42                -1.168490e-03 3 1  ON 41
ci_43                -2.487677e-03 3 1  ON 42
ci_44                -3.259434e-03 3 1  ON 43
ci_45                -5.333418e-04 3 1  ON 44
ci_46                -8.746388e-04 3 1  ON 45
ci_47                 1.539824e-03 3 1  ON 46
ci_48                 1.376166e-03 3 1  ON 47
ci_49                -1.048399e-03 3 1  ON 48
ci_50                -8.112968e-04 3 1  ON 49
ci_51                 1.482941e-04 3 1  ON 50
ci_52                 8.293739e-05 3 1  ON 51
ci_53                -6.341995e-04 3 1  ON 52
ci_54                -1.030366e-03 3 1  ON 53
ci_55                -6.529804e-04 3 1  ON 54
ci_56                 2.631776e-03 3 1  ON 55
ci_57                 1.620042e-03 3 1  ON 56
ci_58                -1.118132e-03 3 1  ON 57
ci_59                -1.472803e-03 3 1  ON 58
ci_60                 5.425360e-04 3 1  ON 59
ci_61                -1.242917e-04 3 1  ON 60
ci_62                -6.663655e-04 3 1  ON 61
ci_63                -7.742632e-04 3 1  ON 62
ci_64                -2.616645e-04 3 1  ON 63
ci_65                 6.520445e-05 3 1  ON 64
ci_66                -7.150673e-04 3 1  ON 65
ci_67                -9.006392e-04 3 1  ON 66
ci_68                -1.382301e-03 3 1  ON 67
ci_69                 1.435477e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8535
    reference variance = 0.346035
====================================================
  Execution time = 4.2926e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4737e-01
  Total weights = 1.9646e+06
  Execution time = 5.9739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434837828725
                                         uncertainty =       0.002103255998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434837828725
                                         uncertainty =       0.002103255998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466252924
  error estimate for blocks of size 2^( 2) =       0.000491764418
  error estimate for blocks of size 2^( 3) =       0.000516034545
  error estimate for blocks of size 2^( 4) =       0.000534155802
  error estimate for blocks of size 2^( 5) =       0.000545022628
  error estimate for blocks of size 2^( 6) =       0.000550346040
  error estimate for blocks of size 2^( 7) =       0.000554221320

      target function =      -0.747515144806
              le_mean =     -22.814603566441
             les_mean =     520.953504509716
             stat err =       0.000545936447
             autocorr =       1.371011325694
   target nu stat err =       0.000545936447
   target dn stat err =       0.002955709639
      target stat err =       0.002524040444
              std dev =       0.659381208155
             le_variance =       0.434783577667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434837828343
                                         uncertainty =       0.002103257138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434837828343
                                         uncertainty =       0.002103257138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466252923
  error estimate for blocks of size 2^( 2) =       0.000491764420
  error estimate for blocks of size 2^( 3) =       0.000516034548
  error estimate for blocks of size 2^( 4) =       0.000534155805
  error estimate for blocks of size 2^( 5) =       0.000545022632
  error estimate for blocks of size 2^( 6) =       0.000550346044
  error estimate for blocks of size 2^( 7) =       0.000554221324

      target function =      -0.747515228611
              le_mean =     -22.814603566355
             les_mean =     520.953504404696
             stat err =       0.000545936451
             autocorr =       1.371011347234
   target nu stat err =       0.000545936451
   target dn stat err =       0.002955711150
      target stat err =       0.002524042211
              std dev =       0.659381207856
             le_variance =       0.434783577273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434837828534
                                         uncertainty =       0.002103256568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434837828534
                                         uncertainty =       0.002103256568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466252924
  error estimate for blocks of size 2^( 2) =       0.000491764419
  error estimate for blocks of size 2^( 3) =       0.000516034546
  error estimate for blocks of size 2^( 4) =       0.000534155803
  error estimate for blocks of size 2^( 5) =       0.000545022630
  error estimate for blocks of size 2^( 6) =       0.000550346042
  error estimate for blocks of size 2^( 7) =       0.000554221322

      target function =      -0.747515186844
              le_mean =     -22.814603566398
             les_mean =     520.953504457042
             stat err =       0.000545936449
             autocorr =       1.371011336475
   target nu stat err =       0.000545936449
   target dn stat err =       0.002955710394
      target stat err =       0.002524041328
              std dev =       0.659381208005
             le_variance =       0.434783577470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434837828701
                                         uncertainty =       0.002103256069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434837828701
                                         uncertainty =       0.002103256069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466252924
  error estimate for blocks of size 2^( 2) =       0.000491764419
  error estimate for blocks of size 2^( 3) =       0.000516034545
  error estimate for blocks of size 2^( 4) =       0.000534155802
  error estimate for blocks of size 2^( 5) =       0.000545022628
  error estimate for blocks of size 2^( 6) =       0.000550346040
  error estimate for blocks of size 2^( 7) =       0.000554221320

      target function =      -0.747515150076
              le_mean =     -22.814603566435
             les_mean =     520.953504503114
             stat err =       0.000545936448
             autocorr =       1.371011327047
   target nu stat err =       0.000545936448
   target dn stat err =       0.002955709733
      target stat err =       0.002524040554
              std dev =       0.659381208136
             le_variance =       0.434783577643


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747515144806        initial
     3.9062e+03     3.9062e+04             3.3296e-08        -0.747515228611  <--
     1.5625e+04     1.5625e+05             8.3240e-09        -0.747515186844
     6.2500e+04     6.2500e+05             2.0810e-09        -0.747515150076

*****************************************************************************
Applying the update for shift_i =   3.9062e+03     and shift_s =   3.9062e+04
*****************************************************************************

  Execution time = 7.2583e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.273140e-01 3 1  ON 0
ci_02                -2.888616e-02 3 1  ON 1
ci_03                -2.899687e-02 3 1  ON 2
ci_04                 2.691750e-02 3 1  ON 3
ci_05                -2.208225e-02 3 1  ON 4
ci_06                -2.179083e-02 3 1  ON 5
ci_07                 2.740028e-02 3 1  ON 6
ci_08                -5.570008e-03 3 1  ON 7
ci_09                -9.068909e-03 3 1  ON 8
ci_10                -8.353998e-03 3 1  ON 9
ci_11                 1.321616e-02 3 1  ON 10
ci_12                 6.941122e-03 3 1  ON 11
ci_13                 1.283327e-02 3 1  ON 12
ci_14                 1.270753e-02 3 1  ON 13
ci_15                 6.272120e-03 3 1  ON 14
ci_16                 6.431744e-03 3 1  ON 15
ci_17                -7.255402e-03 3 1  ON 16
ci_18                -5.947995e-03 3 1  ON 17
ci_19                 9.299458e-03 3 1  ON 18
ci_20                 6.398119e-03 3 1  ON 19
ci_21                 8.999759e-03 3 1  ON 20
ci_22                 8.260661e-03 3 1  ON 21
ci_23                 4.757812e-03 3 1  ON 22
ci_24                 3.982463e-03 3 1  ON 23
ci_25                 2.845384e-03 3 1  ON 24
ci_26                 3.145469e-03 3 1  ON 25
ci_27                 3.328945e-03 3 1  ON 26
ci_28                 1.923373e-03 3 1  ON 27
ci_29                 1.298258e-03 3 1  ON 28
ci_30                -1.841314e-03 3 1  ON 29
ci_31                -5.582347e-04 3 1  ON 30
ci_32                -8.425917e-04 3 1  ON 31
ci_33                -1.476986e-03 3 1  ON 32
ci_34                 1.136299e-03 3 1  ON 33
ci_35                 1.469098e-03 3 1  ON 34
ci_36                -1.019615e-03 3 1  ON 35
ci_37                -1.032395e-03 3 1  ON 36
ci_38                -7.710483e-04 3 1  ON 37
ci_39                -6.251050e-04 3 1  ON 38
ci_40                -1.568985e-03 3 1  ON 39
ci_41                -1.247843e-03 3 1  ON 40
ci_42                -1.168487e-03 3 1  ON 41
ci_43                -2.487674e-03 3 1  ON 42
ci_44                -3.259427e-03 3 1  ON 43
ci_45                -5.333431e-04 3 1  ON 44
ci_46                -8.746430e-04 3 1  ON 45
ci_47                 1.539831e-03 3 1  ON 46
ci_48                 1.376177e-03 3 1  ON 47
ci_49                -1.048398e-03 3 1  ON 48
ci_50                -8.112967e-04 3 1  ON 49
ci_51                 1.483036e-04 3 1  ON 50
ci_52                 8.293834e-05 3 1  ON 51
ci_53                -6.342006e-04 3 1  ON 52
ci_54                -1.030363e-03 3 1  ON 53
ci_55                -6.529918e-04 3 1  ON 54
ci_56                 2.631773e-03 3 1  ON 55
ci_57                 1.620045e-03 3 1  ON 56
ci_58                -1.118134e-03 3 1  ON 57
ci_59                -1.472800e-03 3 1  ON 58
ci_60                 5.425434e-04 3 1  ON 59
ci_61                -1.242742e-04 3 1  ON 60
ci_62                -6.663563e-04 3 1  ON 61
ci_63                -7.742594e-04 3 1  ON 62
ci_64                -2.616619e-04 3 1  ON 63
ci_65                 6.519655e-05 3 1  ON 64
ci_66                -7.150700e-04 3 1  ON 65
ci_67                -9.006350e-04 3 1  ON 66
ci_68                -1.382301e-03 3 1  ON 67
ci_69                 1.435273e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2303e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8396
    reference variance = 0.290117
====================================================
  Execution time = 4.3489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5682e-01
  Total weights = 1.964231232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437585708356
                                         uncertainty =       0.002613137911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437585708356
                                         uncertainty =       0.002613137911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467762431
  error estimate for blocks of size 2^( 2) =       0.000493397263
  error estimate for blocks of size 2^( 3) =       0.000516851103
  error estimate for blocks of size 2^( 4) =       0.000534761468
  error estimate for blocks of size 2^( 5) =       0.000545672477
  error estimate for blocks of size 2^( 6) =       0.000551450533
  error estimate for blocks of size 2^( 7) =       0.000554601307

      target function =      -0.739698550826
              le_mean =     -22.815116239475
             les_mean =     520.986344333724
             stat err =       0.000546621446
             autocorr =       1.365597324621
   target nu stat err =       0.000546621446
   target dn stat err =       0.009030836439
      target stat err =       0.007361741767
              std dev =       0.661515974291
             le_variance =       0.437603384242


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281511623947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739770491276       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739770506742       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739770508711       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739770508998       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739770509062       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739770509077       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739770509059       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739770509073       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739770509081       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739770509075       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 1.629188e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739770491276       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739770495143       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739770495635       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739770495707       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739770495714       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739770495726       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739770495724       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739770495732       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739770495728       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739770495740       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 4.073105e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739770491276       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739770492243       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739770492366       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739770492384       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739770492399       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739770492419       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739770492406       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739770492386       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739770492409       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739770492404       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.018285e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1174e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.273139e-01 3 1  ON 0
ci_02                -2.888614e-02 3 1  ON 1
ci_03                -2.899684e-02 3 1  ON 2
ci_04                 2.691748e-02 3 1  ON 3
ci_05                -2.208223e-02 3 1  ON 4
ci_06                -2.179083e-02 3 1  ON 5
ci_07                 2.740026e-02 3 1  ON 6
ci_08                -5.570003e-03 3 1  ON 7
ci_09                -9.068898e-03 3 1  ON 8
ci_10                -8.353995e-03 3 1  ON 9
ci_11                 1.321614e-02 3 1  ON 10
ci_12                 6.941123e-03 3 1  ON 11
ci_13                 1.283327e-02 3 1  ON 12
ci_14                 1.270751e-02 3 1  ON 13
ci_15                 6.272124e-03 3 1  ON 14
ci_16                 6.431744e-03 3 1  ON 15
ci_17                -7.255372e-03 3 1  ON 16
ci_18                -5.947958e-03 3 1  ON 17
ci_19                 9.299479e-03 3 1  ON 18
ci_20                 6.398118e-03 3 1  ON 19
ci_21                 8.999760e-03 3 1  ON 20
ci_22                 8.260656e-03 3 1  ON 21
ci_23                 4.757817e-03 3 1  ON 22
ci_24                 3.982459e-03 3 1  ON 23
ci_25                 2.845383e-03 3 1  ON 24
ci_26                 3.145449e-03 3 1  ON 25
ci_27                 3.328939e-03 3 1  ON 26
ci_28                 1.923382e-03 3 1  ON 27
ci_29                 1.298253e-03 3 1  ON 28
ci_30                -1.841287e-03 3 1  ON 29
ci_31                -5.582427e-04 3 1  ON 30
ci_32                -8.425931e-04 3 1  ON 31
ci_33                -1.476981e-03 3 1  ON 32
ci_34                 1.136340e-03 3 1  ON 33
ci_35                 1.469107e-03 3 1  ON 34
ci_36                -1.019621e-03 3 1  ON 35
ci_37                -1.032398e-03 3 1  ON 36
ci_38                -7.710580e-04 3 1  ON 37
ci_39                -6.251092e-04 3 1  ON 38
ci_40                -1.568977e-03 3 1  ON 39
ci_41                -1.247835e-03 3 1  ON 40
ci_42                -1.168481e-03 3 1  ON 41
ci_43                -2.487667e-03 3 1  ON 42
ci_44                -3.259388e-03 3 1  ON 43
ci_45                -5.333451e-04 3 1  ON 44
ci_46                -8.746369e-04 3 1  ON 45
ci_47                 1.539836e-03 3 1  ON 46
ci_48                 1.376170e-03 3 1  ON 47
ci_49                -1.048394e-03 3 1  ON 48
ci_50                -8.112952e-04 3 1  ON 49
ci_51                 1.483033e-04 3 1  ON 50
ci_52                 8.293254e-05 3 1  ON 51
ci_53                -6.342053e-04 3 1  ON 52
ci_54                -1.030376e-03 3 1  ON 53
ci_55                -6.529897e-04 3 1  ON 54
ci_56                 2.631766e-03 3 1  ON 55
ci_57                 1.620052e-03 3 1  ON 56
ci_58                -1.118146e-03 3 1  ON 57
ci_59                -1.472799e-03 3 1  ON 58
ci_60                 5.425393e-04 3 1  ON 59
ci_61                -1.242847e-04 3 1  ON 60
ci_62                -6.663422e-04 3 1  ON 61
ci_63                -7.742572e-04 3 1  ON 62
ci_64                -2.616582e-04 3 1  ON 63
ci_65                 6.518294e-05 3 1  ON 64
ci_66                -7.150668e-04 3 1  ON 65
ci_67                -9.006333e-04 3 1  ON 66
ci_68                -1.382323e-03 3 1  ON 67
ci_69                 1.435189e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8887
    reference variance = 0.252817
====================================================
  Execution time = 4.1588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4492e-01
  Total weights = 1.9642e+06
  Execution time = 5.9376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433624710776
                                         uncertainty =       0.002264136049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433624710776
                                         uncertainty =       0.002264136049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465595064
  error estimate for blocks of size 2^( 2) =       0.000491148409
  error estimate for blocks of size 2^( 3) =       0.000515202482
  error estimate for blocks of size 2^( 4) =       0.000532597616
  error estimate for blocks of size 2^( 5) =       0.000544163100
  error estimate for blocks of size 2^( 6) =       0.000551031246
  error estimate for blocks of size 2^( 7) =       0.000556270545

      target function =      -0.749544014385
              le_mean =     -22.813907322529
             les_mean =     520.919286909774
             stat err =       0.000546015627
             autocorr =       1.375287226137
   target nu stat err =       0.000546015627
   target dn stat err =       0.002640303534
      target stat err =       0.002280631832
              std dev =       0.658450854307
             le_variance =       0.433557527537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433624705074
                                         uncertainty =       0.002264137513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433624705074
                                         uncertainty =       0.002264137513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465595061
  error estimate for blocks of size 2^( 2) =       0.000491148410
  error estimate for blocks of size 2^( 3) =       0.000515202487
  error estimate for blocks of size 2^( 4) =       0.000532597624
  error estimate for blocks of size 2^( 5) =       0.000544163115
  error estimate for blocks of size 2^( 6) =       0.000551031259
  error estimate for blocks of size 2^( 7) =       0.000556270555

      target function =      -0.749544049006
              le_mean =     -22.813907322078
             les_mean =     520.919286847619
             stat err =       0.000546015638
             autocorr =       1.375287301717
   target nu stat err =       0.000546015638
   target dn stat err =       0.002640301363
      target stat err =       0.002280630295
              std dev =       0.658450850018
             le_variance =       0.433557521889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433624707924
                                         uncertainty =       0.002264136781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433624707924
                                         uncertainty =       0.002264136781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465595063
  error estimate for blocks of size 2^( 2) =       0.000491148409
  error estimate for blocks of size 2^( 3) =       0.000515202485
  error estimate for blocks of size 2^( 4) =       0.000532597620
  error estimate for blocks of size 2^( 5) =       0.000544163107
  error estimate for blocks of size 2^( 6) =       0.000551031253
  error estimate for blocks of size 2^( 7) =       0.000556270550

      target function =      -0.749544031711
              le_mean =     -22.813907322303
             les_mean =     520.919286878674
             stat err =       0.000546015633
             autocorr =       1.375287263923
   target nu stat err =       0.000546015633
   target dn stat err =       0.002640302448
      target stat err =       0.002280631063
              std dev =       0.658450852162
             le_variance =       0.433557524712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433624710419
                                         uncertainty =       0.002264136140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433624710419
                                         uncertainty =       0.002264136140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465595064
  error estimate for blocks of size 2^( 2) =       0.000491148409
  error estimate for blocks of size 2^( 3) =       0.000515202482
  error estimate for blocks of size 2^( 4) =       0.000532597616
  error estimate for blocks of size 2^( 5) =       0.000544163101
  error estimate for blocks of size 2^( 6) =       0.000551031247
  error estimate for blocks of size 2^( 7) =       0.000556270546

      target function =      -0.749544016552
              le_mean =     -22.813907322501
             les_mean =     520.919286905884
             stat err =       0.000546015628
             autocorr =       1.375287230870
   target nu stat err =       0.000546015628
   target dn stat err =       0.002640303398
      target stat err =       0.002280631736
              std dev =       0.658450854038
             le_variance =       0.433557527184


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749544014385        initial
     9.7656e+02     9.7656e+03             1.6292e-07        -0.749544049006  <--
     3.9062e+03     3.9062e+04             4.0731e-08        -0.749544031711
     1.5625e+04     1.5625e+05             1.0183e-08        -0.749544016552

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 7.1381e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.273138e-01 3 1  ON 0
ci_02                -2.888610e-02 3 1  ON 1
ci_03                -2.899678e-02 3 1  ON 2
ci_04                 2.691744e-02 3 1  ON 3
ci_05                -2.208220e-02 3 1  ON 4
ci_06                -2.179084e-02 3 1  ON 5
ci_07                 2.740021e-02 3 1  ON 6
ci_08                -5.569987e-03 3 1  ON 7
ci_09                -9.068864e-03 3 1  ON 8
ci_10                -8.353984e-03 3 1  ON 9
ci_11                 1.321609e-02 3 1  ON 10
ci_12                 6.941126e-03 3 1  ON 11
ci_13                 1.283328e-02 3 1  ON 12
ci_14                 1.270743e-02 3 1  ON 13
ci_15                 6.272137e-03 3 1  ON 14
ci_16                 6.431747e-03 3 1  ON 15
ci_17                -7.255281e-03 3 1  ON 16
ci_18                -5.947845e-03 3 1  ON 17
ci_19                 9.299544e-03 3 1  ON 18
ci_20                 6.398113e-03 3 1  ON 19
ci_21                 8.999764e-03 3 1  ON 20
ci_22                 8.260642e-03 3 1  ON 21
ci_23                 4.757831e-03 3 1  ON 22
ci_24                 3.982448e-03 3 1  ON 23
ci_25                 2.845381e-03 3 1  ON 24
ci_26                 3.145391e-03 3 1  ON 25
ci_27                 3.328923e-03 3 1  ON 26
ci_28                 1.923411e-03 3 1  ON 27
ci_29                 1.298239e-03 3 1  ON 28
ci_30                -1.841204e-03 3 1  ON 29
ci_31                -5.582667e-04 3 1  ON 30
ci_32                -8.425973e-04 3 1  ON 31
ci_33                -1.476967e-03 3 1  ON 32
ci_34                 1.136462e-03 3 1  ON 33
ci_35                 1.469136e-03 3 1  ON 34
ci_36                -1.019639e-03 3 1  ON 35
ci_37                -1.032407e-03 3 1  ON 36
ci_38                -7.710872e-04 3 1  ON 37
ci_39                -6.251218e-04 3 1  ON 38
ci_40                -1.568951e-03 3 1  ON 39
ci_41                -1.247811e-03 3 1  ON 40
ci_42                -1.168461e-03 3 1  ON 41
ci_43                -2.487647e-03 3 1  ON 42
ci_44                -3.259271e-03 3 1  ON 43
ci_45                -5.333511e-04 3 1  ON 44
ci_46                -8.746189e-04 3 1  ON 45
ci_47                 1.539852e-03 3 1  ON 46
ci_48                 1.376148e-03 3 1  ON 47
ci_49                -1.048383e-03 3 1  ON 48
ci_50                -8.112906e-04 3 1  ON 49
ci_51                 1.483025e-04 3 1  ON 50
ci_52                 8.291514e-05 3 1  ON 51
ci_53                -6.342193e-04 3 1  ON 52
ci_54                -1.030415e-03 3 1  ON 53
ci_55                -6.529835e-04 3 1  ON 54
ci_56                 2.631746e-03 3 1  ON 55
ci_57                 1.620071e-03 3 1  ON 56
ci_58                -1.118183e-03 3 1  ON 57
ci_59                -1.472795e-03 3 1  ON 58
ci_60                 5.425271e-04 3 1  ON 59
ci_61                -1.243161e-04 3 1  ON 60
ci_62                -6.662999e-04 3 1  ON 61
ci_63                -7.742507e-04 3 1  ON 62
ci_64                -2.616471e-04 3 1  ON 63
ci_65                 6.514211e-05 3 1  ON 64
ci_66                -7.150572e-04 3 1  ON 65
ci_67                -9.006280e-04 3 1  ON 66
ci_68                -1.382387e-03 3 1  ON 67
ci_69                 1.434936e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2258e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.853
    reference variance = 0.320218
====================================================
  Execution time = 4.4164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.7821e-01
  Total weights = 1.964236189e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6805e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456241480105
                                         uncertainty =       0.020547410827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456241480105
                                         uncertainty =       0.020547410827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477588378
  error estimate for blocks of size 2^( 2) =       0.000502720477
  error estimate for blocks of size 2^( 3) =       0.000525783404
  error estimate for blocks of size 2^( 4) =       0.000542618990
  error estimate for blocks of size 2^( 5) =       0.000554702881
  error estimate for blocks of size 2^( 6) =       0.000562045744
  error estimate for blocks of size 2^( 7) =       0.000566340504

      target function =      -0.722013643950
              le_mean =     -22.815209102998
             les_mean =     521.011978211747
             stat err =       0.000556427030
             autocorr =       1.357403417849
   target nu stat err =       0.000556427030
   target dn stat err =       0.030336412857
      target stat err =       0.023516262879
              std dev =       0.675411960943
             le_variance =       0.456181316985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281520910300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.722781505407       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.722782600080       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.722782702164       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.722782726911       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.722782735416       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.722782737882       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.722782738549       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.722782738654       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.722782738706       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.722782738712       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.722782738732       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 3.630085e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.722781505407       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.722781779116       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.722781804639       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.722781810828       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.722781812952       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.722781813569       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.722781813735       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.722781813758       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.722781813775       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.722781813776       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.722781813782       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 9.075950e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.722781505407       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.722781573837       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.722781580218       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.722781581763       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.722781582296       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.722781582447       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.722781582489       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.722781582497       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.722781582505       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.722781582504       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.722781582502       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 2.269034e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1856e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.273129e-01 3 1  ON 0
ci_02                -2.888621e-02 3 1  ON 1
ci_03                -2.899594e-02 3 1  ON 2
ci_04                 2.691761e-02 3 1  ON 3
ci_05                -2.208253e-02 3 1  ON 4
ci_06                -2.179069e-02 3 1  ON 5
ci_07                 2.740021e-02 3 1  ON 6
ci_08                -5.570110e-03 3 1  ON 7
ci_09                -9.068883e-03 3 1  ON 8
ci_10                -8.353909e-03 3 1  ON 9
ci_11                 1.321614e-02 3 1  ON 10
ci_12                 6.941445e-03 3 1  ON 11
ci_13                 1.283326e-02 3 1  ON 12
ci_14                 1.270747e-02 3 1  ON 13
ci_15                 6.272176e-03 3 1  ON 14
ci_16                 6.431234e-03 3 1  ON 15
ci_17                -7.255488e-03 3 1  ON 16
ci_18                -5.947944e-03 3 1  ON 17
ci_19                 9.299516e-03 3 1  ON 18
ci_20                 6.397973e-03 3 1  ON 19
ci_21                 8.999771e-03 3 1  ON 20
ci_22                 8.260699e-03 3 1  ON 21
ci_23                 4.757782e-03 3 1  ON 22
ci_24                 3.982463e-03 3 1  ON 23
ci_25                 2.845343e-03 3 1  ON 24
ci_26                 3.144880e-03 3 1  ON 25
ci_27                 3.328881e-03 3 1  ON 26
ci_28                 1.923030e-03 3 1  ON 27
ci_29                 1.298069e-03 3 1  ON 28
ci_30                -1.841182e-03 3 1  ON 29
ci_31                -5.581333e-04 3 1  ON 30
ci_32                -8.426811e-04 3 1  ON 31
ci_33                -1.476656e-03 3 1  ON 32
ci_34                 1.136228e-03 3 1  ON 33
ci_35                 1.468915e-03 3 1  ON 34
ci_36                -1.019626e-03 3 1  ON 35
ci_37                -1.032433e-03 3 1  ON 36
ci_38                -7.711059e-04 3 1  ON 37
ci_39                -6.251402e-04 3 1  ON 38
ci_40                -1.568864e-03 3 1  ON 39
ci_41                -1.247863e-03 3 1  ON 40
ci_42                -1.168590e-03 3 1  ON 41
ci_43                -2.487480e-03 3 1  ON 42
ci_44                -3.258862e-03 3 1  ON 43
ci_45                -5.332512e-04 3 1  ON 44
ci_46                -8.745257e-04 3 1  ON 45
ci_47                 1.539862e-03 3 1  ON 46
ci_48                 1.376111e-03 3 1  ON 47
ci_49                -1.048222e-03 3 1  ON 48
ci_50                -8.112674e-04 3 1  ON 49
ci_51                 1.483470e-04 3 1  ON 50
ci_52                 8.295783e-05 3 1  ON 51
ci_53                -6.342580e-04 3 1  ON 52
ci_54                -1.030425e-03 3 1  ON 53
ci_55                -6.529673e-04 3 1  ON 54
ci_56                 2.631611e-03 3 1  ON 55
ci_57                 1.620040e-03 3 1  ON 56
ci_58                -1.118125e-03 3 1  ON 57
ci_59                -1.472667e-03 3 1  ON 58
ci_60                 5.425440e-04 3 1  ON 59
ci_61                -1.239190e-04 3 1  ON 60
ci_62                -6.662594e-04 3 1  ON 61
ci_63                -7.742951e-04 3 1  ON 62
ci_64                -2.615239e-04 3 1  ON 63
ci_65                 6.494988e-05 3 1  ON 64
ci_66                -7.150616e-04 3 1  ON 65
ci_67                -9.006182e-04 3 1  ON 66
ci_68                -1.382652e-03 3 1  ON 67
ci_69                 1.435014e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.912
    reference variance = 0.30176
====================================================
  Execution time = 4.1472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5203e-01
  Total weights = 1.9643e+06
  Execution time = 5.9499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438229487302
                                         uncertainty =       0.002703024625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438229487302
                                         uncertainty =       0.002703024625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468091562
  error estimate for blocks of size 2^( 2) =       0.000493806968
  error estimate for blocks of size 2^( 3) =       0.000517934177
  error estimate for blocks of size 2^( 4) =       0.000536193196
  error estimate for blocks of size 2^( 5) =       0.000546955058
  error estimate for blocks of size 2^( 6) =       0.000555558916
  error estimate for blocks of size 2^( 7) =       0.000560404416

      target function =      -0.743667836213
              le_mean =     -22.814012431248
             les_mean =     520.931193346025
             stat err =       0.000549777896
             autocorr =       1.379472111719
   target nu stat err =       0.000549777896
   target dn stat err =       0.003121246085
      target stat err =       0.002629564370
              std dev =       0.661981435938
             le_variance =       0.438219421527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438227947453
                                         uncertainty =       0.002702246191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438227947453
                                         uncertainty =       0.002702246191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468090741
  error estimate for blocks of size 2^( 2) =       0.000493806221
  error estimate for blocks of size 2^( 3) =       0.000517933541
  error estimate for blocks of size 2^( 4) =       0.000536192610
  error estimate for blocks of size 2^( 5) =       0.000546954501
  error estimate for blocks of size 2^( 6) =       0.000555558436
  error estimate for blocks of size 2^( 7) =       0.000560403923

      target function =      -0.743669579634
              le_mean =     -22.814012437610
             les_mean =     520.931191515071
             stat err =       0.000549777367
             autocorr =       1.379474300628
   target nu stat err =       0.000549777367
   target dn stat err =       0.003120445049
      target stat err =       0.002628937244
              std dev =       0.661980273718
             le_variance =       0.438217882792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438228717001
                                         uncertainty =       0.002702635228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438228717001
                                         uncertainty =       0.002702635228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468091151
  error estimate for blocks of size 2^( 2) =       0.000493806595
  error estimate for blocks of size 2^( 3) =       0.000517933859
  error estimate for blocks of size 2^( 4) =       0.000536192903
  error estimate for blocks of size 2^( 5) =       0.000546954779
  error estimate for blocks of size 2^( 6) =       0.000555558676
  error estimate for blocks of size 2^( 7) =       0.000560404169

      target function =      -0.743668566715
              le_mean =     -22.814012434424
             les_mean =     520.931192602554
             stat err =       0.000549777632
             autocorr =       1.379473206502
   target nu stat err =       0.000549777632
   target dn stat err =       0.003120845187
      target stat err =       0.002629249532
              std dev =       0.661980854544
             le_variance =       0.438218651783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438229390982
                                         uncertainty =       0.002702975935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438229390982
                                         uncertainty =       0.002702975935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468091511
  error estimate for blocks of size 2^( 2) =       0.000493806922
  error estimate for blocks of size 2^( 3) =       0.000517934137
  error estimate for blocks of size 2^( 4) =       0.000536193159
  error estimate for blocks of size 2^( 5) =       0.000546955023
  error estimate for blocks of size 2^( 6) =       0.000555558886
  error estimate for blocks of size 2^( 7) =       0.000560404385

      target function =      -0.743667946248
              le_mean =     -22.814012431642
             les_mean =     520.931193230090
             stat err =       0.000549777863
             autocorr =       1.379472248596
   target nu stat err =       0.000549777863
   target dn stat err =       0.003121195966
      target stat err =       0.002629525138
              std dev =       0.661981363239
             le_variance =       0.438219325276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743667836213        initial
     2.4414e+02     2.4414e+03             3.6301e-06        -0.743669579634  <--
     9.7656e+02     9.7656e+03             9.0759e-07        -0.743668566715
     3.9062e+03     3.9062e+04             2.2690e-07        -0.743667946248

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 7.1333e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.273102e-01 3 1  ON 0
ci_02                -2.888655e-02 3 1  ON 1
ci_03                -2.899342e-02 3 1  ON 2
ci_04                 2.691813e-02 3 1  ON 3
ci_05                -2.208355e-02 3 1  ON 4
ci_06                -2.179024e-02 3 1  ON 5
ci_07                 2.740022e-02 3 1  ON 6
ci_08                -5.570477e-03 3 1  ON 7
ci_09                -9.068941e-03 3 1  ON 8
ci_10                -8.353684e-03 3 1  ON 9
ci_11                 1.321627e-02 3 1  ON 10
ci_12                 6.942403e-03 3 1  ON 11
ci_13                 1.283321e-02 3 1  ON 12
ci_14                 1.270757e-02 3 1  ON 13
ci_15                 6.272294e-03 3 1  ON 14
ci_16                 6.429697e-03 3 1  ON 15
ci_17                -7.256107e-03 3 1  ON 16
ci_18                -5.948244e-03 3 1  ON 17
ci_19                 9.299435e-03 3 1  ON 18
ci_20                 6.397554e-03 3 1  ON 19
ci_21                 8.999790e-03 3 1  ON 20
ci_22                 8.260868e-03 3 1  ON 21
ci_23                 4.757633e-03 3 1  ON 22
ci_24                 3.982507e-03 3 1  ON 23
ci_25                 2.845230e-03 3 1  ON 24
ci_26                 3.143347e-03 3 1  ON 25
ci_27                 3.328755e-03 3 1  ON 26
ci_28                 1.921886e-03 3 1  ON 27
ci_29                 1.297558e-03 3 1  ON 28
ci_30                -1.841118e-03 3 1  ON 29
ci_31                -5.577332e-04 3 1  ON 30
ci_32                -8.429322e-04 3 1  ON 31
ci_33                -1.475725e-03 3 1  ON 32
ci_34                 1.135526e-03 3 1  ON 33
ci_35                 1.468254e-03 3 1  ON 34
ci_36                -1.019587e-03 3 1  ON 35
ci_37                -1.032512e-03 3 1  ON 36
ci_38                -7.711619e-04 3 1  ON 37
ci_39                -6.251952e-04 3 1  ON 38
ci_40                -1.568603e-03 3 1  ON 39
ci_41                -1.248017e-03 3 1  ON 40
ci_42                -1.168975e-03 3 1  ON 41
ci_43                -2.486978e-03 3 1  ON 42
ci_44                -3.257633e-03 3 1  ON 43
ci_45                -5.329515e-04 3 1  ON 44
ci_46                -8.742462e-04 3 1  ON 45
ci_47                 1.539892e-03 3 1  ON 46
ci_48                 1.375999e-03 3 1  ON 47
ci_49                -1.047740e-03 3 1  ON 48
ci_50                -8.111978e-04 3 1  ON 49
ci_51                 1.484804e-04 3 1  ON 50
ci_52                 8.308589e-05 3 1  ON 51
ci_53                -6.343744e-04 3 1  ON 52
ci_54                -1.030456e-03 3 1  ON 53
ci_55                -6.529186e-04 3 1  ON 54
ci_56                 2.631206e-03 3 1  ON 55
ci_57                 1.619947e-03 3 1  ON 56
ci_58                -1.117951e-03 3 1  ON 57
ci_59                -1.472286e-03 3 1  ON 58
ci_60                 5.425949e-04 3 1  ON 59
ci_61                -1.227278e-04 3 1  ON 60
ci_62                -6.661377e-04 3 1  ON 61
ci_63                -7.744283e-04 3 1  ON 62
ci_64                -2.611544e-04 3 1  ON 63
ci_65                 6.437329e-05 3 1  ON 64
ci_66                -7.150750e-04 3 1  ON 65
ci_67                -9.005888e-04 3 1  ON 66
ci_68                -1.383446e-03 3 1  ON 67
ci_69                 1.435247e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2373e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7829
    reference variance = 0.271882
====================================================
  Execution time = 4.4485e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4879e-01
  Total weights = 1.964060798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432284616543
                                         uncertainty =       0.001710610477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432284616543
                                         uncertainty =       0.001710610477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464877977
  error estimate for blocks of size 2^( 2) =       0.000490096890
  error estimate for blocks of size 2^( 3) =       0.000514191544
  error estimate for blocks of size 2^( 4) =       0.000531603724
  error estimate for blocks of size 2^( 5) =       0.000543473707
  error estimate for blocks of size 2^( 6) =       0.000549530641
  error estimate for blocks of size 2^( 7) =       0.000552804840

      target function =      -0.746327169812
              le_mean =     -22.813914416334
             les_mean =     520.923482407736
             stat err =       0.000544353228
             autocorr =       1.371145872249
   target nu stat err =       0.000544353228
   target dn stat err =       0.003803532119
      target stat err =       0.003197218228
              std dev =       0.657436739424
             le_variance =       0.432223066344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281391441633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746339910521       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746340107916       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746340158474       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746340172771       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746340175763       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746340175434       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746340175015       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746340175221       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746340175219       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 2.923575e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746339910521       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746339959901       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746339972545       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746339976120       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746339976868       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746339976786       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746339976681       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746339976732       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746339976732       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 7.311391e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746339910521       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746339922868       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746339926029       residual = 6.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746339926923       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746339927110       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746339927090       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746339927065       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746339927076       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746339927077       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 1.828001e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177261 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2151e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.273095e-01 3 1  ON 0
ci_02                -2.888649e-02 3 1  ON 1
ci_03                -2.899329e-02 3 1  ON 2
ci_04                 2.691806e-02 3 1  ON 3
ci_05                -2.208342e-02 3 1  ON 4
ci_06                -2.178956e-02 3 1  ON 5
ci_07                 2.739978e-02 3 1  ON 6
ci_08                -5.570311e-03 3 1  ON 7
ci_09                -9.068768e-03 3 1  ON 8
ci_10                -8.353699e-03 3 1  ON 9
ci_11                 1.321614e-02 3 1  ON 10
ci_12                 6.942488e-03 3 1  ON 11
ci_13                 1.283331e-02 3 1  ON 12
ci_14                 1.270750e-02 3 1  ON 13
ci_15                 6.272439e-03 3 1  ON 14
ci_16                 6.429503e-03 3 1  ON 15
ci_17                -7.255535e-03 3 1  ON 16
ci_18                -5.948144e-03 3 1  ON 17
ci_19                 9.299391e-03 3 1  ON 18
ci_20                 6.397662e-03 3 1  ON 19
ci_21                 8.999949e-03 3 1  ON 20
ci_22                 8.260879e-03 3 1  ON 21
ci_23                 4.757694e-03 3 1  ON 22
ci_24                 3.982652e-03 3 1  ON 23
ci_25                 2.845248e-03 3 1  ON 24
ci_26                 3.143415e-03 3 1  ON 25
ci_27                 3.328632e-03 3 1  ON 26
ci_28                 1.921893e-03 3 1  ON 27
ci_29                 1.297515e-03 3 1  ON 28
ci_30                -1.841081e-03 3 1  ON 29
ci_31                -5.579065e-04 3 1  ON 30
ci_32                -8.430351e-04 3 1  ON 31
ci_33                -1.475668e-03 3 1  ON 32
ci_34                 1.135534e-03 3 1  ON 33
ci_35                 1.468330e-03 3 1  ON 34
ci_36                -1.019738e-03 3 1  ON 35
ci_37                -1.032557e-03 3 1  ON 36
ci_38                -7.711387e-04 3 1  ON 37
ci_39                -6.251040e-04 3 1  ON 38
ci_40                -1.568492e-03 3 1  ON 39
ci_41                -1.248306e-03 3 1  ON 40
ci_42                -1.169134e-03 3 1  ON 41
ci_43                -2.487012e-03 3 1  ON 42
ci_44                -3.257271e-03 3 1  ON 43
ci_45                -5.328463e-04 3 1  ON 44
ci_46                -8.742192e-04 3 1  ON 45
ci_47                 1.539899e-03 3 1  ON 46
ci_48                 1.375823e-03 3 1  ON 47
ci_49                -1.047666e-03 3 1  ON 48
ci_50                -8.113161e-04 3 1  ON 49
ci_51                 1.483518e-04 3 1  ON 50
ci_52                 8.299434e-05 3 1  ON 51
ci_53                -6.344259e-04 3 1  ON 52
ci_54                -1.030598e-03 3 1  ON 53
ci_55                -6.526806e-04 3 1  ON 54
ci_56                 2.631178e-03 3 1  ON 55
ci_57                 1.620025e-03 3 1  ON 56
ci_58                -1.117887e-03 3 1  ON 57
ci_59                -1.472147e-03 3 1  ON 58
ci_60                 5.424847e-04 3 1  ON 59
ci_61                -1.224394e-04 3 1  ON 60
ci_62                -6.659145e-04 3 1  ON 61
ci_63                -7.745760e-04 3 1  ON 62
ci_64                -2.612923e-04 3 1  ON 63
ci_65                 6.445319e-05 3 1  ON 64
ci_66                -7.150076e-04 3 1  ON 65
ci_67                -9.006548e-04 3 1  ON 66
ci_68                -1.383289e-03 3 1  ON 67
ci_69                 1.432698e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7644
    reference variance = 0.419184
====================================================
  Execution time = 4.1815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4403e-01
  Total weights = 1.9641e+06
  Execution time = 5.8896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432606296401
                                         uncertainty =       0.002269669256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432606296401
                                         uncertainty =       0.002269669256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465104756
  error estimate for blocks of size 2^( 2) =       0.000490400009
  error estimate for blocks of size 2^( 3) =       0.000514609611
  error estimate for blocks of size 2^( 4) =       0.000532386448
  error estimate for blocks of size 2^( 5) =       0.000543906455
  error estimate for blocks of size 2^( 6) =       0.000548395228
  error estimate for blocks of size 2^( 7) =       0.000552998789

      target function =      -0.750290537922
              le_mean =     -22.814438491654
             les_mean =     520.942632595085
             stat err =       0.000544421730
             autocorr =       1.370153869476
   target nu stat err =       0.000544421730
   target dn stat err =       0.003186307299
      target stat err =       0.002728637110
              std dev =       0.657757453724
             le_variance =       0.432644867930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432605906945
                                         uncertainty =       0.002269604946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432605906945
                                         uncertainty =       0.002269604946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465104548
  error estimate for blocks of size 2^( 2) =       0.000490399873
  error estimate for blocks of size 2^( 3) =       0.000514609543
  error estimate for blocks of size 2^( 4) =       0.000532386424
  error estimate for blocks of size 2^( 5) =       0.000543906423
  error estimate for blocks of size 2^( 6) =       0.000548395149
  error estimate for blocks of size 2^( 7) =       0.000552998770

      target function =      -0.750291326948
              le_mean =     -22.814438460279
             les_mean =     520.942630218446
             stat err =       0.000544421692
             autocorr =       1.370154904151
   target nu stat err =       0.000544421692
   target dn stat err =       0.003186241921
      target stat err =       0.002728589343
              std dev =       0.657757159172
             le_variance =       0.432644480443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432606101463
                                         uncertainty =       0.002269637076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432606101463
                                         uncertainty =       0.002269637076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465104652
  error estimate for blocks of size 2^( 2) =       0.000490399941
  error estimate for blocks of size 2^( 3) =       0.000514609577
  error estimate for blocks of size 2^( 4) =       0.000532386436
  error estimate for blocks of size 2^( 5) =       0.000543906439
  error estimate for blocks of size 2^( 6) =       0.000548395188
  error estimate for blocks of size 2^( 7) =       0.000552998780

      target function =      -0.750287630903
              le_mean =     -22.814438475980
             les_mean =     520.942635361449
             stat err =       0.000544421711
             autocorr =       1.370154387756
   target nu stat err =       0.000544421711
   target dn stat err =       0.003186270597
      target stat err =       0.002728586538
              std dev =       0.657757306290
             le_variance =       0.432644673978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432606272019
                                         uncertainty =       0.002269665232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432606272019
                                         uncertainty =       0.002269665232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465104743
  error estimate for blocks of size 2^( 2) =       0.000490400000
  error estimate for blocks of size 2^( 3) =       0.000514609607
  error estimate for blocks of size 2^( 4) =       0.000532386446
  error estimate for blocks of size 2^( 5) =       0.000543906453
  error estimate for blocks of size 2^( 6) =       0.000548395223
  error estimate for blocks of size 2^( 7) =       0.000552998788

      target function =      -0.750290668825
              le_mean =     -22.814438489692
             les_mean =     520.942632348776
             stat err =       0.000544421727
             autocorr =       1.370153934243
   target nu stat err =       0.000544421727
   target dn stat err =       0.003186302890
      target stat err =       0.002728634441
              std dev =       0.657757435284
             le_variance =       0.432644843671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750290537922        initial
     6.1035e+01     6.1035e+02             2.9236e-06        -0.750291326948  <--
     2.4414e+02     2.4414e+03             7.3114e-07        -0.750287630903
     9.7656e+02     9.7656e+03             1.8280e-07        -0.750290668825

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 7.1574e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.273073e-01 3 1  ON 0
ci_02                -2.888632e-02 3 1  ON 1
ci_03                -2.899290e-02 3 1  ON 2
ci_04                 2.691784e-02 3 1  ON 3
ci_05                -2.208304e-02 3 1  ON 4
ci_06                -2.178751e-02 3 1  ON 5
ci_07                 2.739845e-02 3 1  ON 6
ci_08                -5.569812e-03 3 1  ON 7
ci_09                -9.068250e-03 3 1  ON 8
ci_10                -8.353743e-03 3 1  ON 9
ci_11                 1.321574e-02 3 1  ON 10
ci_12                 6.942742e-03 3 1  ON 11
ci_13                 1.283360e-02 3 1  ON 12
ci_14                 1.270730e-02 3 1  ON 13
ci_15                 6.272873e-03 3 1  ON 14
ci_16                 6.428923e-03 3 1  ON 15
ci_17                -7.253821e-03 3 1  ON 16
ci_18                -5.947845e-03 3 1  ON 17
ci_19                 9.299260e-03 3 1  ON 18
ci_20                 6.397988e-03 3 1  ON 19
ci_21                 9.000426e-03 3 1  ON 20
ci_22                 8.260911e-03 3 1  ON 21
ci_23                 4.757877e-03 3 1  ON 22
ci_24                 3.983087e-03 3 1  ON 23
ci_25                 2.845302e-03 3 1  ON 24
ci_26                 3.143618e-03 3 1  ON 25
ci_27                 3.328264e-03 3 1  ON 26
ci_28                 1.921913e-03 3 1  ON 27
ci_29                 1.297388e-03 3 1  ON 28
ci_30                -1.840971e-03 3 1  ON 29
ci_31                -5.584262e-04 3 1  ON 30
ci_32                -8.433437e-04 3 1  ON 31
ci_33                -1.475499e-03 3 1  ON 32
ci_34                 1.135555e-03 3 1  ON 33
ci_35                 1.468560e-03 3 1  ON 34
ci_36                -1.020188e-03 3 1  ON 35
ci_37                -1.032690e-03 3 1  ON 36
ci_38                -7.710691e-04 3 1  ON 37
ci_39                -6.248307e-04 3 1  ON 38
ci_40                -1.568159e-03 3 1  ON 39
ci_41                -1.249173e-03 3 1  ON 40
ci_42                -1.169610e-03 3 1  ON 41
ci_43                -2.487112e-03 3 1  ON 42
ci_44                -3.256185e-03 3 1  ON 43
ci_45                -5.325310e-04 3 1  ON 44
ci_46                -8.741382e-04 3 1  ON 45
ci_47                 1.539918e-03 3 1  ON 46
ci_48                 1.375296e-03 3 1  ON 47
ci_49                -1.047445e-03 3 1  ON 48
ci_50                -8.116706e-04 3 1  ON 49
ci_51                 1.479665e-04 3 1  ON 50
ci_52                 8.271992e-05 3 1  ON 51
ci_53                -6.345801e-04 3 1  ON 52
ci_54                -1.031026e-03 3 1  ON 53
ci_55                -6.519671e-04 3 1  ON 54
ci_56                 2.631095e-03 3 1  ON 55
ci_57                 1.620259e-03 3 1  ON 56
ci_58                -1.117692e-03 3 1  ON 57
ci_59                -1.471731e-03 3 1  ON 58
ci_60                 5.421542e-04 3 1  ON 59
ci_61                -1.215744e-04 3 1  ON 60
ci_62                -6.652456e-04 3 1  ON 61
ci_63                -7.750186e-04 3 1  ON 62
ci_64                -2.617056e-04 3 1  ON 63
ci_65                 6.469273e-05 3 1  ON 64
ci_66                -7.148057e-04 3 1  ON 65
ci_67                -9.008527e-04 3 1  ON 66
ci_68                -1.382819e-03 3 1  ON 67
ci_69                 1.425056e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2393e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.783
    reference variance = 0.300501
====================================================
  Execution time = 4.2930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5372e-01
  Total weights = 1.964131512e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440801276981
                                         uncertainty =       0.007724032475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440801276981
                                         uncertainty =       0.007724032475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469515835
  error estimate for blocks of size 2^( 2) =       0.000494599090
  error estimate for blocks of size 2^( 3) =       0.000518147844
  error estimate for blocks of size 2^( 4) =       0.000536599236
  error estimate for blocks of size 2^( 5) =       0.000547535859
  error estimate for blocks of size 2^( 6) =       0.000552867089
  error estimate for blocks of size 2^( 7) =       0.000553666421

      target function =      -0.742211172990
              le_mean =     -22.814063554932
             les_mean =     520.935216893486
             stat err =       0.000547667151
             autocorr =       1.360607620173
   target nu stat err =       0.000547667151
   target dn stat err =       0.009594260166
      target stat err =       0.007859015516
              std dev =       0.663995661136
             le_variance =       0.440890238007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281406355493e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742292542885       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742295162549       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742295495179       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742295580950       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742295612557       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742295620785       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742295618591       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742295618842       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742295618797       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.181755e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742292542885       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742293199377       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742293282652       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742293304108       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742293312001       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742293314052       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742293313503       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742293313565       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742293313554       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 5.461434e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742292542885       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742292707107       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742292727933       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742292733298       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742292735270       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742292735783       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742292735645       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742292735660       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742292735658       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 1.365800e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0614e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.273018e-01 3 1  ON 0
ci_02                -2.888596e-02 3 1  ON 1
ci_03                -2.899227e-02 3 1  ON 2
ci_04                 2.691782e-02 3 1  ON 3
ci_05                -2.208256e-02 3 1  ON 4
ci_06                -2.178429e-02 3 1  ON 5
ci_07                 2.739744e-02 3 1  ON 6
ci_08                -5.570846e-03 3 1  ON 7
ci_09                -9.063522e-03 3 1  ON 8
ci_10                -8.353639e-03 3 1  ON 9
ci_11                 1.321632e-02 3 1  ON 10
ci_12                 6.944268e-03 3 1  ON 11
ci_13                 1.283314e-02 3 1  ON 12
ci_14                 1.270692e-02 3 1  ON 13
ci_15                 6.271492e-03 3 1  ON 14
ci_16                 6.429200e-03 3 1  ON 15
ci_17                -7.251951e-03 3 1  ON 16
ci_18                -5.946960e-03 3 1  ON 17
ci_19                 9.299574e-03 3 1  ON 18
ci_20                 6.396593e-03 3 1  ON 19
ci_21                 9.001213e-03 3 1  ON 20
ci_22                 8.261865e-03 3 1  ON 21
ci_23                 4.758120e-03 3 1  ON 22
ci_24                 3.982756e-03 3 1  ON 23
ci_25                 2.845920e-03 3 1  ON 24
ci_26                 3.143080e-03 3 1  ON 25
ci_27                 3.325737e-03 3 1  ON 26
ci_28                 1.924306e-03 3 1  ON 27
ci_29                 1.298956e-03 3 1  ON 28
ci_30                -1.840649e-03 3 1  ON 29
ci_31                -5.578771e-04 3 1  ON 30
ci_32                -8.437666e-04 3 1  ON 31
ci_33                -1.474224e-03 3 1  ON 32
ci_34                 1.136347e-03 3 1  ON 33
ci_35                 1.465871e-03 3 1  ON 34
ci_36                -1.020945e-03 3 1  ON 35
ci_37                -1.032740e-03 3 1  ON 36
ci_38                -7.707483e-04 3 1  ON 37
ci_39                -6.246825e-04 3 1  ON 38
ci_40                -1.567580e-03 3 1  ON 39
ci_41                -1.248237e-03 3 1  ON 40
ci_42                -1.168379e-03 3 1  ON 41
ci_43                -2.485917e-03 3 1  ON 42
ci_44                -3.252621e-03 3 1  ON 43
ci_45                -5.318066e-04 3 1  ON 44
ci_46                -8.731895e-04 3 1  ON 45
ci_47                 1.539949e-03 3 1  ON 46
ci_48                 1.375388e-03 3 1  ON 47
ci_49                -1.045775e-03 3 1  ON 48
ci_50                -8.120706e-04 3 1  ON 49
ci_51                 1.477566e-04 3 1  ON 50
ci_52                 8.287045e-05 3 1  ON 51
ci_53                -6.353365e-04 3 1  ON 52
ci_54                -1.029948e-03 3 1  ON 53
ci_55                -6.521787e-04 3 1  ON 54
ci_56                 2.630117e-03 3 1  ON 55
ci_57                 1.620709e-03 3 1  ON 56
ci_58                -1.117565e-03 3 1  ON 57
ci_59                -1.470072e-03 3 1  ON 58
ci_60                 5.432125e-04 3 1  ON 59
ci_61                -1.227680e-04 3 1  ON 60
ci_62                -6.660184e-04 3 1  ON 61
ci_63                -7.746305e-04 3 1  ON 62
ci_64                -2.617258e-04 3 1  ON 63
ci_65                 6.418787e-05 3 1  ON 64
ci_66                -7.144802e-04 3 1  ON 65
ci_67                -8.998336e-04 3 1  ON 66
ci_68                -1.380063e-03 3 1  ON 67
ci_69                 1.403835e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.9075
    reference variance = 0.494245
====================================================
  Execution time = 4.3299e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5470e-01
  Total weights = 1.9645e+06
  Execution time = 5.9301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440616242717
                                         uncertainty =       0.002673115714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440616242717
                                         uncertainty =       0.002673115714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469368035
  error estimate for blocks of size 2^( 2) =       0.000494703516
  error estimate for blocks of size 2^( 3) =       0.000518513549
  error estimate for blocks of size 2^( 4) =       0.000537232264
  error estimate for blocks of size 2^( 5) =       0.000549290433
  error estimate for blocks of size 2^( 6) =       0.000556513082
  error estimate for blocks of size 2^( 7) =       0.000560480079

      target function =      -0.741479698909
              le_mean =     -22.815245764910
             les_mean =     520.990142952557
             stat err =       0.000550878965
             autocorr =       1.377480176685
   target nu stat err =       0.000550878965
   target dn stat err =       0.003497442283
      target stat err =       0.002919271195
              std dev =       0.663786641496
             le_variance =       0.440612705428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440612808897
                                         uncertainty =       0.002672847876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440612808897
                                         uncertainty =       0.002672847876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469366216
  error estimate for blocks of size 2^( 2) =       0.000494702170
  error estimate for blocks of size 2^( 3) =       0.000518512479
  error estimate for blocks of size 2^( 4) =       0.000537231523
  error estimate for blocks of size 2^( 5) =       0.000549289714
  error estimate for blocks of size 2^( 6) =       0.000556512530
  error estimate for blocks of size 2^( 7) =       0.000560480284

      target function =      -0.741486218149
              le_mean =     -22.815245665346
             les_mean =     520.990130442076
             stat err =       0.000550878513
             autocorr =       1.377488597562
   target nu stat err =       0.000550878513
   target dn stat err =       0.003495196085
      target stat err =       0.002917526901
              std dev =       0.663784068220
             le_variance =       0.440609289222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440614514693
                                         uncertainty =       0.002672981250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440614514693
                                         uncertainty =       0.002672981250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469367120
  error estimate for blocks of size 2^( 2) =       0.000494702838
  error estimate for blocks of size 2^( 3) =       0.000518513009
  error estimate for blocks of size 2^( 4) =       0.000537231889
  error estimate for blocks of size 2^( 5) =       0.000549290069
  error estimate for blocks of size 2^( 6) =       0.000556512801
  error estimate for blocks of size 2^( 7) =       0.000560480178

      target function =      -0.741483431124
              le_mean =     -22.815245714119
             les_mean =     520.990136072627
             stat err =       0.000550878734
             autocorr =       1.377484398804
   target nu stat err =       0.000550878734
   target dn stat err =       0.003496292890
      target stat err =       0.002918381684
              std dev =       0.663785346504
             le_variance =       0.440610986233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440616025754
                                         uncertainty =       0.002673098866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440616025754
                                         uncertainty =       0.002673098866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469367920
  error estimate for blocks of size 2^( 2) =       0.000494703431
  error estimate for blocks of size 2^( 3) =       0.000518513481
  error estimate for blocks of size 2^( 4) =       0.000537232217
  error estimate for blocks of size 2^( 5) =       0.000549290387
  error estimate for blocks of size 2^( 6) =       0.000556513047
  error estimate for blocks of size 2^( 7) =       0.000560480091

      target function =      -0.741480213156
              le_mean =     -22.815245758462
             les_mean =     520.990142029630
             stat err =       0.000550878935
             autocorr =       1.377480705152
   target nu stat err =       0.000550878935
   target dn stat err =       0.003497295864
      target stat err =       0.002919158182
              std dev =       0.663786478899
             le_variance =       0.440612489569


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741479698909        initial
     1.5259e+01     1.5259e+02             2.1818e-05        -0.741486218149  <--
     6.1035e+01     6.1035e+02             5.4614e-06        -0.741483431124
     2.4414e+02     2.4414e+03             1.3658e-06        -0.741480213156

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 7.3061e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.272855e-01 3 1  ON 0
ci_02                -2.888488e-02 3 1  ON 1
ci_03                -2.899040e-02 3 1  ON 2
ci_04                 2.691775e-02 3 1  ON 3
ci_05                -2.208112e-02 3 1  ON 4
ci_06                -2.177464e-02 3 1  ON 5
ci_07                 2.739442e-02 3 1  ON 6
ci_08                -5.573935e-03 3 1  ON 7
ci_09                -9.049375e-03 3 1  ON 8
ci_10                -8.353325e-03 3 1  ON 9
ci_11                 1.321808e-02 3 1  ON 10
ci_12                 6.948831e-03 3 1  ON 11
ci_13                 1.283175e-02 3 1  ON 12
ci_14                 1.270580e-02 3 1  ON 13
ci_15                 6.267363e-03 3 1  ON 14
ci_16                 6.430027e-03 3 1  ON 15
ci_17                -7.246359e-03 3 1  ON 16
ci_18                -5.944312e-03 3 1  ON 17
ci_19                 9.300513e-03 3 1  ON 18
ci_20                 6.392423e-03 3 1  ON 19
ci_21                 9.003569e-03 3 1  ON 20
ci_22                 8.264720e-03 3 1  ON 21
ci_23                 4.758847e-03 3 1  ON 22
ci_24                 3.981763e-03 3 1  ON 23
ci_25                 2.847765e-03 3 1  ON 24
ci_26                 3.141472e-03 3 1  ON 25
ci_27                 3.318179e-03 3 1  ON 26
ci_28                 1.931462e-03 3 1  ON 27
ci_29                 1.303644e-03 3 1  ON 28
ci_30                -1.839684e-03 3 1  ON 29
ci_31                -5.562337e-04 3 1  ON 30
ci_32                -8.450311e-04 3 1  ON 31
ci_33                -1.470411e-03 3 1  ON 32
ci_34                 1.138715e-03 3 1  ON 33
ci_35                 1.457826e-03 3 1  ON 34
ci_36                -1.023209e-03 3 1  ON 35
ci_37                -1.032889e-03 3 1  ON 36
ci_38                -7.697884e-04 3 1  ON 37
ci_39                -6.242395e-04 3 1  ON 38
ci_40                -1.565848e-03 3 1  ON 39
ci_41                -1.245437e-03 3 1  ON 40
ci_42                -1.164696e-03 3 1  ON 41
ci_43                -2.482342e-03 3 1  ON 42
ci_44                -3.241960e-03 3 1  ON 43
ci_45                -5.296403e-04 3 1  ON 44
ci_46                -8.703522e-04 3 1  ON 45
ci_47                 1.540041e-03 3 1  ON 46
ci_48                 1.375663e-03 3 1  ON 47
ci_49                -1.040782e-03 3 1  ON 48
ci_50                -8.132657e-04 3 1  ON 49
ci_51                 1.471292e-04 3 1  ON 50
ci_52                 8.332062e-05 3 1  ON 51
ci_53                -6.375974e-04 3 1  ON 52
ci_54                -1.026724e-03 3 1  ON 53
ci_55                -6.528116e-04 3 1  ON 54
ci_56                 2.627196e-03 3 1  ON 55
ci_57                 1.622053e-03 3 1  ON 56
ci_58                -1.117184e-03 3 1  ON 57
ci_59                -1.465109e-03 3 1  ON 58
ci_60                 5.463827e-04 3 1  ON 59
ci_61                -1.263441e-04 3 1  ON 60
ci_62                -6.683287e-04 3 1  ON 61
ci_63                -7.734702e-04 3 1  ON 62
ci_64                -2.617861e-04 3 1  ON 63
ci_65                 6.267801e-05 3 1  ON 64
ci_66                -7.135069e-04 3 1  ON 65
ci_67                -8.967868e-04 3 1  ON 66
ci_68                -1.371822e-03 3 1  ON 67
ci_69                 1.340368e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2368e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7311
    reference variance = 0.53312
====================================================
  Execution time = 4.3930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5463e-01
  Total weights = 1.964476891e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941376147
                                         uncertainty =       0.003797667100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441941376147
                                         uncertainty =       0.003797667100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470091640
  error estimate for blocks of size 2^( 2) =       0.000495167863
  error estimate for blocks of size 2^( 3) =       0.000519520892
  error estimate for blocks of size 2^( 4) =       0.000537911654
  error estimate for blocks of size 2^( 5) =       0.000547669987
  error estimate for blocks of size 2^( 6) =       0.000554518919
  error estimate for blocks of size 2^( 7) =       0.000556606983

      target function =      -0.741536231138
              le_mean =     -22.813917095805
             les_mean =     520.929441466488
             stat err =       0.000549176886
             autocorr =       1.364769925708
   target nu stat err =       0.000549176886
   target dn stat err =       0.004261665796
      target stat err =       0.003525277506
              std dev =       0.664809973023
             le_variance =       0.441972300230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281391709580e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741552170299       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741556713472       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741557498878       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741557655011       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741557699204       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741557718157       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741557729239       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741557730800       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741557730711       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741557730227       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 5.432956e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741552170299       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741553317281       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741553514675       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741553553719       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741553564711       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741553569404       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741553572150       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741553572533       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741553572511       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741553572390       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.369723e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741552170299       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741552457752       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741552507166       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741552516927       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741552519672       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741552520842       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741552521527       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741552521623       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741552521617       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741552521587       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 3.431561e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1557e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.272795e-01 3 1  ON 0
ci_02                -2.888644e-02 3 1  ON 1
ci_03                -2.899123e-02 3 1  ON 2
ci_04                 2.691343e-02 3 1  ON 3
ci_05                -2.207325e-02 3 1  ON 4
ci_06                -2.176624e-02 3 1  ON 5
ci_07                 2.739184e-02 3 1  ON 6
ci_08                -5.571994e-03 3 1  ON 7
ci_09                -9.047519e-03 3 1  ON 8
ci_10                -8.348609e-03 3 1  ON 9
ci_11                 1.321933e-02 3 1  ON 10
ci_12                 6.945990e-03 3 1  ON 11
ci_13                 1.283449e-02 3 1  ON 12
ci_14                 1.270234e-02 3 1  ON 13
ci_15                 6.265880e-03 3 1  ON 14
ci_16                 6.425988e-03 3 1  ON 15
ci_17                -7.250694e-03 3 1  ON 16
ci_18                -5.930615e-03 3 1  ON 17
ci_19                 9.301811e-03 3 1  ON 18
ci_20                 6.396838e-03 3 1  ON 19
ci_21                 9.006838e-03 3 1  ON 20
ci_22                 8.268015e-03 3 1  ON 21
ci_23                 4.758158e-03 3 1  ON 22
ci_24                 3.990566e-03 3 1  ON 23
ci_25                 2.852664e-03 3 1  ON 24
ci_26                 3.145798e-03 3 1  ON 25
ci_27                 3.317997e-03 3 1  ON 26
ci_28                 1.929793e-03 3 1  ON 27
ci_29                 1.307627e-03 3 1  ON 28
ci_30                -1.826837e-03 3 1  ON 29
ci_31                -5.580475e-04 3 1  ON 30
ci_32                -8.448224e-04 3 1  ON 31
ci_33                -1.466192e-03 3 1  ON 32
ci_34                 1.140148e-03 3 1  ON 33
ci_35                 1.459543e-03 3 1  ON 34
ci_36                -1.025849e-03 3 1  ON 35
ci_37                -1.034010e-03 3 1  ON 36
ci_38                -7.702172e-04 3 1  ON 37
ci_39                -6.213962e-04 3 1  ON 38
ci_40                -1.559804e-03 3 1  ON 39
ci_41                -1.246353e-03 3 1  ON 40
ci_42                -1.170389e-03 3 1  ON 41
ci_43                -2.483592e-03 3 1  ON 42
ci_44                -3.249502e-03 3 1  ON 43
ci_45                -5.277556e-04 3 1  ON 44
ci_46                -8.706669e-04 3 1  ON 45
ci_47                 1.537360e-03 3 1  ON 46
ci_48                 1.377984e-03 3 1  ON 47
ci_49                -1.039102e-03 3 1  ON 48
ci_50                -8.120907e-04 3 1  ON 49
ci_51                 1.427939e-04 3 1  ON 50
ci_52                 8.207463e-05 3 1  ON 51
ci_53                -6.390492e-04 3 1  ON 52
ci_54                -1.026720e-03 3 1  ON 53
ci_55                -6.522572e-04 3 1  ON 54
ci_56                 2.627370e-03 3 1  ON 55
ci_57                 1.619946e-03 3 1  ON 56
ci_58                -1.113191e-03 3 1  ON 57
ci_59                -1.461247e-03 3 1  ON 58
ci_60                 5.419903e-04 3 1  ON 59
ci_61                -1.299302e-04 3 1  ON 60
ci_62                -6.715274e-04 3 1  ON 61
ci_63                -7.738879e-04 3 1  ON 62
ci_64                -2.607980e-04 3 1  ON 63
ci_65                 5.937926e-05 3 1  ON 64
ci_66                -7.125336e-04 3 1  ON 65
ci_67                -8.967750e-04 3 1  ON 66
ci_68                -1.375299e-03 3 1  ON 67
ci_69                 1.318446e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8719
    reference variance = 0.23182
====================================================
  Execution time = 4.3249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4750e-01
  Total weights = 1.9643e+06
  Execution time = 5.9358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435273534353
                                         uncertainty =       0.001944244259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435273534353
                                         uncertainty =       0.001944244259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466470933
  error estimate for blocks of size 2^( 2) =       0.000491754030
  error estimate for blocks of size 2^( 3) =       0.000515527995
  error estimate for blocks of size 2^( 4) =       0.000532786153
  error estimate for blocks of size 2^( 5) =       0.000544313352
  error estimate for blocks of size 2^( 6) =       0.000548990154
  error estimate for blocks of size 2^( 7) =       0.000553442399

      target function =      -0.747416174230
              le_mean =     -22.815818948106
             les_mean =     521.009094577161
             stat err =       0.000544883015
             autocorr =       1.364449185026
   target nu stat err =       0.000544883015
   target dn stat err =       0.002718130566
      target stat err =       0.002336621005
              std dev =       0.659689519825
             le_variance =       0.435190262567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269757508
                                         uncertainty =       0.001943611570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435269757508
                                         uncertainty =       0.001943611570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466468875
  error estimate for blocks of size 2^( 2) =       0.000491753383
  error estimate for blocks of size 2^( 3) =       0.000515528579
  error estimate for blocks of size 2^( 4) =       0.000532787664
  error estimate for blocks of size 2^( 5) =       0.000544315520
  error estimate for blocks of size 2^( 6) =       0.000548992962
  error estimate for blocks of size 2^( 7) =       0.000553445765

      target function =      -0.747395039341
              le_mean =     -22.815818753364
             les_mean =     521.009111156115
             stat err =       0.000544885478
             autocorr =       1.364473562356
   target nu stat err =       0.000544885478
   target dn stat err =       0.002716439669
      target stat err =       0.002335137383
              std dev =       0.659686609040
             le_variance =       0.435186422147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435271581645
                                         uncertainty =       0.001943923664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435271581645
                                         uncertainty =       0.001943923664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466469869
  error estimate for blocks of size 2^( 2) =       0.000491753678
  error estimate for blocks of size 2^( 3) =       0.000515528262
  error estimate for blocks of size 2^( 4) =       0.000532786889
  error estimate for blocks of size 2^( 5) =       0.000544314422
  error estimate for blocks of size 2^( 6) =       0.000548991548
  error estimate for blocks of size 2^( 7) =       0.000553444069

      target function =      -0.747414741558
              le_mean =     -22.815818844410
             les_mean =     521.009091576351
             stat err =       0.000544884232
             autocorr =       1.364461506487
   target nu stat err =       0.000544884232
   target dn stat err =       0.002717161894
      target stat err =       0.002335835503
              std dev =       0.659688014980
             le_variance =       0.435188277108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435273284479
                                         uncertainty =       0.001944203940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435273284479
                                         uncertainty =       0.001944203940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466470797
  error estimate for blocks of size 2^( 2) =       0.000491753984
  error estimate for blocks of size 2^( 3) =       0.000515528026
  error estimate for blocks of size 2^( 4) =       0.000532786242
  error estimate for blocks of size 2^( 5) =       0.000544313483
  error estimate for blocks of size 2^( 6) =       0.000548990326
  error estimate for blocks of size 2^( 7) =       0.000553442605

      target function =      -0.747417166343
              le_mean =     -22.815818934373
             les_mean =     521.009092756325
             stat err =       0.000544883164
             autocorr =       1.364450731566
   target nu stat err =       0.000544883164
   target dn stat err =       0.002718001075
      target stat err =       0.002336523147
              std dev =       0.659689327268
             le_variance =       0.435190008512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747416174230        initial
     3.8147e+00     3.8147e+01             5.4330e-05        -0.747395039341
     1.5259e+01     1.5259e+02             1.3697e-05        -0.747414741558
     6.1035e+01     6.1035e+02             3.4316e-06        -0.747417166343  <--

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 7.2968e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.272840e-01 3 1  ON 0
ci_02                -2.888527e-02 3 1  ON 1
ci_03                -2.899061e-02 3 1  ON 2
ci_04                 2.691666e-02 3 1  ON 3
ci_05                -2.207915e-02 3 1  ON 4
ci_06                -2.177253e-02 3 1  ON 5
ci_07                 2.739378e-02 3 1  ON 6
ci_08                -5.573449e-03 3 1  ON 7
ci_09                -9.048910e-03 3 1  ON 8
ci_10                -8.352144e-03 3 1  ON 9
ci_11                 1.321840e-02 3 1  ON 10
ci_12                 6.948119e-03 3 1  ON 11
ci_13                 1.283244e-02 3 1  ON 12
ci_14                 1.270493e-02 3 1  ON 13
ci_15                 6.266992e-03 3 1  ON 14
ci_16                 6.429015e-03 3 1  ON 15
ci_17                -7.247445e-03 3 1  ON 16
ci_18                -5.940881e-03 3 1  ON 17
ci_19                 9.300838e-03 3 1  ON 18
ci_20                 6.393529e-03 3 1  ON 19
ci_21                 9.004388e-03 3 1  ON 20
ci_22                 8.265545e-03 3 1  ON 21
ci_23                 4.758674e-03 3 1  ON 22
ci_24                 3.983967e-03 3 1  ON 23
ci_25                 2.848993e-03 3 1  ON 24
ci_26                 3.142556e-03 3 1  ON 25
ci_27                 3.318133e-03 3 1  ON 26
ci_28                 1.931044e-03 3 1  ON 27
ci_29                 1.304642e-03 3 1  ON 28
ci_30                -1.836467e-03 3 1  ON 29
ci_31                -5.566880e-04 3 1  ON 30
ci_32                -8.449787e-04 3 1  ON 31
ci_33                -1.469354e-03 3 1  ON 32
ci_34                 1.139074e-03 3 1  ON 33
ci_35                 1.458256e-03 3 1  ON 34
ci_36                -1.023870e-03 3 1  ON 35
ci_37                -1.033170e-03 3 1  ON 36
ci_38                -7.698959e-04 3 1  ON 37
ci_39                -6.235270e-04 3 1  ON 38
ci_40                -1.564333e-03 3 1  ON 39
ci_41                -1.245666e-03 3 1  ON 40
ci_42                -1.166123e-03 3 1  ON 41
ci_43                -2.482655e-03 3 1  ON 42
ci_44                -3.243849e-03 3 1  ON 43
ci_45                -5.291680e-04 3 1  ON 44
ci_46                -8.704311e-04 3 1  ON 45
ci_47                 1.539370e-03 3 1  ON 46
ci_48                 1.376244e-03 3 1  ON 47
ci_49                -1.040361e-03 3 1  ON 48
ci_50                -8.129712e-04 3 1  ON 49
ci_51                 1.460426e-04 3 1  ON 50
ci_52                 8.300831e-05 3 1  ON 51
ci_53                -6.379614e-04 3 1  ON 52
ci_54                -1.026723e-03 3 1  ON 53
ci_55                -6.526728e-04 3 1  ON 54
ci_56                 2.627239e-03 3 1  ON 55
ci_57                 1.621525e-03 3 1  ON 56
ci_58                -1.116183e-03 3 1  ON 57
ci_59                -1.464141e-03 3 1  ON 58
ci_60                 5.452836e-04 3 1  ON 59
ci_61                -1.272416e-04 3 1  ON 60
ci_62                -6.691305e-04 3 1  ON 61
ci_63                -7.735749e-04 3 1  ON 62
ci_64                -2.615385e-04 3 1  ON 63
ci_65                 6.185138e-05 3 1  ON 64
ci_66                -7.132629e-04 3 1  ON 65
ci_67                -8.967838e-04 3 1  ON 66
ci_68                -1.372694e-03 3 1  ON 67
ci_69                 1.334874e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2453e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8893
    reference variance = 0.612943
====================================================
  Execution time = 4.3012e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4531e-01
  Total weights = 1.964515149e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433818039631
                                         uncertainty =       0.002050419203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433818039631
                                         uncertainty =       0.002050419203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465741678
  error estimate for blocks of size 2^( 2) =       0.000491086804
  error estimate for blocks of size 2^( 3) =       0.000515264579
  error estimate for blocks of size 2^( 4) =       0.000532771497
  error estimate for blocks of size 2^( 5) =       0.000544778940
  error estimate for blocks of size 2^( 6) =       0.000550870845
  error estimate for blocks of size 2^( 7) =       0.000552889086

      target function =      -0.749224075138
              le_mean =     -22.814634657341
             les_mean =     520.952867599553
             stat err =       0.000545327592
             autocorr =       1.370959854861
   target nu stat err =       0.000545327592
   target dn stat err =       0.002826651882
      target stat err =       0.002430982478
              std dev =       0.658658197695
             le_variance =       0.433830621390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281463465734e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749231012423       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749232167660       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749232386461       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749232410916       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749232415674       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749232417060       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749232415950       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749232415618       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749232415622       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749232415800       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.461387e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749231012423       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749231301951       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749231356727       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749231362839       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749231364025       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749231364369       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749231364091       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749231364008       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749231364010       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749231364054       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 3.661280e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749231012423       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749231084850       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749231098549       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749231100077       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749231100373       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749231100459       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749231100389       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749231100369       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749231100369       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749231100380       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 9.158096e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187371 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0665e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.272804e-01 3 1  ON 0
ci_02                -2.888160e-02 3 1  ON 1
ci_03                -2.898935e-02 3 1  ON 2
ci_04                 2.691549e-02 3 1  ON 3
ci_05                -2.207909e-02 3 1  ON 4
ci_06                -2.177205e-02 3 1  ON 5
ci_07                 2.739286e-02 3 1  ON 6
ci_08                -5.571670e-03 3 1  ON 7
ci_09                -9.048347e-03 3 1  ON 8
ci_10                -8.351298e-03 3 1  ON 9
ci_11                 1.321801e-02 3 1  ON 10
ci_12                 6.947936e-03 3 1  ON 11
ci_13                 1.283195e-02 3 1  ON 12
ci_14                 1.270506e-02 3 1  ON 13
ci_15                 6.266977e-03 3 1  ON 14
ci_16                 6.429769e-03 3 1  ON 15
ci_17                -7.245165e-03 3 1  ON 16
ci_18                -5.939614e-03 3 1  ON 17
ci_19                 9.301198e-03 3 1  ON 18
ci_20                 6.394361e-03 3 1  ON 19
ci_21                 9.003948e-03 3 1  ON 20
ci_22                 8.265489e-03 3 1  ON 21
ci_23                 4.759069e-03 3 1  ON 22
ci_24                 3.983442e-03 3 1  ON 23
ci_25                 2.848897e-03 3 1  ON 24
ci_26                 3.142290e-03 3 1  ON 25
ci_27                 3.318262e-03 3 1  ON 26
ci_28                 1.930566e-03 3 1  ON 27
ci_29                 1.305492e-03 3 1  ON 28
ci_30                -1.836423e-03 3 1  ON 29
ci_31                -5.581388e-04 3 1  ON 30
ci_32                -8.445519e-04 3 1  ON 31
ci_33                -1.468316e-03 3 1  ON 32
ci_34                 1.139030e-03 3 1  ON 33
ci_35                 1.459287e-03 3 1  ON 34
ci_36                -1.023936e-03 3 1  ON 35
ci_37                -1.033097e-03 3 1  ON 36
ci_38                -7.690504e-04 3 1  ON 37
ci_39                -6.232248e-04 3 1  ON 38
ci_40                -1.564809e-03 3 1  ON 39
ci_41                -1.245659e-03 3 1  ON 40
ci_42                -1.166060e-03 3 1  ON 41
ci_43                -2.481465e-03 3 1  ON 42
ci_44                -3.242020e-03 3 1  ON 43
ci_45                -5.290742e-04 3 1  ON 44
ci_46                -8.697263e-04 3 1  ON 45
ci_47                 1.539712e-03 3 1  ON 46
ci_48                 1.376425e-03 3 1  ON 47
ci_49                -1.040331e-03 3 1  ON 48
ci_50                -8.134068e-04 3 1  ON 49
ci_51                 1.461942e-04 3 1  ON 50
ci_52                 8.286538e-05 3 1  ON 51
ci_53                -6.371398e-04 3 1  ON 52
ci_54                -1.026653e-03 3 1  ON 53
ci_55                -6.529314e-04 3 1  ON 54
ci_56                 2.628449e-03 3 1  ON 55
ci_57                 1.622541e-03 3 1  ON 56
ci_58                -1.116208e-03 3 1  ON 57
ci_59                -1.463236e-03 3 1  ON 58
ci_60                 5.472163e-04 3 1  ON 59
ci_61                -1.273514e-04 3 1  ON 60
ci_62                -6.693102e-04 3 1  ON 61
ci_63                -7.734698e-04 3 1  ON 62
ci_64                -2.623685e-04 3 1  ON 63
ci_65                 6.186497e-05 3 1  ON 64
ci_66                -7.134064e-04 3 1  ON 65
ci_67                -8.963969e-04 3 1  ON 66
ci_68                -1.373172e-03 3 1  ON 67
ci_69                 1.327038e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8725
    reference variance = 0.484983
====================================================
  Execution time = 4.3527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4837e-01
  Total weights = 1.9643e+06
  Execution time = 5.9116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436682325129
                                         uncertainty =       0.002258903565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436682325129
                                         uncertainty =       0.002258903565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467238764
  error estimate for blocks of size 2^( 2) =       0.000492941252
  error estimate for blocks of size 2^( 3) =       0.000517007907
  error estimate for blocks of size 2^( 4) =       0.000534866172
  error estimate for blocks of size 2^( 5) =       0.000546276591
  error estimate for blocks of size 2^( 6) =       0.000552097848
  error estimate for blocks of size 2^( 7) =       0.000553537307

      target function =      -0.746695163267
              le_mean =     -22.815402648649
             les_mean =     520.990964228358
             stat err =       0.000546694479
             autocorr =       1.369025834514
   target nu stat err =       0.000546694479
   target dn stat err =       0.002786719574
      target stat err =       0.002386242122
              std dev =       0.660775396912
             le_variance =       0.436624125165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436681066265
                                         uncertainty =       0.002258796635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436681066265
                                         uncertainty =       0.002258796635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467238088
  error estimate for blocks of size 2^( 2) =       0.000492941172
  error estimate for blocks of size 2^( 3) =       0.000517008323
  error estimate for blocks of size 2^( 4) =       0.000534866977
  error estimate for blocks of size 2^( 5) =       0.000546277672
  error estimate for blocks of size 2^( 6) =       0.000552099017
  error estimate for blocks of size 2^( 7) =       0.000553538843

      target function =      -0.746686900321
              le_mean =     -22.815402690848
             les_mean =     520.990976106902
             stat err =       0.000546695627
             autocorr =       1.369035545812
   target nu stat err =       0.000546695627
   target dn stat err =       0.002790732808
      target stat err =       0.002389406230
              std dev =       0.660774440751
             le_variance =       0.436622861550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436681691030
                                         uncertainty =       0.002258849894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436681691030
                                         uncertainty =       0.002258849894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467238423
  error estimate for blocks of size 2^( 2) =       0.000492941210
  error estimate for blocks of size 2^( 3) =       0.000517008114
  error estimate for blocks of size 2^( 4) =       0.000534866574
  error estimate for blocks of size 2^( 5) =       0.000546277131
  error estimate for blocks of size 2^( 6) =       0.000552098432
  error estimate for blocks of size 2^( 7) =       0.000553538075

      target function =      -0.746691152882
              le_mean =     -22.815402669442
             les_mean =     520.990970007473
             stat err =       0.000546695053
             autocorr =       1.369030702882
   target nu stat err =       0.000546695053
   target dn stat err =       0.002788717548
      target stat err =       0.002387817982
              std dev =       0.660774915299
             le_variance =       0.436623488689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436682245464
                                         uncertainty =       0.002258896843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436682245464
                                         uncertainty =       0.002258896843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467238721
  error estimate for blocks of size 2^( 2) =       0.000492941247
  error estimate for blocks of size 2^( 3) =       0.000517007933
  error estimate for blocks of size 2^( 4) =       0.000534866222
  error estimate for blocks of size 2^( 5) =       0.000546276658
  error estimate for blocks of size 2^( 6) =       0.000552097921
  error estimate for blocks of size 2^( 7) =       0.000553537403

      target function =      -0.746694675297
              le_mean =     -22.815402651211
             les_mean =     520.990964932935
             stat err =       0.000546694551
             autocorr =       1.369026443641
   target nu stat err =       0.000546694551
   target dn stat err =       0.002786968124
      target stat err =       0.002386438226
              std dev =       0.660775336406
             le_variance =       0.436624045203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746695163267        initial  <--
     1.5259e+01     1.5259e+02             1.4614e-05        -0.746686900321
     6.1035e+01     6.1035e+02             3.6613e-06        -0.746691152882
     2.4414e+02     2.4414e+03             9.1581e-07        -0.746694675297

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 77.2696
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.272840e-01 3 1  ON 0
ci_02                -2.888527e-02 3 1  ON 1
ci_03                -2.899061e-02 3 1  ON 2
ci_04                 2.691666e-02 3 1  ON 3
ci_05                -2.207915e-02 3 1  ON 4
ci_06                -2.177253e-02 3 1  ON 5
ci_07                 2.739378e-02 3 1  ON 6
ci_08                -5.573449e-03 3 1  ON 7
ci_09                -9.048910e-03 3 1  ON 8
ci_10                -8.352144e-03 3 1  ON 9
ci_11                 1.321840e-02 3 1  ON 10
ci_12                 6.948119e-03 3 1  ON 11
ci_13                 1.283244e-02 3 1  ON 12
ci_14                 1.270493e-02 3 1  ON 13
ci_15                 6.266992e-03 3 1  ON 14
ci_16                 6.429015e-03 3 1  ON 15
ci_17                -7.247445e-03 3 1  ON 16
ci_18                -5.940881e-03 3 1  ON 17
ci_19                 9.300838e-03 3 1  ON 18
ci_20                 6.393529e-03 3 1  ON 19
ci_21                 9.004388e-03 3 1  ON 20
ci_22                 8.265545e-03 3 1  ON 21
ci_23                 4.758674e-03 3 1  ON 22
ci_24                 3.983967e-03 3 1  ON 23
ci_25                 2.848993e-03 3 1  ON 24
ci_26                 3.142556e-03 3 1  ON 25
ci_27                 3.318133e-03 3 1  ON 26
ci_28                 1.931044e-03 3 1  ON 27
ci_29                 1.304642e-03 3 1  ON 28
ci_30                -1.836467e-03 3 1  ON 29
ci_31                -5.566880e-04 3 1  ON 30
ci_32                -8.449787e-04 3 1  ON 31
ci_33                -1.469354e-03 3 1  ON 32
ci_34                 1.139074e-03 3 1  ON 33
ci_35                 1.458256e-03 3 1  ON 34
ci_36                -1.023870e-03 3 1  ON 35
ci_37                -1.033170e-03 3 1  ON 36
ci_38                -7.698959e-04 3 1  ON 37
ci_39                -6.235270e-04 3 1  ON 38
ci_40                -1.564333e-03 3 1  ON 39
ci_41                -1.245666e-03 3 1  ON 40
ci_42                -1.166123e-03 3 1  ON 41
ci_43                -2.482655e-03 3 1  ON 42
ci_44                -3.243849e-03 3 1  ON 43
ci_45                -5.291680e-04 3 1  ON 44
ci_46                -8.704311e-04 3 1  ON 45
ci_47                 1.539370e-03 3 1  ON 46
ci_48                 1.376244e-03 3 1  ON 47
ci_49                -1.040361e-03 3 1  ON 48
ci_50                -8.129712e-04 3 1  ON 49
ci_51                 1.460426e-04 3 1  ON 50
ci_52                 8.300831e-05 3 1  ON 51
ci_53                -6.379614e-04 3 1  ON 52
ci_54                -1.026723e-03 3 1  ON 53
ci_55                -6.526728e-04 3 1  ON 54
ci_56                 2.627239e-03 3 1  ON 55
ci_57                 1.621525e-03 3 1  ON 56
ci_58                -1.116183e-03 3 1  ON 57
ci_59                -1.464141e-03 3 1  ON 58
ci_60                 5.452836e-04 3 1  ON 59
ci_61                -1.272416e-04 3 1  ON 60
ci_62                -6.691305e-04 3 1  ON 61
ci_63                -7.735749e-04 3 1  ON 62
ci_64                -2.615385e-04 3 1  ON 63
ci_65                 6.185138e-05 3 1  ON 64
ci_66                -7.132629e-04 3 1  ON 65
ci_67                -8.967838e-04 3 1  ON 66
ci_68                -1.372694e-03 3 1  ON 67
ci_69                 1.334874e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2794e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7865
    reference variance = 0.374656
====================================================
  Execution time = 4.3264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4736e-01
  Total weights = 1.964164158e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6543e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433688936178
                                         uncertainty =       0.001970740143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433688936178
                                         uncertainty =       0.001970740143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465670154
  error estimate for blocks of size 2^( 2) =       0.000490933090
  error estimate for blocks of size 2^( 3) =       0.000515204258
  error estimate for blocks of size 2^( 4) =       0.000532935644
  error estimate for blocks of size 2^( 5) =       0.000543752381
  error estimate for blocks of size 2^( 6) =       0.000550439363
  error estimate for blocks of size 2^( 7) =       0.000555972125

      target function =      -0.747526071261
              le_mean =     -22.814560082515
             les_mean =     520.951507993914
             stat err =       0.000545774878
             autocorr =       1.373631609932
   target nu stat err =       0.000545774878
   target dn stat err =       0.002752340610
      target stat err =       0.002360577471
              std dev =       0.658557046823
             le_variance =       0.433697383921


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281456008252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747532538747       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747532619446       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747532627737       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747532629567       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747532630628       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747532631125       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747532631571       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747532631568       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747532631541       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747532631537       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 1.025521e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747532538747       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747532558927       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747532560999       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747532561457       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747532561722       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747532561847       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747532561957       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747532561957       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747532561951       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747532561950       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 2.564052e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747532538747       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747532543792       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747532544310       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747532544425       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747532544495       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747532544521       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747532544551       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747532544551       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747532544548       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747532544546       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 6.410286e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0928e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.272839e-01 3 1  ON 0
ci_02                -2.888520e-02 3 1  ON 1
ci_03                -2.899056e-02 3 1  ON 2
ci_04                 2.691648e-02 3 1  ON 3
ci_05                -2.207899e-02 3 1  ON 4
ci_06                -2.177243e-02 3 1  ON 5
ci_07                 2.739355e-02 3 1  ON 6
ci_08                -5.573444e-03 3 1  ON 7
ci_09                -9.048863e-03 3 1  ON 8
ci_10                -8.352036e-03 3 1  ON 9
ci_11                 1.321841e-02 3 1  ON 10
ci_12                 6.948016e-03 3 1  ON 11
ci_13                 1.283244e-02 3 1  ON 12
ci_14                 1.270484e-02 3 1  ON 13
ci_15                 6.267075e-03 3 1  ON 14
ci_16                 6.429005e-03 3 1  ON 15
ci_17                -7.247365e-03 3 1  ON 16
ci_18                -5.940889e-03 3 1  ON 17
ci_19                 9.300928e-03 3 1  ON 18
ci_20                 6.393498e-03 3 1  ON 19
ci_21                 9.004320e-03 3 1  ON 20
ci_22                 8.265425e-03 3 1  ON 21
ci_23                 4.758751e-03 3 1  ON 22
ci_24                 3.983962e-03 3 1  ON 23
ci_25                 2.849038e-03 3 1  ON 24
ci_26                 3.142552e-03 3 1  ON 25
ci_27                 3.317989e-03 3 1  ON 26
ci_28                 1.931129e-03 3 1  ON 27
ci_29                 1.304782e-03 3 1  ON 28
ci_30                -1.836357e-03 3 1  ON 29
ci_31                -5.566349e-04 3 1  ON 30
ci_32                -8.449677e-04 3 1  ON 31
ci_33                -1.469326e-03 3 1  ON 32
ci_34                 1.138989e-03 3 1  ON 33
ci_35                 1.458190e-03 3 1  ON 34
ci_36                -1.023866e-03 3 1  ON 35
ci_37                -1.033231e-03 3 1  ON 36
ci_38                -7.698348e-04 3 1  ON 37
ci_39                -6.234901e-04 3 1  ON 38
ci_40                -1.564330e-03 3 1  ON 39
ci_41                -1.245721e-03 3 1  ON 40
ci_42                -1.166152e-03 3 1  ON 41
ci_43                -2.482693e-03 3 1  ON 42
ci_44                -3.243678e-03 3 1  ON 43
ci_45                -5.291935e-04 3 1  ON 44
ci_46                -8.703536e-04 3 1  ON 45
ci_47                 1.539402e-03 3 1  ON 46
ci_48                 1.376286e-03 3 1  ON 47
ci_49                -1.040411e-03 3 1  ON 48
ci_50                -8.129903e-04 3 1  ON 49
ci_51                 1.460035e-04 3 1  ON 50
ci_52                 8.300400e-05 3 1  ON 51
ci_53                -6.379748e-04 3 1  ON 52
ci_54                -1.026718e-03 3 1  ON 53
ci_55                -6.526728e-04 3 1  ON 54
ci_56                 2.627157e-03 3 1  ON 55
ci_57                 1.621503e-03 3 1  ON 56
ci_58                -1.116117e-03 3 1  ON 57
ci_59                -1.464064e-03 3 1  ON 58
ci_60                 5.452774e-04 3 1  ON 59
ci_61                -1.274981e-04 3 1  ON 60
ci_62                -6.691918e-04 3 1  ON 61
ci_63                -7.734860e-04 3 1  ON 62
ci_64                -2.615354e-04 3 1  ON 63
ci_65                 6.178471e-05 3 1  ON 64
ci_66                -7.132478e-04 3 1  ON 65
ci_67                -8.967624e-04 3 1  ON 66
ci_68                -1.372590e-03 3 1  ON 67
ci_69                 1.335265e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8551
    reference variance = 0.482116
====================================================
  Execution time = 4.2148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4776e-01
  Total weights = 1.9642e+06
  Execution time = 5.9393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435235513779
                                         uncertainty =       0.002085875195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435235513779
                                         uncertainty =       0.002085875195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466492592
  error estimate for blocks of size 2^( 2) =       0.000491927354
  error estimate for blocks of size 2^( 3) =       0.000515797106
  error estimate for blocks of size 2^( 4) =       0.000532885181
  error estimate for blocks of size 2^( 5) =       0.000544604241
  error estimate for blocks of size 2^( 6) =       0.000551460445
  error estimate for blocks of size 2^( 7) =       0.000556718986

      target function =      -0.747189618996
              le_mean =     -22.814095308901
             les_mean =     520.930699713656
             stat err =       0.000546417213
             autocorr =       1.372016208754
   target nu stat err =       0.000546417213
   target dn stat err =       0.003139992912
      target stat err =       0.002668450853
              std dev =       0.659720149754
             le_variance =       0.435230675992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435235401748
                                         uncertainty =       0.002085876358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435235401748
                                         uncertainty =       0.002085876358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466492532
  error estimate for blocks of size 2^( 2) =       0.000491927331
  error estimate for blocks of size 2^( 3) =       0.000515797126
  error estimate for blocks of size 2^( 4) =       0.000532885231
  error estimate for blocks of size 2^( 5) =       0.000544604297
  error estimate for blocks of size 2^( 6) =       0.000551460523
  error estimate for blocks of size 2^( 7) =       0.000556719065

      target function =      -0.747175106352
              le_mean =     -22.814095309749
             les_mean =     520.930717287587
             stat err =       0.000546417279
             autocorr =       1.372016888116
   target nu stat err =       0.000546417279
   target dn stat err =       0.003139982841
      target stat err =       0.002668341762
              std dev =       0.659720065809
             le_variance =       0.435230565231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435235457731
                                         uncertainty =       0.002085875776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435235457731
                                         uncertainty =       0.002085875776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466492562
  error estimate for blocks of size 2^( 2) =       0.000491927342
  error estimate for blocks of size 2^( 3) =       0.000515797116
  error estimate for blocks of size 2^( 4) =       0.000532885206
  error estimate for blocks of size 2^( 5) =       0.000544604269
  error estimate for blocks of size 2^( 6) =       0.000551460484
  error estimate for blocks of size 2^( 7) =       0.000556719025

      target function =      -0.747183159660
              le_mean =     -22.814095309314
             les_mean =     520.930707537185
             stat err =       0.000546417246
             autocorr =       1.372016548570
   target nu stat err =       0.000546417246
   target dn stat err =       0.003139970849
      target stat err =       0.002668388128
              std dev =       0.659720107757
             le_variance =       0.435230620579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435235506771
                                         uncertainty =       0.002085875267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435235506771
                                         uncertainty =       0.002085875267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466492588
  error estimate for blocks of size 2^( 2) =       0.000491927352
  error estimate for blocks of size 2^( 3) =       0.000515797108
  error estimate for blocks of size 2^( 4) =       0.000532885184
  error estimate for blocks of size 2^( 5) =       0.000544604245
  error estimate for blocks of size 2^( 6) =       0.000551460450
  error estimate for blocks of size 2^( 7) =       0.000556718991

      target function =      -0.747189441154
              le_mean =     -22.814095308953
             les_mean =     520.930699930923
             stat err =       0.000546417217
             autocorr =       1.372016251235
   target nu stat err =       0.000546417217
   target dn stat err =       0.003139987360
      target stat err =       0.002668445141
              std dev =       0.659720144503
             le_variance =       0.435230669063


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747189618996        initial  <--
     1.5259e+02     1.5259e+03             1.0255e-06        -0.747175106352
     6.1035e+02     6.1035e+03             2.5641e-07        -0.747183159660
     2.4414e+03     2.4414e+04             6.4103e-08        -0.747189441154

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.5892
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.272840e-01 3 1  ON 0
ci_02                -2.888527e-02 3 1  ON 1
ci_03                -2.899061e-02 3 1  ON 2
ci_04                 2.691666e-02 3 1  ON 3
ci_05                -2.207915e-02 3 1  ON 4
ci_06                -2.177253e-02 3 1  ON 5
ci_07                 2.739378e-02 3 1  ON 6
ci_08                -5.573449e-03 3 1  ON 7
ci_09                -9.048910e-03 3 1  ON 8
ci_10                -8.352144e-03 3 1  ON 9
ci_11                 1.321840e-02 3 1  ON 10
ci_12                 6.948119e-03 3 1  ON 11
ci_13                 1.283244e-02 3 1  ON 12
ci_14                 1.270493e-02 3 1  ON 13
ci_15                 6.266992e-03 3 1  ON 14
ci_16                 6.429015e-03 3 1  ON 15
ci_17                -7.247445e-03 3 1  ON 16
ci_18                -5.940881e-03 3 1  ON 17
ci_19                 9.300838e-03 3 1  ON 18
ci_20                 6.393529e-03 3 1  ON 19
ci_21                 9.004388e-03 3 1  ON 20
ci_22                 8.265545e-03 3 1  ON 21
ci_23                 4.758674e-03 3 1  ON 22
ci_24                 3.983967e-03 3 1  ON 23
ci_25                 2.848993e-03 3 1  ON 24
ci_26                 3.142556e-03 3 1  ON 25
ci_27                 3.318133e-03 3 1  ON 26
ci_28                 1.931044e-03 3 1  ON 27
ci_29                 1.304642e-03 3 1  ON 28
ci_30                -1.836467e-03 3 1  ON 29
ci_31                -5.566880e-04 3 1  ON 30
ci_32                -8.449787e-04 3 1  ON 31
ci_33                -1.469354e-03 3 1  ON 32
ci_34                 1.139074e-03 3 1  ON 33
ci_35                 1.458256e-03 3 1  ON 34
ci_36                -1.023870e-03 3 1  ON 35
ci_37                -1.033170e-03 3 1  ON 36
ci_38                -7.698959e-04 3 1  ON 37
ci_39                -6.235270e-04 3 1  ON 38
ci_40                -1.564333e-03 3 1  ON 39
ci_41                -1.245666e-03 3 1  ON 40
ci_42                -1.166123e-03 3 1  ON 41
ci_43                -2.482655e-03 3 1  ON 42
ci_44                -3.243849e-03 3 1  ON 43
ci_45                -5.291680e-04 3 1  ON 44
ci_46                -8.704311e-04 3 1  ON 45
ci_47                 1.539370e-03 3 1  ON 46
ci_48                 1.376244e-03 3 1  ON 47
ci_49                -1.040361e-03 3 1  ON 48
ci_50                -8.129712e-04 3 1  ON 49
ci_51                 1.460426e-04 3 1  ON 50
ci_52                 8.300831e-05 3 1  ON 51
ci_53                -6.379614e-04 3 1  ON 52
ci_54                -1.026723e-03 3 1  ON 53
ci_55                -6.526728e-04 3 1  ON 54
ci_56                 2.627239e-03 3 1  ON 55
ci_57                 1.621525e-03 3 1  ON 56
ci_58                -1.116183e-03 3 1  ON 57
ci_59                -1.464141e-03 3 1  ON 58
ci_60                 5.452836e-04 3 1  ON 59
ci_61                -1.272416e-04 3 1  ON 60
ci_62                -6.691305e-04 3 1  ON 61
ci_63                -7.735749e-04 3 1  ON 62
ci_64                -2.615385e-04 3 1  ON 63
ci_65                 6.185138e-05 3 1  ON 64
ci_66                -7.132629e-04 3 1  ON 65
ci_67                -8.967838e-04 3 1  ON 66
ci_68                -1.372694e-03 3 1  ON 67
ci_69                 1.334874e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2353e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7869
    reference variance = 0.447398
====================================================
  Execution time = 4.3065e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4457e-01
  Total weights = 1.964670476e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432513779545
                                         uncertainty =       0.001835273316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432513779545
                                         uncertainty =       0.001835273316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465029646
  error estimate for blocks of size 2^( 2) =       0.000490642396
  error estimate for blocks of size 2^( 3) =       0.000514357515
  error estimate for blocks of size 2^( 4) =       0.000531617836
  error estimate for blocks of size 2^( 5) =       0.000541503588
  error estimate for blocks of size 2^( 6) =       0.000547167687
  error estimate for blocks of size 2^( 7) =       0.000549729646

      target function =      -0.749847179149
              le_mean =     -22.814745560462
             les_mean =     520.957184426780
             stat err =       0.000542504689
             autocorr =       1.360961098022
   target nu stat err =       0.000542504689
   target dn stat err =       0.002428548937
      target stat err =       0.002114326772
              std dev =       0.657651232871
             le_variance =       0.432505144097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281474556046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749852173935       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749852181473       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749852183058       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749852183293       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749852183497       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749852183497       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749852183522       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749852183529       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749852183530       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 2.064798e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749852173935       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749852175819       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749852176216       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749852176276       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749852176326       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749852176326       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749852176337       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749852176334       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749852176324       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 5.162059e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749852173935       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749852174406       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749852174505       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749852174520       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749852174523       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749852174520       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749852174534       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749852174535       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749852174524       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 1.290519e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0758e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.272839e-01 3 1  ON 0
ci_02                -2.888525e-02 3 1  ON 1
ci_03                -2.899060e-02 3 1  ON 2
ci_04                 2.691665e-02 3 1  ON 3
ci_05                -2.207913e-02 3 1  ON 4
ci_06                -2.177253e-02 3 1  ON 5
ci_07                 2.739377e-02 3 1  ON 6
ci_08                -5.573443e-03 3 1  ON 7
ci_09                -9.048914e-03 3 1  ON 8
ci_10                -8.352144e-03 3 1  ON 9
ci_11                 1.321839e-02 3 1  ON 10
ci_12                 6.948121e-03 3 1  ON 11
ci_13                 1.283244e-02 3 1  ON 12
ci_14                 1.270494e-02 3 1  ON 13
ci_15                 6.266981e-03 3 1  ON 14
ci_16                 6.429011e-03 3 1  ON 15
ci_17                -7.247416e-03 3 1  ON 16
ci_18                -5.940895e-03 3 1  ON 17
ci_19                 9.300838e-03 3 1  ON 18
ci_20                 6.393529e-03 3 1  ON 19
ci_21                 9.004388e-03 3 1  ON 20
ci_22                 8.265540e-03 3 1  ON 21
ci_23                 4.758678e-03 3 1  ON 22
ci_24                 3.983963e-03 3 1  ON 23
ci_25                 2.848999e-03 3 1  ON 24
ci_26                 3.142553e-03 3 1  ON 25
ci_27                 3.318133e-03 3 1  ON 26
ci_28                 1.931040e-03 3 1  ON 27
ci_29                 1.304646e-03 3 1  ON 28
ci_30                -1.836456e-03 3 1  ON 29
ci_31                -5.566947e-04 3 1  ON 30
ci_32                -8.449818e-04 3 1  ON 31
ci_33                -1.469355e-03 3 1  ON 32
ci_34                 1.139075e-03 3 1  ON 33
ci_35                 1.458258e-03 3 1  ON 34
ci_36                -1.023869e-03 3 1  ON 35
ci_37                -1.033172e-03 3 1  ON 36
ci_38                -7.698917e-04 3 1  ON 37
ci_39                -6.235232e-04 3 1  ON 38
ci_40                -1.564331e-03 3 1  ON 39
ci_41                -1.245657e-03 3 1  ON 40
ci_42                -1.166120e-03 3 1  ON 41
ci_43                -2.482658e-03 3 1  ON 42
ci_44                -3.243847e-03 3 1  ON 43
ci_45                -5.291673e-04 3 1  ON 44
ci_46                -8.704268e-04 3 1  ON 45
ci_47                 1.539369e-03 3 1  ON 46
ci_48                 1.376250e-03 3 1  ON 47
ci_49                -1.040349e-03 3 1  ON 48
ci_50                -8.129713e-04 3 1  ON 49
ci_51                 1.460426e-04 3 1  ON 50
ci_52                 8.300675e-05 3 1  ON 51
ci_53                -6.379594e-04 3 1  ON 52
ci_54                -1.026720e-03 3 1  ON 53
ci_55                -6.526777e-04 3 1  ON 54
ci_56                 2.627235e-03 3 1  ON 55
ci_57                 1.621528e-03 3 1  ON 56
ci_58                -1.116185e-03 3 1  ON 57
ci_59                -1.464140e-03 3 1  ON 58
ci_60                 5.452677e-04 3 1  ON 59
ci_61                -1.272343e-04 3 1  ON 60
ci_62                -6.691287e-04 3 1  ON 61
ci_63                -7.735751e-04 3 1  ON 62
ci_64                -2.615344e-04 3 1  ON 63
ci_65                 6.183778e-05 3 1  ON 64
ci_66                -7.132681e-04 3 1  ON 65
ci_67                -8.967821e-04 3 1  ON 66
ci_68                -1.372688e-03 3 1  ON 67
ci_69                 1.334814e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8567
    reference variance = 0.358794
====================================================
  Execution time = 4.1517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4783e-01
  Total weights = 1.9644e+06
  Execution time = 5.9488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434338522256
                                         uncertainty =       0.001961582120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434338522256
                                         uncertainty =       0.001961582120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466020781
  error estimate for blocks of size 2^( 2) =       0.000491469674
  error estimate for blocks of size 2^( 3) =       0.000515091929
  error estimate for blocks of size 2^( 4) =       0.000532074036
  error estimate for blocks of size 2^( 5) =       0.000544725073
  error estimate for blocks of size 2^( 6) =       0.000549327761
  error estimate for blocks of size 2^( 7) =       0.000552355864

      target function =      -0.747140026148
              le_mean =     -22.814790853517
             les_mean =     520.962508050472
             stat err =       0.000544620683
             autocorr =       1.365770396840
   target nu stat err =       0.000544620683
   target dn stat err =       0.002390918500
      target stat err =       0.002070684358
              std dev =       0.659052908661
             le_variance =       0.434350736414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434338513251
                                         uncertainty =       0.001961583092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434338513251
                                         uncertainty =       0.001961583092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466020776
  error estimate for blocks of size 2^( 2) =       0.000491469674
  error estimate for blocks of size 2^( 3) =       0.000515091935
  error estimate for blocks of size 2^( 4) =       0.000532074045
  error estimate for blocks of size 2^( 5) =       0.000544725084
  error estimate for blocks of size 2^( 6) =       0.000549327772
  error estimate for blocks of size 2^( 7) =       0.000552355877

      target function =      -0.747140083657
              le_mean =     -22.814790853427
             les_mean =     520.962507976951
             stat err =       0.000544620694
             autocorr =       1.365770479474
   target nu stat err =       0.000544620694
   target dn stat err =       0.002390918033
      target stat err =       0.002070684297
              std dev =       0.659052902111
             le_variance =       0.434350727781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434338517753
                                         uncertainty =       0.001961582606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434338517753
                                         uncertainty =       0.001961582606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466020779
  error estimate for blocks of size 2^( 2) =       0.000491469674
  error estimate for blocks of size 2^( 3) =       0.000515091932
  error estimate for blocks of size 2^( 4) =       0.000532074041
  error estimate for blocks of size 2^( 5) =       0.000544725078
  error estimate for blocks of size 2^( 6) =       0.000549327766
  error estimate for blocks of size 2^( 7) =       0.000552355870

      target function =      -0.747140054922
              le_mean =     -22.814790853472
             les_mean =     520.962508013686
             stat err =       0.000544620689
             autocorr =       1.365770438152
   target nu stat err =       0.000544620689
   target dn stat err =       0.002390918266
      target stat err =       0.002070684327
              std dev =       0.659052905386
             le_variance =       0.434350732098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434338521693
                                         uncertainty =       0.001961582181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434338521693
                                         uncertainty =       0.001961582181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466020781
  error estimate for blocks of size 2^( 2) =       0.000491469674
  error estimate for blocks of size 2^( 3) =       0.000515091930
  error estimate for blocks of size 2^( 4) =       0.000532074037
  error estimate for blocks of size 2^( 5) =       0.000544725074
  error estimate for blocks of size 2^( 6) =       0.000549327761
  error estimate for blocks of size 2^( 7) =       0.000552355865

      target function =      -0.747140029747
              le_mean =     -22.814790853511
             les_mean =     520.962508045871
             stat err =       0.000544620684
             autocorr =       1.365770401999
   target nu stat err =       0.000544620684
   target dn stat err =       0.002390918470
      target stat err =       0.002070684354
              std dev =       0.659052908251
             le_variance =       0.434350735874


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747140026148        initial
     1.5259e+03     1.5259e+04             2.0648e-07        -0.747140083657  <--
     6.1035e+03     6.1035e+04             5.1621e-08        -0.747140054922
     2.4414e+04     2.4414e+05             1.2905e-08        -0.747140029747

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 7.1173e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.272838e-01 3 1  ON 0
ci_02                -2.888521e-02 3 1  ON 1
ci_03                -2.899057e-02 3 1  ON 2
ci_04                 2.691660e-02 3 1  ON 3
ci_05                -2.207909e-02 3 1  ON 4
ci_06                -2.177253e-02 3 1  ON 5
ci_07                 2.739374e-02 3 1  ON 6
ci_08                -5.573425e-03 3 1  ON 7
ci_09                -9.048924e-03 3 1  ON 8
ci_10                -8.352143e-03 3 1  ON 9
ci_11                 1.321838e-02 3 1  ON 10
ci_12                 6.948124e-03 3 1  ON 11
ci_13                 1.283245e-02 3 1  ON 12
ci_14                 1.270495e-02 3 1  ON 13
ci_15                 6.266948e-03 3 1  ON 14
ci_16                 6.428999e-03 3 1  ON 15
ci_17                -7.247327e-03 3 1  ON 16
ci_18                -5.940939e-03 3 1  ON 17
ci_19                 9.300836e-03 3 1  ON 18
ci_20                 6.393531e-03 3 1  ON 19
ci_21                 9.004386e-03 3 1  ON 20
ci_22                 8.265527e-03 3 1  ON 21
ci_23                 4.758689e-03 3 1  ON 22
ci_24                 3.983950e-03 3 1  ON 23
ci_25                 2.849017e-03 3 1  ON 24
ci_26                 3.142545e-03 3 1  ON 25
ci_27                 3.318131e-03 3 1  ON 26
ci_28                 1.931028e-03 3 1  ON 27
ci_29                 1.304657e-03 3 1  ON 28
ci_30                -1.836422e-03 3 1  ON 29
ci_31                -5.567150e-04 3 1  ON 30
ci_32                -8.449909e-04 3 1  ON 31
ci_33                -1.469360e-03 3 1  ON 32
ci_34                 1.139078e-03 3 1  ON 33
ci_35                 1.458262e-03 3 1  ON 34
ci_36                -1.023865e-03 3 1  ON 35
ci_37                -1.033177e-03 3 1  ON 36
ci_38                -7.698791e-04 3 1  ON 37
ci_39                -6.235119e-04 3 1  ON 38
ci_40                -1.564327e-03 3 1  ON 39
ci_41                -1.245631e-03 3 1  ON 40
ci_42                -1.166113e-03 3 1  ON 41
ci_43                -2.482667e-03 3 1  ON 42
ci_44                -3.243840e-03 3 1  ON 43
ci_45                -5.291651e-04 3 1  ON 44
ci_46                -8.704136e-04 3 1  ON 45
ci_47                 1.539367e-03 3 1  ON 46
ci_48                 1.376270e-03 3 1  ON 47
ci_49                -1.040315e-03 3 1  ON 48
ci_50                -8.129719e-04 3 1  ON 49
ci_51                 1.460425e-04 3 1  ON 50
ci_52                 8.300205e-05 3 1  ON 51
ci_53                -6.379534e-04 3 1  ON 52
ci_54                -1.026711e-03 3 1  ON 53
ci_55                -6.526923e-04 3 1  ON 54
ci_56                 2.627220e-03 3 1  ON 55
ci_57                 1.621535e-03 3 1  ON 56
ci_58                -1.116190e-03 3 1  ON 57
ci_59                -1.464135e-03 3 1  ON 58
ci_60                 5.452201e-04 3 1  ON 59
ci_61                -1.272121e-04 3 1  ON 60
ci_62                -6.691232e-04 3 1  ON 61
ci_63                -7.735758e-04 3 1  ON 62
ci_64                -2.615219e-04 3 1  ON 63
ci_65                 6.179699e-05 3 1  ON 64
ci_66                -7.132836e-04 3 1  ON 65
ci_67                -8.967769e-04 3 1  ON 66
ci_68                -1.372670e-03 3 1  ON 67
ci_69                 1.334635e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2196e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8216
    reference variance = 0.456595
====================================================
  Execution time = 4.4384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4841e-01
  Total weights = 1.964120349e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434377464266
                                         uncertainty =       0.002009011889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434377464266
                                         uncertainty =       0.002009011889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466029671
  error estimate for blocks of size 2^( 2) =       0.000491456034
  error estimate for blocks of size 2^( 3) =       0.000514932608
  error estimate for blocks of size 2^( 4) =       0.000532056634
  error estimate for blocks of size 2^( 5) =       0.000543071395
  error estimate for blocks of size 2^( 6) =       0.000549194633
  error estimate for blocks of size 2^( 7) =       0.000554197220

      target function =      -0.746660493288
              le_mean =     -22.815485120925
             les_mean =     520.994768999304
             stat err =       0.000544629971
             autocorr =       1.365764867183
   target nu stat err =       0.000544629971
   target dn stat err =       0.002944844480
      target stat err =       0.002512652974
              std dev =       0.659065481312
             le_variance =       0.434367308657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281548512092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746667966196       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746668001573       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746668006167       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746668008037       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746668008717       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746668008982       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746668009029       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746668009036       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746668009034       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746668009029       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 6.249287e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746667966196       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746667975041       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746667976190       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746667976658       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746667976828       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746667976896       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746667976905       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746667976905       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746667976905       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746667976908       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.562398e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746667966196       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746667968408       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746667968695       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746667968812       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746667968850       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746667968871       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746667968874       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746667968875       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746667968871       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746667968864       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 3.906044e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2082e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.272836e-01 3 1  ON 0
ci_02                -2.888514e-02 3 1  ON 1
ci_03                -2.899057e-02 3 1  ON 2
ci_04                 2.691650e-02 3 1  ON 3
ci_05                -2.207906e-02 3 1  ON 4
ci_06                -2.177249e-02 3 1  ON 5
ci_07                 2.739372e-02 3 1  ON 6
ci_08                -5.573414e-03 3 1  ON 7
ci_09                -9.048875e-03 3 1  ON 8
ci_10                -8.352115e-03 3 1  ON 9
ci_11                 1.321838e-02 3 1  ON 10
ci_12                 6.948120e-03 3 1  ON 11
ci_13                 1.283248e-02 3 1  ON 12
ci_14                 1.270500e-02 3 1  ON 13
ci_15                 6.266979e-03 3 1  ON 14
ci_16                 6.429013e-03 3 1  ON 15
ci_17                -7.247304e-03 3 1  ON 16
ci_18                -5.940911e-03 3 1  ON 17
ci_19                 9.300846e-03 3 1  ON 18
ci_20                 6.393524e-03 3 1  ON 19
ci_21                 9.004377e-03 3 1  ON 20
ci_22                 8.265540e-03 3 1  ON 21
ci_23                 4.758692e-03 3 1  ON 22
ci_24                 3.984005e-03 3 1  ON 23
ci_25                 2.849012e-03 3 1  ON 24
ci_26                 3.142542e-03 3 1  ON 25
ci_27                 3.318145e-03 3 1  ON 26
ci_28                 1.931072e-03 3 1  ON 27
ci_29                 1.304646e-03 3 1  ON 28
ci_30                -1.836373e-03 3 1  ON 29
ci_31                -5.567008e-04 3 1  ON 30
ci_32                -8.449401e-04 3 1  ON 31
ci_33                -1.469338e-03 3 1  ON 32
ci_34                 1.139098e-03 3 1  ON 33
ci_35                 1.458289e-03 3 1  ON 34
ci_36                -1.023817e-03 3 1  ON 35
ci_37                -1.033165e-03 3 1  ON 36
ci_38                -7.698850e-04 3 1  ON 37
ci_39                -6.235147e-04 3 1  ON 38
ci_40                -1.564306e-03 3 1  ON 39
ci_41                -1.245630e-03 3 1  ON 40
ci_42                -1.166167e-03 3 1  ON 41
ci_43                -2.482648e-03 3 1  ON 42
ci_44                -3.243790e-03 3 1  ON 43
ci_45                -5.291548e-04 3 1  ON 44
ci_46                -8.703950e-04 3 1  ON 45
ci_47                 1.539391e-03 3 1  ON 46
ci_48                 1.376294e-03 3 1  ON 47
ci_49                -1.040295e-03 3 1  ON 48
ci_50                -8.129365e-04 3 1  ON 49
ci_51                 1.460468e-04 3 1  ON 50
ci_52                 8.302163e-05 3 1  ON 51
ci_53                -6.379553e-04 3 1  ON 52
ci_54                -1.026712e-03 3 1  ON 53
ci_55                -6.526916e-04 3 1  ON 54
ci_56                 2.627188e-03 3 1  ON 55
ci_57                 1.621543e-03 3 1  ON 56
ci_58                -1.116159e-03 3 1  ON 57
ci_59                -1.464141e-03 3 1  ON 58
ci_60                 5.452101e-04 3 1  ON 59
ci_61                -1.271993e-04 3 1  ON 60
ci_62                -6.691372e-04 3 1  ON 61
ci_63                -7.735753e-04 3 1  ON 62
ci_64                -2.615079e-04 3 1  ON 63
ci_65                 6.178185e-05 3 1  ON 64
ci_66                -7.132622e-04 3 1  ON 65
ci_67                -8.967215e-04 3 1  ON 66
ci_68                -1.372652e-03 3 1  ON 67
ci_69                 1.334459e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8167
    reference variance = 0.323339
====================================================
  Execution time = 4.2500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4870e-01
  Total weights = 1.9644e+06
  Execution time = 5.9418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436246673319
                                         uncertainty =       0.001794752489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436246673319
                                         uncertainty =       0.001794752489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467029982
  error estimate for blocks of size 2^( 2) =       0.000492173571
  error estimate for blocks of size 2^( 3) =       0.000515660577
  error estimate for blocks of size 2^( 4) =       0.000532727739
  error estimate for blocks of size 2^( 5) =       0.000544052695
  error estimate for blocks of size 2^( 6) =       0.000549442554
  error estimate for blocks of size 2^( 7) =       0.000552992997

      target function =      -0.746419425013
              le_mean =     -22.815330802889
             les_mean =     520.988018366623
             stat err =       0.000544803996
             autocorr =       1.360789800048
   target nu stat err =       0.000544803996
   target dn stat err =       0.002804529588
      target stat err =       0.002398010341
              std dev =       0.660480134638
             le_variance =       0.436234008251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436246614765
                                         uncertainty =       0.001794751584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436246614765
                                         uncertainty =       0.001794751584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467029951
  error estimate for blocks of size 2^( 2) =       0.000492173560
  error estimate for blocks of size 2^( 3) =       0.000515660585
  error estimate for blocks of size 2^( 4) =       0.000532727762
  error estimate for blocks of size 2^( 5) =       0.000544052727
  error estimate for blocks of size 2^( 6) =       0.000549442597
  error estimate for blocks of size 2^( 7) =       0.000552993046

      target function =      -0.746419468113
              le_mean =     -22.815330804567
             les_mean =     520.988018390891
             stat err =       0.000544804033
             autocorr =       1.360790166626
   target nu stat err =       0.000544804033
   target dn stat err =       0.002804563424
      target stat err =       0.002398037722
              std dev =       0.660480090224
             le_variance =       0.436233949583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436246644035
                                         uncertainty =       0.001794752037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436246644035
                                         uncertainty =       0.001794752037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467029966
  error estimate for blocks of size 2^( 2) =       0.000492173566
  error estimate for blocks of size 2^( 3) =       0.000515660581
  error estimate for blocks of size 2^( 4) =       0.000532727751
  error estimate for blocks of size 2^( 5) =       0.000544052711
  error estimate for blocks of size 2^( 6) =       0.000549442576
  error estimate for blocks of size 2^( 7) =       0.000552993021

      target function =      -0.746419447717
              le_mean =     -22.815330803728
             les_mean =     520.988018377338
             stat err =       0.000544804015
             autocorr =       1.360789983355
   target nu stat err =       0.000544804015
   target dn stat err =       0.002804546488
      target stat err =       0.002398024024
              std dev =       0.660480112426
             le_variance =       0.436233978910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436246669658
                                         uncertainty =       0.001794752433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436246669658
                                         uncertainty =       0.001794752433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467029980
  error estimate for blocks of size 2^( 2) =       0.000492173571
  error estimate for blocks of size 2^( 3) =       0.000515660577
  error estimate for blocks of size 2^( 4) =       0.000532727741
  error estimate for blocks of size 2^( 5) =       0.000544052697
  error estimate for blocks of size 2^( 6) =       0.000549442557
  error estimate for blocks of size 2^( 7) =       0.000552993000

      target function =      -0.746419427976
              le_mean =     -22.815330802994
             les_mean =     520.988018367808
             stat err =       0.000544803999
             autocorr =       1.360789822964
   target nu stat err =       0.000544803999
   target dn stat err =       0.002804531699
      target stat err =       0.002398012050
              std dev =       0.660480131861
             le_variance =       0.436234004583


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746419425013        initial
     3.8147e+02     3.8147e+03             6.2493e-07        -0.746419468113  <--
     1.5259e+03     1.5259e+04             1.5624e-07        -0.746419447717
     6.1035e+03     6.1035e+04             3.9060e-08        -0.746419427976

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 7.2154e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.272831e-01 3 1  ON 0
ci_02                -2.888492e-02 3 1  ON 1
ci_03                -2.899056e-02 3 1  ON 2
ci_04                 2.691620e-02 3 1  ON 3
ci_05                -2.207899e-02 3 1  ON 4
ci_06                -2.177234e-02 3 1  ON 5
ci_07                 2.739366e-02 3 1  ON 6
ci_08                -5.573380e-03 3 1  ON 7
ci_09                -9.048728e-03 3 1  ON 8
ci_10                -8.352033e-03 3 1  ON 9
ci_11                 1.321838e-02 3 1  ON 10
ci_12                 6.948106e-03 3 1  ON 11
ci_13                 1.283258e-02 3 1  ON 12
ci_14                 1.270515e-02 3 1  ON 13
ci_15                 6.267071e-03 3 1  ON 14
ci_16                 6.429053e-03 3 1  ON 15
ci_17                -7.247236e-03 3 1  ON 16
ci_18                -5.940826e-03 3 1  ON 17
ci_19                 9.300875e-03 3 1  ON 18
ci_20                 6.393505e-03 3 1  ON 19
ci_21                 9.004348e-03 3 1  ON 20
ci_22                 8.265580e-03 3 1  ON 21
ci_23                 4.758700e-03 3 1  ON 22
ci_24                 3.984169e-03 3 1  ON 23
ci_25                 2.848995e-03 3 1  ON 24
ci_26                 3.142533e-03 3 1  ON 25
ci_27                 3.318186e-03 3 1  ON 26
ci_28                 1.931205e-03 3 1  ON 27
ci_29                 1.304614e-03 3 1  ON 28
ci_30                -1.836225e-03 3 1  ON 29
ci_31                -5.566583e-04 3 1  ON 30
ci_32                -8.447879e-04 3 1  ON 31
ci_33                -1.469273e-03 3 1  ON 32
ci_34                 1.139160e-03 3 1  ON 33
ci_35                 1.458369e-03 3 1  ON 34
ci_36                -1.023673e-03 3 1  ON 35
ci_37                -1.033127e-03 3 1  ON 36
ci_38                -7.699027e-04 3 1  ON 37
ci_39                -6.235232e-04 3 1  ON 38
ci_40                -1.564243e-03 3 1  ON 39
ci_41                -1.245628e-03 3 1  ON 40
ci_42                -1.166330e-03 3 1  ON 41
ci_43                -2.482589e-03 3 1  ON 42
ci_44                -3.243639e-03 3 1  ON 43
ci_45                -5.291238e-04 3 1  ON 44
ci_46                -8.703392e-04 3 1  ON 45
ci_47                 1.539463e-03 3 1  ON 46
ci_48                 1.376365e-03 3 1  ON 47
ci_49                -1.040233e-03 3 1  ON 48
ci_50                -8.128303e-04 3 1  ON 49
ci_51                 1.460597e-04 3 1  ON 50
ci_52                 8.308034e-05 3 1  ON 51
ci_53                -6.379610e-04 3 1  ON 52
ci_54                -1.026712e-03 3 1  ON 53
ci_55                -6.526893e-04 3 1  ON 54
ci_56                 2.627093e-03 3 1  ON 55
ci_57                 1.621565e-03 3 1  ON 56
ci_58                -1.116068e-03 3 1  ON 57
ci_59                -1.464161e-03 3 1  ON 58
ci_60                 5.451802e-04 3 1  ON 59
ci_61                -1.271606e-04 3 1  ON 60
ci_62                -6.691789e-04 3 1  ON 61
ci_63                -7.735738e-04 3 1  ON 62
ci_64                -2.614659e-04 3 1  ON 63
ci_65                 6.173642e-05 3 1  ON 64
ci_66                -7.131982e-04 3 1  ON 65
ci_67                -8.965554e-04 3 1  ON 66
ci_68                -1.372597e-03 3 1  ON 67
ci_69                 1.333931e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2453e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8178
    reference variance = 0.475531
====================================================
  Execution time = 4.3772e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5374e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4975e-01
  Total weights = 1.964210451e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436138859017
                                         uncertainty =       0.001844881284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436138859017
                                         uncertainty =       0.001844881284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466972944
  error estimate for blocks of size 2^( 2) =       0.000492109839
  error estimate for blocks of size 2^( 3) =       0.000515821563
  error estimate for blocks of size 2^( 4) =       0.000533437071
  error estimate for blocks of size 2^( 5) =       0.000544092993
  error estimate for blocks of size 2^( 6) =       0.000550361348
  error estimate for blocks of size 2^( 7) =       0.000553031996

      target function =      -0.745545531957
              le_mean =     -22.814793706884
             les_mean =     520.964565095585
             stat err =       0.000545230852
             autocorr =       1.363255966123
   target nu stat err =       0.000545230852
   target dn stat err =       0.002745584200
      target stat err =       0.002343769786
              std dev =       0.660399471241
             le_variance =       0.436127461615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281479370688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745551996177       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745552103607       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745552122893       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745552128142       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745552128914       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745552129020       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745552129008       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745552129001       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745552128932       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 2.174604e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745551996177       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745552023045       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745552027867       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745552029179       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745552029373       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745552029399       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745552029396       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745552029394       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745552029378       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 5.437655e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745551996177       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745552002894       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745552004100       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745552004428       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745552004476       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745552004484       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745552004476       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745552004481       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745552004479       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.359485e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3669e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.272826e-01 3 1  ON 0
ci_02                -2.888478e-02 3 1  ON 1
ci_03                -2.899043e-02 3 1  ON 2
ci_04                 2.691598e-02 3 1  ON 3
ci_05                -2.207876e-02 3 1  ON 4
ci_06                -2.177218e-02 3 1  ON 5
ci_07                 2.739355e-02 3 1  ON 6
ci_08                -5.573346e-03 3 1  ON 7
ci_09                -9.048548e-03 3 1  ON 8
ci_10                -8.352091e-03 3 1  ON 9
ci_11                 1.321828e-02 3 1  ON 10
ci_12                 6.948081e-03 3 1  ON 11
ci_13                 1.283260e-02 3 1  ON 12
ci_14                 1.270518e-02 3 1  ON 13
ci_15                 6.267138e-03 3 1  ON 14
ci_16                 6.429166e-03 3 1  ON 15
ci_17                -7.247068e-03 3 1  ON 16
ci_18                -5.940933e-03 3 1  ON 17
ci_19                 9.300933e-03 3 1  ON 18
ci_20                 6.393474e-03 3 1  ON 19
ci_21                 9.004280e-03 3 1  ON 20
ci_22                 8.265437e-03 3 1  ON 21
ci_23                 4.758763e-03 3 1  ON 22
ci_24                 3.984315e-03 3 1  ON 23
ci_25                 2.848951e-03 3 1  ON 24
ci_26                 3.142768e-03 3 1  ON 25
ci_27                 3.318261e-03 3 1  ON 26
ci_28                 1.931103e-03 3 1  ON 27
ci_29                 1.304752e-03 3 1  ON 28
ci_30                -1.836132e-03 3 1  ON 29
ci_31                -5.567052e-04 3 1  ON 30
ci_32                -8.447929e-04 3 1  ON 31
ci_33                -1.469277e-03 3 1  ON 32
ci_34                 1.139082e-03 3 1  ON 33
ci_35                 1.458544e-03 3 1  ON 34
ci_36                -1.023621e-03 3 1  ON 35
ci_37                -1.033089e-03 3 1  ON 36
ci_38                -7.698212e-04 3 1  ON 37
ci_39                -6.234877e-04 3 1  ON 38
ci_40                -1.564092e-03 3 1  ON 39
ci_41                -1.245686e-03 3 1  ON 40
ci_42                -1.166376e-03 3 1  ON 41
ci_43                -2.482525e-03 3 1  ON 42
ci_44                -3.243363e-03 3 1  ON 43
ci_45                -5.291952e-04 3 1  ON 44
ci_46                -8.703368e-04 3 1  ON 45
ci_47                 1.539392e-03 3 1  ON 46
ci_48                 1.376512e-03 3 1  ON 47
ci_49                -1.040180e-03 3 1  ON 48
ci_50                -8.127899e-04 3 1  ON 49
ci_51                 1.460833e-04 3 1  ON 50
ci_52                 8.307853e-05 3 1  ON 51
ci_53                -6.379452e-04 3 1  ON 52
ci_54                -1.026667e-03 3 1  ON 53
ci_55                -6.526810e-04 3 1  ON 54
ci_56                 2.626948e-03 3 1  ON 55
ci_57                 1.621402e-03 3 1  ON 56
ci_58                -1.115912e-03 3 1  ON 57
ci_59                -1.463996e-03 3 1  ON 58
ci_60                 5.451347e-04 3 1  ON 59
ci_61                -1.269640e-04 3 1  ON 60
ci_62                -6.691087e-04 3 1  ON 61
ci_63                -7.736230e-04 3 1  ON 62
ci_64                -2.614491e-04 3 1  ON 63
ci_65                 6.169603e-05 3 1  ON 64
ci_66                -7.130753e-04 3 1  ON 65
ci_67                -8.966389e-04 3 1  ON 66
ci_68                -1.372674e-03 3 1  ON 67
ci_69                 1.332167e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8244
    reference variance = 0.394441
====================================================
  Execution time = 4.2550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4297e-01
  Total weights = 1.9644e+06
  Execution time = 5.9017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431667389150
                                         uncertainty =       0.002129435722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431667389150
                                         uncertainty =       0.002129435722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464624277
  error estimate for blocks of size 2^( 2) =       0.000490167661
  error estimate for blocks of size 2^( 3) =       0.000513676634
  error estimate for blocks of size 2^( 4) =       0.000531849468
  error estimate for blocks of size 2^( 5) =       0.000544530532
  error estimate for blocks of size 2^( 6) =       0.000553076195
  error estimate for blocks of size 2^( 7) =       0.000557684540

      target function =      -0.751166945347
              le_mean =     -22.813696882828
             les_mean =     520.907736916588
             stat err =       0.000546785184
             autocorr =       1.384935918403
   target nu stat err =       0.000546785184
   target dn stat err =       0.002547490658
      target stat err =       0.002214974704
              std dev =       0.657077954327
             le_variance =       0.431751438062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431667083509
                                         uncertainty =       0.002129436721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431667083509
                                         uncertainty =       0.002129436721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464624114
  error estimate for blocks of size 2^( 2) =       0.000490167565
  error estimate for blocks of size 2^( 3) =       0.000513676609
  error estimate for blocks of size 2^( 4) =       0.000531849486
  error estimate for blocks of size 2^( 5) =       0.000544530582
  error estimate for blocks of size 2^( 6) =       0.000553076250
  error estimate for blocks of size 2^( 7) =       0.000557684589

      target function =      -0.751157943781
              le_mean =     -22.813696871987
             les_mean =     520.907747174448
             stat err =       0.000546785227
             autocorr =       1.384937109256
   target nu stat err =       0.000546785227
   target dn stat err =       0.002550111099
      target stat err =       0.002217030086
              std dev =       0.657077723519
             le_variance =       0.431751134745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431667236226
                                         uncertainty =       0.002129436220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431667236226
                                         uncertainty =       0.002129436220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464624196
  error estimate for blocks of size 2^( 2) =       0.000490167613
  error estimate for blocks of size 2^( 3) =       0.000513676621
  error estimate for blocks of size 2^( 4) =       0.000531849477
  error estimate for blocks of size 2^( 5) =       0.000544530557
  error estimate for blocks of size 2^( 6) =       0.000553076222
  error estimate for blocks of size 2^( 7) =       0.000557684565

      target function =      -0.751162505960
              le_mean =     -22.813696877395
             les_mean =     520.907741971570
             stat err =       0.000546785205
             autocorr =       1.384936514034
   target nu stat err =       0.000546785205
   target dn stat err =       0.002548780322
      target stat err =       0.002215986211
              std dev =       0.657077838845
             le_variance =       0.431751286301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431667370027
                                         uncertainty =       0.002129435784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431667370027
                                         uncertainty =       0.002129435784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464624267
  error estimate for blocks of size 2^( 2) =       0.000490167655
  error estimate for blocks of size 2^( 3) =       0.000513676633
  error estimate for blocks of size 2^( 4) =       0.000531849469
  error estimate for blocks of size 2^( 5) =       0.000544530535
  error estimate for blocks of size 2^( 6) =       0.000553076198
  error estimate for blocks of size 2^( 7) =       0.000557684543

      target function =      -0.751166397308
              le_mean =     -22.813696882148
             les_mean =     520.907737540178
             stat err =       0.000546785186
             autocorr =       1.384935992855
   target nu stat err =       0.000546785186
   target dn stat err =       0.002547649630
      target stat err =       0.002215099383
              std dev =       0.657077939886
             le_variance =       0.431751419084


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751166945347        initial  <--
     9.5367e+01     9.5367e+02             2.1746e-06        -0.751157943781
     3.8147e+02     3.8147e+03             5.4377e-07        -0.751162505960
     1.5259e+03     1.5259e+04             1.3595e-07        -0.751166397308

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.2118
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.272831e-01 3 1  ON 0
ci_02                -2.888492e-02 3 1  ON 1
ci_03                -2.899056e-02 3 1  ON 2
ci_04                 2.691620e-02 3 1  ON 3
ci_05                -2.207899e-02 3 1  ON 4
ci_06                -2.177234e-02 3 1  ON 5
ci_07                 2.739366e-02 3 1  ON 6
ci_08                -5.573380e-03 3 1  ON 7
ci_09                -9.048728e-03 3 1  ON 8
ci_10                -8.352033e-03 3 1  ON 9
ci_11                 1.321838e-02 3 1  ON 10
ci_12                 6.948106e-03 3 1  ON 11
ci_13                 1.283258e-02 3 1  ON 12
ci_14                 1.270515e-02 3 1  ON 13
ci_15                 6.267071e-03 3 1  ON 14
ci_16                 6.429053e-03 3 1  ON 15
ci_17                -7.247236e-03 3 1  ON 16
ci_18                -5.940826e-03 3 1  ON 17
ci_19                 9.300875e-03 3 1  ON 18
ci_20                 6.393505e-03 3 1  ON 19
ci_21                 9.004348e-03 3 1  ON 20
ci_22                 8.265580e-03 3 1  ON 21
ci_23                 4.758700e-03 3 1  ON 22
ci_24                 3.984169e-03 3 1  ON 23
ci_25                 2.848995e-03 3 1  ON 24
ci_26                 3.142533e-03 3 1  ON 25
ci_27                 3.318186e-03 3 1  ON 26
ci_28                 1.931205e-03 3 1  ON 27
ci_29                 1.304614e-03 3 1  ON 28
ci_30                -1.836225e-03 3 1  ON 29
ci_31                -5.566583e-04 3 1  ON 30
ci_32                -8.447879e-04 3 1  ON 31
ci_33                -1.469273e-03 3 1  ON 32
ci_34                 1.139160e-03 3 1  ON 33
ci_35                 1.458369e-03 3 1  ON 34
ci_36                -1.023673e-03 3 1  ON 35
ci_37                -1.033127e-03 3 1  ON 36
ci_38                -7.699027e-04 3 1  ON 37
ci_39                -6.235232e-04 3 1  ON 38
ci_40                -1.564243e-03 3 1  ON 39
ci_41                -1.245628e-03 3 1  ON 40
ci_42                -1.166330e-03 3 1  ON 41
ci_43                -2.482589e-03 3 1  ON 42
ci_44                -3.243639e-03 3 1  ON 43
ci_45                -5.291238e-04 3 1  ON 44
ci_46                -8.703392e-04 3 1  ON 45
ci_47                 1.539463e-03 3 1  ON 46
ci_48                 1.376365e-03 3 1  ON 47
ci_49                -1.040233e-03 3 1  ON 48
ci_50                -8.128303e-04 3 1  ON 49
ci_51                 1.460597e-04 3 1  ON 50
ci_52                 8.308034e-05 3 1  ON 51
ci_53                -6.379610e-04 3 1  ON 52
ci_54                -1.026712e-03 3 1  ON 53
ci_55                -6.526893e-04 3 1  ON 54
ci_56                 2.627093e-03 3 1  ON 55
ci_57                 1.621565e-03 3 1  ON 56
ci_58                -1.116068e-03 3 1  ON 57
ci_59                -1.464161e-03 3 1  ON 58
ci_60                 5.451802e-04 3 1  ON 59
ci_61                -1.271606e-04 3 1  ON 60
ci_62                -6.691789e-04 3 1  ON 61
ci_63                -7.735738e-04 3 1  ON 62
ci_64                -2.614659e-04 3 1  ON 63
ci_65                 6.173642e-05 3 1  ON 64
ci_66                -7.131982e-04 3 1  ON 65
ci_67                -8.965554e-04 3 1  ON 66
ci_68                -1.372597e-03 3 1  ON 67
ci_69                 1.333931e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2592e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7832
    reference variance = 0.331378
====================================================
  Execution time = 4.3089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5467e-01
  Total weights = 1.964439270e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439852143748
                                         uncertainty =       0.002905173933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439852143748
                                         uncertainty =       0.002905173933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468910617
  error estimate for blocks of size 2^( 2) =       0.000494494997
  error estimate for blocks of size 2^( 3) =       0.000518511485
  error estimate for blocks of size 2^( 4) =       0.000536311300
  error estimate for blocks of size 2^( 5) =       0.000547297585
  error estimate for blocks of size 2^( 6) =       0.000553617796
  error estimate for blocks of size 2^( 7) =       0.000556817737

      target function =      -0.741510165227
              le_mean =     -22.814984812708
             les_mean =     520.978199049012
             stat err =       0.000548511105
             autocorr =       1.368329581196
   target nu stat err =       0.000548511105
   target dn stat err =       0.003468200879
      target stat err =       0.002894486921
              std dev =       0.663139754479
             le_variance =       0.439754333971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281498481271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741520332260       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741520346814       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741520348397       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741520348801       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741520348875       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741520349016       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741520349016       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741520349036       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741520349035       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741520349040       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 1.906218e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741520332260       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741520335899       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741520336294       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741520336395       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741520336421       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741520336455       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741520336447       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741520336461       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741520336456       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741520336453       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 4.765639e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741520332260       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741520333170       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741520333269       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741520333294       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741520333301       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741520333304       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741520333289       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741520333308       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741520333327       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741520333292       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 1.191416e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0818e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.272831e-01 3 1  ON 0
ci_02                -2.888492e-02 3 1  ON 1
ci_03                -2.899053e-02 3 1  ON 2
ci_04                 2.691619e-02 3 1  ON 3
ci_05                -2.207896e-02 3 1  ON 4
ci_06                -2.177234e-02 3 1  ON 5
ci_07                 2.739365e-02 3 1  ON 6
ci_08                -5.573371e-03 3 1  ON 7
ci_09                -9.048706e-03 3 1  ON 8
ci_10                -8.352026e-03 3 1  ON 9
ci_11                 1.321839e-02 3 1  ON 10
ci_12                 6.948096e-03 3 1  ON 11
ci_13                 1.283259e-02 3 1  ON 12
ci_14                 1.270518e-02 3 1  ON 13
ci_15                 6.267076e-03 3 1  ON 14
ci_16                 6.429041e-03 3 1  ON 15
ci_17                -7.247232e-03 3 1  ON 16
ci_18                -5.940842e-03 3 1  ON 17
ci_19                 9.300891e-03 3 1  ON 18
ci_20                 6.393477e-03 3 1  ON 19
ci_21                 9.004343e-03 3 1  ON 20
ci_22                 8.265592e-03 3 1  ON 21
ci_23                 4.758705e-03 3 1  ON 22
ci_24                 3.984162e-03 3 1  ON 23
ci_25                 2.849007e-03 3 1  ON 24
ci_26                 3.142549e-03 3 1  ON 25
ci_27                 3.318186e-03 3 1  ON 26
ci_28                 1.931194e-03 3 1  ON 27
ci_29                 1.304630e-03 3 1  ON 28
ci_30                -1.836231e-03 3 1  ON 29
ci_31                -5.566577e-04 3 1  ON 30
ci_32                -8.447720e-04 3 1  ON 31
ci_33                -1.469265e-03 3 1  ON 32
ci_34                 1.139166e-03 3 1  ON 33
ci_35                 1.458375e-03 3 1  ON 34
ci_36                -1.023677e-03 3 1  ON 35
ci_37                -1.033119e-03 3 1  ON 36
ci_38                -7.699146e-04 3 1  ON 37
ci_39                -6.235253e-04 3 1  ON 38
ci_40                -1.564245e-03 3 1  ON 39
ci_41                -1.245623e-03 3 1  ON 40
ci_42                -1.166318e-03 3 1  ON 41
ci_43                -2.482599e-03 3 1  ON 42
ci_44                -3.243626e-03 3 1  ON 43
ci_45                -5.291145e-04 3 1  ON 44
ci_46                -8.703226e-04 3 1  ON 45
ci_47                 1.539464e-03 3 1  ON 46
ci_48                 1.376379e-03 3 1  ON 47
ci_49                -1.040228e-03 3 1  ON 48
ci_50                -8.128221e-04 3 1  ON 49
ci_51                 1.460498e-04 3 1  ON 50
ci_52                 8.307747e-05 3 1  ON 51
ci_53                -6.379581e-04 3 1  ON 52
ci_54                -1.026698e-03 3 1  ON 53
ci_55                -6.526857e-04 3 1  ON 54
ci_56                 2.627088e-03 3 1  ON 55
ci_57                 1.621570e-03 3 1  ON 56
ci_58                -1.116046e-03 3 1  ON 57
ci_59                -1.464167e-03 3 1  ON 58
ci_60                 5.451879e-04 3 1  ON 59
ci_61                -1.271460e-04 3 1  ON 60
ci_62                -6.691783e-04 3 1  ON 61
ci_63                -7.735621e-04 3 1  ON 62
ci_64                -2.614531e-04 3 1  ON 63
ci_65                 6.172762e-05 3 1  ON 64
ci_66                -7.132025e-04 3 1  ON 65
ci_67                -8.965560e-04 3 1  ON 66
ci_68                -1.372588e-03 3 1  ON 67
ci_69                 1.333790e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8205
    reference variance = 0.300342
====================================================
  Execution time = 4.3928e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4681e-01
  Total weights = 1.9643e+06
  Execution time = 5.9111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856085792
                                         uncertainty =       0.001603229753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856085792
                                         uncertainty =       0.001603229753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463561114
  error estimate for blocks of size 2^( 2) =       0.000489282142
  error estimate for blocks of size 2^( 3) =       0.000513345266
  error estimate for blocks of size 2^( 4) =       0.000530916633
  error estimate for blocks of size 2^( 5) =       0.000541988408
  error estimate for blocks of size 2^( 6) =       0.000547441462
  error estimate for blocks of size 2^( 7) =       0.000546767616

      target function =      -0.747955064097
              le_mean =     -22.813571598958
             les_mean =     520.905862701305
             stat err =       0.000541778530
             autocorr =       1.365933587454
   target nu stat err =       0.000541778530
   target dn stat err =       0.004448646106
      target stat err =       0.003735320403
              std dev =       0.655574414998
             le_variance =       0.429777813599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856075667
                                         uncertainty =       0.001603230522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856075667
                                         uncertainty =       0.001603230522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463561109
  error estimate for blocks of size 2^( 2) =       0.000489282142
  error estimate for blocks of size 2^( 3) =       0.000513345272
  error estimate for blocks of size 2^( 4) =       0.000530916640
  error estimate for blocks of size 2^( 5) =       0.000541988418
  error estimate for blocks of size 2^( 6) =       0.000547441477
  error estimate for blocks of size 2^( 7) =       0.000546767639

      target function =      -0.747955010721
              le_mean =     -22.813571598472
             les_mean =     520.905862743159
             stat err =       0.000541778544
             autocorr =       1.365933688160
   target nu stat err =       0.000541778544
   target dn stat err =       0.004448685339
      target stat err =       0.003735351969
              std dev =       0.655574407520
             le_variance =       0.429777803796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856080729
                                         uncertainty =       0.001603230138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856080729
                                         uncertainty =       0.001603230138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463561112
  error estimate for blocks of size 2^( 2) =       0.000489282142
  error estimate for blocks of size 2^( 3) =       0.000513345269
  error estimate for blocks of size 2^( 4) =       0.000530916637
  error estimate for blocks of size 2^( 5) =       0.000541988413
  error estimate for blocks of size 2^( 6) =       0.000547441469
  error estimate for blocks of size 2^( 7) =       0.000546767628

      target function =      -0.747955037446
              le_mean =     -22.813571598715
             les_mean =     520.905862722185
             stat err =       0.000541778537
             autocorr =       1.365933637814
   target nu stat err =       0.000541778537
   target dn stat err =       0.004448665723
      target stat err =       0.003735336186
              std dev =       0.655574411258
             le_variance =       0.429777808697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856085159
                                         uncertainty =       0.001603229801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856085159
                                         uncertainty =       0.001603229801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463561114
  error estimate for blocks of size 2^( 2) =       0.000489282142
  error estimate for blocks of size 2^( 3) =       0.000513345267
  error estimate for blocks of size 2^( 4) =       0.000530916633
  error estimate for blocks of size 2^( 5) =       0.000541988409
  error estimate for blocks of size 2^( 6) =       0.000547441463
  error estimate for blocks of size 2^( 7) =       0.000546767618

      target function =      -0.747955060770
              le_mean =     -22.813571598927
             les_mean =     520.905862703910
             stat err =       0.000541778531
             autocorr =       1.365933593749
   target nu stat err =       0.000541778531
   target dn stat err =       0.004448648558
      target stat err =       0.003735322376
              std dev =       0.655574414530
             le_variance =       0.429777812987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747955064097        initial  <--
     9.5367e+02     9.5367e+03             1.9062e-07        -0.747955010721
     3.8147e+03     3.8147e+04             4.7656e-08        -0.747955037446
     1.5259e+04     1.5259e+05             1.1914e-08        -0.747955060770

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.6448
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.272831e-01 3 1  ON 0
ci_02                -2.888492e-02 3 1  ON 1
ci_03                -2.899056e-02 3 1  ON 2
ci_04                 2.691620e-02 3 1  ON 3
ci_05                -2.207899e-02 3 1  ON 4
ci_06                -2.177234e-02 3 1  ON 5
ci_07                 2.739366e-02 3 1  ON 6
ci_08                -5.573380e-03 3 1  ON 7
ci_09                -9.048728e-03 3 1  ON 8
ci_10                -8.352033e-03 3 1  ON 9
ci_11                 1.321838e-02 3 1  ON 10
ci_12                 6.948106e-03 3 1  ON 11
ci_13                 1.283258e-02 3 1  ON 12
ci_14                 1.270515e-02 3 1  ON 13
ci_15                 6.267071e-03 3 1  ON 14
ci_16                 6.429053e-03 3 1  ON 15
ci_17                -7.247236e-03 3 1  ON 16
ci_18                -5.940826e-03 3 1  ON 17
ci_19                 9.300875e-03 3 1  ON 18
ci_20                 6.393505e-03 3 1  ON 19
ci_21                 9.004348e-03 3 1  ON 20
ci_22                 8.265580e-03 3 1  ON 21
ci_23                 4.758700e-03 3 1  ON 22
ci_24                 3.984169e-03 3 1  ON 23
ci_25                 2.848995e-03 3 1  ON 24
ci_26                 3.142533e-03 3 1  ON 25
ci_27                 3.318186e-03 3 1  ON 26
ci_28                 1.931205e-03 3 1  ON 27
ci_29                 1.304614e-03 3 1  ON 28
ci_30                -1.836225e-03 3 1  ON 29
ci_31                -5.566583e-04 3 1  ON 30
ci_32                -8.447879e-04 3 1  ON 31
ci_33                -1.469273e-03 3 1  ON 32
ci_34                 1.139160e-03 3 1  ON 33
ci_35                 1.458369e-03 3 1  ON 34
ci_36                -1.023673e-03 3 1  ON 35
ci_37                -1.033127e-03 3 1  ON 36
ci_38                -7.699027e-04 3 1  ON 37
ci_39                -6.235232e-04 3 1  ON 38
ci_40                -1.564243e-03 3 1  ON 39
ci_41                -1.245628e-03 3 1  ON 40
ci_42                -1.166330e-03 3 1  ON 41
ci_43                -2.482589e-03 3 1  ON 42
ci_44                -3.243639e-03 3 1  ON 43
ci_45                -5.291238e-04 3 1  ON 44
ci_46                -8.703392e-04 3 1  ON 45
ci_47                 1.539463e-03 3 1  ON 46
ci_48                 1.376365e-03 3 1  ON 47
ci_49                -1.040233e-03 3 1  ON 48
ci_50                -8.128303e-04 3 1  ON 49
ci_51                 1.460597e-04 3 1  ON 50
ci_52                 8.308034e-05 3 1  ON 51
ci_53                -6.379610e-04 3 1  ON 52
ci_54                -1.026712e-03 3 1  ON 53
ci_55                -6.526893e-04 3 1  ON 54
ci_56                 2.627093e-03 3 1  ON 55
ci_57                 1.621565e-03 3 1  ON 56
ci_58                -1.116068e-03 3 1  ON 57
ci_59                -1.464161e-03 3 1  ON 58
ci_60                 5.451802e-04 3 1  ON 59
ci_61                -1.271606e-04 3 1  ON 60
ci_62                -6.691789e-04 3 1  ON 61
ci_63                -7.735738e-04 3 1  ON 62
ci_64                -2.614659e-04 3 1  ON 63
ci_65                 6.173642e-05 3 1  ON 64
ci_66                -7.131982e-04 3 1  ON 65
ci_67                -8.965554e-04 3 1  ON 66
ci_68                -1.372597e-03 3 1  ON 67
ci_69                 1.333931e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2447e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7907
    reference variance = 0.232893
====================================================
  Execution time = 4.2906e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4259e-01
  Total weights = 1.964279010e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431556610423
                                         uncertainty =       0.001884202682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431556610423
                                         uncertainty =       0.001884202682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464488658
  error estimate for blocks of size 2^( 2) =       0.000490493889
  error estimate for blocks of size 2^( 3) =       0.000513651930
  error estimate for blocks of size 2^( 4) =       0.000530663220
  error estimate for blocks of size 2^( 5) =       0.000541651413
  error estimate for blocks of size 2^( 6) =       0.000548714484
  error estimate for blocks of size 2^( 7) =       0.000551920654

      target function =      -0.751498214011
              le_mean =     -22.814149316469
             les_mean =     520.927994036591
             stat err =       0.000543237443
             autocorr =       1.367820675707
   target nu stat err =       0.000543237443
   target dn stat err =       0.002351062869
      target stat err =       0.002059521852
              std dev =       0.656886160136
             le_variance =       0.431499427379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281414931647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751502767673       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751502768632       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751502768746       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751502768776       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751502768790       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751502768770       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751502768784       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751502768786       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751502768782       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751502768776       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 1.597735e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751502767673       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751502767913       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751502767941       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751502767949       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751502767962       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751502767958       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751502767939       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751502767911       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751502767959       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751502767950       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 3.994347e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751502767673       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751502767733       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751502767740       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751502767742       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751502767750       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751502767659       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751502768072       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751502768139       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751502767507       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751502767818       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+05 is 9.985872e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207621 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0519e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.272831e-01 3 1  ON 0
ci_02                -2.888492e-02 3 1  ON 1
ci_03                -2.899056e-02 3 1  ON 2
ci_04                 2.691620e-02 3 1  ON 3
ci_05                -2.207898e-02 3 1  ON 4
ci_06                -2.177234e-02 3 1  ON 5
ci_07                 2.739366e-02 3 1  ON 6
ci_08                -5.573380e-03 3 1  ON 7
ci_09                -9.048728e-03 3 1  ON 8
ci_10                -8.352033e-03 3 1  ON 9
ci_11                 1.321838e-02 3 1  ON 10
ci_12                 6.948106e-03 3 1  ON 11
ci_13                 1.283258e-02 3 1  ON 12
ci_14                 1.270515e-02 3 1  ON 13
ci_15                 6.267071e-03 3 1  ON 14
ci_16                 6.429052e-03 3 1  ON 15
ci_17                -7.247235e-03 3 1  ON 16
ci_18                -5.940825e-03 3 1  ON 17
ci_19                 9.300876e-03 3 1  ON 18
ci_20                 6.393504e-03 3 1  ON 19
ci_21                 9.004348e-03 3 1  ON 20
ci_22                 8.265581e-03 3 1  ON 21
ci_23                 4.758700e-03 3 1  ON 22
ci_24                 3.984172e-03 3 1  ON 23
ci_25                 2.848995e-03 3 1  ON 24
ci_26                 3.142534e-03 3 1  ON 25
ci_27                 3.318183e-03 3 1  ON 26
ci_28                 1.931205e-03 3 1  ON 27
ci_29                 1.304614e-03 3 1  ON 28
ci_30                -1.836224e-03 3 1  ON 29
ci_31                -5.566590e-04 3 1  ON 30
ci_32                -8.447871e-04 3 1  ON 31
ci_33                -1.469272e-03 3 1  ON 32
ci_34                 1.139162e-03 3 1  ON 33
ci_35                 1.458367e-03 3 1  ON 34
ci_36                -1.023673e-03 3 1  ON 35
ci_37                -1.033126e-03 3 1  ON 36
ci_38                -7.699034e-04 3 1  ON 37
ci_39                -6.235239e-04 3 1  ON 38
ci_40                -1.564243e-03 3 1  ON 39
ci_41                -1.245629e-03 3 1  ON 40
ci_42                -1.166330e-03 3 1  ON 41
ci_43                -2.482588e-03 3 1  ON 42
ci_44                -3.243639e-03 3 1  ON 43
ci_45                -5.291229e-04 3 1  ON 44
ci_46                -8.703388e-04 3 1  ON 45
ci_47                 1.539462e-03 3 1  ON 46
ci_48                 1.376365e-03 3 1  ON 47
ci_49                -1.040234e-03 3 1  ON 48
ci_50                -8.128304e-04 3 1  ON 49
ci_51                 1.460592e-04 3 1  ON 50
ci_52                 8.308156e-05 3 1  ON 51
ci_53                -6.379611e-04 3 1  ON 52
ci_54                -1.026712e-03 3 1  ON 53
ci_55                -6.526901e-04 3 1  ON 54
ci_56                 2.627092e-03 3 1  ON 55
ci_57                 1.621564e-03 3 1  ON 56
ci_58                -1.116068e-03 3 1  ON 57
ci_59                -1.464161e-03 3 1  ON 58
ci_60                 5.451793e-04 3 1  ON 59
ci_61                -1.271598e-04 3 1  ON 60
ci_62                -6.691782e-04 3 1  ON 61
ci_63                -7.735736e-04 3 1  ON 62
ci_64                -2.614654e-04 3 1  ON 63
ci_65                 6.173607e-05 3 1  ON 64
ci_66                -7.131986e-04 3 1  ON 65
ci_67                -8.965562e-04 3 1  ON 66
ci_68                -1.372596e-03 3 1  ON 67
ci_69                 1.333904e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8585
    reference variance = 0.344518
====================================================
  Execution time = 4.1731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4354e-01
  Total weights = 1.9641e+06
  Execution time = 5.9682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431920562438
                                         uncertainty =       0.001552673898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431920562438
                                         uncertainty =       0.001552673898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464726625
  error estimate for blocks of size 2^( 2) =       0.000490236588
  error estimate for blocks of size 2^( 3) =       0.000513593207
  error estimate for blocks of size 2^( 4) =       0.000531333362
  error estimate for blocks of size 2^( 5) =       0.000543843413
  error estimate for blocks of size 2^( 6) =       0.000549656413
  error estimate for blocks of size 2^( 7) =       0.000555366440

      target function =      -0.750701717973
              le_mean =     -22.814230314405
             les_mean =     520.932644102764
             stat err =       0.000545049907
             autocorr =       1.375553322743
   target nu stat err =       0.000545049907
   target dn stat err =       0.002196794588
      target stat err =       0.001933388266
              std dev =       0.657222695891
             le_variance =       0.431941671994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431920560692
                                         uncertainty =       0.001552673898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431920560692
                                         uncertainty =       0.001552673898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464726624
  error estimate for blocks of size 2^( 2) =       0.000490236588
  error estimate for blocks of size 2^( 3) =       0.000513593207
  error estimate for blocks of size 2^( 4) =       0.000531333363
  error estimate for blocks of size 2^( 5) =       0.000543843414
  error estimate for blocks of size 2^( 6) =       0.000549656414
  error estimate for blocks of size 2^( 7) =       0.000555366441

      target function =      -0.750701721871
              le_mean =     -22.814230314376
             les_mean =     520.932644096778
             stat err =       0.000545049908
             autocorr =       1.375553332855
   target nu stat err =       0.000545049908
   target dn stat err =       0.002196794630
      target stat err =       0.001933388319
              std dev =       0.657222694542
             le_variance =       0.431941670221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431920561565
                                         uncertainty =       0.001552673898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431920561565
                                         uncertainty =       0.001552673898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464726625
  error estimate for blocks of size 2^( 2) =       0.000490236588
  error estimate for blocks of size 2^( 3) =       0.000513593207
  error estimate for blocks of size 2^( 4) =       0.000531333362
  error estimate for blocks of size 2^( 5) =       0.000543843413
  error estimate for blocks of size 2^( 6) =       0.000549656413
  error estimate for blocks of size 2^( 7) =       0.000555366440

      target function =      -0.750701719924
              le_mean =     -22.814230314390
             les_mean =     520.932644099768
             stat err =       0.000545049907
             autocorr =       1.375553327790
   target nu stat err =       0.000545049907
   target dn stat err =       0.002196794609
      target stat err =       0.001933388292
              std dev =       0.657222695217
             le_variance =       0.431941671108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431920562329
                                         uncertainty =       0.001552673898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431920562329
                                         uncertainty =       0.001552673898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464726625
  error estimate for blocks of size 2^( 2) =       0.000490236588
  error estimate for blocks of size 2^( 3) =       0.000513593207
  error estimate for blocks of size 2^( 4) =       0.000531333362
  error estimate for blocks of size 2^( 5) =       0.000543843413
  error estimate for blocks of size 2^( 6) =       0.000549656413
  error estimate for blocks of size 2^( 7) =       0.000555366440

      target function =      -0.750701718218
              le_mean =     -22.814230314403
             les_mean =     520.932644102389
             stat err =       0.000545049907
             autocorr =       1.375553323367
   target nu stat err =       0.000545049907
   target dn stat err =       0.002196794590
      target stat err =       0.001933388269
              std dev =       0.657222695807
             le_variance =       0.431941671884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750701717973        initial
     9.5367e+03     9.5367e+04             1.5977e-08        -0.750701721871  <--
     3.8147e+04     3.8147e+05             3.9943e-09        -0.750701719924
     1.5259e+05     1.5259e+06             9.9859e-10        -0.750701718218

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 7.1651e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.272831e-01 3 1  ON 0
ci_02                -2.888492e-02 3 1  ON 1
ci_03                -2.899055e-02 3 1  ON 2
ci_04                 2.691619e-02 3 1  ON 3
ci_05                -2.207898e-02 3 1  ON 4
ci_06                -2.177234e-02 3 1  ON 5
ci_07                 2.739365e-02 3 1  ON 6
ci_08                -5.573381e-03 3 1  ON 7
ci_09                -9.048728e-03 3 1  ON 8
ci_10                -8.352034e-03 3 1  ON 9
ci_11                 1.321838e-02 3 1  ON 10
ci_12                 6.948106e-03 3 1  ON 11
ci_13                 1.283258e-02 3 1  ON 12
ci_14                 1.270516e-02 3 1  ON 13
ci_15                 6.267072e-03 3 1  ON 14
ci_16                 6.429048e-03 3 1  ON 15
ci_17                -7.247232e-03 3 1  ON 16
ci_18                -5.940823e-03 3 1  ON 17
ci_19                 9.300879e-03 3 1  ON 18
ci_20                 6.393501e-03 3 1  ON 19
ci_21                 9.004350e-03 3 1  ON 20
ci_22                 8.265584e-03 3 1  ON 21
ci_23                 4.758698e-03 3 1  ON 22
ci_24                 3.984180e-03 3 1  ON 23
ci_25                 2.848994e-03 3 1  ON 24
ci_26                 3.142536e-03 3 1  ON 25
ci_27                 3.318175e-03 3 1  ON 26
ci_28                 1.931206e-03 3 1  ON 27
ci_29                 1.304615e-03 3 1  ON 28
ci_30                -1.836221e-03 3 1  ON 29
ci_31                -5.566610e-04 3 1  ON 30
ci_32                -8.447847e-04 3 1  ON 31
ci_33                -1.469271e-03 3 1  ON 32
ci_34                 1.139168e-03 3 1  ON 33
ci_35                 1.458363e-03 3 1  ON 34
ci_36                -1.023675e-03 3 1  ON 35
ci_37                -1.033125e-03 3 1  ON 36
ci_38                -7.699055e-04 3 1  ON 37
ci_39                -6.235261e-04 3 1  ON 38
ci_40                -1.564240e-03 3 1  ON 39
ci_41                -1.245630e-03 3 1  ON 40
ci_42                -1.166331e-03 3 1  ON 41
ci_43                -2.482583e-03 3 1  ON 42
ci_44                -3.243640e-03 3 1  ON 43
ci_45                -5.291203e-04 3 1  ON 44
ci_46                -8.703376e-04 3 1  ON 45
ci_47                 1.539462e-03 3 1  ON 46
ci_48                 1.376364e-03 3 1  ON 47
ci_49                -1.040235e-03 3 1  ON 48
ci_50                -8.128307e-04 3 1  ON 49
ci_51                 1.460576e-04 3 1  ON 50
ci_52                 8.308522e-05 3 1  ON 51
ci_53                -6.379614e-04 3 1  ON 52
ci_54                -1.026712e-03 3 1  ON 53
ci_55                -6.526925e-04 3 1  ON 54
ci_56                 2.627090e-03 3 1  ON 55
ci_57                 1.621562e-03 3 1  ON 56
ci_58                -1.116070e-03 3 1  ON 57
ci_59                -1.464160e-03 3 1  ON 58
ci_60                 5.451765e-04 3 1  ON 59
ci_61                -1.271575e-04 3 1  ON 60
ci_62                -6.691762e-04 3 1  ON 61
ci_63                -7.735730e-04 3 1  ON 62
ci_64                -2.614638e-04 3 1  ON 63
ci_65                 6.173504e-05 3 1  ON 64
ci_66                -7.131998e-04 3 1  ON 65
ci_67                -8.965587e-04 3 1  ON 66
ci_68                -1.372593e-03 3 1  ON 67
ci_69                 1.333823e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2218e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.75
    reference variance = 0.282016
====================================================
  Execution time = 4.2908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5144e-01
  Total weights = 1.964417992e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437645105177
                                         uncertainty =       0.002359826938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437645105177
                                         uncertainty =       0.002359826938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467783911
  error estimate for blocks of size 2^( 2) =       0.000493154318
  error estimate for blocks of size 2^( 3) =       0.000517057125
  error estimate for blocks of size 2^( 4) =       0.000534838404
  error estimate for blocks of size 2^( 5) =       0.000546762827
  error estimate for blocks of size 2^( 6) =       0.000551657602
  error estimate for blocks of size 2^( 7) =       0.000552091335

      target function =      -0.744149321383
              le_mean =     -22.813577321047
             les_mean =     520.910749133313
             stat err =       0.000546337542
             autocorr =       1.364053890031
   target nu stat err =       0.000546337542
   target dn stat err =       0.003343010655
      target stat err =       0.002807712061
              std dev =       0.661546350897
             le_variance =       0.437643574385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281357732105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744158927687       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744158932787       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744158933192       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744158933297       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744158933303       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744158933312       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744158933314       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744158933318       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744158933318       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 7.537658e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744158927687       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744158928962       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744158929064       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744158929090       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744158929100       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744158929092       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744158929107       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744158929096       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744158929096       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 1.884444e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744158927687       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744158928006       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744158928032       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744158928038       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744158928038       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744158928030       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744158928084       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744158928040       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744158928040       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 4.711130e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0599e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.272831e-01 3 1  ON 0
ci_02                -2.888492e-02 3 1  ON 1
ci_03                -2.899055e-02 3 1  ON 2
ci_04                 2.691619e-02 3 1  ON 3
ci_05                -2.207898e-02 3 1  ON 4
ci_06                -2.177233e-02 3 1  ON 5
ci_07                 2.739365e-02 3 1  ON 6
ci_08                -5.573380e-03 3 1  ON 7
ci_09                -9.048720e-03 3 1  ON 8
ci_10                -8.352034e-03 3 1  ON 9
ci_11                 1.321838e-02 3 1  ON 10
ci_12                 6.948112e-03 3 1  ON 11
ci_13                 1.283258e-02 3 1  ON 12
ci_14                 1.270516e-02 3 1  ON 13
ci_15                 6.267067e-03 3 1  ON 14
ci_16                 6.429043e-03 3 1  ON 15
ci_17                -7.247235e-03 3 1  ON 16
ci_18                -5.940817e-03 3 1  ON 17
ci_19                 9.300875e-03 3 1  ON 18
ci_20                 6.393504e-03 3 1  ON 19
ci_21                 9.004355e-03 3 1  ON 20
ci_22                 8.265582e-03 3 1  ON 21
ci_23                 4.758703e-03 3 1  ON 22
ci_24                 3.984183e-03 3 1  ON 23
ci_25                 2.848987e-03 3 1  ON 24
ci_26                 3.142536e-03 3 1  ON 25
ci_27                 3.318184e-03 3 1  ON 26
ci_28                 1.931205e-03 3 1  ON 27
ci_29                 1.304621e-03 3 1  ON 28
ci_30                -1.836227e-03 3 1  ON 29
ci_31                -5.566587e-04 3 1  ON 30
ci_32                -8.447877e-04 3 1  ON 31
ci_33                -1.469270e-03 3 1  ON 32
ci_34                 1.139166e-03 3 1  ON 33
ci_35                 1.458370e-03 3 1  ON 34
ci_36                -1.023679e-03 3 1  ON 35
ci_37                -1.033126e-03 3 1  ON 36
ci_38                -7.699045e-04 3 1  ON 37
ci_39                -6.235290e-04 3 1  ON 38
ci_40                -1.564237e-03 3 1  ON 39
ci_41                -1.245634e-03 3 1  ON 40
ci_42                -1.166321e-03 3 1  ON 41
ci_43                -2.482588e-03 3 1  ON 42
ci_44                -3.243641e-03 3 1  ON 43
ci_45                -5.291259e-04 3 1  ON 44
ci_46                -8.703321e-04 3 1  ON 45
ci_47                 1.539464e-03 3 1  ON 46
ci_48                 1.376360e-03 3 1  ON 47
ci_49                -1.040235e-03 3 1  ON 48
ci_50                -8.128297e-04 3 1  ON 49
ci_51                 1.460593e-04 3 1  ON 50
ci_52                 8.308909e-05 3 1  ON 51
ci_53                -6.379611e-04 3 1  ON 52
ci_54                -1.026708e-03 3 1  ON 53
ci_55                -6.526880e-04 3 1  ON 54
ci_56                 2.627089e-03 3 1  ON 55
ci_57                 1.621567e-03 3 1  ON 56
ci_58                -1.116089e-03 3 1  ON 57
ci_59                -1.464160e-03 3 1  ON 58
ci_60                 5.451798e-04 3 1  ON 59
ci_61                -1.271591e-04 3 1  ON 60
ci_62                -6.691759e-04 3 1  ON 61
ci_63                -7.735685e-04 3 1  ON 62
ci_64                -2.614668e-04 3 1  ON 63
ci_65                 6.173772e-05 3 1  ON 64
ci_66                -7.131997e-04 3 1  ON 65
ci_67                -8.965561e-04 3 1  ON 66
ci_68                -1.372597e-03 3 1  ON 67
ci_69                 1.333765e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.9197
    reference variance = 0.352968
====================================================
  Execution time = 4.1633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4516e-01
  Total weights = 1.9639e+06
  Execution time = 5.9109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434319805041
                                         uncertainty =       0.001871607049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434319805041
                                         uncertainty =       0.001871607049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465981252
  error estimate for blocks of size 2^( 2) =       0.000491385360
  error estimate for blocks of size 2^( 3) =       0.000514881265
  error estimate for blocks of size 2^( 4) =       0.000532688176
  error estimate for blocks of size 2^( 5) =       0.000543917875
  error estimate for blocks of size 2^( 6) =       0.000550685623
  error estimate for blocks of size 2^( 7) =       0.000553892418

      target function =      -0.749339379817
              le_mean =     -22.813529051264
             les_mean =     520.902267332987
             stat err =       0.000545296023
             autocorr =       1.369391956470
   target nu stat err =       0.000545296023
   target dn stat err =       0.002670307546
      target stat err =       0.002302009534
              std dev =       0.658997006359
             le_variance =       0.434277054390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434319798380
                                         uncertainty =       0.001871607099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434319798380
                                         uncertainty =       0.001871607099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465981248
  error estimate for blocks of size 2^( 2) =       0.000491385358
  error estimate for blocks of size 2^( 3) =       0.000514881265
  error estimate for blocks of size 2^( 4) =       0.000532688176
  error estimate for blocks of size 2^( 5) =       0.000543917876
  error estimate for blocks of size 2^( 6) =       0.000550685624
  error estimate for blocks of size 2^( 7) =       0.000553892420

      target function =      -0.749339407568
              le_mean =     -22.813529051449
             les_mean =     520.902267308084
             stat err =       0.000545296024
             autocorr =       1.369391982332
   target nu stat err =       0.000545296024
   target dn stat err =       0.002670302331
      target stat err =       0.002302005515
              std dev =       0.658997001305
             le_variance =       0.434277047729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434319801710
                                         uncertainty =       0.001871607074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434319801710
                                         uncertainty =       0.001871607074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465981250
  error estimate for blocks of size 2^( 2) =       0.000491385359
  error estimate for blocks of size 2^( 3) =       0.000514881265
  error estimate for blocks of size 2^( 4) =       0.000532688176
  error estimate for blocks of size 2^( 5) =       0.000543917875
  error estimate for blocks of size 2^( 6) =       0.000550685624
  error estimate for blocks of size 2^( 7) =       0.000553892419

      target function =      -0.749339393699
              le_mean =     -22.813529051357
             les_mean =     520.902267320526
             stat err =       0.000545296023
             autocorr =       1.369391969395
   target nu stat err =       0.000545296023
   target dn stat err =       0.002670304938
      target stat err =       0.002302007524
              std dev =       0.658997003832
             le_variance =       0.434277051060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434319804625
                                         uncertainty =       0.001871607052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434319804625
                                         uncertainty =       0.001871607052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465981252
  error estimate for blocks of size 2^( 2) =       0.000491385360
  error estimate for blocks of size 2^( 3) =       0.000514881265
  error estimate for blocks of size 2^( 4) =       0.000532688176
  error estimate for blocks of size 2^( 5) =       0.000543917875
  error estimate for blocks of size 2^( 6) =       0.000550685623
  error estimate for blocks of size 2^( 7) =       0.000553892418

      target function =      -0.749339381553
              le_mean =     -22.813529051276
             les_mean =     520.902267331428
             stat err =       0.000545296023
             autocorr =       1.369391958095
   target nu stat err =       0.000545296023
   target dn stat err =       0.002670307220
      target stat err =       0.002302009283
              std dev =       0.658997006043
             le_variance =       0.434277053974


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749339379817        initial
     2.3842e+03     2.3842e+04             7.5377e-08        -0.749339407568  <--
     9.5367e+03     9.5367e+04             1.8844e-08        -0.749339393699
     3.8147e+04     3.8147e+05             4.7111e-09        -0.749339381553

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 7.1366e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.272831e-01 3 1  ON 0
ci_02                -2.888492e-02 3 1  ON 1
ci_03                -2.899053e-02 3 1  ON 2
ci_04                 2.691619e-02 3 1  ON 3
ci_05                -2.207898e-02 3 1  ON 4
ci_06                -2.177229e-02 3 1  ON 5
ci_07                 2.739366e-02 3 1  ON 6
ci_08                -5.573379e-03 3 1  ON 7
ci_09                -9.048694e-03 3 1  ON 8
ci_10                -8.352036e-03 3 1  ON 9
ci_11                 1.321836e-02 3 1  ON 10
ci_12                 6.948130e-03 3 1  ON 11
ci_13                 1.283257e-02 3 1  ON 12
ci_14                 1.270517e-02 3 1  ON 13
ci_15                 6.267051e-03 3 1  ON 14
ci_16                 6.429026e-03 3 1  ON 15
ci_17                -7.247243e-03 3 1  ON 16
ci_18                -5.940798e-03 3 1  ON 17
ci_19                 9.300864e-03 3 1  ON 18
ci_20                 6.393513e-03 3 1  ON 19
ci_21                 9.004372e-03 3 1  ON 20
ci_22                 8.265576e-03 3 1  ON 21
ci_23                 4.758718e-03 3 1  ON 22
ci_24                 3.984191e-03 3 1  ON 23
ci_25                 2.848967e-03 3 1  ON 24
ci_26                 3.142539e-03 3 1  ON 25
ci_27                 3.318209e-03 3 1  ON 26
ci_28                 1.931203e-03 3 1  ON 27
ci_29                 1.304639e-03 3 1  ON 28
ci_30                -1.836244e-03 3 1  ON 29
ci_31                -5.566520e-04 3 1  ON 30
ci_32                -8.447970e-04 3 1  ON 31
ci_33                -1.469269e-03 3 1  ON 32
ci_34                 1.139162e-03 3 1  ON 33
ci_35                 1.458391e-03 3 1  ON 34
ci_36                -1.023692e-03 3 1  ON 35
ci_37                -1.033130e-03 3 1  ON 36
ci_38                -7.699014e-04 3 1  ON 37
ci_39                -6.235379e-04 3 1  ON 38
ci_40                -1.564228e-03 3 1  ON 39
ci_41                -1.245645e-03 3 1  ON 40
ci_42                -1.166294e-03 3 1  ON 41
ci_43                -2.482603e-03 3 1  ON 42
ci_44                -3.243645e-03 3 1  ON 43
ci_45                -5.291425e-04 3 1  ON 44
ci_46                -8.703155e-04 3 1  ON 45
ci_47                 1.539470e-03 3 1  ON 46
ci_48                 1.376349e-03 3 1  ON 47
ci_49                -1.040235e-03 3 1  ON 48
ci_50                -8.128267e-04 3 1  ON 49
ci_51                 1.460643e-04 3 1  ON 50
ci_52                 8.310070e-05 3 1  ON 51
ci_53                -6.379602e-04 3 1  ON 52
ci_54                -1.026695e-03 3 1  ON 53
ci_55                -6.526747e-04 3 1  ON 54
ci_56                 2.627085e-03 3 1  ON 55
ci_57                 1.621584e-03 3 1  ON 56
ci_58                -1.116146e-03 3 1  ON 57
ci_59                -1.464161e-03 3 1  ON 58
ci_60                 5.451895e-04 3 1  ON 59
ci_61                -1.271639e-04 3 1  ON 60
ci_62                -6.691750e-04 3 1  ON 61
ci_63                -7.735552e-04 3 1  ON 62
ci_64                -2.614757e-04 3 1  ON 63
ci_65                 6.174578e-05 3 1  ON 64
ci_66                -7.131993e-04 3 1  ON 65
ci_67                -8.965486e-04 3 1  ON 66
ci_68                -1.372610e-03 3 1  ON 67
ci_69                 1.333593e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2197e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8303
    reference variance = 0.347335
====================================================
  Execution time = 4.5122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5368e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5212e-01
  Total weights = 1.964146327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436557256120
                                         uncertainty =       0.001713265213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436557256120
                                         uncertainty =       0.001713265213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467231023
  error estimate for blocks of size 2^( 2) =       0.000492867156
  error estimate for blocks of size 2^( 3) =       0.000517673180
  error estimate for blocks of size 2^( 4) =       0.000535895530
  error estimate for blocks of size 2^( 5) =       0.000546780353
  error estimate for blocks of size 2^( 6) =       0.000552460573
  error estimate for blocks of size 2^( 7) =       0.000557293790

      target function =      -0.743596917490
              le_mean =     -22.814632765096
             les_mean =     520.959588853527
             stat err =       0.000548107562
             autocorr =       1.376157828909
   target nu stat err =       0.000548107562
   target dn stat err =       0.002858106457
      target stat err =       0.002421477946
              std dev =       0.660764449334
             le_variance =       0.436609657503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281463276510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743603801921       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743603827165       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743603830694       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743603831274       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743603831697       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743603831840       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743603831846       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743603831835       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743603831835       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 3.801861e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743603801921       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743603808232       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743603809114       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743603809260       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743603809368       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743603809403       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743603809394       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743603809403       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743603809403       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 9.504978e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743603801921       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743603803499       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743603803719       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743603803757       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743603803772       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743603803788       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743603803803       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743603803773       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743603803786       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 2.376265e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2818e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.272830e-01 3 1  ON 0
ci_02                -2.888485e-02 3 1  ON 1
ci_03                -2.899051e-02 3 1  ON 2
ci_04                 2.691615e-02 3 1  ON 3
ci_05                -2.207897e-02 3 1  ON 4
ci_06                -2.177224e-02 3 1  ON 5
ci_07                 2.739364e-02 3 1  ON 6
ci_08                -5.573367e-03 3 1  ON 7
ci_09                -9.048678e-03 3 1  ON 8
ci_10                -8.352056e-03 3 1  ON 9
ci_11                 1.321838e-02 3 1  ON 10
ci_12                 6.948152e-03 3 1  ON 11
ci_13                 1.283257e-02 3 1  ON 12
ci_14                 1.270516e-02 3 1  ON 13
ci_15                 6.267088e-03 3 1  ON 14
ci_16                 6.429039e-03 3 1  ON 15
ci_17                -7.247229e-03 3 1  ON 16
ci_18                -5.940811e-03 3 1  ON 17
ci_19                 9.300872e-03 3 1  ON 18
ci_20                 6.393511e-03 3 1  ON 19
ci_21                 9.004400e-03 3 1  ON 20
ci_22                 8.265594e-03 3 1  ON 21
ci_23                 4.758737e-03 3 1  ON 22
ci_24                 3.984181e-03 3 1  ON 23
ci_25                 2.848954e-03 3 1  ON 24
ci_26                 3.142501e-03 3 1  ON 25
ci_27                 3.318157e-03 3 1  ON 26
ci_28                 1.931207e-03 3 1  ON 27
ci_29                 1.304654e-03 3 1  ON 28
ci_30                -1.836222e-03 3 1  ON 29
ci_31                -5.566592e-04 3 1  ON 30
ci_32                -8.448164e-04 3 1  ON 31
ci_33                -1.469287e-03 3 1  ON 32
ci_34                 1.139182e-03 3 1  ON 33
ci_35                 1.458379e-03 3 1  ON 34
ci_36                -1.023707e-03 3 1  ON 35
ci_37                -1.033142e-03 3 1  ON 36
ci_38                -7.699146e-04 3 1  ON 37
ci_39                -6.235341e-04 3 1  ON 38
ci_40                -1.564212e-03 3 1  ON 39
ci_41                -1.245640e-03 3 1  ON 40
ci_42                -1.166316e-03 3 1  ON 41
ci_43                -2.482607e-03 3 1  ON 42
ci_44                -3.243605e-03 3 1  ON 43
ci_45                -5.291330e-04 3 1  ON 44
ci_46                -8.703315e-04 3 1  ON 45
ci_47                 1.539447e-03 3 1  ON 46
ci_48                 1.376327e-03 3 1  ON 47
ci_49                -1.040237e-03 3 1  ON 48
ci_50                -8.128148e-04 3 1  ON 49
ci_51                 1.460537e-04 3 1  ON 50
ci_52                 8.310597e-05 3 1  ON 51
ci_53                -6.379564e-04 3 1  ON 52
ci_54                -1.026695e-03 3 1  ON 53
ci_55                -6.526553e-04 3 1  ON 54
ci_56                 2.627075e-03 3 1  ON 55
ci_57                 1.621589e-03 3 1  ON 56
ci_58                -1.116124e-03 3 1  ON 57
ci_59                -1.464150e-03 3 1  ON 58
ci_60                 5.451994e-04 3 1  ON 59
ci_61                -1.271897e-04 3 1  ON 60
ci_62                -6.691825e-04 3 1  ON 61
ci_63                -7.735367e-04 3 1  ON 62
ci_64                -2.614803e-04 3 1  ON 63
ci_65                 6.174009e-05 3 1  ON 64
ci_66                -7.132135e-04 3 1  ON 65
ci_67                -8.965268e-04 3 1  ON 66
ci_68                -1.372586e-03 3 1  ON 67
ci_69                 1.333305e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.9041
    reference variance = 0.483823
====================================================
  Execution time = 4.2033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4989e-01
  Total weights = 1.9642e+06
  Execution time = 5.8937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724052742
                                         uncertainty =       0.002401829792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724052742
                                         uncertainty =       0.002401829792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466788894
  error estimate for blocks of size 2^( 2) =       0.000491944756
  error estimate for blocks of size 2^( 3) =       0.000515945897
  error estimate for blocks of size 2^( 4) =       0.000533344215
  error estimate for blocks of size 2^( 5) =       0.000543162162
  error estimate for blocks of size 2^( 6) =       0.000549407920
  error estimate for blocks of size 2^( 7) =       0.000550401519

      target function =      -0.745426488297
              le_mean =     -22.814734008779
             les_mean =     520.961983757323
             stat err =       0.000544078954
             autocorr =       1.358572517101
   target nu stat err =       0.000544078954
   target dn stat err =       0.002967615647
      target stat err =       0.002519885042
              std dev =       0.660139184395
             le_variance =       0.435783742773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724010732
                                         uncertainty =       0.002401825352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724010732
                                         uncertainty =       0.002401825352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466788871
  error estimate for blocks of size 2^( 2) =       0.000491944746
  error estimate for blocks of size 2^( 3) =       0.000515945896
  error estimate for blocks of size 2^( 4) =       0.000533344219
  error estimate for blocks of size 2^( 5) =       0.000543162168
  error estimate for blocks of size 2^( 6) =       0.000549407924
  error estimate for blocks of size 2^( 7) =       0.000550401523

      target function =      -0.745429110932
              le_mean =     -22.814734006732
             les_mean =     520.961980481713
             stat err =       0.000544078958
             autocorr =       1.358572669540
   target nu stat err =       0.000544078958
   target dn stat err =       0.002967840476
      target stat err =       0.002520082286
              std dev =       0.660139152726
             le_variance =       0.435783700962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724031734
                                         uncertainty =       0.002401827572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724031734
                                         uncertainty =       0.002401827572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466788883
  error estimate for blocks of size 2^( 2) =       0.000491944751
  error estimate for blocks of size 2^( 3) =       0.000515945897
  error estimate for blocks of size 2^( 4) =       0.000533344217
  error estimate for blocks of size 2^( 5) =       0.000543162165
  error estimate for blocks of size 2^( 6) =       0.000549407922
  error estimate for blocks of size 2^( 7) =       0.000550401521

      target function =      -0.745427974915
              le_mean =     -22.814734007757
             les_mean =     520.961981906953
             stat err =       0.000544078956
             autocorr =       1.358572593316
   target nu stat err =       0.000544078956
   target dn stat err =       0.002967726661
      target stat err =       0.002519983694
              std dev =       0.660139168558
             le_variance =       0.435783721865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724050116
                                         uncertainty =       0.002401829515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724050116
                                         uncertainty =       0.002401829515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466788892
  error estimate for blocks of size 2^( 2) =       0.000491944756
  error estimate for blocks of size 2^( 3) =       0.000515945897
  error estimate for blocks of size 2^( 4) =       0.000533344215
  error estimate for blocks of size 2^( 5) =       0.000543162162
  error estimate for blocks of size 2^( 6) =       0.000549407920
  error estimate for blocks of size 2^( 7) =       0.000550401520

      target function =      -0.745426697325
              le_mean =     -22.814734008652
             les_mean =     520.961983497894
             stat err =       0.000544078954
             autocorr =       1.358572526629
   target nu stat err =       0.000544078954
   target dn stat err =       0.002967629320
      target stat err =       0.002519897363
              std dev =       0.660139182415
             le_variance =       0.435783740160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745426488297        initial
     5.9605e+02     5.9605e+03             3.8019e-07        -0.745429110932  <--
     2.3842e+03     2.3842e+04             9.5050e-08        -0.745427974915
     9.5367e+03     9.5367e+04             2.3763e-08        -0.745426697325

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 7.1962e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.272827e-01 3 1  ON 0
ci_02                -2.888466e-02 3 1  ON 1
ci_03                -2.899043e-02 3 1  ON 2
ci_04                 2.691604e-02 3 1  ON 3
ci_05                -2.207893e-02 3 1  ON 4
ci_06                -2.177211e-02 3 1  ON 5
ci_07                 2.739356e-02 3 1  ON 6
ci_08                -5.573333e-03 3 1  ON 7
ci_09                -9.048630e-03 3 1  ON 8
ci_10                -8.352118e-03 3 1  ON 9
ci_11                 1.321842e-02 3 1  ON 10
ci_12                 6.948217e-03 3 1  ON 11
ci_13                 1.283256e-02 3 1  ON 12
ci_14                 1.270514e-02 3 1  ON 13
ci_15                 6.267197e-03 3 1  ON 14
ci_16                 6.429079e-03 3 1  ON 15
ci_17                -7.247186e-03 3 1  ON 16
ci_18                -5.940853e-03 3 1  ON 17
ci_19                 9.300895e-03 3 1  ON 18
ci_20                 6.393503e-03 3 1  ON 19
ci_21                 9.004484e-03 3 1  ON 20
ci_22                 8.265647e-03 3 1  ON 21
ci_23                 4.758794e-03 3 1  ON 22
ci_24                 3.984153e-03 3 1  ON 23
ci_25                 2.848915e-03 3 1  ON 24
ci_26                 3.142387e-03 3 1  ON 25
ci_27                 3.318002e-03 3 1  ON 26
ci_28                 1.931218e-03 3 1  ON 27
ci_29                 1.304699e-03 3 1  ON 28
ci_30                -1.836155e-03 3 1  ON 29
ci_31                -5.566807e-04 3 1  ON 30
ci_32                -8.448744e-04 3 1  ON 31
ci_33                -1.469342e-03 3 1  ON 32
ci_34                 1.139242e-03 3 1  ON 33
ci_35                 1.458345e-03 3 1  ON 34
ci_36                -1.023754e-03 3 1  ON 35
ci_37                -1.033177e-03 3 1  ON 36
ci_38                -7.699544e-04 3 1  ON 37
ci_39                -6.235228e-04 3 1  ON 38
ci_40                -1.564165e-03 3 1  ON 39
ci_41                -1.245625e-03 3 1  ON 40
ci_42                -1.166380e-03 3 1  ON 41
ci_43                -2.482619e-03 3 1  ON 42
ci_44                -3.243482e-03 3 1  ON 43
ci_45                -5.291044e-04 3 1  ON 44
ci_46                -8.703795e-04 3 1  ON 45
ci_47                 1.539378e-03 3 1  ON 46
ci_48                 1.376263e-03 3 1  ON 47
ci_49                -1.040241e-03 3 1  ON 48
ci_50                -8.127793e-04 3 1  ON 49
ci_51                 1.460217e-04 3 1  ON 50
ci_52                 8.312180e-05 3 1  ON 51
ci_53                -6.379449e-04 3 1  ON 52
ci_54                -1.026695e-03 3 1  ON 53
ci_55                -6.525973e-04 3 1  ON 54
ci_56                 2.627045e-03 3 1  ON 55
ci_57                 1.621604e-03 3 1  ON 56
ci_58                -1.116061e-03 3 1  ON 57
ci_59                -1.464115e-03 3 1  ON 58
ci_60                 5.452290e-04 3 1  ON 59
ci_61                -1.272671e-04 3 1  ON 60
ci_62                -6.692051e-04 3 1  ON 61
ci_63                -7.734813e-04 3 1  ON 62
ci_64                -2.614944e-04 3 1  ON 63
ci_65                 6.172304e-05 3 1  ON 64
ci_66                -7.132561e-04 3 1  ON 65
ci_67                -8.964616e-04 3 1  ON 66
ci_68                -1.372515e-03 3 1  ON 67
ci_69                 1.332444e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2479e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8511
    reference variance = 0.562829
====================================================
  Execution time = 4.5895e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4744e-01
  Total weights = 1.964384261e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433475494335
                                         uncertainty =       0.001716524166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433475494335
                                         uncertainty =       0.001716524166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465554286
  error estimate for blocks of size 2^( 2) =       0.000490713115
  error estimate for blocks of size 2^( 3) =       0.000513999911
  error estimate for blocks of size 2^( 4) =       0.000532363949
  error estimate for blocks of size 2^( 5) =       0.000544338665
  error estimate for blocks of size 2^( 6) =       0.000552407056
  error estimate for blocks of size 2^( 7) =       0.000553208731

      target function =      -0.747454762283
              le_mean =     -22.814904169009
             les_mean =     520.967296985367
             stat err =       0.000545579600
             autocorr =       1.373332155999
   target nu stat err =       0.000545579600
   target dn stat err =       0.002890775976
      target stat err =       0.002472432055
              std dev =       0.658393184799
             le_variance =       0.433481585790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281490416901e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747462006761       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747462319238       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747462338154       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747462340310       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747462337176       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747462339231       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747462339954       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747462340140       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747462339685       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747462339721       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747462339650       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 2.492915e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747462006761       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747462084900       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747462089628       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747462090167       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747462089382       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747462089897       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747462090079       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747462090123       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747462090010       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747462090018       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747462090000       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 6.233898e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747462006761       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747462026297       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747462027479       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747462027614       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747462027411       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747462027546       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747462027590       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747462027602       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747462027579       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747462027580       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747462027576       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 1.558575e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3595e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.272826e-01 3 1  ON 0
ci_02                -2.888463e-02 3 1  ON 1
ci_03                -2.899050e-02 3 1  ON 2
ci_04                 2.691591e-02 3 1  ON 3
ci_05                -2.207865e-02 3 1  ON 4
ci_06                -2.177205e-02 3 1  ON 5
ci_07                 2.739344e-02 3 1  ON 6
ci_08                -5.573477e-03 3 1  ON 7
ci_09                -9.048659e-03 3 1  ON 8
ci_10                -8.352126e-03 3 1  ON 9
ci_11                 1.321835e-02 3 1  ON 10
ci_12                 6.948222e-03 3 1  ON 11
ci_13                 1.283251e-02 3 1  ON 12
ci_14                 1.270576e-02 3 1  ON 13
ci_15                 6.267055e-03 3 1  ON 14
ci_16                 6.429091e-03 3 1  ON 15
ci_17                -7.247137e-03 3 1  ON 16
ci_18                -5.940809e-03 3 1  ON 17
ci_19                 9.300961e-03 3 1  ON 18
ci_20                 6.393427e-03 3 1  ON 19
ci_21                 9.004434e-03 3 1  ON 20
ci_22                 8.265676e-03 3 1  ON 21
ci_23                 4.758753e-03 3 1  ON 22
ci_24                 3.984271e-03 3 1  ON 23
ci_25                 2.848913e-03 3 1  ON 24
ci_26                 3.142412e-03 3 1  ON 25
ci_27                 3.317794e-03 3 1  ON 26
ci_28                 1.931230e-03 3 1  ON 27
ci_29                 1.304678e-03 3 1  ON 28
ci_30                -1.836004e-03 3 1  ON 29
ci_31                -5.568453e-04 3 1  ON 30
ci_32                -8.449391e-04 3 1  ON 31
ci_33                -1.469273e-03 3 1  ON 32
ci_34                 1.139301e-03 3 1  ON 33
ci_35                 1.458304e-03 3 1  ON 34
ci_36                -1.023849e-03 3 1  ON 35
ci_37                -1.033257e-03 3 1  ON 36
ci_38                -7.699395e-04 3 1  ON 37
ci_39                -6.236097e-04 3 1  ON 38
ci_40                -1.564210e-03 3 1  ON 39
ci_41                -1.245708e-03 3 1  ON 40
ci_42                -1.166496e-03 3 1  ON 41
ci_43                -2.482606e-03 3 1  ON 42
ci_44                -3.243326e-03 3 1  ON 43
ci_45                -5.290579e-04 3 1  ON 44
ci_46                -8.703748e-04 3 1  ON 45
ci_47                 1.539301e-03 3 1  ON 46
ci_48                 1.376306e-03 3 1  ON 47
ci_49                -1.040175e-03 3 1  ON 48
ci_50                -8.125823e-04 3 1  ON 49
ci_51                 1.459761e-04 3 1  ON 50
ci_52                 8.306545e-05 3 1  ON 51
ci_53                -6.380317e-04 3 1  ON 52
ci_54                -1.026619e-03 3 1  ON 53
ci_55                -6.525020e-04 3 1  ON 54
ci_56                 2.627083e-03 3 1  ON 55
ci_57                 1.621677e-03 3 1  ON 56
ci_58                -1.116020e-03 3 1  ON 57
ci_59                -1.464019e-03 3 1  ON 58
ci_60                 5.451424e-04 3 1  ON 59
ci_61                -1.275423e-04 3 1  ON 60
ci_62                -6.691238e-04 3 1  ON 61
ci_63                -7.734960e-04 3 1  ON 62
ci_64                -2.616437e-04 3 1  ON 63
ci_65                 6.174296e-05 3 1  ON 64
ci_66                -7.130281e-04 3 1  ON 65
ci_67                -8.966446e-04 3 1  ON 66
ci_68                -1.372479e-03 3 1  ON 67
ci_69                 1.332342e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7701
    reference variance = 0.411433
====================================================
  Execution time = 4.3003e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4881e-01
  Total weights = 1.9642e+06
  Execution time = 6.0007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437705088236
                                         uncertainty =       0.002960936996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437705088236
                                         uncertainty =       0.002960936996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467794667
  error estimate for blocks of size 2^( 2) =       0.000493382439
  error estimate for blocks of size 2^( 3) =       0.000516762347
  error estimate for blocks of size 2^( 4) =       0.000534711621
  error estimate for blocks of size 2^( 5) =       0.000546119182
  error estimate for blocks of size 2^( 6) =       0.000552200075
  error estimate for blocks of size 2^( 7) =       0.000556437875

      target function =      -0.746316842543
              le_mean =     -22.814819409579
             les_mean =     520.964794731850
             stat err =       0.000547367188
             autocorr =       1.369137249102
   target nu stat err =       0.000547367188
   target dn stat err =       0.004019771141
      target stat err =       0.003377749299
              std dev =       0.661561563155
             le_variance =       0.437663701845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437705078583
                                         uncertainty =       0.002960983019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437705078583
                                         uncertainty =       0.002960983019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467794663
  error estimate for blocks of size 2^( 2) =       0.000493382450
  error estimate for blocks of size 2^( 3) =       0.000516762373
  error estimate for blocks of size 2^( 4) =       0.000534711641
  error estimate for blocks of size 2^( 5) =       0.000546119186
  error estimate for blocks of size 2^( 6) =       0.000552200063
  error estimate for blocks of size 2^( 7) =       0.000556437890

      target function =      -0.746317690125
              le_mean =     -22.814819399751
             les_mean =     520.964793257602
             stat err =       0.000547367195
             autocorr =       1.369137313052
   target nu stat err =       0.000547367195
   target dn stat err =       0.004019808633
      target stat err =       0.003377787290
              std dev =       0.661561556446
             le_variance =       0.437663692967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437705083377
                                         uncertainty =       0.002960960019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437705083377
                                         uncertainty =       0.002960960019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467794665
  error estimate for blocks of size 2^( 2) =       0.000493382444
  error estimate for blocks of size 2^( 3) =       0.000516762360
  error estimate for blocks of size 2^( 4) =       0.000534711631
  error estimate for blocks of size 2^( 5) =       0.000546119184
  error estimate for blocks of size 2^( 6) =       0.000552200069
  error estimate for blocks of size 2^( 7) =       0.000556437882

      target function =      -0.746317314715
              le_mean =     -22.814819404657
             les_mean =     520.964793935839
             stat err =       0.000547367191
             autocorr =       1.369137281083
   target nu stat err =       0.000547367191
   target dn stat err =       0.004019789850
      target stat err =       0.003377768695
              std dev =       0.661561559776
             le_variance =       0.437663697374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437705087624
                                         uncertainty =       0.002960939874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437705087624
                                         uncertainty =       0.002960939874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467794667
  error estimate for blocks of size 2^( 2) =       0.000493382439
  error estimate for blocks of size 2^( 3) =       0.000516762349
  error estimate for blocks of size 2^( 4) =       0.000534711622
  error estimate for blocks of size 2^( 5) =       0.000546119182
  error estimate for blocks of size 2^( 6) =       0.000552200074
  error estimate for blocks of size 2^( 7) =       0.000556437876

      target function =      -0.746316908300
              le_mean =     -22.814819408963
             les_mean =     520.964794624166
             stat err =       0.000547367188
             autocorr =       1.369137253095
   target nu stat err =       0.000547367188
   target dn stat err =       0.004019773473
      target stat err =       0.003377751778
              std dev =       0.661561562730
             le_variance =       0.437663701281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746316842543        initial
     1.4901e+02     1.4901e+03             2.4929e-06        -0.746317690125  <--
     5.9605e+02     5.9605e+03             6.2339e-07        -0.746317314715
     2.3842e+03     2.3842e+04             1.5586e-07        -0.746316908300

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 7.3128e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.272821e-01 3 1  ON 0
ci_02                -2.888453e-02 3 1  ON 1
ci_03                -2.899071e-02 3 1  ON 2
ci_04                 2.691553e-02 3 1  ON 3
ci_05                -2.207784e-02 3 1  ON 4
ci_06                -2.177188e-02 3 1  ON 5
ci_07                 2.739308e-02 3 1  ON 6
ci_08                -5.573909e-03 3 1  ON 7
ci_09                -9.048748e-03 3 1  ON 8
ci_10                -8.352151e-03 3 1  ON 9
ci_11                 1.321815e-02 3 1  ON 10
ci_12                 6.948234e-03 3 1  ON 11
ci_13                 1.283235e-02 3 1  ON 12
ci_14                 1.270763e-02 3 1  ON 13
ci_15                 6.266631e-03 3 1  ON 14
ci_16                 6.429127e-03 3 1  ON 15
ci_17                -7.246988e-03 3 1  ON 16
ci_18                -5.940679e-03 3 1  ON 17
ci_19                 9.301157e-03 3 1  ON 18
ci_20                 6.393199e-03 3 1  ON 19
ci_21                 9.004282e-03 3 1  ON 20
ci_22                 8.265763e-03 3 1  ON 21
ci_23                 4.758630e-03 3 1  ON 22
ci_24                 3.984626e-03 3 1  ON 23
ci_25                 2.848906e-03 3 1  ON 24
ci_26                 3.142487e-03 3 1  ON 25
ci_27                 3.317170e-03 3 1  ON 26
ci_28                 1.931265e-03 3 1  ON 27
ci_29                 1.304616e-03 3 1  ON 28
ci_30                -1.835551e-03 3 1  ON 29
ci_31                -5.573387e-04 3 1  ON 30
ci_32                -8.451332e-04 3 1  ON 31
ci_33                -1.469066e-03 3 1  ON 32
ci_34                 1.139477e-03 3 1  ON 33
ci_35                 1.458184e-03 3 1  ON 34
ci_36                -1.024137e-03 3 1  ON 35
ci_37                -1.033494e-03 3 1  ON 36
ci_38                -7.698948e-04 3 1  ON 37
ci_39                -6.238703e-04 3 1  ON 38
ci_40                -1.564344e-03 3 1  ON 39
ci_41                -1.245956e-03 3 1  ON 40
ci_42                -1.166843e-03 3 1  ON 41
ci_43                -2.482568e-03 3 1  ON 42
ci_44                -3.242860e-03 3 1  ON 43
ci_45                -5.289184e-04 3 1  ON 44
ci_46                -8.703607e-04 3 1  ON 45
ci_47                 1.539071e-03 3 1  ON 46
ci_48                 1.376434e-03 3 1  ON 47
ci_49                -1.039978e-03 3 1  ON 48
ci_50                -8.119918e-04 3 1  ON 49
ci_51                 1.458396e-04 3 1  ON 50
ci_52                 8.289646e-05 3 1  ON 51
ci_53                -6.382918e-04 3 1  ON 52
ci_54                -1.026390e-03 3 1  ON 53
ci_55                -6.522162e-04 3 1  ON 54
ci_56                 2.627200e-03 3 1  ON 55
ci_57                 1.621895e-03 3 1  ON 56
ci_58                -1.115898e-03 3 1  ON 57
ci_59                -1.463729e-03 3 1  ON 58
ci_60                 5.448830e-04 3 1  ON 59
ci_61                -1.283679e-04 3 1  ON 60
ci_62                -6.688800e-04 3 1  ON 61
ci_63                -7.735401e-04 3 1  ON 62
ci_64                -2.620915e-04 3 1  ON 63
ci_65                 6.180271e-05 3 1  ON 64
ci_66                -7.123442e-04 3 1  ON 65
ci_67                -8.971932e-04 3 1  ON 66
ci_68                -1.372370e-03 3 1  ON 67
ci_69                 1.332036e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2673e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7996
    reference variance = 0.233688
====================================================
  Execution time = 4.3978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4227e-01
  Total weights = 1.964098828e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431835980271
                                         uncertainty =       0.002023792604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431835980271
                                         uncertainty =       0.002023792604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464654114
  error estimate for blocks of size 2^( 2) =       0.000490384737
  error estimate for blocks of size 2^( 3) =       0.000514209429
  error estimate for blocks of size 2^( 4) =       0.000532767759
  error estimate for blocks of size 2^( 5) =       0.000543336488
  error estimate for blocks of size 2^( 6) =       0.000550704266
  error estimate for blocks of size 2^( 7) =       0.000554171867

      target function =      -0.751769464870
              le_mean =     -22.814440336608
             les_mean =     520.940953967416
             stat err =       0.000545245095
             autocorr =       1.376968361858
   target nu stat err =       0.000545245095
   target dn stat err =       0.002417529249
      target stat err =       0.002115799336
              std dev =       0.657120149699
             le_variance =       0.431806891140


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281444033661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751774398293       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751774682479       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751774722873       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751774729110       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751774730840       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751774731454       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751774730668       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751774730876       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751774730924       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 4.385916e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751774398293       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751774469411       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751774479516       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751774481075       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751774481507       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751774481660       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751774481464       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751774481516       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751774481528       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.097081e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751774398293       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751774416077       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751774418604       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751774418993       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751774419101       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751774419139       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751774419092       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751774419104       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751774419107       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 2.743080e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1683e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.272810e-01 3 1  ON 0
ci_02                -2.888399e-02 3 1  ON 1
ci_03                -2.899052e-02 3 1  ON 2
ci_04                 2.691479e-02 3 1  ON 3
ci_05                -2.207738e-02 3 1  ON 4
ci_06                -2.177189e-02 3 1  ON 5
ci_07                 2.739245e-02 3 1  ON 6
ci_08                -5.573750e-03 3 1  ON 7
ci_09                -9.048055e-03 3 1  ON 8
ci_10                -8.352258e-03 3 1  ON 9
ci_11                 1.321810e-02 3 1  ON 10
ci_12                 6.948355e-03 3 1  ON 11
ci_13                 1.283223e-02 3 1  ON 12
ci_14                 1.270784e-02 3 1  ON 13
ci_15                 6.266696e-03 3 1  ON 14
ci_16                 6.428804e-03 3 1  ON 15
ci_17                -7.246625e-03 3 1  ON 16
ci_18                -5.940735e-03 3 1  ON 17
ci_19                 9.300724e-03 3 1  ON 18
ci_20                 6.393101e-03 3 1  ON 19
ci_21                 9.004358e-03 3 1  ON 20
ci_22                 8.265649e-03 3 1  ON 21
ci_23                 4.758330e-03 3 1  ON 22
ci_24                 3.984536e-03 3 1  ON 23
ci_25                 2.848681e-03 3 1  ON 24
ci_26                 3.141447e-03 3 1  ON 25
ci_27                 3.317244e-03 3 1  ON 26
ci_28                 1.931465e-03 3 1  ON 27
ci_29                 1.304665e-03 3 1  ON 28
ci_30                -1.835344e-03 3 1  ON 29
ci_31                -5.572292e-04 3 1  ON 30
ci_32                -8.450427e-04 3 1  ON 31
ci_33                -1.468858e-03 3 1  ON 32
ci_34                 1.139542e-03 3 1  ON 33
ci_35                 1.458202e-03 3 1  ON 34
ci_36                -1.024247e-03 3 1  ON 35
ci_37                -1.033219e-03 3 1  ON 36
ci_38                -7.698872e-04 3 1  ON 37
ci_39                -6.239038e-04 3 1  ON 38
ci_40                -1.564281e-03 3 1  ON 39
ci_41                -1.246134e-03 3 1  ON 40
ci_42                -1.166945e-03 3 1  ON 41
ci_43                -2.482471e-03 3 1  ON 42
ci_44                -3.242658e-03 3 1  ON 43
ci_45                -5.286990e-04 3 1  ON 44
ci_46                -8.699412e-04 3 1  ON 45
ci_47                 1.538867e-03 3 1  ON 46
ci_48                 1.376033e-03 3 1  ON 47
ci_49                -1.040152e-03 3 1  ON 48
ci_50                -8.120009e-04 3 1  ON 49
ci_51                 1.457879e-04 3 1  ON 50
ci_52                 8.279278e-05 3 1  ON 51
ci_53                -6.383122e-04 3 1  ON 52
ci_54                -1.026310e-03 3 1  ON 53
ci_55                -6.522681e-04 3 1  ON 54
ci_56                 2.627239e-03 3 1  ON 55
ci_57                 1.622340e-03 3 1  ON 56
ci_58                -1.115764e-03 3 1  ON 57
ci_59                -1.463420e-03 3 1  ON 58
ci_60                 5.448220e-04 3 1  ON 59
ci_61                -1.283323e-04 3 1  ON 60
ci_62                -6.687355e-04 3 1  ON 61
ci_63                -7.733385e-04 3 1  ON 62
ci_64                -2.619629e-04 3 1  ON 63
ci_65                 6.153294e-05 3 1  ON 64
ci_66                -7.123373e-04 3 1  ON 65
ci_67                -8.971545e-04 3 1  ON 66
ci_68                -1.372162e-03 3 1  ON 67
ci_69                 1.330641e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8824
    reference variance = 0.598081
====================================================
  Execution time = 4.3711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5246e-01
  Total weights = 1.9644e+06
  Execution time = 5.8925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437091153767
                                         uncertainty =       0.002354009121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437091153767
                                         uncertainty =       0.002354009121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467493510
  error estimate for blocks of size 2^( 2) =       0.000492585576
  error estimate for blocks of size 2^( 3) =       0.000516288301
  error estimate for blocks of size 2^( 4) =       0.000533077923
  error estimate for blocks of size 2^( 5) =       0.000545415275
  error estimate for blocks of size 2^( 6) =       0.000551474556
  error estimate for blocks of size 2^( 7) =       0.000557116142

      target function =      -0.743310666565
              le_mean =     -22.814613840224
             les_mean =     520.959068761965
             stat err =       0.000546770974
             autocorr =       1.367916949259
   target nu stat err =       0.000546770974
   target dn stat err =       0.003619524998
      target stat err =       0.003027715984
              std dev =       0.661135662105
             le_variance =       0.437100363707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437090861346
                                         uncertainty =       0.002354013271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437090861346
                                         uncertainty =       0.002354013271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467493348
  error estimate for blocks of size 2^( 2) =       0.000492585579
  error estimate for blocks of size 2^( 3) =       0.000516288502
  error estimate for blocks of size 2^( 4) =       0.000533078280
  error estimate for blocks of size 2^( 5) =       0.000545415652
  error estimate for blocks of size 2^( 6) =       0.000551474911
  error estimate for blocks of size 2^( 7) =       0.000557116588

      target function =      -0.743312134832
              le_mean =     -22.814613861608
             les_mean =     520.959067941818
             stat err =       0.000546771358
             autocorr =       1.367919815850
   target nu stat err =       0.000546771358
   target dn stat err =       0.003620119694
      target stat err =       0.003028205637
              std dev =       0.661135433478
             le_variance =       0.437100061400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437091007168
                                         uncertainty =       0.002354011204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437091007168
                                         uncertainty =       0.002354011204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467493429
  error estimate for blocks of size 2^( 2) =       0.000492585577
  error estimate for blocks of size 2^( 3) =       0.000516288401
  error estimate for blocks of size 2^( 4) =       0.000533078102
  error estimate for blocks of size 2^( 5) =       0.000545415464
  error estimate for blocks of size 2^( 6) =       0.000551474734
  error estimate for blocks of size 2^( 7) =       0.000557116365

      target function =      -0.743311763270
              le_mean =     -22.814613850829
             les_mean =     520.959067905619
             stat err =       0.000546771166
             autocorr =       1.367918384830
   target nu stat err =       0.000546771166
   target dn stat err =       0.003619821602
      target stat err =       0.003027963107
              std dev =       0.661135547494
             le_variance =       0.437100212160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437091135406
                                         uncertainty =       0.002354009381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437091135406
                                         uncertainty =       0.002354009381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467493500
  error estimate for blocks of size 2^( 2) =       0.000492585576
  error estimate for blocks of size 2^( 3) =       0.000516288313
  error estimate for blocks of size 2^( 4) =       0.000533077946
  error estimate for blocks of size 2^( 5) =       0.000545415299
  error estimate for blocks of size 2^( 6) =       0.000551474578
  error estimate for blocks of size 2^( 7) =       0.000557116170

      target function =      -0.743310874105
              le_mean =     -22.814613841537
             les_mean =     520.959068568376
             stat err =       0.000546770998
             autocorr =       1.367917128951
   target nu stat err =       0.000546770998
   target dn stat err =       0.003619561899
      target stat err =       0.003027747296
              std dev =       0.661135647752
             le_variance =       0.437100344728


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743310666565        initial
     3.7253e+01     3.7253e+02             4.3859e-06        -0.743312134832  <--
     1.4901e+02     1.4901e+03             1.0971e-06        -0.743311763270
     5.9605e+02     5.9605e+03             2.7431e-07        -0.743310874105

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 7.3364e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.272777e-01 3 1  ON 0
ci_02                -2.888236e-02 3 1  ON 1
ci_03                -2.898993e-02 3 1  ON 2
ci_04                 2.691260e-02 3 1  ON 3
ci_05                -2.207601e-02 3 1  ON 4
ci_06                -2.177190e-02 3 1  ON 5
ci_07                 2.739056e-02 3 1  ON 6
ci_08                -5.573272e-03 3 1  ON 7
ci_09                -9.045981e-03 3 1  ON 8
ci_10                -8.352580e-03 3 1  ON 9
ci_11                 1.321795e-02 3 1  ON 10
ci_12                 6.948719e-03 3 1  ON 11
ci_13                 1.283186e-02 3 1  ON 12
ci_14                 1.270845e-02 3 1  ON 13
ci_15                 6.266890e-03 3 1  ON 14
ci_16                 6.427835e-03 3 1  ON 15
ci_17                -7.245537e-03 3 1  ON 16
ci_18                -5.940904e-03 3 1  ON 17
ci_19                 9.299425e-03 3 1  ON 18
ci_20                 6.392807e-03 3 1  ON 19
ci_21                 9.004585e-03 3 1  ON 20
ci_22                 8.265307e-03 3 1  ON 21
ci_23                 4.757431e-03 3 1  ON 22
ci_24                 3.984269e-03 3 1  ON 23
ci_25                 2.848005e-03 3 1  ON 24
ci_26                 3.138329e-03 3 1  ON 25
ci_27                 3.317466e-03 3 1  ON 26
ci_28                 1.932063e-03 3 1  ON 27
ci_29                 1.304810e-03 3 1  ON 28
ci_30                -1.834721e-03 3 1  ON 29
ci_31                -5.569007e-04 3 1  ON 30
ci_32                -8.447716e-04 3 1  ON 31
ci_33                -1.468234e-03 3 1  ON 32
ci_34                 1.139736e-03 3 1  ON 33
ci_35                 1.458254e-03 3 1  ON 34
ci_36                -1.024579e-03 3 1  ON 35
ci_37                -1.032394e-03 3 1  ON 36
ci_38                -7.698644e-04 3 1  ON 37
ci_39                -6.240042e-04 3 1  ON 38
ci_40                -1.564095e-03 3 1  ON 39
ci_41                -1.246668e-03 3 1  ON 40
ci_42                -1.167252e-03 3 1  ON 41
ci_43                -2.482181e-03 3 1  ON 42
ci_44                -3.242054e-03 3 1  ON 43
ci_45                -5.280418e-04 3 1  ON 44
ci_46                -8.686844e-04 3 1  ON 45
ci_47                 1.538254e-03 3 1  ON 46
ci_48                 1.374831e-03 3 1  ON 47
ci_49                -1.040672e-03 3 1  ON 48
ci_50                -8.120281e-04 3 1  ON 49
ci_51                 1.456328e-04 3 1  ON 50
ci_52                 8.248217e-05 3 1  ON 51
ci_53                -6.383733e-04 3 1  ON 52
ci_54                -1.026071e-03 3 1  ON 53
ci_55                -6.524236e-04 3 1  ON 54
ci_56                 2.627355e-03 3 1  ON 55
ci_57                 1.623674e-03 3 1  ON 56
ci_58                -1.115361e-03 3 1  ON 57
ci_59                -1.462493e-03 3 1  ON 58
ci_60                 5.446389e-04 3 1  ON 59
ci_61                -1.282256e-04 3 1  ON 60
ci_62                -6.683029e-04 3 1  ON 61
ci_63                -7.727347e-04 3 1  ON 62
ci_64                -2.615773e-04 3 1  ON 63
ci_65                 6.072468e-05 3 1  ON 64
ci_66                -7.123165e-04 3 1  ON 65
ci_67                -8.970385e-04 3 1  ON 66
ci_68                -1.371539e-03 3 1  ON 67
ci_69                 1.326461e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2506e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8534
    reference variance = 0.328395
====================================================
  Execution time = 4.3762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5121e-01
  Total weights = 1.963956536e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435836592562
                                         uncertainty =       0.003159307806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435836592562
                                         uncertainty =       0.003159307806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466816066
  error estimate for blocks of size 2^( 2) =       0.000492526139
  error estimate for blocks of size 2^( 3) =       0.000516591607
  error estimate for blocks of size 2^( 4) =       0.000534461232
  error estimate for blocks of size 2^( 5) =       0.000546327357
  error estimate for blocks of size 2^( 6) =       0.000552366332
  error estimate for blocks of size 2^( 7) =       0.000556665850

      target function =      -0.744335289368
              le_mean =     -22.814460235822
             les_mean =     520.950807093007
             stat err =       0.000547455192
             autocorr =       1.375325736157
   target nu stat err =       0.000547455192
   target dn stat err =       0.004112344601
      target stat err =       0.003433218214
              std dev =       0.660177611594
             le_variance =       0.435834478850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281446023582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744349955390       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744351896330       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744352134218       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744352185119       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744352201200       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744352201420       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744352202413       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744352203527       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744352203302       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 2.052428e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744349955390       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744350442626       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744350502229       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744350514959       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744350518971       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744350519021       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744350519268       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744350519546       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744350519490       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 5.141585e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744349955390       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744350077325       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744350092234       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744350095417       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744350096419       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744350096431       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744350096493       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744350096562       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744350096548       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.286055e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228506 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1581e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898797e-02 3 1  ON 2
ci_04                 2.690908e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176965e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571474e-03 3 1  ON 7
ci_09                -9.045292e-03 3 1  ON 8
ci_10                -8.352772e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948915e-03 3 1  ON 11
ci_13                 1.283207e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266758e-03 3 1  ON 14
ci_16                 6.426484e-03 3 1  ON 15
ci_17                -7.244575e-03 3 1  ON 16
ci_18                -5.940908e-03 3 1  ON 17
ci_19                 9.299878e-03 3 1  ON 18
ci_20                 6.395028e-03 3 1  ON 19
ci_21                 9.004944e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984861e-03 3 1  ON 23
ci_25                 2.848362e-03 3 1  ON 24
ci_26                 3.136313e-03 3 1  ON 25
ci_27                 3.318398e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306958e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581119e-04 3 1  ON 30
ci_32                -8.464063e-04 3 1  ON 31
ci_33                -1.467128e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456794e-03 3 1  ON 34
ci_36                -1.024437e-03 3 1  ON 35
ci_37                -1.031565e-03 3 1  ON 36
ci_38                -7.685159e-04 3 1  ON 37
ci_39                -6.245880e-04 3 1  ON 38
ci_40                -1.561242e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167542e-03 3 1  ON 41
ci_43                -2.482052e-03 3 1  ON 42
ci_44                -3.239200e-03 3 1  ON 43
ci_45                -5.273520e-04 3 1  ON 44
ci_46                -8.694152e-04 3 1  ON 45
ci_47                 1.538400e-03 3 1  ON 46
ci_48                 1.377193e-03 3 1  ON 47
ci_49                -1.040597e-03 3 1  ON 48
ci_50                -8.119959e-04 3 1  ON 49
ci_51                 1.439370e-04 3 1  ON 50
ci_52                 8.068145e-05 3 1  ON 51
ci_53                -6.382743e-04 3 1  ON 52
ci_54                -1.026837e-03 3 1  ON 53
ci_55                -6.525756e-04 3 1  ON 54
ci_56                 2.626586e-03 3 1  ON 55
ci_57                 1.624709e-03 3 1  ON 56
ci_58                -1.114400e-03 3 1  ON 57
ci_59                -1.466038e-03 3 1  ON 58
ci_60                 5.428998e-04 3 1  ON 59
ci_61                -1.294355e-04 3 1  ON 60
ci_62                -6.662244e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632731e-04 3 1  ON 63
ci_65                 6.160176e-05 3 1  ON 64
ci_66                -7.127489e-04 3 1  ON 65
ci_67                -8.949576e-04 3 1  ON 66
ci_68                -1.372121e-03 3 1  ON 67
ci_69                 1.318227e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8102
    reference variance = 0.273137
====================================================
  Execution time = 4.4813e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4616e-01
  Total weights = 1.9645e+06
  Execution time = 6.0294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433046451494
                                         uncertainty =       0.002214201844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433046451494
                                         uncertainty =       0.002214201844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465343300
  error estimate for blocks of size 2^( 2) =       0.000491459080
  error estimate for blocks of size 2^( 3) =       0.000515455998
  error estimate for blocks of size 2^( 4) =       0.000533233616
  error estimate for blocks of size 2^( 5) =       0.000544800572
  error estimate for blocks of size 2^( 6) =       0.000552017332
  error estimate for blocks of size 2^( 7) =       0.000554486422

      target function =      -0.748516346269
              le_mean =     -22.814791843879
             les_mean =     520.960892884000
             stat err =       0.000546134485
             autocorr =       1.377375234608
   target nu stat err =       0.000546134485
   target dn stat err =       0.002746009586
      target stat err =       0.002362458593
              std dev =       0.658094806494
             le_variance =       0.433088774334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433044641992
                                         uncertainty =       0.002214267796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433044641992
                                         uncertainty =       0.002214267796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465342315
  error estimate for blocks of size 2^( 2) =       0.000491458948
  error estimate for blocks of size 2^( 3) =       0.000515456635
  error estimate for blocks of size 2^( 4) =       0.000533234675
  error estimate for blocks of size 2^( 5) =       0.000544802341
  error estimate for blocks of size 2^( 6) =       0.000552019286
  error estimate for blocks of size 2^( 7) =       0.000554488253

      target function =      -0.748403122378
              le_mean =     -22.814791808866
             les_mean =     520.961027486404
             stat err =       0.000546136139
             autocorr =       1.377389407166
   target nu stat err =       0.000546136139
   target dn stat err =       0.002745375055
      target stat err =       0.002361258087
              std dev =       0.658093413170
             le_variance =       0.433086940458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433045534025
                                         uncertainty =       0.002214234758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433045534025
                                         uncertainty =       0.002214234758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465342801
  error estimate for blocks of size 2^( 2) =       0.000491459009
  error estimate for blocks of size 2^( 3) =       0.000515456316
  error estimate for blocks of size 2^( 4) =       0.000533234150
  error estimate for blocks of size 2^( 5) =       0.000544801459
  error estimate for blocks of size 2^( 6) =       0.000552018307
  error estimate for blocks of size 2^( 7) =       0.000554487348

      target function =      -0.748528761742
              le_mean =     -22.814791822820
             les_mean =     520.960877014246
             stat err =       0.000546135316
             autocorr =       1.377382382041
   target nu stat err =       0.000546135316
   target dn stat err =       0.002742227279
      target stat err =       0.002359495086
              std dev =       0.658094100140
             le_variance =       0.433087844639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433046335630
                                         uncertainty =       0.002214205938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433046335630
                                         uncertainty =       0.002214205938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465343237
  error estimate for blocks of size 2^( 2) =       0.000491459070
  error estimate for blocks of size 2^( 3) =       0.000515456037
  error estimate for blocks of size 2^( 4) =       0.000533233682
  error estimate for blocks of size 2^( 5) =       0.000544800682
  error estimate for blocks of size 2^( 6) =       0.000552017453
  error estimate for blocks of size 2^( 7) =       0.000554486538

      target function =      -0.748518553108
              le_mean =     -22.814791841111
             les_mean =     520.960890106644
             stat err =       0.000546134589
             autocorr =       1.377376130320
   target nu stat err =       0.000546134589
   target dn stat err =       0.002745500321
      target stat err =       0.002362062834
              std dev =       0.658094717300
             le_variance =       0.433088656939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748516346269        initial
     9.3132e+00     9.3132e+01             2.0524e-05        -0.748403122378
     3.7253e+01     3.7253e+02             5.1416e-06        -0.748528761742  <--
     1.4901e+02     1.4901e+03             1.2861e-06        -0.748518553108

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 7.4958e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898797e-02 3 1  ON 2
ci_04                 2.690908e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176965e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571474e-03 3 1  ON 7
ci_09                -9.045292e-03 3 1  ON 8
ci_10                -8.352772e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948915e-03 3 1  ON 11
ci_13                 1.283207e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266758e-03 3 1  ON 14
ci_16                 6.426484e-03 3 1  ON 15
ci_17                -7.244575e-03 3 1  ON 16
ci_18                -5.940908e-03 3 1  ON 17
ci_19                 9.299878e-03 3 1  ON 18
ci_20                 6.395028e-03 3 1  ON 19
ci_21                 9.004944e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984861e-03 3 1  ON 23
ci_25                 2.848362e-03 3 1  ON 24
ci_26                 3.136313e-03 3 1  ON 25
ci_27                 3.318398e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306958e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581119e-04 3 1  ON 30
ci_32                -8.464063e-04 3 1  ON 31
ci_33                -1.467128e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456794e-03 3 1  ON 34
ci_36                -1.024437e-03 3 1  ON 35
ci_37                -1.031565e-03 3 1  ON 36
ci_38                -7.685159e-04 3 1  ON 37
ci_39                -6.245880e-04 3 1  ON 38
ci_40                -1.561242e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167542e-03 3 1  ON 41
ci_43                -2.482052e-03 3 1  ON 42
ci_44                -3.239200e-03 3 1  ON 43
ci_45                -5.273520e-04 3 1  ON 44
ci_46                -8.694152e-04 3 1  ON 45
ci_47                 1.538400e-03 3 1  ON 46
ci_48                 1.377193e-03 3 1  ON 47
ci_49                -1.040597e-03 3 1  ON 48
ci_50                -8.119959e-04 3 1  ON 49
ci_51                 1.439370e-04 3 1  ON 50
ci_52                 8.068145e-05 3 1  ON 51
ci_53                -6.382743e-04 3 1  ON 52
ci_54                -1.026837e-03 3 1  ON 53
ci_55                -6.525756e-04 3 1  ON 54
ci_56                 2.626586e-03 3 1  ON 55
ci_57                 1.624709e-03 3 1  ON 56
ci_58                -1.114400e-03 3 1  ON 57
ci_59                -1.466038e-03 3 1  ON 58
ci_60                 5.428998e-04 3 1  ON 59
ci_61                -1.294355e-04 3 1  ON 60
ci_62                -6.662244e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632731e-04 3 1  ON 63
ci_65                 6.160176e-05 3 1  ON 64
ci_66                -7.127489e-04 3 1  ON 65
ci_67                -8.949576e-04 3 1  ON 66
ci_68                -1.372121e-03 3 1  ON 67
ci_69                 1.318227e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2657e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8786
    reference variance = 0.416141
====================================================
  Execution time = 4.4358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5447e-01
  Total weights = 1.964214078e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437109385385
                                         uncertainty =       0.002116847756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437109385385
                                         uncertainty =       0.002116847756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467449917
  error estimate for blocks of size 2^( 2) =       0.000493508779
  error estimate for blocks of size 2^( 3) =       0.000516908524
  error estimate for blocks of size 2^( 4) =       0.000534805261
  error estimate for blocks of size 2^( 5) =       0.000546550373
  error estimate for blocks of size 2^( 6) =       0.000551971633
  error estimate for blocks of size 2^( 7) =       0.000558508162

      target function =      -0.741671259670
              le_mean =     -22.814710235522
             les_mean =     520.965471367421
             stat err =       0.000547958857
             autocorr =       1.374123380761
   target nu stat err =       0.000547958857
   target dn stat err =       0.003651805544
      target stat err =       0.003041153620
              std dev =       0.661074011996
             le_variance =       0.437018849336


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281471023552e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741682800772       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741684075138       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741684284152       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741684364392       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741684384375       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741684386543       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741684391140       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741684391351       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741684391146       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 2.273994e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741682800772       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741683120693       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741683173077       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741683193156       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741683198131       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741683198680       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741683199825       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741683199869       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741683199819       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 5.696727e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741682800772       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741682880836       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741682893940       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741682898961       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741682900204       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741682900341       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741682900627       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741682900638       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741682900625       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.424918e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235999 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1938e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.272669e-01 3 1  ON 0
ci_02                -2.887915e-02 3 1  ON 1
ci_03                -2.898771e-02 3 1  ON 2
ci_04                 2.690730e-02 3 1  ON 3
ci_05                -2.207576e-02 3 1  ON 4
ci_06                -2.176869e-02 3 1  ON 5
ci_07                 2.738683e-02 3 1  ON 6
ci_08                -5.571911e-03 3 1  ON 7
ci_09                -9.043894e-03 3 1  ON 8
ci_10                -8.351483e-03 3 1  ON 9
ci_11                 1.321742e-02 3 1  ON 10
ci_12                 6.947744e-03 3 1  ON 11
ci_13                 1.283127e-02 3 1  ON 12
ci_14                 1.270917e-02 3 1  ON 13
ci_15                 6.266862e-03 3 1  ON 14
ci_16                 6.425716e-03 3 1  ON 15
ci_17                -7.242129e-03 3 1  ON 16
ci_18                -5.939645e-03 3 1  ON 17
ci_19                 9.302161e-03 3 1  ON 18
ci_20                 6.393924e-03 3 1  ON 19
ci_21                 9.004258e-03 3 1  ON 20
ci_22                 8.265701e-03 3 1  ON 21
ci_23                 4.757739e-03 3 1  ON 22
ci_24                 3.984964e-03 3 1  ON 23
ci_25                 2.848850e-03 3 1  ON 24
ci_26                 3.134995e-03 3 1  ON 25
ci_27                 3.317942e-03 3 1  ON 26
ci_28                 1.932227e-03 3 1  ON 27
ci_29                 1.307331e-03 3 1  ON 28
ci_30                -1.833528e-03 3 1  ON 29
ci_31                -5.602033e-04 3 1  ON 30
ci_32                -8.490643e-04 3 1  ON 31
ci_33                -1.466773e-03 3 1  ON 32
ci_34                 1.139362e-03 3 1  ON 33
ci_35                 1.457891e-03 3 1  ON 34
ci_36                -1.024832e-03 3 1  ON 35
ci_37                -1.032519e-03 3 1  ON 36
ci_38                -7.685468e-04 3 1  ON 37
ci_39                -6.261076e-04 3 1  ON 38
ci_40                -1.561316e-03 3 1  ON 39
ci_41                -1.248160e-03 3 1  ON 40
ci_42                -1.166465e-03 3 1  ON 41
ci_43                -2.485054e-03 3 1  ON 42
ci_44                -3.238745e-03 3 1  ON 43
ci_45                -5.267975e-04 3 1  ON 44
ci_46                -8.696270e-04 3 1  ON 45
ci_47                 1.539203e-03 3 1  ON 46
ci_48                 1.375989e-03 3 1  ON 47
ci_49                -1.041170e-03 3 1  ON 48
ci_50                -8.108344e-04 3 1  ON 49
ci_51                 1.438527e-04 3 1  ON 50
ci_52                 8.105595e-05 3 1  ON 51
ci_53                -6.392263e-04 3 1  ON 52
ci_54                -1.025580e-03 3 1  ON 53
ci_55                -6.530206e-04 3 1  ON 54
ci_56                 2.626588e-03 3 1  ON 55
ci_57                 1.625176e-03 3 1  ON 56
ci_58                -1.114929e-03 3 1  ON 57
ci_59                -1.463919e-03 3 1  ON 58
ci_60                 5.423738e-04 3 1  ON 59
ci_61                -1.299062e-04 3 1  ON 60
ci_62                -6.667759e-04 3 1  ON 61
ci_63                -7.745895e-04 3 1  ON 62
ci_64                -2.627949e-04 3 1  ON 63
ci_65                 6.179071e-05 3 1  ON 64
ci_66                -7.137331e-04 3 1  ON 65
ci_67                -8.944371e-04 3 1  ON 66
ci_68                -1.370602e-03 3 1  ON 67
ci_69                 1.320173e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8708
    reference variance = 0.317897
====================================================
  Execution time = 4.1742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4818e-01
  Total weights = 1.9643e+06
  Execution time = 5.8924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436230299450
                                         uncertainty =       0.001770188739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436230299450
                                         uncertainty =       0.001770188739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466997841
  error estimate for blocks of size 2^( 2) =       0.000492383757
  error estimate for blocks of size 2^( 3) =       0.000516299459
  error estimate for blocks of size 2^( 4) =       0.000534040215
  error estimate for blocks of size 2^( 5) =       0.000545007603
  error estimate for blocks of size 2^( 6) =       0.000550035420
  error estimate for blocks of size 2^( 7) =       0.000554713882

      target function =      -0.746840411034
              le_mean =     -22.813898502156
             les_mean =     520.922143248895
             stat err =       0.000545949280
             autocorr =       1.366705207995
   target nu stat err =       0.000545949280
   target dn stat err =       0.002622185493
      target stat err =       0.002250309237
              std dev =       0.660434680796
             le_variance =       0.436173967598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436228197652
                                         uncertainty =       0.001770413432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436228197652
                                         uncertainty =       0.001770413432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466996706
  error estimate for blocks of size 2^( 2) =       0.000492383128
  error estimate for blocks of size 2^( 3) =       0.000516299334
  error estimate for blocks of size 2^( 4) =       0.000534040420
  error estimate for blocks of size 2^( 5) =       0.000545007810
  error estimate for blocks of size 2^( 6) =       0.000550035661
  error estimate for blocks of size 2^( 7) =       0.000554713643

      target function =      -0.746837638789
              le_mean =     -22.813898441621
             les_mean =     520.922143830079
             stat err =       0.000545949384
             autocorr =       1.366712370115
   target nu stat err =       0.000545949384
   target dn stat err =       0.002623864784
      target stat err =       0.002251630217
              std dev =       0.660433075289
             le_variance =       0.436171846936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436229240346
                                         uncertainty =       0.001770301232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436229240346
                                         uncertainty =       0.001770301232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466997269
  error estimate for blocks of size 2^( 2) =       0.000492383439
  error estimate for blocks of size 2^( 3) =       0.000516299393
  error estimate for blocks of size 2^( 4) =       0.000534040315
  error estimate for blocks of size 2^( 5) =       0.000545007704
  error estimate for blocks of size 2^( 6) =       0.000550035538
  error estimate for blocks of size 2^( 7) =       0.000554713759

      target function =      -0.746839187444
              le_mean =     -22.813898471217
             les_mean =     520.922143312234
             stat err =       0.000545949329
             autocorr =       1.366708802377
   target nu stat err =       0.000545949329
   target dn stat err =       0.002623024178
      target stat err =       0.002250969898
              std dev =       0.660433871801
             le_variance =       0.436172899022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436230166415
                                         uncertainty =       0.001770202791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436230166415
                                         uncertainty =       0.001770202791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466997769
  error estimate for blocks of size 2^( 2) =       0.000492383717
  error estimate for blocks of size 2^( 3) =       0.000516299450
  error estimate for blocks of size 2^( 4) =       0.000534040227
  error estimate for blocks of size 2^( 5) =       0.000545007616
  error estimate for blocks of size 2^( 6) =       0.000550035435
  error estimate for blocks of size 2^( 7) =       0.000554713867

      target function =      -0.746840277725
              le_mean =     -22.813898498222
             les_mean =     520.922143230015
             stat err =       0.000545949286
             autocorr =       1.366705657897
   target nu stat err =       0.000545949286
   target dn stat err =       0.002622289961
      target stat err =       0.002250391640
              std dev =       0.660434579180
             le_variance =       0.436173833377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746840411034        initial  <--
     9.3132e+00     9.3132e+01             2.2740e-05        -0.746837638789
     3.7253e+01     3.7253e+02             5.6967e-06        -0.746839187444
     1.4901e+02     1.4901e+03             1.4249e-06        -0.746840277725

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.4946
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898797e-02 3 1  ON 2
ci_04                 2.690908e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176965e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571474e-03 3 1  ON 7
ci_09                -9.045292e-03 3 1  ON 8
ci_10                -8.352772e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948915e-03 3 1  ON 11
ci_13                 1.283207e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266758e-03 3 1  ON 14
ci_16                 6.426484e-03 3 1  ON 15
ci_17                -7.244575e-03 3 1  ON 16
ci_18                -5.940908e-03 3 1  ON 17
ci_19                 9.299878e-03 3 1  ON 18
ci_20                 6.395028e-03 3 1  ON 19
ci_21                 9.004944e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984861e-03 3 1  ON 23
ci_25                 2.848362e-03 3 1  ON 24
ci_26                 3.136313e-03 3 1  ON 25
ci_27                 3.318398e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306958e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581119e-04 3 1  ON 30
ci_32                -8.464063e-04 3 1  ON 31
ci_33                -1.467128e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456794e-03 3 1  ON 34
ci_36                -1.024437e-03 3 1  ON 35
ci_37                -1.031565e-03 3 1  ON 36
ci_38                -7.685159e-04 3 1  ON 37
ci_39                -6.245880e-04 3 1  ON 38
ci_40                -1.561242e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167542e-03 3 1  ON 41
ci_43                -2.482052e-03 3 1  ON 42
ci_44                -3.239200e-03 3 1  ON 43
ci_45                -5.273520e-04 3 1  ON 44
ci_46                -8.694152e-04 3 1  ON 45
ci_47                 1.538400e-03 3 1  ON 46
ci_48                 1.377193e-03 3 1  ON 47
ci_49                -1.040597e-03 3 1  ON 48
ci_50                -8.119959e-04 3 1  ON 49
ci_51                 1.439370e-04 3 1  ON 50
ci_52                 8.068145e-05 3 1  ON 51
ci_53                -6.382743e-04 3 1  ON 52
ci_54                -1.026837e-03 3 1  ON 53
ci_55                -6.525756e-04 3 1  ON 54
ci_56                 2.626586e-03 3 1  ON 55
ci_57                 1.624709e-03 3 1  ON 56
ci_58                -1.114400e-03 3 1  ON 57
ci_59                -1.466038e-03 3 1  ON 58
ci_60                 5.428998e-04 3 1  ON 59
ci_61                -1.294355e-04 3 1  ON 60
ci_62                -6.662244e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632731e-04 3 1  ON 63
ci_65                 6.160176e-05 3 1  ON 64
ci_66                -7.127489e-04 3 1  ON 65
ci_67                -8.949576e-04 3 1  ON 66
ci_68                -1.372121e-03 3 1  ON 67
ci_69                 1.318227e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2445e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7099
    reference variance = 0.411289
====================================================
  Execution time = 4.2973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4227e-01
  Total weights = 1.964238796e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429772629304
                                         uncertainty =       0.001613240132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429772629304
                                         uncertainty =       0.001613240132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463527828
  error estimate for blocks of size 2^( 2) =       0.000489274417
  error estimate for blocks of size 2^( 3) =       0.000512826293
  error estimate for blocks of size 2^( 4) =       0.000530875166
  error estimate for blocks of size 2^( 5) =       0.000541588571
  error estimate for blocks of size 2^( 6) =       0.000548192209
  error estimate for blocks of size 2^( 7) =       0.000551836926

      target function =      -0.751764130477
              le_mean =     -22.814052857358
             les_mean =     520.923274293046
             stat err =       0.000543123218
             autocorr =       1.372919623461
   target nu stat err =       0.000543123218
   target dn stat err =       0.002173365377
      target stat err =       0.001918776320
              std dev =       0.655527341301
             le_variance =       0.429716095194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281405285736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751768012257       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751768095002       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751768103575       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751768104205       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751768104347       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751768104511       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751768104461       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751768104289       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751768104336       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 1.117027e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751768012257       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751768032952       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751768035095       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751768035253       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751768035288       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751768035329       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751768035317       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751768035273       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751768035286       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 2.793181e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751768012257       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751768017431       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751768017967       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751768018005       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751768018016       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751768018028       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751768018023       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751768018012       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751768018015       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 6.983335e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0610e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.272723e-01 3 1  ON 0
ci_02                -2.888005e-02 3 1  ON 1
ci_03                -2.898781e-02 3 1  ON 2
ci_04                 2.690906e-02 3 1  ON 3
ci_05                -2.207707e-02 3 1  ON 4
ci_06                -2.176969e-02 3 1  ON 5
ci_07                 2.738802e-02 3 1  ON 6
ci_08                -5.571359e-03 3 1  ON 7
ci_09                -9.045023e-03 3 1  ON 8
ci_10                -8.352898e-03 3 1  ON 9
ci_11                 1.321819e-02 3 1  ON 10
ci_12                 6.948889e-03 3 1  ON 11
ci_13                 1.283202e-02 3 1  ON 12
ci_14                 1.270891e-02 3 1  ON 13
ci_15                 6.266742e-03 3 1  ON 14
ci_16                 6.426523e-03 3 1  ON 15
ci_17                -7.244354e-03 3 1  ON 16
ci_18                -5.941051e-03 3 1  ON 17
ci_19                 9.299880e-03 3 1  ON 18
ci_20                 6.394979e-03 3 1  ON 19
ci_21                 9.004827e-03 3 1  ON 20
ci_22                 8.265993e-03 3 1  ON 21
ci_23                 4.757300e-03 3 1  ON 22
ci_24                 3.984632e-03 3 1  ON 23
ci_25                 2.848417e-03 3 1  ON 24
ci_26                 3.136365e-03 3 1  ON 25
ci_27                 3.318523e-03 3 1  ON 26
ci_28                 1.933006e-03 3 1  ON 27
ci_29                 1.307079e-03 3 1  ON 28
ci_30                -1.833516e-03 3 1  ON 29
ci_31                -5.582450e-04 3 1  ON 30
ci_32                -8.463688e-04 3 1  ON 31
ci_33                -1.467024e-03 3 1  ON 32
ci_34                 1.138074e-03 3 1  ON 33
ci_35                 1.456950e-03 3 1  ON 34
ci_36                -1.024463e-03 3 1  ON 35
ci_37                -1.031532e-03 3 1  ON 36
ci_38                -7.684072e-04 3 1  ON 37
ci_39                -6.245804e-04 3 1  ON 38
ci_40                -1.561213e-03 3 1  ON 39
ci_41                -1.248508e-03 3 1  ON 40
ci_42                -1.167492e-03 3 1  ON 41
ci_43                -2.481978e-03 3 1  ON 42
ci_44                -3.239133e-03 3 1  ON 43
ci_45                -5.273586e-04 3 1  ON 44
ci_46                -8.693200e-04 3 1  ON 45
ci_47                 1.538330e-03 3 1  ON 46
ci_48                 1.377139e-03 3 1  ON 47
ci_49                -1.040533e-03 3 1  ON 48
ci_50                -8.119871e-04 3 1  ON 49
ci_51                 1.439585e-04 3 1  ON 50
ci_52                 8.067066e-05 3 1  ON 51
ci_53                -6.382778e-04 3 1  ON 52
ci_54                -1.026853e-03 3 1  ON 53
ci_55                -6.527262e-04 3 1  ON 54
ci_56                 2.626579e-03 3 1  ON 55
ci_57                 1.624730e-03 3 1  ON 56
ci_58                -1.114394e-03 3 1  ON 57
ci_59                -1.465832e-03 3 1  ON 58
ci_60                 5.428944e-04 3 1  ON 59
ci_61                -1.294178e-04 3 1  ON 60
ci_62                -6.661198e-04 3 1  ON 61
ci_63                -7.727830e-04 3 1  ON 62
ci_64                -2.633746e-04 3 1  ON 63
ci_65                 6.173651e-05 3 1  ON 64
ci_66                -7.126199e-04 3 1  ON 65
ci_67                -8.948452e-04 3 1  ON 66
ci_68                -1.372099e-03 3 1  ON 67
ci_69                 1.317097e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.826
    reference variance = 0.419536
====================================================
  Execution time = 4.1647e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5413e-01
  Total weights = 1.9642e+06
  Execution time = 5.9176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437884577054
                                         uncertainty =       0.002452276246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437884577054
                                         uncertainty =       0.002452276246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467867906
  error estimate for blocks of size 2^( 2) =       0.000492923156
  error estimate for blocks of size 2^( 3) =       0.000516777067
  error estimate for blocks of size 2^( 4) =       0.000535083310
  error estimate for blocks of size 2^( 5) =       0.000546859939
  error estimate for blocks of size 2^( 6) =       0.000553896758
  error estimate for blocks of size 2^( 7) =       0.000555684193

      target function =      -0.741935294848
              le_mean =     -22.814485118731
             les_mean =     520.954862584990
             stat err =       0.000547881050
             autocorr =       1.371279707024
   target nu stat err =       0.000547881050
   target dn stat err =       0.005076622260
      target stat err =       0.004189012645
              std dev =       0.661665137771
             le_variance =       0.437800754542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437884200420
                                         uncertainty =       0.002452070658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437884200420
                                         uncertainty =       0.002452070658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467867705
  error estimate for blocks of size 2^( 2) =       0.000492922995
  error estimate for blocks of size 2^( 3) =       0.000516776941
  error estimate for blocks of size 2^( 4) =       0.000535083212
  error estimate for blocks of size 2^( 5) =       0.000546859825
  error estimate for blocks of size 2^( 6) =       0.000553896666
  error estimate for blocks of size 2^( 7) =       0.000555684066

      target function =      -0.741930881083
              le_mean =     -22.814485115357
             les_mean =     520.954867826210
             stat err =       0.000547880942
             autocorr =       1.371280341343
   target nu stat err =       0.000547880942
   target dn stat err =       0.005077558891
      target stat err =       0.004189720175
              std dev =       0.661664854431
             le_variance =       0.437800379589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437884388602
                                         uncertainty =       0.002452173401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437884388602
                                         uncertainty =       0.002452173401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467867806
  error estimate for blocks of size 2^( 2) =       0.000492923076
  error estimate for blocks of size 2^( 3) =       0.000516777004
  error estimate for blocks of size 2^( 4) =       0.000535083261
  error estimate for blocks of size 2^( 5) =       0.000546859882
  error estimate for blocks of size 2^( 6) =       0.000553896712
  error estimate for blocks of size 2^( 7) =       0.000555684129

      target function =      -0.741933133194
              le_mean =     -22.814485117043
             les_mean =     520.954865150186
             stat err =       0.000547880996
             autocorr =       1.371280024318
   target nu stat err =       0.000547880996
   target dn stat err =       0.005077089129
      target stat err =       0.004189365748
              std dev =       0.661664995999
             le_variance =       0.437800566930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437884553488
                                         uncertainty =       0.002452263388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437884553488
                                         uncertainty =       0.002452263388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467867893
  error estimate for blocks of size 2^( 2) =       0.000492923146
  error estimate for blocks of size 2^( 3) =       0.000516777059
  error estimate for blocks of size 2^( 4) =       0.000535083304
  error estimate for blocks of size 2^( 5) =       0.000546859932
  error estimate for blocks of size 2^( 6) =       0.000553896753
  error estimate for blocks of size 2^( 7) =       0.000555684185

      target function =      -0.741935028101
              le_mean =     -22.814485118520
             les_mean =     520.954862901397
             stat err =       0.000547881043
             autocorr =       1.371279746696
   target nu stat err =       0.000547881043
   target dn stat err =       0.005076680452
      target stat err =       0.004189056686
              std dev =       0.661665120043
             le_variance =       0.437800731081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741935294848        initial  <--
     9.3132e+01     9.3132e+02             1.1170e-06        -0.741930881083
     3.7253e+02     3.7253e+03             2.7932e-07        -0.741933133194
     1.4901e+03     1.4901e+04             6.9833e-08        -0.741935028101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.3014
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898797e-02 3 1  ON 2
ci_04                 2.690908e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176965e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571474e-03 3 1  ON 7
ci_09                -9.045292e-03 3 1  ON 8
ci_10                -8.352772e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948915e-03 3 1  ON 11
ci_13                 1.283207e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266758e-03 3 1  ON 14
ci_16                 6.426484e-03 3 1  ON 15
ci_17                -7.244575e-03 3 1  ON 16
ci_18                -5.940908e-03 3 1  ON 17
ci_19                 9.299878e-03 3 1  ON 18
ci_20                 6.395028e-03 3 1  ON 19
ci_21                 9.004944e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984861e-03 3 1  ON 23
ci_25                 2.848362e-03 3 1  ON 24
ci_26                 3.136313e-03 3 1  ON 25
ci_27                 3.318398e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306958e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581119e-04 3 1  ON 30
ci_32                -8.464063e-04 3 1  ON 31
ci_33                -1.467128e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456794e-03 3 1  ON 34
ci_36                -1.024437e-03 3 1  ON 35
ci_37                -1.031565e-03 3 1  ON 36
ci_38                -7.685159e-04 3 1  ON 37
ci_39                -6.245880e-04 3 1  ON 38
ci_40                -1.561242e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167542e-03 3 1  ON 41
ci_43                -2.482052e-03 3 1  ON 42
ci_44                -3.239200e-03 3 1  ON 43
ci_45                -5.273520e-04 3 1  ON 44
ci_46                -8.694152e-04 3 1  ON 45
ci_47                 1.538400e-03 3 1  ON 46
ci_48                 1.377193e-03 3 1  ON 47
ci_49                -1.040597e-03 3 1  ON 48
ci_50                -8.119959e-04 3 1  ON 49
ci_51                 1.439370e-04 3 1  ON 50
ci_52                 8.068145e-05 3 1  ON 51
ci_53                -6.382743e-04 3 1  ON 52
ci_54                -1.026837e-03 3 1  ON 53
ci_55                -6.525756e-04 3 1  ON 54
ci_56                 2.626586e-03 3 1  ON 55
ci_57                 1.624709e-03 3 1  ON 56
ci_58                -1.114400e-03 3 1  ON 57
ci_59                -1.466038e-03 3 1  ON 58
ci_60                 5.428998e-04 3 1  ON 59
ci_61                -1.294355e-04 3 1  ON 60
ci_62                -6.662244e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632731e-04 3 1  ON 63
ci_65                 6.160176e-05 3 1  ON 64
ci_66                -7.127489e-04 3 1  ON 65
ci_67                -8.949576e-04 3 1  ON 66
ci_68                -1.372121e-03 3 1  ON 67
ci_69                 1.318227e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2210e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8352
    reference variance = 0.443529
====================================================
  Execution time = 4.5252e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5118e-01
  Total weights = 1.964102496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437309930006
                                         uncertainty =       0.002618512362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437309930006
                                         uncertainty =       0.002618512362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467632564
  error estimate for blocks of size 2^( 2) =       0.000493201075
  error estimate for blocks of size 2^( 3) =       0.000517283809
  error estimate for blocks of size 2^( 4) =       0.000534577735
  error estimate for blocks of size 2^( 5) =       0.000545979950
  error estimate for blocks of size 2^( 6) =       0.000552216401
  error estimate for blocks of size 2^( 7) =       0.000555236341

      target function =      -0.744361417121
              le_mean =     -22.814022026317
             les_mean =     520.930782193874
             stat err =       0.000547002607
             autocorr =       1.368262105453
   target nu stat err =       0.000547002607
   target dn stat err =       0.003610480710
      target stat err =       0.003026219413
              std dev =       0.661332314730
             le_variance =       0.437360430506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281402202632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744372730959       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744372746042       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744372747956       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744372748190       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744372748250       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744372748247       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744372748237       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744372748235       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744372748235       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 1.365401e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744372730959       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744372734730       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744372735208       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744372735267       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744372735287       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744372735281       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744372735276       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744372735272       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744372735273       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 3.413627e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744372730959       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744372731902       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744372732021       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744372732036       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744372732040       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744372732018       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744372732064       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744372732023       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744372732019       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 8.534144e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246588 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2942e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888018e-02 3 1  ON 1
ci_03                -2.898793e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176964e-02 3 1  ON 5
ci_07                 2.738808e-02 3 1  ON 6
ci_08                -5.571466e-03 3 1  ON 7
ci_09                -9.045260e-03 3 1  ON 8
ci_10                -8.352766e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948921e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270875e-02 3 1  ON 13
ci_15                 6.266752e-03 3 1  ON 14
ci_16                 6.426483e-03 3 1  ON 15
ci_17                -7.244584e-03 3 1  ON 16
ci_18                -5.940923e-03 3 1  ON 17
ci_19                 9.299873e-03 3 1  ON 18
ci_20                 6.395029e-03 3 1  ON 19
ci_21                 9.004941e-03 3 1  ON 20
ci_22                 8.265978e-03 3 1  ON 21
ci_23                 4.757146e-03 3 1  ON 22
ci_24                 3.984864e-03 3 1  ON 23
ci_25                 2.848357e-03 3 1  ON 24
ci_26                 3.136343e-03 3 1  ON 25
ci_27                 3.318409e-03 3 1  ON 26
ci_28                 1.933042e-03 3 1  ON 27
ci_29                 1.306965e-03 3 1  ON 28
ci_30                -1.833663e-03 3 1  ON 29
ci_31                -5.581188e-04 3 1  ON 30
ci_32                -8.463957e-04 3 1  ON 31
ci_33                -1.467109e-03 3 1  ON 32
ci_34                 1.137992e-03 3 1  ON 33
ci_35                 1.456793e-03 3 1  ON 34
ci_36                -1.024440e-03 3 1  ON 35
ci_37                -1.031568e-03 3 1  ON 36
ci_38                -7.685029e-04 3 1  ON 37
ci_39                -6.245877e-04 3 1  ON 38
ci_40                -1.561241e-03 3 1  ON 39
ci_41                -1.248549e-03 3 1  ON 40
ci_42                -1.167538e-03 3 1  ON 41
ci_43                -2.482021e-03 3 1  ON 42
ci_44                -3.239190e-03 3 1  ON 43
ci_45                -5.273507e-04 3 1  ON 44
ci_46                -8.694099e-04 3 1  ON 45
ci_47                 1.538400e-03 3 1  ON 46
ci_48                 1.377189e-03 3 1  ON 47
ci_49                -1.040592e-03 3 1  ON 48
ci_50                -8.119929e-04 3 1  ON 49
ci_51                 1.439311e-04 3 1  ON 50
ci_52                 8.067848e-05 3 1  ON 51
ci_53                -6.382778e-04 3 1  ON 52
ci_54                -1.026838e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626578e-03 3 1  ON 55
ci_57                 1.624723e-03 3 1  ON 56
ci_58                -1.114417e-03 3 1  ON 57
ci_59                -1.466035e-03 3 1  ON 58
ci_60                 5.428967e-04 3 1  ON 59
ci_61                -1.294383e-04 3 1  ON 60
ci_62                -6.662241e-04 3 1  ON 61
ci_63                -7.728302e-04 3 1  ON 62
ci_64                -2.632770e-04 3 1  ON 63
ci_65                 6.160550e-05 3 1  ON 64
ci_66                -7.127398e-04 3 1  ON 65
ci_67                -8.949556e-04 3 1  ON 66
ci_68                -1.372104e-03 3 1  ON 67
ci_69                 1.318062e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7798
    reference variance = 0.352115
====================================================
  Execution time = 4.1689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4850e-01
  Total weights = 1.9643e+06
  Execution time = 5.9562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436378942441
                                         uncertainty =       0.002556903981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436378942441
                                         uncertainty =       0.002556903981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467114624
  error estimate for blocks of size 2^( 2) =       0.000492511164
  error estimate for blocks of size 2^( 3) =       0.000516394993
  error estimate for blocks of size 2^( 4) =       0.000533597563
  error estimate for blocks of size 2^( 5) =       0.000544133945
  error estimate for blocks of size 2^( 6) =       0.000550695910
  error estimate for blocks of size 2^( 7) =       0.000555521092

      target function =      -0.746565344988
              le_mean =     -22.813698041723
             les_mean =     520.913322305225
             stat err =       0.000545987127
             autocorr =       1.366211321069
   target nu stat err =       0.000545987127
   target dn stat err =       0.003412239962
      target stat err =       0.002881852724
              std dev =       0.660599835795
             le_variance =       0.436392143053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436379246867
                                         uncertainty =       0.002557121634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436379246867
                                         uncertainty =       0.002557121634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467114786
  error estimate for blocks of size 2^( 2) =       0.000492511325
  error estimate for blocks of size 2^( 3) =       0.000516395152
  error estimate for blocks of size 2^( 4) =       0.000533597723
  error estimate for blocks of size 2^( 5) =       0.000544134108
  error estimate for blocks of size 2^( 6) =       0.000550696087
  error estimate for blocks of size 2^( 7) =       0.000555521270

      target function =      -0.746564902289
              le_mean =     -22.813698038090
             les_mean =     520.913322673975
             stat err =       0.000545987297
             autocorr =       1.366211220725
   target nu stat err =       0.000545987297
   target dn stat err =       0.003412448993
      target stat err =       0.002882018196
              std dev =       0.660600065555
             le_variance =       0.436392446611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436379094648
                                         uncertainty =       0.002557012802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436379094648
                                         uncertainty =       0.002557012802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467114705
  error estimate for blocks of size 2^( 2) =       0.000492511244
  error estimate for blocks of size 2^( 3) =       0.000516395073
  error estimate for blocks of size 2^( 4) =       0.000533597643
  error estimate for blocks of size 2^( 5) =       0.000544134026
  error estimate for blocks of size 2^( 6) =       0.000550695998
  error estimate for blocks of size 2^( 7) =       0.000555521181

      target function =      -0.746565123946
              le_mean =     -22.813698039906
             les_mean =     520.913322489224
             stat err =       0.000545987212
             autocorr =       1.366211270900
   target nu stat err =       0.000545987212
   target dn stat err =       0.003412344472
      target stat err =       0.002881935458
              std dev =       0.660599950671
             le_variance =       0.436392294826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436378961466
                                         uncertainty =       0.002556917583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436378961466
                                         uncertainty =       0.002556917583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467114634
  error estimate for blocks of size 2^( 2) =       0.000492511174
  error estimate for blocks of size 2^( 3) =       0.000516395003
  error estimate for blocks of size 2^( 4) =       0.000533597573
  error estimate for blocks of size 2^( 5) =       0.000544133955
  error estimate for blocks of size 2^( 6) =       0.000550695921
  error estimate for blocks of size 2^( 7) =       0.000555521103

      target function =      -0.746565317393
              le_mean =     -22.813698041496
             les_mean =     520.913322328182
             stat err =       0.000545987138
             autocorr =       1.366211314798
   target nu stat err =       0.000545987138
   target dn stat err =       0.003412253025
      target stat err =       0.002881863065
              std dev =       0.660599850154
             le_variance =       0.436392162024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746565344988        initial  <--
     9.3132e+02     9.3132e+03             1.3654e-07        -0.746564902289
     3.7253e+03     3.7253e+04             3.4136e-08        -0.746565123946
     1.4901e+04     1.4901e+05             8.5341e-09        -0.746565317393

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.5649
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898797e-02 3 1  ON 2
ci_04                 2.690908e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176965e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571474e-03 3 1  ON 7
ci_09                -9.045292e-03 3 1  ON 8
ci_10                -8.352772e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948915e-03 3 1  ON 11
ci_13                 1.283207e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266758e-03 3 1  ON 14
ci_16                 6.426484e-03 3 1  ON 15
ci_17                -7.244575e-03 3 1  ON 16
ci_18                -5.940908e-03 3 1  ON 17
ci_19                 9.299878e-03 3 1  ON 18
ci_20                 6.395028e-03 3 1  ON 19
ci_21                 9.004944e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984861e-03 3 1  ON 23
ci_25                 2.848362e-03 3 1  ON 24
ci_26                 3.136313e-03 3 1  ON 25
ci_27                 3.318398e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306958e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581119e-04 3 1  ON 30
ci_32                -8.464063e-04 3 1  ON 31
ci_33                -1.467128e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456794e-03 3 1  ON 34
ci_36                -1.024437e-03 3 1  ON 35
ci_37                -1.031565e-03 3 1  ON 36
ci_38                -7.685159e-04 3 1  ON 37
ci_39                -6.245880e-04 3 1  ON 38
ci_40                -1.561242e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167542e-03 3 1  ON 41
ci_43                -2.482052e-03 3 1  ON 42
ci_44                -3.239200e-03 3 1  ON 43
ci_45                -5.273520e-04 3 1  ON 44
ci_46                -8.694152e-04 3 1  ON 45
ci_47                 1.538400e-03 3 1  ON 46
ci_48                 1.377193e-03 3 1  ON 47
ci_49                -1.040597e-03 3 1  ON 48
ci_50                -8.119959e-04 3 1  ON 49
ci_51                 1.439370e-04 3 1  ON 50
ci_52                 8.068145e-05 3 1  ON 51
ci_53                -6.382743e-04 3 1  ON 52
ci_54                -1.026837e-03 3 1  ON 53
ci_55                -6.525756e-04 3 1  ON 54
ci_56                 2.626586e-03 3 1  ON 55
ci_57                 1.624709e-03 3 1  ON 56
ci_58                -1.114400e-03 3 1  ON 57
ci_59                -1.466038e-03 3 1  ON 58
ci_60                 5.428998e-04 3 1  ON 59
ci_61                -1.294355e-04 3 1  ON 60
ci_62                -6.662244e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632731e-04 3 1  ON 63
ci_65                 6.160176e-05 3 1  ON 64
ci_66                -7.127489e-04 3 1  ON 65
ci_67                -8.949576e-04 3 1  ON 66
ci_68                -1.372121e-03 3 1  ON 67
ci_69                 1.318227e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2452e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.824
    reference variance = 0.286963
====================================================
  Execution time = 4.4887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5141e-01
  Total weights = 1.963988318e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435271415525
                                         uncertainty =       0.002094769688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435271415525
                                         uncertainty =       0.002094769688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466493446
  error estimate for blocks of size 2^( 2) =       0.000491449624
  error estimate for blocks of size 2^( 3) =       0.000514964543
  error estimate for blocks of size 2^( 4) =       0.000532863136
  error estimate for blocks of size 2^( 5) =       0.000542669489
  error estimate for blocks of size 2^( 6) =       0.000548566169
  error estimate for blocks of size 2^( 7) =       0.000550793557

      target function =      -0.744173898152
              le_mean =     -22.814661440257
             les_mean =     520.960183808452
             stat err =       0.000543723088
             autocorr =       1.358515056452
   target nu stat err =       0.000543723088
   target dn stat err =       0.004257475089
      target stat err =       0.003549536214
              std dev =       0.659721357894
             le_variance =       0.435232270061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281466144026e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744189692274       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744189694074       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744189694355       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744189694423       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744189694437       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744189694446       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744189694435       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744189694434       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744189694438       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 2.620943e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744189692274       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744189692724       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744189692794       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744189692812       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744189692835       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744189692861       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744189692833       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744189692911       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744189692844       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+04 is 6.552371e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744189692274       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744189692387       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744189692404       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744189692408       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744189692396       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744189692438       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744189692652       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744189692375       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744189692758       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+05 is 1.638094e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2651e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898797e-02 3 1  ON 2
ci_04                 2.690908e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176965e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571474e-03 3 1  ON 7
ci_09                -9.045291e-03 3 1  ON 8
ci_10                -8.352766e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948913e-03 3 1  ON 11
ci_13                 1.283207e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266760e-03 3 1  ON 14
ci_16                 6.426482e-03 3 1  ON 15
ci_17                -7.244573e-03 3 1  ON 16
ci_18                -5.940908e-03 3 1  ON 17
ci_19                 9.299879e-03 3 1  ON 18
ci_20                 6.395026e-03 3 1  ON 19
ci_21                 9.004944e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984863e-03 3 1  ON 23
ci_25                 2.848363e-03 3 1  ON 24
ci_26                 3.136312e-03 3 1  ON 25
ci_27                 3.318400e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306957e-03 3 1  ON 28
ci_30                -1.833663e-03 3 1  ON 29
ci_31                -5.581126e-04 3 1  ON 30
ci_32                -8.464070e-04 3 1  ON 31
ci_33                -1.467129e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456795e-03 3 1  ON 34
ci_36                -1.024436e-03 3 1  ON 35
ci_37                -1.031564e-03 3 1  ON 36
ci_38                -7.685149e-04 3 1  ON 37
ci_39                -6.245874e-04 3 1  ON 38
ci_40                -1.561242e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167542e-03 3 1  ON 41
ci_43                -2.482052e-03 3 1  ON 42
ci_44                -3.239198e-03 3 1  ON 43
ci_45                -5.273524e-04 3 1  ON 44
ci_46                -8.694146e-04 3 1  ON 45
ci_47                 1.538400e-03 3 1  ON 46
ci_48                 1.377194e-03 3 1  ON 47
ci_49                -1.040597e-03 3 1  ON 48
ci_50                -8.119958e-04 3 1  ON 49
ci_51                 1.439373e-04 3 1  ON 50
ci_52                 8.068140e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026836e-03 3 1  ON 53
ci_55                -6.525763e-04 3 1  ON 54
ci_56                 2.626585e-03 3 1  ON 55
ci_57                 1.624709e-03 3 1  ON 56
ci_58                -1.114399e-03 3 1  ON 57
ci_59                -1.466037e-03 3 1  ON 58
ci_60                 5.428978e-04 3 1  ON 59
ci_61                -1.294357e-04 3 1  ON 60
ci_62                -6.662257e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632734e-04 3 1  ON 63
ci_65                 6.160293e-05 3 1  ON 64
ci_66                -7.127474e-04 3 1  ON 65
ci_67                -8.949577e-04 3 1  ON 66
ci_68                -1.372122e-03 3 1  ON 67
ci_69                 1.318223e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8369
    reference variance = 0.256248
====================================================
  Execution time = 4.1649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5250e-01
  Total weights = 1.9643e+06
  Execution time = 5.9339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670959718
                                         uncertainty =       0.005660355466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670959718
                                         uncertainty =       0.005660355466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468952436
  error estimate for blocks of size 2^( 2) =       0.000493917428
  error estimate for blocks of size 2^( 3) =       0.000518291403
  error estimate for blocks of size 2^( 4) =       0.000535836563
  error estimate for blocks of size 2^( 5) =       0.000546971184
  error estimate for blocks of size 2^( 6) =       0.000552652804
  error estimate for blocks of size 2^( 7) =       0.000556323516

      target function =      -0.743225950547
              le_mean =     -22.814236996068
             les_mean =     520.941909569700
             stat err =       0.000547946016
             autocorr =       1.365268140662
   target nu stat err =       0.000547946016
   target dn stat err =       0.008613532961
      target stat err =       0.007081604947
              std dev =       0.663198894931
             le_variance =       0.439832774238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670954505
                                         uncertainty =       0.005660352489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670954505
                                         uncertainty =       0.005660352489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468952433
  error estimate for blocks of size 2^( 2) =       0.000493917427
  error estimate for blocks of size 2^( 3) =       0.000518291402
  error estimate for blocks of size 2^( 4) =       0.000535836562
  error estimate for blocks of size 2^( 5) =       0.000546971184
  error estimate for blocks of size 2^( 6) =       0.000552652804
  error estimate for blocks of size 2^( 7) =       0.000556323516

      target function =      -0.743225958532
              le_mean =     -22.814236996184
             les_mean =     520.941909565367
             stat err =       0.000547946017
             autocorr =       1.365268157427
   target nu stat err =       0.000547946017
   target dn stat err =       0.008613528401
      target stat err =       0.007081601377
              std dev =       0.663198891110
             le_variance =       0.439832769169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670957111
                                         uncertainty =       0.005660353977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670957111
                                         uncertainty =       0.005660353977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468952435
  error estimate for blocks of size 2^( 2) =       0.000493917428
  error estimate for blocks of size 2^( 3) =       0.000518291403
  error estimate for blocks of size 2^( 4) =       0.000535836563
  error estimate for blocks of size 2^( 5) =       0.000546971184
  error estimate for blocks of size 2^( 6) =       0.000552652804
  error estimate for blocks of size 2^( 7) =       0.000556323516

      target function =      -0.743225954541
              le_mean =     -22.814236996126
             les_mean =     520.941909567532
             stat err =       0.000547946017
             autocorr =       1.365268149048
   target nu stat err =       0.000547946017
   target dn stat err =       0.008613530681
      target stat err =       0.007081603162
              std dev =       0.663198893020
             le_variance =       0.439832771703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670959392
                                         uncertainty =       0.005660355280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670959392
                                         uncertainty =       0.005660355280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468952436
  error estimate for blocks of size 2^( 2) =       0.000493917428
  error estimate for blocks of size 2^( 3) =       0.000518291403
  error estimate for blocks of size 2^( 4) =       0.000535836563
  error estimate for blocks of size 2^( 5) =       0.000546971184
  error estimate for blocks of size 2^( 6) =       0.000552652804
  error estimate for blocks of size 2^( 7) =       0.000556323516

      target function =      -0.743225951046
              le_mean =     -22.814236996075
             les_mean =     520.941909569429
             stat err =       0.000547946016
             autocorr =       1.365268141707
   target nu stat err =       0.000547946016
   target dn stat err =       0.008613532676
      target stat err =       0.007081604724
              std dev =       0.663198894693
             le_variance =       0.439832773921


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743225950547        initial
     9.3132e+03     9.3132e+04             2.6209e-08        -0.743225958532  <--
     3.7253e+04     3.7253e+05             6.5524e-09        -0.743225954541
     1.4901e+05     1.4901e+06             1.6381e-09        -0.743225951046

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 7.1445e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045287e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948910e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266766e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244570e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299880e-03 3 1  ON 18
ci_20                 6.395022e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265992e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984870e-03 3 1  ON 23
ci_25                 2.848364e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318407e-03 3 1  ON 26
ci_28                 1.933021e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833663e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464089e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024432e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245855e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248547e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482051e-03 3 1  ON 42
ci_44                -3.239193e-03 3 1  ON 43
ci_45                -5.273538e-04 3 1  ON 44
ci_46                -8.694128e-04 3 1  ON 45
ci_47                 1.538401e-03 3 1  ON 46
ci_48                 1.377196e-03 3 1  ON 47
ci_49                -1.040596e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439384e-04 3 1  ON 50
ci_52                 8.068124e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525783e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114397e-03 3 1  ON 57
ci_59                -1.466034e-03 3 1  ON 58
ci_60                 5.428916e-04 3 1  ON 59
ci_61                -1.294362e-04 3 1  ON 60
ci_62                -6.662297e-04 3 1  ON 61
ci_63                -7.728500e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160645e-05 3 1  ON 64
ci_66                -7.127428e-04 3 1  ON 65
ci_67                -8.949581e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318209e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2419e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8816
    reference variance = 0.619717
====================================================
  Execution time = 4.3427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4771e-01
  Total weights = 1.963989165e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435411633020
                                         uncertainty =       0.002070894931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435411633020
                                         uncertainty =       0.002070894931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466574432
  error estimate for blocks of size 2^( 2) =       0.000491850757
  error estimate for blocks of size 2^( 3) =       0.000514817624
  error estimate for blocks of size 2^( 4) =       0.000532657926
  error estimate for blocks of size 2^( 5) =       0.000544505563
  error estimate for blocks of size 2^( 6) =       0.000550342378
  error estimate for blocks of size 2^( 7) =       0.000554482822

      target function =      -0.747226986869
              le_mean =     -22.813627775065
             les_mean =     520.909318849569
             stat err =       0.000545497172
             autocorr =       1.366920120006
   target nu stat err =       0.000545497172
   target dn stat err =       0.002833035610
      target stat err =       0.002419994748
              std dev =       0.659835889045
             le_variance =       0.435383400472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281362777507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747233861608       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747233869569       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747233870643       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747233871108       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747233871138       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747233871165       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747233871154       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747233871157       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747233871155       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 1.378645e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747233861608       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747233863599       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747233863867       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747233863981       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747233863999       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747233864012       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747233863993       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747233863984       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747233863997       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 3.446640e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747233861608       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747233862106       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747233862173       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747233862202       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747233862164       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747233862187       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747233862205       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747233862199       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747233862168       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+04 is 8.616617e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1150e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690906e-02 3 1  ON 3
ci_05                -2.207726e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571462e-03 3 1  ON 7
ci_09                -9.045278e-03 3 1  ON 8
ci_10                -8.352743e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948909e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266766e-03 3 1  ON 14
ci_16                 6.426468e-03 3 1  ON 15
ci_17                -7.244563e-03 3 1  ON 16
ci_18                -5.940910e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395017e-03 3 1  ON 19
ci_21                 9.004939e-03 3 1  ON 20
ci_22                 8.265990e-03 3 1  ON 21
ci_23                 4.757161e-03 3 1  ON 22
ci_24                 3.984875e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136312e-03 3 1  ON 25
ci_27                 3.318402e-03 3 1  ON 26
ci_28                 1.933023e-03 3 1  ON 27
ci_29                 1.306957e-03 3 1  ON 28
ci_30                -1.833659e-03 3 1  ON 29
ci_31                -5.581162e-04 3 1  ON 30
ci_32                -8.464133e-04 3 1  ON 31
ci_33                -1.467126e-03 3 1  ON 32
ci_34                 1.137979e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024432e-03 3 1  ON 35
ci_37                -1.031567e-03 3 1  ON 36
ci_38                -7.685116e-04 3 1  ON 37
ci_39                -6.245819e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167553e-03 3 1  ON 41
ci_43                -2.482049e-03 3 1  ON 42
ci_44                -3.239186e-03 3 1  ON 43
ci_45                -5.273567e-04 3 1  ON 44
ci_46                -8.694105e-04 3 1  ON 45
ci_47                 1.538404e-03 3 1  ON 46
ci_48                 1.377194e-03 3 1  ON 47
ci_49                -1.040594e-03 3 1  ON 48
ci_50                -8.119945e-04 3 1  ON 49
ci_51                 1.439332e-04 3 1  ON 50
ci_52                 8.068090e-05 3 1  ON 51
ci_53                -6.382703e-04 3 1  ON 52
ci_54                -1.026831e-03 3 1  ON 53
ci_55                -6.525736e-04 3 1  ON 54
ci_56                 2.626568e-03 3 1  ON 55
ci_57                 1.624713e-03 3 1  ON 56
ci_58                -1.114398e-03 3 1  ON 57
ci_59                -1.466017e-03 3 1  ON 58
ci_60                 5.428835e-04 3 1  ON 59
ci_61                -1.294416e-04 3 1  ON 60
ci_62                -6.662220e-04 3 1  ON 61
ci_63                -7.728456e-04 3 1  ON 62
ci_64                -2.632806e-04 3 1  ON 63
ci_65                 6.160890e-05 3 1  ON 64
ci_66                -7.127431e-04 3 1  ON 65
ci_67                -8.949562e-04 3 1  ON 66
ci_68                -1.372121e-03 3 1  ON 67
ci_69                 1.318134e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8558
    reference variance = 0.326945
====================================================
  Execution time = 4.4120e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4997e-01
  Total weights = 1.9644e+06
  Execution time = 5.9523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341799592
                                         uncertainty =       0.002345558264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341799592
                                         uncertainty =       0.002345558264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466546418
  error estimate for blocks of size 2^( 2) =       0.000491902230
  error estimate for blocks of size 2^( 3) =       0.000515781288
  error estimate for blocks of size 2^( 4) =       0.000533196970
  error estimate for blocks of size 2^( 5) =       0.000543816577
  error estimate for blocks of size 2^( 6) =       0.000551190098
  error estimate for blocks of size 2^( 7) =       0.000551159594

      target function =      -0.745360445556
              le_mean =     -22.814098088635
             les_mean =     520.933043048011
             stat err =       0.000544840810
             autocorr =       1.363796401794
   target nu stat err =       0.000544840810
   target dn stat err =       0.002997655549
      target stat err =       0.002541308421
              std dev =       0.659796271868
             le_variance =       0.435331120370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341790806
                                         uncertainty =       0.002345559612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341790806
                                         uncertainty =       0.002345559612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466546413
  error estimate for blocks of size 2^( 2) =       0.000491902228
  error estimate for blocks of size 2^( 3) =       0.000515781289
  error estimate for blocks of size 2^( 4) =       0.000533196973
  error estimate for blocks of size 2^( 5) =       0.000543816582
  error estimate for blocks of size 2^( 6) =       0.000551190104
  error estimate for blocks of size 2^( 7) =       0.000551159598

      target function =      -0.745360430282
              le_mean =     -22.814098088431
             les_mean =     520.933043057232
             stat err =       0.000544840814
             autocorr =       1.363796452645
   target nu stat err =       0.000544840814
   target dn stat err =       0.002997660194
      target stat err =       0.002541312038
              std dev =       0.659796265257
             le_variance =       0.435331111647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341795199
                                         uncertainty =       0.002345558938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341795199
                                         uncertainty =       0.002345558938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466546416
  error estimate for blocks of size 2^( 2) =       0.000491902229
  error estimate for blocks of size 2^( 3) =       0.000515781289
  error estimate for blocks of size 2^( 4) =       0.000533196971
  error estimate for blocks of size 2^( 5) =       0.000543816579
  error estimate for blocks of size 2^( 6) =       0.000551190101
  error estimate for blocks of size 2^( 7) =       0.000551159596

      target function =      -0.745360437928
              le_mean =     -22.814098088533
             les_mean =     520.933043052610
             stat err =       0.000544840812
             autocorr =       1.363796427219
   target nu stat err =       0.000544840812
   target dn stat err =       0.002997657871
      target stat err =       0.002541310229
              std dev =       0.659796268562
             le_variance =       0.435331116008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341799043
                                         uncertainty =       0.002345558348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435341799043
                                         uncertainty =       0.002345558348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466546418
  error estimate for blocks of size 2^( 2) =       0.000491902230
  error estimate for blocks of size 2^( 3) =       0.000515781288
  error estimate for blocks of size 2^( 4) =       0.000533196970
  error estimate for blocks of size 2^( 5) =       0.000543816577
  error estimate for blocks of size 2^( 6) =       0.000551190098
  error estimate for blocks of size 2^( 7) =       0.000551159594

      target function =      -0.745360444603
              le_mean =     -22.814098088622
             les_mean =     520.933043048584
             stat err =       0.000544840810
             autocorr =       1.363796404971
   target nu stat err =       0.000544840810
   target dn stat err =       0.002997655839
      target stat err =       0.002541308647
              std dev =       0.659796271454
             le_variance =       0.435331119825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745360445556        initial  <--
     2.3283e+03     2.3283e+04             1.3786e-07        -0.745360430282
     9.3132e+03     9.3132e+04             3.4466e-08        -0.745360437928
     3.7253e+04     3.7253e+05             8.6166e-09        -0.745360444603

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 74.0120
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045287e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948910e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266766e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244570e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299880e-03 3 1  ON 18
ci_20                 6.395022e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265992e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984870e-03 3 1  ON 23
ci_25                 2.848364e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318407e-03 3 1  ON 26
ci_28                 1.933021e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833663e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464089e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024432e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245855e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248547e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482051e-03 3 1  ON 42
ci_44                -3.239193e-03 3 1  ON 43
ci_45                -5.273538e-04 3 1  ON 44
ci_46                -8.694128e-04 3 1  ON 45
ci_47                 1.538401e-03 3 1  ON 46
ci_48                 1.377196e-03 3 1  ON 47
ci_49                -1.040596e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439384e-04 3 1  ON 50
ci_52                 8.068124e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525783e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114397e-03 3 1  ON 57
ci_59                -1.466034e-03 3 1  ON 58
ci_60                 5.428916e-04 3 1  ON 59
ci_61                -1.294362e-04 3 1  ON 60
ci_62                -6.662297e-04 3 1  ON 61
ci_63                -7.728500e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160645e-05 3 1  ON 64
ci_66                -7.127428e-04 3 1  ON 65
ci_67                -8.949581e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318209e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2517e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8912
    reference variance = 0.407071
====================================================
  Execution time = 4.3359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4532e-01
  Total weights = 1.964352747e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433545702846
                                         uncertainty =       0.002245317224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433545702846
                                         uncertainty =       0.002245317224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465583773
  error estimate for blocks of size 2^( 2) =       0.000491070836
  error estimate for blocks of size 2^( 3) =       0.000514608276
  error estimate for blocks of size 2^( 4) =       0.000531691548
  error estimate for blocks of size 2^( 5) =       0.000542260192
  error estimate for blocks of size 2^( 6) =       0.000550727159
  error estimate for blocks of size 2^( 7) =       0.000553839411

      target function =      -0.749224066891
              le_mean =     -22.814679580321
             les_mean =     520.954920413583
             stat err =       0.000544629577
             autocorr =       1.368380182333
   target nu stat err =       0.000544629577
   target dn stat err =       0.002421330731
      target stat err =       0.002105667872
              std dev =       0.658434885657
             le_variance =       0.433536498650


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281467958032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749229001578       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749229002205       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749229002282       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749229002294       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749229002344       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749229002290       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749229002270       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749229002304       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749229002311       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 5.521145e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749229001578       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749229001735       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749229001754       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749229001757       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749229001766       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749229001762       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749229001818       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749229001758       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749229001637       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 1.380288e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749229001578       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749229001617       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749229001622       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749229001623       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749229001623       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749229001460       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749229001351       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749229001763       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749229001690       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+05 is 3.450720e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1021e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045287e-03 3 1  ON 8
ci_10                -8.352747e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948909e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266766e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244570e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299880e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984870e-03 3 1  ON 23
ci_25                 2.848364e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933021e-03 3 1  ON 27
ci_29                 1.306954e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581149e-04 3 1  ON 30
ci_32                -8.464101e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456801e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685123e-04 3 1  ON 37
ci_39                -6.245858e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248547e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482052e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273533e-04 3 1  ON 44
ci_46                -8.694126e-04 3 1  ON 45
ci_47                 1.538401e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040597e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439389e-04 3 1  ON 50
ci_52                 8.068156e-05 3 1  ON 51
ci_53                -6.382735e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525779e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466034e-03 3 1  ON 58
ci_60                 5.428905e-04 3 1  ON 59
ci_61                -1.294362e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728493e-04 3 1  ON 62
ci_64                -2.632747e-04 3 1  ON 63
ci_65                 6.160594e-05 3 1  ON 64
ci_66                -7.127430e-04 3 1  ON 65
ci_67                -8.949580e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318200e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8207
    reference variance = 0.566061
====================================================
  Execution time = 4.3171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4803e-01
  Total weights = 1.9646e+06
  Execution time = 5.9560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436567811265
                                         uncertainty =       0.001812989234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436567811265
                                         uncertainty =       0.001812989234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193945
  error estimate for blocks of size 2^( 2) =       0.000492460223
  error estimate for blocks of size 2^( 3) =       0.000516589349
  error estimate for blocks of size 2^( 4) =       0.000534859594
  error estimate for blocks of size 2^( 5) =       0.000545798043
  error estimate for blocks of size 2^( 6) =       0.000551438077
  error estimate for blocks of size 2^( 7) =       0.000554361312

      target function =      -0.746971040412
              le_mean =     -22.815086140564
             les_mean =     520.976188096772
             stat err =       0.000546614256
             autocorr =       1.368886679040
   target nu stat err =       0.000546614256
   target dn stat err =       0.002487440508
      target stat err =       0.002147927866
              std dev =       0.660712013701
             le_variance =       0.436540365049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436567811148
                                         uncertainty =       0.001812989143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436567811148
                                         uncertainty =       0.001812989143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193945
  error estimate for blocks of size 2^( 2) =       0.000492460223
  error estimate for blocks of size 2^( 3) =       0.000516589349
  error estimate for blocks of size 2^( 4) =       0.000534859595
  error estimate for blocks of size 2^( 5) =       0.000545798044
  error estimate for blocks of size 2^( 6) =       0.000551438078
  error estimate for blocks of size 2^( 7) =       0.000554361312

      target function =      -0.746971037680
              le_mean =     -22.815086140603
             les_mean =     520.976188101886
             stat err =       0.000546614257
             autocorr =       1.368886683223
   target nu stat err =       0.000546614257
   target dn stat err =       0.002487440612
      target stat err =       0.002147927933
              std dev =       0.660712013611
             le_variance =       0.436540364930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436567811206
                                         uncertainty =       0.001812989189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436567811206
                                         uncertainty =       0.001812989189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193945
  error estimate for blocks of size 2^( 2) =       0.000492460223
  error estimate for blocks of size 2^( 3) =       0.000516589349
  error estimate for blocks of size 2^( 4) =       0.000534859594
  error estimate for blocks of size 2^( 5) =       0.000545798043
  error estimate for blocks of size 2^( 6) =       0.000551438077
  error estimate for blocks of size 2^( 7) =       0.000554361312

      target function =      -0.746971039046
              le_mean =     -22.815086140584
             les_mean =     520.976188099329
             stat err =       0.000546614257
             autocorr =       1.368886681130
   target nu stat err =       0.000546614257
   target dn stat err =       0.002487440560
      target stat err =       0.002147927899
              std dev =       0.660712013657
             le_variance =       0.436540364990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436567811258
                                         uncertainty =       0.001812989228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436567811258
                                         uncertainty =       0.001812989228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193945
  error estimate for blocks of size 2^( 2) =       0.000492460223
  error estimate for blocks of size 2^( 3) =       0.000516589349
  error estimate for blocks of size 2^( 4) =       0.000534859594
  error estimate for blocks of size 2^( 5) =       0.000545798043
  error estimate for blocks of size 2^( 6) =       0.000551438077
  error estimate for blocks of size 2^( 7) =       0.000554361312

      target function =      -0.746971040241
              le_mean =     -22.815086140566
             les_mean =     520.976188097092
             stat err =       0.000546614256
             autocorr =       1.368886679292
   target nu stat err =       0.000546614256
   target dn stat err =       0.002487440515
      target stat err =       0.002147927870
              std dev =       0.660712013696
             le_variance =       0.436540365042


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746971040412        initial  <--
     2.3283e+04     2.3283e+05             5.5211e-09        -0.746971037680
     9.3132e+04     9.3132e+05             1.3803e-09        -0.746971039046
     3.7253e+05     3.7253e+06             3.4507e-10        -0.746971040241

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.0693
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045287e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948910e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266766e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244570e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299880e-03 3 1  ON 18
ci_20                 6.395022e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265992e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984870e-03 3 1  ON 23
ci_25                 2.848364e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318407e-03 3 1  ON 26
ci_28                 1.933021e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833663e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464089e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024432e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245855e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248547e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482051e-03 3 1  ON 42
ci_44                -3.239193e-03 3 1  ON 43
ci_45                -5.273538e-04 3 1  ON 44
ci_46                -8.694128e-04 3 1  ON 45
ci_47                 1.538401e-03 3 1  ON 46
ci_48                 1.377196e-03 3 1  ON 47
ci_49                -1.040596e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439384e-04 3 1  ON 50
ci_52                 8.068124e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525783e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114397e-03 3 1  ON 57
ci_59                -1.466034e-03 3 1  ON 58
ci_60                 5.428916e-04 3 1  ON 59
ci_61                -1.294362e-04 3 1  ON 60
ci_62                -6.662297e-04 3 1  ON 61
ci_63                -7.728500e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160645e-05 3 1  ON 64
ci_66                -7.127428e-04 3 1  ON 65
ci_67                -8.949581e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318209e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2414e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.823
    reference variance = 0.379369
====================================================
  Execution time = 4.3186e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4562e-01
  Total weights = 1.964571700e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434204693641
                                         uncertainty =       0.001896785788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434204693641
                                         uncertainty =       0.001896785788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465960798
  error estimate for blocks of size 2^( 2) =       0.000491255081
  error estimate for blocks of size 2^( 3) =       0.000514318735
  error estimate for blocks of size 2^( 4) =       0.000532079723
  error estimate for blocks of size 2^( 5) =       0.000542231789
  error estimate for blocks of size 2^( 6) =       0.000549054121
  error estimate for blocks of size 2^( 7) =       0.000552805574

      target function =      -0.748965323013
              le_mean =     -22.814440924726
             les_mean =     520.944338316296
             stat err =       0.000544042801
             autocorr =       1.363224477568
   target nu stat err =       0.000544042801
   target dn stat err =       0.002452484084
      target stat err =       0.002128182469
              std dev =       0.658968080321
             le_variance =       0.434238930882


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281444092473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748970350914       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748970350968       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748970350976       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748970350979       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748970351162       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748970351528       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748970350870       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748970351297       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748970350849       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748970349964       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 7.134559e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748970350914       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748970350928       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748970350930       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748970350930       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748970350930       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748970349680       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748970347445       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748970350546       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748970350707       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748970351418       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 1.783639e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748970350914       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748970350917       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748970350918       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748970350918       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748970350916       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748970349941       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748970350984       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748970361029       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748970352119       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748970360194       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 4.459099e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259438 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0920e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045287e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948910e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266766e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244570e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299880e-03 3 1  ON 18
ci_20                 6.395022e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265992e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984870e-03 3 1  ON 23
ci_25                 2.848364e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933021e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833663e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464089e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024432e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245855e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248547e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482051e-03 3 1  ON 42
ci_44                -3.239193e-03 3 1  ON 43
ci_45                -5.273538e-04 3 1  ON 44
ci_46                -8.694129e-04 3 1  ON 45
ci_47                 1.538401e-03 3 1  ON 46
ci_48                 1.377196e-03 3 1  ON 47
ci_49                -1.040596e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.068122e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525783e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114397e-03 3 1  ON 57
ci_59                -1.466034e-03 3 1  ON 58
ci_60                 5.428916e-04 3 1  ON 59
ci_61                -1.294362e-04 3 1  ON 60
ci_62                -6.662297e-04 3 1  ON 61
ci_63                -7.728500e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160642e-05 3 1  ON 64
ci_66                -7.127428e-04 3 1  ON 65
ci_67                -8.949581e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318209e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8447
    reference variance = 0.257468
====================================================
  Execution time = 4.1741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4440e-01
  Total weights = 1.9640e+06
  Execution time = 5.9314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433112308684
                                         uncertainty =       0.001940642689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433112308684
                                         uncertainty =       0.001940642689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465355958
  error estimate for blocks of size 2^( 2) =       0.000490790631
  error estimate for blocks of size 2^( 3) =       0.000514575867
  error estimate for blocks of size 2^( 4) =       0.000532736602
  error estimate for blocks of size 2^( 5) =       0.000543680021
  error estimate for blocks of size 2^( 6) =       0.000547579741
  error estimate for blocks of size 2^( 7) =       0.000549681208

      target function =      -0.749995712855
              le_mean =     -22.815565999604
             les_mean =     520.994454347212
             stat err =       0.000543419393
             autocorr =       1.363639927330
   target nu stat err =       0.000543419393
   target dn stat err =       0.002455616237
      target stat err =       0.002139686502
              std dev =       0.658112707037
             le_variance =       0.433112335164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433112308600
                                         uncertainty =       0.001940642686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433112308600
                                         uncertainty =       0.001940642686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465355958
  error estimate for blocks of size 2^( 2) =       0.000490790631
  error estimate for blocks of size 2^( 3) =       0.000514575867
  error estimate for blocks of size 2^( 4) =       0.000532736602
  error estimate for blocks of size 2^( 5) =       0.000543680021
  error estimate for blocks of size 2^( 6) =       0.000547579741
  error estimate for blocks of size 2^( 7) =       0.000549681208

      target function =      -0.749995713180
              le_mean =     -22.815565999612
             les_mean =     520.994454347207
             stat err =       0.000543419393
             autocorr =       1.363639927758
   target nu stat err =       0.000543419393
   target dn stat err =       0.002455616250
      target stat err =       0.002139686514
              std dev =       0.658112706974
             le_variance =       0.433112335080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433112308642
                                         uncertainty =       0.001940642688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433112308642
                                         uncertainty =       0.001940642688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465355958
  error estimate for blocks of size 2^( 2) =       0.000490790631
  error estimate for blocks of size 2^( 3) =       0.000514575867
  error estimate for blocks of size 2^( 4) =       0.000532736602
  error estimate for blocks of size 2^( 5) =       0.000543680021
  error estimate for blocks of size 2^( 6) =       0.000547579741
  error estimate for blocks of size 2^( 7) =       0.000549681208

      target function =      -0.749995713017
              le_mean =     -22.815565999608
             les_mean =     520.994454347209
             stat err =       0.000543419393
             autocorr =       1.363639927546
   target nu stat err =       0.000543419393
   target dn stat err =       0.002455616244
      target stat err =       0.002139686508
              std dev =       0.658112707005
             le_variance =       0.433112335122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433112308679
                                         uncertainty =       0.001940642689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433112308679
                                         uncertainty =       0.001940642689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465355958
  error estimate for blocks of size 2^( 2) =       0.000490790631
  error estimate for blocks of size 2^( 3) =       0.000514575867
  error estimate for blocks of size 2^( 4) =       0.000532736602
  error estimate for blocks of size 2^( 5) =       0.000543680021
  error estimate for blocks of size 2^( 6) =       0.000547579741
  error estimate for blocks of size 2^( 7) =       0.000549681208

      target function =      -0.749995712875
              le_mean =     -22.815565999604
             les_mean =     520.994454347212
             stat err =       0.000543419393
             autocorr =       1.363639927359
   target nu stat err =       0.000543419393
   target dn stat err =       0.002455616238
      target stat err =       0.002139686503
              std dev =       0.658112707033
             le_variance =       0.433112335159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749995712855        initial
     2.3283e+05     2.3283e+06             7.1346e-10        -0.749995713180  <--
     9.3132e+05     9.3132e+06             1.7836e-10        -0.749995713017
     3.7253e+06     3.7253e+07             4.4591e-11        -0.749995712875

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 7.2064e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045287e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948910e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266766e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244570e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299880e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265992e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984870e-03 3 1  ON 23
ci_25                 2.848364e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833663e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024432e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245855e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248547e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482051e-03 3 1  ON 42
ci_44                -3.239192e-03 3 1  ON 43
ci_45                -5.273537e-04 3 1  ON 44
ci_46                -8.694130e-04 3 1  ON 45
ci_47                 1.538401e-03 3 1  ON 46
ci_48                 1.377196e-03 3 1  ON 47
ci_49                -1.040596e-03 3 1  ON 48
ci_50                -8.119957e-04 3 1  ON 49
ci_51                 1.439390e-04 3 1  ON 50
ci_52                 8.068115e-05 3 1  ON 51
ci_53                -6.382741e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525783e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466034e-03 3 1  ON 58
ci_60                 5.428917e-04 3 1  ON 59
ci_61                -1.294359e-04 3 1  ON 60
ci_62                -6.662297e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160631e-05 3 1  ON 64
ci_66                -7.127427e-04 3 1  ON 65
ci_67                -8.949583e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318208e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2319e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8181
    reference variance = 0.270834
====================================================
  Execution time = 4.3032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5147e-01
  Total weights = 1.964130039e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439936759954
                                         uncertainty =       0.002528479194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439936759954
                                         uncertainty =       0.002528479194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468998014
  error estimate for blocks of size 2^( 2) =       0.000494206644
  error estimate for blocks of size 2^( 3) =       0.000517991576
  error estimate for blocks of size 2^( 4) =       0.000534725763
  error estimate for blocks of size 2^( 5) =       0.000545377165
  error estimate for blocks of size 2^( 6) =       0.000552069323
  error estimate for blocks of size 2^( 7) =       0.000556538794

      target function =      -0.744132023809
              le_mean =     -22.814443648721
             les_mean =     520.950306260336
             stat err =       0.000547177761
             autocorr =       1.361177837291
   target nu stat err =       0.000547177761
   target dn stat err =       0.002975648037
      target stat err =       0.002517533209
              std dev =       0.663263352050
             le_variance =       0.439918274172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281444364872e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744139550273       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744139550460       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744139550475       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744139550477       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744139550477       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744139550475       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744139550427       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744139550570       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744139550463       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 3.281766e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744139550273       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744139550320       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744139550323       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744139550324       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744139550307       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744139550395       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744139550150       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744139550490       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744139550254       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 8.204420e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744139550273       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744139550284       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744139550285       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744139550286       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744139550292       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744139547870       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744139552592       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744139551402       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744139549769       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 2.051105e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262493 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0730e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045287e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948910e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266766e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244570e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245855e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248547e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482051e-03 3 1  ON 42
ci_44                -3.239192e-03 3 1  ON 43
ci_45                -5.273537e-04 3 1  ON 44
ci_46                -8.694131e-04 3 1  ON 45
ci_47                 1.538401e-03 3 1  ON 46
ci_48                 1.377196e-03 3 1  ON 47
ci_49                -1.040596e-03 3 1  ON 48
ci_50                -8.119957e-04 3 1  ON 49
ci_51                 1.439391e-04 3 1  ON 50
ci_52                 8.068108e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525785e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466034e-03 3 1  ON 58
ci_60                 5.428917e-04 3 1  ON 59
ci_61                -1.294357e-04 3 1  ON 60
ci_62                -6.662297e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160625e-05 3 1  ON 64
ci_66                -7.127425e-04 3 1  ON 65
ci_67                -8.949583e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318204e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8071
    reference variance = 0.393215
====================================================
  Execution time = 4.1840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4515e-01
  Total weights = 1.9643e+06
  Execution time = 5.9617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433535006715
                                         uncertainty =       0.001982014017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433535006715
                                         uncertainty =       0.001982014017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465590152
  error estimate for blocks of size 2^( 2) =       0.000491250993
  error estimate for blocks of size 2^( 3) =       0.000515240051
  error estimate for blocks of size 2^( 4) =       0.000532345932
  error estimate for blocks of size 2^( 5) =       0.000543066372
  error estimate for blocks of size 2^( 6) =       0.000549532120
  error estimate for blocks of size 2^( 7) =       0.000551402148

      target function =      -0.749360512654
              le_mean =     -22.814595942533
             les_mean =     520.950938481815
             stat err =       0.000544086643
             autocorr =       1.365615876920
   target nu stat err =       0.000544086643
   target dn stat err =       0.002544509488
      target stat err =       0.002204463957
              std dev =       0.658443907641
             le_variance =       0.433548379509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433535006581
                                         uncertainty =       0.001982014007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433535006581
                                         uncertainty =       0.001982014007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465590152
  error estimate for blocks of size 2^( 2) =       0.000491250993
  error estimate for blocks of size 2^( 3) =       0.000515240051
  error estimate for blocks of size 2^( 4) =       0.000532345932
  error estimate for blocks of size 2^( 5) =       0.000543066373
  error estimate for blocks of size 2^( 6) =       0.000549532120
  error estimate for blocks of size 2^( 7) =       0.000551402148

      target function =      -0.749360514882
              le_mean =     -22.814595942539
             les_mean =     520.950938479395
             stat err =       0.000544086643
             autocorr =       1.365615878416
   target nu stat err =       0.000544086643
   target dn stat err =       0.002544508904
      target stat err =       0.002204463502
              std dev =       0.658443907537
             le_variance =       0.433548379372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433535006648
                                         uncertainty =       0.001982014012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433535006648
                                         uncertainty =       0.001982014012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465590152
  error estimate for blocks of size 2^( 2) =       0.000491250993
  error estimate for blocks of size 2^( 3) =       0.000515240051
  error estimate for blocks of size 2^( 4) =       0.000532345932
  error estimate for blocks of size 2^( 5) =       0.000543066373
  error estimate for blocks of size 2^( 6) =       0.000549532120
  error estimate for blocks of size 2^( 7) =       0.000551402148

      target function =      -0.749360513768
              le_mean =     -22.814595942536
             les_mean =     520.950938480605
             stat err =       0.000544086643
             autocorr =       1.365615877667
   target nu stat err =       0.000544086643
   target dn stat err =       0.002544509196
      target stat err =       0.002204463730
              std dev =       0.658443907589
             le_variance =       0.433548379441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433535006707
                                         uncertainty =       0.001982014016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433535006707
                                         uncertainty =       0.001982014016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465590152
  error estimate for blocks of size 2^( 2) =       0.000491250993
  error estimate for blocks of size 2^( 3) =       0.000515240051
  error estimate for blocks of size 2^( 4) =       0.000532345932
  error estimate for blocks of size 2^( 5) =       0.000543066372
  error estimate for blocks of size 2^( 6) =       0.000549532120
  error estimate for blocks of size 2^( 7) =       0.000551402148

      target function =      -0.749360512793
              le_mean =     -22.814595942534
             les_mean =     520.950938481663
             stat err =       0.000544086643
             autocorr =       1.365615877014
   target nu stat err =       0.000544086643
   target dn stat err =       0.002544509451
      target stat err =       0.002204463929
              std dev =       0.658443907634
             le_variance =       0.433548379501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749360512654        initial
     5.8208e+04     5.8208e+05             3.2818e-09        -0.749360514882  <--
     2.3283e+05     2.3283e+06             8.2044e-10        -0.749360513768
     9.3132e+05     9.3132e+06             2.0511e-10        -0.749360512793

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 7.1727e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045286e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244570e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933019e-03 3 1  ON 27
ci_29                 1.306952e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464090e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245857e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273535e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119957e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068086e-05 3 1  ON 51
ci_53                -6.382743e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525791e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428917e-04 3 1  ON 59
ci_61                -1.294350e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160607e-05 3 1  ON 64
ci_66                -7.127420e-04 3 1  ON 65
ci_67                -8.949582e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318193e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2247e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8105
    reference variance = 0.254357
====================================================
  Execution time = 4.4440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4724e-01
  Total weights = 1.964183651e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434673451759
                                         uncertainty =       0.002244586742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434673451759
                                         uncertainty =       0.002244586742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466175174
  error estimate for blocks of size 2^( 2) =       0.000491840966
  error estimate for blocks of size 2^( 3) =       0.000515878772
  error estimate for blocks of size 2^( 4) =       0.000534219378
  error estimate for blocks of size 2^( 5) =       0.000545845078
  error estimate for blocks of size 2^( 6) =       0.000552694888
  error estimate for blocks of size 2^( 7) =       0.000556369873

      target function =      -0.747624296352
              le_mean =     -22.814722634477
             les_mean =     520.958806494768
             stat err =       0.000547282304
             autocorr =       1.378238978426
   target nu stat err =       0.000547282304
   target dn stat err =       0.003021513388
      target stat err =       0.002578573743
              std dev =       0.659271253901
             le_variance =       0.434638586220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472263448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747632300355       residual = 7.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747632303129       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747632303526       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747632303613       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747632303633       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747632303642       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747632303640       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747632303639       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747632303639       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747632303639       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 1.594094e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747632300355       residual = 7.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747632301049       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747632301148       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747632301170       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747632301175       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747632301177       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747632301177       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747632301176       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747632301176       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747632301176       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 3.985240e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747632300355       residual = 7.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747632300529       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747632300554       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747632300559       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747632300560       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747632300561       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747632300561       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747632300561       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747632300657       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747632300532       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 9.963104e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266016 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2041e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888019e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571469e-03 3 1  ON 7
ci_09                -9.045284e-03 3 1  ON 8
ci_10                -8.352750e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948910e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940909e-03 3 1  ON 17
ci_19                 9.299882e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265992e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136308e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306955e-03 3 1  ON 28
ci_30                -1.833660e-03 3 1  ON 29
ci_31                -5.581155e-04 3 1  ON 30
ci_32                -8.464074e-04 3 1  ON 31
ci_33                -1.467131e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456802e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685132e-04 3 1  ON 37
ci_39                -6.245857e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167544e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239192e-03 3 1  ON 43
ci_45                -5.273537e-04 3 1  ON 44
ci_46                -8.694122e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040594e-03 3 1  ON 48
ci_50                -8.119959e-04 3 1  ON 49
ci_51                 1.439388e-04 3 1  ON 50
ci_52                 8.068103e-05 3 1  ON 51
ci_53                -6.382754e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624709e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428911e-04 3 1  ON 59
ci_61                -1.294334e-04 3 1  ON 60
ci_62                -6.662298e-04 3 1  ON 61
ci_63                -7.728490e-04 3 1  ON 62
ci_64                -2.632733e-04 3 1  ON 63
ci_65                 6.160467e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949575e-04 3 1  ON 66
ci_68                -1.372124e-03 3 1  ON 67
ci_69                 1.318184e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8961
    reference variance = 0.832952
====================================================
  Execution time = 4.1962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5164e-01
  Total weights = 1.9642e+06
  Execution time = 6.1415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922350383
                                         uncertainty =       0.003628980422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922350383
                                         uncertainty =       0.003628980422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468469703
  error estimate for blocks of size 2^( 2) =       0.000493510882
  error estimate for blocks of size 2^( 3) =       0.000517505625
  error estimate for blocks of size 2^( 4) =       0.000534636581
  error estimate for blocks of size 2^( 5) =       0.000545548602
  error estimate for blocks of size 2^( 6) =       0.000553556482
  error estimate for blocks of size 2^( 7) =       0.000559521628

      target function =      -0.743983892289
              le_mean =     -22.815614045702
             les_mean =     521.003886861171
             stat err =       0.000548315823
             autocorr =       1.369930511016
   target nu stat err =       0.000548315823
   target dn stat err =       0.004099575088
      target stat err =       0.003425738700
              std dev =       0.662516208013
             le_variance =       0.438927725880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922360979
                                         uncertainty =       0.003628991518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922360979
                                         uncertainty =       0.003628991518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468469709
  error estimate for blocks of size 2^( 2) =       0.000493510888
  error estimate for blocks of size 2^( 3) =       0.000517505631
  error estimate for blocks of size 2^( 4) =       0.000534636587
  error estimate for blocks of size 2^( 5) =       0.000545548608
  error estimate for blocks of size 2^( 6) =       0.000553556489
  error estimate for blocks of size 2^( 7) =       0.000559521635

      target function =      -0.743983882421
              le_mean =     -22.815614045604
             les_mean =     521.003886868627
             stat err =       0.000548315830
             autocorr =       1.369930511754
   target nu stat err =       0.000548315830
   target dn stat err =       0.004099584849
      target stat err =       0.003425746514
              std dev =       0.662516216002
             le_variance =       0.438927736466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922355681
                                         uncertainty =       0.003628985970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922355681
                                         uncertainty =       0.003628985970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468469706
  error estimate for blocks of size 2^( 2) =       0.000493510885
  error estimate for blocks of size 2^( 3) =       0.000517505628
  error estimate for blocks of size 2^( 4) =       0.000534636584
  error estimate for blocks of size 2^( 5) =       0.000545548605
  error estimate for blocks of size 2^( 6) =       0.000553556485
  error estimate for blocks of size 2^( 7) =       0.000559521632

      target function =      -0.743983887355
              le_mean =     -22.815614045653
             les_mean =     521.003886864899
             stat err =       0.000548315827
             autocorr =       1.369930511385
   target nu stat err =       0.000548315827
   target dn stat err =       0.004099579968
      target stat err =       0.003425742607
              std dev =       0.662516212008
             le_variance =       0.438927731173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922351045
                                         uncertainty =       0.003628981115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438922351045
                                         uncertainty =       0.003628981115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468469704
  error estimate for blocks of size 2^( 2) =       0.000493510882
  error estimate for blocks of size 2^( 3) =       0.000517505625
  error estimate for blocks of size 2^( 4) =       0.000534636581
  error estimate for blocks of size 2^( 5) =       0.000545548602
  error estimate for blocks of size 2^( 6) =       0.000553556482
  error estimate for blocks of size 2^( 7) =       0.000559521629

      target function =      -0.743983891672
              le_mean =     -22.815614045696
             les_mean =     521.003886861637
             stat err =       0.000548315824
             autocorr =       1.369930511060
   target nu stat err =       0.000548315824
   target dn stat err =       0.004099575698
      target stat err =       0.003425739189
              std dev =       0.662516208513
             le_variance =       0.438927726542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743983892289        initial  <--
     1.4552e+04     1.4552e+05             1.5941e-08        -0.743983882421
     5.8208e+04     5.8208e+05             3.9852e-09        -0.743983887355
     2.3283e+05     2.3283e+06             9.9631e-10        -0.743983891672

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.4790
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045286e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244570e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933019e-03 3 1  ON 27
ci_29                 1.306952e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464090e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245857e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273535e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119957e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068086e-05 3 1  ON 51
ci_53                -6.382743e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525791e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428917e-04 3 1  ON 59
ci_61                -1.294350e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160607e-05 3 1  ON 64
ci_66                -7.127420e-04 3 1  ON 65
ci_67                -8.949582e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318193e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2458e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7802
    reference variance = 0.400392
====================================================
  Execution time = 4.5888e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4884e-01
  Total weights = 1.964078122e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436762721539
                                         uncertainty =       0.002162635510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436762721539
                                         uncertainty =       0.002162635510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467300921
  error estimate for blocks of size 2^( 2) =       0.000492217019
  error estimate for blocks of size 2^( 3) =       0.000515716153
  error estimate for blocks of size 2^( 4) =       0.000533899411
  error estimate for blocks of size 2^( 5) =       0.000545499713
  error estimate for blocks of size 2^( 6) =       0.000552905006
  error estimate for blocks of size 2^( 7) =       0.000554255238

      target function =      -0.746305688770
              le_mean =     -22.815203768127
             les_mean =     520.982358933742
             stat err =       0.000546639842
             autocorr =       1.368388104954
   target nu stat err =       0.000546639842
   target dn stat err =       0.002710986124
      target stat err =       0.002322587843
              std dev =       0.660863300206
             le_variance =       0.436740301560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281520376813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746311896555       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746311896638       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746311896648       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746311896650       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746311896651       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746311896651       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746311896650       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746311897044       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746311896650       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 1.267849e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746311896555       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746311896575       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746311896578       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746311896483       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746311896409       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746311896579       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746311896579       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746311896579       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746311897034       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 3.169623e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746311896555       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746311896560       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746311896560       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746311896561       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746311896561       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746311896561       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746311893424       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746311891308       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746311899719       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+06 is 7.924065e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3780e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738810e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045286e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426476e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933019e-03 3 1  ON 27
ci_29                 1.306952e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245856e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273534e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068096e-05 3 1  ON 51
ci_53                -6.382743e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525791e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428916e-04 3 1  ON 59
ci_61                -1.294349e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127420e-04 3 1  ON 65
ci_67                -8.949581e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318192e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8194
    reference variance = 0.369966
====================================================
  Execution time = 4.2664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4838e-01
  Total weights = 1.9647e+06
  Execution time = 5.9518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436094007566
                                         uncertainty =       0.002888703358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436094007566
                                         uncertainty =       0.002888703358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466900863
  error estimate for blocks of size 2^( 2) =       0.000492235728
  error estimate for blocks of size 2^( 3) =       0.000515495350
  error estimate for blocks of size 2^( 4) =       0.000533701752
  error estimate for blocks of size 2^( 5) =       0.000544930438
  error estimate for blocks of size 2^( 6) =       0.000551554905
  error estimate for blocks of size 2^( 7) =       0.000555908280

      target function =      -0.746661017019
              le_mean =     -22.813185169044
             les_mean =     520.889800207339
             stat err =       0.000546523844
             autocorr =       1.370152395979
   target nu stat err =       0.000546523844
   target dn stat err =       0.003366343721
      target stat err =       0.002843481319
              std dev =       0.660297532890
             le_variance =       0.435992831940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436094007524
                                         uncertainty =       0.002888703417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436094007524
                                         uncertainty =       0.002888703417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466900863
  error estimate for blocks of size 2^( 2) =       0.000492235728
  error estimate for blocks of size 2^( 3) =       0.000515495350
  error estimate for blocks of size 2^( 4) =       0.000533701752
  error estimate for blocks of size 2^( 5) =       0.000544930438
  error estimate for blocks of size 2^( 6) =       0.000551554905
  error estimate for blocks of size 2^( 7) =       0.000555908280

      target function =      -0.746661017227
              le_mean =     -22.813185169044
             les_mean =     520.889800207099
             stat err =       0.000546523844
             autocorr =       1.370152396733
   target nu stat err =       0.000546523844
   target dn stat err =       0.003366343794
      target stat err =       0.002843481379
              std dev =       0.660297532858
             le_variance =       0.435992831898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436094007545
                                         uncertainty =       0.002888703388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436094007545
                                         uncertainty =       0.002888703388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466900863
  error estimate for blocks of size 2^( 2) =       0.000492235728
  error estimate for blocks of size 2^( 3) =       0.000515495350
  error estimate for blocks of size 2^( 4) =       0.000533701752
  error estimate for blocks of size 2^( 5) =       0.000544930438
  error estimate for blocks of size 2^( 6) =       0.000551554905
  error estimate for blocks of size 2^( 7) =       0.000555908280

      target function =      -0.746661017123
              le_mean =     -22.813185169044
             les_mean =     520.889800207219
             stat err =       0.000546523844
             autocorr =       1.370152396372
   target nu stat err =       0.000546523844
   target dn stat err =       0.003366343758
      target stat err =       0.002843481349
              std dev =       0.660297532873
             le_variance =       0.435992831919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436094007563
                                         uncertainty =       0.002888703362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436094007563
                                         uncertainty =       0.002888703362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466900863
  error estimate for blocks of size 2^( 2) =       0.000492235728
  error estimate for blocks of size 2^( 3) =       0.000515495350
  error estimate for blocks of size 2^( 4) =       0.000533701752
  error estimate for blocks of size 2^( 5) =       0.000544930438
  error estimate for blocks of size 2^( 6) =       0.000551554905
  error estimate for blocks of size 2^( 7) =       0.000555908280

      target function =      -0.746661017032
              le_mean =     -22.813185169044
             les_mean =     520.889800207324
             stat err =       0.000546523844
             autocorr =       1.370152396033
   target nu stat err =       0.000546523844
   target dn stat err =       0.003366343726
      target stat err =       0.002843481322
              std dev =       0.660297532888
             le_variance =       0.435992831937


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746661017019        initial
     1.4552e+05     1.4552e+06             1.2678e-09        -0.746661017227  <--
     5.8208e+05     5.8208e+06             3.1696e-10        -0.746661017123
     2.3283e+06     2.3283e+07             7.9241e-11        -0.746661017032

*****************************************************************************
Applying the update for shift_i =   1.4552e+05     and shift_s =   1.4552e+06
*****************************************************************************

  Execution time = 7.2917e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685120e-04 3 1  ON 37
ci_39                -6.245854e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273533e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439396e-04 3 1  ON 50
ci_52                 8.068127e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525792e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428913e-04 3 1  ON 59
ci_61                -1.294345e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160593e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949578e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318188e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2671e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.84
    reference variance = 0.289449
====================================================
  Execution time = 4.4359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4205e-01
  Total weights = 1.964219254e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430556505355
                                         uncertainty =       0.001680832522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430556505355
                                         uncertainty =       0.001680832522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463990820
  error estimate for blocks of size 2^( 2) =       0.000489458982
  error estimate for blocks of size 2^( 3) =       0.000512539943
  error estimate for blocks of size 2^( 4) =       0.000529921579
  error estimate for blocks of size 2^( 5) =       0.000540363626
  error estimate for blocks of size 2^( 6) =       0.000546891702
  error estimate for blocks of size 2^( 7) =       0.000550734235

      target function =      -0.751959928291
              le_mean =     -22.815280048917
             les_mean =     520.979054521384
             stat err =       0.000541977786
             autocorr =       1.364407809224
   target nu stat err =       0.000541977786
   target dn stat err =       0.002904202621
      target stat err =       0.002512792633
              std dev =       0.656182110085
             le_variance =       0.430574961596


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281528004892e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751967375580       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751967375861       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751967375910       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751967375916       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751967375918       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751967375919       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751967375919       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751967375919       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751967376011       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 4.109999e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751967375580       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751967375650       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751967375662       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751967375664       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751967375665       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751967375665       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751967375665       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751967375665       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751967375665       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 1.027500e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751967375580       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751967375598       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751967375601       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751967375502       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751967375445       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751967375215       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751967374736       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751967375363       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751967374698       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 2.568752e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2256e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352747e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940907e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984872e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933019e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464090e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685116e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273531e-04 3 1  ON 44
ci_46                -8.694133e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119954e-04 3 1  ON 49
ci_51                 1.439396e-04 3 1  ON 50
ci_52                 8.068141e-05 3 1  ON 51
ci_53                -6.382747e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525792e-04 3 1  ON 54
ci_56                 2.626581e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428914e-04 3 1  ON 59
ci_61                -1.294342e-04 3 1  ON 60
ci_62                -6.662294e-04 3 1  ON 61
ci_63                -7.728496e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160598e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949577e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.83
    reference variance = 0.26819
====================================================
  Execution time = 4.3930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5260e-01
  Total weights = 1.9647e+06
  Execution time = 5.9437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062988990
                                         uncertainty =       0.002419619683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062988990
                                         uncertainty =       0.002419619683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467425638
  error estimate for blocks of size 2^( 2) =       0.000492870542
  error estimate for blocks of size 2^( 3) =       0.000516608498
  error estimate for blocks of size 2^( 4) =       0.000534490322
  error estimate for blocks of size 2^( 5) =       0.000544004322
  error estimate for blocks of size 2^( 6) =       0.000548659253
  error estimate for blocks of size 2^( 7) =       0.000550144965

      target function =      -0.743197552506
              le_mean =     -22.814670864503
             les_mean =     520.961805946232
             stat err =       0.000544324715
             autocorr =       1.356097920807
   target nu stat err =       0.000544324715
   target dn stat err =       0.003926436699
      target stat err =       0.003273458903
              std dev =       0.661039676173
             le_variance =       0.436973453475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062988109
                                         uncertainty =       0.002419619488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062988109
                                         uncertainty =       0.002419619488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467425637
  error estimate for blocks of size 2^( 2) =       0.000492870541
  error estimate for blocks of size 2^( 3) =       0.000516608497
  error estimate for blocks of size 2^( 4) =       0.000534490322
  error estimate for blocks of size 2^( 5) =       0.000544004322
  error estimate for blocks of size 2^( 6) =       0.000548659253
  error estimate for blocks of size 2^( 7) =       0.000550144965

      target function =      -0.743197547789
              le_mean =     -22.814670864493
             les_mean =     520.961805951540
             stat err =       0.000544324716
             autocorr =       1.356097923998
   target nu stat err =       0.000544324716
   target dn stat err =       0.003926436883
      target stat err =       0.003273459010
              std dev =       0.661039675507
             le_variance =       0.436973452594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062988549
                                         uncertainty =       0.002419619585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062988549
                                         uncertainty =       0.002419619585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467425637
  error estimate for blocks of size 2^( 2) =       0.000492870542
  error estimate for blocks of size 2^( 3) =       0.000516608497
  error estimate for blocks of size 2^( 4) =       0.000534490322
  error estimate for blocks of size 2^( 5) =       0.000544004322
  error estimate for blocks of size 2^( 6) =       0.000548659253
  error estimate for blocks of size 2^( 7) =       0.000550144965

      target function =      -0.743197550147
              le_mean =     -22.814670864498
             les_mean =     520.961805948886
             stat err =       0.000544324716
             autocorr =       1.356097922411
   target nu stat err =       0.000544324715
   target dn stat err =       0.003926436791
      target stat err =       0.003273458956
              std dev =       0.661039675840
             le_variance =       0.436973453035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062988935
                                         uncertainty =       0.002419619671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437062988935
                                         uncertainty =       0.002419619671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467425638
  error estimate for blocks of size 2^( 2) =       0.000492870542
  error estimate for blocks of size 2^( 3) =       0.000516608498
  error estimate for blocks of size 2^( 4) =       0.000534490322
  error estimate for blocks of size 2^( 5) =       0.000544004322
  error estimate for blocks of size 2^( 6) =       0.000548659253
  error estimate for blocks of size 2^( 7) =       0.000550144965

      target function =      -0.743197552211
              le_mean =     -22.814670864503
             les_mean =     520.961805946564
             stat err =       0.000544324715
             autocorr =       1.356097921007
   target nu stat err =       0.000544324715
   target dn stat err =       0.003926436711
      target stat err =       0.003273458909
              std dev =       0.661039676131
             le_variance =       0.436973453420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743197552506        initial  <--
     3.6380e+04     3.6380e+05             4.1100e-09        -0.743197547789
     1.4552e+05     1.4552e+06             1.0275e-09        -0.743197550147
     5.8208e+05     5.8208e+06             2.5688e-10        -0.743197552211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.9532
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685120e-04 3 1  ON 37
ci_39                -6.245854e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273533e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439396e-04 3 1  ON 50
ci_52                 8.068127e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525792e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428913e-04 3 1  ON 59
ci_61                -1.294345e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160593e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949578e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318188e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2622e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8783
    reference variance = 0.840541
====================================================
  Execution time = 4.4037e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4274e-01
  Total weights = 1.964190479e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431692630232
                                         uncertainty =       0.001759554864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431692630232
                                         uncertainty =       0.001759554864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464589898
  error estimate for blocks of size 2^( 2) =       0.000490009322
  error estimate for blocks of size 2^( 3) =       0.000513926652
  error estimate for blocks of size 2^( 4) =       0.000530989559
  error estimate for blocks of size 2^( 5) =       0.000542695930
  error estimate for blocks of size 2^( 6) =       0.000547209352
  error estimate for blocks of size 2^( 7) =       0.000549543475

      target function =      -0.751391860633
              le_mean =     -22.815703490658
             les_mean =     520.999063575763
             stat err =       0.000542609579
             autocorr =       1.364066012003
   target nu stat err =       0.000542609579
   target dn stat err =       0.002317750686
      target stat err =       0.002036812641
              std dev =       0.657029335031
             le_variance =       0.431687547091


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281570349066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751396386556       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751396386579       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751396386581       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751396386582       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751396386545       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751396386481       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751396385914       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751396386687       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751396386889       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 4.265084e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751396386556       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751396386562       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751396386563       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751396386563       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751396386482       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751396388598       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751396386140       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751396382698       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751396386563       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 1.066270e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751396386556       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751396386558       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751396386558       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751396386558       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751396386138       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751396384156       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751396394252       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751396390464       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751396387499       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 2.665685e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1841e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833662e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245854e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439396e-04 3 1  ON 50
ci_52                 8.068126e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428913e-04 3 1  ON 59
ci_61                -1.294345e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160596e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949578e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318188e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8122
    reference variance = 0.281817
====================================================
  Execution time = 4.3986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4669e-01
  Total weights = 1.9641e+06
  Execution time = 6.0751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552108213
                                         uncertainty =       0.002048715547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552108213
                                         uncertainty =       0.002048715547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466647341
  error estimate for blocks of size 2^( 2) =       0.000492177801
  error estimate for blocks of size 2^( 3) =       0.000516221148
  error estimate for blocks of size 2^( 4) =       0.000533979516
  error estimate for blocks of size 2^( 5) =       0.000544457239
  error estimate for blocks of size 2^( 6) =       0.000551243881
  error estimate for blocks of size 2^( 7) =       0.000550921290

      target function =      -0.748069416359
              le_mean =     -22.813939064039
             les_mean =     520.922510209194
             stat err =       0.000545150481
             autocorr =       1.364756619865
   target nu stat err =       0.000545150481
   target dn stat err =       0.002621781468
      target stat err =       0.002257029909
              std dev =       0.659938997983
             le_variance =       0.435519481059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552108161
                                         uncertainty =       0.002048715545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552108161
                                         uncertainty =       0.002048715545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466647341
  error estimate for blocks of size 2^( 2) =       0.000492177801
  error estimate for blocks of size 2^( 3) =       0.000516221148
  error estimate for blocks of size 2^( 4) =       0.000533979516
  error estimate for blocks of size 2^( 5) =       0.000544457239
  error estimate for blocks of size 2^( 6) =       0.000551243881
  error estimate for blocks of size 2^( 7) =       0.000550921290

      target function =      -0.748069416448
              le_mean =     -22.813939064037
             les_mean =     520.922510209005
             stat err =       0.000545150481
             autocorr =       1.364756620097
   target nu stat err =       0.000545150481
   target dn stat err =       0.002621781466
      target stat err =       0.002257029907
              std dev =       0.659938997943
             le_variance =       0.435519481006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552108187
                                         uncertainty =       0.002048715546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552108187
                                         uncertainty =       0.002048715546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466647341
  error estimate for blocks of size 2^( 2) =       0.000492177801
  error estimate for blocks of size 2^( 3) =       0.000516221148
  error estimate for blocks of size 2^( 4) =       0.000533979516
  error estimate for blocks of size 2^( 5) =       0.000544457239
  error estimate for blocks of size 2^( 6) =       0.000551243881
  error estimate for blocks of size 2^( 7) =       0.000550921290

      target function =      -0.748069416403
              le_mean =     -22.813939064038
             les_mean =     520.922510209099
             stat err =       0.000545150481
             autocorr =       1.364756619984
   target nu stat err =       0.000545150481
   target dn stat err =       0.002621781467
      target stat err =       0.002257029908
              std dev =       0.659938997963
             le_variance =       0.435519481033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552108210
                                         uncertainty =       0.002048715547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552108210
                                         uncertainty =       0.002048715547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466647341
  error estimate for blocks of size 2^( 2) =       0.000492177801
  error estimate for blocks of size 2^( 3) =       0.000516221148
  error estimate for blocks of size 2^( 4) =       0.000533979516
  error estimate for blocks of size 2^( 5) =       0.000544457239
  error estimate for blocks of size 2^( 6) =       0.000551243881
  error estimate for blocks of size 2^( 7) =       0.000550921290

      target function =      -0.748069416364
              le_mean =     -22.813939064039
             les_mean =     520.922510209182
             stat err =       0.000545150481
             autocorr =       1.364756619883
   target nu stat err =       0.000545150481
   target dn stat err =       0.002621781468
      target stat err =       0.002257029909
              std dev =       0.659938997981
             le_variance =       0.435519481056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748069416359        initial
     3.6380e+05     3.6380e+06             4.2651e-10        -0.748069416448  <--
     1.4552e+06     1.4552e+07             1.0663e-10        -0.748069416403
     5.8208e+06     5.8208e+07             2.6657e-11        -0.748069416364

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 7.4061e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160605e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2613e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.9406
    reference variance = 4.36268
====================================================
  Execution time = 4.3920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4695e-01
  Total weights = 1.964285122e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966114351
                                         uncertainty =       0.001976657169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966114351
                                         uncertainty =       0.001976657169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466970909
  error estimate for blocks of size 2^( 2) =       0.000492370258
  error estimate for blocks of size 2^( 3) =       0.000516404360
  error estimate for blocks of size 2^( 4) =       0.000534728722
  error estimate for blocks of size 2^( 5) =       0.000544829404
  error estimate for blocks of size 2^( 6) =       0.000550257616
  error estimate for blocks of size 2^( 7) =       0.000553664313

      target function =      -0.747850915882
              le_mean =     -22.813498159142
             les_mean =     520.902651049256
             stat err =       0.000545870014
             autocorr =       1.366465977201
   target nu stat err =       0.000545870014
   target dn stat err =       0.002583340925
      target stat err =       0.002223837454
              std dev =       0.660396593083
             le_variance =       0.436123660156


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281349815914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747856524469       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747856524559       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747856524572       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747856524575       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747856524531       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747856524572       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747856524497       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747856524628       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747856524420       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747856524502       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+04 is 1.435114e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747856524469       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747856524492       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747856524495       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747856524496       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747856524461       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747856524626       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747856524230       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747856524279       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747856524366       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747856524025       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 3.587785e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747856524469       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747856524475       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747856524476       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747856524822       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747856524475       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747856524476       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747856523833       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747856524542       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747856525481       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747856527591       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 8.969456e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1690e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299882e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464092e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245852e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068132e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428914e-04 3 1  ON 59
ci_61                -1.294342e-04 3 1  ON 60
ci_62                -6.662295e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632742e-04 3 1  ON 63
ci_65                 6.160610e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949578e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.908
    reference variance = 0.686837
====================================================
  Execution time = 4.2517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4637e-01
  Total weights = 1.9641e+06
  Execution time = 5.9383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434275656059
                                         uncertainty =       0.001867866870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434275656059
                                         uncertainty =       0.001867866870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465943949
  error estimate for blocks of size 2^( 2) =       0.000491237923
  error estimate for blocks of size 2^( 3) =       0.000514782102
  error estimate for blocks of size 2^( 4) =       0.000531972254
  error estimate for blocks of size 2^( 5) =       0.000542740951
  error estimate for blocks of size 2^( 6) =       0.000549008570
  error estimate for blocks of size 2^( 7) =       0.000551378451

      target function =      -0.748347978614
              le_mean =     -22.814941386291
             les_mean =     520.967920950471
             stat err =       0.000543775057
             autocorr =       1.361981511750
   target nu stat err =       0.000543775057
   target dn stat err =       0.002694084747
      target stat err =       0.002319580790
              std dev =       0.658944251984
             le_variance =       0.434207527223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434275655949
                                         uncertainty =       0.001867866858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434275655949
                                         uncertainty =       0.001867866858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465943949
  error estimate for blocks of size 2^( 2) =       0.000491237923
  error estimate for blocks of size 2^( 3) =       0.000514782102
  error estimate for blocks of size 2^( 4) =       0.000531972254
  error estimate for blocks of size 2^( 5) =       0.000542740952
  error estimate for blocks of size 2^( 6) =       0.000549008570
  error estimate for blocks of size 2^( 7) =       0.000551378451

      target function =      -0.748347974615
              le_mean =     -22.814941386308
             les_mean =     520.967920956032
             stat err =       0.000543775057
             autocorr =       1.361981512634
   target nu stat err =       0.000543775057
   target dn stat err =       0.002694084734
      target stat err =       0.002319580755
              std dev =       0.658944251900
             le_variance =       0.434207527112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434275656004
                                         uncertainty =       0.001867866864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434275656004
                                         uncertainty =       0.001867866864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465943949
  error estimate for blocks of size 2^( 2) =       0.000491237923
  error estimate for blocks of size 2^( 3) =       0.000514782102
  error estimate for blocks of size 2^( 4) =       0.000531972254
  error estimate for blocks of size 2^( 5) =       0.000542740951
  error estimate for blocks of size 2^( 6) =       0.000549008570
  error estimate for blocks of size 2^( 7) =       0.000551378451

      target function =      -0.748347976615
              le_mean =     -22.814941386299
             les_mean =     520.967920953251
             stat err =       0.000543775057
             autocorr =       1.361981512207
   target nu stat err =       0.000543775057
   target dn stat err =       0.002694084741
      target stat err =       0.002319580772
              std dev =       0.658944251942
             le_variance =       0.434207527168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434275656052
                                         uncertainty =       0.001867866869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434275656052
                                         uncertainty =       0.001867866869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465943949
  error estimate for blocks of size 2^( 2) =       0.000491237923
  error estimate for blocks of size 2^( 3) =       0.000514782102
  error estimate for blocks of size 2^( 4) =       0.000531972254
  error estimate for blocks of size 2^( 5) =       0.000542740951
  error estimate for blocks of size 2^( 6) =       0.000549008570
  error estimate for blocks of size 2^( 7) =       0.000551378451

      target function =      -0.748347978364
              le_mean =     -22.814941386292
             les_mean =     520.967920950819
             stat err =       0.000543775057
             autocorr =       1.361981511810
   target nu stat err =       0.000543775057
   target dn stat err =       0.002694084746
      target stat err =       0.002319580787
              std dev =       0.658944251979
             le_variance =       0.434207527216


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748347978614        initial  <--
     9.0949e+04     9.0949e+05             1.4351e-09        -0.748347974615
     3.6380e+05     3.6380e+06             3.5878e-10        -0.748347976615
     1.4552e+06     1.4552e+07             8.9695e-11        -0.748347978364

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.0039
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160605e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2489e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.7787
    reference variance = 0.399313
====================================================
  Execution time = 4.4286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.6429e-01
  Total weights = 1.964408092e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.0356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436569399906
                                         uncertainty =       0.002237070980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436569399906
                                         uncertainty =       0.002237070980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467167075
  error estimate for blocks of size 2^( 2) =       0.000492721665
  error estimate for blocks of size 2^( 3) =       0.000516724643
  error estimate for blocks of size 2^( 4) =       0.000534692378
  error estimate for blocks of size 2^( 5) =       0.000545528413
  error estimate for blocks of size 2^( 6) =       0.000552190530
  error estimate for blocks of size 2^( 7) =       0.000554142639

      target function =      -0.733583875015
              le_mean =     -22.815785302631
             les_mean =     521.024353380478
             stat err =       0.000546638490
             autocorr =       1.369165544838
   target nu stat err =       0.000546638490
   target dn stat err =       0.013158603440
      target stat err =       0.010543306687
              std dev =       0.660674014058
             le_variance =       0.436490152851


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281578530263e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733734085367       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733734085382       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.733734085384       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.733734085306       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.733734085461       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.733734085285       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.733734084796       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.733734085418       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.733734086734       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+05 is 2.481688e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733734085367       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733734085371       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.733734085371       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.733734085371       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.733734085448       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.733734085954       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.733734085852       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.733734085207       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.733734086535       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 6.204221e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733734085367       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733734085368       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.733734085368       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.733734089021       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.733734083624       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.733734077759       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.733734092393       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.733734099435       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.733734114523       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 1.551064e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2338e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068124e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428913e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.859
    reference variance = 0.346845
====================================================
  Execution time = 4.2609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5111e-01
  Total weights = 1.9644e+06
  Execution time = 6.0389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438445681747
                                         uncertainty =       0.005836118830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438445681747
                                         uncertainty =       0.005836118830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468196462
  error estimate for blocks of size 2^( 2) =       0.000493856596
  error estimate for blocks of size 2^( 3) =       0.000517702802
  error estimate for blocks of size 2^( 4) =       0.000536327041
  error estimate for blocks of size 2^( 5) =       0.000546801471
  error estimate for blocks of size 2^( 6) =       0.000552105030
  error estimate for blocks of size 2^( 7) =       0.000556142472

      target function =      -0.744398615613
              le_mean =     -22.814501595898
             les_mean =     520.952597683159
             stat err =       0.000547844003
             autocorr =       1.369170614454
   target nu stat err =       0.000547844003
   target dn stat err =       0.005912260882
      target stat err =       0.004897531183
              std dev =       0.662129786353
             le_variance =       0.438415853975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438445681743
                                         uncertainty =       0.005836118832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438445681743
                                         uncertainty =       0.005836118832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468196462
  error estimate for blocks of size 2^( 2) =       0.000493856596
  error estimate for blocks of size 2^( 3) =       0.000517702802
  error estimate for blocks of size 2^( 4) =       0.000536327041
  error estimate for blocks of size 2^( 5) =       0.000546801471
  error estimate for blocks of size 2^( 6) =       0.000552105030
  error estimate for blocks of size 2^( 7) =       0.000556142472

      target function =      -0.744398614625
              le_mean =     -22.814501595898
             les_mean =     520.952597684340
             stat err =       0.000547844003
             autocorr =       1.369170614526
   target nu stat err =       0.000547844003
   target dn stat err =       0.005912260884
      target stat err =       0.004897531171
              std dev =       0.662129786349
             le_variance =       0.438415853971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438445681745
                                         uncertainty =       0.005836118831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438445681745
                                         uncertainty =       0.005836118831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468196462
  error estimate for blocks of size 2^( 2) =       0.000493856596
  error estimate for blocks of size 2^( 3) =       0.000517702802
  error estimate for blocks of size 2^( 4) =       0.000536327041
  error estimate for blocks of size 2^( 5) =       0.000546801471
  error estimate for blocks of size 2^( 6) =       0.000552105030
  error estimate for blocks of size 2^( 7) =       0.000556142472

      target function =      -0.744398615119
              le_mean =     -22.814501595898
             les_mean =     520.952597683749
             stat err =       0.000547844003
             autocorr =       1.369170614495
   target nu stat err =       0.000547844003
   target dn stat err =       0.005912260883
      target stat err =       0.004897531177
              std dev =       0.662129786351
             le_variance =       0.438415853973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438445681747
                                         uncertainty =       0.005836118830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438445681747
                                         uncertainty =       0.005836118830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468196462
  error estimate for blocks of size 2^( 2) =       0.000493856596
  error estimate for blocks of size 2^( 3) =       0.000517702802
  error estimate for blocks of size 2^( 4) =       0.000536327041
  error estimate for blocks of size 2^( 5) =       0.000546801471
  error estimate for blocks of size 2^( 6) =       0.000552105030
  error estimate for blocks of size 2^( 7) =       0.000556142472

      target function =      -0.744398615551
              le_mean =     -22.814501595898
             les_mean =     520.952597683232
             stat err =       0.000547844003
             autocorr =       1.369170614470
   target nu stat err =       0.000547844003
   target dn stat err =       0.005912260882
      target stat err =       0.004897531182
              std dev =       0.662129786352
             le_variance =       0.438415853975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744398615613        initial  <--
     9.0949e+05     9.0949e+06             2.4817e-10        -0.744398614625
     3.6380e+06     3.6380e+07             6.2042e-11        -0.744398615119
     1.4552e+07     1.4552e+08             1.5511e-11        -0.744398615551

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.0249
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160605e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2540e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7218
    reference variance = 0.56082
====================================================
  Execution time = 4.5990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4999e-01
  Total weights = 1.964293268e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436482110913
                                         uncertainty =       0.002699283505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436482110913
                                         uncertainty =       0.002699283505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467150726
  error estimate for blocks of size 2^( 2) =       0.000492124799
  error estimate for blocks of size 2^( 3) =       0.000515848067
  error estimate for blocks of size 2^( 4) =       0.000533746473
  error estimate for blocks of size 2^( 5) =       0.000543798259
  error estimate for blocks of size 2^( 6) =       0.000550173714
  error estimate for blocks of size 2^( 7) =       0.000554310055

      target function =      -0.745342799520
              le_mean =     -22.814533696320
             les_mean =     520.952932876162
             stat err =       0.000545507125
             autocorr =       1.363599395201
   target nu stat err =       0.000545507125
   target dn stat err =       0.004351930266
      target stat err =       0.003636941150
              std dev =       0.660650891744
             le_variance =       0.436459600762


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281453369632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745359410568       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745359410572       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745359410572       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745359414255       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745359417902       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745359408071       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745359430367       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745359415440       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745359390903       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745359449943       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+06 is 2.674941e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745359410568       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745359410569       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745359410569       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745359413737       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745359424190       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745359387481       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745359421870       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745359427394       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745359485477       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745359420825       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+07 is 6.687347e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745359410568       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745359410569       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745359410569       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745359418909       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745359458015       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745359442829       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745359470725       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745359280361       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745359546350       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745359451598       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+08 is 1.671806e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3895e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.9065
    reference variance = 0.938529
====================================================
  Execution time = 4.2852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4751e-01
  Total weights = 1.9643e+06
  Execution time = 5.9724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434357464763
                                         uncertainty =       0.002253513975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434357464763
                                         uncertainty =       0.002253513975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466061487
  error estimate for blocks of size 2^( 2) =       0.000491221232
  error estimate for blocks of size 2^( 3) =       0.000514572952
  error estimate for blocks of size 2^( 4) =       0.000532359323
  error estimate for blocks of size 2^( 5) =       0.000544426774
  error estimate for blocks of size 2^( 6) =       0.000551407932
  error estimate for blocks of size 2^( 7) =       0.000557482673

      target function =      -0.747388492154
              le_mean =     -22.813433042503
             les_mean =     520.900235241865
             stat err =       0.000546419176
             autocorr =       1.374565471491
   target nu stat err =       0.000546419176
   target dn stat err =       0.002997933395
      target stat err =       0.002552888060
              std dev =       0.659110475821
             le_variance =       0.434426619337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434357464761
                                         uncertainty =       0.002253513974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434357464761
                                         uncertainty =       0.002253513974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466061487
  error estimate for blocks of size 2^( 2) =       0.000491221232
  error estimate for blocks of size 2^( 3) =       0.000514572952
  error estimate for blocks of size 2^( 4) =       0.000532359323
  error estimate for blocks of size 2^( 5) =       0.000544426774
  error estimate for blocks of size 2^( 6) =       0.000551407932
  error estimate for blocks of size 2^( 7) =       0.000557482673

      target function =      -0.747388492158
              le_mean =     -22.813433042503
             les_mean =     520.900235241861
             stat err =       0.000546419176
             autocorr =       1.374565471515
   target nu stat err =       0.000546419176
   target dn stat err =       0.002997933394
      target stat err =       0.002552888060
              std dev =       0.659110475819
             le_variance =       0.434426619335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434357464762
                                         uncertainty =       0.002253513975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434357464762
                                         uncertainty =       0.002253513975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466061487
  error estimate for blocks of size 2^( 2) =       0.000491221232
  error estimate for blocks of size 2^( 3) =       0.000514572952
  error estimate for blocks of size 2^( 4) =       0.000532359323
  error estimate for blocks of size 2^( 5) =       0.000544426774
  error estimate for blocks of size 2^( 6) =       0.000551407932
  error estimate for blocks of size 2^( 7) =       0.000557482673

      target function =      -0.747388492156
              le_mean =     -22.813433042503
             les_mean =     520.900235241863
             stat err =       0.000546419176
             autocorr =       1.374565471503
   target nu stat err =       0.000546419176
   target dn stat err =       0.002997933395
      target stat err =       0.002552888060
              std dev =       0.659110475820
             le_variance =       0.434426619336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434357464763
                                         uncertainty =       0.002253513975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434357464763
                                         uncertainty =       0.002253513975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466061487
  error estimate for blocks of size 2^( 2) =       0.000491221232
  error estimate for blocks of size 2^( 3) =       0.000514572952
  error estimate for blocks of size 2^( 4) =       0.000532359323
  error estimate for blocks of size 2^( 5) =       0.000544426774
  error estimate for blocks of size 2^( 6) =       0.000551407932
  error estimate for blocks of size 2^( 7) =       0.000557482673

      target function =      -0.747388492154
              le_mean =     -22.813433042503
             les_mean =     520.900235241865
             stat err =       0.000546419176
             autocorr =       1.374565471495
   target nu stat err =       0.000546419176
   target dn stat err =       0.002997933395
      target stat err =       0.002552888060
              std dev =       0.659110475821
             le_variance =       0.434426619337


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747388492154        initial
     9.0949e+06     9.0949e+07             2.6749e-11        -0.747388492158  <--
     3.6380e+07     3.6380e+08             6.6873e-12        -0.747388492156
     1.4552e+08     1.4552e+09             1.6718e-12        -0.747388492154

*****************************************************************************
Applying the update for shift_i =   9.0949e+06     and shift_s =   9.0949e+07
*****************************************************************************

  Execution time = 7.3093e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2701e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7886
    reference variance = 0.27392
====================================================
  Execution time = 4.5704e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4702e-01
  Total weights = 1.964646333e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432700432820
                                         uncertainty =       0.001996569328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432700432820
                                         uncertainty =       0.001996569328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465142649
  error estimate for blocks of size 2^( 2) =       0.000490166206
  error estimate for blocks of size 2^( 3) =       0.000513926599
  error estimate for blocks of size 2^( 4) =       0.000531982268
  error estimate for blocks of size 2^( 5) =       0.000542354224
  error estimate for blocks of size 2^( 6) =       0.000549295983
  error estimate for blocks of size 2^( 7) =       0.000552769920

      target function =      -0.747793534384
              le_mean =     -22.814162028811
             les_mean =     520.933008497260
             stat err =       0.000544100599
             autocorr =       1.368314988465
   target nu stat err =       0.000544100599
   target dn stat err =       0.004052352093
      target stat err =       0.003413548064
              std dev =       0.657811042404
             le_variance =       0.432715367509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281416202881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747808129728       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747808129734       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747808129735       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747808129735       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747808129746       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747808128327       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747808131406       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747808133006       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747808125636       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747808133312       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+06 is 8.022388e-11

solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747808129728       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747808129730       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747808129730       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747808129730       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747808129728       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747808128627       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747808117025       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747808130465       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747808134047       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747808115901       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+06 is 2.005604e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747808129728       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747808129729       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747808129729       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747808124212       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747808129729       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747808132169       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747808156640       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747808158510       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747808165731       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747808141799       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+07 is 5.014076e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3573e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160605e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.9008
    reference variance = 0.50745
====================================================
  Execution time = 4.2561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5086e-01
  Total weights = 1.9642e+06
  Execution time = 6.0664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438852928402
                                         uncertainty =       0.002678074544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438852928402
                                         uncertainty =       0.002678074544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468462443
  error estimate for blocks of size 2^( 2) =       0.000493467818
  error estimate for blocks of size 2^( 3) =       0.000517029087
  error estimate for blocks of size 2^( 4) =       0.000534792096
  error estimate for blocks of size 2^( 5) =       0.000546281245
  error estimate for blocks of size 2^( 6) =       0.000552576610
  error estimate for blocks of size 2^( 7) =       0.000556350900

      target function =      -0.744633621297
              le_mean =     -22.815841232765
             les_mean =     521.013472382902
             stat err =       0.000547500213
             autocorr =       1.365900384920
   target nu stat err =       0.000547500213
   target dn stat err =       0.003178420474
      target stat err =       0.002688692450
              std dev =       0.662505939976
             le_variance =       0.438914120503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438852928386
                                         uncertainty =       0.002678074540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438852928386
                                         uncertainty =       0.002678074540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468462443
  error estimate for blocks of size 2^( 2) =       0.000493467818
  error estimate for blocks of size 2^( 3) =       0.000517029087
  error estimate for blocks of size 2^( 4) =       0.000534792096
  error estimate for blocks of size 2^( 5) =       0.000546281245
  error estimate for blocks of size 2^( 6) =       0.000552576610
  error estimate for blocks of size 2^( 7) =       0.000556350900

      target function =      -0.744633620972
              le_mean =     -22.815841232765
             les_mean =     521.013472383289
             stat err =       0.000547500213
             autocorr =       1.365900384973
   target nu stat err =       0.000547500213
   target dn stat err =       0.003178420471
      target stat err =       0.002688692445
              std dev =       0.662505939963
             le_variance =       0.438914120486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438852928394
                                         uncertainty =       0.002678074542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438852928394
                                         uncertainty =       0.002678074542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468462443
  error estimate for blocks of size 2^( 2) =       0.000493467818
  error estimate for blocks of size 2^( 3) =       0.000517029087
  error estimate for blocks of size 2^( 4) =       0.000534792096
  error estimate for blocks of size 2^( 5) =       0.000546281245
  error estimate for blocks of size 2^( 6) =       0.000552576610
  error estimate for blocks of size 2^( 7) =       0.000556350900

      target function =      -0.744633621134
              le_mean =     -22.815841232765
             les_mean =     521.013472383095
             stat err =       0.000547500213
             autocorr =       1.365900384944
   target nu stat err =       0.000547500213
   target dn stat err =       0.003178420472
      target stat err =       0.002688692447
              std dev =       0.662505939970
             le_variance =       0.438914120495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438852928401
                                         uncertainty =       0.002678074544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438852928401
                                         uncertainty =       0.002678074544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468462443
  error estimate for blocks of size 2^( 2) =       0.000493467818
  error estimate for blocks of size 2^( 3) =       0.000517029087
  error estimate for blocks of size 2^( 4) =       0.000534792096
  error estimate for blocks of size 2^( 5) =       0.000546281245
  error estimate for blocks of size 2^( 6) =       0.000552576610
  error estimate for blocks of size 2^( 7) =       0.000556350900

      target function =      -0.744633621276
              le_mean =     -22.815841232765
             les_mean =     521.013472382926
             stat err =       0.000547500213
             autocorr =       1.365900384920
   target nu stat err =       0.000547500213
   target dn stat err =       0.003178420474
      target stat err =       0.002688692450
              std dev =       0.662505939975
             le_variance =       0.438914120502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744633621297        initial  <--
     2.2737e+06     2.2737e+07             8.0224e-11        -0.744633620972
     9.0949e+06     9.0949e+07             2.0056e-11        -0.744633621134
     3.6380e+07     3.6380e+08             5.0141e-12        -0.744633621276

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.9293
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2697e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8682
    reference variance = 0.247568
====================================================
  Execution time = 4.3790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4632e-01
  Total weights = 1.964272901e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435831572681
                                         uncertainty =       0.002729671038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435831572681
                                         uncertainty =       0.002729671038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466822972
  error estimate for blocks of size 2^( 2) =       0.000492659122
  error estimate for blocks of size 2^( 3) =       0.000516480362
  error estimate for blocks of size 2^( 4) =       0.000533762022
  error estimate for blocks of size 2^( 5) =       0.000546229017
  error estimate for blocks of size 2^( 6) =       0.000551498373
  error estimate for blocks of size 2^( 7) =       0.000556238319

      target function =      -0.748376842009
              le_mean =     -22.814019114876
             les_mean =     520.925790675823
             stat err =       0.000546931933
             autocorr =       1.372657292822
   target nu stat err =       0.000546931933
   target dn stat err =       0.003062055313
      target stat err =       0.002613564964
              std dev =       0.660187378889
             le_variance =       0.435847375244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281401911488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748384879604       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748384879605       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748384879605       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748384879605       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748384879605       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748384879605       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748384879605       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748384879605       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748384879605       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+07 is 1.016339e-11

solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748384879604       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748384879605       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748384879605       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748384879605       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748384879605       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748384945664       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748384980343       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748384879605       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748384771851       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+07 is 2.540844e-12

solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748384879604       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748384879605       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748384879605       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748384879605       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748384879605       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748384879605       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748384879605       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748384926218       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748384879605       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+08 is 6.352056e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298966 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1681e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8337
    reference variance = 0.337881
====================================================
  Execution time = 4.4915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4788e-01
  Total weights = 1.9643e+06
  Execution time = 5.9602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436500951960
                                         uncertainty =       0.002498543569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436500951960
                                         uncertainty =       0.002498543569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467172555
  error estimate for blocks of size 2^( 2) =       0.000492702703
  error estimate for blocks of size 2^( 3) =       0.000516451782
  error estimate for blocks of size 2^( 4) =       0.000534405634
  error estimate for blocks of size 2^( 5) =       0.000545726302
  error estimate for blocks of size 2^( 6) =       0.000552782533
  error estimate for blocks of size 2^( 7) =       0.000556500504

      target function =      -0.747100217061
              le_mean =     -22.815223830211
             les_mean =     520.982313907836
             stat err =       0.000547353743
             autocorr =       1.372718673004
   target nu stat err =       0.000547353743
   target dn stat err =       0.002873773428
      target stat err =       0.002458153671
              std dev =       0.660681763882
             le_variance =       0.436500393127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436500951959
                                         uncertainty =       0.002498543569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436500951959
                                         uncertainty =       0.002498543569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467172555
  error estimate for blocks of size 2^( 2) =       0.000492702703
  error estimate for blocks of size 2^( 3) =       0.000516451782
  error estimate for blocks of size 2^( 4) =       0.000534405634
  error estimate for blocks of size 2^( 5) =       0.000545726302
  error estimate for blocks of size 2^( 6) =       0.000552782533
  error estimate for blocks of size 2^( 7) =       0.000556500504

      target function =      -0.747100217068
              le_mean =     -22.815223830211
             les_mean =     520.982313907826
             stat err =       0.000547353743
             autocorr =       1.372718673014
   target nu stat err =       0.000547353743
   target dn stat err =       0.002873773427
      target stat err =       0.002458153670
              std dev =       0.660681763881
             le_variance =       0.436500393126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436500951960
                                         uncertainty =       0.002498543569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436500951960
                                         uncertainty =       0.002498543569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467172555
  error estimate for blocks of size 2^( 2) =       0.000492702703
  error estimate for blocks of size 2^( 3) =       0.000516451782
  error estimate for blocks of size 2^( 4) =       0.000534405634
  error estimate for blocks of size 2^( 5) =       0.000545726302
  error estimate for blocks of size 2^( 6) =       0.000552782533
  error estimate for blocks of size 2^( 7) =       0.000556500504

      target function =      -0.747100217065
              le_mean =     -22.815223830211
             les_mean =     520.982313907831
             stat err =       0.000547353743
             autocorr =       1.372718673006
   target nu stat err =       0.000547353743
   target dn stat err =       0.002873773428
      target stat err =       0.002458153671
              std dev =       0.660681763882
             le_variance =       0.436500393126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436500951960
                                         uncertainty =       0.002498543569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436500951960
                                         uncertainty =       0.002498543569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467172555
  error estimate for blocks of size 2^( 2) =       0.000492702703
  error estimate for blocks of size 2^( 3) =       0.000516451782
  error estimate for blocks of size 2^( 4) =       0.000534405634
  error estimate for blocks of size 2^( 5) =       0.000545726302
  error estimate for blocks of size 2^( 6) =       0.000552782533
  error estimate for blocks of size 2^( 7) =       0.000556500504

      target function =      -0.747100217061
              le_mean =     -22.815223830211
             les_mean =     520.982313907836
             stat err =       0.000547353743
             autocorr =       1.372718672995
   target nu stat err =       0.000547353743
   target dn stat err =       0.002873773428
      target stat err =       0.002458153671
              std dev =       0.660681763882
             le_variance =       0.436500393127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747100217061        initial
     2.2737e+07     2.2737e+08             1.0163e-11        -0.747100217068  <--
     9.0949e+07     9.0949e+08             2.5408e-12        -0.747100217065
     3.6380e+08     3.6380e+09             6.3521e-13        -0.747100217061

*****************************************************************************
Applying the update for shift_i =   2.2737e+07     and shift_s =   2.2737e+08
*****************************************************************************

  Execution time = 7.4851e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2697e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8912
    reference variance = 0.395666
====================================================
  Execution time = 4.4097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4823e-01
  Total weights = 1.964501337e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436978434031
                                         uncertainty =       0.002081519168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436978434031
                                         uncertainty =       0.002081519168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467424023
  error estimate for blocks of size 2^( 2) =       0.000492800921
  error estimate for blocks of size 2^( 3) =       0.000517062398
  error estimate for blocks of size 2^( 4) =       0.000535080658
  error estimate for blocks of size 2^( 5) =       0.000545606321
  error estimate for blocks of size 2^( 6) =       0.000553516837
  error estimate for blocks of size 2^( 7) =       0.000559956820

      target function =      -0.746805618478
              le_mean =     -22.814525422989
             les_mean =     520.950796455791
             stat err =       0.000548540159
             autocorr =       1.377192974813
   target nu stat err =       0.000548540159
   target dn stat err =       0.002708636539
      target stat err =       0.002321927770
              std dev =       0.661037392080
             le_variance =       0.436970433727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281452542299e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746811789860       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746811789863       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746811789863       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746811789863       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746811789863       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746811789863       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746811789863       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746811789863       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746811789863       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746811786420       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+06 is 2.634911e-11

solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746811789860       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746811789861       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746811789861       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746811789861       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746811789861       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746811789861       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746811789861       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746811789861       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746811839139       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746811789861       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+07 is 6.587280e-12

solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746811789860       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746811789861       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746811789861       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746811790772       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746811821483       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746811807695       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746812019486       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746811934887       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746811582393       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746811791710       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+07 is 1.646840e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1982e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8209
    reference variance = 0.319719
====================================================
  Execution time = 4.4233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6520e-01
  Total weights = 1.9645e+06
  Execution time = 5.9386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525316199
                                         uncertainty =       0.007299619893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525316199
                                         uncertainty =       0.007299619893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470891352
  error estimate for blocks of size 2^( 2) =       0.000495936741
  error estimate for blocks of size 2^( 3) =       0.000519930777
  error estimate for blocks of size 2^( 4) =       0.000537530460
  error estimate for blocks of size 2^( 5) =       0.000548684565
  error estimate for blocks of size 2^( 6) =       0.000553030241
  error estimate for blocks of size 2^( 7) =       0.000555121354

      target function =      -0.732767862003
              le_mean =     -22.814618155434
             les_mean =     520.971996672851
             stat err =       0.000548591655
             autocorr =       1.357240980682
   target nu stat err =       0.000548591655
   target dn stat err =       0.017458188980
      target stat err =       0.013925702174
              std dev =       0.665940936806
             le_variance =       0.443477331314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525316206
                                         uncertainty =       0.007299619901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525316206
                                         uncertainty =       0.007299619901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470891352
  error estimate for blocks of size 2^( 2) =       0.000495936741
  error estimate for blocks of size 2^( 3) =       0.000519930777
  error estimate for blocks of size 2^( 4) =       0.000537530460
  error estimate for blocks of size 2^( 5) =       0.000548684565
  error estimate for blocks of size 2^( 6) =       0.000553030241
  error estimate for blocks of size 2^( 7) =       0.000555121354

      target function =      -0.732767862000
              le_mean =     -22.814618155434
             les_mean =     520.971996672850
             stat err =       0.000548591655
             autocorr =       1.357240980689
   target nu stat err =       0.000548591655
   target dn stat err =       0.017458188999
      target stat err =       0.013925702189
              std dev =       0.665940936811
             le_variance =       0.443477331321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525316202
                                         uncertainty =       0.007299619897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525316202
                                         uncertainty =       0.007299619897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470891352
  error estimate for blocks of size 2^( 2) =       0.000495936741
  error estimate for blocks of size 2^( 3) =       0.000519930777
  error estimate for blocks of size 2^( 4) =       0.000537530460
  error estimate for blocks of size 2^( 5) =       0.000548684565
  error estimate for blocks of size 2^( 6) =       0.000553030241
  error estimate for blocks of size 2^( 7) =       0.000555121354

      target function =      -0.732767862002
              le_mean =     -22.814618155434
             les_mean =     520.971996672851
             stat err =       0.000548591655
             autocorr =       1.357240980693
   target nu stat err =       0.000548591655
   target dn stat err =       0.017458188990
      target stat err =       0.013925702181
              std dev =       0.665940936808
             le_variance =       0.443477331317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525316199
                                         uncertainty =       0.007299619893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525316199
                                         uncertainty =       0.007299619893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470891352
  error estimate for blocks of size 2^( 2) =       0.000495936741
  error estimate for blocks of size 2^( 3) =       0.000519930777
  error estimate for blocks of size 2^( 4) =       0.000537530460
  error estimate for blocks of size 2^( 5) =       0.000548684565
  error estimate for blocks of size 2^( 6) =       0.000553030241
  error estimate for blocks of size 2^( 7) =       0.000555121354

      target function =      -0.732767862003
              le_mean =     -22.814618155434
             les_mean =     520.971996672851
             stat err =       0.000548591655
             autocorr =       1.357240980694
   target nu stat err =       0.000548591655
   target dn stat err =       0.017458188981
      target stat err =       0.013925702175
              std dev =       0.665940936806
             le_variance =       0.443477331315


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.732767862003        initial  <--
     5.6843e+06     5.6843e+07             2.6349e-11        -0.732767862000
     2.2737e+07     2.2737e+08             6.5873e-12        -0.732767862002
     9.0949e+07     9.0949e+08             1.6468e-12        -0.732767862003

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 74.3887
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2638e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.7854
    reference variance = 0.327564
====================================================
  Execution time = 4.3883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4709e-01
  Total weights = 1.964476828e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435411755554
                                         uncertainty =       0.002883858836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435411755554
                                         uncertainty =       0.002883858836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466565707
  error estimate for blocks of size 2^( 2) =       0.000491928366
  error estimate for blocks of size 2^( 3) =       0.000515487295
  error estimate for blocks of size 2^( 4) =       0.000532792878
  error estimate for blocks of size 2^( 5) =       0.000544815758
  error estimate for blocks of size 2^( 6) =       0.000552395523
  error estimate for blocks of size 2^( 7) =       0.000555398378

      target function =      -0.747735985569
              le_mean =     -22.814129168147
             les_mean =     520.931579671446
             stat err =       0.000546350634
             autocorr =       1.371252000438
   target nu stat err =       0.000546350634
   target dn stat err =       0.003893041280
      target stat err =       0.003283421793
              std dev =       0.659823550441
             le_variance =       0.435367117717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281412916815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747749324070       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747749324070       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747749324070       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747749301659       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747749320027       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747749299660       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747749337005       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747749309056       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747749324070       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+07 is 3.762446e-12

solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747749324070       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747749324070       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747749324070       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747749442049       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747749324070       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747749324070       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747749324070       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747748544886       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747749324070       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+08 is 9.406041e-13

solving harmonic davidson linear method for identity shift 9.0949e+08, overlap shift 9.0949e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747749324070       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747749324070       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747749324070       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747749324070       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747749515468       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747749324070       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747749324070       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747746944824       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747749949679       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+08 is 2.351687e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305539 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1675e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8497
    reference variance = 0.294945
====================================================
  Execution time = 4.2699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4447e-01
  Total weights = 1.9642e+06
  Execution time = 6.0911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269141584
                                         uncertainty =       0.002215334707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269141584
                                         uncertainty =       0.002215334707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465449334
  error estimate for blocks of size 2^( 2) =       0.000491159520
  error estimate for blocks of size 2^( 3) =       0.000514961895
  error estimate for blocks of size 2^( 4) =       0.000532938778
  error estimate for blocks of size 2^( 5) =       0.000545892679
  error estimate for blocks of size 2^( 6) =       0.000553548612
  error estimate for blocks of size 2^( 7) =       0.000555724678

      target function =      -0.749924032609
              le_mean =     -22.814268605295
             les_mean =     520.935321501128
             stat err =       0.000547026187
             autocorr =       1.381247190326
   target nu stat err =       0.000547026187
   target dn stat err =       0.002582100435
      target stat err =       0.002237635293
              std dev =       0.658244760640
             le_variance =       0.433286164910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269141583
                                         uncertainty =       0.002215334707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269141583
                                         uncertainty =       0.002215334707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465449334
  error estimate for blocks of size 2^( 2) =       0.000491159520
  error estimate for blocks of size 2^( 3) =       0.000514961895
  error estimate for blocks of size 2^( 4) =       0.000532938778
  error estimate for blocks of size 2^( 5) =       0.000545892679
  error estimate for blocks of size 2^( 6) =       0.000553548612
  error estimate for blocks of size 2^( 7) =       0.000555724678

      target function =      -0.749924032611
              le_mean =     -22.814268605295
             les_mean =     520.935321501126
             stat err =       0.000547026187
             autocorr =       1.381247190326
   target nu stat err =       0.000547026187
   target dn stat err =       0.002582100435
      target stat err =       0.002237635293
              std dev =       0.658244760640
             le_variance =       0.433286164910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269141583
                                         uncertainty =       0.002215334707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269141583
                                         uncertainty =       0.002215334707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465449334
  error estimate for blocks of size 2^( 2) =       0.000491159520
  error estimate for blocks of size 2^( 3) =       0.000514961895
  error estimate for blocks of size 2^( 4) =       0.000532938778
  error estimate for blocks of size 2^( 5) =       0.000545892679
  error estimate for blocks of size 2^( 6) =       0.000553548612
  error estimate for blocks of size 2^( 7) =       0.000555724678

      target function =      -0.749924032610
              le_mean =     -22.814268605295
             les_mean =     520.935321501127
             stat err =       0.000547026187
             autocorr =       1.381247190313
   target nu stat err =       0.000547026187
   target dn stat err =       0.002582100435
      target stat err =       0.002237635293
              std dev =       0.658244760640
             le_variance =       0.433286164910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269141584
                                         uncertainty =       0.002215334707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269141584
                                         uncertainty =       0.002215334707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465449334
  error estimate for blocks of size 2^( 2) =       0.000491159520
  error estimate for blocks of size 2^( 3) =       0.000514961895
  error estimate for blocks of size 2^( 4) =       0.000532938778
  error estimate for blocks of size 2^( 5) =       0.000545892679
  error estimate for blocks of size 2^( 6) =       0.000553548612
  error estimate for blocks of size 2^( 7) =       0.000555724678

      target function =      -0.749924032609
              le_mean =     -22.814268605295
             les_mean =     520.935321501128
             stat err =       0.000547026187
             autocorr =       1.381247190327
   target nu stat err =       0.000547026187
   target dn stat err =       0.002582100435
      target stat err =       0.002237635293
              std dev =       0.658244760640
             le_variance =       0.433286164911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749924032609        initial
     5.6843e+07     5.6843e+08             3.7624e-12        -0.749924032611  <--
     2.2737e+08     2.2737e+09             9.4060e-13        -0.749924032610
     9.0949e+08     9.0949e+09             2.3517e-13        -0.749924032609

*****************************************************************************
Applying the update for shift_i =   5.6843e+07     and shift_s =   5.6843e+08
*****************************************************************************

  Execution time = 7.3155e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2486e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8246
    reference variance = 0.346644
====================================================
  Execution time = 4.4113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4301e-01
  Total weights = 1.963973377e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856411093
                                         uncertainty =       0.001672901775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.429856411093
                                         uncertainty =       0.001672901775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463586351
  error estimate for blocks of size 2^( 2) =       0.000489469028
  error estimate for blocks of size 2^( 3) =       0.000513853124
  error estimate for blocks of size 2^( 4) =       0.000531587984
  error estimate for blocks of size 2^( 5) =       0.000542016613
  error estimate for blocks of size 2^( 6) =       0.000548260967
  error estimate for blocks of size 2^( 7) =       0.000549788644

      target function =      -0.751157459679
              le_mean =     -22.815074810743
             les_mean =     520.970645475937
             stat err =       0.000542913552
             autocorr =       1.371513486604
   target nu stat err =       0.000542913552
   target dn stat err =       0.002473150288
      target stat err =       0.002158425274
              std dev =       0.655610105479
             le_variance =       0.429824610406


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281507481074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751162691864       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751162691865       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751162691865       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751162691865       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751162691865       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751162691865       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751162705745       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751162691865       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751162657819       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+07 is 8.776846e-12

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751162691864       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751162691864       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751162691864       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751162686402       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751162691864       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751162691864       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751162691864       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751162691864       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751162691864       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+07 is 2.194257e-12

solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751162691864       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751162691864       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751162691864       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751162691864       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751162678831       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751162691864       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751162691864       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751162691864       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751162521644       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+08 is 5.485505e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1957e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.707
    reference variance = 0.568046
====================================================
  Execution time = 4.2499e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4801e-01
  Total weights = 1.9641e+06
  Execution time = 5.9484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432261322941
                                         uncertainty =       0.002124552080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432261322941
                                         uncertainty =       0.002124552080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464885377
  error estimate for blocks of size 2^( 2) =       0.000490204324
  error estimate for blocks of size 2^( 3) =       0.000514048915
  error estimate for blocks of size 2^( 4) =       0.000532593795
  error estimate for blocks of size 2^( 5) =       0.000543277417
  error estimate for blocks of size 2^( 6) =       0.000548078371
  error estimate for blocks of size 2^( 7) =       0.000551997215

      target function =      -0.746977550197
              le_mean =     -22.814683227754
             les_mean =     520.957781774539
             stat err =       0.000543986700
             autocorr =       1.369256436205
   target nu stat err =       0.000543986700
   target dn stat err =       0.003930490051
      target stat err =       0.003309571116
              std dev =       0.657447205406
             le_variance =       0.432236827896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432261322941
                                         uncertainty =       0.002124552080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432261322941
                                         uncertainty =       0.002124552080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464885377
  error estimate for blocks of size 2^( 2) =       0.000490204324
  error estimate for blocks of size 2^( 3) =       0.000514048915
  error estimate for blocks of size 2^( 4) =       0.000532593795
  error estimate for blocks of size 2^( 5) =       0.000543277417
  error estimate for blocks of size 2^( 6) =       0.000548078371
  error estimate for blocks of size 2^( 7) =       0.000551997215

      target function =      -0.746977550204
              le_mean =     -22.814683227755
             les_mean =     520.957781774533
             stat err =       0.000543986700
             autocorr =       1.369256436220
   target nu stat err =       0.000543986700
   target dn stat err =       0.003930490043
      target stat err =       0.003309571110
              std dev =       0.657447205406
             le_variance =       0.432236827896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432261322941
                                         uncertainty =       0.002124552080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432261322941
                                         uncertainty =       0.002124552080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464885377
  error estimate for blocks of size 2^( 2) =       0.000490204324
  error estimate for blocks of size 2^( 3) =       0.000514048915
  error estimate for blocks of size 2^( 4) =       0.000532593795
  error estimate for blocks of size 2^( 5) =       0.000543277417
  error estimate for blocks of size 2^( 6) =       0.000548078371
  error estimate for blocks of size 2^( 7) =       0.000551997215

      target function =      -0.746977550201
              le_mean =     -22.814683227755
             les_mean =     520.957781774536
             stat err =       0.000543986700
             autocorr =       1.369256436217
   target nu stat err =       0.000543986700
   target dn stat err =       0.003930490047
      target stat err =       0.003309571113
              std dev =       0.657447205406
             le_variance =       0.432236827896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432261322941
                                         uncertainty =       0.002124552080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432261322941
                                         uncertainty =       0.002124552080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464885377
  error estimate for blocks of size 2^( 2) =       0.000490204324
  error estimate for blocks of size 2^( 3) =       0.000514048915
  error estimate for blocks of size 2^( 4) =       0.000532593795
  error estimate for blocks of size 2^( 5) =       0.000543277417
  error estimate for blocks of size 2^( 6) =       0.000548078371
  error estimate for blocks of size 2^( 7) =       0.000551997215

      target function =      -0.746977550198
              le_mean =     -22.814683227754
             les_mean =     520.957781774538
             stat err =       0.000543986700
             autocorr =       1.369256436207
   target nu stat err =       0.000543986700
   target dn stat err =       0.003930490051
      target stat err =       0.003309571116
              std dev =       0.657447205406
             le_variance =       0.432236827896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746977550197        initial
     1.4211e+07     1.4211e+08             8.7768e-12        -0.746977550204  <--
     5.6843e+07     5.6843e+08             2.1943e-12        -0.746977550201
     2.2737e+08     2.2737e+09             5.4855e-13        -0.746977550198

*****************************************************************************
Applying the update for shift_i =   1.4211e+07     and shift_s =   1.4211e+08
*****************************************************************************

  Execution time = 7.2730e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2469e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7908
    reference variance = 0.364711
====================================================
  Execution time = 4.5355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5243e-01
  Total weights = 1.964388325e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439207291636
                                         uncertainty =       0.003393056192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439207291636
                                         uncertainty =       0.003393056192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468597833
  error estimate for blocks of size 2^( 2) =       0.000493957898
  error estimate for blocks of size 2^( 3) =       0.000516905438
  error estimate for blocks of size 2^( 4) =       0.000533933400
  error estimate for blocks of size 2^( 5) =       0.000544682478
  error estimate for blocks of size 2^( 6) =       0.000552916646
  error estimate for blocks of size 2^( 7) =       0.000556401385

      target function =      -0.743334406776
              le_mean =     -22.814882249618
             les_mean =     520.971281162473
             stat err =       0.000546983477
             autocorr =       1.362535616928
   target nu stat err =       0.000546983477
   target dn stat err =       0.004400542947
      target stat err =       0.003659097583
              std dev =       0.662697410762
             le_variance =       0.439167858231


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281488224962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743351346339       residual = 8.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743351346358       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743351346360       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743351346360       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743351342908       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743351343234       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743351350663       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743351347511       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743351350712       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743351351554       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743351347531       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+06 is 9.294702e-11

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743351346339       residual = 8.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743351346344       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743351346344       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743351346344       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743351346346       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743351323046       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743351326523       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743351339443       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743351338229       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743351330313       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743351325004       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+07 is 2.323674e-11

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743351346339       residual = 8.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743351346340       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743351346340       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743351346340       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743351346341       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743351325158       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743351348250       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743351401784       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743351294168       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743351279050       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743351535089       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+07 is 5.809191e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312717 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3145e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7722
    reference variance = 0.264764
====================================================
  Execution time = 4.2484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4587e-01
  Total weights = 1.9645e+06
  Execution time = 6.0895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958705476
                                         uncertainty =       0.002047711908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958705476
                                         uncertainty =       0.002047711908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465281276
  error estimate for blocks of size 2^( 2) =       0.000490923395
  error estimate for blocks of size 2^( 3) =       0.000514473812
  error estimate for blocks of size 2^( 4) =       0.000532338514
  error estimate for blocks of size 2^( 5) =       0.000542660510
  error estimate for blocks of size 2^( 6) =       0.000549565243
  error estimate for blocks of size 2^( 7) =       0.000552729637

      target function =      -0.748768404704
              le_mean =     -22.815127366177
             les_mean =     520.975904855916
             stat err =       0.000544323476
             autocorr =       1.368620305468
   target nu stat err =       0.000544323476
   target dn stat err =       0.002551750537
      target stat err =       0.002208718346
              std dev =       0.658007090604
             le_variance =       0.432973331285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958705468
                                         uncertainty =       0.002047711908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958705468
                                         uncertainty =       0.002047711908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465281276
  error estimate for blocks of size 2^( 2) =       0.000490923395
  error estimate for blocks of size 2^( 3) =       0.000514473812
  error estimate for blocks of size 2^( 4) =       0.000532338514
  error estimate for blocks of size 2^( 5) =       0.000542660510
  error estimate for blocks of size 2^( 6) =       0.000549565243
  error estimate for blocks of size 2^( 7) =       0.000552729637

      target function =      -0.748768404664
              le_mean =     -22.815127366177
             les_mean =     520.975904855951
             stat err =       0.000544323476
             autocorr =       1.368620305500
   target nu stat err =       0.000544323476
   target dn stat err =       0.002551750536
      target stat err =       0.002208718345
              std dev =       0.658007090597
             le_variance =       0.432973331276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958705472
                                         uncertainty =       0.002047711908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958705472
                                         uncertainty =       0.002047711908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465281276
  error estimate for blocks of size 2^( 2) =       0.000490923395
  error estimate for blocks of size 2^( 3) =       0.000514473812
  error estimate for blocks of size 2^( 4) =       0.000532338514
  error estimate for blocks of size 2^( 5) =       0.000542660510
  error estimate for blocks of size 2^( 6) =       0.000549565243
  error estimate for blocks of size 2^( 7) =       0.000552729637

      target function =      -0.748768404684
              le_mean =     -22.815127366177
             les_mean =     520.975904855933
             stat err =       0.000544323476
             autocorr =       1.368620305485
   target nu stat err =       0.000544323476
   target dn stat err =       0.002551750536
      target stat err =       0.002208718346
              std dev =       0.658007090600
             le_variance =       0.432973331281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958705476
                                         uncertainty =       0.002047711908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432958705476
                                         uncertainty =       0.002047711908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465281276
  error estimate for blocks of size 2^( 2) =       0.000490923395
  error estimate for blocks of size 2^( 3) =       0.000514473812
  error estimate for blocks of size 2^( 4) =       0.000532338514
  error estimate for blocks of size 2^( 5) =       0.000542660510
  error estimate for blocks of size 2^( 6) =       0.000549565243
  error estimate for blocks of size 2^( 7) =       0.000552729637

      target function =      -0.748768404702
              le_mean =     -22.815127366177
             les_mean =     520.975904855918
             stat err =       0.000544323476
             autocorr =       1.368620305465
   target nu stat err =       0.000544323476
   target dn stat err =       0.002551750537
      target stat err =       0.002208718346
              std dev =       0.658007090604
             le_variance =       0.432973331284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748768404704        initial  <--
     3.5527e+06     3.5527e+07             9.2947e-11        -0.748768404664
     1.4211e+07     1.4211e+08             2.3237e-11        -0.748768404684
     5.6843e+07     5.6843e+08             5.8092e-12        -0.748768404702

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.8530
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2643e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7269
    reference variance = 0.366443
====================================================
  Execution time = 4.5603e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4547e-01
  Total weights = 1.964299609e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433439250699
                                         uncertainty =       0.002044896129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433439250699
                                         uncertainty =       0.002044896129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465515119
  error estimate for blocks of size 2^( 2) =       0.000490989350
  error estimate for blocks of size 2^( 3) =       0.000515171731
  error estimate for blocks of size 2^( 4) =       0.000532886534
  error estimate for blocks of size 2^( 5) =       0.000545050257
  error estimate for blocks of size 2^( 6) =       0.000551710677
  error estimate for blocks of size 2^( 7) =       0.000557565584

      target function =      -0.749103719439
              le_mean =     -22.815902022450
             les_mean =     521.010859219978
             stat err =       0.000546803263
             autocorr =       1.379731607541
   target nu stat err =       0.000546803263
   target dn stat err =       0.002567995831
      target stat err =       0.002226958085
              std dev =       0.658337795186
             le_variance =       0.433408652571


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281590202245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749109348081       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749109348081       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749109348081       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749109348081       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749109348081       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749109348081       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749109391086       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749109335071       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749109348081       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 3.664316e-12

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749109348081       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749109348081       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749109348081       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749109348081       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749109348081       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749109374294       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749109427395       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749109272306       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749109234721       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+08 is 9.160634e-13

solving harmonic davidson linear method for identity shift 5.6843e+08, overlap shift 5.6843e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749109348081       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749109348081       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749109348081       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749109348081       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749109348081       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749109348081       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749109348081       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749107874729       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749109348081       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+08 is 2.290127e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315802 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3502e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7201
    reference variance = 0.794499
====================================================
  Execution time = 4.2527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4589e-01
  Total weights = 1.9643e+06
  Execution time = 6.1107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435314154458
                                         uncertainty =       0.001832443249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435314154458
                                         uncertainty =       0.001832443249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466540230
  error estimate for blocks of size 2^( 2) =       0.000492420137
  error estimate for blocks of size 2^( 3) =       0.000516911111
  error estimate for blocks of size 2^( 4) =       0.000534666254
  error estimate for blocks of size 2^( 5) =       0.000545856687
  error estimate for blocks of size 2^( 6) =       0.000551442879
  error estimate for blocks of size 2^( 7) =       0.000553570740

      target function =      -0.748742531458
              le_mean =     -22.814566479378
             les_mean =     520.950336593385
             stat err =       0.000546384140
             autocorr =       1.371569976010
   target nu stat err =       0.000546384140
   target dn stat err =       0.002468159362
      target stat err =       0.002140603118
              std dev =       0.659787521245
             le_variance =       0.435319573191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435314154458
                                         uncertainty =       0.001832443249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435314154458
                                         uncertainty =       0.001832443249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466540230
  error estimate for blocks of size 2^( 2) =       0.000492420137
  error estimate for blocks of size 2^( 3) =       0.000516911111
  error estimate for blocks of size 2^( 4) =       0.000534666254
  error estimate for blocks of size 2^( 5) =       0.000545856687
  error estimate for blocks of size 2^( 6) =       0.000551442879
  error estimate for blocks of size 2^( 7) =       0.000553570740

      target function =      -0.748742531464
              le_mean =     -22.814566479378
             les_mean =     520.950336593377
             stat err =       0.000546384140
             autocorr =       1.371569976012
   target nu stat err =       0.000546384140
   target dn stat err =       0.002468159362
      target stat err =       0.002140603118
              std dev =       0.659787521245
             le_variance =       0.435319573190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435314154458
                                         uncertainty =       0.001832443249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435314154458
                                         uncertainty =       0.001832443249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466540230
  error estimate for blocks of size 2^( 2) =       0.000492420137
  error estimate for blocks of size 2^( 3) =       0.000516911111
  error estimate for blocks of size 2^( 4) =       0.000534666254
  error estimate for blocks of size 2^( 5) =       0.000545856687
  error estimate for blocks of size 2^( 6) =       0.000551442879
  error estimate for blocks of size 2^( 7) =       0.000553570740

      target function =      -0.748742531461
              le_mean =     -22.814566479378
             les_mean =     520.950336593381
             stat err =       0.000546384140
             autocorr =       1.371569976012
   target nu stat err =       0.000546384140
   target dn stat err =       0.002468159362
      target stat err =       0.002140603118
              std dev =       0.659787521245
             le_variance =       0.435319573191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435314154458
                                         uncertainty =       0.001832443249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435314154458
                                         uncertainty =       0.001832443249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466540230
  error estimate for blocks of size 2^( 2) =       0.000492420137
  error estimate for blocks of size 2^( 3) =       0.000516911111
  error estimate for blocks of size 2^( 4) =       0.000534666254
  error estimate for blocks of size 2^( 5) =       0.000545856687
  error estimate for blocks of size 2^( 6) =       0.000551442879
  error estimate for blocks of size 2^( 7) =       0.000553570740

      target function =      -0.748742531458
              le_mean =     -22.814566479378
             les_mean =     520.950336593384
             stat err =       0.000546384140
             autocorr =       1.371569976008
   target nu stat err =       0.000546384140
   target dn stat err =       0.002468159362
      target stat err =       0.002140603118
              std dev =       0.659787521245
             le_variance =       0.435319573191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748742531458        initial
     3.5527e+07     3.5527e+08             3.6643e-12        -0.748742531464  <--
     1.4211e+08     1.4211e+09             9.1606e-13        -0.748742531461
     5.6843e+08     5.6843e+09             2.2901e-13        -0.748742531458

*****************************************************************************
Applying the update for shift_i =   3.5527e+07     and shift_s =   3.5527e+08
*****************************************************************************

  Execution time = 7.2837e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2649e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8874
    reference variance = 0.472542
====================================================
  Execution time = 4.3760e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4591e-01
  Total weights = 1.964160879e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435759783481
                                         uncertainty =       0.001857646299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435759783481
                                         uncertainty =       0.001857646299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466787352
  error estimate for blocks of size 2^( 2) =       0.000492507034
  error estimate for blocks of size 2^( 3) =       0.000515947883
  error estimate for blocks of size 2^( 4) =       0.000532425184
  error estimate for blocks of size 2^( 5) =       0.000543980886
  error estimate for blocks of size 2^( 6) =       0.000550293199
  error estimate for blocks of size 2^( 7) =       0.000553151716

      target function =      -0.748734975291
              le_mean =     -22.815138824629
             les_mean =     520.976468794605
             stat err =       0.000544962746
             autocorr =       1.362998786914
   target nu stat err =       0.000544962746
   target dn stat err =       0.002408064102
      target stat err =       0.002094000518
              std dev =       0.660137004342
             le_variance =       0.435780864501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281513882463e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748739822323       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748739822324       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748739822324       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748739822324       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748739822285       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748739816548       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748739824807       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748739824756       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748739821413       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+06 is 2.048794e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748739822323       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748739822323       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748739822323       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748739822323       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748739820673       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748739844040       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748739822323       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748739833880       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748739843150       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 5.121945e-12

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748739822323       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748739822323       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748739822323       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748739915268       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748739873276       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748739840791       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748739630087       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748740334976       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748739932920       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+08 is 1.280403e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318859 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1656e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160604e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8909
    reference variance = 0.473874
====================================================
  Execution time = 4.4100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5084e-01
  Total weights = 1.9645e+06
  Execution time = 5.9529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437362476654
                                         uncertainty =       0.002006663173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437362476654
                                         uncertainty =       0.002006663173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467631471
  error estimate for blocks of size 2^( 2) =       0.000493367182
  error estimate for blocks of size 2^( 3) =       0.000517622424
  error estimate for blocks of size 2^( 4) =       0.000535243176
  error estimate for blocks of size 2^( 5) =       0.000545638424
  error estimate for blocks of size 2^( 6) =       0.000552993202
  error estimate for blocks of size 2^( 7) =       0.000559411645

      target function =      -0.744647410371
              le_mean =     -22.815018378736
             les_mean =     520.975908421781
             stat err =       0.000548321612
             autocorr =       1.374875157328
   target nu stat err =       0.000548321612
   target dn stat err =       0.002688698027
      target stat err =       0.002294777702
              std dev =       0.661330769094
             le_variance =       0.437358386150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437362476651
                                         uncertainty =       0.002006663173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437362476651
                                         uncertainty =       0.002006663173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467631471
  error estimate for blocks of size 2^( 2) =       0.000493367182
  error estimate for blocks of size 2^( 3) =       0.000517622424
  error estimate for blocks of size 2^( 4) =       0.000535243176
  error estimate for blocks of size 2^( 5) =       0.000545638424
  error estimate for blocks of size 2^( 6) =       0.000552993202
  error estimate for blocks of size 2^( 7) =       0.000559411645

      target function =      -0.744647410407
              le_mean =     -22.815018378737
             les_mean =     520.975908421738
             stat err =       0.000548321612
             autocorr =       1.374875157344
   target nu stat err =       0.000548321612
   target dn stat err =       0.002688698023
      target stat err =       0.002294777699
              std dev =       0.661330769093
             le_variance =       0.437358386148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437362476652
                                         uncertainty =       0.002006663173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437362476652
                                         uncertainty =       0.002006663173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467631471
  error estimate for blocks of size 2^( 2) =       0.000493367182
  error estimate for blocks of size 2^( 3) =       0.000517622424
  error estimate for blocks of size 2^( 4) =       0.000535243176
  error estimate for blocks of size 2^( 5) =       0.000545638424
  error estimate for blocks of size 2^( 6) =       0.000552993202
  error estimate for blocks of size 2^( 7) =       0.000559411645

      target function =      -0.744647410389
              le_mean =     -22.815018378736
             les_mean =     520.975908421760
             stat err =       0.000548321612
             autocorr =       1.374875157342
   target nu stat err =       0.000548321612
   target dn stat err =       0.002688698025
      target stat err =       0.002294777700
              std dev =       0.661330769093
             le_variance =       0.437358386149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437362476653
                                         uncertainty =       0.002006663173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437362476653
                                         uncertainty =       0.002006663173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467631471
  error estimate for blocks of size 2^( 2) =       0.000493367182
  error estimate for blocks of size 2^( 3) =       0.000517622424
  error estimate for blocks of size 2^( 4) =       0.000535243176
  error estimate for blocks of size 2^( 5) =       0.000545638424
  error estimate for blocks of size 2^( 6) =       0.000552993202
  error estimate for blocks of size 2^( 7) =       0.000559411645

      target function =      -0.744647410373
              le_mean =     -22.815018378736
             les_mean =     520.975908421778
             stat err =       0.000548321612
             autocorr =       1.374875157330
   target nu stat err =       0.000548321612
   target dn stat err =       0.002688698027
      target stat err =       0.002294777701
              std dev =       0.661330769094
             le_variance =       0.437358386151


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744647410371        initial
     8.8818e+06     8.8818e+07             2.0488e-11        -0.744647410407  <--
     3.5527e+07     3.5527e+08             5.1219e-12        -0.744647410389
     1.4211e+08     1.4211e+09             1.2804e-12        -0.744647410373

*****************************************************************************
Applying the update for shift_i =   8.8818e+06     and shift_s =   8.8818e+07
*****************************************************************************

  Execution time = 7.4176e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160603e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2590e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8226
    reference variance = 0.279259
====================================================
  Execution time = 4.4013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5378e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5469e-01
  Total weights = 1.964336933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440453844104
                                         uncertainty =       0.002730566975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440453844104
                                         uncertainty =       0.002730566975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469240736
  error estimate for blocks of size 2^( 2) =       0.000494503275
  error estimate for blocks of size 2^( 3) =       0.000518919967
  error estimate for blocks of size 2^( 4) =       0.000536526020
  error estimate for blocks of size 2^( 5) =       0.000548495459
  error estimate for blocks of size 2^( 6) =       0.000552705182
  error estimate for blocks of size 2^( 7) =       0.000557776524

      target function =      -0.741489862340
              le_mean =     -22.814167870119
             les_mean =     520.940942032835
             stat err =       0.000548875796
             autocorr =       1.368222556107
   target nu stat err =       0.000548875796
   target dn stat err =       0.004159571996
      target stat err =       0.003444123694
              std dev =       0.663606612858
             le_variance =       0.440373736630


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281416787012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741504843845       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741504843853       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741504843854       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741504843808       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741504843858       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741504846861       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741504844934       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741504842052       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741504836761       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+06 is 1.038796e-10

solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741504843845       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741504843847       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741504843847       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741504843847       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741504843706       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741504847062       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741504843847       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741504831785       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741504841429       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+06 is 2.596995e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741504843845       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741504843845       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741504843845       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741504843845       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741504836893       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741504842029       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741504978545       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741504831014       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741504836357       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 6.492508e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1758e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068126e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160603e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7822
    reference variance = 0.344839
====================================================
  Execution time = 4.4475e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4931e-01
  Total weights = 1.9639e+06
  Execution time = 6.0275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436186051255
                                         uncertainty =       0.001988848205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436186051255
                                         uncertainty =       0.001988848205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467003063
  error estimate for blocks of size 2^( 2) =       0.000492367164
  error estimate for blocks of size 2^( 3) =       0.000515969807
  error estimate for blocks of size 2^( 4) =       0.000534056205
  error estimate for blocks of size 2^( 5) =       0.000544628083
  error estimate for blocks of size 2^( 6) =       0.000551788463
  error estimate for blocks of size 2^( 7) =       0.000556469494

      target function =      -0.745909077739
              le_mean =     -22.814349401570
             les_mean =     520.943848835772
             stat err =       0.000546735561
             autocorr =       1.370614074166
   target nu stat err =       0.000546735561
   target dn stat err =       0.002629018798
      target stat err =       0.002252068530
              std dev =       0.660442065407
             le_variance =       0.436183721759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436186051247
                                         uncertainty =       0.001988848205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436186051247
                                         uncertainty =       0.001988848205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467003063
  error estimate for blocks of size 2^( 2) =       0.000492367164
  error estimate for blocks of size 2^( 3) =       0.000515969807
  error estimate for blocks of size 2^( 4) =       0.000534056205
  error estimate for blocks of size 2^( 5) =       0.000544628083
  error estimate for blocks of size 2^( 6) =       0.000551788463
  error estimate for blocks of size 2^( 7) =       0.000556469494

      target function =      -0.745909077797
              le_mean =     -22.814349401571
             les_mean =     520.943848835717
             stat err =       0.000546735561
             autocorr =       1.370614074232
   target nu stat err =       0.000546735561
   target dn stat err =       0.002629018793
      target stat err =       0.002252068526
              std dev =       0.660442065401
             le_variance =       0.436183721751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436186051251
                                         uncertainty =       0.001988848205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436186051251
                                         uncertainty =       0.001988848205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467003063
  error estimate for blocks of size 2^( 2) =       0.000492367164
  error estimate for blocks of size 2^( 3) =       0.000515969807
  error estimate for blocks of size 2^( 4) =       0.000534056205
  error estimate for blocks of size 2^( 5) =       0.000544628083
  error estimate for blocks of size 2^( 6) =       0.000551788463
  error estimate for blocks of size 2^( 7) =       0.000556469494

      target function =      -0.745909077768
              le_mean =     -22.814349401571
             les_mean =     520.943848835745
             stat err =       0.000546735561
             autocorr =       1.370614074200
   target nu stat err =       0.000546735561
   target dn stat err =       0.002629018796
      target stat err =       0.002252068528
              std dev =       0.660442065404
             le_variance =       0.436183721755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436186051255
                                         uncertainty =       0.001988848205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436186051255
                                         uncertainty =       0.001988848205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467003063
  error estimate for blocks of size 2^( 2) =       0.000492367164
  error estimate for blocks of size 2^( 3) =       0.000515969807
  error estimate for blocks of size 2^( 4) =       0.000534056205
  error estimate for blocks of size 2^( 5) =       0.000544628083
  error estimate for blocks of size 2^( 6) =       0.000551788463
  error estimate for blocks of size 2^( 7) =       0.000556469494

      target function =      -0.745909077743
              le_mean =     -22.814349401570
             les_mean =     520.943848835769
             stat err =       0.000546735561
             autocorr =       1.370614074174
   target nu stat err =       0.000546735561
   target dn stat err =       0.002629018798
      target stat err =       0.002252068530
              std dev =       0.660442065407
             le_variance =       0.436183721759


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745909077739        initial
     2.2204e+06     2.2204e+07             1.0388e-10        -0.745909077797  <--
     8.8818e+06     8.8818e+07             2.5970e-11        -0.745909077768
     3.5527e+07     3.5527e+08             6.4925e-12        -0.745909077743

*****************************************************************************
Applying the update for shift_i =   2.2204e+06     and shift_s =   2.2204e+07
*****************************************************************************

  Execution time = 7.4779e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068127e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160601e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2654e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7541
    reference variance = 0.363743
====================================================
  Execution time = 4.4164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4362e-01
  Total weights = 1.964149518e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431757194169
                                         uncertainty =       0.001846315006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431757194169
                                         uncertainty =       0.001846315006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464704445
  error estimate for blocks of size 2^( 2) =       0.000490118463
  error estimate for blocks of size 2^( 3) =       0.000513948534
  error estimate for blocks of size 2^( 4) =       0.000532466144
  error estimate for blocks of size 2^( 5) =       0.000543567155
  error estimate for blocks of size 2^( 6) =       0.000549309625
  error estimate for blocks of size 2^( 7) =       0.000551229263

      target function =      -0.750634741358
              le_mean =     -22.814550656724
             les_mean =     520.947345219770
             stat err =       0.000544143047
             autocorr =       1.371110683065
   target nu stat err =       0.000544143047
   target dn stat err =       0.002421036915
      target stat err =       0.002112481555
              std dev =       0.657191328870
             le_variance =       0.431900442743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281455065672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+05, overlap shift 5.5511e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750639664998       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750639665018       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750639665022       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750639664946       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750639665023       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750639665049       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750639665023       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750639664883       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750639664899       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750639664285       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+05 is 4.641135e-10

solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750639664998       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750639665003       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750639665004       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750639665004       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750639665004       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750639665004       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750639665004       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750639660517       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750639665004       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750639665004       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+06 is 1.160283e-10

solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750639664998       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750639664999       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750639664999       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750639664999       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750639664999       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750639664999       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750639666292       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750639664999       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750639664999       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750639664999       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+06 is 2.900714e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325507 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2015e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581147e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068125e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160601e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7669
    reference variance = 0.387396
====================================================
  Execution time = 4.2741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4565e-01
  Total weights = 1.9641e+06
  Execution time = 6.0929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432871107711
                                         uncertainty =       0.002102190404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432871107711
                                         uncertainty =       0.002102190404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465206368
  error estimate for blocks of size 2^( 2) =       0.000490945191
  error estimate for blocks of size 2^( 3) =       0.000515037409
  error estimate for blocks of size 2^( 4) =       0.000533384046
  error estimate for blocks of size 2^( 5) =       0.000544570798
  error estimate for blocks of size 2^( 6) =       0.000552084017
  error estimate for blocks of size 2^( 7) =       0.000555292052

      target function =      -0.748933386958
              le_mean =     -22.814217513541
             les_mean =     520.934174374100
             stat err =       0.000546332728
             autocorr =       1.379186932845
   target nu stat err =       0.000546332728
   target dn stat err =       0.003296722002
      target stat err =       0.002808191873
              std dev =       0.657901154574
             le_variance =       0.432833929190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432871107655
                                         uncertainty =       0.002102190390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432871107655
                                         uncertainty =       0.002102190390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465206368
  error estimate for blocks of size 2^( 2) =       0.000490945191
  error estimate for blocks of size 2^( 3) =       0.000515037409
  error estimate for blocks of size 2^( 4) =       0.000533384046
  error estimate for blocks of size 2^( 5) =       0.000544570798
  error estimate for blocks of size 2^( 6) =       0.000552084017
  error estimate for blocks of size 2^( 7) =       0.000555292052

      target function =      -0.748933386114
              le_mean =     -22.814217513540
             les_mean =     520.934174375062
             stat err =       0.000546332728
             autocorr =       1.379186933032
   target nu stat err =       0.000546332728
   target dn stat err =       0.003296722026
      target stat err =       0.002808191886
              std dev =       0.657901154531
             le_variance =       0.432833929134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432871107683
                                         uncertainty =       0.002102190397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432871107683
                                         uncertainty =       0.002102190397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465206368
  error estimate for blocks of size 2^( 2) =       0.000490945191
  error estimate for blocks of size 2^( 3) =       0.000515037409
  error estimate for blocks of size 2^( 4) =       0.000533384046
  error estimate for blocks of size 2^( 5) =       0.000544570798
  error estimate for blocks of size 2^( 6) =       0.000552084017
  error estimate for blocks of size 2^( 7) =       0.000555292052

      target function =      -0.748933386536
              le_mean =     -22.814217513541
             les_mean =     520.934174374581
             stat err =       0.000546332728
             autocorr =       1.379186932929
   target nu stat err =       0.000546332728
   target dn stat err =       0.003296722014
      target stat err =       0.002808191880
              std dev =       0.657901154553
             le_variance =       0.432833929162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432871107708
                                         uncertainty =       0.002102190403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432871107708
                                         uncertainty =       0.002102190403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465206368
  error estimate for blocks of size 2^( 2) =       0.000490945191
  error estimate for blocks of size 2^( 3) =       0.000515037409
  error estimate for blocks of size 2^( 4) =       0.000533384046
  error estimate for blocks of size 2^( 5) =       0.000544570798
  error estimate for blocks of size 2^( 6) =       0.000552084017
  error estimate for blocks of size 2^( 7) =       0.000555292052

      target function =      -0.748933386905
              le_mean =     -22.814217513541
             les_mean =     520.934174374160
             stat err =       0.000546332728
             autocorr =       1.379186932858
   target nu stat err =       0.000546332728
   target dn stat err =       0.003296722004
      target stat err =       0.002808191874
              std dev =       0.657901154572
             le_variance =       0.432833929187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748933386958        initial  <--
     5.5511e+05     5.5511e+06             4.6411e-10        -0.748933386114
     2.2204e+06     2.2204e+07             1.1603e-10        -0.748933386536
     8.8818e+06     8.8818e+07             2.9007e-11        -0.748933386905

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.2479
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244569e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068127e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160601e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2527e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7576
    reference variance = 0.356091
====================================================
  Execution time = 4.4165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4697e-01
  Total weights = 1.964279252e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235207302
                                         uncertainty =       0.002000234673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434235207302
                                         uncertainty =       0.002000234673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465915740
  error estimate for blocks of size 2^( 2) =       0.000491607105
  error estimate for blocks of size 2^( 3) =       0.000514483719
  error estimate for blocks of size 2^( 4) =       0.000531832531
  error estimate for blocks of size 2^( 5) =       0.000543374410
  error estimate for blocks of size 2^( 6) =       0.000549370383
  error estimate for blocks of size 2^( 7) =       0.000553841939

      target function =      -0.747851590740
              le_mean =     -22.815038401873
             les_mean =     520.972945819902
             stat err =       0.000544604816
             autocorr =       1.366306674742
   target nu stat err =       0.000544604816
   target dn stat err =       0.002772793211
      target stat err =       0.002380332727
              std dev =       0.658904358647
             le_variance =       0.434154953845


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281503840187e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+06, overlap shift 5.5511e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747858248181       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747858248183       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747858248183       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747858248184       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747858248017       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747858247745       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747858250314       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747858250503       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747858247277       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+06 is 3.499647e-11

solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747858248181       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747858248181       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747858248181       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747858248197       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747858248181       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747858254610       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747858269920       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747858261320       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747858303951       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+07 is 8.749179e-12

solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747858248181       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747858248181       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747858248181       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747858248181       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747858248181       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747858283568       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747858391264       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747858379621       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747858262069       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+07 is 2.187207e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2067e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068127e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160601e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8539
    reference variance = 0.358844
====================================================
  Execution time = 4.3257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6039e-01
  Total weights = 1.9644e+06
  Execution time = 5.9541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438049819844
                                         uncertainty =       0.002881332490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438049819844
                                         uncertainty =       0.002881332490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467954482
  error estimate for blocks of size 2^( 2) =       0.000493438345
  error estimate for blocks of size 2^( 3) =       0.000516698743
  error estimate for blocks of size 2^( 4) =       0.000533884565
  error estimate for blocks of size 2^( 5) =       0.000544177310
  error estimate for blocks of size 2^( 6) =       0.000550599106
  error estimate for blocks of size 2^( 7) =       0.000553014360

      target function =      -0.736762123946
              le_mean =     -22.814790496168
             les_mean =     520.975060049561
             stat err =       0.000545418835
             autocorr =       1.358479350193
   target nu stat err =       0.000545418835
   target dn stat err =       0.011377368689
      target stat err =       0.009185919978
              std dev =       0.661787574897
             le_variance =       0.437962794289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438049819833
                                         uncertainty =       0.002881332487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438049819833
                                         uncertainty =       0.002881332487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467954482
  error estimate for blocks of size 2^( 2) =       0.000493438345
  error estimate for blocks of size 2^( 3) =       0.000516698743
  error estimate for blocks of size 2^( 4) =       0.000533884565
  error estimate for blocks of size 2^( 5) =       0.000544177310
  error estimate for blocks of size 2^( 6) =       0.000550599106
  error estimate for blocks of size 2^( 7) =       0.000553014360

      target function =      -0.736762124005
              le_mean =     -22.814790496168
             les_mean =     520.975060049477
             stat err =       0.000545418835
             autocorr =       1.358479350200
   target nu stat err =       0.000545418835
   target dn stat err =       0.011377368653
      target stat err =       0.009185919950
              std dev =       0.661787574889
             le_variance =       0.437962794277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438049819839
                                         uncertainty =       0.002881332488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438049819839
                                         uncertainty =       0.002881332488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467954482
  error estimate for blocks of size 2^( 2) =       0.000493438345
  error estimate for blocks of size 2^( 3) =       0.000516698743
  error estimate for blocks of size 2^( 4) =       0.000533884565
  error estimate for blocks of size 2^( 5) =       0.000544177310
  error estimate for blocks of size 2^( 6) =       0.000550599106
  error estimate for blocks of size 2^( 7) =       0.000553014360

      target function =      -0.736762123976
              le_mean =     -22.814790496168
             les_mean =     520.975060049519
             stat err =       0.000545418835
             autocorr =       1.358479350200
   target nu stat err =       0.000545418835
   target dn stat err =       0.011377368671
      target stat err =       0.009185919964
              std dev =       0.661787574893
             le_variance =       0.437962794283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438049819843
                                         uncertainty =       0.002881332490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438049819843
                                         uncertainty =       0.002881332490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467954482
  error estimate for blocks of size 2^( 2) =       0.000493438345
  error estimate for blocks of size 2^( 3) =       0.000516698743
  error estimate for blocks of size 2^( 4) =       0.000533884565
  error estimate for blocks of size 2^( 5) =       0.000544177310
  error estimate for blocks of size 2^( 6) =       0.000550599106
  error estimate for blocks of size 2^( 7) =       0.000553014360

      target function =      -0.736762123950
              le_mean =     -22.814790496168
             les_mean =     520.975060049556
             stat err =       0.000545418835
             autocorr =       1.358479350194
   target nu stat err =       0.000545418835
   target dn stat err =       0.011377368687
      target stat err =       0.009185919976
              std dev =       0.661787574897
             le_variance =       0.437962794288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736762123946        initial
     5.5511e+06     5.5511e+07             3.4996e-11        -0.736762124005  <--
     2.2204e+07     2.2204e+08             8.7492e-12        -0.736762123976
     8.8818e+07     8.8818e+08             2.1872e-12        -0.736762123950

*****************************************************************************
Applying the update for shift_i =   5.5511e+06     and shift_s =   5.5511e+07
*****************************************************************************

  Execution time = 7.6022e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068127e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525793e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160600e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2811e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7723
    reference variance = 0.38105
====================================================
  Execution time = 4.3699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4773e-01
  Total weights = 1.964414814e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7483e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435410423812
                                         uncertainty =       0.002401650928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435410423812
                                         uncertainty =       0.002401650928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466565939
  error estimate for blocks of size 2^( 2) =       0.000492207414
  error estimate for blocks of size 2^( 3) =       0.000516085420
  error estimate for blocks of size 2^( 4) =       0.000533911504
  error estimate for blocks of size 2^( 5) =       0.000544526535
  error estimate for blocks of size 2^( 6) =       0.000551496735
  error estimate for blocks of size 2^( 7) =       0.000553366243

      target function =      -0.747220349630
              le_mean =     -22.815631048027
             les_mean =     521.000753860913
             stat err =       0.000545825254
             autocorr =       1.368614666519
   target nu stat err =       0.000545825254
   target dn stat err =       0.002863233481
      target stat err =       0.002451515884
              std dev =       0.659823879095
             le_variance =       0.435367551424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281563104803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+06, overlap shift 1.3878e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747227518854       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747227518861       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747227518862       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747227518863       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747227518863       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747227518245       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747227520571       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747227518872       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747227517605       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+06 is 1.655712e-10

solving harmonic davidson linear method for identity shift 5.5511e+06, overlap shift 5.5511e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747227518854       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747227518856       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747227518856       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747227518856       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747227518857       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747227527690       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747227519444       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747227530696       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747227523388       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+06 is 4.139283e-11

solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747227518854       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747227518855       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747227518855       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747227518855       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747227518854       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747227518963       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747227544337       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747227534787       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747227512913       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+07 is 1.034824e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1457e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068128e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160600e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.9391
    reference variance = 1.66647
====================================================
  Execution time = 4.2689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4593e-01
  Total weights = 1.9643e+06
  Execution time = 5.9330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063883810
                                         uncertainty =       0.002443872388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063883810
                                         uncertainty =       0.002443872388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465847302
  error estimate for blocks of size 2^( 2) =       0.000491213472
  error estimate for blocks of size 2^( 3) =       0.000515579242
  error estimate for blocks of size 2^( 4) =       0.000533473693
  error estimate for blocks of size 2^( 5) =       0.000545886314
  error estimate for blocks of size 2^( 6) =       0.000551327594
  error estimate for blocks of size 2^( 7) =       0.000554093062

      target function =      -0.748705595635
              le_mean =     -22.814315479108
             les_mean =     520.938922070752
             stat err =       0.000546195166
             autocorr =       1.374701905068
   target nu stat err =       0.000546195166
   target dn stat err =       0.002946536719
      target stat err =       0.002523439011
              std dev =       0.658807572742
             le_variance =       0.434027417902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063883791
                                         uncertainty =       0.002443872386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063883791
                                         uncertainty =       0.002443872386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465847302
  error estimate for blocks of size 2^( 2) =       0.000491213472
  error estimate for blocks of size 2^( 3) =       0.000515579242
  error estimate for blocks of size 2^( 4) =       0.000533473693
  error estimate for blocks of size 2^( 5) =       0.000545886314
  error estimate for blocks of size 2^( 6) =       0.000551327594
  error estimate for blocks of size 2^( 7) =       0.000554093062

      target function =      -0.748705596098
              le_mean =     -22.814315479108
             les_mean =     520.938922070166
             stat err =       0.000546195166
             autocorr =       1.374701905141
   target nu stat err =       0.000546195166
   target dn stat err =       0.002946536718
      target stat err =       0.002523439014
              std dev =       0.658807572727
             le_variance =       0.434027417883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063883801
                                         uncertainty =       0.002443872387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063883801
                                         uncertainty =       0.002443872387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465847302
  error estimate for blocks of size 2^( 2) =       0.000491213472
  error estimate for blocks of size 2^( 3) =       0.000515579242
  error estimate for blocks of size 2^( 4) =       0.000533473693
  error estimate for blocks of size 2^( 5) =       0.000545886314
  error estimate for blocks of size 2^( 6) =       0.000551327594
  error estimate for blocks of size 2^( 7) =       0.000554093062

      target function =      -0.748705595866
              le_mean =     -22.814315479108
             les_mean =     520.938922070459
             stat err =       0.000546195166
             autocorr =       1.374701905091
   target nu stat err =       0.000546195166
   target dn stat err =       0.002946536718
      target stat err =       0.002523439013
              std dev =       0.658807572735
             le_variance =       0.434027417893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063883809
                                         uncertainty =       0.002443872388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434063883809
                                         uncertainty =       0.002443872388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465847302
  error estimate for blocks of size 2^( 2) =       0.000491213472
  error estimate for blocks of size 2^( 3) =       0.000515579242
  error estimate for blocks of size 2^( 4) =       0.000533473693
  error estimate for blocks of size 2^( 5) =       0.000545886314
  error estimate for blocks of size 2^( 6) =       0.000551327594
  error estimate for blocks of size 2^( 7) =       0.000554093062

      target function =      -0.748705595664
              le_mean =     -22.814315479108
             les_mean =     520.938922070715
             stat err =       0.000546195166
             autocorr =       1.374701905060
   target nu stat err =       0.000546195166
   target dn stat err =       0.002946536719
      target stat err =       0.002523439012
              std dev =       0.658807572741
             le_variance =       0.434027417901


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748705595635        initial
     1.3878e+06     1.3878e+07             1.6557e-10        -0.748705596098  <--
     5.5511e+06     5.5511e+07             4.1393e-11        -0.748705595866
     2.2204e+07     2.2204e+08             1.0348e-11        -0.748705595664

*****************************************************************************
Applying the update for shift_i =   1.3878e+06     and shift_s =   1.3878e+07
*****************************************************************************

  Execution time = 7.2627e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068131e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160600e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2410e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.833
    reference variance = 0.244654
====================================================
  Execution time = 4.5767e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4374e-01
  Total weights = 1.964451214e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432541916289
                                         uncertainty =       0.001868301999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432541916289
                                         uncertainty =       0.001868301999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464986091
  error estimate for blocks of size 2^( 2) =       0.000490302712
  error estimate for blocks of size 2^( 3) =       0.000514244745
  error estimate for blocks of size 2^( 4) =       0.000532107092
  error estimate for blocks of size 2^( 5) =       0.000542708662
  error estimate for blocks of size 2^( 6) =       0.000549129981
  error estimate for blocks of size 2^( 7) =       0.000552581839

      target function =      -0.750544607637
              le_mean =     -22.815390821967
             les_mean =     520.985802180846
             stat err =       0.000544131893
             autocorr =       1.369394059401
   target nu stat err =       0.000544131893
   target dn stat err =       0.002432751028
      target stat err =       0.002124018987
              std dev =       0.657589636560
             le_variance =       0.432424130111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281539082197e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+05, overlap shift 3.4694e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750549653818       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750549653843       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750549653850       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750549653852       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750549653853       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750549653503       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750549653853       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750549653853       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750549653853       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750549653853       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+05 is 4.161025e-10

solving harmonic davidson linear method for identity shift 1.3878e+06, overlap shift 1.3878e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750549653818       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750549653824       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750549653826       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750549653826       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750549653827       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750549653827       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750549653827       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750549653827       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750549653999       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750549653827       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+06 is 1.040255e-10

solving harmonic davidson linear method for identity shift 5.5511e+06, overlap shift 5.5511e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750549653818       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750549653819       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750549653820       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750549653521       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750549656120       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750549656782       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750549649424       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750549647902       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750549650580       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750549658671       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+06 is 2.600631e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3545e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068132e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662295e-04 3 1  ON 61
ci_63                -7.728497e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160601e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7912
    reference variance = 0.238867
====================================================
  Execution time = 4.2609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4661e-01
  Total weights = 1.9648e+06
  Execution time = 6.0633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434874127892
                                         uncertainty =       0.002545387660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434874127892
                                         uncertainty =       0.002545387660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466276860
  error estimate for blocks of size 2^( 2) =       0.000491169204
  error estimate for blocks of size 2^( 3) =       0.000515284249
  error estimate for blocks of size 2^( 4) =       0.000532290251
  error estimate for blocks of size 2^( 5) =       0.000543520284
  error estimate for blocks of size 2^( 6) =       0.000549113977
  error estimate for blocks of size 2^( 7) =       0.000552171674

      target function =      -0.748134650089
              le_mean =     -22.814274832371
             les_mean =     520.937750261503
             stat err =       0.000544274046
             autocorr =       1.362534551488
   target nu stat err =       0.000544274046
   target dn stat err =       0.003521764760
      target stat err =       0.002984762285
              std dev =       0.659415059890
             le_variance =       0.434828221210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434874127858
                                         uncertainty =       0.002545387676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434874127858
                                         uncertainty =       0.002545387676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466276860
  error estimate for blocks of size 2^( 2) =       0.000491169204
  error estimate for blocks of size 2^( 3) =       0.000515284249
  error estimate for blocks of size 2^( 4) =       0.000532290251
  error estimate for blocks of size 2^( 5) =       0.000543520284
  error estimate for blocks of size 2^( 6) =       0.000549113977
  error estimate for blocks of size 2^( 7) =       0.000552171674

      target function =      -0.748134649843
              le_mean =     -22.814274832373
             les_mean =     520.937750261891
             stat err =       0.000544274047
             autocorr =       1.362534551709
   target nu stat err =       0.000544274047
   target dn stat err =       0.003521764785
      target stat err =       0.002984762304
              std dev =       0.659415059865
             le_variance =       0.434828221177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434874127875
                                         uncertainty =       0.002545387668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434874127875
                                         uncertainty =       0.002545387668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466276860
  error estimate for blocks of size 2^( 2) =       0.000491169204
  error estimate for blocks of size 2^( 3) =       0.000515284249
  error estimate for blocks of size 2^( 4) =       0.000532290251
  error estimate for blocks of size 2^( 5) =       0.000543520284
  error estimate for blocks of size 2^( 6) =       0.000549113977
  error estimate for blocks of size 2^( 7) =       0.000552171674

      target function =      -0.748134649966
              le_mean =     -22.814274832372
             les_mean =     520.937750261697
             stat err =       0.000544274046
             autocorr =       1.362534551599
   target nu stat err =       0.000544274046
   target dn stat err =       0.003521764773
      target stat err =       0.002984762294
              std dev =       0.659415059878
             le_variance =       0.434828221194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434874127890
                                         uncertainty =       0.002545387661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434874127890
                                         uncertainty =       0.002545387661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466276860
  error estimate for blocks of size 2^( 2) =       0.000491169204
  error estimate for blocks of size 2^( 3) =       0.000515284249
  error estimate for blocks of size 2^( 4) =       0.000532290251
  error estimate for blocks of size 2^( 5) =       0.000543520284
  error estimate for blocks of size 2^( 6) =       0.000549113977
  error estimate for blocks of size 2^( 7) =       0.000552171674

      target function =      -0.748134650074
              le_mean =     -22.814274832371
             les_mean =     520.937750261528
             stat err =       0.000544274046
             autocorr =       1.362534551498
   target nu stat err =       0.000544274046
   target dn stat err =       0.003521764762
      target stat err =       0.002984762286
              std dev =       0.659415059889
             le_variance =       0.434828221208


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748134650089        initial  <--
     3.4694e+05     3.4694e+06             4.1610e-10        -0.748134649843
     1.3878e+06     1.3878e+07             1.0403e-10        -0.748134649966
     5.5511e+06     5.5511e+07             2.6006e-11        -0.748134650074

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.8706
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068131e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160600e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2644e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.7363
    reference variance = 0.505459
====================================================
  Execution time = 4.5201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4212e-01
  Total weights = 1.964439083e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430071502408
                                         uncertainty =       0.001685098264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430071502408
                                         uncertainty =       0.001685098264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463779459
  error estimate for blocks of size 2^( 2) =       0.000489368071
  error estimate for blocks of size 2^( 3) =       0.000513021918
  error estimate for blocks of size 2^( 4) =       0.000530225397
  error estimate for blocks of size 2^( 5) =       0.000540811675
  error estimate for blocks of size 2^( 6) =       0.000546620112
  error estimate for blocks of size 2^( 7) =       0.000550636499

      target function =      -0.751891795566
              le_mean =     -22.814295402640
             les_mean =     520.934191889173
             stat err =       0.000542073421
             autocorr =       1.366133706401
   target nu stat err =       0.000542073421
   target dn stat err =       0.002469261956
      target stat err =       0.002156590127
              std dev =       0.655883201290
             le_variance =       0.430182773734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429540264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751897003893       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751897003895       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751897003895       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751897003896       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751897003895       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751897003984       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751897001089       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751896996456       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751897008838       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+06 is 5.740789e-11

solving harmonic davidson linear method for identity shift 1.3878e+07, overlap shift 1.3878e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751897003893       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751897003893       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751897003894       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751897003894       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751897003894       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751897001335       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751897017773       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751896996905       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751897001031       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+07 is 1.435191e-11

solving harmonic davidson linear method for identity shift 5.5511e+07, overlap shift 5.5511e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751897003893       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751897003893       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751897003893       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751896998635       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751896991861       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751897002708       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751897026830       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751896957273       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751896995711       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+07 is 3.588153e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3052e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068131e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662296e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160600e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.7898
    reference variance = 0.353996
====================================================
  Execution time = 4.2565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5139e-01
  Total weights = 1.9644e+06
  Execution time = 5.9531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439203728519
                                         uncertainty =       0.002393475169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439203728519
                                         uncertainty =       0.002393475169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468562820
  error estimate for blocks of size 2^( 2) =       0.000494055526
  error estimate for blocks of size 2^( 3) =       0.000518135524
  error estimate for blocks of size 2^( 4) =       0.000536310541
  error estimate for blocks of size 2^( 5) =       0.000548739468
  error estimate for blocks of size 2^( 6) =       0.000553096472
  error estimate for blocks of size 2^( 7) =       0.000557084433

      target function =      -0.744196472181
              le_mean =     -22.814449413093
             les_mean =     520.950491269073
             stat err =       0.000548807729
             autocorr =       1.371844189681
   target nu stat err =       0.000548807729
   target dn stat err =       0.002894724477
      target stat err =       0.002453935688
              std dev =       0.662647894753
             le_variance =       0.439102232420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439203728512
                                         uncertainty =       0.002393475169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439203728512
                                         uncertainty =       0.002393475169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468562820
  error estimate for blocks of size 2^( 2) =       0.000494055526
  error estimate for blocks of size 2^( 3) =       0.000518135524
  error estimate for blocks of size 2^( 4) =       0.000536310541
  error estimate for blocks of size 2^( 5) =       0.000548739468
  error estimate for blocks of size 2^( 6) =       0.000553096472
  error estimate for blocks of size 2^( 7) =       0.000557084433

      target function =      -0.744196472202
              le_mean =     -22.814449413093
             les_mean =     520.950491269056
             stat err =       0.000548807729
             autocorr =       1.371844189718
   target nu stat err =       0.000548807729
   target dn stat err =       0.002894724475
      target stat err =       0.002453935687
              std dev =       0.662647894747
             le_variance =       0.439102232413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439203728515
                                         uncertainty =       0.002393475169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439203728515
                                         uncertainty =       0.002393475169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468562820
  error estimate for blocks of size 2^( 2) =       0.000494055526
  error estimate for blocks of size 2^( 3) =       0.000518135524
  error estimate for blocks of size 2^( 4) =       0.000536310541
  error estimate for blocks of size 2^( 5) =       0.000548739468
  error estimate for blocks of size 2^( 6) =       0.000553096472
  error estimate for blocks of size 2^( 7) =       0.000557084433

      target function =      -0.744196472191
              le_mean =     -22.814449413093
             les_mean =     520.950491269065
             stat err =       0.000548807729
             autocorr =       1.371844189696
   target nu stat err =       0.000548807729
   target dn stat err =       0.002894724476
      target stat err =       0.002453935688
              std dev =       0.662647894750
             le_variance =       0.439102232416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439203728518
                                         uncertainty =       0.002393475169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439203728518
                                         uncertainty =       0.002393475169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468562820
  error estimate for blocks of size 2^( 2) =       0.000494055526
  error estimate for blocks of size 2^( 3) =       0.000518135524
  error estimate for blocks of size 2^( 4) =       0.000536310541
  error estimate for blocks of size 2^( 5) =       0.000548739468
  error estimate for blocks of size 2^( 6) =       0.000553096472
  error estimate for blocks of size 2^( 7) =       0.000557084433

      target function =      -0.744196472182
              le_mean =     -22.814449413093
             les_mean =     520.950491269072
             stat err =       0.000548807729
             autocorr =       1.371844189676
   target nu stat err =       0.000548807729
   target dn stat err =       0.002894724477
      target stat err =       0.002453935688
              std dev =       0.662647894752
             le_variance =       0.439102232420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744196472181        initial
     3.4694e+06     3.4694e+07             5.7408e-11        -0.744196472202  <--
     1.3878e+07     1.3878e+08             1.4352e-11        -0.744196472191
     5.5511e+07     5.5511e+08             3.5882e-12        -0.744196472182

*****************************************************************************
Applying the update for shift_i =   3.4694e+06     and shift_s =   3.4694e+07
*****************************************************************************

  Execution time = 7.2792e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068131e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662295e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160599e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2591e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.8155
    reference variance = 0.534472
====================================================
  Execution time = 4.3642e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4784e-01
  Total weights = 1.964545161e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433528438017
                                         uncertainty =       0.001866617009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433528438017
                                         uncertainty =       0.001866617009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465550175
  error estimate for blocks of size 2^( 2) =       0.000490948488
  error estimate for blocks of size 2^( 3) =       0.000514864584
  error estimate for blocks of size 2^( 4) =       0.000532965628
  error estimate for blocks of size 2^( 5) =       0.000543407350
  error estimate for blocks of size 2^( 6) =       0.000548916733
  error estimate for blocks of size 2^( 7) =       0.000553388151

      target function =      -0.747120293238
              le_mean =     -22.815028100679
             les_mean =     520.973351058767
             stat err =       0.000544669465
             autocorr =       1.368778165756
   target nu stat err =       0.000544669465
   target dn stat err =       0.003661206406
      target stat err =       0.003093502565
              std dev =       0.658387372057
             le_variance =       0.433473931684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281502810068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747132122064       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747132122091       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747132122095       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747132122615       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747132122829       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747132122473       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747132122579       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747132121558       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747132125392       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+05 is 2.823191e-10

solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747132122064       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747132122071       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747132122072       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747132122072       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747132122072       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747132121028       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747132121842       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747132122072       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747132123544       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+06 is 7.057974e-11

solving harmonic davidson linear method for identity shift 1.3878e+07, overlap shift 1.3878e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747132122064       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747132122066       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747132122066       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747132122066       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747132122078       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747132120132       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747132139193       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747132143396       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747132117935       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+07 is 1.764480e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.341239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1353e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245853e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068131e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662295e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160598e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.7295
    reference variance = 0.554448
====================================================
  Execution time = 4.3264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5462e-01
  Total weights = 1.9644e+06
  Execution time = 5.9334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015764396
                                         uncertainty =       0.002408639877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015764396
                                         uncertainty =       0.002408639877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467478981
  error estimate for blocks of size 2^( 2) =       0.000493113834
  error estimate for blocks of size 2^( 3) =       0.000517342257
  error estimate for blocks of size 2^( 4) =       0.000535065000
  error estimate for blocks of size 2^( 5) =       0.000545494030
  error estimate for blocks of size 2^( 6) =       0.000551640449
  error estimate for blocks of size 2^( 7) =       0.000557212098

      target function =      -0.741544119773
              le_mean =     -22.815445720503
             les_mean =     520.999181927062
             stat err =       0.000547352894
             autocorr =       1.370915416439
   target nu stat err =       0.000547352894
   target dn stat err =       0.004159874062
      target stat err =       0.003451109096
              std dev =       0.661115115171
             le_variance =       0.437073195507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015764356
                                         uncertainty =       0.002408639880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015764356
                                         uncertainty =       0.002408639880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467478981
  error estimate for blocks of size 2^( 2) =       0.000493113834
  error estimate for blocks of size 2^( 3) =       0.000517342257
  error estimate for blocks of size 2^( 4) =       0.000535065000
  error estimate for blocks of size 2^( 5) =       0.000545494030
  error estimate for blocks of size 2^( 6) =       0.000551640449
  error estimate for blocks of size 2^( 7) =       0.000557212098

      target function =      -0.741544136613
              le_mean =     -22.815445720502
             les_mean =     520.999181906397
             stat err =       0.000547352894
             autocorr =       1.370915416665
   target nu stat err =       0.000547352894
   target dn stat err =       0.004159875395
      target stat err =       0.003451110323
              std dev =       0.661115115141
             le_variance =       0.437073195468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015764376
                                         uncertainty =       0.002408639878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015764376
                                         uncertainty =       0.002408639878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467478981
  error estimate for blocks of size 2^( 2) =       0.000493113834
  error estimate for blocks of size 2^( 3) =       0.000517342257
  error estimate for blocks of size 2^( 4) =       0.000535065000
  error estimate for blocks of size 2^( 5) =       0.000545494030
  error estimate for blocks of size 2^( 6) =       0.000551640449
  error estimate for blocks of size 2^( 7) =       0.000557212098

      target function =      -0.741544128194
              le_mean =     -22.815445720502
             les_mean =     520.999181916728
             stat err =       0.000547352894
             autocorr =       1.370915416558
   target nu stat err =       0.000547352894
   target dn stat err =       0.004159874729
      target stat err =       0.003451109710
              std dev =       0.661115115156
             le_variance =       0.437073195488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015764393
                                         uncertainty =       0.002408639877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437015764393
                                         uncertainty =       0.002408639877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467478981
  error estimate for blocks of size 2^( 2) =       0.000493113834
  error estimate for blocks of size 2^( 3) =       0.000517342257
  error estimate for blocks of size 2^( 4) =       0.000535065000
  error estimate for blocks of size 2^( 5) =       0.000545494030
  error estimate for blocks of size 2^( 6) =       0.000551640449
  error estimate for blocks of size 2^( 7) =       0.000557212098

      target function =      -0.741544120826
              le_mean =     -22.815445720503
             les_mean =     520.999181925770
             stat err =       0.000547352894
             autocorr =       1.370915416443
   target nu stat err =       0.000547352894
   target dn stat err =       0.004159874145
      target stat err =       0.003451109173
              std dev =       0.661115115169
             le_variance =       0.437073195505


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741544119773        initial
     8.6736e+05     8.6736e+06             2.8232e-10        -0.741544136613  <--
     3.4694e+06     3.4694e+07             7.0580e-11        -0.741544128194
     1.3878e+07     1.3878e+08             1.7645e-11        -0.741544120826

*****************************************************************************
Applying the update for shift_i =   8.6736e+05     and shift_s =   8.6736e+06
*****************************************************************************

  Execution time = 7.3022e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245852e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439395e-04 3 1  ON 50
ci_52                 8.068131e-05 3 1  ON 51
ci_53                -6.382742e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525794e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662295e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632743e-04 3 1  ON 63
ci_65                 6.160596e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949579e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2445e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7891
    reference variance = 0.294691
====================================================
  Execution time = 4.2748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5183e-01
  Total weights = 1.964466687e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436233940661
                                         uncertainty =       0.001772730172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436233940661
                                         uncertainty =       0.001772730172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466986076
  error estimate for blocks of size 2^( 2) =       0.000492331514
  error estimate for blocks of size 2^( 3) =       0.000517065756
  error estimate for blocks of size 2^( 4) =       0.000535479003
  error estimate for blocks of size 2^( 5) =       0.000546527912
  error estimate for blocks of size 2^( 6) =       0.000553398759
  error estimate for blocks of size 2^( 7) =       0.000556043343

      target function =      -0.743832593796
              le_mean =     -22.815395605793
             les_mean =     520.994108009622
             stat err =       0.000547862255
             autocorr =       1.376369051035
   target nu stat err =       0.000547862255
   target dn stat err =       0.003458000656
      target stat err =       0.002905680614
              std dev =       0.660418041435
             le_variance =       0.436151989452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281539560579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743843002454       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743843002553       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743843002564       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743843002565       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743843002662       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743843002821       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743843002401       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743843002941       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743843002431       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+05 is 7.411336e-10

solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743843002454       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743843002479       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743843002482       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743843002482       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743843002345       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743843003063       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743843002702       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743843002541       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743843002593       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+05 is 1.852835e-10

solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743843002454       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743843002461       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743843002461       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743843002461       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743843002443       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743843003284       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743843004560       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743842994016       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743843006695       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+06 is 4.632079e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0441e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571472e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940906e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581148e-04 3 1  ON 30
ci_32                -8.464091e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245852e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694134e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439396e-04 3 1  ON 50
ci_52                 8.068132e-05 3 1  ON 51
ci_53                -6.382741e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525795e-04 3 1  ON 54
ci_56                 2.626582e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662295e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632742e-04 3 1  ON 63
ci_65                 6.160589e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949578e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.843
    reference variance = 0.362021
====================================================
  Execution time = 4.2882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4708e-01
  Total weights = 1.9643e+06
  Execution time = 5.9156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434332654096
                                         uncertainty =       0.002078985305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434332654096
                                         uncertainty =       0.002078985305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466009057
  error estimate for blocks of size 2^( 2) =       0.000491317960
  error estimate for blocks of size 2^( 3) =       0.000515094889
  error estimate for blocks of size 2^( 4) =       0.000532900008
  error estimate for blocks of size 2^( 5) =       0.000543007718
  error estimate for blocks of size 2^( 6) =       0.000548549846
  error estimate for blocks of size 2^( 7) =       0.000553543130

      target function =      -0.747755577053
              le_mean =     -22.814999623726
             les_mean =     520.971291718749
             stat err =       0.000544500175
             autocorr =       1.365234745982
   target nu stat err =       0.000544500175
   target dn stat err =       0.002780778737
      target stat err =       0.002385986119
              std dev =       0.659036328954
             le_variance =       0.434328882882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434332653969
                                         uncertainty =       0.002078985287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434332653969
                                         uncertainty =       0.002078985287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466009057
  error estimate for blocks of size 2^( 2) =       0.000491317960
  error estimate for blocks of size 2^( 3) =       0.000515094889
  error estimate for blocks of size 2^( 4) =       0.000532900008
  error estimate for blocks of size 2^( 5) =       0.000543007718
  error estimate for blocks of size 2^( 6) =       0.000548549846
  error estimate for blocks of size 2^( 7) =       0.000553543130

      target function =      -0.747755577362
              le_mean =     -22.814999623726
             les_mean =     520.971291718412
             stat err =       0.000544500175
             autocorr =       1.365234746516
   target nu stat err =       0.000544500175
   target dn stat err =       0.002780778694
      target stat err =       0.002385986086
              std dev =       0.659036328858
             le_variance =       0.434328882755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434332654033
                                         uncertainty =       0.002078985296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434332654033
                                         uncertainty =       0.002078985296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466009057
  error estimate for blocks of size 2^( 2) =       0.000491317960
  error estimate for blocks of size 2^( 3) =       0.000515094889
  error estimate for blocks of size 2^( 4) =       0.000532900008
  error estimate for blocks of size 2^( 5) =       0.000543007718
  error estimate for blocks of size 2^( 6) =       0.000548549846
  error estimate for blocks of size 2^( 7) =       0.000553543130

      target function =      -0.747755577207
              le_mean =     -22.814999623726
             les_mean =     520.971291718580
             stat err =       0.000544500175
             autocorr =       1.365234746236
   target nu stat err =       0.000544500175
   target dn stat err =       0.002780778715
      target stat err =       0.002385986103
              std dev =       0.659036328906
             le_variance =       0.434328882818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434332654088
                                         uncertainty =       0.002078985304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434332654088
                                         uncertainty =       0.002078985304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466009057
  error estimate for blocks of size 2^( 2) =       0.000491317960
  error estimate for blocks of size 2^( 3) =       0.000515094889
  error estimate for blocks of size 2^( 4) =       0.000532900008
  error estimate for blocks of size 2^( 5) =       0.000543007718
  error estimate for blocks of size 2^( 6) =       0.000548549846
  error estimate for blocks of size 2^( 7) =       0.000553543130

      target function =      -0.747755577072
              le_mean =     -22.814999623726
             les_mean =     520.971291718728
             stat err =       0.000544500175
             autocorr =       1.365234746013
   target nu stat err =       0.000544500175
   target dn stat err =       0.002780778734
      target stat err =       0.002385986117
              std dev =       0.659036328948
             le_variance =       0.434328882874


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747755577053        initial
     2.1684e+05     2.1684e+06             7.4113e-10        -0.747755577362  <--
     8.6736e+05     8.6736e+06             1.8528e-10        -0.747755577207
     3.4694e+06     3.4694e+07             4.6321e-11        -0.747755577072

*****************************************************************************
Applying the update for shift_i =   2.1684e+05     and shift_s =   2.1684e+06
*****************************************************************************

  Execution time = 7.2718e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571471e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940907e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306952e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581149e-04 3 1  ON 30
ci_32                -8.464090e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137983e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245851e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273533e-04 3 1  ON 44
ci_46                -8.694133e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439397e-04 3 1  ON 50
ci_52                 8.068134e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525796e-04 3 1  ON 54
ci_56                 2.626581e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294348e-04 3 1  ON 60
ci_62                -6.662293e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632741e-04 3 1  ON 63
ci_65                 6.160569e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949578e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2322e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.7872
    reference variance = 0.596863
====================================================
  Execution time = 4.2601e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4255e-01
  Total weights = 1.964511555e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431213530971
                                         uncertainty =       0.001719471141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431213530971
                                         uncertainty =       0.001719471141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464334321
  error estimate for blocks of size 2^( 2) =       0.000489906871
  error estimate for blocks of size 2^( 3) =       0.000513959054
  error estimate for blocks of size 2^( 4) =       0.000531931873
  error estimate for blocks of size 2^( 5) =       0.000543304033
  error estimate for blocks of size 2^( 6) =       0.000551095014
  error estimate for blocks of size 2^( 7) =       0.000554145280

      target function =      -0.751532261038
              le_mean =     -22.814429935011
             les_mean =     520.940762336991
             stat err =       0.000545119050
             autocorr =       1.378228251742
   target nu stat err =       0.000545119050
   target dn stat err =       0.002383391738
      target stat err =       0.002087070497
              std dev =       0.656667893812
             le_variance =       0.431212722764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281442993501e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+04, overlap shift 5.4210e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751537097803       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751537097950       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751537097968       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751537097972       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751537097972       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751537097968       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751537097897       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751537097786       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751537098043       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+04 is 2.472233e-09

solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751537097803       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751537097839       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751537097844       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751537097849       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751537097798       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751537098007       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751537097965       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751537098306       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751537097953       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+05 is 6.180585e-10

solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751537097803       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751537097812       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751537097813       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751537097706       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751537097813       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751537096476       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751537097813       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751537098231       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751537099635       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+05 is 1.545146e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0319e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571471e-03 3 1  ON 7
ci_09                -9.045284e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940907e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306952e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581150e-04 3 1  ON 30
ci_32                -8.464089e-04 3 1  ON 31
ci_33                -1.467129e-03 3 1  ON 32
ci_34                 1.137983e-03 3 1  ON 33
ci_35                 1.456800e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245851e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239190e-03 3 1  ON 43
ci_45                -5.273534e-04 3 1  ON 44
ci_46                -8.694133e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119954e-04 3 1  ON 49
ci_51                 1.439397e-04 3 1  ON 50
ci_52                 8.068144e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525797e-04 3 1  ON 54
ci_56                 2.626581e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294350e-04 3 1  ON 60
ci_62                -6.662292e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632740e-04 3 1  ON 63
ci_65                 6.160571e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949577e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.9385
    reference variance = 1.27766
====================================================
  Execution time = 4.2324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4685e-01
  Total weights = 1.9643e+06
  Execution time = 5.8893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434710609310
                                         uncertainty =       0.002206510620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434710609310
                                         uncertainty =       0.002206510620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466350459
  error estimate for blocks of size 2^( 2) =       0.000491879745
  error estimate for blocks of size 2^( 3) =       0.000515704210
  error estimate for blocks of size 2^( 4) =       0.000533533598
  error estimate for blocks of size 2^( 5) =       0.000544820472
  error estimate for blocks of size 2^( 6) =       0.000551585074
  error estimate for blocks of size 2^( 7) =       0.000556818913

      target function =      -0.747939394260
              le_mean =     -22.814092271829
             les_mean =     520.929659840009
             stat err =       0.000546689514
             autocorr =       1.374221281748
   target nu stat err =       0.000546689514
   target dn stat err =       0.002539103546
      target stat err =       0.002191271416
              std dev =       0.659519144586
             le_variance =       0.434965502076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434710609006
                                         uncertainty =       0.002206510617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434710609006
                                         uncertainty =       0.002206510617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466350459
  error estimate for blocks of size 2^( 2) =       0.000491879745
  error estimate for blocks of size 2^( 3) =       0.000515704210
  error estimate for blocks of size 2^( 4) =       0.000533533598
  error estimate for blocks of size 2^( 5) =       0.000544820472
  error estimate for blocks of size 2^( 6) =       0.000551585074
  error estimate for blocks of size 2^( 7) =       0.000556818913

      target function =      -0.747939394029
              le_mean =     -22.814092271830
             les_mean =     520.929659840358
             stat err =       0.000546689514
             autocorr =       1.374221283416
   target nu stat err =       0.000546689514
   target dn stat err =       0.002539103459
      target stat err =       0.002191271346
              std dev =       0.659519144358
             le_variance =       0.434965501775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434710609158
                                         uncertainty =       0.002206510618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434710609158
                                         uncertainty =       0.002206510618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466350459
  error estimate for blocks of size 2^( 2) =       0.000491879745
  error estimate for blocks of size 2^( 3) =       0.000515704210
  error estimate for blocks of size 2^( 4) =       0.000533533598
  error estimate for blocks of size 2^( 5) =       0.000544820472
  error estimate for blocks of size 2^( 6) =       0.000551585074
  error estimate for blocks of size 2^( 7) =       0.000556818913

      target function =      -0.747939394144
              le_mean =     -22.814092271829
             les_mean =     520.929659840184
             stat err =       0.000546689514
             autocorr =       1.374221282588
   target nu stat err =       0.000546689514
   target dn stat err =       0.002539103502
      target stat err =       0.002191271381
              std dev =       0.659519144472
             le_variance =       0.434965501926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434710609291
                                         uncertainty =       0.002206510620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434710609291
                                         uncertainty =       0.002206510620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466350459
  error estimate for blocks of size 2^( 2) =       0.000491879745
  error estimate for blocks of size 2^( 3) =       0.000515704210
  error estimate for blocks of size 2^( 4) =       0.000533533598
  error estimate for blocks of size 2^( 5) =       0.000544820472
  error estimate for blocks of size 2^( 6) =       0.000551585074
  error estimate for blocks of size 2^( 7) =       0.000556818913

      target function =      -0.747939394245
              le_mean =     -22.814092271829
             les_mean =     520.929659840031
             stat err =       0.000546689514
             autocorr =       1.374221281863
   target nu stat err =       0.000546689514
   target dn stat err =       0.002539103540
      target stat err =       0.002191271412
              std dev =       0.659519144572
             le_variance =       0.434965502057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747939394260        initial  <--
     5.4210e+04     5.4210e+05             2.4722e-09        -0.747939394029
     2.1684e+05     2.1684e+06             6.1806e-10        -0.747939394144
     8.6736e+05     8.6736e+06             1.5451e-10        -0.747939394245

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 76.0737
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571471e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940907e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306952e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581149e-04 3 1  ON 30
ci_32                -8.464090e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137983e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245851e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273533e-04 3 1  ON 44
ci_46                -8.694133e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439397e-04 3 1  ON 50
ci_52                 8.068134e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525796e-04 3 1  ON 54
ci_56                 2.626581e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294348e-04 3 1  ON 60
ci_62                -6.662293e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632741e-04 3 1  ON 63
ci_65                 6.160569e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949578e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318186e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2640e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.8556
    reference variance = 0.323476
====================================================
  Execution time = 4.3042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4691e-01
  Total weights = 1.964538457e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435268594101
                                         uncertainty =       0.001970290029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435268594101
                                         uncertainty =       0.001970290029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466531104
  error estimate for blocks of size 2^( 2) =       0.000491969055
  error estimate for blocks of size 2^( 3) =       0.000515519233
  error estimate for blocks of size 2^( 4) =       0.000532799995
  error estimate for blocks of size 2^( 5) =       0.000543179901
  error estimate for blocks of size 2^( 6) =       0.000549679171
  error estimate for blocks of size 2^( 7) =       0.000550111808

      target function =      -0.747905627623
              le_mean =     -22.815024282145
             les_mean =     520.972238769785
             stat err =       0.000543942719
             autocorr =       1.359393305734
   target nu stat err =       0.000543942719
   target dn stat err =       0.002360870395
      target stat err =       0.002051389818
              std dev =       0.659774614972
             le_variance =       0.435302542561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281502428215e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747910248687       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747910248707       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747910248709       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747910248710       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747910248811       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747910248710       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747910249381       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747910249881       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747910249693       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747910249493       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+05 is 3.262523e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747910248687       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747910248692       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747910248693       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747910248796       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747910248360       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747910248980       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747910248495       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747910250397       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747910249705       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747910247063       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+06 is 8.156310e-11

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747910248687       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747910248688       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747910248688       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747910246981       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747910254657       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747910250191       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747910259051       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747910235173       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747910254991       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747910235731       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+06 is 2.039072e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0748e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571471e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940907e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306952e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581150e-04 3 1  ON 30
ci_32                -8.464090e-04 3 1  ON 31
ci_33                -1.467130e-03 3 1  ON 32
ci_34                 1.137983e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245852e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273533e-04 3 1  ON 44
ci_46                -8.694132e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439397e-04 3 1  ON 50
ci_52                 8.068133e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525796e-04 3 1  ON 54
ci_56                 2.626581e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294348e-04 3 1  ON 60
ci_62                -6.662293e-04 3 1  ON 61
ci_63                -7.728499e-04 3 1  ON 62
ci_64                -2.632741e-04 3 1  ON 63
ci_65                 6.160570e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949578e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318185e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.8461
    reference variance = 0.324348
====================================================
  Execution time = 4.1420e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4708e-01
  Total weights = 1.9642e+06
  Execution time = 5.8944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433670027970
                                         uncertainty =       0.001710042037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433670027970
                                         uncertainty =       0.001710042037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465651334
  error estimate for blocks of size 2^( 2) =       0.000491103164
  error estimate for blocks of size 2^( 3) =       0.000515448243
  error estimate for blocks of size 2^( 4) =       0.000533139470
  error estimate for blocks of size 2^( 5) =       0.000544597067
  error estimate for blocks of size 2^( 6) =       0.000550627456
  error estimate for blocks of size 2^( 7) =       0.000552642773

      target function =      -0.747754741672
              le_mean =     -22.814598660114
             les_mean =     520.952993505159
             stat err =       0.000545251691
             autocorr =       1.371110133540
   target nu stat err =       0.000545251691
   target dn stat err =       0.002644080868
      target stat err =       0.002275264244
              std dev =       0.658530431414
             le_variance =       0.433662329098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433670027932
                                         uncertainty =       0.001710042035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433670027932
                                         uncertainty =       0.001710042035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465651334
  error estimate for blocks of size 2^( 2) =       0.000491103164
  error estimate for blocks of size 2^( 3) =       0.000515448243
  error estimate for blocks of size 2^( 4) =       0.000533139470
  error estimate for blocks of size 2^( 5) =       0.000544597067
  error estimate for blocks of size 2^( 6) =       0.000550627456
  error estimate for blocks of size 2^( 7) =       0.000552642773

      target function =      -0.747754742039
              le_mean =     -22.814598660115
             les_mean =     520.952993504723
             stat err =       0.000545251691
             autocorr =       1.371110133754
   target nu stat err =       0.000545251691
   target dn stat err =       0.002644080779
      target stat err =       0.002275264174
              std dev =       0.658530431385
             le_variance =       0.433662329061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433670027951
                                         uncertainty =       0.001710042036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433670027951
                                         uncertainty =       0.001710042036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465651334
  error estimate for blocks of size 2^( 2) =       0.000491103164
  error estimate for blocks of size 2^( 3) =       0.000515448243
  error estimate for blocks of size 2^( 4) =       0.000533139470
  error estimate for blocks of size 2^( 5) =       0.000544597067
  error estimate for blocks of size 2^( 6) =       0.000550627456
  error estimate for blocks of size 2^( 7) =       0.000552642773

      target function =      -0.747754741856
              le_mean =     -22.814598660114
             les_mean =     520.952993504941
             stat err =       0.000545251691
             autocorr =       1.371110133644
   target nu stat err =       0.000545251691
   target dn stat err =       0.002644080824
      target stat err =       0.002275264209
              std dev =       0.658530431400
             le_variance =       0.433662329079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433670027968
                                         uncertainty =       0.001710042037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433670027968
                                         uncertainty =       0.001710042037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465651334
  error estimate for blocks of size 2^( 2) =       0.000491103164
  error estimate for blocks of size 2^( 3) =       0.000515448243
  error estimate for blocks of size 2^( 4) =       0.000533139470
  error estimate for blocks of size 2^( 5) =       0.000544597067
  error estimate for blocks of size 2^( 6) =       0.000550627456
  error estimate for blocks of size 2^( 7) =       0.000552642773

      target function =      -0.747754741695
              le_mean =     -22.814598660114
             les_mean =     520.952993505132
             stat err =       0.000545251691
             autocorr =       1.371110133546
   target nu stat err =       0.000545251691
   target dn stat err =       0.002644080863
      target stat err =       0.002275264239
              std dev =       0.658530431412
             le_variance =       0.433662329096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747754741672        initial
     5.4210e+05     5.4210e+06             3.2625e-10        -0.747754742039  <--
     2.1684e+06     2.1684e+07             8.1563e-11        -0.747754741856
     8.6736e+06     8.6736e+07             2.0391e-11        -0.747754741695

*****************************************************************************
Applying the update for shift_i =   5.4210e+05     and shift_s =   5.4210e+06
*****************************************************************************

  Execution time = 7.1045e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571471e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940907e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306952e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581151e-04 3 1  ON 30
ci_32                -8.464090e-04 3 1  ON 31
ci_33                -1.467129e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245852e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239191e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694132e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439397e-04 3 1  ON 50
ci_52                 8.068131e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525797e-04 3 1  ON 54
ci_56                 2.626581e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428913e-04 3 1  ON 59
ci_61                -1.294348e-04 3 1  ON 60
ci_62                -6.662292e-04 3 1  ON 61
ci_63                -7.728498e-04 3 1  ON 62
ci_64                -2.632741e-04 3 1  ON 63
ci_65                 6.160570e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949578e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318184e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2186e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8653
    reference variance = 0.337618
====================================================
  Execution time = 4.4500e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4872e-01
  Total weights = 1.964205649e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437037616149
                                         uncertainty =       0.002365751768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437037616149
                                         uncertainty =       0.002365751768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467443020
  error estimate for blocks of size 2^( 2) =       0.000492642516
  error estimate for blocks of size 2^( 3) =       0.000516720495
  error estimate for blocks of size 2^( 4) =       0.000534254085
  error estimate for blocks of size 2^( 5) =       0.000545498729
  error estimate for blocks of size 2^( 6) =       0.000551106069
  error estimate for blocks of size 2^( 7) =       0.000555694256

      target function =      -0.746394543801
              le_mean =     -22.814213357221
             les_mean =     520.937050567365
             stat err =       0.000546638285
             autocorr =       1.367548481314
   target nu stat err =       0.000546638285
   target dn stat err =       0.002889137491
      target stat err =       0.002462082529
              std dev =       0.661064258585
             le_variance =       0.437005953979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281421335722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746401633690       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746401633780       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746401633791       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746401633796       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746401633860       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746401633517       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746401634021       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746401633832       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746401633537       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746401633699       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+05 is 1.880077e-09

solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746401633690       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746401633712       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746401633715       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746401633717       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746401633717       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746401633717       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746401635124       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746401633655       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746401632390       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746401633630       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+05 is 4.700194e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746401633690       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746401633695       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746401633696       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746401633283       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746401633697       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746401633697       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746401633697       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746401633697       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746401633697       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746401633697       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+06 is 1.175048e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.354390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2209e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571471e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940907e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395021e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136309e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581151e-04 3 1  ON 30
ci_32                -8.464090e-04 3 1  ON 31
ci_33                -1.467129e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685121e-04 3 1  ON 37
ci_39                -6.245852e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239190e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694131e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377197e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119956e-04 3 1  ON 49
ci_51                 1.439397e-04 3 1  ON 50
ci_52                 8.068127e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525798e-04 3 1  ON 54
ci_56                 2.626581e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428912e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662292e-04 3 1  ON 61
ci_63                -7.728497e-04 3 1  ON 62
ci_64                -2.632740e-04 3 1  ON 63
ci_65                 6.160564e-05 3 1  ON 64
ci_66                -7.127418e-04 3 1  ON 65
ci_67                -8.949577e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318183e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.755
    reference variance = 0.306191
====================================================
  Execution time = 4.1404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4924e-01
  Total weights = 1.9644e+06
  Execution time = 5.8980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436944129927
                                         uncertainty =       0.002166822808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436944129927
                                         uncertainty =       0.002166822808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467433378
  error estimate for blocks of size 2^( 2) =       0.000492857518
  error estimate for blocks of size 2^( 3) =       0.000516768816
  error estimate for blocks of size 2^( 4) =       0.000535302856
  error estimate for blocks of size 2^( 5) =       0.000547062495
  error estimate for blocks of size 2^( 6) =       0.000552546969
  error estimate for blocks of size 2^( 7) =       0.000557152860

      target function =      -0.745964538576
              le_mean =     -22.814551874851
             les_mean =     520.953020088053
             stat err =       0.000548016295
             autocorr =       1.374508728460
   target nu stat err =       0.000548016295
   target dn stat err =       0.002923140604
      target stat err =       0.002488157193
              std dev =       0.661050623208
             le_variance =       0.436987926443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436944129728
                                         uncertainty =       0.002166822802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436944129728
                                         uncertainty =       0.002166822802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467433378
  error estimate for blocks of size 2^( 2) =       0.000492857518
  error estimate for blocks of size 2^( 3) =       0.000516768816
  error estimate for blocks of size 2^( 4) =       0.000535302856
  error estimate for blocks of size 2^( 5) =       0.000547062495
  error estimate for blocks of size 2^( 6) =       0.000552546969
  error estimate for blocks of size 2^( 7) =       0.000557152860

      target function =      -0.745964538726
              le_mean =     -22.814551874850
             les_mean =     520.953020087847
             stat err =       0.000548016295
             autocorr =       1.374508729442
   target nu stat err =       0.000548016295
   target dn stat err =       0.002923140638
      target stat err =       0.002488157222
              std dev =       0.661050623056
             le_variance =       0.436987926243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436944129828
                                         uncertainty =       0.002166822805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436944129828
                                         uncertainty =       0.002166822805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467433378
  error estimate for blocks of size 2^( 2) =       0.000492857518
  error estimate for blocks of size 2^( 3) =       0.000516768816
  error estimate for blocks of size 2^( 4) =       0.000535302856
  error estimate for blocks of size 2^( 5) =       0.000547062495
  error estimate for blocks of size 2^( 6) =       0.000552546969
  error estimate for blocks of size 2^( 7) =       0.000557152860

      target function =      -0.745964538651
              le_mean =     -22.814551874850
             les_mean =     520.953020087950
             stat err =       0.000548016295
             autocorr =       1.374508728950
   target nu stat err =       0.000548016295
   target dn stat err =       0.002923140621
      target stat err =       0.002488157207
              std dev =       0.661050623132
             le_variance =       0.436987926343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436944129914
                                         uncertainty =       0.002166822808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436944129914
                                         uncertainty =       0.002166822808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467433378
  error estimate for blocks of size 2^( 2) =       0.000492857518
  error estimate for blocks of size 2^( 3) =       0.000516768816
  error estimate for blocks of size 2^( 4) =       0.000535302856
  error estimate for blocks of size 2^( 5) =       0.000547062495
  error estimate for blocks of size 2^( 6) =       0.000552546969
  error estimate for blocks of size 2^( 7) =       0.000557152860

      target function =      -0.745964538586
              le_mean =     -22.814551874851
             les_mean =     520.953020088040
             stat err =       0.000548016295
             autocorr =       1.374508728526
   target nu stat err =       0.000548016295
   target dn stat err =       0.002923140606
      target stat err =       0.002488157195
              std dev =       0.661050623198
             le_variance =       0.436987926431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745964538576        initial
     1.3553e+05     1.3553e+06             1.8801e-09        -0.745964538726  <--
     5.4210e+05     5.4210e+06             4.7002e-10        -0.745964538651
     2.1684e+06     2.1684e+07             1.1750e-10        -0.745964538586

*****************************************************************************
Applying the update for shift_i =   1.3553e+05     and shift_s =   1.3553e+06
*****************************************************************************

  Execution time = 7.1003e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571471e-03 3 1  ON 7
ci_09                -9.045285e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244568e-03 3 1  ON 16
ci_18                -5.940907e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395020e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136310e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581150e-04 3 1  ON 30
ci_32                -8.464088e-04 3 1  ON 31
ci_33                -1.467129e-03 3 1  ON 32
ci_34                 1.137983e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031563e-03 3 1  ON 36
ci_38                -7.685122e-04 3 1  ON 37
ci_39                -6.245851e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239190e-03 3 1  ON 43
ci_45                -5.273532e-04 3 1  ON 44
ci_46                -8.694130e-04 3 1  ON 45
ci_47                 1.538403e-03 3 1  ON 46
ci_48                 1.377198e-03 3 1  ON 47
ci_49                -1.040594e-03 3 1  ON 48
ci_50                -8.119955e-04 3 1  ON 49
ci_51                 1.439398e-04 3 1  ON 50
ci_52                 8.068117e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525800e-04 3 1  ON 54
ci_56                 2.626581e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114396e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428908e-04 3 1  ON 59
ci_61                -1.294345e-04 3 1  ON 60
ci_62                -6.662293e-04 3 1  ON 61
ci_63                -7.728493e-04 3 1  ON 62
ci_64                -2.632738e-04 3 1  ON 63
ci_65                 6.160544e-05 3 1  ON 64
ci_66                -7.127416e-04 3 1  ON 65
ci_67                -8.949576e-04 3 1  ON 66
ci_68                -1.372124e-03 3 1  ON 67
ci_69                 1.318180e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2338e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.8197
    reference variance = 0.837717
====================================================
  Execution time = 4.2844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.3900e-01
  Total weights = 1.964201651e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428252750539
                                         uncertainty =       0.001548957806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428252750539
                                         uncertainty =       0.001548957806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000462763446
  error estimate for blocks of size 2^( 2) =       0.000488459755
  error estimate for blocks of size 2^( 3) =       0.000512881088
  error estimate for blocks of size 2^( 4) =       0.000531092164
  error estimate for blocks of size 2^( 5) =       0.000542467836
  error estimate for blocks of size 2^( 6) =       0.000547466880
  error estimate for blocks of size 2^( 7) =       0.000549818082

      target function =      -0.754521451081
              le_mean =     -22.814806171217
             les_mean =     520.954384415282
             stat err =       0.000542711240
             autocorr =       1.375369980020
   target nu stat err =       0.000542711240
   target dn stat err =       0.002347521532
      target stat err =       0.002074398733
              std dev =       0.654446341152
             le_variance =       0.428300013447


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281480617122e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.754526133523       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.754526133784       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.754526133824       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.754526133834       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.754526133835       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.754526133836       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.754526133832       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.754526133836       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.754526133851       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+04 is 4.996501e-09

solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.754526133523       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.754526133588       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.754526133598       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.754526133600       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.754526133601       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.754526133601       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.754526133601       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.754526133601       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.754526133601       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+05 is 1.249126e-09

solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.754526133523       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.754526133539       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.754526133541       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.754526133542       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.754526133542       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.754526133542       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.754526133542       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.754526133542       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.754526133542       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+05 is 3.122816e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.357477 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.4533e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176963e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571471e-03 3 1  ON 7
ci_09                -9.045284e-03 3 1  ON 8
ci_10                -8.352747e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948911e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426477e-03 3 1  ON 15
ci_17                -7.244567e-03 3 1  ON 16
ci_18                -5.940907e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395020e-03 3 1  ON 19
ci_21                 9.004942e-03 3 1  ON 20
ci_22                 8.265991e-03 3 1  ON 21
ci_23                 4.757157e-03 3 1  ON 22
ci_24                 3.984871e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136310e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833661e-03 3 1  ON 29
ci_31                -5.581156e-04 3 1  ON 30
ci_32                -8.464086e-04 3 1  ON 31
ci_33                -1.467129e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456799e-03 3 1  ON 34
ci_36                -1.024433e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685123e-04 3 1  ON 37
ci_39                -6.245851e-04 3 1  ON 38
ci_40                -1.561239e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167543e-03 3 1  ON 41
ci_43                -2.482050e-03 3 1  ON 42
ci_44                -3.239189e-03 3 1  ON 43
ci_45                -5.273530e-04 3 1  ON 44
ci_46                -8.694128e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377198e-03 3 1  ON 47
ci_49                -1.040594e-03 3 1  ON 48
ci_50                -8.119953e-04 3 1  ON 49
ci_51                 1.439398e-04 3 1  ON 50
ci_52                 8.068115e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026834e-03 3 1  ON 53
ci_55                -6.525800e-04 3 1  ON 54
ci_56                 2.626581e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114395e-03 3 1  ON 57
ci_59                -1.466033e-03 3 1  ON 58
ci_60                 5.428909e-04 3 1  ON 59
ci_61                -1.294344e-04 3 1  ON 60
ci_62                -6.662294e-04 3 1  ON 61
ci_63                -7.728489e-04 3 1  ON 62
ci_64                -2.632738e-04 3 1  ON 63
ci_65                 6.160576e-05 3 1  ON 64
ci_66                -7.127413e-04 3 1  ON 65
ci_67                -8.949572e-04 3 1  ON 66
ci_68                -1.372124e-03 3 1  ON 67
ci_69                 1.318174e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.8435
    reference variance = 0.309573
====================================================
  Execution time = 4.1976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6283e-01
  Total weights = 1.9640e+06
  Execution time = 5.9321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445336182427
                                         uncertainty =       0.007160670355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445336182427
                                         uncertainty =       0.007160670355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471793651
  error estimate for blocks of size 2^( 2) =       0.000497245155
  error estimate for blocks of size 2^( 3) =       0.000521231183
  error estimate for blocks of size 2^( 4) =       0.000538899825
  error estimate for blocks of size 2^( 5) =       0.000549830334
  error estimate for blocks of size 2^( 6) =       0.000556793166
  error estimate for blocks of size 2^( 7) =       0.000560974062

      target function =      -0.734786389505
              le_mean =     -22.814793764049
             les_mean =     520.977642531670
             stat err =       0.000551624347
             autocorr =       1.367044548007
   target nu stat err =       0.000551624347
   target dn stat err =       0.012450085856
      target stat err =       0.009995526001
              std dev =       0.667216980368
             le_variance =       0.445178498891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445336182216
                                         uncertainty =       0.007160670638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445336182216
                                         uncertainty =       0.007160670638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471793651
  error estimate for blocks of size 2^( 2) =       0.000497245155
  error estimate for blocks of size 2^( 3) =       0.000521231183
  error estimate for blocks of size 2^( 4) =       0.000538899826
  error estimate for blocks of size 2^( 5) =       0.000549830334
  error estimate for blocks of size 2^( 6) =       0.000556793166
  error estimate for blocks of size 2^( 7) =       0.000560974062

      target function =      -0.734786391089
              le_mean =     -22.814793764049
             les_mean =     520.977642529668
             stat err =       0.000551624347
             autocorr =       1.367044550289
   target nu stat err =       0.000551624347
   target dn stat err =       0.012450086655
      target stat err =       0.009995526684
              std dev =       0.667216980208
             le_variance =       0.445178498678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445336182321
                                         uncertainty =       0.007160670497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445336182321
                                         uncertainty =       0.007160670497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471793651
  error estimate for blocks of size 2^( 2) =       0.000497245155
  error estimate for blocks of size 2^( 3) =       0.000521231183
  error estimate for blocks of size 2^( 4) =       0.000538899826
  error estimate for blocks of size 2^( 5) =       0.000549830334
  error estimate for blocks of size 2^( 6) =       0.000556793166
  error estimate for blocks of size 2^( 7) =       0.000560974062

      target function =      -0.734786390297
              le_mean =     -22.814793764049
             les_mean =     520.977642530669
             stat err =       0.000551624347
             autocorr =       1.367044549143
   target nu stat err =       0.000551624347
   target dn stat err =       0.012450086256
      target stat err =       0.009995526342
              std dev =       0.667216980288
             le_variance =       0.445178498785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445336182413
                                         uncertainty =       0.007160670373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445336182413
                                         uncertainty =       0.007160670373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471793651
  error estimate for blocks of size 2^( 2) =       0.000497245155
  error estimate for blocks of size 2^( 3) =       0.000521231183
  error estimate for blocks of size 2^( 4) =       0.000538899825
  error estimate for blocks of size 2^( 5) =       0.000549830334
  error estimate for blocks of size 2^( 6) =       0.000556793166
  error estimate for blocks of size 2^( 7) =       0.000560974062

      target function =      -0.734786389604
              le_mean =     -22.814793764049
             les_mean =     520.977642531544
             stat err =       0.000551624347
             autocorr =       1.367044548146
   target nu stat err =       0.000551624347
   target dn stat err =       0.012450085906
      target stat err =       0.009995526044
              std dev =       0.667216980358
             le_variance =       0.445178498878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.734786389505        initial
     3.3881e+04     3.3881e+05             4.9965e-09        -0.734786391089  <--
     1.3553e+05     1.3553e+06             1.2491e-09        -0.734786390297
     5.4210e+05     5.4210e+06             3.1228e-10        -0.734786389604

*****************************************************************************
Applying the update for shift_i =   3.3881e+04     and shift_s =   3.3881e+05
*****************************************************************************

  Execution time = 7.1705e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888019e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176962e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571471e-03 3 1  ON 7
ci_09                -9.045283e-03 3 1  ON 8
ci_10                -8.352747e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948910e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244566e-03 3 1  ON 16
ci_18                -5.940910e-03 3 1  ON 17
ci_19                 9.299882e-03 3 1  ON 18
ci_20                 6.395020e-03 3 1  ON 19
ci_21                 9.004943e-03 3 1  ON 20
ci_22                 8.265992e-03 3 1  ON 21
ci_23                 4.757155e-03 3 1  ON 22
ci_24                 3.984872e-03 3 1  ON 23
ci_25                 2.848365e-03 3 1  ON 24
ci_26                 3.136310e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933020e-03 3 1  ON 27
ci_29                 1.306953e-03 3 1  ON 28
ci_30                -1.833659e-03 3 1  ON 29
ci_31                -5.581172e-04 3 1  ON 30
ci_32                -8.464080e-04 3 1  ON 31
ci_33                -1.467128e-03 3 1  ON 32
ci_34                 1.137984e-03 3 1  ON 33
ci_35                 1.456801e-03 3 1  ON 34
ci_36                -1.024434e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685127e-04 3 1  ON 37
ci_39                -6.245851e-04 3 1  ON 38
ci_40                -1.561239e-03 3 1  ON 39
ci_41                -1.248545e-03 3 1  ON 40
ci_42                -1.167542e-03 3 1  ON 41
ci_43                -2.482051e-03 3 1  ON 42
ci_44                -3.239187e-03 3 1  ON 43
ci_45                -5.273522e-04 3 1  ON 44
ci_46                -8.694124e-04 3 1  ON 45
ci_47                 1.538402e-03 3 1  ON 46
ci_48                 1.377199e-03 3 1  ON 47
ci_49                -1.040595e-03 3 1  ON 48
ci_50                -8.119949e-04 3 1  ON 49
ci_51                 1.439400e-04 3 1  ON 50
ci_52                 8.068110e-05 3 1  ON 51
ci_53                -6.382740e-04 3 1  ON 52
ci_54                -1.026833e-03 3 1  ON 53
ci_55                -6.525801e-04 3 1  ON 54
ci_56                 2.626580e-03 3 1  ON 55
ci_57                 1.624708e-03 3 1  ON 56
ci_58                -1.114395e-03 3 1  ON 57
ci_59                -1.466032e-03 3 1  ON 58
ci_60                 5.428909e-04 3 1  ON 59
ci_61                -1.294340e-04 3 1  ON 60
ci_62                -6.662294e-04 3 1  ON 61
ci_63                -7.728477e-04 3 1  ON 62
ci_64                -2.632737e-04 3 1  ON 63
ci_65                 6.160672e-05 3 1  ON 64
ci_66                -7.127405e-04 3 1  ON 65
ci_67                -8.949562e-04 3 1  ON 66
ci_68                -1.372125e-03 3 1  ON 67
ci_69                 1.318157e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2627e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.791
    reference variance = 0.482604
====================================================
  Execution time = 4.2778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5073e-01
  Total weights = 1.964427327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437170116994
                                         uncertainty =       0.002471886613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437170116994
                                         uncertainty =       0.002471886613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467524069
  error estimate for blocks of size 2^( 2) =       0.000493140488
  error estimate for blocks of size 2^( 3) =       0.000517034774
  error estimate for blocks of size 2^( 4) =       0.000534712793
  error estimate for blocks of size 2^( 5) =       0.000545244411
  error estimate for blocks of size 2^( 6) =       0.000550316730
  error estimate for blocks of size 2^( 7) =       0.000552568329

      target function =      -0.744743406108
              le_mean =     -22.815104816830
             les_mean =     520.979733302815
             stat err =       0.000545710566
             autocorr =       1.362438093080
   target nu stat err =       0.000545710566
   target dn stat err =       0.003150210745
      target stat err =       0.002663447250
              std dev =       0.661178878445
             le_variance =       0.437157509301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281510481683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744752004605       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744752006462       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744752006652       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744752006705       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744752006698       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744752006700       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744752006718       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744752006706       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744752006704       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744752006703       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+03 is 1.672704e-08

solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744752004605       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744752005069       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744752005117       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744752005130       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744752005131       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744752005129       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744752005135       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744752005164       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744752005129       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744752005161       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+04 is 4.181776e-09

solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744752004605       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744752004721       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744752004733       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744752004736       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744752004736       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744752004736       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744752004514       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744752004623       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744752004418       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744752004591       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+05 is 1.045445e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0471e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_01                 1.272726e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898796e-02 3 1  ON 2
ci_04                 2.690907e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176962e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571470e-03 3 1  ON 7
ci_09                -9.045281e-03 3 1  ON 8
ci_10                -8.352746e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948908e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266765e-03 3 1  ON 14
ci_16                 6.426480e-03 3 1  ON 15
ci_17                -7.244565e-03 3 1  ON 16
ci_18                -5.940911e-03 3 1  ON 17
ci_19                 9.299881e-03 3 1  ON 18
ci_20                 6.395018e-03 3 1  ON 19
ci_21                 9.004941e-03 3 1  ON 20
ci_22                 8.265989e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984873e-03 3 1  ON 23
ci_25                 2.848366e-03 3 1  ON 24
ci_26                 3.136311e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933021e-03 3 1  ON 27
ci_29                 1.306954e-03 3 1  ON 28
ci_30                -1.833657e-03 3 1  ON 29
ci_31                -5.581170e-04 3 1  ON 30
ci_32                -8.464092e-04 3 1  ON 31
ci_33                -1.467128e-03 3 1  ON 32
ci_34                 1.137983e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024434e-03 3 1  ON 35
ci_37                -1.031562e-03 3 1  ON 36
ci_38                -7.685119e-04 3 1  ON 37
ci_39                -6.245833e-04 3 1  ON 38
ci_40                -1.561239e-03 3 1  ON 39
ci_41                -1.248545e-03 3 1  ON 40
ci_42                -1.167538e-03 3 1  ON 41
ci_43                -2.482052e-03 3 1  ON 42
ci_44                -3.239183e-03 3 1  ON 43
ci_45                -5.273507e-04 3 1  ON 44
ci_46                -8.694121e-04 3 1  ON 45
ci_47                 1.538404e-03 3 1  ON 46
ci_48                 1.377200e-03 3 1  ON 47
ci_49                -1.040594e-03 3 1  ON 48
ci_50                -8.119949e-04 3 1  ON 49
ci_51                 1.439409e-04 3 1  ON 50
ci_52                 8.067947e-05 3 1  ON 51
ci_53                -6.382733e-04 3 1  ON 52
ci_54                -1.026833e-03 3 1  ON 53
ci_55                -6.525803e-04 3 1  ON 54
ci_56                 2.626579e-03 3 1  ON 55
ci_57                 1.624710e-03 3 1  ON 56
ci_58                -1.114394e-03 3 1  ON 57
ci_59                -1.466030e-03 3 1  ON 58
ci_60                 5.428918e-04 3 1  ON 59
ci_61                -1.294325e-04 3 1  ON 60
ci_62                -6.662303e-04 3 1  ON 61
ci_63                -7.728492e-04 3 1  ON 62
ci_64                -2.632720e-04 3 1  ON 63
ci_65                 6.160582e-05 3 1  ON 64
ci_66                -7.127392e-04 3 1  ON 65
ci_67                -8.949547e-04 3 1  ON 66
ci_68                -1.372126e-03 3 1  ON 67
ci_69                 1.318155e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.8273
    reference variance = 0.476378
====================================================
  Execution time = 4.3411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4277e-01
  Total weights = 1.9645e+06
  Execution time = 5.8925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431490240450
                                         uncertainty =       0.002076543183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431490240450
                                         uncertainty =       0.002076543183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464454441
  error estimate for blocks of size 2^( 2) =       0.000489596245
  error estimate for blocks of size 2^( 3) =       0.000513773080
  error estimate for blocks of size 2^( 4) =       0.000531929294
  error estimate for blocks of size 2^( 5) =       0.000543434833
  error estimate for blocks of size 2^( 6) =       0.000548585561
  error estimate for blocks of size 2^( 7) =       0.000551466814

      target function =      -0.751337991249
              le_mean =     -22.814064475972
             les_mean =     520.924310832837
             stat err =       0.000543854125
             autocorr =       1.371129941224
   target nu stat err =       0.000543854125
   target dn stat err =       0.002696199156
      target stat err =       0.002336216397
              std dev =       0.656837769728
             le_variance =       0.431435855741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431490238990
                                         uncertainty =       0.002076542887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431490238990
                                         uncertainty =       0.002076542887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464454440
  error estimate for blocks of size 2^( 2) =       0.000489596245
  error estimate for blocks of size 2^( 3) =       0.000513773080
  error estimate for blocks of size 2^( 4) =       0.000531929294
  error estimate for blocks of size 2^( 5) =       0.000543434834
  error estimate for blocks of size 2^( 6) =       0.000548585562
  error estimate for blocks of size 2^( 7) =       0.000551466816

      target function =      -0.751338004423
              le_mean =     -22.814064475975
             les_mean =     520.924310817227
             stat err =       0.000543854127
             autocorr =       1.371129951454
   target nu stat err =       0.000543854127
   target dn stat err =       0.002696198558
      target stat err =       0.002336215992
              std dev =       0.656837768641
             le_variance =       0.431435854313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431490239720
                                         uncertainty =       0.002076543035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431490239720
                                         uncertainty =       0.002076543035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464454441
  error estimate for blocks of size 2^( 2) =       0.000489596245
  error estimate for blocks of size 2^( 3) =       0.000513773080
  error estimate for blocks of size 2^( 4) =       0.000531929294
  error estimate for blocks of size 2^( 5) =       0.000543434833
  error estimate for blocks of size 2^( 6) =       0.000548585562
  error estimate for blocks of size 2^( 7) =       0.000551466815

      target function =      -0.751337997837
              le_mean =     -22.814064475973
             les_mean =     520.924310825031
             stat err =       0.000543854126
             autocorr =       1.371129946342
   target nu stat err =       0.000543854126
   target dn stat err =       0.002696198857
      target stat err =       0.002336216194
              std dev =       0.656837769185
             le_variance =       0.431435855027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431490240358
                                         uncertainty =       0.002076543164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431490240358
                                         uncertainty =       0.002076543164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464454441
  error estimate for blocks of size 2^( 2) =       0.000489596245
  error estimate for blocks of size 2^( 3) =       0.000513773080
  error estimate for blocks of size 2^( 4) =       0.000531929294
  error estimate for blocks of size 2^( 5) =       0.000543434833
  error estimate for blocks of size 2^( 6) =       0.000548585561
  error estimate for blocks of size 2^( 7) =       0.000551466814

      target function =      -0.751337992072
              le_mean =     -22.814064475972
             les_mean =     520.924310831861
             stat err =       0.000543854126
             autocorr =       1.371129941857
   target nu stat err =       0.000543854126
   target dn stat err =       0.002696199119
      target stat err =       0.002336216371
              std dev =       0.656837769660
             le_variance =       0.431435855652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751337991249        initial
     8.4703e+03     8.4703e+04             1.6727e-08        -0.751338004423  <--
     3.3881e+04     3.3881e+05             4.1818e-09        -0.751337997837
     1.3553e+05     1.3553e+06             1.0454e-09        -0.751337992072

*****************************************************************************
Applying the update for shift_i =   8.4703e+03     and shift_s =   8.4703e+04
*****************************************************************************

  Execution time = 7.3044e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888020e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690906e-02 3 1  ON 3
ci_05                -2.207727e-02 3 1  ON 4
ci_06                -2.176961e-02 3 1  ON 5
ci_07                 2.738809e-02 3 1  ON 6
ci_08                -5.571469e-03 3 1  ON 7
ci_09                -9.045274e-03 3 1  ON 8
ci_10                -8.352742e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948902e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266766e-03 3 1  ON 14
ci_16                 6.426485e-03 3 1  ON 15
ci_17                -7.244561e-03 3 1  ON 16
ci_18                -5.940916e-03 3 1  ON 17
ci_19                 9.299879e-03 3 1  ON 18
ci_20                 6.395013e-03 3 1  ON 19
ci_21                 9.004937e-03 3 1  ON 20
ci_22                 8.265980e-03 3 1  ON 21
ci_23                 4.757156e-03 3 1  ON 22
ci_24                 3.984875e-03 3 1  ON 23
ci_25                 2.848370e-03 3 1  ON 24
ci_26                 3.136316e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933024e-03 3 1  ON 27
ci_29                 1.306956e-03 3 1  ON 28
ci_30                -1.833652e-03 3 1  ON 29
ci_31                -5.581164e-04 3 1  ON 30
ci_32                -8.464128e-04 3 1  ON 31
ci_33                -1.467126e-03 3 1  ON 32
ci_34                 1.137981e-03 3 1  ON 33
ci_35                 1.456787e-03 3 1  ON 34
ci_36                -1.024435e-03 3 1  ON 35
ci_37                -1.031561e-03 3 1  ON 36
ci_38                -7.685096e-04 3 1  ON 37
ci_39                -6.245780e-04 3 1  ON 38
ci_40                -1.561239e-03 3 1  ON 39
ci_41                -1.248546e-03 3 1  ON 40
ci_42                -1.167527e-03 3 1  ON 41
ci_43                -2.482058e-03 3 1  ON 42
ci_44                -3.239173e-03 3 1  ON 43
ci_45                -5.273461e-04 3 1  ON 44
ci_46                -8.694111e-04 3 1  ON 45
ci_47                 1.538409e-03 3 1  ON 46
ci_48                 1.377202e-03 3 1  ON 47
ci_49                -1.040593e-03 3 1  ON 48
ci_50                -8.119950e-04 3 1  ON 49
ci_51                 1.439435e-04 3 1  ON 50
ci_52                 8.067461e-05 3 1  ON 51
ci_53                -6.382710e-04 3 1  ON 52
ci_54                -1.026831e-03 3 1  ON 53
ci_55                -6.525809e-04 3 1  ON 54
ci_56                 2.626577e-03 3 1  ON 55
ci_57                 1.624717e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466024e-03 3 1  ON 58
ci_60                 5.428944e-04 3 1  ON 59
ci_61                -1.294283e-04 3 1  ON 60
ci_62                -6.662329e-04 3 1  ON 61
ci_63                -7.728537e-04 3 1  ON 62
ci_64                -2.632668e-04 3 1  ON 63
ci_65                 6.160314e-05 3 1  ON 64
ci_66                -7.127355e-04 3 1  ON 65
ci_67                -8.949501e-04 3 1  ON 66
ci_68                -1.372131e-03 3 1  ON 67
ci_69                 1.318151e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2353e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.8272
    reference variance = 0.243554
====================================================
  Execution time = 4.2796e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4993e-01
  Total weights = 1.964167492e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434813210443
                                         uncertainty =       0.002131641227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434813210443
                                         uncertainty =       0.002131641227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466250007
  error estimate for blocks of size 2^( 2) =       0.000491951295
  error estimate for blocks of size 2^( 3) =       0.000516275136
  error estimate for blocks of size 2^( 4) =       0.000534385494
  error estimate for blocks of size 2^( 5) =       0.000546043122
  error estimate for blocks of size 2^( 6) =       0.000552005970
  error estimate for blocks of size 2^( 7) =       0.000553176387

      target function =      -0.745396795499
              le_mean =     -22.815036084377
             les_mean =     520.975803755072
             stat err =       0.000546402743
             autocorr =       1.373371529736
   target nu stat err =       0.000546402743
   target dn stat err =       0.003178332788
      target stat err =       0.002690502773
              std dev =       0.659377082714
             le_variance =       0.434778137208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281503608438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745405531023       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745405537754       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745405539169       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745405539707       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745405539830       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745405539873       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745405539862       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745405539878       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745405539872       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745405539872       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+03 is 7.892083e-08

solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745405531023       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745405532706       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745405533060       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745405533192       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745405533217       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745405533211       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745405533237       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745405533228       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745405533229       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745405533246       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+03 is 1.973042e-08

solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745405531023       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745405531444       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745405531532       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745405531566       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745405531596       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745405531576       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745405531545       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745405531576       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745405531560       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745405531619       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+04 is 4.932618e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0521e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888019e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690905e-02 3 1  ON 3
ci_05                -2.207726e-02 3 1  ON 4
ci_06                -2.176960e-02 3 1  ON 5
ci_07                 2.738808e-02 3 1  ON 6
ci_08                -5.571463e-03 3 1  ON 7
ci_09                -9.045264e-03 3 1  ON 8
ci_10                -8.352744e-03 3 1  ON 9
ci_11                 1.321806e-02 3 1  ON 10
ci_12                 6.948893e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266768e-03 3 1  ON 14
ci_16                 6.426483e-03 3 1  ON 15
ci_17                -7.244561e-03 3 1  ON 16
ci_18                -5.940921e-03 3 1  ON 17
ci_19                 9.299872e-03 3 1  ON 18
ci_20                 6.395011e-03 3 1  ON 19
ci_21                 9.004927e-03 3 1  ON 20
ci_22                 8.265990e-03 3 1  ON 21
ci_23                 4.757152e-03 3 1  ON 22
ci_24                 3.984870e-03 3 1  ON 23
ci_25                 2.848370e-03 3 1  ON 24
ci_26                 3.136310e-03 3 1  ON 25
ci_27                 3.318406e-03 3 1  ON 26
ci_28                 1.933026e-03 3 1  ON 27
ci_29                 1.306961e-03 3 1  ON 28
ci_30                -1.833632e-03 3 1  ON 29
ci_31                -5.581179e-04 3 1  ON 30
ci_32                -8.464134e-04 3 1  ON 31
ci_33                -1.467123e-03 3 1  ON 32
ci_34                 1.137986e-03 3 1  ON 33
ci_35                 1.456790e-03 3 1  ON 34
ci_36                -1.024431e-03 3 1  ON 35
ci_37                -1.031564e-03 3 1  ON 36
ci_38                -7.685074e-04 3 1  ON 37
ci_39                -6.245780e-04 3 1  ON 38
ci_40                -1.561240e-03 3 1  ON 39
ci_41                -1.248549e-03 3 1  ON 40
ci_42                -1.167538e-03 3 1  ON 41
ci_43                -2.482048e-03 3 1  ON 42
ci_44                -3.239169e-03 3 1  ON 43
ci_45                -5.273461e-04 3 1  ON 44
ci_46                -8.694064e-04 3 1  ON 45
ci_47                 1.538414e-03 3 1  ON 46
ci_48                 1.377216e-03 3 1  ON 47
ci_49                -1.040599e-03 3 1  ON 48
ci_50                -8.119924e-04 3 1  ON 49
ci_51                 1.439422e-04 3 1  ON 50
ci_52                 8.067417e-05 3 1  ON 51
ci_53                -6.382781e-04 3 1  ON 52
ci_54                -1.026829e-03 3 1  ON 53
ci_55                -6.525811e-04 3 1  ON 54
ci_56                 2.626579e-03 3 1  ON 55
ci_57                 1.624720e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466020e-03 3 1  ON 58
ci_60                 5.428756e-04 3 1  ON 59
ci_61                -1.294299e-04 3 1  ON 60
ci_62                -6.662303e-04 3 1  ON 61
ci_63                -7.728445e-04 3 1  ON 62
ci_64                -2.632691e-04 3 1  ON 63
ci_65                 6.160485e-05 3 1  ON 64
ci_66                -7.127319e-04 3 1  ON 65
ci_67                -8.949494e-04 3 1  ON 66
ci_68                -1.372121e-03 3 1  ON 67
ci_69                 1.318027e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.8351
    reference variance = 0.359131
====================================================
  Execution time = 4.1581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4608e-01
  Total weights = 1.9643e+06
  Execution time = 5.9228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433539411973
                                         uncertainty =       0.002366042686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433539411973
                                         uncertainty =       0.002366042686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465558002
  error estimate for blocks of size 2^( 2) =       0.000490949159
  error estimate for blocks of size 2^( 3) =       0.000514877089
  error estimate for blocks of size 2^( 4) =       0.000531340155
  error estimate for blocks of size 2^( 5) =       0.000541776287
  error estimate for blocks of size 2^( 6) =       0.000548218209
  error estimate for blocks of size 2^( 7) =       0.000551729209

      target function =      -0.748590094127
              le_mean =     -22.814688891096
             les_mean =     520.956105944984
             stat err =       0.000543265965
             autocorr =       1.361687352671
   target nu stat err =       0.000543265965
   target dn stat err =       0.002624987012
      target stat err =       0.002264584689
              std dev =       0.658398440785
             le_variance =       0.433488506828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433539411847
                                         uncertainty =       0.002366043647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433539411847
                                         uncertainty =       0.002366043647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465558002
  error estimate for blocks of size 2^( 2) =       0.000490949162
  error estimate for blocks of size 2^( 3) =       0.000514877094
  error estimate for blocks of size 2^( 4) =       0.000531340161
  error estimate for blocks of size 2^( 5) =       0.000541776294
  error estimate for blocks of size 2^( 6) =       0.000548218217
  error estimate for blocks of size 2^( 7) =       0.000551729214

      target function =      -0.748590140356
              le_mean =     -22.814688891498
             les_mean =     520.956105907863
             stat err =       0.000543265972
             autocorr =       1.361687387078
   target nu stat err =       0.000543265972
   target dn stat err =       0.002624960070
      target stat err =       0.002264563369
              std dev =       0.658398440709
             le_variance =       0.433488506728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433539411910
                                         uncertainty =       0.002366043166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433539411910
                                         uncertainty =       0.002366043166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465558002
  error estimate for blocks of size 2^( 2) =       0.000490949161
  error estimate for blocks of size 2^( 3) =       0.000514877092
  error estimate for blocks of size 2^( 4) =       0.000531340158
  error estimate for blocks of size 2^( 5) =       0.000541776290
  error estimate for blocks of size 2^( 6) =       0.000548218213
  error estimate for blocks of size 2^( 7) =       0.000551729212

      target function =      -0.748590117263
              le_mean =     -22.814688891297
             les_mean =     520.956105926398
             stat err =       0.000543265968
             autocorr =       1.361687369876
   target nu stat err =       0.000543265968
   target dn stat err =       0.002624973540
      target stat err =       0.002264574028
              std dev =       0.658398440747
             le_variance =       0.433488506778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433539411966
                                         uncertainty =       0.002366042746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433539411966
                                         uncertainty =       0.002366042746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465558002
  error estimate for blocks of size 2^( 2) =       0.000490949159
  error estimate for blocks of size 2^( 3) =       0.000514877089
  error estimate for blocks of size 2^( 4) =       0.000531340155
  error estimate for blocks of size 2^( 5) =       0.000541776287
  error estimate for blocks of size 2^( 6) =       0.000548218210
  error estimate for blocks of size 2^( 7) =       0.000551729209

      target function =      -0.748590097021
              le_mean =     -22.814688891121
             les_mean =     520.956105942658
             stat err =       0.000543265965
             autocorr =       1.361687354823
   target nu stat err =       0.000543265965
   target dn stat err =       0.002624985327
      target stat err =       0.002264583356
              std dev =       0.658398440780
             le_variance =       0.433488506822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748590094127        initial
     2.1176e+03     2.1176e+04             7.8921e-08        -0.748590140356  <--
     8.4703e+03     8.4703e+04             1.9730e-08        -0.748590117263
     3.3881e+04     3.3881e+05             4.9326e-09        -0.748590097021

*****************************************************************************
Applying the update for shift_i =   2.1176e+03     and shift_s =   2.1176e+04
*****************************************************************************

  Execution time = 7.3286e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581224e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685007e-04 3 1  ON 37
ci_39                -6.245778e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067287e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466007e-03 3 1  ON 58
ci_60                 5.428191e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662226e-04 3 1  ON 61
ci_63                -7.728169e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317657e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2389e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.8418
    reference variance = 0.267181
====================================================
  Execution time = 4.2814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4809e-01
  Total weights = 1.964226299e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434368561843
                                         uncertainty =       0.001983810531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434368561843
                                         uncertainty =       0.001983810531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466042388
  error estimate for blocks of size 2^( 2) =       0.000491462348
  error estimate for blocks of size 2^( 3) =       0.000515886241
  error estimate for blocks of size 2^( 4) =       0.000533905660
  error estimate for blocks of size 2^( 5) =       0.000545399405
  error estimate for blocks of size 2^( 6) =       0.000552047569
  error estimate for blocks of size 2^( 7) =       0.000554591909

      target function =      -0.746913563530
              le_mean =     -22.814235723762
             les_mean =     520.937443091357
             stat err =       0.000546486136
             autocorr =       1.375015074917
   target nu stat err =       0.000546486136
   target dn stat err =       0.002927088653
      target stat err =       0.002495891543
              std dev =       0.659083465375
             le_variance =       0.434391014331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281423572376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+02, overlap shift 5.2940e+03 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746920970584       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746920992165       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746920993835       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746920994593       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746920994866       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746920994947       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746920995006       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746920995006       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746920995011       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+02 is 2.559019e-07

solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746920970584       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746920975980       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746920976397       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746920976587       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746920976655       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746920976673       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746920976690       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746920976690       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746920976693       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+03 is 6.397806e-08

solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746920970584       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746920971933       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746920972037       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746920972085       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746920972094       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746920972107       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746920972111       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746920972125       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746920972099       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+03 is 1.599468e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0490e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_01                 1.272724e-01 3 1  ON 0
ci_02                -2.888014e-02 3 1  ON 1
ci_03                -2.898794e-02 3 1  ON 2
ci_04                 2.690898e-02 3 1  ON 3
ci_05                -2.207718e-02 3 1  ON 4
ci_06                -2.176958e-02 3 1  ON 5
ci_07                 2.738806e-02 3 1  ON 6
ci_08                -5.571444e-03 3 1  ON 7
ci_09                -9.045224e-03 3 1  ON 8
ci_10                -8.352759e-03 3 1  ON 9
ci_11                 1.321802e-02 3 1  ON 10
ci_12                 6.948843e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270873e-02 3 1  ON 13
ci_15                 6.266770e-03 3 1  ON 14
ci_16                 6.426450e-03 3 1  ON 15
ci_17                -7.244550e-03 3 1  ON 16
ci_18                -5.940939e-03 3 1  ON 17
ci_19                 9.299841e-03 3 1  ON 18
ci_20                 6.395002e-03 3 1  ON 19
ci_21                 9.004894e-03 3 1  ON 20
ci_22                 8.266043e-03 3 1  ON 21
ci_23                 4.757151e-03 3 1  ON 22
ci_24                 3.984881e-03 3 1  ON 23
ci_25                 2.848387e-03 3 1  ON 24
ci_26                 3.136298e-03 3 1  ON 25
ci_27                 3.318389e-03 3 1  ON 26
ci_28                 1.933039e-03 3 1  ON 27
ci_29                 1.306981e-03 3 1  ON 28
ci_30                -1.833577e-03 3 1  ON 29
ci_31                -5.581224e-04 3 1  ON 30
ci_32                -8.464350e-04 3 1  ON 31
ci_33                -1.467115e-03 3 1  ON 32
ci_34                 1.137958e-03 3 1  ON 33
ci_35                 1.456778e-03 3 1  ON 34
ci_36                -1.024415e-03 3 1  ON 35
ci_37                -1.031557e-03 3 1  ON 36
ci_38                -7.684870e-04 3 1  ON 37
ci_39                -6.246008e-04 3 1  ON 38
ci_40                -1.561237e-03 3 1  ON 39
ci_41                -1.248566e-03 3 1  ON 40
ci_42                -1.167574e-03 3 1  ON 41
ci_43                -2.482008e-03 3 1  ON 42
ci_44                -3.239148e-03 3 1  ON 43
ci_45                -5.273409e-04 3 1  ON 44
ci_46                -8.693940e-04 3 1  ON 45
ci_47                 1.538403e-03 3 1  ON 46
ci_48                 1.377284e-03 3 1  ON 47
ci_49                -1.040609e-03 3 1  ON 48
ci_50                -8.119881e-04 3 1  ON 49
ci_51                 1.439382e-04 3 1  ON 50
ci_52                 8.069139e-05 3 1  ON 51
ci_53                -6.383150e-04 3 1  ON 52
ci_54                -1.026818e-03 3 1  ON 53
ci_55                -6.525697e-04 3 1  ON 54
ci_56                 2.626549e-03 3 1  ON 55
ci_57                 1.624742e-03 3 1  ON 56
ci_58                -1.114428e-03 3 1  ON 57
ci_59                -1.465961e-03 3 1  ON 58
ci_60                 5.427980e-04 3 1  ON 59
ci_61                -1.294107e-04 3 1  ON 60
ci_62                -6.662045e-04 3 1  ON 61
ci_63                -7.727917e-04 3 1  ON 62
ci_64                -2.632848e-04 3 1  ON 63
ci_65                 6.158248e-05 3 1  ON 64
ci_66                -7.126994e-04 3 1  ON 65
ci_67                -8.949461e-04 3 1  ON 66
ci_68                -1.372068e-03 3 1  ON 67
ci_69                 1.317345e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.8086
    reference variance = 0.36197
====================================================
  Execution time = 4.1576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5210e-01
  Total weights = 1.9643e+06
  Execution time = 5.8922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438131885991
                                         uncertainty =       0.008110762971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438131885991
                                         uncertainty =       0.008110762971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468022160
  error estimate for blocks of size 2^( 2) =       0.000493691633
  error estimate for blocks of size 2^( 3) =       0.000517150477
  error estimate for blocks of size 2^( 4) =       0.000534109772
  error estimate for blocks of size 2^( 5) =       0.000544821657
  error estimate for blocks of size 2^( 6) =       0.000552225887
  error estimate for blocks of size 2^( 7) =       0.000554571885

      target function =      -0.743529545356
              le_mean =     -22.813748910000
             les_mean =     520.919234526303
             stat err =       0.000546432300
             autocorr =       1.363138214280
   target nu stat err =       0.000546432300
   target dn stat err =       0.010173463016
      target stat err =       0.008356419145
              std dev =       0.661883286171
             le_variance =       0.438089484512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438135692120
                                         uncertainty =       0.008114506703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438135692120
                                         uncertainty =       0.008114506703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468024188
  error estimate for blocks of size 2^( 2) =       0.000493693567
  error estimate for blocks of size 2^( 3) =       0.000517152335
  error estimate for blocks of size 2^( 4) =       0.000534111561
  error estimate for blocks of size 2^( 5) =       0.000544823412
  error estimate for blocks of size 2^( 6) =       0.000552227656
  error estimate for blocks of size 2^( 7) =       0.000554573678

      target function =      -0.743524918486
              le_mean =     -22.813748893627
             les_mean =     520.919239307602
             stat err =       0.000546434077
             autocorr =       1.363135263472
   target nu stat err =       0.000546434077
   target dn stat err =       0.010178880166
      target stat err =       0.008360742915
              std dev =       0.661886154443
             le_variance =       0.438093281444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438133788692
                                         uncertainty =       0.008112634477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438133788692
                                         uncertainty =       0.008112634477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468023174
  error estimate for blocks of size 2^( 2) =       0.000493692600
  error estimate for blocks of size 2^( 3) =       0.000517151406
  error estimate for blocks of size 2^( 4) =       0.000534110667
  error estimate for blocks of size 2^( 5) =       0.000544822534
  error estimate for blocks of size 2^( 6) =       0.000552226771
  error estimate for blocks of size 2^( 7) =       0.000554572781

      target function =      -0.743527236801
              le_mean =     -22.813748901814
             les_mean =     520.919236911034
             stat err =       0.000546433188
             autocorr =       1.363136739172
   target nu stat err =       0.000546433188
   target dn stat err =       0.010176171047
      target stat err =       0.008358580707
              std dev =       0.661884720034
             le_variance =       0.438091382615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438132123785
                                         uncertainty =       0.008110996866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438132123785
                                         uncertainty =       0.008110996866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468022287
  error estimate for blocks of size 2^( 2) =       0.000493691754
  error estimate for blocks of size 2^( 3) =       0.000517150594
  error estimate for blocks of size 2^( 4) =       0.000534109884
  error estimate for blocks of size 2^( 5) =       0.000544821766
  error estimate for blocks of size 2^( 6) =       0.000552225998
  error estimate for blocks of size 2^( 7) =       0.000554571997

      target function =      -0.743529257309
              le_mean =     -22.813748908977
             les_mean =     520.919234823762
             stat err =       0.000546432411
             autocorr =       1.363138029918
   target nu stat err =       0.000546432411
   target dn stat err =       0.010173801454
      target stat err =       0.008356689299
              std dev =       0.661883465370
             le_variance =       0.438089721731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743529545356        initial  <--
     5.2940e+02     5.2940e+03             2.5590e-07        -0.743524918486
     2.1176e+03     2.1176e+04             6.3978e-08        -0.743527236801
     8.4703e+03     8.4703e+04             1.5995e-08        -0.743529257309

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.0967
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581224e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685007e-04 3 1  ON 37
ci_39                -6.245778e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067287e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466007e-03 3 1  ON 58
ci_60                 5.428191e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662226e-04 3 1  ON 61
ci_63                -7.728169e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317657e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2360e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.8244
    reference variance = 0.335715
====================================================
  Execution time = 4.3266e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5678e-01
  Total weights = 1.964393397e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442433585039
                                         uncertainty =       0.003831375070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442433585039
                                         uncertainty =       0.003831375070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470311465
  error estimate for blocks of size 2^( 2) =       0.000495481031
  error estimate for blocks of size 2^( 3) =       0.000519168395
  error estimate for blocks of size 2^( 4) =       0.000535879734
  error estimate for blocks of size 2^( 5) =       0.000545603744
  error estimate for blocks of size 2^( 6) =       0.000549916268
  error estimate for blocks of size 2^( 7) =       0.000553374131

      target function =      -0.739785751125
              le_mean =     -22.813855650912
             les_mean =     520.928787892719
             stat err =       0.000546193469
             autocorr =       1.348720241239
   target nu stat err =       0.000546193469
   target dn stat err =       0.004593939488
      target stat err =       0.003773854115
              std dev =       0.665120851821
             le_variance =       0.442385747527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281385565091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739804123699       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739804126158       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739804126454       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739804126489       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739804126515       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739804126514       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739804126503       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739804126511       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739804126518       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+03 is 2.999486e-08

solving harmonic davidson linear method for identity shift 2.1176e+04, overlap shift 2.1176e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739804123699       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739804124314       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739804124388       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739804124396       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739804124419       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739804124403       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739804124403       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739804124443       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739804124442       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+04 is 7.498743e-09

solving harmonic davidson linear method for identity shift 8.4703e+04, overlap shift 8.4703e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739804123699       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739804123853       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739804123871       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739804123909       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739804123783       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739804123872       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739804123813       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739804124016       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739804123777       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+04 is 1.874687e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.370809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0970e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888016e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738806e-02 3 1  ON 6
ci_08                -5.571446e-03 3 1  ON 7
ci_09                -9.045232e-03 3 1  ON 8
ci_10                -8.352745e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948871e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266773e-03 3 1  ON 14
ci_16                 6.426481e-03 3 1  ON 15
ci_17                -7.244555e-03 3 1  ON 16
ci_18                -5.940932e-03 3 1  ON 17
ci_19                 9.299850e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266023e-03 3 1  ON 21
ci_23                 4.757138e-03 3 1  ON 22
ci_24                 3.984856e-03 3 1  ON 23
ci_25                 2.848370e-03 3 1  ON 24
ci_26                 3.136293e-03 3 1  ON 25
ci_27                 3.318402e-03 3 1  ON 26
ci_28                 1.933029e-03 3 1  ON 27
ci_29                 1.306980e-03 3 1  ON 28
ci_30                -1.833572e-03 3 1  ON 29
ci_31                -5.581215e-04 3 1  ON 30
ci_32                -8.464129e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138000e-03 3 1  ON 33
ci_35                 1.456793e-03 3 1  ON 34
ci_36                -1.024420e-03 3 1  ON 35
ci_37                -1.031572e-03 3 1  ON 36
ci_38                -7.684998e-04 3 1  ON 37
ci_39                -6.245771e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248560e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482015e-03 3 1  ON 42
ci_44                -3.239148e-03 3 1  ON 43
ci_45                -5.273466e-04 3 1  ON 44
ci_46                -8.693910e-04 3 1  ON 45
ci_47                 1.538431e-03 3 1  ON 46
ci_48                 1.377257e-03 3 1  ON 47
ci_49                -1.040617e-03 3 1  ON 48
ci_50                -8.119839e-04 3 1  ON 49
ci_51                 1.439397e-04 3 1  ON 50
ci_52                 8.067496e-05 3 1  ON 51
ci_53                -6.382994e-04 3 1  ON 52
ci_54                -1.026821e-03 3 1  ON 53
ci_55                -6.525818e-04 3 1  ON 54
ci_56                 2.626588e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114394e-03 3 1  ON 57
ci_59                -1.466004e-03 3 1  ON 58
ci_60                 5.428228e-04 3 1  ON 59
ci_61                -1.294363e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728159e-04 3 1  ON 62
ci_64                -2.632774e-04 3 1  ON 63
ci_65                 6.160745e-05 3 1  ON 64
ci_66                -7.127206e-04 3 1  ON 65
ci_67                -8.949463e-04 3 1  ON 66
ci_68                -1.372093e-03 3 1  ON 67
ci_69                 1.317619e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.8413
    reference variance = 0.363106
====================================================
  Execution time = 4.1593e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5069e-01
  Total weights = 1.9642e+06
  Execution time = 5.8962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438322970902
                                         uncertainty =       0.003141637644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438322970902
                                         uncertainty =       0.003141637644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468122146
  error estimate for blocks of size 2^( 2) =       0.000493293118
  error estimate for blocks of size 2^( 3) =       0.000516782454
  error estimate for blocks of size 2^( 4) =       0.000534439738
  error estimate for blocks of size 2^( 5) =       0.000545009433
  error estimate for blocks of size 2^( 6) =       0.000549894878
  error estimate for blocks of size 2^( 7) =       0.000554719536

      target function =      -0.744764211115
              le_mean =     -22.814750762476
             les_mean =     520.963547022090
             stat err =       0.000546015896
             autocorr =       1.360480116018
   target nu stat err =       0.000546015896
   target dn stat err =       0.003650207772
      target stat err =       0.003064543916
              std dev =       0.662024687821
             le_variance =       0.438276687284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438322967818
                                         uncertainty =       0.003141637684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438322967818
                                         uncertainty =       0.003141637684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468122144
  error estimate for blocks of size 2^( 2) =       0.000493293117
  error estimate for blocks of size 2^( 3) =       0.000516782454
  error estimate for blocks of size 2^( 4) =       0.000534439738
  error estimate for blocks of size 2^( 5) =       0.000545009434
  error estimate for blocks of size 2^( 6) =       0.000549894879
  error estimate for blocks of size 2^( 7) =       0.000554719537

      target function =      -0.744764183686
              le_mean =     -22.814750762559
             les_mean =     520.963547059193
             stat err =       0.000546015897
             autocorr =       1.360480128256
   target nu stat err =       0.000546015897
   target dn stat err =       0.003650207289
      target stat err =       0.003064543305
              std dev =       0.662024685493
             le_variance =       0.438276684202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438322969360
                                         uncertainty =       0.003141637664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438322969360
                                         uncertainty =       0.003141637664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468122145
  error estimate for blocks of size 2^( 2) =       0.000493293117
  error estimate for blocks of size 2^( 3) =       0.000516782454
  error estimate for blocks of size 2^( 4) =       0.000534439738
  error estimate for blocks of size 2^( 5) =       0.000545009433
  error estimate for blocks of size 2^( 6) =       0.000549894879
  error estimate for blocks of size 2^( 7) =       0.000554719536

      target function =      -0.744764197409
              le_mean =     -22.814750762517
             les_mean =     520.963547040631
             stat err =       0.000546015897
             autocorr =       1.360480122140
   target nu stat err =       0.000546015897
   target dn stat err =       0.003650207530
      target stat err =       0.003064543611
              std dev =       0.662024686657
             le_variance =       0.438276685744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438322970709
                                         uncertainty =       0.003141637647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438322970709
                                         uncertainty =       0.003141637647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468122146
  error estimate for blocks of size 2^( 2) =       0.000493293118
  error estimate for blocks of size 2^( 3) =       0.000516782454
  error estimate for blocks of size 2^( 4) =       0.000534439738
  error estimate for blocks of size 2^( 5) =       0.000545009433
  error estimate for blocks of size 2^( 6) =       0.000549894878
  error estimate for blocks of size 2^( 7) =       0.000554719536

      target function =      -0.744764209403
              le_mean =     -22.814750762481
             les_mean =     520.963547024406
             stat err =       0.000546015896
             autocorr =       1.360480116781
   target nu stat err =       0.000546015896
   target dn stat err =       0.003650207742
      target stat err =       0.003064543878
              std dev =       0.662024687675
             le_variance =       0.438276687092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744764211115        initial  <--
     5.2940e+03     5.2940e+04             2.9995e-08        -0.744764183686
     2.1176e+04     2.1176e+05             7.4987e-09        -0.744764197409
     8.4703e+04     8.4703e+05             1.8747e-09        -0.744764209403

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.1379
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581224e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685007e-04 3 1  ON 37
ci_39                -6.245778e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067287e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466007e-03 3 1  ON 58
ci_60                 5.428191e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662226e-04 3 1  ON 61
ci_63                -7.728169e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317657e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2211e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.7886
    reference variance = 0.468135
====================================================
  Execution time = 4.4794e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4735e-01
  Total weights = 1.964386866e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435010885417
                                         uncertainty =       0.002060105866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435010885417
                                         uncertainty =       0.002060105866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466363103
  error estimate for blocks of size 2^( 2) =       0.000491734593
  error estimate for blocks of size 2^( 3) =       0.000515878127
  error estimate for blocks of size 2^( 4) =       0.000533623323
  error estimate for blocks of size 2^( 5) =       0.000543716302
  error estimate for blocks of size 2^( 6) =       0.000549084674
  error estimate for blocks of size 2^( 7) =       0.000551816646

      target function =      -0.747534040578
              le_mean =     -22.814855017816
             les_mean =     520.964958515547
             stat err =       0.000544560236
             autocorr =       1.363463404258
   target nu stat err =       0.000544560236
   target dn stat err =       0.002850059633
      target stat err =       0.002439751567
              std dev =       0.659537025124
             le_variance =       0.434989087509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281485501782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+04, overlap shift 5.2940e+05 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747540988113       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747540988263       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747540988280       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747540988288       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747540988288       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747540988290       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747540988312       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747540988158       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747540988369       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747540988373       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+04 is 2.001722e-09

solving harmonic davidson linear method for identity shift 2.1176e+05, overlap shift 2.1176e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747540988113       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747540988151       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747540988155       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747540987954       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747540988157       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747540988389       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747540988319       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747540988206       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747540988304       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747540988394       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+05 is 5.004309e-10

solving harmonic davidson linear method for identity shift 8.4703e+05, overlap shift 8.4703e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747540988113       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747540988123       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747540988124       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747540988124       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747540987967       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747540988464       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747540987135       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747540985715       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747540986192       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747540988270       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+05 is 1.251077e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.379171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2542e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136290e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581224e-04 3 1  ON 30
ci_32                -8.464149e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456796e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685005e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482018e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273459e-04 3 1  ON 44
ci_46                -8.693924e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119846e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067280e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466007e-03 3 1  ON 58
ci_60                 5.428190e-04 3 1  ON 59
ci_61                -1.294345e-04 3 1  ON 60
ci_62                -6.662226e-04 3 1  ON 61
ci_63                -7.728167e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.160990e-05 3 1  ON 64
ci_66                -7.127206e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317654e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.795
    reference variance = 0.330627
====================================================
  Execution time = 4.1463e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4604e-01
  Total weights = 1.9641e+06
  Execution time = 5.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434576099555
                                         uncertainty =       0.001711513576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434576099555
                                         uncertainty =       0.001711513576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466099733
  error estimate for blocks of size 2^( 2) =       0.000491461777
  error estimate for blocks of size 2^( 3) =       0.000515729867
  error estimate for blocks of size 2^( 4) =       0.000533012315
  error estimate for blocks of size 2^( 5) =       0.000544220793
  error estimate for blocks of size 2^( 6) =       0.000550378060
  error estimate for blocks of size 2^( 7) =       0.000553867066

      target function =      -0.748607599319
              le_mean =     -22.813775957179
             les_mean =     520.914416984790
             stat err =       0.000545369558
             autocorr =       1.369065028557
   target nu stat err =       0.000545369558
   target dn stat err =       0.002684741114
      target stat err =       0.002310098976
              std dev =       0.659164563839
             le_variance =       0.434497922221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434576099398
                                         uncertainty =       0.001711513580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434576099398
                                         uncertainty =       0.001711513580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466099733
  error estimate for blocks of size 2^( 2) =       0.000491461777
  error estimate for blocks of size 2^( 3) =       0.000515729867
  error estimate for blocks of size 2^( 4) =       0.000533012315
  error estimate for blocks of size 2^( 5) =       0.000544220793
  error estimate for blocks of size 2^( 6) =       0.000550378060
  error estimate for blocks of size 2^( 7) =       0.000553867066

      target function =      -0.748607590607
              le_mean =     -22.813775957168
             les_mean =     520.914416994768
             stat err =       0.000545369559
             autocorr =       1.369065030373
   target nu stat err =       0.000545369559
   target dn stat err =       0.002684742572
      target stat err =       0.002310100093
              std dev =       0.659164563721
             le_variance =       0.434497922065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434576099476
                                         uncertainty =       0.001711513578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434576099476
                                         uncertainty =       0.001711513578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466099733
  error estimate for blocks of size 2^( 2) =       0.000491461777
  error estimate for blocks of size 2^( 3) =       0.000515729867
  error estimate for blocks of size 2^( 4) =       0.000533012315
  error estimate for blocks of size 2^( 5) =       0.000544220793
  error estimate for blocks of size 2^( 6) =       0.000550378060
  error estimate for blocks of size 2^( 7) =       0.000553867066

      target function =      -0.748607594964
              le_mean =     -22.813775957173
             les_mean =     520.914416989778
             stat err =       0.000545369558
             autocorr =       1.369065029456
   target nu stat err =       0.000545369558
   target dn stat err =       0.002684741843
      target stat err =       0.002310099535
              std dev =       0.659164563780
             le_variance =       0.434497922143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434576099545
                                         uncertainty =       0.001711513576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434576099545
                                         uncertainty =       0.001711513576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466099733
  error estimate for blocks of size 2^( 2) =       0.000491461777
  error estimate for blocks of size 2^( 3) =       0.000515729867
  error estimate for blocks of size 2^( 4) =       0.000533012315
  error estimate for blocks of size 2^( 5) =       0.000544220793
  error estimate for blocks of size 2^( 6) =       0.000550378060
  error estimate for blocks of size 2^( 7) =       0.000553867066

      target function =      -0.748607598775
              le_mean =     -22.813775957178
             les_mean =     520.914416985413
             stat err =       0.000545369558
             autocorr =       1.369065028671
   target nu stat err =       0.000545369558
   target dn stat err =       0.002684741205
      target stat err =       0.002310099046
              std dev =       0.659164563832
             le_variance =       0.434497922212


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748607599319        initial  <--
     5.2940e+04     5.2940e+05             2.0017e-09        -0.748607590607
     2.1176e+05     2.1176e+06             5.0043e-10        -0.748607594964
     8.4703e+05     8.4703e+06             1.2511e-10        -0.748607598775

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.0828
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581224e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685007e-04 3 1  ON 37
ci_39                -6.245778e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067287e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466007e-03 3 1  ON 58
ci_60                 5.428191e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662226e-04 3 1  ON 61
ci_63                -7.728169e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317657e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2366e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7815
    reference variance = 0.514813
====================================================
  Execution time = 4.2816e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4822e-01
  Total weights = 1.964295087e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436053709350
                                         uncertainty =       0.002186479427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436053709350
                                         uncertainty =       0.002186479427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466933448
  error estimate for blocks of size 2^( 2) =       0.000492474565
  error estimate for blocks of size 2^( 3) =       0.000516624585
  error estimate for blocks of size 2^( 4) =       0.000533749950
  error estimate for blocks of size 2^( 5) =       0.000544652786
  error estimate for blocks of size 2^( 6) =       0.000550332377
  error estimate for blocks of size 2^( 7) =       0.000552562199

      target function =      -0.746802318051
              le_mean =     -22.813998265427
             les_mean =     520.926741355198
             stat err =       0.000545324328
             autocorr =       1.363954159540
   target nu stat err =       0.000545324328
   target dn stat err =       0.002802450531
      target stat err =       0.002394133381
              std dev =       0.660343615512
             le_variance =       0.436053690548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281399826543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+05, overlap shift 5.2940e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746808943580       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746808943601       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746808943604       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746808943604       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746808943569       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746808945008       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746808943628       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746808943955       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746808943604       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+05 is 2.253341e-10

solving harmonic davidson linear method for identity shift 2.1176e+06, overlap shift 2.1176e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746808943580       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746808943585       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746808943586       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746808943586       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746808943586       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746808943042       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746808945498       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746808946656       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746808947850       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+06 is 5.633353e-11

solving harmonic davidson linear method for identity shift 8.4703e+06, overlap shift 8.4703e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746808943580       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746808943581       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746808943582       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746808943581       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746808943674       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746808940613       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746808955788       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746808943436       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746808931890       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+06 is 1.408340e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.4563e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581224e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685007e-04 3 1  ON 37
ci_39                -6.245778e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067289e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466007e-03 3 1  ON 58
ci_60                 5.428190e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662226e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317657e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7943
    reference variance = 0.313781
====================================================
  Execution time = 4.2612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4630e-01
  Total weights = 1.9644e+06
  Execution time = 5.9470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433989980158
                                         uncertainty =       0.002053650436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433989980158
                                         uncertainty =       0.002053650436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465781852
  error estimate for blocks of size 2^( 2) =       0.000491968450
  error estimate for blocks of size 2^( 3) =       0.000515636704
  error estimate for blocks of size 2^( 4) =       0.000534136048
  error estimate for blocks of size 2^( 5) =       0.000545244771
  error estimate for blocks of size 2^( 6) =       0.000552088253
  error estimate for blocks of size 2^( 7) =       0.000557732580

      target function =      -0.748390975621
              le_mean =     -22.813349606697
             les_mean =     520.895219188261
             stat err =       0.000547300413
             autocorr =       1.380658991736
   target nu stat err =       0.000547300413
   target dn stat err =       0.002628919277
      target stat err =       0.002263271507
              std dev =       0.658715011628
             le_variance =       0.433905466544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433989980132
                                         uncertainty =       0.002053650436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433989980132
                                         uncertainty =       0.002053650436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465781852
  error estimate for blocks of size 2^( 2) =       0.000491968450
  error estimate for blocks of size 2^( 3) =       0.000515636704
  error estimate for blocks of size 2^( 4) =       0.000534136048
  error estimate for blocks of size 2^( 5) =       0.000545244771
  error estimate for blocks of size 2^( 6) =       0.000552088253
  error estimate for blocks of size 2^( 7) =       0.000557732580

      target function =      -0.748390975732
              le_mean =     -22.813349606695
             les_mean =     520.895219188038
             stat err =       0.000547300413
             autocorr =       1.380658992004
   target nu stat err =       0.000547300413
   target dn stat err =       0.002628919274
      target stat err =       0.002263271506
              std dev =       0.658715011608
             le_variance =       0.433905466518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433989980145
                                         uncertainty =       0.002053650436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433989980145
                                         uncertainty =       0.002053650436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465781852
  error estimate for blocks of size 2^( 2) =       0.000491968450
  error estimate for blocks of size 2^( 3) =       0.000515636704
  error estimate for blocks of size 2^( 4) =       0.000534136048
  error estimate for blocks of size 2^( 5) =       0.000545244771
  error estimate for blocks of size 2^( 6) =       0.000552088253
  error estimate for blocks of size 2^( 7) =       0.000557732580

      target function =      -0.748390975676
              le_mean =     -22.813349606696
             les_mean =     520.895219188149
             stat err =       0.000547300413
             autocorr =       1.380658991877
   target nu stat err =       0.000547300413
   target dn stat err =       0.002628919275
      target stat err =       0.002263271506
              std dev =       0.658715011618
             le_variance =       0.433905466531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433989980156
                                         uncertainty =       0.002053650436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433989980156
                                         uncertainty =       0.002053650436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465781852
  error estimate for blocks of size 2^( 2) =       0.000491968450
  error estimate for blocks of size 2^( 3) =       0.000515636704
  error estimate for blocks of size 2^( 4) =       0.000534136048
  error estimate for blocks of size 2^( 5) =       0.000545244771
  error estimate for blocks of size 2^( 6) =       0.000552088253
  error estimate for blocks of size 2^( 7) =       0.000557732580

      target function =      -0.748390975628
              le_mean =     -22.813349606696
             les_mean =     520.895219188247
             stat err =       0.000547300413
             autocorr =       1.380658991763
   target nu stat err =       0.000547300413
   target dn stat err =       0.002628919276
      target stat err =       0.002263271507
              std dev =       0.658715011626
             le_variance =       0.433905466542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748390975621        initial
     5.2940e+05     5.2940e+06             2.2533e-10        -0.748390975732  <--
     2.1176e+06     2.1176e+07             5.6334e-11        -0.748390975676
     8.4703e+06     8.4703e+07             1.4083e-11        -0.748390975628

*****************************************************************************
Applying the update for shift_i =   5.2940e+05     and shift_s =   5.2940e+06
*****************************************************************************

  Execution time = 7.2437e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273457e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067295e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466007e-03 3 1  ON 58
ci_60                 5.428190e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632762e-04 3 1  ON 63
ci_65                 6.161001e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317657e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2703e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7924
    reference variance = 0.469932
====================================================
  Execution time = 4.4194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5323e-01
  Total weights = 1.964291721e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437390566815
                                         uncertainty =       0.003379412938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437390566815
                                         uncertainty =       0.003379412938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467632345
  error estimate for blocks of size 2^( 2) =       0.000493249035
  error estimate for blocks of size 2^( 3) =       0.000516894739
  error estimate for blocks of size 2^( 4) =       0.000534091583
  error estimate for blocks of size 2^( 5) =       0.000544193613
  error estimate for blocks of size 2^( 6) =       0.000548833256
  error estimate for blocks of size 2^( 7) =       0.000551372809

      target function =      -0.742665013990
              le_mean =     -22.813958839410
             les_mean =     520.929943364594
             stat err =       0.000544622815
             autocorr =       1.356383742699
   target nu stat err =       0.000544622815
   target dn stat err =       0.006061864903
      target stat err =       0.004991970550
              std dev =       0.661332004732
             le_variance =       0.437360020482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281395883941e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+05, overlap shift 1.3235e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742697309362       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742697309480       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742697309493       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742697309496       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742697309497       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742697309533       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742697309487       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742697309516       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742697309414       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742697309876       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+05 is 1.481888e-09

solving harmonic davidson linear method for identity shift 5.2940e+05, overlap shift 5.2940e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742697309362       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742697309391       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742697309395       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742697309395       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742697309396       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742697310139       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742697307552       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742697309474       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742697309564       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742697309482       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+05 is 3.704719e-10

solving harmonic davidson linear method for identity shift 2.1176e+06, overlap shift 2.1176e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742697309362       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742697309369       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742697309370       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742697309370       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742697309371       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742697308995       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742697310344       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742697304051       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742697311200       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742697306646       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+06 is 9.261804e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1865e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685005e-04 3 1  ON 37
ci_39                -6.245778e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482018e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273457e-04 3 1  ON 44
ci_46                -8.693926e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439386e-04 3 1  ON 50
ci_52                 8.067291e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428192e-04 3 1  ON 59
ci_61                -1.294344e-04 3 1  ON 60
ci_62                -6.662224e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632762e-04 3 1  ON 63
ci_65                 6.161012e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7691
    reference variance = 0.499255
====================================================
  Execution time = 4.4391e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5264e-01
  Total weights = 1.9644e+06
  Execution time = 5.9642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820599709
                                         uncertainty =       0.002380804480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820599709
                                         uncertainty =       0.002380804480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467344349
  error estimate for blocks of size 2^( 2) =       0.000492782504
  error estimate for blocks of size 2^( 3) =       0.000517047359
  error estimate for blocks of size 2^( 4) =       0.000534355691
  error estimate for blocks of size 2^( 5) =       0.000545160616
  error estimate for blocks of size 2^( 6) =       0.000551752715
  error estimate for blocks of size 2^( 7) =       0.000553586541

      target function =      -0.743163563884
              le_mean =     -22.814523582454
             les_mean =     520.955131264024
             stat err =       0.000546213891
             autocorr =       1.366002486590
   target nu stat err =       0.000546213891
   target dn stat err =       0.003437663437
      target stat err =       0.002880141594
              std dev =       0.660924716497
             le_variance =       0.436821480877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820599520
                                         uncertainty =       0.002380804455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820599520
                                         uncertainty =       0.002380804455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467344349
  error estimate for blocks of size 2^( 2) =       0.000492782504
  error estimate for blocks of size 2^( 3) =       0.000517047359
  error estimate for blocks of size 2^( 4) =       0.000534355691
  error estimate for blocks of size 2^( 5) =       0.000545160615
  error estimate for blocks of size 2^( 6) =       0.000551752715
  error estimate for blocks of size 2^( 7) =       0.000553586541

      target function =      -0.743163559390
              le_mean =     -22.814523582450
             les_mean =     520.955131269299
             stat err =       0.000546213891
             autocorr =       1.366002487162
   target nu stat err =       0.000546213891
   target dn stat err =       0.003437665588
      target stat err =       0.002880143283
              std dev =       0.660924716353
             le_variance =       0.436821480687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820599615
                                         uncertainty =       0.002380804467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820599615
                                         uncertainty =       0.002380804467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467344349
  error estimate for blocks of size 2^( 2) =       0.000492782504
  error estimate for blocks of size 2^( 3) =       0.000517047359
  error estimate for blocks of size 2^( 4) =       0.000534355691
  error estimate for blocks of size 2^( 5) =       0.000545160615
  error estimate for blocks of size 2^( 6) =       0.000551752715
  error estimate for blocks of size 2^( 7) =       0.000553586541

      target function =      -0.743163561637
              le_mean =     -22.814523582452
             les_mean =     520.955131266662
             stat err =       0.000546213891
             autocorr =       1.366002486873
   target nu stat err =       0.000546213891
   target dn stat err =       0.003437664512
      target stat err =       0.002880142438
              std dev =       0.660924716425
             le_variance =       0.436821480782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820599698
                                         uncertainty =       0.002380804478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820599698
                                         uncertainty =       0.002380804478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467344349
  error estimate for blocks of size 2^( 2) =       0.000492782504
  error estimate for blocks of size 2^( 3) =       0.000517047359
  error estimate for blocks of size 2^( 4) =       0.000534355691
  error estimate for blocks of size 2^( 5) =       0.000545160616
  error estimate for blocks of size 2^( 6) =       0.000551752715
  error estimate for blocks of size 2^( 7) =       0.000553586541

      target function =      -0.743163563603
              le_mean =     -22.814523582454
             les_mean =     520.955131264354
             stat err =       0.000546213891
             autocorr =       1.366002486634
   target nu stat err =       0.000546213891
   target dn stat err =       0.003437663571
      target stat err =       0.002880141699
              std dev =       0.660924716488
             le_variance =       0.436821480865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743163563884        initial  <--
     1.3235e+05     1.3235e+06             1.4819e-09        -0.743163559390
     5.2940e+05     5.2940e+06             3.7047e-10        -0.743163561637
     2.1176e+06     2.1176e+07             9.2618e-11        -0.743163563603

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 74.2528
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273457e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067295e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466007e-03 3 1  ON 58
ci_60                 5.428190e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632762e-04 3 1  ON 63
ci_65                 6.161001e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317657e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2617e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.9001
    reference variance = 0.229143
====================================================
  Execution time = 4.4116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5374e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4924e-01
  Total weights = 1.964468097e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435646531204
                                         uncertainty =       0.002100751859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435646531204
                                         uncertainty =       0.002100751859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466733961
  error estimate for blocks of size 2^( 2) =       0.000492354658
  error estimate for blocks of size 2^( 3) =       0.000516229178
  error estimate for blocks of size 2^( 4) =       0.000533494672
  error estimate for blocks of size 2^( 5) =       0.000544000618
  error estimate for blocks of size 2^( 6) =       0.000550514342
  error estimate for blocks of size 2^( 7) =       0.000554638047

      target function =      -0.745960809504
              le_mean =     -22.814155933457
             les_mean =     520.934951607028
             stat err =       0.000545661920
             autocorr =       1.366811071170
   target nu stat err =       0.000545661920
   target dn stat err =       0.003424177845
      target stat err =       0.002888798962
              std dev =       0.660061497483
             le_variance =       0.435681180459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281415593346e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+06, overlap shift 1.3235e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745970945174       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745970945184       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745970945186       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745970945186       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745970945223       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745970948664       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745970948308       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745970945054       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745970944898       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+06 is 1.304683e-10

solving harmonic davidson linear method for identity shift 5.2940e+06, overlap shift 5.2940e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745970945174       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745970945177       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745970945177       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745970945177       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745970945189       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745970946701       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745970945177       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745970942385       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745970941913       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+06 is 3.261711e-11

solving harmonic davidson linear method for identity shift 2.1176e+07, overlap shift 2.1176e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745970945174       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745970945175       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745970945175       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745970945175       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745970945158       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745970937211       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745970965708       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745970959209       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745970977436       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+07 is 8.154304e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1781e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067295e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428190e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161001e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6997
    reference variance = 0.294899
====================================================
  Execution time = 4.3046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5099e-01
  Total weights = 1.9643e+06
  Execution time = 5.9343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436428698395
                                         uncertainty =       0.001987623227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436428698395
                                         uncertainty =       0.001987623227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467198065
  error estimate for blocks of size 2^( 2) =       0.000492560473
  error estimate for blocks of size 2^( 3) =       0.000516764121
  error estimate for blocks of size 2^( 4) =       0.000534260763
  error estimate for blocks of size 2^( 5) =       0.000545637197
  error estimate for blocks of size 2^( 6) =       0.000553175222
  error estimate for blocks of size 2^( 7) =       0.000558845217

      target function =      -0.744519866052
              le_mean =     -22.814504097514
             les_mean =     520.952589948889
             stat err =       0.000547979600
             autocorr =       1.375709419905
   target nu stat err =       0.000547979600
   target dn stat err =       0.003379004320
      target stat err =       0.002843610208
              std dev =       0.660717839422
             le_variance =       0.436548063331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436428698370
                                         uncertainty =       0.001987623224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436428698370
                                         uncertainty =       0.001987623224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467198065
  error estimate for blocks of size 2^( 2) =       0.000492560473
  error estimate for blocks of size 2^( 3) =       0.000516764121
  error estimate for blocks of size 2^( 4) =       0.000534260763
  error estimate for blocks of size 2^( 5) =       0.000545637197
  error estimate for blocks of size 2^( 6) =       0.000553175222
  error estimate for blocks of size 2^( 7) =       0.000558845217

      target function =      -0.744519866123
              le_mean =     -22.814504097514
             les_mean =     520.952589948787
             stat err =       0.000547979600
             autocorr =       1.375709419997
   target nu stat err =       0.000547979600
   target dn stat err =       0.003379004304
      target stat err =       0.002843610196
              std dev =       0.660717839404
             le_variance =       0.436548063306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436428698382
                                         uncertainty =       0.001987623226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436428698382
                                         uncertainty =       0.001987623226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467198065
  error estimate for blocks of size 2^( 2) =       0.000492560473
  error estimate for blocks of size 2^( 3) =       0.000516764121
  error estimate for blocks of size 2^( 4) =       0.000534260763
  error estimate for blocks of size 2^( 5) =       0.000545637197
  error estimate for blocks of size 2^( 6) =       0.000553175222
  error estimate for blocks of size 2^( 7) =       0.000558845217

      target function =      -0.744519866087
              le_mean =     -22.814504097514
             les_mean =     520.952589948838
             stat err =       0.000547979600
             autocorr =       1.375709419942
   target nu stat err =       0.000547979600
   target dn stat err =       0.003379004312
      target stat err =       0.002843610202
              std dev =       0.660717839413
             le_variance =       0.436548063319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436428698393
                                         uncertainty =       0.001987623227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436428698393
                                         uncertainty =       0.001987623227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467198065
  error estimate for blocks of size 2^( 2) =       0.000492560473
  error estimate for blocks of size 2^( 3) =       0.000516764121
  error estimate for blocks of size 2^( 4) =       0.000534260763
  error estimate for blocks of size 2^( 5) =       0.000545637197
  error estimate for blocks of size 2^( 6) =       0.000553175222
  error estimate for blocks of size 2^( 7) =       0.000558845217

      target function =      -0.744519866056
              le_mean =     -22.814504097514
             les_mean =     520.952589948883
             stat err =       0.000547979600
             autocorr =       1.375709419910
   target nu stat err =       0.000547979600
   target dn stat err =       0.003379004319
      target stat err =       0.002843610208
              std dev =       0.660717839422
             le_variance =       0.436548063330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744519866052        initial
     1.3235e+06     1.3235e+07             1.3047e-10        -0.744519866123  <--
     5.2940e+06     5.2940e+07             3.2617e-11        -0.744519866087
     2.1176e+07     2.1176e+08             8.1543e-12        -0.744519866056

*****************************************************************************
Applying the update for shift_i =   1.3235e+06     and shift_s =   1.3235e+07
*****************************************************************************

  Execution time = 7.2791e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161001e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949473e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2460e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.7774
    reference variance = 0.308518
====================================================
  Execution time = 4.2724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4690e-01
  Total weights = 1.964274570e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434755301994
                                         uncertainty =       0.002392362266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434755301994
                                         uncertainty =       0.002392362266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466253622
  error estimate for blocks of size 2^( 2) =       0.000491847578
  error estimate for blocks of size 2^( 3) =       0.000515239773
  error estimate for blocks of size 2^( 4) =       0.000532558195
  error estimate for blocks of size 2^( 5) =       0.000543518553
  error estimate for blocks of size 2^( 6) =       0.000550284488
  error estimate for blocks of size 2^( 7) =       0.000555524897

      target function =      -0.747905602216
              le_mean =     -22.814775486054
             les_mean =     520.960880305662
             stat err =       0.000545471533
             autocorr =       1.368673143025
   target nu stat err =       0.000545471533
   target dn stat err =       0.002922494267
      target stat err =       0.002500362327
              std dev =       0.659382195182
             le_variance =       0.434784879324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281477548605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+05, overlap shift 3.3087e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747913036999       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747913037029       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747913037032       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747913037033       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747913036877       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747913037052       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747913036835       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747913037250       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747913037040       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+05 is 3.123699e-10

solving harmonic davidson linear method for identity shift 1.3235e+06, overlap shift 1.3235e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747913036999       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747913037006       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747913037007       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747913037007       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747913036229       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747913037897       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747913034614       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747913037681       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747913036872       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+06 is 7.809247e-11

solving harmonic davidson linear method for identity shift 5.2940e+06, overlap shift 5.2940e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747913036999       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747913037000       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747913037001       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747913037001       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747913036711       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747913031586       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747913037223       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747913021784       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747913050135       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+06 is 1.952315e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0415e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685005e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273457e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119843e-04 3 1  ON 49
ci_51                 1.439384e-04 3 1  ON 50
ci_52                 8.067297e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632762e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949473e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.7088
    reference variance = 0.619032
====================================================
  Execution time = 4.1495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4411e-01
  Total weights = 1.9644e+06
  Execution time = 5.9327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432993032308
                                         uncertainty =       0.002067917685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432993032308
                                         uncertainty =       0.002067917685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465267923
  error estimate for blocks of size 2^( 2) =       0.000490909902
  error estimate for blocks of size 2^( 3) =       0.000514320179
  error estimate for blocks of size 2^( 4) =       0.000531568048
  error estimate for blocks of size 2^( 5) =       0.000542177744
  error estimate for blocks of size 2^( 6) =       0.000545806759
  error estimate for blocks of size 2^( 7) =       0.000547540277

      target function =      -0.750238787891
              le_mean =     -22.815125481385
             les_mean =     520.974056150759
             stat err =       0.000541773207
             autocorr =       1.355903626323
   target nu stat err =       0.000541773207
   target dn stat err =       0.002499619872
      target stat err =       0.002174405783
              std dev =       0.657988207353
             le_variance =       0.432948481016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432993032308
                                         uncertainty =       0.002067917684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432993032308
                                         uncertainty =       0.002067917684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465267923
  error estimate for blocks of size 2^( 2) =       0.000490909902
  error estimate for blocks of size 2^( 3) =       0.000514320179
  error estimate for blocks of size 2^( 4) =       0.000531568048
  error estimate for blocks of size 2^( 5) =       0.000542177744
  error estimate for blocks of size 2^( 6) =       0.000545806759
  error estimate for blocks of size 2^( 7) =       0.000547540278

      target function =      -0.750238787685
              le_mean =     -22.815125481386
             les_mean =     520.974056151075
             stat err =       0.000541773207
             autocorr =       1.355903626474
   target nu stat err =       0.000541773207
   target dn stat err =       0.002499619910
      target stat err =       0.002174405813
              std dev =       0.657988207353
             le_variance =       0.432948481016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432993032308
                                         uncertainty =       0.002067917684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432993032308
                                         uncertainty =       0.002067917684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465267923
  error estimate for blocks of size 2^( 2) =       0.000490909902
  error estimate for blocks of size 2^( 3) =       0.000514320179
  error estimate for blocks of size 2^( 4) =       0.000531568048
  error estimate for blocks of size 2^( 5) =       0.000542177744
  error estimate for blocks of size 2^( 6) =       0.000545806759
  error estimate for blocks of size 2^( 7) =       0.000547540277

      target function =      -0.750238787788
              le_mean =     -22.815125481385
             les_mean =     520.974056150917
             stat err =       0.000541773207
             autocorr =       1.355903626396
   target nu stat err =       0.000541773207
   target dn stat err =       0.002499619891
      target stat err =       0.002174405798
              std dev =       0.657988207353
             le_variance =       0.432948481016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432993032308
                                         uncertainty =       0.002067917685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432993032308
                                         uncertainty =       0.002067917685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465267923
  error estimate for blocks of size 2^( 2) =       0.000490909902
  error estimate for blocks of size 2^( 3) =       0.000514320179
  error estimate for blocks of size 2^( 4) =       0.000531568048
  error estimate for blocks of size 2^( 5) =       0.000542177744
  error estimate for blocks of size 2^( 6) =       0.000545806759
  error estimate for blocks of size 2^( 7) =       0.000547540277

      target function =      -0.750238787878
              le_mean =     -22.815125481385
             les_mean =     520.974056150779
             stat err =       0.000541773207
             autocorr =       1.355903626314
   target nu stat err =       0.000541773207
   target dn stat err =       0.002499619874
      target stat err =       0.002174405785
              std dev =       0.657988207354
             le_variance =       0.432948481016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750238787891        initial  <--
     3.3087e+05     3.3087e+06             3.1237e-10        -0.750238787685
     1.3235e+06     1.3235e+07             7.8092e-11        -0.750238787788
     5.2940e+06     5.2940e+07             1.9523e-11        -0.750238787878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.1914
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161001e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949473e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2166e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.8288
    reference variance = 0.362756
====================================================
  Execution time = 4.4391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4658e-01
  Total weights = 1.963981087e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433058443129
                                         uncertainty =       0.001780059861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433058443129
                                         uncertainty =       0.001780059861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465279962
  error estimate for blocks of size 2^( 2) =       0.000490595774
  error estimate for blocks of size 2^( 3) =       0.000514512497
  error estimate for blocks of size 2^( 4) =       0.000532128770
  error estimate for blocks of size 2^( 5) =       0.000542814611
  error estimate for blocks of size 2^( 6) =       0.000550516395
  error estimate for blocks of size 2^( 7) =       0.000552786770

      target function =      -0.748171982182
              le_mean =     -22.815275803628
             les_mean =     520.983389863374
             stat err =       0.000544561636
             autocorr =       1.369825940344
   target nu stat err =       0.000544561636
   target dn stat err =       0.003554153875
      target stat err =       0.003015930702
              std dev =       0.658005232764
             le_variance =       0.432970886345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281527580363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+06, overlap shift 3.3087e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748183154218       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748183154220       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748183154221       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748183154221       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748183154221       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748183154221       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748183154221       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748183158803       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748183154221       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748183158776       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+06 is 3.979825e-11

solving harmonic davidson linear method for identity shift 1.3235e+07, overlap shift 1.3235e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748183154218       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748183154219       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748183154219       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748183154219       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748183154219       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748183156387       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748183154219       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748183154219       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748183154219       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748183154219       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+07 is 9.949638e-12

solving harmonic davidson linear method for identity shift 5.2940e+07, overlap shift 5.2940e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748183154218       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748183154218       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748183154218       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748183154218       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748183158675       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748183115011       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748183154218       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748183154218       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748183113576       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748183167401       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+07 is 2.487305e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2043e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525815e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294347e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949473e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.7631
    reference variance = 0.289672
====================================================
  Execution time = 4.1411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5001e-01
  Total weights = 1.9644e+06
  Execution time = 5.8980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437063110961
                                         uncertainty =       0.002833115768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437063110961
                                         uncertainty =       0.002833115768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467438857
  error estimate for blocks of size 2^( 2) =       0.000492748020
  error estimate for blocks of size 2^( 3) =       0.000516353221
  error estimate for blocks of size 2^( 4) =       0.000533690662
  error estimate for blocks of size 2^( 5) =       0.000544076506
  error estimate for blocks of size 2^( 6) =       0.000551820410
  error estimate for blocks of size 2^( 7) =       0.000555168992

      target function =      -0.745325499570
              le_mean =     -22.814928371905
             les_mean =     520.970970367220
             stat err =       0.000546189142
             autocorr =       1.365326444203
   target nu stat err =       0.000546189142
   target dn stat err =       0.003748106677
      target stat err =       0.003149109781
              std dev =       0.661058371757
             le_variance =       0.436998170870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437063110951
                                         uncertainty =       0.002833115768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437063110951
                                         uncertainty =       0.002833115768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467438857
  error estimate for blocks of size 2^( 2) =       0.000492748020
  error estimate for blocks of size 2^( 3) =       0.000516353221
  error estimate for blocks of size 2^( 4) =       0.000533690662
  error estimate for blocks of size 2^( 5) =       0.000544076506
  error estimate for blocks of size 2^( 6) =       0.000551820410
  error estimate for blocks of size 2^( 7) =       0.000555168992

      target function =      -0.745325499583
              le_mean =     -22.814928371905
             les_mean =     520.970970367201
             stat err =       0.000546189142
             autocorr =       1.365326444204
   target nu stat err =       0.000546189142
   target dn stat err =       0.003748106669
      target stat err =       0.003149109775
              std dev =       0.661058371749
             le_variance =       0.436998170860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437063110956
                                         uncertainty =       0.002833115768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437063110956
                                         uncertainty =       0.002833115768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467438857
  error estimate for blocks of size 2^( 2) =       0.000492748020
  error estimate for blocks of size 2^( 3) =       0.000516353221
  error estimate for blocks of size 2^( 4) =       0.000533690662
  error estimate for blocks of size 2^( 5) =       0.000544076506
  error estimate for blocks of size 2^( 6) =       0.000551820410
  error estimate for blocks of size 2^( 7) =       0.000555168992

      target function =      -0.745325499576
              le_mean =     -22.814928371905
             les_mean =     520.970970367210
             stat err =       0.000546189142
             autocorr =       1.365326444196
   target nu stat err =       0.000546189142
   target dn stat err =       0.003748106673
      target stat err =       0.003149109778
              std dev =       0.661058371753
             le_variance =       0.436998170865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437063110960
                                         uncertainty =       0.002833115768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437063110960
                                         uncertainty =       0.002833115768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467438857
  error estimate for blocks of size 2^( 2) =       0.000492748020
  error estimate for blocks of size 2^( 3) =       0.000516353221
  error estimate for blocks of size 2^( 4) =       0.000533690662
  error estimate for blocks of size 2^( 5) =       0.000544076506
  error estimate for blocks of size 2^( 6) =       0.000551820410
  error estimate for blocks of size 2^( 7) =       0.000555168992

      target function =      -0.745325499571
              le_mean =     -22.814928371905
             les_mean =     520.970970367219
             stat err =       0.000546189142
             autocorr =       1.365326444193
   target nu stat err =       0.000546189142
   target dn stat err =       0.003748106676
      target stat err =       0.003149109781
              std dev =       0.661058371756
             le_variance =       0.436998170869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745325499570        initial
     3.3087e+06     3.3087e+07             3.9798e-11        -0.745325499583  <--
     1.3235e+07     1.3235e+08             9.9496e-12        -0.745325499576
     5.2940e+07     5.2940e+08             2.4873e-12        -0.745325499571

*****************************************************************************
Applying the update for shift_i =   3.3087e+06     and shift_s =   3.3087e+07
*****************************************************************************

  Execution time = 7.1032e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2310e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7765
    reference variance = 0.357883
====================================================
  Execution time = 4.4265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5373e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4859e-01
  Total weights = 1.964383961e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433434111057
                                         uncertainty =       0.002211902719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433434111057
                                         uncertainty =       0.002211902719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465547702
  error estimate for blocks of size 2^( 2) =       0.000491739273
  error estimate for blocks of size 2^( 3) =       0.000515867010
  error estimate for blocks of size 2^( 4) =       0.000534284967
  error estimate for blocks of size 2^( 5) =       0.000545293640
  error estimate for blocks of size 2^( 6) =       0.000550044702
  error estimate for blocks of size 2^( 7) =       0.000553009161

      target function =      -0.746501477751
              le_mean =     -22.814901735057
             les_mean =     520.968327589737
             stat err =       0.000545658118
             autocorr =       1.373766325685
   target nu stat err =       0.000545658118
   target dn stat err =       0.004102390355
      target stat err =       0.003446728643
              std dev =       0.658383873864
             le_variance =       0.433469325365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281490173506e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+05, overlap shift 8.2718e+06 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746516444757       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746516444772       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746516444775       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746516444775       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746516444326       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746516444775       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746516444775       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746516444007       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746516445285       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+05 is 1.674167e-10

solving harmonic davidson linear method for identity shift 3.3087e+06, overlap shift 3.3087e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746516444757       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746516444760       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746516444761       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746516444761       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746516446669       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746516445525       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746516440667       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746516443831       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746516449976       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+06 is 4.185411e-11

solving harmonic davidson linear method for identity shift 1.3235e+07, overlap shift 1.3235e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746516444757       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746516444757       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746516444758       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746516443844       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746516446163       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746516444758       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746516444758       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746516449946       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746516434963       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+07 is 1.046358e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.398592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1919e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581226e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685005e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119843e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.160998e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949473e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7699
    reference variance = 0.28422
====================================================
  Execution time = 4.1590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4589e-01
  Total weights = 1.9645e+06
  Execution time = 5.9032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434886233515
                                         uncertainty =       0.001989144781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434886233515
                                         uncertainty =       0.001989144781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466288856
  error estimate for blocks of size 2^( 2) =       0.000492114416
  error estimate for blocks of size 2^( 3) =       0.000515827556
  error estimate for blocks of size 2^( 4) =       0.000533758931
  error estimate for blocks of size 2^( 5) =       0.000545277899
  error estimate for blocks of size 2^( 6) =       0.000552180532
  error estimate for blocks of size 2^( 7) =       0.000551866905

      target function =      -0.748734419073
              le_mean =     -22.813935760443
             les_mean =     520.921559305177
             stat err =       0.000545771067
             autocorr =       1.369969646415
   target nu stat err =       0.000545771067
   target dn stat err =       0.002469691902
      target stat err =       0.002139585967
              std dev =       0.659432023823
             le_variance =       0.434850594044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434886233511
                                         uncertainty =       0.001989144785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434886233511
                                         uncertainty =       0.001989144785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466288856
  error estimate for blocks of size 2^( 2) =       0.000492114416
  error estimate for blocks of size 2^( 3) =       0.000515827556
  error estimate for blocks of size 2^( 4) =       0.000533758931
  error estimate for blocks of size 2^( 5) =       0.000545277899
  error estimate for blocks of size 2^( 6) =       0.000552180532
  error estimate for blocks of size 2^( 7) =       0.000551866905

      target function =      -0.748734418032
              le_mean =     -22.813935760442
             les_mean =     520.921559306400
             stat err =       0.000545771067
             autocorr =       1.369969646522
   target nu stat err =       0.000545771067
   target dn stat err =       0.002469692017
      target stat err =       0.002139586053
              std dev =       0.659432023820
             le_variance =       0.434850594039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434886233513
                                         uncertainty =       0.001989144783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434886233513
                                         uncertainty =       0.001989144783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466288856
  error estimate for blocks of size 2^( 2) =       0.000492114416
  error estimate for blocks of size 2^( 3) =       0.000515827556
  error estimate for blocks of size 2^( 4) =       0.000533758931
  error estimate for blocks of size 2^( 5) =       0.000545277899
  error estimate for blocks of size 2^( 6) =       0.000552180532
  error estimate for blocks of size 2^( 7) =       0.000551866905

      target function =      -0.748734418552
              le_mean =     -22.813935760443
             les_mean =     520.921559305789
             stat err =       0.000545771067
             autocorr =       1.369969646468
   target nu stat err =       0.000545771067
   target dn stat err =       0.002469691959
      target stat err =       0.002139586010
              std dev =       0.659432023822
             le_variance =       0.434850594042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434886233515
                                         uncertainty =       0.001989144781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434886233515
                                         uncertainty =       0.001989144781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466288856
  error estimate for blocks of size 2^( 2) =       0.000492114416
  error estimate for blocks of size 2^( 3) =       0.000515827556
  error estimate for blocks of size 2^( 4) =       0.000533758931
  error estimate for blocks of size 2^( 5) =       0.000545277899
  error estimate for blocks of size 2^( 6) =       0.000552180532
  error estimate for blocks of size 2^( 7) =       0.000551866905

      target function =      -0.748734419008
              le_mean =     -22.813935760443
             les_mean =     520.921559305254
             stat err =       0.000545771067
             autocorr =       1.369969646419
   target nu stat err =       0.000545771067
   target dn stat err =       0.002469691909
      target stat err =       0.002139585972
              std dev =       0.659432023823
             le_variance =       0.434850594044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748734419073        initial  <--
     8.2718e+05     8.2718e+06             1.6742e-10        -0.748734418032
     3.3087e+06     3.3087e+07             4.1854e-11        -0.748734418552
     1.3235e+07     1.3235e+08             1.0464e-11        -0.748734419008

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.2972
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2324e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.8894
    reference variance = 0.323846
====================================================
  Execution time = 4.2780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4947e-01
  Total weights = 1.964322632e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436227611137
                                         uncertainty =       0.002068744246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436227611137
                                         uncertainty =       0.002068744246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467042691
  error estimate for blocks of size 2^( 2) =       0.000492393451
  error estimate for blocks of size 2^( 3) =       0.000516133635
  error estimate for blocks of size 2^( 4) =       0.000534385600
  error estimate for blocks of size 2^( 5) =       0.000546249331
  error estimate for blocks of size 2^( 6) =       0.000549770070
  error estimate for blocks of size 2^( 7) =       0.000552432706

      target function =      -0.745782604573
              le_mean =     -22.815104794268
             les_mean =     520.978473593653
             stat err =       0.000545709427
             autocorr =       1.365242347758
   target nu stat err =       0.000545709427
   target dn stat err =       0.002922235718
      target stat err =       0.002487675458
              std dev =       0.660498108343
             le_variance =       0.436257751124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281510479427e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+06, overlap shift 8.2718e+07 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745789982372       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745789982375       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745789982376       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745789982376       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745789982376       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745789982376       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745789982376       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745789982376       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745789982376       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745790003131       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+06 is 2.476809e-11

solving harmonic davidson linear method for identity shift 3.3087e+07, overlap shift 3.3087e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745789982372       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745789982373       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745789982373       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745789982373       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745789982373       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745790007953       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745789982373       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745789982373       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745789982373       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745789926686       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+07 is 6.192141e-12

solving harmonic davidson linear method for identity shift 1.3235e+08, overlap shift 1.3235e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745789982372       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745789982372       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745789982372       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745789982372       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745789982372       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745789982372       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745789560326       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745789982372       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745789881994       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745789982372       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+08 is 1.547938e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.402212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0452e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.8529
    reference variance = 0.329581
====================================================
  Execution time = 4.3061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4903e-01
  Total weights = 1.9643e+06
  Execution time = 5.8909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079530892
                                         uncertainty =       0.001947828586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079530892
                                         uncertainty =       0.001947828586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466939529
  error estimate for blocks of size 2^( 2) =       0.000492441809
  error estimate for blocks of size 2^( 3) =       0.000515970418
  error estimate for blocks of size 2^( 4) =       0.000533174502
  error estimate for blocks of size 2^( 5) =       0.000544817122
  error estimate for blocks of size 2^( 6) =       0.000551918164
  error estimate for blocks of size 2^( 7) =       0.000552797769

      target function =      -0.746148166481
              le_mean =     -22.815062451235
             les_mean =     520.976101541435
             stat err =       0.000545676889
             autocorr =       1.365682797281
   target nu stat err =       0.000545676889
   target dn stat err =       0.002459411482
      target stat err =       0.002120800980
              std dev =       0.660352215374
             le_variance =       0.436065048349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079530891
                                         uncertainty =       0.001947828586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079530891
                                         uncertainty =       0.001947828586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466939529
  error estimate for blocks of size 2^( 2) =       0.000492441809
  error estimate for blocks of size 2^( 3) =       0.000515970418
  error estimate for blocks of size 2^( 4) =       0.000533174502
  error estimate for blocks of size 2^( 5) =       0.000544817122
  error estimate for blocks of size 2^( 6) =       0.000551918164
  error estimate for blocks of size 2^( 7) =       0.000552797769

      target function =      -0.746148166467
              le_mean =     -22.815062451235
             les_mean =     520.976101541457
             stat err =       0.000545676889
             autocorr =       1.365682797315
   target nu stat err =       0.000545676889
   target dn stat err =       0.002459411483
      target stat err =       0.002120800981
              std dev =       0.660352215373
             le_variance =       0.436065048348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079530892
                                         uncertainty =       0.001947828586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079530892
                                         uncertainty =       0.001947828586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466939529
  error estimate for blocks of size 2^( 2) =       0.000492441809
  error estimate for blocks of size 2^( 3) =       0.000515970418
  error estimate for blocks of size 2^( 4) =       0.000533174502
  error estimate for blocks of size 2^( 5) =       0.000544817122
  error estimate for blocks of size 2^( 6) =       0.000551918164
  error estimate for blocks of size 2^( 7) =       0.000552797769

      target function =      -0.746148166474
              le_mean =     -22.815062451235
             les_mean =     520.976101541446
             stat err =       0.000545676889
             autocorr =       1.365682797299
   target nu stat err =       0.000545676889
   target dn stat err =       0.002459411482
      target stat err =       0.002120800981
              std dev =       0.660352215373
             le_variance =       0.436065048348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079530892
                                         uncertainty =       0.001947828586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436079530892
                                         uncertainty =       0.001947828586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466939529
  error estimate for blocks of size 2^( 2) =       0.000492441809
  error estimate for blocks of size 2^( 3) =       0.000515970418
  error estimate for blocks of size 2^( 4) =       0.000533174502
  error estimate for blocks of size 2^( 5) =       0.000544817122
  error estimate for blocks of size 2^( 6) =       0.000551918164
  error estimate for blocks of size 2^( 7) =       0.000552797769

      target function =      -0.746148166480
              le_mean =     -22.815062451235
             les_mean =     520.976101541437
             stat err =       0.000545676889
             autocorr =       1.365682797286
   target nu stat err =       0.000545676889
   target dn stat err =       0.002459411482
      target stat err =       0.002120800980
              std dev =       0.660352215374
             le_variance =       0.436065048349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746148166481        initial  <--
     8.2718e+06     8.2718e+07             2.4768e-11        -0.746148166467
     3.3087e+07     3.3087e+08             6.1921e-12        -0.746148166474
     1.3235e+08     1.3235e+09             1.5479e-12        -0.746148166480

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.6453
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2310e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.6584
    reference variance = 0.340648
====================================================
  Execution time = 4.2764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5581e-01
  Total weights = 1.964367197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438735213185
                                         uncertainty =       0.002516064893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438735213185
                                         uncertainty =       0.002516064893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468355753
  error estimate for blocks of size 2^( 2) =       0.000494178626
  error estimate for blocks of size 2^( 3) =       0.000518066719
  error estimate for blocks of size 2^( 4) =       0.000535731736
  error estimate for blocks of size 2^( 5) =       0.000547647072
  error estimate for blocks of size 2^( 6) =       0.000554259245
  error estimate for blocks of size 2^( 7) =       0.000558736258

      target function =      -0.740565222877
              le_mean =     -22.814771986604
             les_mean =     520.969631517669
             stat err =       0.000549093578
             autocorr =       1.374488183787
   target nu stat err =       0.000549093578
   target dn stat err =       0.005162473297
      target stat err =       0.004244841950
              std dev =       0.662355057353
             le_variance =       0.438714222001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281477198660e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+07, overlap shift 8.2718e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740588483816       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740588483816       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740588483816       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740588483816       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740588483816       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740588438991       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740588390679       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740588407359       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740588273675       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740588477812       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+07 is 2.833263e-12

solving harmonic davidson linear method for identity shift 3.3087e+08, overlap shift 3.3087e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740588483816       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740588483816       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740588483816       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740588483816       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740588483198       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740588506981       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740588850356       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740588068375       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740588154077       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740588393615       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+08 is 7.083128e-13

solving harmonic davidson linear method for identity shift 1.3235e+09, overlap shift 1.3235e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740588483816       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740588483816       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740588483816       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740588483816       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740588476260       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740588483816       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740586607437       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740586588818       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740590853486       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740588229635       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+09 is 1.770845e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0397e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.8288
    reference variance = 0.463454
====================================================
  Execution time = 4.2947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4538e-01
  Total weights = 1.9642e+06
  Execution time = 5.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432385888052
                                         uncertainty =       0.002093512577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432385888052
                                         uncertainty =       0.002093512577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465041175
  error estimate for blocks of size 2^( 2) =       0.000490170586
  error estimate for blocks of size 2^( 3) =       0.000513948617
  error estimate for blocks of size 2^( 4) =       0.000531581291
  error estimate for blocks of size 2^( 5) =       0.000542660077
  error estimate for blocks of size 2^( 6) =       0.000549703107
  error estimate for blocks of size 2^( 7) =       0.000556972314

      target function =      -0.749175127863
              le_mean =     -22.814975019798
             les_mean =     520.968463272888
             stat err =       0.000545229197
             autocorr =       1.374597008740
   target nu stat err =       0.000545229197
   target dn stat err =       0.002509800447
      target stat err =       0.002177214013
              std dev =       0.657667536829
             le_variance =       0.432526588999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432385888052
                                         uncertainty =       0.002093512577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432385888052
                                         uncertainty =       0.002093512577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465041175
  error estimate for blocks of size 2^( 2) =       0.000490170586
  error estimate for blocks of size 2^( 3) =       0.000513948617
  error estimate for blocks of size 2^( 4) =       0.000531581291
  error estimate for blocks of size 2^( 5) =       0.000542660077
  error estimate for blocks of size 2^( 6) =       0.000549703107
  error estimate for blocks of size 2^( 7) =       0.000556972314

      target function =      -0.749175127860
              le_mean =     -22.814975019798
             les_mean =     520.968463272892
             stat err =       0.000545229197
             autocorr =       1.374597008742
   target nu stat err =       0.000545229197
   target dn stat err =       0.002509800448
      target stat err =       0.002177214013
              std dev =       0.657667536829
             le_variance =       0.432526588999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432385888052
                                         uncertainty =       0.002093512577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432385888052
                                         uncertainty =       0.002093512577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465041175
  error estimate for blocks of size 2^( 2) =       0.000490170586
  error estimate for blocks of size 2^( 3) =       0.000513948617
  error estimate for blocks of size 2^( 4) =       0.000531581291
  error estimate for blocks of size 2^( 5) =       0.000542660077
  error estimate for blocks of size 2^( 6) =       0.000549703107
  error estimate for blocks of size 2^( 7) =       0.000556972314

      target function =      -0.749175127861
              le_mean =     -22.814975019798
             les_mean =     520.968463272890
             stat err =       0.000545229197
             autocorr =       1.374597008736
   target nu stat err =       0.000545229197
   target dn stat err =       0.002509800448
      target stat err =       0.002177214013
              std dev =       0.657667536829
             le_variance =       0.432526588999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432385888052
                                         uncertainty =       0.002093512577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432385888052
                                         uncertainty =       0.002093512577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465041175
  error estimate for blocks of size 2^( 2) =       0.000490170586
  error estimate for blocks of size 2^( 3) =       0.000513948617
  error estimate for blocks of size 2^( 4) =       0.000531581291
  error estimate for blocks of size 2^( 5) =       0.000542660077
  error estimate for blocks of size 2^( 6) =       0.000549703107
  error estimate for blocks of size 2^( 7) =       0.000556972314

      target function =      -0.749175127863
              le_mean =     -22.814975019798
             les_mean =     520.968463272888
             stat err =       0.000545229197
             autocorr =       1.374597008740
   target nu stat err =       0.000545229197
   target dn stat err =       0.002509800447
      target stat err =       0.002177214013
              std dev =       0.657667536829
             le_variance =       0.432526588999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749175127863        initial  <--
     8.2718e+07     8.2718e+08             2.8333e-12        -0.749175127860
     3.3087e+08     3.3087e+09             7.0831e-13        -0.749175127861
     1.3235e+09     1.3235e+10             1.7708e-13        -0.749175127863

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.5421
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2295e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.9602
    reference variance = 0.365317
====================================================
  Execution time = 4.2993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5376e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4737e-01
  Total weights = 1.964273973e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432764466507
                                         uncertainty =       0.001963642667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432764466507
                                         uncertainty =       0.001963642667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465186525
  error estimate for blocks of size 2^( 2) =       0.000490612710
  error estimate for blocks of size 2^( 3) =       0.000515067828
  error estimate for blocks of size 2^( 4) =       0.000533420001
  error estimate for blocks of size 2^( 5) =       0.000545836863
  error estimate for blocks of size 2^( 6) =       0.000551530127
  error estimate for blocks of size 2^( 7) =       0.000551967132

      target function =      -0.747496185347
              le_mean =     -22.813681720656
             les_mean =     520.911445271883
             stat err =       0.000545688531
             autocorr =       1.376053754743
   target nu stat err =       0.000545688531
   target dn stat err =       0.004168260270
      target stat err =       0.003503240533
              std dev =       0.657873092525
             le_variance =       0.432797005869


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281368172066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+08, overlap shift 8.2718e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747511591947       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747511591947       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747511591947       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747511591947       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747511591947       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747511591947       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747511591947       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747513145659       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747511591947       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+08 is 2.097493e-13

solving harmonic davidson linear method for identity shift 3.3087e+09, overlap shift 3.3087e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747511591947       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747511591947       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747511591947       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747511591947       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747511591947       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747511591947       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747511591947       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747511591947       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747511591947       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+09 is 5.239421e-14

solving harmonic davidson linear method for identity shift 1.3235e+10, overlap shift 1.3235e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747511591947       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747511591947       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747511591947       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747511591947       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747511591947       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747511591947       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747511591947       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747511591947       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747535920903       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747511591947       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747510946322       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747523590762       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747535835975       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747518704600       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747513972071       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747504382465       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747515206938       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747524033377       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747517353383       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+10 is 1.309736e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.484479 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0728e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6572
    reference variance = 0.643079
====================================================
  Execution time = 4.1586e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5373e-01
  Total weights = 1.9644e+06
  Execution time = 5.8860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441499095359
                                         uncertainty =       0.002531651973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441499095359
                                         uncertainty =       0.002531651973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469815891
  error estimate for blocks of size 2^( 2) =       0.000494789415
  error estimate for blocks of size 2^( 3) =       0.000518463959
  error estimate for blocks of size 2^( 4) =       0.000536704427
  error estimate for blocks of size 2^( 5) =       0.000546806009
  error estimate for blocks of size 2^( 6) =       0.000552619810
  error estimate for blocks of size 2^( 7) =       0.000553804317

      target function =      -0.742281027665
              le_mean =     -22.815202073284
             les_mean =     520.987172066079
             stat err =       0.000547483641
             autocorr =       1.357959724446
   target nu stat err =       0.000547483641
   target dn stat err =       0.003029397393
      target stat err =       0.002550994846
              std dev =       0.664420004306
             le_variance =       0.441453942122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441499095359
                                         uncertainty =       0.002531651973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441499095359
                                         uncertainty =       0.002531651973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469815891
  error estimate for blocks of size 2^( 2) =       0.000494789415
  error estimate for blocks of size 2^( 3) =       0.000518463959
  error estimate for blocks of size 2^( 4) =       0.000536704427
  error estimate for blocks of size 2^( 5) =       0.000546806009
  error estimate for blocks of size 2^( 6) =       0.000552619810
  error estimate for blocks of size 2^( 7) =       0.000553804317

      target function =      -0.742281027665
              le_mean =     -22.815202073284
             les_mean =     520.987172066079
             stat err =       0.000547483641
             autocorr =       1.357959724446
   target nu stat err =       0.000547483641
   target dn stat err =       0.003029397393
      target stat err =       0.002550994846
              std dev =       0.664420004306
             le_variance =       0.441453942122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441499095359
                                         uncertainty =       0.002531651973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441499095359
                                         uncertainty =       0.002531651973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469815891
  error estimate for blocks of size 2^( 2) =       0.000494789415
  error estimate for blocks of size 2^( 3) =       0.000518463959
  error estimate for blocks of size 2^( 4) =       0.000536704427
  error estimate for blocks of size 2^( 5) =       0.000546806009
  error estimate for blocks of size 2^( 6) =       0.000552619810
  error estimate for blocks of size 2^( 7) =       0.000553804317

      target function =      -0.742281027665
              le_mean =     -22.815202073284
             les_mean =     520.987172066079
             stat err =       0.000547483641
             autocorr =       1.357959724447
   target nu stat err =       0.000547483641
   target dn stat err =       0.003029397393
      target stat err =       0.002550994846
              std dev =       0.664420004306
             le_variance =       0.441453942122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441499095359
                                         uncertainty =       0.002531651973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441499095359
                                         uncertainty =       0.002531651973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469815891
  error estimate for blocks of size 2^( 2) =       0.000494789415
  error estimate for blocks of size 2^( 3) =       0.000518463959
  error estimate for blocks of size 2^( 4) =       0.000536704427
  error estimate for blocks of size 2^( 5) =       0.000546806009
  error estimate for blocks of size 2^( 6) =       0.000552619810
  error estimate for blocks of size 2^( 7) =       0.000553804317

      target function =      -0.742281027665
              le_mean =     -22.815202073284
             les_mean =     520.987172066079
             stat err =       0.000547483641
             autocorr =       1.357959724445
   target nu stat err =       0.000547483641
   target dn stat err =       0.003029397393
      target stat err =       0.002550994846
              std dev =       0.664420004306
             le_variance =       0.441453942122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742281027665        initial
     8.2718e+08     8.2718e+09             2.0975e-13        -0.742281027665  <--
     3.3087e+09     3.3087e+10             5.2394e-14        -0.742281027665
     1.3235e+10     1.3235e+11             1.3097e-14        -0.742281027665

*****************************************************************************
Applying the update for shift_i =   8.2718e+08     and shift_s =   8.2718e+09
*****************************************************************************

  Execution time = 7.3539e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2434e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8826
    reference variance = 0.369831
====================================================
  Execution time = 4.2805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4660e-01
  Total weights = 1.964185577e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989036460
                                         uncertainty =       0.002583176297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434989036460
                                         uncertainty =       0.002583176297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466372732
  error estimate for blocks of size 2^( 2) =       0.000491603004
  error estimate for blocks of size 2^( 3) =       0.000515440733
  error estimate for blocks of size 2^( 4) =       0.000533168762
  error estimate for blocks of size 2^( 5) =       0.000543791205
  error estimate for blocks of size 2^( 6) =       0.000549183247
  error estimate for blocks of size 2^( 7) =       0.000550569228

      target function =      -0.748141923413
              le_mean =     -22.813983356512
             les_mean =     520.924440340152
             stat err =       0.000544178110
             autocorr =       1.361494330287
   target nu stat err =       0.000544178110
   target dn stat err =       0.003238144495
      target stat err =       0.002753470891
              std dev =       0.659550642141
             le_variance =       0.435007049549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281398335651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+08, overlap shift 2.0680e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748151079185       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748151079185       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748151079185       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748151086581       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748151079185       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748151079185       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748151079185       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748151079185       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748151109779       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748150637470       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+08 is 9.654611e-13

solving harmonic davidson linear method for identity shift 8.2718e+08, overlap shift 8.2718e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748151079185       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748151079185       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748151079185       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748151079185       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748151079185       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748151079185       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748151079185       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748151079185       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748151079185       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748151257663       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+08 is 2.413064e-13

solving harmonic davidson linear method for identity shift 3.3087e+09, overlap shift 3.3087e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748151079185       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748151079185       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748151079185       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748151079185       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748151079185       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748151079185       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748151079185       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748152866160       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748151079185       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748151079185       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+09 is 6.028878e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.487945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0440e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8317
    reference variance = 0.307269
====================================================
  Execution time = 4.1343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.7388e-01
  Total weights = 1.9645e+06
  Execution time = 5.9567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443071313954
                                         uncertainty =       0.006964135163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443071313954
                                         uncertainty =       0.006964135163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470672519
  error estimate for blocks of size 2^( 2) =       0.000495904066
  error estimate for blocks of size 2^( 3) =       0.000518961844
  error estimate for blocks of size 2^( 4) =       0.000536213555
  error estimate for blocks of size 2^( 5) =       0.000548054260
  error estimate for blocks of size 2^( 6) =       0.000555779312
  error estimate for blocks of size 2^( 7) =       0.000557263651

      target function =      -0.725872549576
              le_mean =     -22.814407197381
             les_mean =     520.971055437920
             stat err =       0.000549327694
             autocorr =       1.362151159843
   target nu stat err =       0.000549327694
   target dn stat err =       0.019006076373
      target stat err =       0.014870777508
              std dev =       0.665631460070
             le_variance =       0.443065240635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443071313953
                                         uncertainty =       0.006964135163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443071313953
                                         uncertainty =       0.006964135163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470672519
  error estimate for blocks of size 2^( 2) =       0.000495904066
  error estimate for blocks of size 2^( 3) =       0.000518961844
  error estimate for blocks of size 2^( 4) =       0.000536213555
  error estimate for blocks of size 2^( 5) =       0.000548054260
  error estimate for blocks of size 2^( 6) =       0.000555779312
  error estimate for blocks of size 2^( 7) =       0.000557263651

      target function =      -0.725872549575
              le_mean =     -22.814407197381
             les_mean =     520.971055437922
             stat err =       0.000549327694
             autocorr =       1.362151159849
   target nu stat err =       0.000549327694
   target dn stat err =       0.019006076372
      target stat err =       0.014870777507
              std dev =       0.665631460070
             le_variance =       0.443065240635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443071313953
                                         uncertainty =       0.006964135163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443071313953
                                         uncertainty =       0.006964135163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470672519
  error estimate for blocks of size 2^( 2) =       0.000495904066
  error estimate for blocks of size 2^( 3) =       0.000518961844
  error estimate for blocks of size 2^( 4) =       0.000536213555
  error estimate for blocks of size 2^( 5) =       0.000548054260
  error estimate for blocks of size 2^( 6) =       0.000555779312
  error estimate for blocks of size 2^( 7) =       0.000557263651

      target function =      -0.725872549575
              le_mean =     -22.814407197381
             les_mean =     520.971055437921
             stat err =       0.000549327694
             autocorr =       1.362151159842
   target nu stat err =       0.000549327694
   target dn stat err =       0.019006076373
      target stat err =       0.014870777508
              std dev =       0.665631460070
             le_variance =       0.443065240635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443071313953
                                         uncertainty =       0.006964135163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443071313953
                                         uncertainty =       0.006964135163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470672519
  error estimate for blocks of size 2^( 2) =       0.000495904066
  error estimate for blocks of size 2^( 3) =       0.000518961844
  error estimate for blocks of size 2^( 4) =       0.000536213555
  error estimate for blocks of size 2^( 5) =       0.000548054260
  error estimate for blocks of size 2^( 6) =       0.000555779312
  error estimate for blocks of size 2^( 7) =       0.000557263651

      target function =      -0.725872549576
              le_mean =     -22.814407197381
             les_mean =     520.971055437920
             stat err =       0.000549327694
             autocorr =       1.362151159843
   target nu stat err =       0.000549327694
   target dn stat err =       0.019006076373
      target stat err =       0.014870777508
              std dev =       0.665631460070
             le_variance =       0.443065240635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.725872549576        initial  <--
     2.0680e+08     2.0680e+09             9.6546e-13        -0.725872549575
     8.2718e+08     8.2718e+09             2.4131e-13        -0.725872549575
     3.3087e+09     3.3087e+10             6.0289e-14        -0.725872549576

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.2433
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2177e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.7959
    reference variance = 0.341131
====================================================
  Execution time = 4.4553e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4550e-01
  Total weights = 1.963978579e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.5978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433282039821
                                         uncertainty =       0.001787668859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433282039821
                                         uncertainty =       0.001787668859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465462146
  error estimate for blocks of size 2^( 2) =       0.000490936421
  error estimate for blocks of size 2^( 3) =       0.000514696102
  error estimate for blocks of size 2^( 4) =       0.000532181516
  error estimate for blocks of size 2^( 5) =       0.000544060950
  error estimate for blocks of size 2^( 6) =       0.000550153925
  error estimate for blocks of size 2^( 7) =       0.000552040342

      target function =      -0.749071363637
              le_mean =     -22.814707845537
             les_mean =     520.956393079613
             stat err =       0.000544609183
             autocorr =       1.368992864072
   target nu stat err =       0.000544609183
   target dn stat err =       0.002554944660
      target stat err =       0.002211707943
              std dev =       0.658262880034
             le_variance =       0.433310019231


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281470784554e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+09, overlap shift 2.0680e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749076961577       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749076961577       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749076961577       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749076961577       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749076961577       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749076718716       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749076762630       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749080323855       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749077375717       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749075018605       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+09 is 6.880412e-14

solving harmonic davidson linear method for identity shift 8.2718e+09, overlap shift 8.2718e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749076961577       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749076961577       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749076961577       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749076153940       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749078980658       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749078749991       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749081439214       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749064478412       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749096068559       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749071050953       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749083590917       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+09 is 1.719456e-14

solving harmonic davidson linear method for identity shift 3.3087e+10, overlap shift 3.3087e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749076961577       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749076961577       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749076961577       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749084372131       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749076461318       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749076961577       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749084745161       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749024843539       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749078513350       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749155493443       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749065109986       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749128413664       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749123156647       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749105494174       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749042002039       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749083573362       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749081446536       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749077014563       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749045350363       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749038028437       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749088104523       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749096056442       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+10 is 4.304730e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.495906 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2169e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.7574
    reference variance = 0.541102
====================================================
  Execution time = 4.1537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5171e-01
  Total weights = 1.9642e+06
  Execution time = 5.9789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439538645228
                                         uncertainty =       0.004137598790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439538645228
                                         uncertainty =       0.004137598790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468833851
  error estimate for blocks of size 2^( 2) =       0.000493885529
  error estimate for blocks of size 2^( 3) =       0.000517272232
  error estimate for blocks of size 2^( 4) =       0.000535151289
  error estimate for blocks of size 2^( 5) =       0.000546748119
  error estimate for blocks of size 2^( 6) =       0.000553743110
  error estimate for blocks of size 2^( 7) =       0.000559699531

      target function =      -0.743920027719
              le_mean =     -22.814476098920
             les_mean =     520.952031296381
             stat err =       0.000548835512
             autocorr =       1.370397276844
   target nu stat err =       0.000548835512
   target dn stat err =       0.004611242271
      target stat err =       0.003833620224
              std dev =       0.663031190166
             le_variance =       0.439610359133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439538645228
                                         uncertainty =       0.004137598790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439538645228
                                         uncertainty =       0.004137598790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468833851
  error estimate for blocks of size 2^( 2) =       0.000493885529
  error estimate for blocks of size 2^( 3) =       0.000517272232
  error estimate for blocks of size 2^( 4) =       0.000535151289
  error estimate for blocks of size 2^( 5) =       0.000546748119
  error estimate for blocks of size 2^( 6) =       0.000553743110
  error estimate for blocks of size 2^( 7) =       0.000559699531

      target function =      -0.743920027719
              le_mean =     -22.814476098920
             les_mean =     520.952031296381
             stat err =       0.000548835512
             autocorr =       1.370397276850
   target nu stat err =       0.000548835512
   target dn stat err =       0.004611242271
      target stat err =       0.003833620224
              std dev =       0.663031190166
             le_variance =       0.439610359133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439538645228
                                         uncertainty =       0.004137598790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439538645228
                                         uncertainty =       0.004137598790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468833851
  error estimate for blocks of size 2^( 2) =       0.000493885529
  error estimate for blocks of size 2^( 3) =       0.000517272232
  error estimate for blocks of size 2^( 4) =       0.000535151289
  error estimate for blocks of size 2^( 5) =       0.000546748119
  error estimate for blocks of size 2^( 6) =       0.000553743110
  error estimate for blocks of size 2^( 7) =       0.000559699531

      target function =      -0.743920027719
              le_mean =     -22.814476098920
             les_mean =     520.952031296381
             stat err =       0.000548835512
             autocorr =       1.370397276851
   target nu stat err =       0.000548835512
   target dn stat err =       0.004611242271
      target stat err =       0.003833620224
              std dev =       0.663031190166
             le_variance =       0.439610359133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439538645229
                                         uncertainty =       0.004137598790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439538645229
                                         uncertainty =       0.004137598790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468833851
  error estimate for blocks of size 2^( 2) =       0.000493885529
  error estimate for blocks of size 2^( 3) =       0.000517272232
  error estimate for blocks of size 2^( 4) =       0.000535151289
  error estimate for blocks of size 2^( 5) =       0.000546748119
  error estimate for blocks of size 2^( 6) =       0.000553743110
  error estimate for blocks of size 2^( 7) =       0.000559699531

      target function =      -0.743920027719
              le_mean =     -22.814476098920
             les_mean =     520.952031296381
             stat err =       0.000548835512
             autocorr =       1.370397276850
   target nu stat err =       0.000548835512
   target dn stat err =       0.004611242271
      target stat err =       0.003833620224
              std dev =       0.663031190166
             le_variance =       0.439610359133


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743920027719        initial
     2.0680e+09     2.0680e+10             6.8804e-14        -0.743920027719  <--
     8.2718e+09     8.2718e+10             1.7195e-14        -0.743920027719
     3.3087e+10     3.3087e+11             4.3047e-15        -0.743920027719

*****************************************************************************
Applying the update for shift_i =   2.0680e+09     and shift_s =   2.0680e+10
*****************************************************************************

  Execution time = 7.1406e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2360e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8521
    reference variance = 0.277861
====================================================
  Execution time = 4.3973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4723e-01
  Total weights = 1.964358300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435838739245
                                         uncertainty =       0.001766576920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435838739245
                                         uncertainty =       0.001766576920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466765823
  error estimate for blocks of size 2^( 2) =       0.000492291777
  error estimate for blocks of size 2^( 3) =       0.000516045907
  error estimate for blocks of size 2^( 4) =       0.000533457354
  error estimate for blocks of size 2^( 5) =       0.000545178852
  error estimate for blocks of size 2^( 6) =       0.000551071454
  error estimate for blocks of size 2^( 7) =       0.000552526906

      target function =      -0.747632614016
              le_mean =     -22.814251457074
             les_mean =     520.937295829931
             stat err =       0.000545558642
             autocorr =       1.366107202463
   target nu stat err =       0.000545558642
   target dn stat err =       0.002421416129
      target stat err =       0.002096134598
              std dev =       0.660106556946
             le_variance =       0.435740666523


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281425145707e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+08, overlap shift 5.1699e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747637493820       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747637493820       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747637493820       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747637493820       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747637493820       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747637493820       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747637557217       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747637493820       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747637493820       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747637493820       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+08 is 2.850718e-13

solving harmonic davidson linear method for identity shift 2.0680e+09, overlap shift 2.0680e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747637493820       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747637493820       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747637493820       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747637981186       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747637910690       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747637493820       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747637493820       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747637493820       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747637493820       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747637493820       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+09 is 7.120029e-14

solving harmonic davidson linear method for identity shift 8.2718e+09, overlap shift 8.2718e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747637493820       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747637493820       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747637493820       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747637493820       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747639101073       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747637493820       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747637493820       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747637493820       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747635290892       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747637493820       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+09 is 1.779978e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.499400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2042e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8137
    reference variance = 0.34639
====================================================
  Execution time = 4.3019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4569e-01
  Total weights = 1.9643e+06
  Execution time = 5.9451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434365319474
                                         uncertainty =       0.001898345827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434365319474
                                         uncertainty =       0.001898345827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466055764
  error estimate for blocks of size 2^( 2) =       0.000492007229
  error estimate for blocks of size 2^( 3) =       0.000516315519
  error estimate for blocks of size 2^( 4) =       0.000535434793
  error estimate for blocks of size 2^( 5) =       0.000547335431
  error estimate for blocks of size 2^( 6) =       0.000553923768
  error estimate for blocks of size 2^( 7) =       0.000558607662

      target function =      -0.748906934134
              le_mean =     -22.814509754443
             les_mean =     520.947549614911
             stat err =       0.000548825414
             autocorr =       1.386732389898
   target nu stat err =       0.000548825414
   target dn stat err =       0.002513969635
      target stat err =       0.002178660663
              std dev =       0.659102382396
             le_variance =       0.434415950481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434365319474
                                         uncertainty =       0.001898345827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434365319474
                                         uncertainty =       0.001898345827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466055764
  error estimate for blocks of size 2^( 2) =       0.000492007229
  error estimate for blocks of size 2^( 3) =       0.000516315519
  error estimate for blocks of size 2^( 4) =       0.000535434793
  error estimate for blocks of size 2^( 5) =       0.000547335431
  error estimate for blocks of size 2^( 6) =       0.000553923768
  error estimate for blocks of size 2^( 7) =       0.000558607662

      target function =      -0.748906934134
              le_mean =     -22.814509754443
             les_mean =     520.947549614911
             stat err =       0.000548825414
             autocorr =       1.386732389899
   target nu stat err =       0.000548825414
   target dn stat err =       0.002513969635
      target stat err =       0.002178660663
              std dev =       0.659102382396
             le_variance =       0.434415950480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434365319474
                                         uncertainty =       0.001898345827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434365319474
                                         uncertainty =       0.001898345827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466055764
  error estimate for blocks of size 2^( 2) =       0.000492007229
  error estimate for blocks of size 2^( 3) =       0.000516315519
  error estimate for blocks of size 2^( 4) =       0.000535434793
  error estimate for blocks of size 2^( 5) =       0.000547335431
  error estimate for blocks of size 2^( 6) =       0.000553923768
  error estimate for blocks of size 2^( 7) =       0.000558607662

      target function =      -0.748906934134
              le_mean =     -22.814509754443
             les_mean =     520.947549614911
             stat err =       0.000548825414
             autocorr =       1.386732389901
   target nu stat err =       0.000548825414
   target dn stat err =       0.002513969635
      target stat err =       0.002178660663
              std dev =       0.659102382396
             le_variance =       0.434415950481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434365319474
                                         uncertainty =       0.001898345827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434365319474
                                         uncertainty =       0.001898345827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466055764
  error estimate for blocks of size 2^( 2) =       0.000492007229
  error estimate for blocks of size 2^( 3) =       0.000516315519
  error estimate for blocks of size 2^( 4) =       0.000535434793
  error estimate for blocks of size 2^( 5) =       0.000547335431
  error estimate for blocks of size 2^( 6) =       0.000553923768
  error estimate for blocks of size 2^( 7) =       0.000558607662

      target function =      -0.748906934134
              le_mean =     -22.814509754443
             les_mean =     520.947549614911
             stat err =       0.000548825414
             autocorr =       1.386732389904
   target nu stat err =       0.000548825414
   target dn stat err =       0.002513969635
      target stat err =       0.002178660663
              std dev =       0.659102382396
             le_variance =       0.434415950481


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748906934134        initial  <--
     5.1699e+08     5.1699e+09             2.8507e-13        -0.748906934134
     2.0680e+09     2.0680e+10             7.1200e-14        -0.748906934134
     8.2718e+09     8.2718e+10             1.7800e-14        -0.748906934134

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 73.2321
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2531e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.8149
    reference variance = 0.306029
====================================================
  Execution time = 4.3950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4648e-01
  Total weights = 1.964087283e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435405704120
                                         uncertainty =       0.002618853319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435405704120
                                         uncertainty =       0.002618853319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466554347
  error estimate for blocks of size 2^( 2) =       0.000492017153
  error estimate for blocks of size 2^( 3) =       0.000516016624
  error estimate for blocks of size 2^( 4) =       0.000533305531
  error estimate for blocks of size 2^( 5) =       0.000544317104
  error estimate for blocks of size 2^( 6) =       0.000551723095
  error estimate for blocks of size 2^( 7) =       0.000556562678

      target function =      -0.748255679877
              le_mean =     -22.814622760278
             les_mean =     520.953486905877
             stat err =       0.000546477102
             autocorr =       1.371953708199
   target nu stat err =       0.000546477102
   target dn stat err =       0.003127149088
      target stat err =       0.002667592932
              std dev =       0.659807485465
             le_variance =       0.435345917876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281462276028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+09, overlap shift 5.1699e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748264227662       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748264227662       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748264227662       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748264227662       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748264227662       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748264227662       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748264227662       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748266026203       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748264227662       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+09 is 3.628625e-14

solving harmonic davidson linear method for identity shift 2.0680e+10, overlap shift 2.0680e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748264227662       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748264227662       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748264227662       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748264182393       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748264227662       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748258043012       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748255864197       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748299023585       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748231614895       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748229254432       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748216090787       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748307524513       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748237802073       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748237340574       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748268508424       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748288305615       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748286929408       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748283037511       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748301511435       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748303088367       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748264709022       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748289013209       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748255807920       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748263223166       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748260067652       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748275554847       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748276421761       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748268432640       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748269815845       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748260952621       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748267919719       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748251279911       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748279118825       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748259793680       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748259071105       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+10 is 9.080174e-15

solving harmonic davidson linear method for identity shift 8.2718e+10, overlap shift 8.2718e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748264227662       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748264227662       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748264227662       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748264227662       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748264227662       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748264227662       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748264227662       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748222564597       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748377341236       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748309259058       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748266535610       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748179341555       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748113798944       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748305010580       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748062531169       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748248905941       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748462633856       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748322639465       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748286040221       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748231338738       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748282703559       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748212596096       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748291750874       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748501235101       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748142141672       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748228736572       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748511124654       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748183865925       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748439691101       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748111446470       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748206114072       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748328078314       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748234849974       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748207011505       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748229836683       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748260301123       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748209143829       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748130272723       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748450188422       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748145595105       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748154413482       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748116233110       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748408030354       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748318084804       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748159844823       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748238863210       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748340939924       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748103462864       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748258887556       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748318614453       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748275784641       residual = 1.60e-06           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.748271192675       residual = 1.99e-06           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748287150066       residual = 8.64e-07           smallest_sin_value = 9.98e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+10 is 2.276611e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.580777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1837e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.8387
    reference variance = 0.375944
====================================================
  Execution time = 4.4060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4953e-01
  Total weights = 1.9642e+06
  Execution time = 5.9382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435576714495
                                         uncertainty =       0.002198663309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435576714495
                                         uncertainty =       0.002198663309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466623514
  error estimate for blocks of size 2^( 2) =       0.000492150507
  error estimate for blocks of size 2^( 3) =       0.000515976669
  error estimate for blocks of size 2^( 4) =       0.000533168965
  error estimate for blocks of size 2^( 5) =       0.000545744306
  error estimate for blocks of size 2^( 6) =       0.000551362024
  error estimate for blocks of size 2^( 7) =       0.000552109518

      target function =      -0.745730074186
              le_mean =     -22.814776417146
             les_mean =     520.963550825098
             stat err =       0.000545596203
             autocorr =       1.367128818352
   target nu stat err =       0.000545596203
   target dn stat err =       0.003015045568
      target stat err =       0.002560462355
              std dev =       0.659905302717
             le_variance =       0.435475008554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435576714495
                                         uncertainty =       0.002198663309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435576714495
                                         uncertainty =       0.002198663309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466623514
  error estimate for blocks of size 2^( 2) =       0.000492150507
  error estimate for blocks of size 2^( 3) =       0.000515976669
  error estimate for blocks of size 2^( 4) =       0.000533168965
  error estimate for blocks of size 2^( 5) =       0.000545744306
  error estimate for blocks of size 2^( 6) =       0.000551362024
  error estimate for blocks of size 2^( 7) =       0.000552109518

      target function =      -0.745730074186
              le_mean =     -22.814776417146
             les_mean =     520.963550825098
             stat err =       0.000545596203
             autocorr =       1.367128818347
   target nu stat err =       0.000545596203
   target dn stat err =       0.003015045568
      target stat err =       0.002560462355
              std dev =       0.659905302716
             le_variance =       0.435475008553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435576714495
                                         uncertainty =       0.002198663309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435576714495
                                         uncertainty =       0.002198663309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466623514
  error estimate for blocks of size 2^( 2) =       0.000492150507
  error estimate for blocks of size 2^( 3) =       0.000515976669
  error estimate for blocks of size 2^( 4) =       0.000533168965
  error estimate for blocks of size 2^( 5) =       0.000545744306
  error estimate for blocks of size 2^( 6) =       0.000551362024
  error estimate for blocks of size 2^( 7) =       0.000552109518

      target function =      -0.745730074186
              le_mean =     -22.814776417146
             les_mean =     520.963550825098
             stat err =       0.000545596203
             autocorr =       1.367128818350
   target nu stat err =       0.000545596203
   target dn stat err =       0.003015045568
      target stat err =       0.002560462355
              std dev =       0.659905302716
             le_variance =       0.435475008553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435576714495
                                         uncertainty =       0.002198663309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435576714495
                                         uncertainty =       0.002198663309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466623514
  error estimate for blocks of size 2^( 2) =       0.000492150507
  error estimate for blocks of size 2^( 3) =       0.000515976669
  error estimate for blocks of size 2^( 4) =       0.000533168965
  error estimate for blocks of size 2^( 5) =       0.000545744306
  error estimate for blocks of size 2^( 6) =       0.000551362024
  error estimate for blocks of size 2^( 7) =       0.000552109518

      target function =      -0.745730074186
              le_mean =     -22.814776417146
             les_mean =     520.963550825098
             stat err =       0.000545596203
             autocorr =       1.367128818348
   target nu stat err =       0.000545596203
   target dn stat err =       0.003015045568
      target stat err =       0.002560462355
              std dev =       0.659905302717
             le_variance =       0.435475008554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745730074186        initial  <--
     5.1699e+09     5.1699e+10             3.6286e-14        -0.745730074186
     2.0680e+10     2.0680e+11             9.0802e-15        -0.745730074186
     8.2718e+10     8.2718e+11             2.2766e-15        -0.745730074186

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 74.0865
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2601e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.7332
    reference variance = 0.365317
====================================================
  Execution time = 4.3993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4631e-01
  Total weights = 1.964366200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432596964809
                                         uncertainty =       0.002151914706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432596964809
                                         uncertainty =       0.002151914706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465113598
  error estimate for blocks of size 2^( 2) =       0.000490730947
  error estimate for blocks of size 2^( 3) =       0.000514960296
  error estimate for blocks of size 2^( 4) =       0.000532035382
  error estimate for blocks of size 2^( 5) =       0.000543888014
  error estimate for blocks of size 2^( 6) =       0.000550753450
  error estimate for blocks of size 2^( 7) =       0.000556155400

      target function =      -0.748389915642
              le_mean =     -22.814694915021
             les_mean =     520.956617217095
             stat err =       0.000545708061
             autocorr =       1.376583833632
   target nu stat err =       0.000545708061
   target dn stat err =       0.003326427925
      target stat err =       0.002830160371
              std dev =       0.657769958714
             le_variance =       0.432661318587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281469491502e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+10, overlap shift 5.1699e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748399579666       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748399579666       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748399579666       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748390456462       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748458732934       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748399595866       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748450278154       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748427098254       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748414984487       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748468480552       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748447779578       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748372347580       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748509090925       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748393424893       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748426787203       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748309598500       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748277225651       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748333652207       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748380363091       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748360519936       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748316002021       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748408491599       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748384478428       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748369347350       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748406418590       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748358691519       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748489528984       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748396373863       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748383666750       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748401976527       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748372677494       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748313905454       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748376421846       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748342356065       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748382656569       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748386445430       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748339123457       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748381054900       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748282172319       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748364884426       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748412630609       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748481499858       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748389499744       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748412705493       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748372927664       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748428036088       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748354670381       residual = 1.42e-06           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748375093617       residual = 1.36e-06           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748389083820       residual = 1.62e-06           smallest_sin_value = 9.98e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+10 is 2.995498e-15

solving harmonic davidson linear method for identity shift 2.0680e+11, overlap shift 2.0680e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748399579666       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748399579666       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748399579666       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748399579666       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748398937208       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748393474203       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748399586431       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748452158398       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748715931696       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748674775109       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748322449695       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748726657467       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748670631579       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748820335453       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748268434010       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747945994921       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748517794387       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748529547057       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748410772089       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748121367262       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747928760344       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748105069210       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748280167402       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748945360922       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748507517174       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748771513347       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748124940822       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748579579835       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748463747453       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748254629139       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748212104603       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748332775235       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747958161806       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748042239633       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748007419933       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748319902336       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748574222769       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748652704428       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748134436465       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748084912399       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748228866648       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748613101116       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748381413956       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748428620266       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748662492600       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748413092632       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748276170045       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748418982217       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748508844344       residual = 4.95e-06           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748462015579       residual = 3.07e-06           smallest_sin_value = 9.98e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748880160240       residual = 8.19e-06           smallest_sin_value = 9.93e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+11 is 7.166595e-16

solving harmonic davidson linear method for identity shift 8.2718e+11, overlap shift 8.2718e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748399579666       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748399579666       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748399579666       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748142886636       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748399579639       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748399579666       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748019222111       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748268810854       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748790554725       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747354035037       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750068828386       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749507196651       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747136614140       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748948462586       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747365157932       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749574532768       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749239486980       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748464627733       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748161162677       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749437542305       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747315553805       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746967078487       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748188720476       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747754512633       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748513165542       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748777386431       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748924221182       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747793456783       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749215379279       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747974415026       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747658371746       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748589715101       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747870219172       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748251368081       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747951766013       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747933022989       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748069423963       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748341587944       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748284031176       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747836592870       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748037938444       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748370475747       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748114510680       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748223760698       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.749035520758       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747871993049       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748928853368       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748272555694       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748042096760       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748327443601       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748820689895       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.748787570776       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748579793933       residual = 1.61e-04           smallest_sin_value = 9.98e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+11 is 1.754366e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.736439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2031e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.9955
    reference variance = 0.709731
====================================================
  Execution time = 4.2633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4965e-01
  Total weights = 1.9642e+06
  Execution time = 6.1250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308694682
                                         uncertainty =       0.002480966389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308694682
                                         uncertainty =       0.002480966389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467063888
  error estimate for blocks of size 2^( 2) =       0.000492475022
  error estimate for blocks of size 2^( 3) =       0.000515900714
  error estimate for blocks of size 2^( 4) =       0.000533718835
  error estimate for blocks of size 2^( 5) =       0.000544478463
  error estimate for blocks of size 2^( 6) =       0.000550774824
  error estimate for blocks of size 2^( 7) =       0.000554111423

      target function =      -0.745621616022
              le_mean =     -22.814363232530
             les_mean =     520.944821890798
             stat err =       0.000545770886
             autocorr =       1.365425940431
   target nu stat err =       0.000545770886
   target dn stat err =       0.003600668091
      target stat err =       0.003029606940
              std dev =       0.660528084813
             le_variance =       0.436297350826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308694682
                                         uncertainty =       0.002480966389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308694682
                                         uncertainty =       0.002480966389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467063888
  error estimate for blocks of size 2^( 2) =       0.000492475022
  error estimate for blocks of size 2^( 3) =       0.000515900714
  error estimate for blocks of size 2^( 4) =       0.000533718835
  error estimate for blocks of size 2^( 5) =       0.000544478463
  error estimate for blocks of size 2^( 6) =       0.000550774824
  error estimate for blocks of size 2^( 7) =       0.000554111423

      target function =      -0.745621616022
              le_mean =     -22.814363232530
             les_mean =     520.944821890798
             stat err =       0.000545770886
             autocorr =       1.365425940430
   target nu stat err =       0.000545770886
   target dn stat err =       0.003600668091
      target stat err =       0.003029606940
              std dev =       0.660528084813
             le_variance =       0.436297350826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308694682
                                         uncertainty =       0.002480966389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308694682
                                         uncertainty =       0.002480966389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467063888
  error estimate for blocks of size 2^( 2) =       0.000492475022
  error estimate for blocks of size 2^( 3) =       0.000515900714
  error estimate for blocks of size 2^( 4) =       0.000533718835
  error estimate for blocks of size 2^( 5) =       0.000544478463
  error estimate for blocks of size 2^( 6) =       0.000550774824
  error estimate for blocks of size 2^( 7) =       0.000554111423

      target function =      -0.745621616022
              le_mean =     -22.814363232530
             les_mean =     520.944821890798
             stat err =       0.000545770886
             autocorr =       1.365425940431
   target nu stat err =       0.000545770886
   target dn stat err =       0.003600668091
      target stat err =       0.003029606940
              std dev =       0.660528084813
             le_variance =       0.436297350826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308694682
                                         uncertainty =       0.002480966389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436308694682
                                         uncertainty =       0.002480966389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467063888
  error estimate for blocks of size 2^( 2) =       0.000492475022
  error estimate for blocks of size 2^( 3) =       0.000515900714
  error estimate for blocks of size 2^( 4) =       0.000533718835
  error estimate for blocks of size 2^( 5) =       0.000544478463
  error estimate for blocks of size 2^( 6) =       0.000550774824
  error estimate for blocks of size 2^( 7) =       0.000554111423

      target function =      -0.745621616022
              le_mean =     -22.814363232530
             les_mean =     520.944821890798
             stat err =       0.000545770886
             autocorr =       1.365425940437
   target nu stat err =       0.000545770886
   target dn stat err =       0.003600668091
      target stat err =       0.003029606940
              std dev =       0.660528084813
             le_variance =       0.436297350826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745621616022        initial
     5.1699e+10     5.1699e+11             2.9955e-15        -0.745621616022
     2.0680e+11     2.0680e+12             7.1666e-16        -0.745621616022  <--
     8.2718e+11     8.2718e+12             1.7544e-16        -0.745621616022

*****************************************************************************
Applying the update for shift_i =   2.0680e+11     and shift_s =   2.0680e+12
*****************************************************************************

  Execution time = 7.3148e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2523e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.8456
    reference variance = 0.303606
====================================================
  Execution time = 4.3964e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4845e-01
  Total weights = 1.964220073e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434732090621
                                         uncertainty =       0.002526250759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434732090621
                                         uncertainty =       0.002526250759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466185932
  error estimate for blocks of size 2^( 2) =       0.000491809534
  error estimate for blocks of size 2^( 3) =       0.000515576776
  error estimate for blocks of size 2^( 4) =       0.000532845202
  error estimate for blocks of size 2^( 5) =       0.000543668478
  error estimate for blocks of size 2^( 6) =       0.000549462953
  error estimate for blocks of size 2^( 7) =       0.000549435811

      target function =      -0.746622846694
              le_mean =     -22.814641056620
             les_mean =     520.956292055847
             stat err =       0.000543853111
             autocorr =       1.360958574260
   target nu stat err =       0.000543853111
   target dn stat err =       0.003114544366
      target stat err =       0.002645522215
              std dev =       0.659286468249
             le_variance =       0.434658647216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281464105662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+10, overlap shift 5.1699e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746631201869       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746631201869       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746631201869       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746620372545       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746626293410       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746623371251       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746630621614       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746700526080       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746564417004       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746622938000       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746477913873       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746528363578       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746693338127       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746624631941       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746749393171       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746674921034       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746579036685       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746609281205       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746713331841       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746708130927       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746571022252       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746619017449       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746672782341       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746727108010       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746591749170       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746729402692       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746690643792       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746660793583       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746765184769       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746732572624       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746551627030       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746498672494       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746593674710       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746693651960       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746632522072       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746602003497       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746611681927       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746665054751       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746689056346       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746670950612       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746661665388       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746561796798       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746595807892       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746630765326       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746595171283       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746685829865       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746643918089       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746616479225       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746618243033       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746594900911       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746677818517       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746653740015       residual = 1.64e-07           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746657470835       residual = 8.85e-08           smallest_sin_value = 9.98e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.746552276988       residual = 6.54e-07           smallest_sin_value = 9.95e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.746525555991       residual = 1.61e-07           smallest_sin_value = 9.90e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+10 is 2.727376e-15

solving harmonic davidson linear method for identity shift 2.0680e+11, overlap shift 2.0680e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746631201869       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746631201869       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746631201869       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746631201869       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746631201860       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746602081458       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746804354376       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746785797965       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746171576379       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746674075079       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746663303558       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746655669914       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746595588769       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746549245997       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746594099870       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746579126989       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746635037382       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746631730111       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746586347490       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746605679785       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746569844045       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746672733263       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746665315839       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746636322962       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746679630200       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746650203147       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746596460879       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746669074498       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746590289597       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746627086034       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746684136320       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746626988863       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746584611473       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746656489314       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746559567294       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746594040699       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746626864847       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746565705156       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746533176588       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746627840674       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746672470064       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746646978329       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746608846491       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746715693474       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746652582802       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746597157830       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746648414885       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746664841665       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746700425154       residual = 1.08e-05           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746528995468       residual = 1.26e-05           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746662444486       residual = 4.94e-06           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746580047168       residual = 5.75e-06           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746614310774       residual = 6.20e-06           smallest_sin_value = 9.97e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.746614425289       residual = 1.25e-05           smallest_sin_value = 9.95e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.65e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+11 is 6.832846e-16

solving harmonic davidson linear method for identity shift 8.2718e+11, overlap shift 8.2718e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746631201869       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746631201869       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746631201869       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747194978668       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747445997902       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746818273442       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745545405296       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745869253737       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746901397407       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748961149092       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747092424811       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747503002359       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744190526023       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748158353002       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746436002845       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746279650426       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746692199732       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746433499708       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746630985316       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746782378759       residual = 7.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746630380069       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746705918935       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746768286282       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746809419767       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746994133427       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745930362113       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747507989589       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746393009352       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747295747298       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746322796826       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747145892373       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746826235535       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746477324557       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746358210738       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746507366736       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747087526425       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747750625557       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745889773676       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746451661838       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746557809975       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746603337749       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747093516784       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747123245513       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746768196105       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748215869369       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744851063520       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747856089196       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746282995371       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747391069565       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746132125945       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746301263723       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747381515447       residual = 9.76e-05           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747729214442       residual = 8.83e-05           smallest_sin_value = 9.91e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+11 is 1.706265e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.926550 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2033e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.9888
    reference variance = 0.460664
====================================================
  Execution time = 4.2833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4299e-01
  Total weights = 1.9641e+06
  Execution time = 6.0980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374010948
                                         uncertainty =       0.001865202800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374010948
                                         uncertainty =       0.001865202800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464933028
  error estimate for blocks of size 2^( 2) =       0.000490077579
  error estimate for blocks of size 2^( 3) =       0.000513987966
  error estimate for blocks of size 2^( 4) =       0.000530293484
  error estimate for blocks of size 2^( 5) =       0.000541193897
  error estimate for blocks of size 2^( 6) =       0.000547722906
  error estimate for blocks of size 2^( 7) =       0.000551217987

      target function =      -0.751173891917
              le_mean =     -22.815475793130
             les_mean =     520.988929966973
             stat err =       0.000542607068
             autocorr =       1.362040736934
   target nu stat err =       0.000542607068
   target dn stat err =       0.002305599359
      target stat err =       0.002025271832
              std dev =       0.657514593371
             le_variance =       0.432325440496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374010948
                                         uncertainty =       0.001865202800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374010948
                                         uncertainty =       0.001865202800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464933028
  error estimate for blocks of size 2^( 2) =       0.000490077579
  error estimate for blocks of size 2^( 3) =       0.000513987966
  error estimate for blocks of size 2^( 4) =       0.000530293484
  error estimate for blocks of size 2^( 5) =       0.000541193897
  error estimate for blocks of size 2^( 6) =       0.000547722906
  error estimate for blocks of size 2^( 7) =       0.000551217987

      target function =      -0.751173891917
              le_mean =     -22.815475793130
             les_mean =     520.988929966973
             stat err =       0.000542607068
             autocorr =       1.362040736934
   target nu stat err =       0.000542607068
   target dn stat err =       0.002305599359
      target stat err =       0.002025271832
              std dev =       0.657514593371
             le_variance =       0.432325440496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374010948
                                         uncertainty =       0.001865202800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374010948
                                         uncertainty =       0.001865202800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464933028
  error estimate for blocks of size 2^( 2) =       0.000490077579
  error estimate for blocks of size 2^( 3) =       0.000513987966
  error estimate for blocks of size 2^( 4) =       0.000530293484
  error estimate for blocks of size 2^( 5) =       0.000541193897
  error estimate for blocks of size 2^( 6) =       0.000547722906
  error estimate for blocks of size 2^( 7) =       0.000551217987

      target function =      -0.751173891917
              le_mean =     -22.815475793130
             les_mean =     520.988929966973
             stat err =       0.000542607068
             autocorr =       1.362040736934
   target nu stat err =       0.000542607068
   target dn stat err =       0.002305599359
      target stat err =       0.002025271832
              std dev =       0.657514593371
             le_variance =       0.432325440496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374010948
                                         uncertainty =       0.001865202800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432374010948
                                         uncertainty =       0.001865202800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464933028
  error estimate for blocks of size 2^( 2) =       0.000490077579
  error estimate for blocks of size 2^( 3) =       0.000513987966
  error estimate for blocks of size 2^( 4) =       0.000530293484
  error estimate for blocks of size 2^( 5) =       0.000541193897
  error estimate for blocks of size 2^( 6) =       0.000547722906
  error estimate for blocks of size 2^( 7) =       0.000551217987

      target function =      -0.751173891917
              le_mean =     -22.815475793130
             les_mean =     520.988929966973
             stat err =       0.000542607068
             autocorr =       1.362040736940
   target nu stat err =       0.000542607068
   target dn stat err =       0.002305599359
      target stat err =       0.002025271832
              std dev =       0.657514593371
             le_variance =       0.432325440496


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751173891917        initial
     5.1699e+10     5.1699e+11             2.7274e-15        -0.751173891917  <--
     2.0680e+11     2.0680e+12             6.8328e-16        -0.751173891917
     8.2718e+11     8.2718e+12             1.7063e-16        -0.751173891917

*****************************************************************************
Applying the update for shift_i =   5.1699e+10     and shift_s =   5.1699e+11
*****************************************************************************

  Execution time = 7.7051e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2909e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.9955
    reference variance = 0.534482
====================================================
  Execution time = 4.3959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5309e-01
  Total weights = 1.964319990e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432536943074
                                         uncertainty =       0.001808000176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432536943074
                                         uncertainty =       0.001808000176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465079460
  error estimate for blocks of size 2^( 2) =       0.000490203385
  error estimate for blocks of size 2^( 3) =       0.000514185050
  error estimate for blocks of size 2^( 4) =       0.000532157582
  error estimate for blocks of size 2^( 5) =       0.000542720265
  error estimate for blocks of size 2^( 6) =       0.000550416862
  error estimate for blocks of size 2^( 7) =       0.000552800323

      target function =      -0.742742237955
              le_mean =     -22.815000680069
             les_mean =     520.977341939557
             stat err =       0.000544523758
             autocorr =       1.370816573896
   target nu stat err =       0.000544523758
   target dn stat err =       0.008891290403
      target stat err =       0.007306863900
              std dev =       0.657721680188
             le_variance =       0.432597808590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281500068007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+10, overlap shift 1.2925e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742813167384       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742813167384       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742813167384       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742813033884       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742814091089       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742808182793       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742801609822       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742818137735       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742818098198       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742806913208       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742836720876       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742791185587       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742772488826       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742813910019       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742786800366       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742822115184       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742779274987       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742819485382       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742815857575       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742841222531       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742823994952       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742806504341       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+10 is 2.047285e-14

solving harmonic davidson linear method for identity shift 5.1699e+10, overlap shift 5.1699e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742813167384       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742813167384       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742813167384       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742813167384       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742795307321       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742813167384       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742869178735       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742845136517       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742920020403       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742890536202       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742749981565       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742824819071       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742852433511       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742843530874       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742715808099       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742869326919       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742960006227       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742858587490       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742796266673       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742805721191       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742765758975       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742760318060       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742739259232       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742809657073       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742803369252       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742899065166       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742758282030       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742831330093       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742727285151       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742824115378       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742888636092       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742801754766       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742805103894       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742774333875       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.742765254587       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742798785555       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742782954709       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742804619522       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742774109157       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742796024385       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742845003628       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742803678142       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.742812449938       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742831453111       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742809357370       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.742806985668       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742762588145       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742828522052       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.742809892113       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742802741474       residual = 7.07e-08           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742816090070       residual = 1.56e-07           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.742819946612       residual = 1.39e-07           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.742797208142       residual = 3.13e-07           smallest_sin_value = 9.92e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+10 is 5.123665e-15

solving harmonic davidson linear method for identity shift 2.0680e+11, overlap shift 2.0680e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742813167384       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742813167384       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742813167384       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742797613239       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742813167388       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743019980126       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743243493594       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743203686933       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742760843213       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743377278330       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742424294113       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742758220082       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742859085890       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742882199059       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742755634016       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742849833918       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742849830844       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742793231674       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742743830998       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742767942948       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742746035824       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742811244368       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742738001482       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742724231678       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742812374282       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742774497154       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742826964517       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742823486309       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742846566467       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742838040365       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742818257084       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742812217202       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742805167795       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742778224628       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.742893974014       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742774253335       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742793673055       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742747039227       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742828419869       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742815038966       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742869192885       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742849981806       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.742766501490       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742756345426       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742781288589       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.742896270496       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742836718248       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742751950054       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.742556156125       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742733456127       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742873293346       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.742435176166       residual = 9.65e-06           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.742703928138       residual = 3.51e-06           smallest_sin_value = 9.93e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+11 is 1.278132e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.048968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1935e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.8997
    reference variance = 0.718454
====================================================
  Execution time = 4.2774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4691e-01
  Total weights = 1.9640e+06
  Execution time = 6.0607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435960357909
                                         uncertainty =       0.002104296451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435960357909
                                         uncertainty =       0.002104296451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466866161
  error estimate for blocks of size 2^( 2) =       0.000492501275
  error estimate for blocks of size 2^( 3) =       0.000516385801
  error estimate for blocks of size 2^( 4) =       0.000533984529
  error estimate for blocks of size 2^( 5) =       0.000545716582
  error estimate for blocks of size 2^( 6) =       0.000553160545
  error estimate for blocks of size 2^( 7) =       0.000558946841

      target function =      -0.747903380877
              le_mean =     -22.815200293634
             les_mean =     520.980273923489
             stat err =       0.000547952124
             autocorr =       1.377528004231
   target nu stat err =       0.000547952124
   target dn stat err =       0.002495556303
      target stat err =       0.002160331210
              std dev =       0.660248456392
             le_variance =       0.435928024168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435960357909
                                         uncertainty =       0.002104296451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435960357909
                                         uncertainty =       0.002104296451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466866161
  error estimate for blocks of size 2^( 2) =       0.000492501275
  error estimate for blocks of size 2^( 3) =       0.000516385801
  error estimate for blocks of size 2^( 4) =       0.000533984529
  error estimate for blocks of size 2^( 5) =       0.000545716582
  error estimate for blocks of size 2^( 6) =       0.000553160545
  error estimate for blocks of size 2^( 7) =       0.000558946841

      target function =      -0.747903380877
              le_mean =     -22.815200293634
             les_mean =     520.980273923490
             stat err =       0.000547952124
             autocorr =       1.377528004235
   target nu stat err =       0.000547952124
   target dn stat err =       0.002495556303
      target stat err =       0.002160331210
              std dev =       0.660248456392
             le_variance =       0.435928024168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435960357909
                                         uncertainty =       0.002104296451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435960357909
                                         uncertainty =       0.002104296451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466866161
  error estimate for blocks of size 2^( 2) =       0.000492501275
  error estimate for blocks of size 2^( 3) =       0.000516385801
  error estimate for blocks of size 2^( 4) =       0.000533984529
  error estimate for blocks of size 2^( 5) =       0.000545716582
  error estimate for blocks of size 2^( 6) =       0.000553160545
  error estimate for blocks of size 2^( 7) =       0.000558946841

      target function =      -0.747903380877
              le_mean =     -22.815200293634
             les_mean =     520.980273923490
             stat err =       0.000547952124
             autocorr =       1.377528004240
   target nu stat err =       0.000547952124
   target dn stat err =       0.002495556303
      target stat err =       0.002160331210
              std dev =       0.660248456392
             le_variance =       0.435928024168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435960357909
                                         uncertainty =       0.002104296451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435960357909
                                         uncertainty =       0.002104296451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466866161
  error estimate for blocks of size 2^( 2) =       0.000492501275
  error estimate for blocks of size 2^( 3) =       0.000516385801
  error estimate for blocks of size 2^( 4) =       0.000533984529
  error estimate for blocks of size 2^( 5) =       0.000545716582
  error estimate for blocks of size 2^( 6) =       0.000553160545
  error estimate for blocks of size 2^( 7) =       0.000558946841

      target function =      -0.747903380877
              le_mean =     -22.815200293634
             les_mean =     520.980273923489
             stat err =       0.000547952124
             autocorr =       1.377528004233
   target nu stat err =       0.000547952124
   target dn stat err =       0.002495556303
      target stat err =       0.002160331210
              std dev =       0.660248456392
             le_variance =       0.435928024168


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747903380877        initial
     1.2925e+10     1.2925e+11             2.0473e-14        -0.747903380877  <--
     5.1699e+10     5.1699e+11             5.1237e-15        -0.747903380877
     2.0680e+11     2.0680e+12             1.2781e-15        -0.747903380877

*****************************************************************************
Applying the update for shift_i =   1.2925e+10     and shift_s =   1.2925e+11
*****************************************************************************

  Execution time = 7.3032e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2503e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.749
    reference variance = 0.481006
====================================================
  Execution time = 4.5254e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4627e-01
  Total weights = 1.964208842e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435015695161
                                         uncertainty =       0.002035961809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435015695161
                                         uncertainty =       0.002035961809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466372642
  error estimate for blocks of size 2^( 2) =       0.000491688397
  error estimate for blocks of size 2^( 3) =       0.000515625932
  error estimate for blocks of size 2^( 4) =       0.000533668454
  error estimate for blocks of size 2^( 5) =       0.000543297429
  error estimate for blocks of size 2^( 6) =       0.000551059829
  error estimate for blocks of size 2^( 7) =       0.000554359372

      target function =      -0.748439977699
              le_mean =     -22.815292303765
             les_mean =     520.983828477627
             stat err =       0.000545596271
             autocorr =       1.368600374735
   target nu stat err =       0.000545596271
   target dn stat err =       0.002374425031
      target stat err =       0.002066331554
              std dev =       0.659550515218
             le_variance =       0.435006882125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281529230376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+09, overlap shift 3.2312e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748444674231       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748444674231       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748444674231       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748444674231       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748444450155       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748447438142       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748444924706       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748444674231       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748451571404       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748439586876       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+09 is 6.392459e-14

solving harmonic davidson linear method for identity shift 1.2925e+10, overlap shift 1.2925e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748444674231       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748444674231       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748444674231       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748444674231       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748444734544       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748445110193       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748458409799       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748445037227       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748455298183       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748420621178       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748470322639       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748437218670       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748460680695       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748444925479       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748433402977       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748432533182       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748433443165       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748447630549       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+10 is 1.610651e-14

solving harmonic davidson linear method for identity shift 5.1699e+10, overlap shift 5.1699e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748444674231       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748444674231       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748444674231       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748444674230       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748444637413       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748459521141       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748463053391       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748355327628       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748470244562       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748409859858       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748421193711       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748472364075       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748546940191       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748436268256       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748425732666       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748453385466       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748432181054       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748461574978       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748438850608       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748452244155       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748449383265       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748441407463       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748464986770       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748449725674       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748452290009       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748441617635       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748415134848       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748439001188       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748432629922       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748423342365       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748460240238       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748437067378       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748401631751       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748451314263       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748432309433       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748456217508       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748455260130       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748444794562       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748437919061       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748427341077       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748449751849       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748448285178       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748441201338       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748428336416       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748500868653       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748447148717       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748454312840       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748441757041       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748449286577       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748400822488       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748431464962       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.748463474204       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748460432921       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.748462478592       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.748450149211       residual = 5.46e-06           smallest_sin_value = 9.98e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.748436146678       residual = 4.17e-06           smallest_sin_value = 9.98e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.748455617628       residual = 2.31e-06           smallest_sin_value = 9.96e-01
davidson iteration   57:   krylov dim =  58   tar_fn =      -0.748420278311       residual = 2.12e-07           smallest_sin_value = 9.92e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.68e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+10 is 4.025158e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.130632 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3089e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8234
    reference variance = 0.629336
====================================================
  Execution time = 4.2435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5223e-01
  Total weights = 1.9644e+06
  Execution time = 5.9530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328948469
                                         uncertainty =       0.002330875442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328948469
                                         uncertainty =       0.002330875442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466589470
  error estimate for blocks of size 2^( 2) =       0.000492183422
  error estimate for blocks of size 2^( 3) =       0.000516127019
  error estimate for blocks of size 2^( 4) =       0.000534483056
  error estimate for blocks of size 2^( 5) =       0.000545273761
  error estimate for blocks of size 2^( 6) =       0.000549205095
  error estimate for blocks of size 2^( 7) =       0.000553357624

      target function =      -0.743498366055
              le_mean =     -22.814875377048
             les_mean =     520.970772071700
             stat err =       0.000545579884
             autocorr =       1.367246537051
   target nu stat err =       0.000545579884
   target dn stat err =       0.003894124696
      target stat err =       0.003251254805
              std dev =       0.659857156256
             le_variance =       0.435411466662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328948469
                                         uncertainty =       0.002330875442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328948469
                                         uncertainty =       0.002330875442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466589470
  error estimate for blocks of size 2^( 2) =       0.000492183422
  error estimate for blocks of size 2^( 3) =       0.000516127019
  error estimate for blocks of size 2^( 4) =       0.000534483056
  error estimate for blocks of size 2^( 5) =       0.000545273761
  error estimate for blocks of size 2^( 6) =       0.000549205095
  error estimate for blocks of size 2^( 7) =       0.000553357624

      target function =      -0.743498366055
              le_mean =     -22.814875377048
             les_mean =     520.970772071700
             stat err =       0.000545579884
             autocorr =       1.367246537058
   target nu stat err =       0.000545579884
   target dn stat err =       0.003894124696
      target stat err =       0.003251254805
              std dev =       0.659857156256
             le_variance =       0.435411466662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328948469
                                         uncertainty =       0.002330875442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328948469
                                         uncertainty =       0.002330875442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466589470
  error estimate for blocks of size 2^( 2) =       0.000492183422
  error estimate for blocks of size 2^( 3) =       0.000516127019
  error estimate for blocks of size 2^( 4) =       0.000534483056
  error estimate for blocks of size 2^( 5) =       0.000545273761
  error estimate for blocks of size 2^( 6) =       0.000549205095
  error estimate for blocks of size 2^( 7) =       0.000553357624

      target function =      -0.743498366055
              le_mean =     -22.814875377048
             les_mean =     520.970772071700
             stat err =       0.000545579884
             autocorr =       1.367246537052
   target nu stat err =       0.000545579884
   target dn stat err =       0.003894124696
      target stat err =       0.003251254805
              std dev =       0.659857156256
             le_variance =       0.435411466662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328948469
                                         uncertainty =       0.002330875442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435328948469
                                         uncertainty =       0.002330875442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466589470
  error estimate for blocks of size 2^( 2) =       0.000492183422
  error estimate for blocks of size 2^( 3) =       0.000516127019
  error estimate for blocks of size 2^( 4) =       0.000534483056
  error estimate for blocks of size 2^( 5) =       0.000545273761
  error estimate for blocks of size 2^( 6) =       0.000549205095
  error estimate for blocks of size 2^( 7) =       0.000553357624

      target function =      -0.743498366055
              le_mean =     -22.814875377048
             les_mean =     520.970772071700
             stat err =       0.000545579884
             autocorr =       1.367246537050
   target nu stat err =       0.000545579884
   target dn stat err =       0.003894124696
      target stat err =       0.003251254805
              std dev =       0.659857156256
             le_variance =       0.435411466662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743498366055        initial  <--
     3.2312e+09     3.2312e+10             6.3925e-14        -0.743498366055
     1.2925e+10     1.2925e+11             1.6107e-14        -0.743498366055
     5.1699e+10     5.1699e+11             4.0252e-15        -0.743498366055

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.6571
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2575e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7572
    reference variance = 0.453481
====================================================
  Execution time = 4.5209e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5470e-01
  Total weights = 1.964279216e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437482356539
                                         uncertainty =       0.002860365333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437482356539
                                         uncertainty =       0.002860365333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467739058
  error estimate for blocks of size 2^( 2) =       0.000493233756
  error estimate for blocks of size 2^( 3) =       0.000516745591
  error estimate for blocks of size 2^( 4) =       0.000534576338
  error estimate for blocks of size 2^( 5) =       0.000544839758
  error estimate for blocks of size 2^( 6) =       0.000549470165
  error estimate for blocks of size 2^( 7) =       0.000553302035

      target function =      -0.741476486404
              le_mean =     -22.815179587509
             les_mean =     520.987118908628
             stat err =       0.000545547074
             autocorr =       1.360370445575
   target nu stat err =       0.000545547074
   target dn stat err =       0.004438022756
      target stat err =       0.003672608472
              std dev =       0.661482919464
             le_variance =       0.437559652742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281517958751e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+10, overlap shift 3.2312e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741493763030       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741493763030       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741493763030       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741493817014       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741493763031       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741494236551       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741491012375       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741617626252       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741454834979       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741461717531       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741474538969       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741507856375       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741393779801       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741456824651       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741519710897       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741327869296       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741476693884       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741496650181       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741496874140       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741506045811       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741526678009       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741496304079       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741496439929       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741482530367       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741496850784       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741482103275       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741455919975       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741506171622       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741520165670       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741521620157       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741493336687       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741453919896       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741479396373       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.741441734632       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741449975267       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741494591220       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741452392182       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741474951488       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741490610083       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741464661273       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.741487821810       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741454709303       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741485520931       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.741483057410       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741481942181       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741469193542       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.741478450114       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.741495811116       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.741484623582       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.741517145267       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.741462476547       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.741531808999       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.741527190877       residual = 5.02e-07           smallest_sin_value = 9.98e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.741498516563       residual = 5.18e-07           smallest_sin_value = 9.94e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.741440218098       residual = 5.44e-07           smallest_sin_value = 9.93e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+10 is 9.253113e-15

solving harmonic davidson linear method for identity shift 1.2925e+11, overlap shift 1.2925e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741493763030       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741493763030       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741493763030       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741493763029       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741493763022       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741469399383       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741496689755       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741468369903       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741279386270       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741665376128       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741516272533       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741177462104       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741266648015       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741351276696       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741565145053       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741449637534       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741504395065       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741557564560       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741503168975       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741467115756       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741502210830       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741390584503       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741518753547       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741433129766       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741574734710       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741446089811       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741509991327       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741582873606       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741524678391       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741524370998       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741414671871       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741430254708       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741581928354       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.741783575883       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741471541360       residual = 9.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741498289958       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741591522889       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741473401127       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741426461831       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741556421402       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.741472150776       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741485621037       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741501594872       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.741506379785       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741443684413       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741472424217       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.741476387719       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.741551484337       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.741623761593       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.741302591976       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.741431078168       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.741445847608       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.741373002775       residual = 4.90e-06           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.741584021167       residual = 1.21e-05           smallest_sin_value = 9.94e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+11 is 2.318100e-15

solving harmonic davidson linear method for identity shift 5.1699e+11, overlap shift 5.1699e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741493763030       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741493763030       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741493763030       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741493763030       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741493763029       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741447271936       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741554239134       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741887822658       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741359473561       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741609670245       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741553701387       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741316148111       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742004779757       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741479030515       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741424468610       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740965006290       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742784948062       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741553937525       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741166896053       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741615211276       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741267042673       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741513480741       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740904781201       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741142321742       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741658935909       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741561134850       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740389661429       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740888334691       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742081115082       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740883966602       residual = 9.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741422624206       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741039930304       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741824574496       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.741978602927       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741441495811       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741052558790       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741508542286       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741982752842       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741873223625       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.741186157818       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.741709916257       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741585096888       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741385147427       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.741437841561       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741279100210       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741537372014       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.741040227137       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.741302639321       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.741426510487       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.741855293555       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.741264104087       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.741510053264       residual = 8.61e-06           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.741382159760       residual = 5.20e-06           smallest_sin_value = 9.97e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.741479660514       residual = 2.36e-05           smallest_sin_value = 9.95e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+11 is 5.270320e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.322293 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.3230e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7853
    reference variance = 0.341458
====================================================
  Execution time = 4.2392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4681e-01
  Total weights = 1.9643e+06
  Execution time = 5.8852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434704431346
                                         uncertainty =       0.002108334346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434704431346
                                         uncertainty =       0.002108334346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466221873
  error estimate for blocks of size 2^( 2) =       0.000491634756
  error estimate for blocks of size 2^( 3) =       0.000515227920
  error estimate for blocks of size 2^( 4) =       0.000533653642
  error estimate for blocks of size 2^( 5) =       0.000545290235
  error estimate for blocks of size 2^( 6) =       0.000551345032
  error estimate for blocks of size 2^( 7) =       0.000554102415

      target function =      -0.747976016317
              le_mean =     -22.814349834311
             les_mean =     520.941369751608
             stat err =       0.000546097831
             autocorr =       1.372004743362
   target nu stat err =       0.000546097831
   target dn stat err =       0.002764294951
      target stat err =       0.002372270225
              std dev =       0.659337296499
             le_variance =       0.434725670554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434704431346
                                         uncertainty =       0.002108334346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434704431346
                                         uncertainty =       0.002108334346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466221873
  error estimate for blocks of size 2^( 2) =       0.000491634756
  error estimate for blocks of size 2^( 3) =       0.000515227920
  error estimate for blocks of size 2^( 4) =       0.000533653642
  error estimate for blocks of size 2^( 5) =       0.000545290235
  error estimate for blocks of size 2^( 6) =       0.000551345032
  error estimate for blocks of size 2^( 7) =       0.000554102415

      target function =      -0.747976016317
              le_mean =     -22.814349834311
             les_mean =     520.941369751608
             stat err =       0.000546097831
             autocorr =       1.372004743365
   target nu stat err =       0.000546097831
   target dn stat err =       0.002764294951
      target stat err =       0.002372270225
              std dev =       0.659337296499
             le_variance =       0.434725670554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434704431346
                                         uncertainty =       0.002108334346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434704431346
                                         uncertainty =       0.002108334346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466221873
  error estimate for blocks of size 2^( 2) =       0.000491634756
  error estimate for blocks of size 2^( 3) =       0.000515227920
  error estimate for blocks of size 2^( 4) =       0.000533653642
  error estimate for blocks of size 2^( 5) =       0.000545290235
  error estimate for blocks of size 2^( 6) =       0.000551345032
  error estimate for blocks of size 2^( 7) =       0.000554102415

      target function =      -0.747976016317
              le_mean =     -22.814349834311
             les_mean =     520.941369751608
             stat err =       0.000546097831
             autocorr =       1.372004743363
   target nu stat err =       0.000546097831
   target dn stat err =       0.002764294951
      target stat err =       0.002372270225
              std dev =       0.659337296499
             le_variance =       0.434725670554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434704431346
                                         uncertainty =       0.002108334346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434704431346
                                         uncertainty =       0.002108334346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466221873
  error estimate for blocks of size 2^( 2) =       0.000491634756
  error estimate for blocks of size 2^( 3) =       0.000515227920
  error estimate for blocks of size 2^( 4) =       0.000533653642
  error estimate for blocks of size 2^( 5) =       0.000545290235
  error estimate for blocks of size 2^( 6) =       0.000551345032
  error estimate for blocks of size 2^( 7) =       0.000554102415

      target function =      -0.747976016317
              le_mean =     -22.814349834311
             les_mean =     520.941369751608
             stat err =       0.000546097831
             autocorr =       1.372004743365
   target nu stat err =       0.000546097831
   target dn stat err =       0.002764294951
      target stat err =       0.002372270225
              std dev =       0.659337296499
             le_variance =       0.434725670554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747976016317        initial
     3.2312e+10     3.2312e+11             9.2531e-15        -0.747976016317  <--
     1.2925e+11     1.2925e+12             2.3181e-15        -0.747976016317
     5.1699e+11     5.1699e+12             5.2703e-16        -0.747976016317

*****************************************************************************
Applying the update for shift_i =   3.2312e+10     and shift_s =   3.2312e+11
*****************************************************************************

  Execution time = 7.1963e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2522e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.7368
    reference variance = 0.404609
====================================================
  Execution time = 4.2873e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4673e-01
  Total weights = 1.964188178e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436228291260
                                         uncertainty =       0.001679200865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436228291260
                                         uncertainty =       0.001679200865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467043122
  error estimate for blocks of size 2^( 2) =       0.000492455269
  error estimate for blocks of size 2^( 3) =       0.000516456126
  error estimate for blocks of size 2^( 4) =       0.000533823172
  error estimate for blocks of size 2^( 5) =       0.000545999240
  error estimate for blocks of size 2^( 6) =       0.000552480024
  error estimate for blocks of size 2^( 7) =       0.000554946040

      target function =      -0.748051454012
              le_mean =     -22.815111460364
             les_mean =     520.976042142924
             stat err =       0.000546812119
             autocorr =       1.370762769834
   target nu stat err =       0.000546812119
   target dn stat err =       0.002332443297
      target stat err =       0.002030811446
              std dev =       0.660498717959
             le_variance =       0.436258556426


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281511146036e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.0779e+09, overlap shift 8.0779e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748055998742       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748055998742       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748055998742       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748055998742       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748055998742       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748055998742       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748066269692       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748043813331       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748055998742       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748060850977       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748036121663       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748055998742       residual = 2.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.0779e+09 is 2.246038e-14

solving harmonic davidson linear method for identity shift 3.2312e+10, overlap shift 3.2312e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748055998742       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748055998742       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748055998742       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748055998742       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748054930840       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748037010845       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748054493323       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748100156379       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748056258409       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748020799900       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748075843786       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748030966518       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748035003831       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748058454738       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748102398751       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748108229727       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748000157849       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748071198350       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748004131785       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748022736196       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748052771514       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748110731101       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748006987492       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748043451117       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748054821398       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748023771188       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748150720061       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748005045379       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748007509444       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748074220494       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748103191812       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748046431337       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748119203325       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748072075823       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748027941022       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748026653717       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748047331636       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748099970110       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748099863095       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748037282650       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748082563300       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748071688080       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747988966604       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747978575689       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748074469065       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748042868791       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748095073543       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748018499890       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748076078882       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.748068956778       residual = 5.88e-07           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747991594314       residual = 5.40e-07           smallest_sin_value = 9.97e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.748048173301       residual = 6.47e-07           smallest_sin_value = 9.96e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748073567112       residual = 3.87e-07           smallest_sin_value = 9.95e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+10 is 5.599072e-15

solving harmonic davidson linear method for identity shift 1.2925e+11, overlap shift 1.2925e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748055998742       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748055998742       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748055998742       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748055998742       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748055998742       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748055998742       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748009711181       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748085918461       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747763490550       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747890321180       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747962527821       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747813518193       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748334503019       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747897897340       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748202766615       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747923091375       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747951225853       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748007815565       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748086452429       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748034121584       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748107462491       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748019016755       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748023737575       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748074364067       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748095186470       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748101093734       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748073367028       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748079854095       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748026094611       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748135304485       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748193999640       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748033430719       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748113290683       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748196878681       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748001184347       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747995826823       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748068988757       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748097023812       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748022276545       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747996618111       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748095668521       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748026891267       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748049796527       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748042082430       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748046630443       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.748051934267       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748064550862       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.748045617468       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.748071998345       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747921607774       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.748028379070       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.748254949280       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747920799875       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.748238939610       residual = 4.68e-06           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.748071791123       residual = 1.35e-05           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.748132022704       residual = 7.22e-06           smallest_sin_value = 9.96e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+11 is 1.371302e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.450593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0672e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.8315
    reference variance = 0.631605
====================================================
  Execution time = 4.3399e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4896e-01
  Total weights = 1.9639e+06
  Execution time = 5.9779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433834903168
                                         uncertainty =       0.002025002939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433834903168
                                         uncertainty =       0.002025002939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465709705
  error estimate for blocks of size 2^( 2) =       0.000491198674
  error estimate for blocks of size 2^( 3) =       0.000514707931
  error estimate for blocks of size 2^( 4) =       0.000532591151
  error estimate for blocks of size 2^( 5) =       0.000543031582
  error estimate for blocks of size 2^( 6) =       0.000549524290
  error estimate for blocks of size 2^( 7) =       0.000554289561

      target function =      -0.746187724932
              le_mean =     -22.814115816280
             les_mean =     520.932844296405
             stat err =       0.000544859146
             autocorr =       1.368793435948
   target nu stat err =       0.000544859146
   target dn stat err =       0.003622889337
      target stat err =       0.003050784383
              std dev =       0.658612980737
             le_variance =       0.433771058395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433834903168
                                         uncertainty =       0.002025002939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433834903168
                                         uncertainty =       0.002025002939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465709705
  error estimate for blocks of size 2^( 2) =       0.000491198674
  error estimate for blocks of size 2^( 3) =       0.000514707931
  error estimate for blocks of size 2^( 4) =       0.000532591151
  error estimate for blocks of size 2^( 5) =       0.000543031582
  error estimate for blocks of size 2^( 6) =       0.000549524290
  error estimate for blocks of size 2^( 7) =       0.000554289561

      target function =      -0.746187724932
              le_mean =     -22.814115816280
             les_mean =     520.932844296405
             stat err =       0.000544859146
             autocorr =       1.368793435944
   target nu stat err =       0.000544859146
   target dn stat err =       0.003622889337
      target stat err =       0.003050784383
              std dev =       0.658612980737
             le_variance =       0.433771058395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433834903168
                                         uncertainty =       0.002025002939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433834903168
                                         uncertainty =       0.002025002939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465709705
  error estimate for blocks of size 2^( 2) =       0.000491198674
  error estimate for blocks of size 2^( 3) =       0.000514707931
  error estimate for blocks of size 2^( 4) =       0.000532591151
  error estimate for blocks of size 2^( 5) =       0.000543031582
  error estimate for blocks of size 2^( 6) =       0.000549524290
  error estimate for blocks of size 2^( 7) =       0.000554289561

      target function =      -0.746187724932
              le_mean =     -22.814115816280
             les_mean =     520.932844296405
             stat err =       0.000544859146
             autocorr =       1.368793435938
   target nu stat err =       0.000544859146
   target dn stat err =       0.003622889337
      target stat err =       0.003050784383
              std dev =       0.658612980737
             le_variance =       0.433771058395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433834903168
                                         uncertainty =       0.002025002939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433834903168
                                         uncertainty =       0.002025002939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465709705
  error estimate for blocks of size 2^( 2) =       0.000491198674
  error estimate for blocks of size 2^( 3) =       0.000514707931
  error estimate for blocks of size 2^( 4) =       0.000532591151
  error estimate for blocks of size 2^( 5) =       0.000543031582
  error estimate for blocks of size 2^( 6) =       0.000549524290
  error estimate for blocks of size 2^( 7) =       0.000554289561

      target function =      -0.746187724932
              le_mean =     -22.814115816280
             les_mean =     520.932844296405
             stat err =       0.000544859146
             autocorr =       1.368793435947
   target nu stat err =       0.000544859146
   target dn stat err =       0.003622889337
      target stat err =       0.003050784383
              std dev =       0.658612980737
             le_variance =       0.433771058395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746187724932        initial
     8.0779e+09     8.0779e+10             2.2460e-14        -0.746187724932  <--
     3.2312e+10     3.2312e+11             5.5991e-15        -0.746187724932
     1.2925e+11     1.2925e+12             1.3713e-15        -0.746187724932

*****************************************************************************
Applying the update for shift_i =   8.0779e+09     and shift_s =   8.0779e+10
*****************************************************************************

  Execution time = 7.3149e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2390e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.9213
    reference variance = 0.321592
====================================================
  Execution time = 4.3070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4853e-01
  Total weights = 1.964111093e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435096409218
                                         uncertainty =       0.002101703611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435096409218
                                         uncertainty =       0.002101703611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466423095
  error estimate for blocks of size 2^( 2) =       0.000492073659
  error estimate for blocks of size 2^( 3) =       0.000516635355
  error estimate for blocks of size 2^( 4) =       0.000534675988
  error estimate for blocks of size 2^( 5) =       0.000545231205
  error estimate for blocks of size 2^( 6) =       0.000550885700
  error estimate for blocks of size 2^( 7) =       0.000554512609

      target function =      -0.746542149598
              le_mean =     -22.813649623997
             les_mean =     520.911140143477
             stat err =       0.000546326376
             autocorr =       1.371968824332
   target nu stat err =       0.000546326376
   target dn stat err =       0.003471662989
      target stat err =       0.002929544044
              std dev =       0.659621866896
             le_variance =       0.435101007287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281364962400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0195e+09, overlap shift 2.0195e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746552746274       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746552746274       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746552746274       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746552746274       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746552467516       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746552746274       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746552585075       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746552241311       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746549841476       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746555011164       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+09 is 6.063659e-14

solving harmonic davidson linear method for identity shift 8.0779e+09, overlap shift 8.0779e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746552746274       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746552746274       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746552746274       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746552746274       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746554708291       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746556566827       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746552746274       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746552746274       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746562289021       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746556360291       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746544960362       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746553827612       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746563464646       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.0779e+09 is 1.511277e-14

solving harmonic davidson linear method for identity shift 3.2312e+10, overlap shift 3.2312e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746552746274       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746552746274       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746552746274       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746552746274       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746552339227       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746575848773       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746545584792       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746580404852       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746602531124       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746583100579       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746504478741       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746513302926       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746519276734       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746522610472       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746579834140       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746593645822       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746523752208       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746629388276       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746596867433       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746531606004       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746571781785       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746479076915       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746590240484       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746532092120       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746518797854       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746550898185       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746573155686       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746588893837       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746497605273       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746566471117       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746532694260       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746524185111       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746620492412       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746467081448       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746627981827       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746516344743       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746512149736       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746530137576       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746641528685       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746604458346       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746542793805       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746537407340       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746495365074       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746538190689       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746568554371       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746583992496       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746591624091       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746540323814       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746526338886       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746576028414       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746572599494       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746537172619       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746555845619       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.746532859504       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.746570113443       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.746546320977       residual = 1.53e-07           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   tar_fn =      -0.746599234088       residual = 2.05e-07           smallest_sin_value = 9.98e-01
davidson iteration   57 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         57 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+10 is 3.839179e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.523387 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0859e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.8832
    reference variance = 0.537915
====================================================
  Execution time = 4.3227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4949e-01
  Total weights = 1.9646e+06
  Execution time = 5.8934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432899719660
                                         uncertainty =       0.002906976100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432899719660
                                         uncertainty =       0.002906976100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465284021
  error estimate for blocks of size 2^( 2) =       0.000490605706
  error estimate for blocks of size 2^( 3) =       0.000514108572
  error estimate for blocks of size 2^( 4) =       0.000532180948
  error estimate for blocks of size 2^( 5) =       0.000543895666
  error estimate for blocks of size 2^( 6) =       0.000548895116
  error estimate for blocks of size 2^( 7) =       0.000552171830

      target function =      -0.745735364328
              le_mean =     -22.813909393176
             les_mean =     520.923953491808
             stat err =       0.000544285890
             autocorr =       1.368415157424
   target nu stat err =       0.000544285890
   target dn stat err =       0.005490940413
      target stat err =       0.004565718403
              std dev =       0.658010972520
             le_variance =       0.432978439957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432899719660
                                         uncertainty =       0.002906976100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432899719660
                                         uncertainty =       0.002906976100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465284021
  error estimate for blocks of size 2^( 2) =       0.000490605706
  error estimate for blocks of size 2^( 3) =       0.000514108572
  error estimate for blocks of size 2^( 4) =       0.000532180948
  error estimate for blocks of size 2^( 5) =       0.000543895666
  error estimate for blocks of size 2^( 6) =       0.000548895116
  error estimate for blocks of size 2^( 7) =       0.000552171830

      target function =      -0.745735364328
              le_mean =     -22.813909393176
             les_mean =     520.923953491808
             stat err =       0.000544285890
             autocorr =       1.368415157416
   target nu stat err =       0.000544285890
   target dn stat err =       0.005490940413
      target stat err =       0.004565718403
              std dev =       0.658010972520
             le_variance =       0.432978439957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432899719660
                                         uncertainty =       0.002906976100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432899719660
                                         uncertainty =       0.002906976100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465284021
  error estimate for blocks of size 2^( 2) =       0.000490605706
  error estimate for blocks of size 2^( 3) =       0.000514108572
  error estimate for blocks of size 2^( 4) =       0.000532180948
  error estimate for blocks of size 2^( 5) =       0.000543895666
  error estimate for blocks of size 2^( 6) =       0.000548895116
  error estimate for blocks of size 2^( 7) =       0.000552171830

      target function =      -0.745735364328
              le_mean =     -22.813909393176
             les_mean =     520.923953491808
             stat err =       0.000544285890
             autocorr =       1.368415157427
   target nu stat err =       0.000544285890
   target dn stat err =       0.005490940413
      target stat err =       0.004565718403
              std dev =       0.658010972520
             le_variance =       0.432978439957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432899719660
                                         uncertainty =       0.002906976100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432899719660
                                         uncertainty =       0.002906976100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465284021
  error estimate for blocks of size 2^( 2) =       0.000490605706
  error estimate for blocks of size 2^( 3) =       0.000514108572
  error estimate for blocks of size 2^( 4) =       0.000532180948
  error estimate for blocks of size 2^( 5) =       0.000543895666
  error estimate for blocks of size 2^( 6) =       0.000548895116
  error estimate for blocks of size 2^( 7) =       0.000552171830

      target function =      -0.745735364328
              le_mean =     -22.813909393176
             les_mean =     520.923953491808
             stat err =       0.000544285890
             autocorr =       1.368415157420
   target nu stat err =       0.000544285890
   target dn stat err =       0.005490940413
      target stat err =       0.004565718403
              std dev =       0.658010972520
             le_variance =       0.432978439957


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745735364328        initial  <--
     2.0195e+09     2.0195e+10             6.0637e-14        -0.745735364328
     8.0779e+09     8.0779e+10             1.5113e-14        -0.745735364328
     3.2312e+10     3.2312e+11             3.8392e-15        -0.745735364328

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 72.8656
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2375e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6695
    reference variance = 0.770024
====================================================
  Execution time = 4.2878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4994e-01
  Total weights = 1.964357871e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435126613871
                                         uncertainty =       0.002005385624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435126613871
                                         uncertainty =       0.002005385624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466474091
  error estimate for blocks of size 2^( 2) =       0.000491688792
  error estimate for blocks of size 2^( 3) =       0.000515112081
  error estimate for blocks of size 2^( 4) =       0.000532627077
  error estimate for blocks of size 2^( 5) =       0.000543953019
  error estimate for blocks of size 2^( 6) =       0.000551061957
  error estimate for blocks of size 2^( 7) =       0.000553741390

      target function =      -0.745385151011
              le_mean =     -22.814096287446
             les_mean =     520.932931242841
             stat err =       0.000545345861
             autocorr =       1.366749705402
   target nu stat err =       0.000545345861
   target dn stat err =       0.002939327984
      target stat err =       0.002494949158
              std dev =       0.659693985297
             le_variance =       0.435196154237


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281409628745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0195e+10, overlap shift 2.0195e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745392524057       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745392524057       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745392524057       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745390253065       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745394647550       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745392524057       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745406463404       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745376063696       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745369783244       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745355583791       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745412478789       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745422500221       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745427826033       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745384511044       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745404017717       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745377460556       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745386867298       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745385262870       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745399833271       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745372522149       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745394367924       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745393216911       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745392294290       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745387745821       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745426626488       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745363538290       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745394044022       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745382013398       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745374271526       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745423724526       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745381648311       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745387495314       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745407427614       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745409512859       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745369317745       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+10 is 8.085127e-15

solving harmonic davidson linear method for identity shift 8.0779e+10, overlap shift 8.0779e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745392524057       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745392524057       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745392524057       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745392524057       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745392524057       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745370045440       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745525430851       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745392524057       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745392524057       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745270701490       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745325293098       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745393431784       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745299756064       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745330326297       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745682491266       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745448048090       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745259337248       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745719694215       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745377694363       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745397990198       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745626159761       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745216717339       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745390162840       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745297921823       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745495521668       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745220684037       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745612752039       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745458631044       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745287365491       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745478790828       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745333472625       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745369613593       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745366709947       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745361091954       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745494553619       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745364115903       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745359490919       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745415142224       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745222506769       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745486465712       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745206610505       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745432127314       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745263578548       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.745248517153       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745378975776       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745362297356       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745419839918       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745343108500       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745424468216       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.745393198481       residual = 8.20e-07           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745383860233       residual = 2.21e-06           smallest_sin_value = 9.96e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.745365368756       residual = 1.33e-06           smallest_sin_value = 9.95e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.0779e+10 is 2.091375e-15

solving harmonic davidson linear method for identity shift 3.2312e+11, overlap shift 3.2312e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745392524057       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745392524057       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745392524057       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745423977522       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745392524057       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745562587554       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745167416446       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745305521406       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744629075903       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745381391106       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745001477500       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745174693643       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745552864771       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745720282946       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744990975427       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745997036857       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745680706760       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744472362374       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745882457241       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745269765651       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745928526350       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745103453246       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745163976036       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745633430567       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745461192728       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745663810281       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745260001715       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745393349183       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745410944607       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745410029859       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745726835988       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745345349261       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745480565206       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745574961656       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745062719443       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745661817780       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745575704194       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745222314663       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745399525006       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745358771587       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744970625417       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745522080791       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745362168442       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.745427182159       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745274988758       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745490399312       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745339952830       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744447831205       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745206698962       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.745293352723       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.744917652315       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.745050260141       residual = 1.40e-04           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.745492401555       residual = 1.26e-05           smallest_sin_value = 9.96e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+11 is 5.237463e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.651475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0681e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6976
    reference variance = 0.305176
====================================================
  Execution time = 4.1754e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4677e-01
  Total weights = 1.9645e+06
  Execution time = 5.9402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434772691840
                                         uncertainty =       0.002356273997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434772691840
                                         uncertainty =       0.002356273997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466226196
  error estimate for blocks of size 2^( 2) =       0.000491594583
  error estimate for blocks of size 2^( 3) =       0.000515307575
  error estimate for blocks of size 2^( 4) =       0.000533439588
  error estimate for blocks of size 2^( 5) =       0.000544485460
  error estimate for blocks of size 2^( 6) =       0.000549382591
  error estimate for blocks of size 2^( 7) =       0.000550908092

      target function =      -0.748007240831
              le_mean =     -22.813980198830
             les_mean =     520.924458944004
             stat err =       0.000544553933
             autocorr =       1.364232694883
   target nu stat err =       0.000544553933
   target dn stat err =       0.003206568251
      target stat err =       0.002727036954
              std dev =       0.659343410167
             le_variance =       0.434733732530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434772691840
                                         uncertainty =       0.002356273997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434772691840
                                         uncertainty =       0.002356273997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466226196
  error estimate for blocks of size 2^( 2) =       0.000491594583
  error estimate for blocks of size 2^( 3) =       0.000515307575
  error estimate for blocks of size 2^( 4) =       0.000533439588
  error estimate for blocks of size 2^( 5) =       0.000544485460
  error estimate for blocks of size 2^( 6) =       0.000549382591
  error estimate for blocks of size 2^( 7) =       0.000550908092

      target function =      -0.748007240831
              le_mean =     -22.813980198830
             les_mean =     520.924458944004
             stat err =       0.000544553933
             autocorr =       1.364232694883
   target nu stat err =       0.000544553933
   target dn stat err =       0.003206568251
      target stat err =       0.002727036954
              std dev =       0.659343410167
             le_variance =       0.434733732530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434772691840
                                         uncertainty =       0.002356273997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434772691840
                                         uncertainty =       0.002356273997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466226196
  error estimate for blocks of size 2^( 2) =       0.000491594583
  error estimate for blocks of size 2^( 3) =       0.000515307575
  error estimate for blocks of size 2^( 4) =       0.000533439588
  error estimate for blocks of size 2^( 5) =       0.000544485460
  error estimate for blocks of size 2^( 6) =       0.000549382591
  error estimate for blocks of size 2^( 7) =       0.000550908092

      target function =      -0.748007240831
              le_mean =     -22.813980198830
             les_mean =     520.924458944004
             stat err =       0.000544553933
             autocorr =       1.364232694883
   target nu stat err =       0.000544553933
   target dn stat err =       0.003206568251
      target stat err =       0.002727036954
              std dev =       0.659343410167
             le_variance =       0.434733732530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434772691840
                                         uncertainty =       0.002356273997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434772691840
                                         uncertainty =       0.002356273997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466226196
  error estimate for blocks of size 2^( 2) =       0.000491594583
  error estimate for blocks of size 2^( 3) =       0.000515307575
  error estimate for blocks of size 2^( 4) =       0.000533439588
  error estimate for blocks of size 2^( 5) =       0.000544485460
  error estimate for blocks of size 2^( 6) =       0.000549382591
  error estimate for blocks of size 2^( 7) =       0.000550908092

      target function =      -0.748007240831
              le_mean =     -22.813980198830
             les_mean =     520.924458944004
             stat err =       0.000544553933
             autocorr =       1.364232694883
   target nu stat err =       0.000544553933
   target dn stat err =       0.003206568251
      target stat err =       0.002727036954
              std dev =       0.659343410167
             le_variance =       0.434733732530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748007240831        initial
     2.0195e+10     2.0195e+11             8.0851e-15        -0.748007240831  <--
     8.0779e+10     8.0779e+11             2.0914e-15        -0.748007240831
     3.2312e+11     3.2312e+12             5.2375e-16        -0.748007240831

*****************************************************************************
Applying the update for shift_i =   2.0195e+10     and shift_s =   2.0195e+11
*****************************************************************************

  Execution time = 7.5597e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2630e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.8126
    reference variance = 0.602439
====================================================
  Execution time = 4.3051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5325e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4696e-01
  Total weights = 1.964322108e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433543753614
                                         uncertainty =       0.001988791535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433543753614
                                         uncertainty =       0.001988791535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465849677
  error estimate for blocks of size 2^( 2) =       0.000491373956
  error estimate for blocks of size 2^( 3) =       0.000515251470
  error estimate for blocks of size 2^( 4) =       0.000532342426
  error estimate for blocks of size 2^( 5) =       0.000543406296
  error estimate for blocks of size 2^( 6) =       0.000550180711
  error estimate for blocks of size 2^( 7) =       0.000555746665

      target function =      -0.747847994840
              le_mean =     -22.813726303861
             les_mean =     520.913066342184
             stat err =       0.000545419025
             autocorr =       1.370783812237
   target nu stat err =       0.000545419025
   target dn stat err =       0.002711061971
      target stat err =       0.002326474739
              std dev =       0.658810931288
             le_variance =       0.434031843185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281372630386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.0487e+09, overlap shift 5.0487e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747854250621       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747854250621       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747854250621       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747856029055       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747854250593       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747850160130       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747854443076       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747845913244       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747850621464       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.0487e+09 is 2.847579e-14

solving harmonic davidson linear method for identity shift 2.0195e+10, overlap shift 2.0195e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747854250621       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747854250621       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747854250621       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747854250621       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747854250599       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747854250426       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747854961726       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747898681789       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747798752337       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747857711996       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747840338880       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747879123396       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747869592878       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747873489430       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747877181449       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747852601545       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747866824687       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747855223926       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747863355479       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747853956028       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747861259468       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747836573389       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747881721491       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747849781767       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+10 is 7.127598e-15

solving harmonic davidson linear method for identity shift 8.0779e+10, overlap shift 8.0779e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747854250621       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747854250621       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747854250621       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747854250621       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747830568976       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747883043633       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747835416495       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747884438132       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747862745340       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747870314599       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747876574037       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747811722224       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747766946772       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747925393529       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747868294246       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747770465037       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747847289761       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747938448718       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748088573749       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747833264161       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747745267827       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747780469860       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747750454278       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747800841913       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747840791051       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747918974337       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747962990042       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747808527467       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747895636844       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747752853942       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747890124755       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748017830344       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747937881243       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747818508009       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747983698146       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747870402702       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747867770418       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747842504145       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747795811772       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747902265693       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747899617163       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747801869970       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747916877341       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747951184318       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.747785821075       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747882934330       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747836685733       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747838185134       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747887984139       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747819027296       residual = 1.53e-07           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.747850846889       residual = 1.80e-06           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.747853886794       residual = 5.85e-07           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.747864500625       residual = 1.80e-07           smallest_sin_value = 9.96e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.747796761778       residual = 9.85e-07           smallest_sin_value = 9.96e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.748056580944       residual = 4.59e-07           smallest_sin_value = 9.93e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.0779e+10 is 1.782112e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.726430 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0820e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.8294
    reference variance = 0.46937
====================================================
  Execution time = 4.1640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4592e-01
  Total weights = 1.9642e+06
  Execution time = 5.8834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635148443
                                         uncertainty =       0.002003794958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635148443
                                         uncertainty =       0.002003794958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465586453
  error estimate for blocks of size 2^( 2) =       0.000491299328
  error estimate for blocks of size 2^( 3) =       0.000515325712
  error estimate for blocks of size 2^( 4) =       0.000533646264
  error estimate for blocks of size 2^( 5) =       0.000544532493
  error estimate for blocks of size 2^( 6) =       0.000549517953
  error estimate for blocks of size 2^( 7) =       0.000554834596

      target function =      -0.748724927403
              le_mean =     -22.814862360693
             les_mean =     520.963861525026
             stat err =       0.000545632827
             autocorr =       1.373410335910
   target nu stat err =       0.000545632827
   target dn stat err =       0.002605582936
      target stat err =       0.002251104183
              std dev =       0.658438675661
             le_variance =       0.433541489606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635148443
                                         uncertainty =       0.002003794958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635148443
                                         uncertainty =       0.002003794958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465586453
  error estimate for blocks of size 2^( 2) =       0.000491299328
  error estimate for blocks of size 2^( 3) =       0.000515325712
  error estimate for blocks of size 2^( 4) =       0.000533646264
  error estimate for blocks of size 2^( 5) =       0.000544532493
  error estimate for blocks of size 2^( 6) =       0.000549517953
  error estimate for blocks of size 2^( 7) =       0.000554834596

      target function =      -0.748724927403
              le_mean =     -22.814862360693
             les_mean =     520.963861525026
             stat err =       0.000545632827
             autocorr =       1.373410335910
   target nu stat err =       0.000545632827
   target dn stat err =       0.002605582936
      target stat err =       0.002251104183
              std dev =       0.658438675661
             le_variance =       0.433541489606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635148443
                                         uncertainty =       0.002003794958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635148443
                                         uncertainty =       0.002003794958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465586453
  error estimate for blocks of size 2^( 2) =       0.000491299328
  error estimate for blocks of size 2^( 3) =       0.000515325712
  error estimate for blocks of size 2^( 4) =       0.000533646264
  error estimate for blocks of size 2^( 5) =       0.000544532493
  error estimate for blocks of size 2^( 6) =       0.000549517953
  error estimate for blocks of size 2^( 7) =       0.000554834596

      target function =      -0.748724927403
              le_mean =     -22.814862360693
             les_mean =     520.963861525026
             stat err =       0.000545632827
             autocorr =       1.373410335910
   target nu stat err =       0.000545632827
   target dn stat err =       0.002605582936
      target stat err =       0.002251104183
              std dev =       0.658438675661
             le_variance =       0.433541489606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635148443
                                         uncertainty =       0.002003794958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635148443
                                         uncertainty =       0.002003794958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465586453
  error estimate for blocks of size 2^( 2) =       0.000491299328
  error estimate for blocks of size 2^( 3) =       0.000515325712
  error estimate for blocks of size 2^( 4) =       0.000533646264
  error estimate for blocks of size 2^( 5) =       0.000544532493
  error estimate for blocks of size 2^( 6) =       0.000549517953
  error estimate for blocks of size 2^( 7) =       0.000554834596

      target function =      -0.748724927403
              le_mean =     -22.814862360693
             les_mean =     520.963861525027
             stat err =       0.000545632827
             autocorr =       1.373410335909
   target nu stat err =       0.000545632827
   target dn stat err =       0.002605582936
      target stat err =       0.002251104183
              std dev =       0.658438675661
             le_variance =       0.433541489606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748724927403        initial
     5.0487e+09     5.0487e+10             2.8476e-14        -0.748724927403  <--
     2.0195e+10     2.0195e+11             7.1276e-15        -0.748724927403
     8.0779e+10     8.0779e+11             1.7821e-15        -0.748724927403

*****************************************************************************
Applying the update for shift_i =   5.0487e+09     and shift_s =   5.0487e+10
*****************************************************************************

  Execution time = 7.1178e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2200e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.8616
    reference variance = 0.325599
====================================================
  Execution time = 4.4705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4369e-01
  Total weights = 1.964507228e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430260972776
                                         uncertainty =       0.001949365511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430260972776
                                         uncertainty =       0.001949365511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463811196
  error estimate for blocks of size 2^( 2) =       0.000489254862
  error estimate for blocks of size 2^( 3) =       0.000513196663
  error estimate for blocks of size 2^( 4) =       0.000530844633
  error estimate for blocks of size 2^( 5) =       0.000540480348
  error estimate for blocks of size 2^( 6) =       0.000546648931
  error estimate for blocks of size 2^( 7) =       0.000549843847

      target function =      -0.750571859258
              le_mean =     -22.814232123976
             les_mean =     520.932878301305
             stat err =       0.000541954440
             autocorr =       1.365347186932
   target nu stat err =       0.000541954440
   target dn stat err =       0.002879097843
      target stat err =       0.002479548962
              std dev =       0.655928084396
             le_variance =       0.430241651899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281423212398e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e+09, overlap shift 1.2622e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750579070222       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750579070222       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750579070222       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750579070222       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750579070222       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750579070222       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750579669879       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750578728164       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750577883440       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2622e+09 is 1.682652e-13

solving harmonic davidson linear method for identity shift 5.0487e+09, overlap shift 5.0487e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750579070222       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750579070222       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750579070222       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750579070222       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750579070222       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750579070222       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750579104675       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750569910388       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750585267524       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.0487e+09 is 4.206237e-14

solving harmonic davidson linear method for identity shift 2.0195e+10, overlap shift 2.0195e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750579070222       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750579070222       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750579070222       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750579070222       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750579070222       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750573653501       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750579679351       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750613472331       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750587341783       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750590186576       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750565652961       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750583668974       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750592260324       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750552070398       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750549569633       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750588425601       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750578088532       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750582013197       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750588280717       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750588731050       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750571310267       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750583103845       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750574886175       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750574244049       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+10 is 1.051635e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.734814 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2389e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.8451
    reference variance = 1.24015
====================================================
  Execution time = 4.1477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4793e-01
  Total weights = 1.9642e+06
  Execution time = 5.9248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432934098259
                                         uncertainty =       0.001958313168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432934098259
                                         uncertainty =       0.001958313168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465240461
  error estimate for blocks of size 2^( 2) =       0.000490671006
  error estimate for blocks of size 2^( 3) =       0.000514119689
  error estimate for blocks of size 2^( 4) =       0.000531098222
  error estimate for blocks of size 2^( 5) =       0.000540988167
  error estimate for blocks of size 2^( 6) =       0.000546339923
  error estimate for blocks of size 2^( 7) =       0.000548377632

      target function =      -0.747042923357
              le_mean =     -22.814454593165
             les_mean =     520.947271672756
             stat err =       0.000541700986
             autocorr =       1.355702187478
   target nu stat err =       0.000541700986
   target dn stat err =       0.003484689303
      target stat err =       0.002946398776
              std dev =       0.657949369973
             le_variance =       0.432897373447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432934098259
                                         uncertainty =       0.001958313168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432934098259
                                         uncertainty =       0.001958313168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465240461
  error estimate for blocks of size 2^( 2) =       0.000490671006
  error estimate for blocks of size 2^( 3) =       0.000514119689
  error estimate for blocks of size 2^( 4) =       0.000531098222
  error estimate for blocks of size 2^( 5) =       0.000540988167
  error estimate for blocks of size 2^( 6) =       0.000546339923
  error estimate for blocks of size 2^( 7) =       0.000548377632

      target function =      -0.747042923357
              le_mean =     -22.814454593165
             les_mean =     520.947271672756
             stat err =       0.000541700986
             autocorr =       1.355702187478
   target nu stat err =       0.000541700986
   target dn stat err =       0.003484689303
      target stat err =       0.002946398776
              std dev =       0.657949369972
             le_variance =       0.432897373447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432934098259
                                         uncertainty =       0.001958313168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432934098259
                                         uncertainty =       0.001958313168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465240461
  error estimate for blocks of size 2^( 2) =       0.000490671006
  error estimate for blocks of size 2^( 3) =       0.000514119689
  error estimate for blocks of size 2^( 4) =       0.000531098222
  error estimate for blocks of size 2^( 5) =       0.000540988167
  error estimate for blocks of size 2^( 6) =       0.000546339923
  error estimate for blocks of size 2^( 7) =       0.000548377632

      target function =      -0.747042923357
              le_mean =     -22.814454593165
             les_mean =     520.947271672756
             stat err =       0.000541700986
             autocorr =       1.355702187477
   target nu stat err =       0.000541700986
   target dn stat err =       0.003484689303
      target stat err =       0.002946398776
              std dev =       0.657949369973
             le_variance =       0.432897373448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432934098259
                                         uncertainty =       0.001958313168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432934098259
                                         uncertainty =       0.001958313168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465240461
  error estimate for blocks of size 2^( 2) =       0.000490671006
  error estimate for blocks of size 2^( 3) =       0.000514119689
  error estimate for blocks of size 2^( 4) =       0.000531098222
  error estimate for blocks of size 2^( 5) =       0.000540988167
  error estimate for blocks of size 2^( 6) =       0.000546339923
  error estimate for blocks of size 2^( 7) =       0.000548377632

      target function =      -0.747042923357
              le_mean =     -22.814454593165
             les_mean =     520.947271672756
             stat err =       0.000541700986
             autocorr =       1.355702187478
   target nu stat err =       0.000541700986
   target dn stat err =       0.003484689303
      target stat err =       0.002946398776
              std dev =       0.657949369972
             le_variance =       0.432897373447


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747042923357        initial  <--
     1.2622e+09     1.2622e+10             1.6827e-13        -0.747042923357
     5.0487e+09     5.0487e+10             4.2062e-14        -0.747042923357
     2.0195e+10     2.0195e+11             1.0516e-14        -0.747042923357

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 71.2523
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2365e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.8069
    reference variance = 0.339705
====================================================
  Execution time = 4.3082e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5363e-01
  Total weights = 1.964184671e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.9855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440328156086
                                         uncertainty =       0.003484939373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440328156086
                                         uncertainty =       0.003484939373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469320869
  error estimate for blocks of size 2^( 2) =       0.000494331208
  error estimate for blocks of size 2^( 3) =       0.000517560544
  error estimate for blocks of size 2^( 4) =       0.000535090443
  error estimate for blocks of size 2^( 5) =       0.000545741240
  error estimate for blocks of size 2^( 6) =       0.000552912783
  error estimate for blocks of size 2^( 7) =       0.000553970275

      target function =      -0.742352427723
              le_mean =     -22.814616236604
             les_mean =     520.960342707403
             stat err =       0.000546928685
             autocorr =       1.358068487442
   target nu stat err =       0.000546928685
   target dn stat err =       0.004326014305
      target stat err =       0.003588027419
              std dev =       0.663719937455
             le_variance =       0.440524155376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281461623660e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e+10, overlap shift 1.2622e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742368657585       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742368657585       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742368657585       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742368657585       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742368657585       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742368657585       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742368082372       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742365627267       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742383029611       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742358772105       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742383955991       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742362415586       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742371715918       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742346657423       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742354285819       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742356589233       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742366097242       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742344069508       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742364776427       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2622e+10 is 1.923185e-14

solving harmonic davidson linear method for identity shift 5.0487e+10, overlap shift 5.0487e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742368657585       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742368657585       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742368657585       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742368657585       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742368657585       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742373256453       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742357066710       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742394829072       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742257971078       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742397688305       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742384665517       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742429561782       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742310278067       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742454177950       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742394124814       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742352591505       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742452588429       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742386246683       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742364182655       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742310454885       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742398919372       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742335256621       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742427763013       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742360291746       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742409574257       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742383083995       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742415193967       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742307809534       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742386649602       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742360266958       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742345501853       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742436363918       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742286837734       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742281754048       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.742325040524       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742294017999       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742209558985       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742394500365       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742353156143       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742324286496       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742337885091       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742383489815       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.742381786451       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742390505478       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742403323347       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.742392821468       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742385886858       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742409920381       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.742406248350       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742370013013       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742402400951       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.742372625803       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.742374004918       residual = 4.45e-07           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.742368059413       residual = 3.09e-07           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.742317434380       residual = 2.94e-07           smallest_sin_value = 9.91e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.0487e+10 is 4.848528e-15

solving harmonic davidson linear method for identity shift 2.0195e+11, overlap shift 2.0195e+12 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742368657585       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742368657585       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742368657585       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742368657585       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742368657585       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742368658504       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742454743388       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742289498858       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742224494352       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742290595432       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742004687901       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742608990105       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742644900708       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742094023707       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742609294294       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741964382114       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742411076283       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742529932438       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742488158064       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742575479989       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742586448731       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742256143021       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742286519006       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742486461768       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742349071686       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742335277528       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742339814674       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742507736602       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742355579138       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742335819310       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742523336857       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742288854789       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742258919510       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742556691643       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.742421294642       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742263421499       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742485529717       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742222059787       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742362771055       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742314671702       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742377475734       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.742278906455       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.742508814504       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742185592240       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742387231470       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.742379265238       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742228638447       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742289658211       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.742383749775       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742338074721       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742272803766       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.742243608010       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.742434606914       residual = 7.45e-06           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.742305665544       residual = 2.39e-05           smallest_sin_value = 9.98e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.742194629839       residual = 3.01e-06           smallest_sin_value = 9.98e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+11 is 1.252522e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.867240 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1338e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.8796
    reference variance = 0.333808
====================================================
  Execution time = 4.1634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4552e-01
  Total weights = 1.9645e+06
  Execution time = 5.9092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434397267539
                                         uncertainty =       0.002851856316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434397267539
                                         uncertainty =       0.002851856316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466009252
  error estimate for blocks of size 2^( 2) =       0.000491735421
  error estimate for blocks of size 2^( 3) =       0.000515631903
  error estimate for blocks of size 2^( 4) =       0.000533592610
  error estimate for blocks of size 2^( 5) =       0.000544604837
  error estimate for blocks of size 2^( 6) =       0.000550933236
  error estimate for blocks of size 2^( 7) =       0.000556243357

      target function =      -0.749040600211
              le_mean =     -22.814023502347
             les_mean =     520.925189308922
             stat err =       0.000546343510
             autocorr =       1.374492894609
   target nu stat err =       0.000546343510
   target dn stat err =       0.003446753648
      target stat err =       0.002930133607
              std dev =       0.659036603881
             le_variance =       0.434329245255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434397267539
                                         uncertainty =       0.002851856316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434397267539
                                         uncertainty =       0.002851856316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466009252
  error estimate for blocks of size 2^( 2) =       0.000491735421
  error estimate for blocks of size 2^( 3) =       0.000515631903
  error estimate for blocks of size 2^( 4) =       0.000533592610
  error estimate for blocks of size 2^( 5) =       0.000544604837
  error estimate for blocks of size 2^( 6) =       0.000550933236
  error estimate for blocks of size 2^( 7) =       0.000556243357

      target function =      -0.749040600211
              le_mean =     -22.814023502347
             les_mean =     520.925189308922
             stat err =       0.000546343510
             autocorr =       1.374492894608
   target nu stat err =       0.000546343510
   target dn stat err =       0.003446753648
      target stat err =       0.002930133607
              std dev =       0.659036603881
             le_variance =       0.434329245255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434397267539
                                         uncertainty =       0.002851856316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434397267539
                                         uncertainty =       0.002851856316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466009252
  error estimate for blocks of size 2^( 2) =       0.000491735421
  error estimate for blocks of size 2^( 3) =       0.000515631903
  error estimate for blocks of size 2^( 4) =       0.000533592610
  error estimate for blocks of size 2^( 5) =       0.000544604837
  error estimate for blocks of size 2^( 6) =       0.000550933236
  error estimate for blocks of size 2^( 7) =       0.000556243357

      target function =      -0.749040600211
              le_mean =     -22.814023502347
             les_mean =     520.925189308922
             stat err =       0.000546343510
             autocorr =       1.374492894608
   target nu stat err =       0.000546343510
   target dn stat err =       0.003446753648
      target stat err =       0.002930133607
              std dev =       0.659036603881
             le_variance =       0.434329245255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434397267539
                                         uncertainty =       0.002851856316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434397267539
                                         uncertainty =       0.002851856316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466009252
  error estimate for blocks of size 2^( 2) =       0.000491735421
  error estimate for blocks of size 2^( 3) =       0.000515631903
  error estimate for blocks of size 2^( 4) =       0.000533592610
  error estimate for blocks of size 2^( 5) =       0.000544604837
  error estimate for blocks of size 2^( 6) =       0.000550933236
  error estimate for blocks of size 2^( 7) =       0.000556243357

      target function =      -0.749040600211
              le_mean =     -22.814023502347
             les_mean =     520.925189308922
             stat err =       0.000546343510
             autocorr =       1.374492894609
   target nu stat err =       0.000546343510
   target dn stat err =       0.003446753648
      target stat err =       0.002930133607
              std dev =       0.659036603881
             le_variance =       0.434329245255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749040600211        initial
     1.2622e+10     1.2622e+11             1.9232e-14        -0.749040600211  <--
     5.0487e+10     5.0487e+11             4.8485e-15        -0.749040600211
     2.0195e+11     2.0195e+12             1.2525e-15        -0.749040600211

*****************************************************************************
Applying the update for shift_i =   1.2622e+10     and shift_s =   1.2622e+11
*****************************************************************************

  Execution time = 7.1232e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2259e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.754
    reference variance = 0.368404
====================================================
  Execution time = 4.2842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4816e-01
  Total weights = 1.964419786e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434782622222
                                         uncertainty =       0.002253655679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434782622222
                                         uncertainty =       0.002253655679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466218221
  error estimate for blocks of size 2^( 2) =       0.000491389074
  error estimate for blocks of size 2^( 3) =       0.000514922357
  error estimate for blocks of size 2^( 4) =       0.000532325256
  error estimate for blocks of size 2^( 5) =       0.000541993521
  error estimate for blocks of size 2^( 6) =       0.000546248444
  error estimate for blocks of size 2^( 7) =       0.000546866922

      target function =      -0.746862296348
              le_mean =     -22.815299576244
             les_mean =     520.986057249129
             stat err =       0.000541858536
             autocorr =       1.350807155879
   target nu stat err =       0.000541858536
   target dn stat err =       0.002963048059
      target stat err =       0.002527187892
              std dev =       0.659332130999
             le_variance =       0.434718858968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281529957624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.1554e+09, overlap shift 3.1554e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746869939327       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746869939327       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746869939327       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746869939327       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746871163653       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746870546739       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746869608649       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746874549930       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746872111038       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.1554e+09 is 4.976673e-14

solving harmonic davidson linear method for identity shift 1.2622e+10, overlap shift 1.2622e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746869939327       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746869939327       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746869939327       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746867467987       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746871843051       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746869939327       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746869939327       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746851300165       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746872032869       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746851685123       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746906301549       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746832282628       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746898696153       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746867478882       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746879906666       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746860610185       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746863049056       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746863138703       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746848180848       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746843134481       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746874851493       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746867340413       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2622e+10 is 1.244952e-14

solving harmonic davidson linear method for identity shift 5.0487e+10, overlap shift 5.0487e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746869939327       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746869939327       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746869939327       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746869939327       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746871815604       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746849254368       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746952697257       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746850853493       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746886683440       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746784628570       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746851994585       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746907350003       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746861214751       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746877457960       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746938009944       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746883012360       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746880710151       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746812022562       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746858423916       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746821821148       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746844662307       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746899966028       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746958191406       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746832184148       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746840722946       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746840597411       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746854753254       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746813647946       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746822773647       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746836534960       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746786459849       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746761033465       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747054506784       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746817724722       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746825796133       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746801736103       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746925008857       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746901892155       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746815308665       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746822392242       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746809175982       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746850385565       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746909525840       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746856952461       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746792612548       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746966876428       residual = 2.72e-07           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746945602836       residual = 7.18e-08           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746864009649       residual = 3.65e-07           smallest_sin_value = 9.97e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746965580957       residual = 3.77e-07           smallest_sin_value = 9.91e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.0487e+10 is 3.115730e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.919513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0619e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7841
    reference variance = 0.275933
====================================================
  Execution time = 4.3062e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4830e-01
  Total weights = 1.9643e+06
  Execution time = 5.8918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229769623
                                         uncertainty =       0.002539214770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229769623
                                         uncertainty =       0.002539214770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466467267
  error estimate for blocks of size 2^( 2) =       0.000491779408
  error estimate for blocks of size 2^( 3) =       0.000515460167
  error estimate for blocks of size 2^( 4) =       0.000533333814
  error estimate for blocks of size 2^( 5) =       0.000544980304
  error estimate for blocks of size 2^( 6) =       0.000551589164
  error estimate for blocks of size 2^( 7) =       0.000558476045

      target function =      -0.746739310075
              le_mean =     -22.814384542992
             les_mean =     520.944438840196
             stat err =       0.000547094832
             autocorr =       1.375570571622
   target nu stat err =       0.000547094832
   target dn stat err =       0.003835320257
      target stat err =       0.003229312755
              std dev =       0.659684335674
             le_variance =       0.435183422734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229769623
                                         uncertainty =       0.002539214770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229769623
                                         uncertainty =       0.002539214770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466467267
  error estimate for blocks of size 2^( 2) =       0.000491779408
  error estimate for blocks of size 2^( 3) =       0.000515460167
  error estimate for blocks of size 2^( 4) =       0.000533333814
  error estimate for blocks of size 2^( 5) =       0.000544980304
  error estimate for blocks of size 2^( 6) =       0.000551589164
  error estimate for blocks of size 2^( 7) =       0.000558476045

      target function =      -0.746739310075
              le_mean =     -22.814384542992
             les_mean =     520.944438840195
             stat err =       0.000547094832
             autocorr =       1.375570571623
   target nu stat err =       0.000547094832
   target dn stat err =       0.003835320257
      target stat err =       0.003229312755
              std dev =       0.659684335674
             le_variance =       0.435183422734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229769623
                                         uncertainty =       0.002539214770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229769623
                                         uncertainty =       0.002539214770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466467267
  error estimate for blocks of size 2^( 2) =       0.000491779408
  error estimate for blocks of size 2^( 3) =       0.000515460167
  error estimate for blocks of size 2^( 4) =       0.000533333814
  error estimate for blocks of size 2^( 5) =       0.000544980304
  error estimate for blocks of size 2^( 6) =       0.000551589164
  error estimate for blocks of size 2^( 7) =       0.000558476045

      target function =      -0.746739310075
              le_mean =     -22.814384542992
             les_mean =     520.944438840195
             stat err =       0.000547094832
             autocorr =       1.375570571622
   target nu stat err =       0.000547094832
   target dn stat err =       0.003835320257
      target stat err =       0.003229312755
              std dev =       0.659684335674
             le_variance =       0.435183422734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229769623
                                         uncertainty =       0.002539214770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435229769623
                                         uncertainty =       0.002539214770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466467267
  error estimate for blocks of size 2^( 2) =       0.000491779408
  error estimate for blocks of size 2^( 3) =       0.000515460167
  error estimate for blocks of size 2^( 4) =       0.000533333814
  error estimate for blocks of size 2^( 5) =       0.000544980304
  error estimate for blocks of size 2^( 6) =       0.000551589164
  error estimate for blocks of size 2^( 7) =       0.000558476045

      target function =      -0.746739310075
              le_mean =     -22.814384542992
             les_mean =     520.944438840196
             stat err =       0.000547094832
             autocorr =       1.375570571629
   target nu stat err =       0.000547094832
   target dn stat err =       0.003835320257
      target stat err =       0.003229312755
              std dev =       0.659684335674
             le_variance =       0.435183422734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746739310075        initial
     3.1554e+09     3.1554e+10             4.9767e-14        -0.746739310075  <--
     1.2622e+10     1.2622e+11             1.2450e-14        -0.746739310075
     5.0487e+10     5.0487e+11             3.1157e-15        -0.746739310075

*****************************************************************************
Applying the update for shift_i =   3.1554e+09     and shift_s =   3.1554e+10
*****************************************************************************

  Execution time = 7.2691e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2332e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.8332
    reference variance = 0.206427
====================================================
  Execution time = 4.4172e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5386e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5108e-01
  Total weights = 1.964097299e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.6938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436772265112
                                         uncertainty =       0.001898056998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436772265112
                                         uncertainty =       0.001898056998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467323621
  error estimate for blocks of size 2^( 2) =       0.000492560630
  error estimate for blocks of size 2^( 3) =       0.000515885348
  error estimate for blocks of size 2^( 4) =       0.000533519980
  error estimate for blocks of size 2^( 5) =       0.000544462392
  error estimate for blocks of size 2^( 6) =       0.000551675487
  error estimate for blocks of size 2^( 7) =       0.000560832563

      target function =      -0.744447306765
              le_mean =     -22.813620676412
             les_mean =     520.912367278553
             stat err =       0.000547622606
             autocorr =       1.373179366235
   target nu stat err =       0.000547622606
   target dn stat err =       0.002938692152
      target stat err =       0.002487206076
              std dev =       0.660895402263
             le_variance =       0.436782732732


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281362067641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 7.8886e+08, overlap shift 7.8886e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744454639726       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744454639726       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744454639726       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744454639726       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744454639726       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744454639877       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744455893703       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744455821502       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744454676584       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 7.8886e+08 is 3.276575e-13

solving harmonic davidson linear method for identity shift 3.1554e+09, overlap shift 3.1554e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744454639726       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744454639726       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744454639726       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744454639726       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744454639726       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744454639726       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744454225634       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744457343014       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744453756926       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.1554e+09 is 8.182852e-14

solving harmonic davidson linear method for identity shift 1.2622e+10, overlap shift 1.2622e+11 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744454639726       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744454639726       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744454639726       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744454639726       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744454639726       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744454639660       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744450986005       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744443960414       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744445422925       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744464959154       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744449659065       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744440584379       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744444247518       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744465208618       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744450287266       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744479364733       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744454065443       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744453225505       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744456541969       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744455025586       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744459399130       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744451411118       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744450900391       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744462282191       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2622e+10 is 2.049805e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.933913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1889e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.7729
    reference variance = 0.271625
====================================================
  Execution time = 4.2944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4928e-01
  Total weights = 1.9642e+06
  Execution time = 5.9481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434291150408
                                         uncertainty =       0.001945641681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434291150408
                                         uncertainty =       0.001945641681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465990010
  error estimate for blocks of size 2^( 2) =       0.000491720595
  error estimate for blocks of size 2^( 3) =       0.000515265166
  error estimate for blocks of size 2^( 4) =       0.000532754315
  error estimate for blocks of size 2^( 5) =       0.000545010035
  error estimate for blocks of size 2^( 6) =       0.000550952534
  error estimate for blocks of size 2^( 7) =       0.000552597099

      target function =      -0.745939081068
              le_mean =     -22.815067741777
             les_mean =     520.976592975154
             stat err =       0.000545328496
             autocorr =       1.369503578747
   target nu stat err =       0.000545328496
   target dn stat err =       0.002956376661
      target stat err =       0.002515819829
              std dev =       0.659009392190
             le_variance =       0.434293378994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434291150408
                                         uncertainty =       0.001945641681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434291150408
                                         uncertainty =       0.001945641681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465990010
  error estimate for blocks of size 2^( 2) =       0.000491720595
  error estimate for blocks of size 2^( 3) =       0.000515265166
  error estimate for blocks of size 2^( 4) =       0.000532754315
  error estimate for blocks of size 2^( 5) =       0.000545010035
  error estimate for blocks of size 2^( 6) =       0.000550952534
  error estimate for blocks of size 2^( 7) =       0.000552597099

      target function =      -0.745939081068
              le_mean =     -22.815067741777
             les_mean =     520.976592975154
             stat err =       0.000545328496
             autocorr =       1.369503578749
   target nu stat err =       0.000545328496
   target dn stat err =       0.002956376661
      target stat err =       0.002515819829
              std dev =       0.659009392190
             le_variance =       0.434293378994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434291150408
                                         uncertainty =       0.001945641681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434291150408
                                         uncertainty =       0.001945641681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465990010
  error estimate for blocks of size 2^( 2) =       0.000491720595
  error estimate for blocks of size 2^( 3) =       0.000515265166
  error estimate for blocks of size 2^( 4) =       0.000532754315
  error estimate for blocks of size 2^( 5) =       0.000545010035
  error estimate for blocks of size 2^( 6) =       0.000550952534
  error estimate for blocks of size 2^( 7) =       0.000552597099

      target function =      -0.745939081068
              le_mean =     -22.815067741777
             les_mean =     520.976592975154
             stat err =       0.000545328496
             autocorr =       1.369503578748
   target nu stat err =       0.000545328496
   target dn stat err =       0.002956376661
      target stat err =       0.002515819829
              std dev =       0.659009392190
             le_variance =       0.434293378995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434291150408
                                         uncertainty =       0.001945641681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434291150408
                                         uncertainty =       0.001945641681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465990010
  error estimate for blocks of size 2^( 2) =       0.000491720595
  error estimate for blocks of size 2^( 3) =       0.000515265166
  error estimate for blocks of size 2^( 4) =       0.000532754315
  error estimate for blocks of size 2^( 5) =       0.000545010035
  error estimate for blocks of size 2^( 6) =       0.000550952534
  error estimate for blocks of size 2^( 7) =       0.000552597099

      target function =      -0.745939081068
              le_mean =     -22.815067741777
             les_mean =     520.976592975154
             stat err =       0.000545328496
             autocorr =       1.369503578746
   target nu stat err =       0.000545328496
   target dn stat err =       0.002956376661
      target stat err =       0.002515819829
              std dev =       0.659009392190
             le_variance =       0.434293378994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745939081068        initial
     7.8886e+08     7.8886e+09             3.2766e-13        -0.745939081068  <--
     3.1554e+09     3.1554e+10             8.1829e-14        -0.745939081068
     1.2622e+10     1.2622e+11             2.0498e-14        -0.745939081068

*****************************************************************************
Applying the update for shift_i =   7.8886e+08     and shift_s =   7.8886e+09
*****************************************************************************

  Execution time = 7.2787e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2470e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.8456
    reference variance = 0.387525
====================================================
  Execution time = 4.4220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4652e-01
  Total weights = 1.964420511e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.7042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434647826726
                                         uncertainty =       0.001968481560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434647826726
                                         uncertainty =       0.001968481560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466154137
  error estimate for blocks of size 2^( 2) =       0.000491353853
  error estimate for blocks of size 2^( 3) =       0.000515489574
  error estimate for blocks of size 2^( 4) =       0.000533268159
  error estimate for blocks of size 2^( 5) =       0.000542600532
  error estimate for blocks of size 2^( 6) =       0.000547912053
  error estimate for blocks of size 2^( 7) =       0.000550422996

      target function =      -0.748217260534
              le_mean =     -22.814388616932
             les_mean =     520.942849415289
             stat err =       0.000543550935
             autocorr =       1.359632099947
   target nu stat err =       0.000543550935
   target dn stat err =       0.002718557488
      target stat err =       0.002336457463
              std dev =       0.659241502353
             le_variance =       0.434599358425


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281438861693e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.9722e+08, overlap shift 1.9722e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748223532753       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748223532753       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748223532753       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748223532737       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748223546482       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748223530427       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748223577618       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748223677632       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748223516625       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.9722e+08 is 8.375966e-13

solving harmonic davidson linear method for identity shift 7.8886e+08, overlap shift 7.8886e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748223532753       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748223532753       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748223532753       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748223532753       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748223532753       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748223532753       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748224964804       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748223490457       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748223532753       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 7.8886e+08 is 2.093980e-13

solving harmonic davidson linear method for identity shift 3.1554e+09, overlap shift 3.1554e+10 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748223532753       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748223532753       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748223532753       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748223532753       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748225459618       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748227793865       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748217524179       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748220653461       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748223460693       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.1554e+09 is 5.238589e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.937001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1934e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.803
    reference variance = 0.453475
====================================================
  Execution time = 4.3236e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4643e-01
  Total weights = 1.9646e+06
  Execution time = 5.9392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434362598334
                                         uncertainty =       0.002224364727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434362598334
                                         uncertainty =       0.002224364727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466024103
  error estimate for blocks of size 2^( 2) =       0.000491795019
  error estimate for blocks of size 2^( 3) =       0.000515644227
  error estimate for blocks of size 2^( 4) =       0.000533425010
  error estimate for blocks of size 2^( 5) =       0.000544660581
  error estimate for blocks of size 2^( 6) =       0.000551466175
  error estimate for blocks of size 2^( 7) =       0.000557539556

      target function =      -0.748290189016
              le_mean =     -22.814445873966
             les_mean =     520.945375026869
             stat err =       0.000546772830
             autocorr =       1.376566176145
   target nu stat err =       0.000546772830
   target dn stat err =       0.002684725925
      target stat err =       0.002310897409
              std dev =       0.659057606354
             le_variance =       0.434356928494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434362598334
                                         uncertainty =       0.002224364727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434362598334
                                         uncertainty =       0.002224364727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466024103
  error estimate for blocks of size 2^( 2) =       0.000491795019
  error estimate for blocks of size 2^( 3) =       0.000515644227
  error estimate for blocks of size 2^( 4) =       0.000533425010
  error estimate for blocks of size 2^( 5) =       0.000544660581
  error estimate for blocks of size 2^( 6) =       0.000551466175
  error estimate for blocks of size 2^( 7) =       0.000557539556

      target function =      -0.748290189016
              le_mean =     -22.814445873966
             les_mean =     520.945375026868
             stat err =       0.000546772830
             autocorr =       1.376566176151
   target nu stat err =       0.000546772830
   target dn stat err =       0.002684725925
      target stat err =       0.002310897409
              std dev =       0.659057606354
             le_variance =       0.434356928494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434362598334
                                         uncertainty =       0.002224364727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434362598334
                                         uncertainty =       0.002224364727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466024103
  error estimate for blocks of size 2^( 2) =       0.000491795019
  error estimate for blocks of size 2^( 3) =       0.000515644227
  error estimate for blocks of size 2^( 4) =       0.000533425010
  error estimate for blocks of size 2^( 5) =       0.000544660581
  error estimate for blocks of size 2^( 6) =       0.000551466175
  error estimate for blocks of size 2^( 7) =       0.000557539556

      target function =      -0.748290189016
              le_mean =     -22.814445873966
             les_mean =     520.945375026869
             stat err =       0.000546772830
             autocorr =       1.376566176150
   target nu stat err =       0.000546772830
   target dn stat err =       0.002684725925
      target stat err =       0.002310897409
              std dev =       0.659057606354
             le_variance =       0.434356928494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434362598334
                                         uncertainty =       0.002224364727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434362598334
                                         uncertainty =       0.002224364727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466024103
  error estimate for blocks of size 2^( 2) =       0.000491795019
  error estimate for blocks of size 2^( 3) =       0.000515644227
  error estimate for blocks of size 2^( 4) =       0.000533425010
  error estimate for blocks of size 2^( 5) =       0.000544660581
  error estimate for blocks of size 2^( 6) =       0.000551466175
  error estimate for blocks of size 2^( 7) =       0.000557539556

      target function =      -0.748290189016
              le_mean =     -22.814445873966
             les_mean =     520.945375026869
             stat err =       0.000546772830
             autocorr =       1.376566176145
   target nu stat err =       0.000546772830
   target dn stat err =       0.002684725925
      target stat err =       0.002310897409
              std dev =       0.659057606355
             le_variance =       0.434356928494


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748290189016        initial
     1.9722e+08     1.9722e+09             8.3760e-13        -0.748290189016  <--
     7.8886e+08     7.8886e+09             2.0940e-13        -0.748290189016
     3.1554e+09     3.1554e+10             5.2386e-14        -0.748290189016

*****************************************************************************
Applying the update for shift_i =   1.9722e+08     and shift_s =   1.9722e+09
*****************************************************************************

  Execution time = 7.6270e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2821e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.8343
    reference variance = 0.22897
====================================================
  Execution time = 4.4248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5003e-01
  Total weights = 1.964249289e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 7.8385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435577738671
                                         uncertainty =       0.002016416646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435577738671
                                         uncertainty =       0.002016416646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466677647
  error estimate for blocks of size 2^( 2) =       0.000492211125
  error estimate for blocks of size 2^( 3) =       0.000516430307
  error estimate for blocks of size 2^( 4) =       0.000533794809
  error estimate for blocks of size 2^( 5) =       0.000544344430
  error estimate for blocks of size 2^( 6) =       0.000549791161
  error estimate for blocks of size 2^( 7) =       0.000553698981

      target function =      -0.745315078526
              le_mean =     -22.814294608334
             les_mean =     520.942065712897
             stat err =       0.000545407345
             autocorr =       1.365865594372
   target nu stat err =       0.000545407345
   target dn stat err =       0.003089501256
      target stat err =       0.002615461687
              std dev =       0.659981858345
             le_variance =       0.435576053345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281429460833e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.9304e+07, overlap shift 4.9304e+08 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745323353463       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745323353464       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745323353464       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745323353464       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745323353464       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745323359321       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745323368924       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745323364845       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745323385102       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745323286511       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.9304e+07 is 5.031552e-12

solving harmonic davidson linear method for identity shift 1.9722e+08, overlap shift 1.9722e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745323353463       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745323353463       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745323353463       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745323353463       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745323285135       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745323353047       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745323470947       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745323685760       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745323478679       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745323386641       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.9722e+08 is 1.257972e-12

solving harmonic davidson linear method for identity shift 7.8886e+08, overlap shift 7.8886e+09 and omega -2.3489e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745323353463       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745323353463       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745323353463       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745323353463       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745323353466       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745323353999       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745323038484       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745323461182       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745324136862       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745323496529       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 7.8886e+08 is 3.144748e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.945301 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.2105e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.7723
    reference variance = 0.28924
====================================================
  Execution time = 4.3139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4893e-01
  Total weights = 1.9641e+06
  Execution time = 5.9514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435156955229
                                         uncertainty =       0.001803813212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435156955229
                                         uncertainty =       0.001803813212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466501142
  error estimate for blocks of size 2^( 2) =       0.000492026387
  error estimate for blocks of size 2^( 3) =       0.000515619845
  error estimate for blocks of size 2^( 4) =       0.000532895855
  error estimate for blocks of size 2^( 5) =       0.000542792126
  error estimate for blocks of size 2^( 6) =       0.000548390107
  error estimate for blocks of size 2^( 7) =       0.000550714521

      target function =      -0.746224817748
              le_mean =     -22.815056868125
             les_mean =     520.975752832685
             stat err =       0.000543698152
             autocorr =       1.358345636767
   target nu stat err =       0.000543698152
   target dn stat err =       0.002663979008
      target stat err =       0.002283239185
              std dev =       0.659732241682
             le_variance =       0.435246630715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435156955228
                                         uncertainty =       0.001803813212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435156955228
                                         uncertainty =       0.001803813212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466501142
  error estimate for blocks of size 2^( 2) =       0.000492026387
  error estimate for blocks of size 2^( 3) =       0.000515619845
  error estimate for blocks of size 2^( 4) =       0.000532895855
  error estimate for blocks of size 2^( 5) =       0.000542792126
  error estimate for blocks of size 2^( 6) =       0.000548390107
  error estimate for blocks of size 2^( 7) =       0.000550714521

      target function =      -0.746224817760
              le_mean =     -22.815056868125
             les_mean =     520.975752832670
             stat err =       0.000543698152
             autocorr =       1.358345636764
   target nu stat err =       0.000543698152
   target dn stat err =       0.002663979008
      target stat err =       0.002283239184
              std dev =       0.659732241682
             le_variance =       0.435246630715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435156955228
                                         uncertainty =       0.001803813212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435156955228
                                         uncertainty =       0.001803813212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466501142
  error estimate for blocks of size 2^( 2) =       0.000492026387
  error estimate for blocks of size 2^( 3) =       0.000515619845
  error estimate for blocks of size 2^( 4) =       0.000532895855
  error estimate for blocks of size 2^( 5) =       0.000542792126
  error estimate for blocks of size 2^( 6) =       0.000548390107
  error estimate for blocks of size 2^( 7) =       0.000550714521

      target function =      -0.746224817754
              le_mean =     -22.815056868125
             les_mean =     520.975752832677
             stat err =       0.000543698152
             autocorr =       1.358345636768
   target nu stat err =       0.000543698152
   target dn stat err =       0.002663979008
      target stat err =       0.002283239185
              std dev =       0.659732241682
             le_variance =       0.435246630715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435156955229
                                         uncertainty =       0.001803813212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435156955229
                                         uncertainty =       0.001803813212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466501142
  error estimate for blocks of size 2^( 2) =       0.000492026387
  error estimate for blocks of size 2^( 3) =       0.000515619845
  error estimate for blocks of size 2^( 4) =       0.000532895855
  error estimate for blocks of size 2^( 5) =       0.000542792126
  error estimate for blocks of size 2^( 6) =       0.000548390107
  error estimate for blocks of size 2^( 7) =       0.000550714521

      target function =      -0.746224817748
              le_mean =     -22.815056868125
             les_mean =     520.975752832684
             stat err =       0.000543698152
             autocorr =       1.358345636765
   target nu stat err =       0.000543698152
   target dn stat err =       0.002663979008
      target stat err =       0.002283239185
              std dev =       0.659732241682
             le_variance =       0.435246630715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746224817748        initial
     4.9304e+07     4.9304e+08             5.0316e-12        -0.746224817760  <--
     1.9722e+08     1.9722e+09             1.2580e-12        -0.746224817754
     7.8886e+08     7.8886e+09             3.1447e-13        -0.746224817748

*****************************************************************************
Applying the update for shift_i =   4.9304e+07     and shift_s =   4.9304e+08
*****************************************************************************

  Execution time = 7.2998e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_01                 1.272725e-01 3 1  ON 0
ci_02                -2.888017e-02 3 1  ON 1
ci_03                -2.898795e-02 3 1  ON 2
ci_04                 2.690903e-02 3 1  ON 3
ci_05                -2.207724e-02 3 1  ON 4
ci_06                -2.176959e-02 3 1  ON 5
ci_07                 2.738805e-02 3 1  ON 6
ci_08                -5.571447e-03 3 1  ON 7
ci_09                -9.045233e-03 3 1  ON 8
ci_10                -8.352748e-03 3 1  ON 9
ci_11                 1.321804e-02 3 1  ON 10
ci_12                 6.948869e-03 3 1  ON 11
ci_13                 1.283206e-02 3 1  ON 12
ci_14                 1.270874e-02 3 1  ON 13
ci_15                 6.266772e-03 3 1  ON 14
ci_16                 6.426478e-03 3 1  ON 15
ci_17                -7.244560e-03 3 1  ON 16
ci_18                -5.940935e-03 3 1  ON 17
ci_19                 9.299852e-03 3 1  ON 18
ci_20                 6.395003e-03 3 1  ON 19
ci_21                 9.004898e-03 3 1  ON 20
ci_22                 8.266021e-03 3 1  ON 21
ci_23                 4.757139e-03 3 1  ON 22
ci_24                 3.984855e-03 3 1  ON 23
ci_25                 2.848372e-03 3 1  ON 24
ci_26                 3.136289e-03 3 1  ON 25
ci_27                 3.318403e-03 3 1  ON 26
ci_28                 1.933033e-03 3 1  ON 27
ci_29                 1.306979e-03 3 1  ON 28
ci_30                -1.833573e-03 3 1  ON 29
ci_31                -5.581225e-04 3 1  ON 30
ci_32                -8.464151e-04 3 1  ON 31
ci_33                -1.467113e-03 3 1  ON 32
ci_34                 1.138001e-03 3 1  ON 33
ci_35                 1.456797e-03 3 1  ON 34
ci_36                -1.024419e-03 3 1  ON 35
ci_37                -1.031573e-03 3 1  ON 36
ci_38                -7.685006e-04 3 1  ON 37
ci_39                -6.245777e-04 3 1  ON 38
ci_40                -1.561243e-03 3 1  ON 39
ci_41                -1.248559e-03 3 1  ON 40
ci_42                -1.167570e-03 3 1  ON 41
ci_43                -2.482019e-03 3 1  ON 42
ci_44                -3.239155e-03 3 1  ON 43
ci_45                -5.273458e-04 3 1  ON 44
ci_46                -8.693925e-04 3 1  ON 45
ci_47                 1.538428e-03 3 1  ON 46
ci_48                 1.377256e-03 3 1  ON 47
ci_49                -1.040618e-03 3 1  ON 48
ci_50                -8.119844e-04 3 1  ON 49
ci_51                 1.439385e-04 3 1  ON 50
ci_52                 8.067296e-05 3 1  ON 51
ci_53                -6.382993e-04 3 1  ON 52
ci_54                -1.026822e-03 3 1  ON 53
ci_55                -6.525814e-04 3 1  ON 54
ci_56                 2.626587e-03 3 1  ON 55
ci_57                 1.624732e-03 3 1  ON 56
ci_58                -1.114392e-03 3 1  ON 57
ci_59                -1.466006e-03 3 1  ON 58
ci_60                 5.428189e-04 3 1  ON 59
ci_61                -1.294346e-04 3 1  ON 60
ci_62                -6.662225e-04 3 1  ON 61
ci_63                -7.728168e-04 3 1  ON 62
ci_64                -2.632761e-04 3 1  ON 63
ci_65                 6.161000e-05 3 1  ON 64
ci_66                -7.127209e-04 3 1  ON 65
ci_67                -8.949474e-04 3 1  ON 66
ci_68                -1.372092e-03 3 1  ON 67
ci_69                 1.317656e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2516e+02 secs
  Total Execution time = 1.2490e+04 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
