Rank =    0  Free Memory = 89763 MB
Rank =    1  Free Memory = 89763 MB
Rank =    2  Free Memory = 89763 MB
Rank =    3  Free Memory = 89763 MB
Rank =    4  Free Memory = 89762 MB
Rank =    5  Free Memory = 89762 MB
Rank =    6  Free Memory = 89762 MB
Rank =    7  Free Memory = 89762 MB
Rank =    8  Free Memory = 89762 MB
Rank =    9  Free Memory = 89762 MB
Rank =   10  Free Memory = 89761 MB
Rank =   11  Free Memory = 89761 MB
Rank =   12  Free Memory = 89761 MB
Rank =   13  Free Memory = 89761 MB
Rank =   14  Free Memory = 89760 MB
Rank =   15  Free Memory = 89747 MB
Rank =   16  Free Memory = 89747 MB
Rank =   17  Free Memory = 89747 MB
Rank =   18  Free Memory = 89746 MB
Rank =   19  Free Memory = 89746 MB
Rank =   20  Free Memory = 89746 MB
Rank =   21  Free Memory = 89746 MB
Rank =   22  Free Memory = 89746 MB
Rank =   23  Free Memory = 89746 MB
Rank =   24  Free Memory = 89746 MB
Rank =   25  Free Memory = 89746 MB
Rank =   26  Free Memory = 89746 MB
Rank =   27  Free Memory = 89746 MB
Rank =   28  Free Memory = 89746 MB
Rank =   29  Free Memory = 89746 MB
Rank =   30  Free Memory = 89746 MB
Rank =   31  Free Memory = 89746 MB
Rank =   32  Free Memory = 73709 MB
Rank =   33  Free Memory = 73709 MB
Rank =   34  Free Memory = 73709 MB
Rank =   35  Free Memory = 73709 MB
Rank =   36  Free Memory = 73709 MB
Rank =   37  Free Memory = 73709 MB
Rank =   38  Free Memory = 73709 MB
Rank =   39  Free Memory = 73709 MB
Rank =   40  Free Memory = 73709 MB
Rank =   41  Free Memory = 73709 MB
Rank =   42  Free Memory = 73709 MB
Rank =   43  Free Memory = 73709 MB
Rank =   44  Free Memory = 73709 MB
Rank =   45  Free Memory = 73709 MB
Rank =   46  Free Memory = 73709 MB
Rank =   47  Free Memory = 73709 MB
Rank =   48  Free Memory = 73709 MB
Rank =   49  Free Memory = 73709 MB
Rank =   50  Free Memory = 73709 MB
Rank =   51  Free Memory = 73709 MB
Rank =   52  Free Memory = 73709 MB
Rank =   53  Free Memory = 73709 MB
Rank =   54  Free Memory = 73709 MB
Rank =   55  Free Memory = 73709 MB
Rank =   56  Free Memory = 73709 MB
Rank =   57  Free Memory = 73709 MB
Rank =   58  Free Memory = 73709 MB
Rank =   59  Free Memory = 73709 MB
Rank =   60  Free Memory = 73709 MB
Rank =   61  Free Memory = 73709 MB
Rank =   62  Free Memory = 73709 MB
Rank =   63  Free Memory = 73709 MB
Rank =   64  Free Memory = 87456 MB
Rank =   65  Free Memory = 87456 MB
Rank =   66  Free Memory = 87456 MB
Rank =   67  Free Memory = 87456 MB
Rank =   68  Free Memory = 87456 MB
Rank =   69  Free Memory = 87456 MB
Rank =   70  Free Memory = 87456 MB
Rank =   71  Free Memory = 87456 MB
Rank =   72  Free Memory = 87456 MB
Rank =   73  Free Memory = 87456 MB
Rank =   74  Free Memory = 87456 MB
Rank =   75  Free Memory = 87456 MB
Rank =   76  Free Memory = 87456 MB
Rank =   77  Free Memory = 87456 MB
Rank =   78  Free Memory = 87456 MB
Rank =   79  Free Memory = 87456 MB
Rank =   80  Free Memory = 87456 MB
Rank =   81  Free Memory = 87456 MB
Rank =   82  Free Memory = 87456 MB
Rank =   83  Free Memory = 87456 MB
Rank =   84  Free Memory = 87456 MB
Rank =   85  Free Memory = 87456 MB
Rank =   86  Free Memory = 87456 MB
Rank =   87  Free Memory = 87456 MB
Rank =   88  Free Memory = 87456 MB
Rank =   89  Free Memory = 87456 MB
Rank =   90  Free Memory = 87456 MB
Rank =   91  Free Memory = 87456 MB
Rank =   92  Free Memory = 87456 MB
Rank =   93  Free Memory = 87456 MB
Rank =   94  Free Memory = 87456 MB
Rank =   95  Free Memory = 87456 MB
Rank =   96  Free Memory = 89586 MB
Rank =   97  Free Memory = 89586 MB
Rank =   98  Free Memory = 89586 MB
Rank =   99  Free Memory = 89586 MB
Rank =  100  Free Memory = 89586 MB
Rank =  101  Free Memory = 89586 MB
Rank =  102  Free Memory = 89586 MB
Rank =  103  Free Memory = 89586 MB
Rank =  104  Free Memory = 89586 MB
Rank =  105  Free Memory = 89586 MB
Rank =  106  Free Memory = 89586 MB
Rank =  107  Free Memory = 89586 MB
Rank =  108  Free Memory = 89586 MB
Rank =  109  Free Memory = 89586 MB
Rank =  110  Free Memory = 89586 MB
Rank =  111  Free Memory = 89586 MB
Rank =  112  Free Memory = 89586 MB
Rank =  113  Free Memory = 89586 MB
Rank =  114  Free Memory = 89586 MB
Rank =  115  Free Memory = 89586 MB
Rank =  116  Free Memory = 89586 MB
Rank =  117  Free Memory = 89586 MB
Rank =  118  Free Memory = 89586 MB
Rank =  119  Free Memory = 89586 MB
Rank =  120  Free Memory = 89586 MB
Rank =  121  Free Memory = 89586 MB
Rank =  122  Free Memory = 89586 MB
Rank =  123  Free Memory = 89586 MB
Rank =  124  Free Memory = 89586 MB
Rank =  125  Free Memory = 89586 MB
Rank =  126  Free Memory = 89586 MB
Rank =  127  Free Memory = 89586 MB
  Input file(s): opt_form_gs_tett_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run001d.xml

  Project = FORM
  date    = 2023-03-16 00:03:35 PDT
  host    = n0114.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 839

  Range of prime numbers to use as seeds over processors and threads = 6481-7639


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.624554e-01    1         1  ON     0
     uu_1                 1.011863e-01    1         1  ON     1
     uu_2                 3.659226e-03    1         1  ON     2
     uu_3                -5.375161e-02    1         1  ON     3
     uu_4                -8.591702e-02    1         1  ON     4
     uu_5                -1.029990e-01    1         1  ON     5
     uu_6                -1.108447e-01    1         1  ON     6
     uu_7                -1.087609e-01    1         1  ON     7
     uu_8                -9.325173e-02    1         1  ON     8
     uu_9                -5.957390e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.378549e-01    1         1  ON     0
     ud_1                 9.967815e-02    1         1  ON     1
     ud_2                -1.443990e-02    1         1  ON     2
     ud_3                -7.376538e-02    1         1  ON     3
     ud_4                -1.061181e-01    1         1  ON     4
     ud_5                -1.224040e-01    1         1  ON     5
     ud_6                -1.277130e-01    1         1  ON     6
     ud_7                -1.191873e-01    1         1  ON     7
     ud_8                -9.272569e-02    1         1  ON     8
     ud_9                -4.447679e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.563379e-01    1         1  ON     0
     eC_1                -3.182912e-01    1         1  ON     1
     eC_2                -6.732177e-02    1         1  ON     2
     eC_3                 9.506706e-02    1         1  ON     3
     eC_4                 1.375986e-01    1         1  ON     4
     eC_5                 1.931335e-01    1         1  ON     5
     eC_6                 2.098757e-01    1         1  ON     6
     eC_7                 1.661996e-01    1         1  ON     7
     eC_8                 3.840237e-02    1         1  ON     8
     eC_9                 1.377137e-03    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.227972e-01    1         1  ON     0
     eO_1                -5.297360e-01    1         1  ON     1
     eO_2                -1.492259e-01    1         1  ON     2
     eO_3                 1.025706e-01    1         1  ON     3
     eO_4                 2.270539e-01    1         1  ON     4
     eO_5                 3.212686e-01    1         1  ON     5
     eO_6                 3.347758e-01    1         1  ON     6
     eO_7                 3.060194e-01    1         1  ON     7
     eO_8                 1.433530e-01    1         1  ON     8
     eO_9                 3.830540e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.277008e-01    1         1  ON     0
     eH1_1                -3.779999e-02    1         1  ON     1
     eH1_2                -1.874707e-02    1         1  ON     2
     eH1_3                -3.712827e-02    1         1  ON     3
     eH1_4                -1.241675e-02    1         1  ON     4
     eH1_5                 8.974315e-03    1         1  ON     5
     eH1_6                 5.391205e-02    1         1  ON     6
     eH1_7                 6.334551e-02    1         1  ON     7
     eH1_8                 6.498479e-02    1         1  ON     8
     eH1_9                 4.352531e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.183001e-01    1         1  ON     0
     eH2_1                -2.576170e-02    1         1  ON     1
     eH2_2                -1.319036e-02    1         1  ON     2
     eH2_3                -3.560919e-02    1         1  ON     3
     eH2_4                -1.653925e-02    1         1  ON     4
     eH2_5                 7.920534e-03    1         1  ON     5
     eH2_6                 4.215155e-02    1         1  ON     6
     eH2_7                 4.045401e-02    1         1  ON     7
     eH2_8                 5.493390e-02    1         1  ON     8
     eH2_9                 5.404523e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.781052e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 6.8079e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8883
    reference variance = 0.495282
====================================================
  Execution time = 4.4690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4897e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4762e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448997064542
                                         uncertainty =       0.002742159765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448997064542
                                         uncertainty =       0.002742159765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473798024
  error estimate for blocks of size 2^( 2) =       0.000499136412
  error estimate for blocks of size 2^( 3) =       0.000522596066
  error estimate for blocks of size 2^( 4) =       0.000539693162
  error estimate for blocks of size 2^( 5) =       0.000550955511
  error estimate for blocks of size 2^( 6) =       0.000559249891
  error estimate for blocks of size 2^( 7) =       0.000561169514

      target function =      -0.746095911168
              le_mean =     -22.816050114423
             les_mean =     521.021111734150
             stat err =       0.000552767020
             autocorr =       1.361124203654
   target nu stat err =       0.000552767020
   target dn stat err =       0.003010766725
      target stat err =       0.002619923311
              std dev =       0.670051591127
             le_variance =       0.448969134771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281605011442e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746104258261       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746141406667       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746159573669       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746165025585       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746170305604       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746173209322       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746176524441       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746180788004       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746182136521       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746185021361       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746186102421       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746188198642       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746191462969       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746193119679       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746195222560       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746196330283       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746197481500       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746198926182       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746200580233       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746202156559       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746202726510       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746202776705       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746203059401       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746203172076       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746204071837       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746204055571       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746204295723       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746204298445       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746204291847       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746204242730       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746204286244       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746204312856       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746204328052       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746204335444       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 3.204138e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746104258261       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746115128797       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746120396785       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746121982478       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746123531479       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746124302400       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746125275780       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746126426029       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746126775040       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746127611566       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746128010408       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746128559581       residual = 6.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746129304553       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746129722685       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746130283317       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746130734348       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746130956229       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746131347506       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746131765944       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746132115320       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746132254378       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746132252620       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746132309844       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746132339580       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746132533856       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746132523085       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746132571001       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746132569170       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746132566599       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746132554911       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746132564483       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746132569461       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 8.574934e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746104258261       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746107096884       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746108469140       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746108882176       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746109286902       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746109482529       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746109737510       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746110030253       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746110119947       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746110335503       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746110442126       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746110583775       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746110749653       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746110871136       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746111024665       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746111141488       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746111205821       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746111300599       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746111391416       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746111476146       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746111510390       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746111509111       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746111522436       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746111530170       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746111576576       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746111573419       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746111584571       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746111583998       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746111583305       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746111580488       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746111582785       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746111583937       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 2.185780e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169332 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9629e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.625216e-01                 1 1 ON  0
uu_1  1.012965e-01                 1 1 ON  1
uu_2  3.713338e-03                 1 1 ON  2
uu_3  -5.374362e-02                1 1 ON  3
uu_4  -8.594638e-02                1 1 ON  4
uu_5  -1.030917e-01                1 1 ON  5
uu_6  -1.109624e-01                1 1 ON  6
uu_7  -1.088324e-01                1 1 ON  7
uu_8  -9.312174e-02                1 1 ON  8
uu_9  -5.936387e-02                1 1 ON  9
ud_0  3.381796e-01                 1 1 ON  10
ud_1  9.983561e-02                 1 1 ON  11
ud_2  -1.441289e-02                1 1 ON  12
ud_3  -7.379240e-02                1 1 ON  13
ud_4  -1.061404e-01                1 1 ON  14
ud_5  -1.224481e-01                1 1 ON  15
ud_6  -1.277177e-01                1 1 ON  16
ud_7  -1.191853e-01                1 1 ON  17
ud_8  -9.287923e-02                1 1 ON  18
ud_9  -4.475722e-02                1 1 ON  19
eC_0  -4.567197e-01                1 1 ON  20
eC_1  -3.185508e-01                1 1 ON  21
eC_2  -6.763548e-02                1 1 ON  22
eC_3  9.482310e-02                 1 1 ON  23
eC_4  1.375461e-01                 1 1 ON  24
eC_5  1.931462e-01                 1 1 ON  25
eC_6  2.102768e-01                 1 1 ON  26
eC_7  1.668169e-01                 1 1 ON  27
eC_8  3.861526e-02                 1 1 ON  28
eC_9  1.390384e-03                 1 1 ON  29
eO_0  -8.236547e-01                1 1 ON  30
eO_1  -5.302694e-01                1 1 ON  31
eO_2  -1.494335e-01                1 1 ON  32
eO_3  1.025908e-01                 1 1 ON  33
eO_4  2.272838e-01                 1 1 ON  34
eO_5  3.213868e-01                 1 1 ON  35
eO_6  3.348860e-01                 1 1 ON  36
eO_7  3.061867e-01                 1 1 ON  37
eO_8  1.440123e-01                 1 1 ON  38
eO_9  3.860749e-02                 1 1 ON  39
eH1_0 -1.279125e-01                1 1 ON  40
eH1_1 -3.789342e-02                1 1 ON  41
eH1_2 -1.887475e-02                1 1 ON  42
eH1_3 -3.708387e-02                1 1 ON  43
eH1_4 -1.239405e-02                1 1 ON  44
eH1_5 9.209994e-03                 1 1 ON  45
eH1_6 5.378843e-02                 1 1 ON  46
eH1_7 6.310275e-02                 1 1 ON  47
eH1_8 6.506975e-02                 1 1 ON  48
eH1_9 4.380843e-02                 1 1 ON  49
eH2_0 -1.185089e-01                1 1 ON  50
eH2_1 -2.616897e-02                1 1 ON  51
eH2_2 -1.339994e-02                1 1 ON  52
eH2_3 -3.567740e-02                1 1 ON  53
eH2_4 -1.649272e-02                1 1 ON  54
eH2_5 7.927696e-03                 1 1 ON  55
eH2_6 4.219165e-02                 1 1 ON  56
eH2_7 4.086792e-02                 1 1 ON  57
eH2_8 5.508781e-02                 1 1 ON  58
eH2_9 5.420700e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8866
    reference variance = 0.508076
====================================================
  Execution time = 4.3097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4766e-01
  Total weights = 2.0000e+06
  Execution time = 4.4676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447694805362
                                         uncertainty =       0.003636993354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447694805362
                                         uncertainty =       0.003636993354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473093143
  error estimate for blocks of size 2^( 2) =       0.000498049493
  error estimate for blocks of size 2^( 3) =       0.000521382057
  error estimate for blocks of size 2^( 4) =       0.000537685535
  error estimate for blocks of size 2^( 5) =       0.000547385650
  error estimate for blocks of size 2^( 6) =       0.000553233145
  error estimate for blocks of size 2^( 7) =       0.000555134182

      target function =      -0.747246351058
              le_mean =     -22.814439352093
             les_mean =     520.946276970723
             stat err =       0.000548359628
             autocorr =       1.343499902114
   target nu stat err =       0.000548359628
   target dn stat err =       0.003846078114
      target stat err =       0.003310616230
              std dev =       0.669054739337
             le_variance =       0.447634244229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447815799991
                                         uncertainty =       0.003654988712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447815799991
                                         uncertainty =       0.003654988712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473156722
  error estimate for blocks of size 2^( 2) =       0.000497987644
  error estimate for blocks of size 2^( 3) =       0.000521209986
  error estimate for blocks of size 2^( 4) =       0.000537436187
  error estimate for blocks of size 2^( 5) =       0.000547091663
  error estimate for blocks of size 2^( 6) =       0.000552896947
  error estimate for blocks of size 2^( 7) =       0.000554784390

      target function =      -0.747144477953
              le_mean =     -22.814440608219
             les_mean =     520.946454609283
             stat err =       0.000548052297
             autocorr =       1.341633752542
   target nu stat err =       0.000548052297
   target dn stat err =       0.003864427724
      target stat err =       0.003324908662
              std dev =       0.669144653409
             le_variance =       0.447754567186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447757505405
                                         uncertainty =       0.003647318965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447757505405
                                         uncertainty =       0.003647318965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473126072
  error estimate for blocks of size 2^( 2) =       0.000498011224
  error estimate for blocks of size 2^( 3) =       0.000521281685
  error estimate for blocks of size 2^( 4) =       0.000537542068
  error estimate for blocks of size 2^( 5) =       0.000547217787
  error estimate for blocks of size 2^( 6) =       0.000553042020
  error estimate for blocks of size 2^( 7) =       0.000554935746

      target function =      -0.747193595832
              le_mean =     -22.814438916418
             les_mean =     520.946319406925
             stat err =       0.000548184405
             autocorr =       1.342454552150
   target nu stat err =       0.000548184405
   target dn stat err =       0.003856619604
      target stat err =       0.003318872394
              std dev =       0.669101307574
             le_variance =       0.447696559797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447702194007
                                         uncertainty =       0.003638333259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447702194007
                                         uncertainty =       0.003638333259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473097021
  error estimate for blocks of size 2^( 2) =       0.000498044124
  error estimate for blocks of size 2^( 3) =       0.000521368641
  error estimate for blocks of size 2^( 4) =       0.000537666550
  error estimate for blocks of size 2^( 5) =       0.000547363529
  error estimate for blocks of size 2^( 6) =       0.000553208031
  error estimate for blocks of size 2^( 7) =       0.000555108138

      target function =      -0.747240139067
              le_mean =     -22.814439152463
             les_mean =     520.946275200603
             stat err =       0.000548336562
             autocorr =       1.343364855798
   target nu stat err =       0.000548336562
   target dn stat err =       0.003847446451
      target stat err =       0.003311692754
              std dev =       0.669060223742
             le_variance =       0.447641582993


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747246351058        initial  <--
     2.5000e-01     2.5000e+00             3.2041e-03        -0.747144477953
     1.0000e+00     1.0000e+01             8.5749e-04        -0.747193595832
     4.0000e+00     4.0000e+01             2.1858e-04        -0.747240139067

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8512
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2149e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6961
    reference variance = 0.451085
====================================================
  Execution time = 4.5914e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5448e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5394e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454372339497
                                         uncertainty =       0.004225921953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454372339497
                                         uncertainty =       0.004225921953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476699564
  error estimate for blocks of size 2^( 2) =       0.000501653760
  error estimate for blocks of size 2^( 3) =       0.000524964626
  error estimate for blocks of size 2^( 4) =       0.000542309586
  error estimate for blocks of size 2^( 5) =       0.000554206411
  error estimate for blocks of size 2^( 6) =       0.000560106234
  error estimate for blocks of size 2^( 7) =       0.000562334381

      target function =      -0.741485141787
              le_mean =     -22.814839064528
             les_mean =     520.971366261047
             stat err =       0.000554739153
             autocorr =       1.354216587958
   target nu stat err =       0.000554739153
   target dn stat err =       0.004341287838
      target stat err =       0.003669797077
              std dev =       0.674154988104
             le_variance =       0.454484947986


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281483906453e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741502537512       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741506326481       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741510211706       residual = 9.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741511084829       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741511766234       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741512329076       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741512620558       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741513160023       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741513450756       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741513696434       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741513965352       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741514195131       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741514420284       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741514848130       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741514957253       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741515314361       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741515401190       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741515425044       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741515433013       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741515545536       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741515657427       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741515737669       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741515824957       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741515833595       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741515837384       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741515847934       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741515850379       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741515862594       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741515862980       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741515856721       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741515853621       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741515853015       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 3.990525e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741502537512       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741503502260       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741504488053       residual = 9.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741504710828       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741504884665       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741505025907       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741505100306       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741505235353       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741505310834       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741505372198       residual = 9.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741505441226       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741505499065       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741505555765       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741505664150       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741505691721       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741505781156       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741505802706       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741505808472       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741505810329       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741505838228       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741505866149       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741505886158       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741505907907       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741505909726       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741505910612       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741505913116       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741505913696       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741505916702       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741505916744       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741505915209       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741505914464       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 1.005683e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741502537512       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741502779818       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741503027188       residual = 9.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741503083170       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741503126856       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741503162195       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741503180894       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741503214667       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741503233718       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741503249053       residual = 9.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741503266424       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741503280908       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741503295110       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741503322296       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741503329207       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741503351575       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741503356952       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741503358381       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741503358837       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741503365797       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741503372774       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741503377772       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741503383204       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741503383638       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741503383856       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741503384473       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741503384617       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741503385365       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741503385372       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741503384990       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741503384806       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+01 is 2.518909e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1347e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.624810e-01 1 1  ON 0
 uu_1                 1.012078e-01 1 1  ON 1
 uu_2                 3.670436e-03 1 1  ON 2
 uu_3                -5.374876e-02 1 1  ON 3
 uu_4                -8.591878e-02 1 1  ON 4
 uu_5                -1.030126e-01 1 1  ON 5
 uu_6                -1.108664e-01 1 1  ON 6
 uu_7                -1.087747e-01 1 1  ON 7
 uu_8                -9.325827e-02 1 1  ON 8
 uu_9                -5.955884e-02 1 1  ON 9
 ud_0                 3.378769e-01 1 1  ON 10
 ud_1                 9.969131e-02 1 1  ON 11
 ud_2                -1.444542e-02 1 1  ON 12
 ud_3                -7.377268e-02 1 1  ON 13
 ud_4                -1.061248e-01 1 1  ON 14
 ud_5                -1.224117e-01 1 1  ON 15
 ud_6                -1.277134e-01 1 1  ON 16
 ud_7                -1.191905e-01 1 1  ON 17
 ud_8                -9.273475e-02 1 1  ON 18
 ud_9                -4.449149e-02 1 1  ON 19
 eC_0                -4.563875e-01 1 1  ON 20
 eC_1                -3.183183e-01 1 1  ON 21
 eC_2                -6.734732e-02 1 1  ON 22
 eC_3                 9.505202e-02 1 1  ON 23
 eC_4                 1.376107e-01 1 1  ON 24
 eC_5                 1.931612e-01 1 1  ON 25
 eC_6                 2.098898e-01 1 1  ON 26
 eC_7                 1.662451e-01 1 1  ON 27
 eC_8                 3.842530e-02 1 1  ON 28
 eC_9                 1.372640e-03 1 1  ON 29
 eO_0                -8.228978e-01 1 1  ON 30
 eO_1                -5.298036e-01 1 1  ON 31
 eO_2                -1.492549e-01 1 1  ON 32
 eO_3                 1.025651e-01 1 1  ON 33
 eO_4                 2.270767e-01 1 1  ON 34
 eO_5                 3.212864e-01 1 1  ON 35
 eO_6                 3.347905e-01 1 1  ON 36
 eO_7                 3.060677e-01 1 1  ON 37
 eO_8                 1.434231e-01 1 1  ON 38
 eO_9                 3.833362e-02 1 1  ON 39
eH1_0                -1.276985e-01 1 1  ON 40
eH1_1                -3.779035e-02 1 1  ON 41
eH1_2                -1.875139e-02 1 1  ON 42
eH1_3                -3.713015e-02 1 1  ON 43
eH1_4                -1.241742e-02 1 1  ON 44
eH1_5                 9.000183e-03 1 1  ON 45
eH1_6                 5.390117e-02 1 1  ON 46
eH1_7                 6.333160e-02 1 1  ON 47
eH1_8                 6.496065e-02 1 1  ON 48
eH1_9                 4.354026e-02 1 1  ON 49
eH2_0                -1.183214e-01 1 1  ON 50
eH2_1                -2.579190e-02 1 1  ON 51
eH2_2                -1.320929e-02 1 1  ON 52
eH2_3                -3.560881e-02 1 1  ON 53
eH2_4                -1.653510e-02 1 1  ON 54
eH2_5                 7.921834e-03 1 1  ON 55
eH2_6                 4.215967e-02 1 1  ON 56
eH2_7                 4.049257e-02 1 1  ON 57
eH2_8                 5.493376e-02 1 1  ON 58
eH2_9                 5.405868e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.9493
    reference variance = 0.394454
====================================================
  Execution time = 4.3925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5224e-01
  Total weights = 2.0000e+06
  Execution time = 3.5634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452282018393
                                         uncertainty =       0.003728426788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452282018393
                                         uncertainty =       0.003728426788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475516529
  error estimate for blocks of size 2^( 2) =       0.000500151143
  error estimate for blocks of size 2^( 3) =       0.000523316157
  error estimate for blocks of size 2^( 4) =       0.000539537827
  error estimate for blocks of size 2^( 5) =       0.000550799403
  error estimate for blocks of size 2^( 6) =       0.000557686443
  error estimate for blocks of size 2^( 7) =       0.000558032643

      target function =      -0.743383614384
              le_mean =     -22.814220437836
             les_mean =     520.940885898417
             stat err =       0.000551514079
             autocorr =       1.345184864684
   target nu stat err =       0.000551514079
   target dn stat err =       0.003810060544
      target stat err =       0.003247081517
              std dev =       0.672481924190
             le_variance =       0.452231938363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452310637049
                                         uncertainty =       0.003730132718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452310637049
                                         uncertainty =       0.003730132718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475531562
  error estimate for blocks of size 2^( 2) =       0.000500149903
  error estimate for blocks of size 2^( 3) =       0.000523300325
  error estimate for blocks of size 2^( 4) =       0.000539512005
  error estimate for blocks of size 2^( 5) =       0.000550768103
  error estimate for blocks of size 2^( 6) =       0.000557651676
  error estimate for blocks of size 2^( 7) =       0.000557995017

      target function =      -0.743359695450
              le_mean =     -22.814219911211
             les_mean =     520.940890463202
             stat err =       0.000551481700
             autocorr =       1.344941883093
   target nu stat err =       0.000551481700
   target dn stat err =       0.003811610974
      target stat err =       0.003248139872
              std dev =       0.672503183820
             le_variance =       0.452260532248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452296499840
                                         uncertainty =       0.003729292609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452296499840
                                         uncertainty =       0.003729292609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475524136
  error estimate for blocks of size 2^( 2) =       0.000500150504
  error estimate for blocks of size 2^( 3) =       0.000523308130
  error estimate for blocks of size 2^( 4) =       0.000539524746
  error estimate for blocks of size 2^( 5) =       0.000550783559
  error estimate for blocks of size 2^( 6) =       0.000557668850
  error estimate for blocks of size 2^( 7) =       0.000558013603

      target function =      -0.743371511182
              le_mean =     -22.814220157202
             les_mean =     520.940887562392
             stat err =       0.000551497689
             autocorr =       1.345061879835
   target nu stat err =       0.000551497689
   target dn stat err =       0.003810847289
      target stat err =       0.003247618818
              std dev =       0.672492681907
             le_variance =       0.452246407218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452283826003
                                         uncertainty =       0.003728535355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452283826003
                                         uncertainty =       0.003728535355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475517478
  error estimate for blocks of size 2^( 2) =       0.000500151058
  error estimate for blocks of size 2^( 3) =       0.000523315145
  error estimate for blocks of size 2^( 4) =       0.000539536181
  error estimate for blocks of size 2^( 5) =       0.000550797411
  error estimate for blocks of size 2^( 6) =       0.000557684232
  error estimate for blocks of size 2^( 7) =       0.000558030250

      target function =      -0.743382103650
              le_mean =     -22.814220400970
             les_mean =     520.940886022292
             stat err =       0.000551512018
             autocorr =       1.345169438898
   target nu stat err =       0.000551512018
   target dn stat err =       0.003810159201
      target stat err =       0.003247148946
              std dev =       0.672483266999
             le_variance =       0.452233744393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743383614384        initial  <--
     2.5000e+00     2.5000e+01             3.9905e-04        -0.743359695450
     1.0000e+01     1.0000e+02             1.0057e-04        -0.743371511182
     4.0000e+01     4.0000e+02             2.5189e-05        -0.743382103650

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.7332
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2309e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2855e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8614
    reference variance = 0.509242
====================================================
  Execution time = 4.3745e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5974e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4830e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459732666937
                                         uncertainty =       0.012133067376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459732666937
                                         uncertainty =       0.012133067376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479447440
  error estimate for blocks of size 2^( 2) =       0.000504130444
  error estimate for blocks of size 2^( 3) =       0.000527510048
  error estimate for blocks of size 2^( 4) =       0.000544885914
  error estimate for blocks of size 2^( 5) =       0.000555990992
  error estimate for blocks of size 2^( 6) =       0.000561592452
  error estimate for blocks of size 2^( 7) =       0.000565053631

      target function =      -0.737030159089
              le_mean =     -22.814234759460
             les_mean =     520.949047125460
             stat err =       0.000556880747
             autocorr =       1.349094583775
   target nu stat err =       0.000556880747
   target dn stat err =       0.012359038491
      target stat err =       0.010183631563
              std dev =       0.678041072190
             le_variance =       0.459739695577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281423475946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737168561835       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737170407187       residual = 7.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737171357522       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737171917505       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737172680193       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737172832918       residual = 8.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737173112028       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737173393547       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737173637806       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737173810082       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737173893623       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737173946645       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.737174122321       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.737174257132       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.737174346690       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.737174381766       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.737174425378       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.737174452867       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.737174518664       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737174551226       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.737174594691       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.737174625531       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.737174643443       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.737174655141       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.737174666600       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.737174670266       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.737174669823       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.737174672595       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.737174674720       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.737174674158       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.737174673874       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.737174674081       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.737174673871       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.737174674192       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.737174674136       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 1.106821e-04

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737168561835       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737169023820       residual = 7.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737169261764       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737169401892       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737169592776       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737169630995       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737169700952       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737169771297       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737169832411       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737169875527       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737169896426       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737169909688       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.737169953714       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.737169987391       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.737170009777       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.737170018489       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.737170029377       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.737170036260       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.737170052712       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737170060890       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.737170071810       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.737170079389       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.737170083864       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.737170086778       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.737170089633       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.737170090542       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.737170090430       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.737170091123       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.737170091652       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.737170091511       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.737170091441       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.737170091492       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.737170091439       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.737170091519       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.737170091506       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         34 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 2.765756e-05

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737168561835       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737168677372       residual = 7.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737168736880       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737168771921       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737168819655       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737168829212       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737168846713       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737168864297       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737168879578       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737168890360       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737168895586       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737168898902       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.737168909914       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.737168918333       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.737168923928       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.737168926104       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.737168928823       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.737168930546       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.737168934658       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737168936705       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.737168939441       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.737168941326       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.737168942445       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.737168943172       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.737168943885       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.737168944114       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.737168944083       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.737168944257       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.737168944391       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.737168944354       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.737168944337       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.737168944349       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.737168944336       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.737168944356       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+02 is 6.917624e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8624e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.624534e-01 1 1  ON 0
 uu_1                 1.011848e-01 1 1  ON 1
 uu_2                 3.657612e-03 1 1  ON 2
 uu_3                -5.375419e-02 1 1  ON 3
 uu_4                -8.592008e-02 1 1  ON 4
 uu_5                -1.030022e-01 1 1  ON 5
 uu_6                -1.108448e-01 1 1  ON 6
 uu_7                -1.087545e-01 1 1  ON 7
 uu_8                -9.324059e-02 1 1  ON 8
 uu_9                -5.956946e-02 1 1  ON 9
 ud_0                 3.378558e-01 1 1  ON 10
 ud_1                 9.967663e-02 1 1  ON 11
 ud_2                -1.444287e-02 1 1  ON 12
 ud_3                -7.376932e-02 1 1  ON 13
 ud_4                -1.061222e-01 1 1  ON 14
 ud_5                -1.224083e-01 1 1  ON 15
 ud_6                -1.277179e-01 1 1  ON 16
 ud_7                -1.191925e-01 1 1  ON 17
 ud_8                -9.272838e-02 1 1  ON 18
 ud_9                -4.447142e-02 1 1  ON 19
 eC_0                -4.563424e-01 1 1  ON 20
 eC_1                -3.182948e-01 1 1  ON 21
 eC_2                -6.732599e-02 1 1  ON 22
 eC_3                 9.506449e-02 1 1  ON 23
 eC_4                 1.375998e-01 1 1  ON 24
 eC_5                 1.931300e-01 1 1  ON 25
 eC_6                 2.098859e-01 1 1  ON 26
 eC_7                 1.662074e-01 1 1  ON 27
 eC_8                 3.840249e-02 1 1  ON 28
 eC_9                 1.376412e-03 1 1  ON 29
 eO_0                -8.228086e-01 1 1  ON 30
 eO_1                -5.297445e-01 1 1  ON 31
 eO_2                -1.492311e-01 1 1  ON 32
 eO_3                 1.025672e-01 1 1  ON 33
 eO_4                 2.270531e-01 1 1  ON 34
 eO_5                 3.212681e-01 1 1  ON 35
 eO_6                 3.347724e-01 1 1  ON 36
 eO_7                 3.060226e-01 1 1  ON 37
 eO_8                 1.433807e-01 1 1  ON 38
 eO_9                 3.830814e-02 1 1  ON 39
eH1_0                -1.276980e-01 1 1  ON 40
eH1_1                -3.779643e-02 1 1  ON 41
eH1_2                -1.874692e-02 1 1  ON 42
eH1_3                -3.712567e-02 1 1  ON 43
eH1_4                -1.241394e-02 1 1  ON 44
eH1_5                 8.977272e-03 1 1  ON 45
eH1_6                 5.391037e-02 1 1  ON 46
eH1_7                 6.334126e-02 1 1  ON 47
eH1_8                 6.497783e-02 1 1  ON 48
eH1_9                 4.352434e-02 1 1  ON 49
eH2_0                -1.183046e-01 1 1  ON 50
eH2_1                -2.576680e-02 1 1  ON 51
eH2_2                -1.319431e-02 1 1  ON 52
eH2_3                -3.561205e-02 1 1  ON 53
eH2_4                -1.653833e-02 1 1  ON 54
eH2_5                 7.921611e-03 1 1  ON 55
eH2_6                 4.215396e-02 1 1  ON 56
eH2_7                 4.046715e-02 1 1  ON 57
eH2_8                 5.493322e-02 1 1  ON 58
eH2_9                 5.404465e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8096
    reference variance = 0.312422
====================================================
  Execution time = 4.3297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4531e-01
  Total weights = 2.0000e+06
  Execution time = 3.5657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445372314127
                                         uncertainty =       0.002132849765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445372314127
                                         uncertainty =       0.002132849765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471864608
  error estimate for blocks of size 2^( 2) =       0.000497075826
  error estimate for blocks of size 2^( 3) =       0.000520672070
  error estimate for blocks of size 2^( 4) =       0.000537600577
  error estimate for blocks of size 2^( 5) =       0.000548896439
  error estimate for blocks of size 2^( 6) =       0.000554574239
  error estimate for blocks of size 2^( 7) =       0.000556280336

      target function =      -0.749202205564
              le_mean =     -22.815980677177
             les_mean =     521.014286454648
             stat err =       0.000549337898
             autocorr =       1.355327697956
   target nu stat err =       0.000549337898
   target dn stat err =       0.002555543243
      target stat err =       0.002264999385
              std dev =       0.667317327794
             le_variance =       0.445312415974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445373127075
                                         uncertainty =       0.002132982951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445373127075
                                         uncertainty =       0.002132982951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471865037
  error estimate for blocks of size 2^( 2) =       0.000497074201
  error estimate for blocks of size 2^( 3) =       0.000520668090
  error estimate for blocks of size 2^( 4) =       0.000537594423
  error estimate for blocks of size 2^( 5) =       0.000548888111
  error estimate for blocks of size 2^( 6) =       0.000554564481
  error estimate for blocks of size 2^( 7) =       0.000556270123

      target function =      -0.749201516076
              le_mean =     -22.815980641829
             les_mean =     521.014285651048
             stat err =       0.000549329284
             autocorr =       1.355282733842
   target nu stat err =       0.000549329284
   target dn stat err =       0.002555621003
      target stat err =       0.002265056231
              std dev =       0.667317934276
             le_variance =       0.445313225406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445372719306
                                         uncertainty =       0.002132916413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445372719306
                                         uncertainty =       0.002132916413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471864821
  error estimate for blocks of size 2^( 2) =       0.000497075012
  error estimate for blocks of size 2^( 3) =       0.000520670078
  error estimate for blocks of size 2^( 4) =       0.000537597497
  error estimate for blocks of size 2^( 5) =       0.000548892272
  error estimate for blocks of size 2^( 6) =       0.000554569357
  error estimate for blocks of size 2^( 7) =       0.000556275226

      target function =      -0.749201861936
              le_mean =     -22.815980658653
             les_mean =     521.014286012786
             stat err =       0.000549333588
             autocorr =       1.355305204221
   target nu stat err =       0.000549333588
   target dn stat err =       0.002555582157
      target stat err =       0.002265027838
              std dev =       0.667317630064
             le_variance =       0.445312819395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445372364381
                                         uncertainty =       0.002132858089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445372364381
                                         uncertainty =       0.002132858089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471864634
  error estimate for blocks of size 2^( 2) =       0.000497075724
  error estimate for blocks of size 2^( 3) =       0.000520671821
  error estimate for blocks of size 2^( 4) =       0.000537600192
  error estimate for blocks of size 2^( 5) =       0.000548895918
  error estimate for blocks of size 2^( 6) =       0.000554573628
  error estimate for blocks of size 2^( 7) =       0.000556279697

      target function =      -0.749202162947
              le_mean =     -22.815980674786
             les_mean =     521.014286395571
             stat err =       0.000549337359
             autocorr =       1.355324886585
   target nu stat err =       0.000549337359
   target dn stat err =       0.002555548099
      target stat err =       0.002265002936
              std dev =       0.667317365283
             le_variance =       0.445312466008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749202205564        initial  <--
     2.5000e+01     2.5000e+02             1.1068e-04        -0.749201516076
     1.0000e+02     1.0000e+03             2.7658e-05        -0.749201861936
     4.0000e+02     4.0000e+03             6.9176e-06        -0.749202162947

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1220
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1975e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2849e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8485
    reference variance = 0.410097
====================================================
  Execution time = 4.5986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5404e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5138e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454108514549
                                         uncertainty =       0.003738449451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454108514549
                                         uncertainty =       0.003738449451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476467447
  error estimate for blocks of size 2^( 2) =       0.000501521512
  error estimate for blocks of size 2^( 3) =       0.000524748594
  error estimate for blocks of size 2^( 4) =       0.000541743443
  error estimate for blocks of size 2^( 5) =       0.000553083710
  error estimate for blocks of size 2^( 6) =       0.000560509079
  error estimate for blocks of size 2^( 7) =       0.000564155630

      target function =      -0.741865691820
              le_mean =     -22.814506068652
             les_mean =     520.955729385122
             stat err =       0.000554872965
             autocorr =       1.356190390759
   target nu stat err =       0.000554872965
   target dn stat err =       0.003870206456
      target stat err =       0.003285405851
              std dev =       0.673826725203
             le_variance =       0.454042455597


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281450606865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741879006475       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741879040535       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741879068561       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741879082336       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741879092648       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741879098483       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741879104230       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741879108833       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741879112761       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741879117074       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741879117878       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741879123158       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741879125950       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741879128689       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741879131093       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741879131970       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741879132795       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741879132925       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741879134534       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741879136765       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741879137881       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741879138156       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741879138180       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741879138266       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741879138484       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741879138561       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741879138602       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741879138776       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741879138727       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741879138692       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741879138769       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741879138793       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741879138775       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 3.754992e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741879006475       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741879014991       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741879021999       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741879025444       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741879028022       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741879029481       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741879030918       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741879032069       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741879033049       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741879034129       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741879034330       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741879035649       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741879036349       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741879037032       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741879037627       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741879037854       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741879038061       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741879038091       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741879038495       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741879039053       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741879039334       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741879039397       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741879039404       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741879039426       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741879039482       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741879039499       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741879039508       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741879039557       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741879039544       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741879039531       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741879039552       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741879039560       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741879039556       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+03 is 9.388164e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741879006475       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741879008604       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741879010356       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741879011217       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741879011865       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741879012227       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741879012587       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741879012873       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741879013109       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741879013391       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741879013433       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741879013762       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741879013939       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741879014114       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741879014270       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741879014323       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741879014369       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741879014372       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741879014462       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741879014623       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741879014684       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741879014700       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741879014717       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741879014710       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741879014715       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741879014719       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741879014726       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741879014732       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741879014736       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741879014724       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741879014748       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741879014747       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741879014752       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+03 is 2.347084e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1167e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.624555e-01 1 1  ON 0
 uu_1                 1.011864e-01 1 1  ON 1
 uu_2                 3.659304e-03 1 1  ON 2
 uu_3                -5.375158e-02 1 1  ON 3
 uu_4                -8.591704e-02 1 1  ON 4
 uu_5                -1.029992e-01 1 1  ON 5
 uu_6                -1.108448e-01 1 1  ON 6
 uu_7                -1.087610e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957364e-02 1 1  ON 9
 ud_0                 3.378551e-01 1 1  ON 10
 ud_1                 9.967823e-02 1 1  ON 11
 ud_2                -1.443994e-02 1 1  ON 12
 ud_3                -7.376545e-02 1 1  ON 13
 ud_4                -1.061182e-01 1 1  ON 14
 ud_5                -1.224041e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191872e-01 1 1  ON 17
 ud_8                -9.272567e-02 1 1  ON 18
 ud_9                -4.447709e-02 1 1  ON 19
 eC_0                -4.563382e-01 1 1  ON 20
 eC_1                -3.182915e-01 1 1  ON 21
 eC_2                -6.732205e-02 1 1  ON 22
 eC_3                 9.506671e-02 1 1  ON 23
 eC_4                 1.375985e-01 1 1  ON 24
 eC_5                 1.931337e-01 1 1  ON 25
 eC_6                 2.098760e-01 1 1  ON 26
 eC_7                 1.662002e-01 1 1  ON 27
 eC_8                 3.840261e-02 1 1  ON 28
 eC_9                 1.377100e-03 1 1  ON 29
 eO_0                -8.227982e-01 1 1  ON 30
 eO_1                -5.297366e-01 1 1  ON 31
 eO_2                -1.492261e-01 1 1  ON 32
 eO_3                 1.025707e-01 1 1  ON 33
 eO_4                 2.270542e-01 1 1  ON 34
 eO_5                 3.212689e-01 1 1  ON 35
 eO_6                 3.347759e-01 1 1  ON 36
 eO_7                 3.060195e-01 1 1  ON 37
 eO_8                 1.433536e-01 1 1  ON 38
 eO_9                 3.830578e-02 1 1  ON 39
eH1_0                -1.277011e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874708e-02 1 1  ON 42
eH1_3                -3.712826e-02 1 1  ON 43
eH1_4                -1.241674e-02 1 1  ON 44
eH1_5                 8.974646e-03 1 1  ON 45
eH1_6                 5.391199e-02 1 1  ON 46
eH1_7                 6.334525e-02 1 1  ON 47
eH1_8                 6.498472e-02 1 1  ON 48
eH1_9                 4.352551e-02 1 1  ON 49
eH2_0                -1.183006e-01 1 1  ON 50
eH2_1                -2.576223e-02 1 1  ON 51
eH2_2                -1.319063e-02 1 1  ON 52
eH2_3                -3.560924e-02 1 1  ON 53
eH2_4                -1.653908e-02 1 1  ON 54
eH2_5                 7.920686e-03 1 1  ON 55
eH2_6                 4.215170e-02 1 1  ON 56
eH2_7                 4.045441e-02 1 1  ON 57
eH2_8                 5.493408e-02 1 1  ON 58
eH2_9                 5.404541e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8621
    reference variance = 0.282465
====================================================
  Execution time = 4.5608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5282e-01
  Total weights = 2.0000e+06
  Execution time = 3.5467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452919209227
                                         uncertainty =       0.005719458370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452919209227
                                         uncertainty =       0.005719458370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475826954
  error estimate for blocks of size 2^( 2) =       0.000500508302
  error estimate for blocks of size 2^( 3) =       0.000523388113
  error estimate for blocks of size 2^( 4) =       0.000539609346
  error estimate for blocks of size 2^( 5) =       0.000550829721
  error estimate for blocks of size 2^( 6) =       0.000555921856
  error estimate for blocks of size 2^( 7) =       0.000558902212

      target function =      -0.742859076002
              le_mean =     -22.814888805480
             les_mean =     520.971973560350
             stat err =       0.000551315784
             autocorr =       1.342464384525
   target nu stat err =       0.000551315784
   target dn stat err =       0.005696470935
      target stat err =       0.004803713545
              std dev =       0.672920931726
             le_variance =       0.452822580355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452919300581
                                         uncertainty =       0.005719478670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452919300581
                                         uncertainty =       0.005719478670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475827002
  error estimate for blocks of size 2^( 2) =       0.000500508214
  error estimate for blocks of size 2^( 3) =       0.000523387891
  error estimate for blocks of size 2^( 4) =       0.000539609041
  error estimate for blocks of size 2^( 5) =       0.000550829347
  error estimate for blocks of size 2^( 6) =       0.000555921448
  error estimate for blocks of size 2^( 7) =       0.000558901834

      target function =      -0.742858999468
              le_mean =     -22.814888808351
             les_mean =     520.971973782613
             stat err =       0.000551315417
             autocorr =       1.342462330389
   target nu stat err =       0.000551315417
   target dn stat err =       0.005696487443
      target stat err =       0.004803726220
              std dev =       0.672920999522
             le_variance =       0.452822671598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452919254903
                                         uncertainty =       0.005719468521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452919254903
                                         uncertainty =       0.005719468521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475826978
  error estimate for blocks of size 2^( 2) =       0.000500508258
  error estimate for blocks of size 2^( 3) =       0.000523388002
  error estimate for blocks of size 2^( 4) =       0.000539609193
  error estimate for blocks of size 2^( 5) =       0.000550829534
  error estimate for blocks of size 2^( 6) =       0.000555921652
  error estimate for blocks of size 2^( 7) =       0.000558902023

      target function =      -0.742859037736
              le_mean =     -22.814888806914
             les_mean =     520.971973671424
             stat err =       0.000551315601
             autocorr =       1.342463357338
   target nu stat err =       0.000551315601
   target dn stat err =       0.005696479190
      target stat err =       0.004803719883
              std dev =       0.672920965624
             le_variance =       0.452822625976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452919214936
                                         uncertainty =       0.005719459639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452919214936
                                         uncertainty =       0.005719459639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475826957
  error estimate for blocks of size 2^( 2) =       0.000500508296
  error estimate for blocks of size 2^( 3) =       0.000523388099
  error estimate for blocks of size 2^( 4) =       0.000539609327
  error estimate for blocks of size 2^( 5) =       0.000550829697
  error estimate for blocks of size 2^( 6) =       0.000555921830
  error estimate for blocks of size 2^( 7) =       0.000558902189

      target function =      -0.742859071219
              le_mean =     -22.814888805659
             les_mean =     520.971973574227
             stat err =       0.000551315761
             autocorr =       1.342464256123
   target nu stat err =       0.000551315761
   target dn stat err =       0.005696471967
      target stat err =       0.004803714337
              std dev =       0.672920935963
             le_variance =       0.452822586057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742859076002        initial  <--
     2.5000e+02     2.5000e+03             3.7550e-06        -0.742858999468
     1.0000e+03     1.0000e+04             9.3882e-07        -0.742859037736
     4.0000e+03     4.0000e+04             2.3471e-07        -0.742859071219

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3448
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2452e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2850e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8504
    reference variance = 0.283576
====================================================
  Execution time = 4.4940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6096e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4959e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461029158970
                                         uncertainty =       0.011415671695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461029158970
                                         uncertainty =       0.011415671695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480083223
  error estimate for blocks of size 2^( 2) =       0.000504419784
  error estimate for blocks of size 2^( 3) =       0.000526879575
  error estimate for blocks of size 2^( 4) =       0.000543090459
  error estimate for blocks of size 2^( 5) =       0.000554279504
  error estimate for blocks of size 2^( 6) =       0.000559841034
  error estimate for blocks of size 2^( 7) =       0.000565301085

      target function =      -0.736051789362
              le_mean =     -22.814083610978
             les_mean =     520.943370580994
             stat err =       0.000555628021
             autocorr =       1.339476871276
   target nu stat err =       0.000555628021
   target dn stat err =       0.011489403664
      target stat err =       0.009442268055
              std dev =       0.678940205585
             le_variance =       0.460959802760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281408361098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736170853913       residual = 7.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736170860263       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736170864110       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736170868107       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736170870131       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736170871660       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736170873248       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736170874139       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736170875399       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736170876203       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736170877234       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736170877866       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736170878641       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736170879023       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736170879622       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736170879986       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736170880297       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736170880671       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736170880891       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736170881011       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736170881082       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736170881111       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736170881132       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736170881226       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736170881257       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736170881296       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736170881303       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736170881304       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736170881316       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736170881303       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736170881311       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.736170881314       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.736170881326       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.736170881305       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 5.331948e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736170853913       residual = 7.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736170855500       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736170856462       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736170857466       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736170857959       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736170858334       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736170858746       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736170858969       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736170859285       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736170859486       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736170859744       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736170859898       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736170860072       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736170860165       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736170860363       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736170860414       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736170860518       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736170860584       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736170860673       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736170860675       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736170860689       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736170860721       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736170860683       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736170860721       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736170860724       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736170860742       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736170860735       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736170860727       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736170860792       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736170860802       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736170860752       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.736170860795       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.736170860738       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.736170860763       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+04 is 1.332999e-07

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736170853913       residual = 7.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736170854310       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736170854550       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736170854786       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736170854995       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736170855003       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736170855016       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736170855169       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736170855223       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736170855278       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736170855371       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736170855342       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736170855405       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736170855432       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736170855486       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736170855516       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736170855613       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736170855542       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736170855602       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736170855619       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736170855577       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736170855623       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736170855801       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736170855605       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736170855594       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736170855654       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736170855566       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736170855538       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736170855636       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736170855729       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736170855680       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.736170855587       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.736170855476       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.736170855593       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+04 is 3.332506e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9946e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659235e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591703e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108448e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325172e-02 1 1  ON 8
 uu_9                -5.957389e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967818e-02 1 1  ON 11
 ud_2                -1.443989e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272571e-02 1 1  ON 18
 ud_9                -4.447682e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732179e-02 1 1  ON 22
 eC_3                 9.506703e-02 1 1  ON 23
 eC_4                 1.375987e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840239e-02 1 1  ON 28
 eC_9                 1.377140e-03 1 1  ON 29
 eO_0                -8.227974e-01 1 1  ON 30
 eO_1                -5.297361e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212687e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433531e-01 1 1  ON 38
 eO_9                 3.830541e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779994e-02 1 1  ON 41
eH1_2                -1.874704e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974313e-03 1 1  ON 45
eH1_6                 5.391200e-02 1 1  ON 46
eH1_7                 6.334543e-02 1 1  ON 47
eH1_8                 6.498478e-02 1 1  ON 48
eH1_9                 4.352533e-02 1 1  ON 49
eH2_0                -1.183002e-01 1 1  ON 50
eH2_1                -2.576177e-02 1 1  ON 51
eH2_2                -1.319041e-02 1 1  ON 52
eH2_3                -3.560920e-02 1 1  ON 53
eH2_4                -1.653921e-02 1 1  ON 54
eH2_5                 7.920583e-03 1 1  ON 55
eH2_6                 4.215161e-02 1 1  ON 56
eH2_7                 4.045404e-02 1 1  ON 57
eH2_8                 5.493391e-02 1 1  ON 58
eH2_9                 5.404524e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7726
    reference variance = 0.405214
====================================================
  Execution time = 4.3284e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4493e-01
  Total weights = 2.0000e+06
  Execution time = 3.5594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444928685302
                                         uncertainty =       0.003588158917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444928685302
                                         uncertainty =       0.003588158917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471664382
  error estimate for blocks of size 2^( 2) =       0.000496602413
  error estimate for blocks of size 2^( 3) =       0.000519878222
  error estimate for blocks of size 2^( 4) =       0.000537505850
  error estimate for blocks of size 2^( 5) =       0.000547440862
  error estimate for blocks of size 2^( 6) =       0.000551683149
  error estimate for blocks of size 2^( 7) =       0.000554573592

      target function =      -0.749522825239
              le_mean =     -22.815562444988
             les_mean =     520.994824036624
             stat err =       0.000547800863
             autocorr =       1.348898470681
   target nu stat err =       0.000547800863
   target dn stat err =       0.003717674780
      target stat err =       0.003228587079
              std dev =       0.667034165497
             le_variance =       0.444934577941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444928728292
                                         uncertainty =       0.003588159498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444928728292
                                         uncertainty =       0.003588159498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471664404
  error estimate for blocks of size 2^( 2) =       0.000496602422
  error estimate for blocks of size 2^( 3) =       0.000519878218
  error estimate for blocks of size 2^( 4) =       0.000537505837
  error estimate for blocks of size 2^( 5) =       0.000547440845
  error estimate for blocks of size 2^( 6) =       0.000551683135
  error estimate for blocks of size 2^( 7) =       0.000554573575

      target function =      -0.749522788585
              le_mean =     -22.815562445748
             les_mean =     520.994824114290
             stat err =       0.000547800848
             autocorr =       1.348898264484
   target nu stat err =       0.000547800848
   target dn stat err =       0.003717675054
      target stat err =       0.003228586999
              std dev =       0.667034197730
             le_variance =       0.444934620942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444928706797
                                         uncertainty =       0.003588159207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444928706797
                                         uncertainty =       0.003588159207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471664393
  error estimate for blocks of size 2^( 2) =       0.000496602418
  error estimate for blocks of size 2^( 3) =       0.000519878220
  error estimate for blocks of size 2^( 4) =       0.000537505843
  error estimate for blocks of size 2^( 5) =       0.000547440854
  error estimate for blocks of size 2^( 6) =       0.000551683142
  error estimate for blocks of size 2^( 7) =       0.000554573584

      target function =      -0.749522806912
              le_mean =     -22.815562445368
             les_mean =     520.994824075456
             stat err =       0.000547800856
             autocorr =       1.348898367576
   target nu stat err =       0.000547800856
   target dn stat err =       0.003717674917
      target stat err =       0.003228587039
              std dev =       0.667034181614
             le_variance =       0.444934599442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444928687989
                                         uncertainty =       0.003588158953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444928687989
                                         uncertainty =       0.003588158953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471664383
  error estimate for blocks of size 2^( 2) =       0.000496602414
  error estimate for blocks of size 2^( 3) =       0.000519878222
  error estimate for blocks of size 2^( 4) =       0.000537505849
  error estimate for blocks of size 2^( 5) =       0.000547440861
  error estimate for blocks of size 2^( 6) =       0.000551683148
  error estimate for blocks of size 2^( 7) =       0.000554573591

      target function =      -0.749522822948
              le_mean =     -22.815562445036
             les_mean =     520.994824041478
             stat err =       0.000547800862
             autocorr =       1.348898457795
   target nu stat err =       0.000547800862
   target dn stat err =       0.003717674797
      target stat err =       0.003228587074
              std dev =       0.667034167512
             le_variance =       0.444934580628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749522825239        initial  <--
     2.5000e+03     2.5000e+04             5.3319e-07        -0.749522788585
     1.0000e+04     1.0000e+05             1.3330e-07        -0.749522806912
     4.0000e+04     4.0000e+05             3.3325e-08        -0.749522822948

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0669
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2102e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2842e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8194
    reference variance = 0.315568
====================================================
  Execution time = 4.4226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4316e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4877e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267377618
                                         uncertainty =       0.002530313332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267377618
                                         uncertainty =       0.002530313332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470725499
  error estimate for blocks of size 2^( 2) =       0.000495705712
  error estimate for blocks of size 2^( 3) =       0.000519018519
  error estimate for blocks of size 2^( 4) =       0.000535903653
  error estimate for blocks of size 2^( 5) =       0.000546435229
  error estimate for blocks of size 2^( 6) =       0.000552131384
  error estimate for blocks of size 2^( 7) =       0.000554777176

      target function =      -0.751053821273
              le_mean =     -22.814283269065
             les_mean =     520.934685850699
             stat err =       0.000547311861
             autocorr =       1.351867943893
   target nu stat err =       0.000547311861
   target dn stat err =       0.002520972512
      target stat err =       0.002240925837
              std dev =       0.665706385090
             le_variance =       0.443164991149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281428326906e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751059442148       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751059442538       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751059442840       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751059442981       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751059443070       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751059443173       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751059443235       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751059443319       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751059443392       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751059443393       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751059443473       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751059443491       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751059443444       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751059443521       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751059443544       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751059443555       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751059443546       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751059443630       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751059443612       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751059443665       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751059443611       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751059443569       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751059443652       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751059443666       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751059443623       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751059443664       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751059443704       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751059443693       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751059443732       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751059443687       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751059443635       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.751059443715       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 4.947907e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751059442148       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751059442246       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751059442321       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751059442358       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751059442346       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751059442478       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751059442464       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751059442350       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751059442458       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751059442233       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751059442431       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751059442341       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751059442619       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751059442501       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751059442722       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751059442610       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751059442437       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751059442527       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751059442326       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751059442546       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751059442377       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751059442657       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751059442172       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751059442942       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751059442255       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751059442726       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751059442536       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751059442653       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751059442214       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751059442438       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751059442286       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.751059442816       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+05 is 1.236978e-08

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751059442148       residual = 4.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751059442173       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751059442191       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751059442200       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751059442624       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751059441939       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751059442331       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751059443093       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751059442688       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751059441886       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751059440362       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751059440870       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751059442056       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751059441413       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751059441940       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.751059442275       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.751059441473       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751059443095       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751059441862       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751059442911       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751059440419       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751059442726       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751059442354       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.751059442887       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751059440858       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.751059442145       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751059442568       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751059443040       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751059441759       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751059439581       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.751059441291       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.751059443818       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+05 is 3.092445e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360418 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9143e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227973e-01 1 1  ON 30
 eO_1                -5.297361e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779998e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974316e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334550e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920536e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7386
    reference variance = 0.494384
====================================================
  Execution time = 4.5252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5134e-01
  Total weights = 2.0000e+06
  Execution time = 3.5414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451397001696
                                         uncertainty =       0.005009542781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451397001696
                                         uncertainty =       0.005009542781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475047371
  error estimate for blocks of size 2^( 2) =       0.000499534708
  error estimate for blocks of size 2^( 3) =       0.000522740231
  error estimate for blocks of size 2^( 4) =       0.000539597533
  error estimate for blocks of size 2^( 5) =       0.000549710680
  error estimate for blocks of size 2^( 6) =       0.000556164181
  error estimate for blocks of size 2^( 7) =       0.000559112622

      target function =      -0.744122635662
              le_mean =     -22.814156260551
             les_mean =     520.937065664147
             stat err =       0.000551146254
             autocorr =       1.346045939017
   target nu stat err =       0.000551146254
   target dn stat err =       0.004890063252
      target stat err =       0.004145206364
              std dev =       0.671818434519
             le_variance =       0.451340008960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451397003792
                                         uncertainty =       0.005009543232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451397003792
                                         uncertainty =       0.005009543232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475047372
  error estimate for blocks of size 2^( 2) =       0.000499534707
  error estimate for blocks of size 2^( 3) =       0.000522740228
  error estimate for blocks of size 2^( 4) =       0.000539597529
  error estimate for blocks of size 2^( 5) =       0.000549710675
  error estimate for blocks of size 2^( 6) =       0.000556164175
  error estimate for blocks of size 2^( 7) =       0.000559112616

      target function =      -0.744122633903
              le_mean =     -22.814156260629
             les_mean =     520.937065669768
             stat err =       0.000551146249
             autocorr =       1.346045907998
   target nu stat err =       0.000551146249
   target dn stat err =       0.004890063686
      target stat err =       0.004145206704
              std dev =       0.671818436076
             le_variance =       0.451340011051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451397002744
                                         uncertainty =       0.005009543007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451397002744
                                         uncertainty =       0.005009543007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475047371
  error estimate for blocks of size 2^( 2) =       0.000499534708
  error estimate for blocks of size 2^( 3) =       0.000522740230
  error estimate for blocks of size 2^( 4) =       0.000539597531
  error estimate for blocks of size 2^( 5) =       0.000549710677
  error estimate for blocks of size 2^( 6) =       0.000556164178
  error estimate for blocks of size 2^( 7) =       0.000559112619

      target function =      -0.744122634783
              le_mean =     -22.814156260590
             les_mean =     520.937065666957
             stat err =       0.000551146251
             autocorr =       1.346045923508
   target nu stat err =       0.000551146251
   target dn stat err =       0.004890063469
      target stat err =       0.004145206534
              std dev =       0.671818435297
             le_variance =       0.451340010005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451397001827
                                         uncertainty =       0.005009542809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451397001827
                                         uncertainty =       0.005009542809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475047371
  error estimate for blocks of size 2^( 2) =       0.000499534708
  error estimate for blocks of size 2^( 3) =       0.000522740231
  error estimate for blocks of size 2^( 4) =       0.000539597533
  error estimate for blocks of size 2^( 5) =       0.000549710679
  error estimate for blocks of size 2^( 6) =       0.000556164180
  error estimate for blocks of size 2^( 7) =       0.000559112621

      target function =      -0.744122635552
              le_mean =     -22.814156260556
             les_mean =     520.937065664498
             stat err =       0.000551146253
             autocorr =       1.346045937082
   target nu stat err =       0.000551146253
   target dn stat err =       0.004890063279
      target stat err =       0.004145206385
              std dev =       0.671818434617
             le_variance =       0.451340009091


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744122635662        initial  <--
     2.5000e+04     2.5000e+05             4.9479e-08        -0.744122633903
     1.0000e+05     1.0000e+06             1.2370e-08        -0.744122634783
     4.0000e+05     4.0000e+06             3.0924e-09        -0.744122635552

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.9803
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2213e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7536
    reference variance = 0.206203
====================================================
  Execution time = 4.5536e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4934e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4987e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449399906835
                                         uncertainty =       0.003606439758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449399906835
                                         uncertainty =       0.003606439758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473993559
  error estimate for blocks of size 2^( 2) =       0.000498246635
  error estimate for blocks of size 2^( 3) =       0.000521671530
  error estimate for blocks of size 2^( 4) =       0.000538615200
  error estimate for blocks of size 2^( 5) =       0.000549516605
  error estimate for blocks of size 2^( 6) =       0.000555849980
  error estimate for blocks of size 2^( 7) =       0.000557889223

      target function =      -0.745797595842
              le_mean =     -22.815111517353
             les_mean =     520.978653112868
             stat err =       0.000550467752
             autocorr =       1.348710947723
   target nu stat err =       0.000550467752
   target dn stat err =       0.003496181150
      target stat err =       0.003012615358
              std dev =       0.670328119871
             le_variance =       0.449339788289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281511151735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745808865737       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745808865778       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745808865813       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745808865825       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745808865797       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745808866220       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745808866215       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745808865765       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745808865733       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745808865384       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745808865557       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745808865685       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745808866227       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745808866503       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745808865625       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745808865410       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745808865471       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745808866150       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745808866212       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745808866642       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745808866190       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745808865639       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745808866010       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745808865274       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745808864901       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745808865816       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745808866100       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745808865841       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745808865470       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745808865726       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745808867389       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745808865355       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+05 is 4.777262e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745808865737       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745808865747       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745808865756       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745808865759       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745808865761       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745808864092       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745808866560       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745808864809       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745808866647       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745808866509       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745808865757       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745808865522       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745808870420       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745808870144       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745808864518       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745808865830       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745808863827       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745808864150       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745808864936       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745808863848       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745808865900       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745808864266       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745808868203       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745808863221       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745808861196       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745808863854       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745808867590       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745808864572       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745808861506       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745808861867       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745808867116       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745808868067       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+06 is 1.194317e-09

solving harmonic davidson linear method for identity shift 4.0000e+06, overlap shift 4.0000e+07 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745808865737       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745808865740       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745808865742       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745808865744       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745808865157       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745808863060       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745808870304       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745808869378       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745808872136       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745808862394       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745808863503       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745808867013       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745808865981       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745808870714       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745808867470       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745808866340       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745808865782       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745808866824       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745808863761       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745808865337       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745808867906       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745808868260       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745808872107       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745808863724       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745808853141       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745808862525       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745808870884       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745808864717       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745808867828       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745808860633       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745808866247       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745808867800       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+06 is 2.985783e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0563e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227973e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920535e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8094
    reference variance = 0.535244
====================================================
  Execution time = 4.3174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5357e-01
  Total weights = 2.0000e+06
  Execution time = 3.5520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453673596230
                                         uncertainty =       0.004030958071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453673596230
                                         uncertainty =       0.004030958071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476217056
  error estimate for blocks of size 2^( 2) =       0.000500779087
  error estimate for blocks of size 2^( 3) =       0.000523702715
  error estimate for blocks of size 2^( 4) =       0.000539844753
  error estimate for blocks of size 2^( 5) =       0.000550112770
  error estimate for blocks of size 2^( 6) =       0.000554551575
  error estimate for blocks of size 2^( 7) =       0.000558528809

      target function =      -0.742250464419
              le_mean =     -22.814997225065
             les_mean =     520.977663522156
             stat err =       0.000550759477
             autocorr =       1.337562442278
   target nu stat err =       0.000550759477
   target dn stat err =       0.004099841204
      target stat err =       0.003478829960
              std dev =       0.673472619491
             le_variance =       0.453565369204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453673596376
                                         uncertainty =       0.004030958082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453673596376
                                         uncertainty =       0.004030958082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476217056
  error estimate for blocks of size 2^( 2) =       0.000500779087
  error estimate for blocks of size 2^( 3) =       0.000523702715
  error estimate for blocks of size 2^( 4) =       0.000539844753
  error estimate for blocks of size 2^( 5) =       0.000550112770
  error estimate for blocks of size 2^( 6) =       0.000554551575
  error estimate for blocks of size 2^( 7) =       0.000558528809

      target function =      -0.742250464296
              le_mean =     -22.814997225062
             les_mean =     520.977663522175
             stat err =       0.000550759477
             autocorr =       1.337562439778
   target nu stat err =       0.000550759477
   target dn stat err =       0.004099841217
      target stat err =       0.003478829970
              std dev =       0.673472619600
             le_variance =       0.453565369351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453673596303
                                         uncertainty =       0.004030958077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453673596303
                                         uncertainty =       0.004030958077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476217056
  error estimate for blocks of size 2^( 2) =       0.000500779087
  error estimate for blocks of size 2^( 3) =       0.000523702715
  error estimate for blocks of size 2^( 4) =       0.000539844753
  error estimate for blocks of size 2^( 5) =       0.000550112770
  error estimate for blocks of size 2^( 6) =       0.000554551575
  error estimate for blocks of size 2^( 7) =       0.000558528809

      target function =      -0.742250464357
              le_mean =     -22.814997225064
             les_mean =     520.977663522165
             stat err =       0.000550759477
             autocorr =       1.337562441023
   target nu stat err =       0.000550759477
   target dn stat err =       0.004099841211
      target stat err =       0.003478829965
              std dev =       0.673472619545
             le_variance =       0.453565369277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453673596239
                                         uncertainty =       0.004030958071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453673596239
                                         uncertainty =       0.004030958071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476217056
  error estimate for blocks of size 2^( 2) =       0.000500779087
  error estimate for blocks of size 2^( 3) =       0.000523702715
  error estimate for blocks of size 2^( 4) =       0.000539844753
  error estimate for blocks of size 2^( 5) =       0.000550112770
  error estimate for blocks of size 2^( 6) =       0.000554551575
  error estimate for blocks of size 2^( 7) =       0.000558528809

      target function =      -0.742250464411
              le_mean =     -22.814997225065
             les_mean =     520.977663522157
             stat err =       0.000550759477
             autocorr =       1.337562442117
   target nu stat err =       0.000550759477
   target dn stat err =       0.004099841205
      target stat err =       0.003478829961
              std dev =       0.673472619498
             le_variance =       0.453565369213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742250464419        initial  <--
     2.5000e+05     2.5000e+06             4.7773e-09        -0.742250464296
     1.0000e+06     1.0000e+07             1.1943e-09        -0.742250464357
     4.0000e+06     4.0000e+07             2.9858e-10        -0.742250464411

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9426
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2151e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8279
    reference variance = 0.37844
====================================================
  Execution time = 4.3845e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4764e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445349266950
                                         uncertainty =       0.002308187188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445349266950
                                         uncertainty =       0.002308187188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471833694
  error estimate for blocks of size 2^( 2) =       0.000496478795
  error estimate for blocks of size 2^( 3) =       0.000519825581
  error estimate for blocks of size 2^( 4) =       0.000536807446
  error estimate for blocks of size 2^( 5) =       0.000548206235
  error estimate for blocks of size 2^( 6) =       0.000553961969
  error estimate for blocks of size 2^( 7) =       0.000556532805

      target function =      -0.749268928866
              le_mean =     -22.814687303812
             les_mean =     520.955210617768
             stat err =       0.000548877114
             autocorr =       1.353232262369
   target nu stat err =       0.000548877114
   target dn stat err =       0.002585777195
      target stat err =       0.002285532616
              std dev =       0.667273609321
             le_variance =       0.445254069696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281468730381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749274908389       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749274908393       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749274908396       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749274908397       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749274908397       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749274910283       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749274908399       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749274908399       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749274900592       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749274913337       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749274908401       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749274909123       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749274908053       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749274908401       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749274908087       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749274905698       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749274908455       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749274903016       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749274907291       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749274903383       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749274902114       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749274907497       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749274901380       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749274908903       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749274900805       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749274913808       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749274913990       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749274914216       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749274909122       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749274899524       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749274894627       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749274905443       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749274910421       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 4.464187e-10

solving harmonic davidson linear method for identity shift 1.0000e+07, overlap shift 1.0000e+08 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749274908389       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749274908390       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749274908390       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749274908988       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749274908391       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749274908391       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749274883473       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749274937855       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749274908391       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749274914359       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749274908392       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749274897952       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749274891895       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749274896625       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749274882535       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749274913753       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749274904928       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749274899553       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749274918988       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749274892556       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749274859009       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749274856959       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749274923653       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749274907385       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749274874613       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749274890746       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749274905641       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749274903687       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749274941570       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749274925293       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749274926290       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749274868358       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749274936743       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+07 is 1.116046e-10

solving harmonic davidson linear method for identity shift 4.0000e+07, overlap shift 4.0000e+08 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749274908389       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749274908389       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749274908389       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749274908389       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749274908389       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749274908389       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749274908389       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749274995395       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749274908389       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749274931788       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749274813652       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749274819326       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749274983911       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749274945101       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749274920386       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749274900084       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749274960702       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749274898813       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749274883130       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749274903021       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749274898611       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749274867253       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749274998709       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749274886781       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749274939072       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749274845003       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749274733692       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749274919783       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749274834110       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749274731505       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749274737906       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749274870190       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749274800187       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+07 is 2.790270e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.433422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8653e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8427
    reference variance = 0.322938
====================================================
  Execution time = 4.3848e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.7034e-01
  Total weights = 2.0000e+06
  Execution time = 3.5610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470399472792
                                         uncertainty =       0.013662030868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470399472792
                                         uncertainty =       0.013662030868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484942662
  error estimate for blocks of size 2^( 2) =       0.000509422761
  error estimate for blocks of size 2^( 3) =       0.000532850539
  error estimate for blocks of size 2^( 4) =       0.000549826964
  error estimate for blocks of size 2^( 5) =       0.000559723879
  error estimate for blocks of size 2^( 6) =       0.000564325272
  error estimate for blocks of size 2^( 7) =       0.000566327704

      target function =      -0.728371405343
              le_mean =     -22.814447192024
             les_mean =     520.969339212573
             stat err =       0.000560050955
             autocorr =       1.333749594845
   target nu stat err =       0.000560050955
   target dn stat err =       0.013871831498
      target stat err =       0.011163579244
              std dev =       0.685812489015
             le_variance =       0.470338770090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470399472807
                                         uncertainty =       0.013662030873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470399472807
                                         uncertainty =       0.013662030873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484942662
  error estimate for blocks of size 2^( 2) =       0.000509422761
  error estimate for blocks of size 2^( 3) =       0.000532850539
  error estimate for blocks of size 2^( 4) =       0.000549826964
  error estimate for blocks of size 2^( 5) =       0.000559723879
  error estimate for blocks of size 2^( 6) =       0.000564325272
  error estimate for blocks of size 2^( 7) =       0.000566327704

      target function =      -0.728371405331
              le_mean =     -22.814447192024
             les_mean =     520.969339212591
             stat err =       0.000560050955
             autocorr =       1.333749594563
   target nu stat err =       0.000560050955
   target dn stat err =       0.013871831503
      target stat err =       0.011163579247
              std dev =       0.685812489027
             le_variance =       0.470338770105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470399472800
                                         uncertainty =       0.013662030871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470399472800
                                         uncertainty =       0.013662030871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484942662
  error estimate for blocks of size 2^( 2) =       0.000509422761
  error estimate for blocks of size 2^( 3) =       0.000532850539
  error estimate for blocks of size 2^( 4) =       0.000549826964
  error estimate for blocks of size 2^( 5) =       0.000559723879
  error estimate for blocks of size 2^( 6) =       0.000564325272
  error estimate for blocks of size 2^( 7) =       0.000566327704

      target function =      -0.728371405337
              le_mean =     -22.814447192024
             les_mean =     520.969339212582
             stat err =       0.000560050955
             autocorr =       1.333749594703
   target nu stat err =       0.000560050955
   target dn stat err =       0.013871831500
      target stat err =       0.011163579246
              std dev =       0.685812489021
             le_variance =       0.470338770098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470399472793
                                         uncertainty =       0.013662030869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470399472793
                                         uncertainty =       0.013662030869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484942662
  error estimate for blocks of size 2^( 2) =       0.000509422761
  error estimate for blocks of size 2^( 3) =       0.000532850539
  error estimate for blocks of size 2^( 4) =       0.000549826964
  error estimate for blocks of size 2^( 5) =       0.000559723879
  error estimate for blocks of size 2^( 6) =       0.000564325272
  error estimate for blocks of size 2^( 7) =       0.000566327704

      target function =      -0.728371405343
              le_mean =     -22.814447192024
             les_mean =     520.969339212574
             stat err =       0.000560050955
             autocorr =       1.333749594823
   target nu stat err =       0.000560050955
   target dn stat err =       0.013871831498
      target stat err =       0.011163579244
              std dev =       0.685812489016
             le_variance =       0.470338770091


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.728371405343        initial  <--
     2.5000e+06     2.5000e+07             4.4642e-10        -0.728371405331
     1.0000e+07     1.0000e+08             1.1160e-10        -0.728371405337
     4.0000e+07     4.0000e+08             2.7903e-11        -0.728371405343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.6633
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2032e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.9747
    reference variance = 0.783086
====================================================
  Execution time = 4.5619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4859e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462604276385
                                         uncertainty =       0.010374017539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462604276385
                                         uncertainty =       0.010374017539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480928972
  error estimate for blocks of size 2^( 2) =       0.000506052530
  error estimate for blocks of size 2^( 3) =       0.000529406663
  error estimate for blocks of size 2^( 4) =       0.000545826949
  error estimate for blocks of size 2^( 5) =       0.000557342419
  error estimate for blocks of size 2^( 6) =       0.000563157681
  error estimate for blocks of size 2^( 7) =       0.000564193151

      target function =      -0.734745908567
              le_mean =     -22.813869717076
             les_mean =     520.935236588644
             stat err =       0.000557630050
             autocorr =       1.344406048361
   target nu stat err =       0.000557630050
   target dn stat err =       0.010616213963
      target stat err =       0.008694138289
              std dev =       0.680136274757
             le_variance =       0.462585352241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281386971708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734846840702       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734846840704       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734846840704       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734846840705       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734846840705       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734846840705       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734846840705       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734846866120       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734846848846       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734846854840       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734846871256       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734846881464       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.734846840146       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.734846889364       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.734846847533       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.734846903929       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.734846792981       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.734846730003       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.734846655429       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.734846827261       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.734846778711       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.734846856330       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.734846875200       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.734846808306       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734846874293       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.734846896529       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.734846924439       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.734846911371       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.734846765988       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.734846820989       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.734846889009       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.734846721787       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.734846803823       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+07 is 3.750569e-11

solving harmonic davidson linear method for identity shift 1.0000e+08, overlap shift 1.0000e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734846840702       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734846840703       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734846840703       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734846840703       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734846860137       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734846840703       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734846840703       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734846840703       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734846840703       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734846840703       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734846840703       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734846722262       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.734846840703       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.734846840703       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.734846761892       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.734846809830       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.734847023700       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.734846865197       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.734846748274       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.734846868915       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.734846439208       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.734846832785       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.734846757729       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.734846533351       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734846776152       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.734846764119       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.734846689056       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.734846855628       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.734846546990       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.734846599095       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.734846224584       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.734846460376       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.734846846420       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+08 is 9.374358e-12

solving harmonic davidson linear method for identity shift 4.0000e+08, overlap shift 4.0000e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734846840702       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734846840703       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734846840703       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734846840703       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734846840703       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734847199125       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734846494084       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734847464465       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734845962905       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734847620627       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734848659166       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734847701313       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.734846417135       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.734847211211       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.734847047213       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.734846478602       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.734846408463       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.734846518810       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.734846015214       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.734846009320       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.734846198084       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.734844969437       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.734846572387       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.734847918031       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734847510480       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.734848667961       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.734845820657       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.734845738399       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.734847219070       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.734846193663       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.734846502615       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.734846945394       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.734849308931       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+08 is 2.343457e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.471479 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0543e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7783
    reference variance = 0.333886
====================================================
  Execution time = 4.5343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6410e-01
  Total weights = 2.0000e+06
  Execution time = 3.5560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464121793940
                                         uncertainty =       0.015149025741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464121793940
                                         uncertainty =       0.015149025741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481717698
  error estimate for blocks of size 2^( 2) =       0.000506185974
  error estimate for blocks of size 2^( 3) =       0.000528839474
  error estimate for blocks of size 2^( 4) =       0.000546606825
  error estimate for blocks of size 2^( 5) =       0.000556778161
  error estimate for blocks of size 2^( 6) =       0.000562539241
  error estimate for blocks of size 2^( 7) =       0.000567162325

      target function =      -0.733343347064
              le_mean =     -22.815277827168
             les_mean =     521.001005979102
             stat err =       0.000558271638
             autocorr =       1.343092505997
   target nu stat err =       0.000558271638
   target dn stat err =       0.015403067661
      target stat err =       0.012578294162
              std dev =       0.681251701114
             le_variance =       0.464103880270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464121793945
                                         uncertainty =       0.015149025743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464121793945
                                         uncertainty =       0.015149025743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481717698
  error estimate for blocks of size 2^( 2) =       0.000506185974
  error estimate for blocks of size 2^( 3) =       0.000528839474
  error estimate for blocks of size 2^( 4) =       0.000546606825
  error estimate for blocks of size 2^( 5) =       0.000556778161
  error estimate for blocks of size 2^( 6) =       0.000562539241
  error estimate for blocks of size 2^( 7) =       0.000567162325

      target function =      -0.733343347059
              le_mean =     -22.815277827168
             les_mean =     521.001005979105
             stat err =       0.000558271638
             autocorr =       1.343092505968
   target nu stat err =       0.000558271638
   target dn stat err =       0.015403067663
      target stat err =       0.012578294164
              std dev =       0.681251701118
             le_variance =       0.464103880276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464121793942
                                         uncertainty =       0.015149025742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464121793942
                                         uncertainty =       0.015149025742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481717698
  error estimate for blocks of size 2^( 2) =       0.000506185974
  error estimate for blocks of size 2^( 3) =       0.000528839474
  error estimate for blocks of size 2^( 4) =       0.000546606825
  error estimate for blocks of size 2^( 5) =       0.000556778161
  error estimate for blocks of size 2^( 6) =       0.000562539241
  error estimate for blocks of size 2^( 7) =       0.000567162325

      target function =      -0.733343347061
              le_mean =     -22.815277827168
             les_mean =     521.001005979104
             stat err =       0.000558271638
             autocorr =       1.343092505979
   target nu stat err =       0.000558271638
   target dn stat err =       0.015403067662
      target stat err =       0.012578294163
              std dev =       0.681251701116
             le_variance =       0.464103880273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464121793940
                                         uncertainty =       0.015149025741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464121793940
                                         uncertainty =       0.015149025741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481717698
  error estimate for blocks of size 2^( 2) =       0.000506185974
  error estimate for blocks of size 2^( 3) =       0.000528839474
  error estimate for blocks of size 2^( 4) =       0.000546606825
  error estimate for blocks of size 2^( 5) =       0.000556778161
  error estimate for blocks of size 2^( 6) =       0.000562539241
  error estimate for blocks of size 2^( 7) =       0.000567162325

      target function =      -0.733343347063
              le_mean =     -22.815277827168
             les_mean =     521.001005979103
             stat err =       0.000558271638
             autocorr =       1.343092505989
   target nu stat err =       0.000558271638
   target dn stat err =       0.015403067661
      target stat err =       0.012578294162
              std dev =       0.681251701114
             le_variance =       0.464103880271


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.733343347064        initial  <--
     2.5000e+07     2.5000e+08             3.7506e-11        -0.733343347059
     1.0000e+08     1.0000e+09             9.3744e-12        -0.733343347061
     4.0000e+08     4.0000e+09             2.3435e-12        -0.733343347063

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.1319
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2368e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.9276
    reference variance = 0.321278
====================================================
  Execution time = 4.4055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5176e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4732e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451704531611
                                         uncertainty =       0.004508910882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451704531611
                                         uncertainty =       0.004508910882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475270542
  error estimate for blocks of size 2^( 2) =       0.000500079522
  error estimate for blocks of size 2^( 3) =       0.000522933246
  error estimate for blocks of size 2^( 4) =       0.000540210699
  error estimate for blocks of size 2^( 5) =       0.000550453363
  error estimate for blocks of size 2^( 6) =       0.000558434408
  error estimate for blocks of size 2^( 7) =       0.000561866929

      target function =      -0.743772656321
              le_mean =     -22.813988120977
             les_mean =     520.929817934136
             stat err =       0.000552741350
             autocorr =       1.352577365809
   target nu stat err =       0.000552741350
   target dn stat err =       0.004666423522
      target stat err =       0.003955568302
              std dev =       0.672134046112
             le_variance =       0.451764175943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281398812098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743792900259       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743792900259       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743792900259       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743792900259       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743792940743       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743792927123       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743792816825       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743792900259       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743793298472       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743793029185       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743792632348       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743792900259       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743792805612       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743793010950       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743792302009       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743793224878       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743793154591       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743793350559       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743791328240       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743792867124       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743792215318       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743792885094       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743793330950       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743793540398       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743792946808       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743793133178       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743792578610       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743793667645       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743792819872       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743792480484       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743792261305       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743793396892       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+08 is 4.613748e-12

solving harmonic davidson linear method for identity shift 1.0000e+09, overlap shift 1.0000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743792900259       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743792900259       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743792900259       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743792900259       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743792900259       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743792669268       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743792800010       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743793834064       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743793759655       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743792269237       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743794025991       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743792812973       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743791553907       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743791251121       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743794510709       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743791863244       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743796590709       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743794363905       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743790662292       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743792663104       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743792876327       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743793545639       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743791842503       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743793642753       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743790973061       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743791545117       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743791934799       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743790100007       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743793308890       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743788528373       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743794281443       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743792768470       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+09 is 1.154558e-12

solving harmonic davidson linear method for identity shift 4.0000e+09, overlap shift 4.0000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743792900259       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743792900259       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743792900259       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743792688085       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743793270196       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743792961670       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743792900259       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743804607320       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743792900259       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743792900259       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743795482751       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743802322356       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743799487970       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743780805134       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743793016516       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743791521212       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743785453650       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743786160325       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743803399838       residual = 9.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743776921185       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743781994076       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743807785087       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743781712739       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743794001517       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743788606419       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743789230010       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743787275090       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743789634638       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743802116941       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743770401056       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743782548275       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743824471286       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743786562039       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743793889035       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+09 is 2.883362e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.508646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8829e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8146
    reference variance = 0.275879
====================================================
  Execution time = 4.3443e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5114e-01
  Total weights = 2.0000e+06
  Execution time = 3.5531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451118431541
                                         uncertainty =       0.005114302456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451118431541
                                         uncertainty =       0.005114302456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474940836
  error estimate for blocks of size 2^( 2) =       0.000499692346
  error estimate for blocks of size 2^( 3) =       0.000522479289
  error estimate for blocks of size 2^( 4) =       0.000540413712
  error estimate for blocks of size 2^( 5) =       0.000551145156
  error estimate for blocks of size 2^( 6) =       0.000557291917
  error estimate for blocks of size 2^( 7) =       0.000561221671

      target function =      -0.744279649483
              le_mean =     -22.814781028558
             les_mean =     520.965370750312
             stat err =       0.000552518114
             autocorr =       1.353362121414
   target nu stat err =       0.000552518114
   target dn stat err =       0.004964433832
      target stat err =       0.004212817688
              std dev =       0.671667771162
             le_variance =       0.451137594818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451118431542
                                         uncertainty =       0.005114302456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451118431542
                                         uncertainty =       0.005114302456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474940836
  error estimate for blocks of size 2^( 2) =       0.000499692346
  error estimate for blocks of size 2^( 3) =       0.000522479289
  error estimate for blocks of size 2^( 4) =       0.000540413712
  error estimate for blocks of size 2^( 5) =       0.000551145156
  error estimate for blocks of size 2^( 6) =       0.000557291917
  error estimate for blocks of size 2^( 7) =       0.000561221671

      target function =      -0.744279649483
              le_mean =     -22.814781028558
             les_mean =     520.965370750312
             stat err =       0.000552518114
             autocorr =       1.353362121416
   target nu stat err =       0.000552518114
   target dn stat err =       0.004964433832
      target stat err =       0.004212817688
              std dev =       0.671667771162
             le_variance =       0.451137594818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451118431542
                                         uncertainty =       0.005114302456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451118431542
                                         uncertainty =       0.005114302456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474940836
  error estimate for blocks of size 2^( 2) =       0.000499692346
  error estimate for blocks of size 2^( 3) =       0.000522479289
  error estimate for blocks of size 2^( 4) =       0.000540413712
  error estimate for blocks of size 2^( 5) =       0.000551145156
  error estimate for blocks of size 2^( 6) =       0.000557291917
  error estimate for blocks of size 2^( 7) =       0.000561221671

      target function =      -0.744279649483
              le_mean =     -22.814781028558
             les_mean =     520.965370750312
             stat err =       0.000552518114
             autocorr =       1.353362121415
   target nu stat err =       0.000552518114
   target dn stat err =       0.004964433832
      target stat err =       0.004212817688
              std dev =       0.671667771162
             le_variance =       0.451137594818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451118431541
                                         uncertainty =       0.005114302456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451118431541
                                         uncertainty =       0.005114302456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474940836
  error estimate for blocks of size 2^( 2) =       0.000499692346
  error estimate for blocks of size 2^( 3) =       0.000522479289
  error estimate for blocks of size 2^( 4) =       0.000540413712
  error estimate for blocks of size 2^( 5) =       0.000551145156
  error estimate for blocks of size 2^( 6) =       0.000557291917
  error estimate for blocks of size 2^( 7) =       0.000561221671

      target function =      -0.744279649483
              le_mean =     -22.814781028558
             les_mean =     520.965370750312
             stat err =       0.000552518114
             autocorr =       1.353362121413
   target nu stat err =       0.000552518114
   target dn stat err =       0.004964433832
      target stat err =       0.004212817688
              std dev =       0.671667771162
             le_variance =       0.451137594818


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744279649483        initial  <--
     2.5000e+08     2.5000e+09             4.6137e-12        -0.744279649483
     1.0000e+09     1.0000e+10             1.1546e-12        -0.744279649483
     4.0000e+09     4.0000e+10             2.8834e-13        -0.744279649483

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1788
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2002e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8325
    reference variance = 0.415917
====================================================
  Execution time = 4.4188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5128e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4864e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451312334725
                                         uncertainty =       0.004944255839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451312334725
                                         uncertainty =       0.004944255839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475016858
  error estimate for blocks of size 2^( 2) =       0.000499533008
  error estimate for blocks of size 2^( 3) =       0.000522968358
  error estimate for blocks of size 2^( 4) =       0.000539508579
  error estimate for blocks of size 2^( 5) =       0.000550291430
  error estimate for blocks of size 2^( 6) =       0.000555485527
  error estimate for blocks of size 2^( 7) =       0.000558446877

      target function =      -0.744156516008
              le_mean =     -22.814829415014
             les_mean =     520.967723041756
             stat err =       0.000550933103
             autocorr =       1.345177797613
   target nu stat err =       0.000550933103
   target dn stat err =       0.005097614070
      target stat err =       0.004322043942
              std dev =       0.671775283267
             le_variance =       0.451282031209


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281482941501e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744180602437       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744180602437       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744180602437       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744180602437       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744180181518       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744178552173       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744185071048       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744181350727       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744182211945       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744180289966       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744179517528       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744183180322       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744179662672       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744175423408       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744180201200       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744185312078       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744177578789       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744179539784       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744181390018       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744181096108       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744181956342       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744163202530       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744191711871       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744181206662       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744186350878       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744179314670       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744181767006       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744188105875       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744183662321       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744184738650       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744184558893       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744169772207       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744170617349       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744175437832       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744176238928       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744188339160       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744181926624       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 3.867063e-13

solving harmonic davidson linear method for identity shift 1.0000e+10, overlap shift 1.0000e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744180602437       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744180602437       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744180602437       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744180602437       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744171089283       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744189529768       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744171499281       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744177097904       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744192342347       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744179592844       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744211150611       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744193322928       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744177076289       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744178314462       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744194133165       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744181360059       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744171792476       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744187875332       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744176580197       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744176684249       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744188108751       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744177337792       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744195341969       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744158126390       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744169720160       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744203686710       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744183824567       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744196291316       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744243545209       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744185050594       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744212792942       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744151351069       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744231727120       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744100645535       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744148336730       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744231824018       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744116151020       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.744236212963       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744333793405       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744304176159       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744334729115       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.744234482842       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744206508285       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744160429307       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.744377891582       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.743990243137       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744060673917       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744070241251       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.744263703959       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.744956828495       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.743485697058       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.744368617441       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.741294147864       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.742479804240       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.745479276128       residual = 2.43e-03           smallest_sin_value = 9.98e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+10 is 9.465928e-14

solving harmonic davidson linear method for identity shift 4.0000e+10, overlap shift 4.0000e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744180602437       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744180602437       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744180602437       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744180602437       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744180602676       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744175529553       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744189349972       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744151276790       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744190120570       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744196478815       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744105950036       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744216901538       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744193341453       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744260113740       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744294468002       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744146898639       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744168034831       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744340995451       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744148031254       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744179788750       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744222029318       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744169051049       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744256369262       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744259524811       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744267838367       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744367072093       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744149611245       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743602307107       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743672693331       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744195876064       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743924640243       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744214933728       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744166949486       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743978089299       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744046770797       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744353642048       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.743666636858       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.744446203500       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744389577992       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743308243734       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745560055216       residual = 8.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.743626618799       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743371049510       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744208376789       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743580523631       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.743831985864       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742712589945       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744132454157       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.743181350080       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.751844213863       residual = 2.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.749029463028       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.741949766625       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.755875076983       residual = 6.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.778515158760       residual = 5.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.720484896935       residual = 3.26e-01           smallest_sin_value = 9.96e-01
davidson iteration   55 stopping due to small subspace S singular value of 8.60e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+10 is 2.385201e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.648326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9197e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7972
    reference variance = 0.372217
====================================================
  Execution time = 4.5123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4467e-01
  Total weights = 2.0000e+06
  Execution time = 3.5616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444667734252
                                         uncertainty =       0.002860567748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444667734252
                                         uncertainty =       0.002860567748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471521706
  error estimate for blocks of size 2^( 2) =       0.000496469865
  error estimate for blocks of size 2^( 3) =       0.000519765832
  error estimate for blocks of size 2^( 4) =       0.000536573197
  error estimate for blocks of size 2^( 5) =       0.000546486479
  error estimate for blocks of size 2^( 6) =       0.000554590682
  error estimate for blocks of size 2^( 7) =       0.000559548854

      target function =      -0.749758536653
              le_mean =     -22.815424855016
             les_mean =     520.988276530817
             stat err =       0.000549299803
             autocorr =       1.357111426744
   target nu stat err =       0.000549299803
   target dn stat err =       0.003018355601
      target stat err =       0.002647816523
              std dev =       0.666832391420
             le_variance =       0.444665438247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444667734252
                                         uncertainty =       0.002860567748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444667734252
                                         uncertainty =       0.002860567748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471521706
  error estimate for blocks of size 2^( 2) =       0.000496469865
  error estimate for blocks of size 2^( 3) =       0.000519765832
  error estimate for blocks of size 2^( 4) =       0.000536573197
  error estimate for blocks of size 2^( 5) =       0.000546486479
  error estimate for blocks of size 2^( 6) =       0.000554590682
  error estimate for blocks of size 2^( 7) =       0.000559548854

      target function =      -0.749758536653
              le_mean =     -22.815424855016
             les_mean =     520.988276530817
             stat err =       0.000549299803
             autocorr =       1.357111426744
   target nu stat err =       0.000549299803
   target dn stat err =       0.003018355601
      target stat err =       0.002647816523
              std dev =       0.666832391420
             le_variance =       0.444665438247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444667734252
                                         uncertainty =       0.002860567748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444667734252
                                         uncertainty =       0.002860567748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471521706
  error estimate for blocks of size 2^( 2) =       0.000496469865
  error estimate for blocks of size 2^( 3) =       0.000519765832
  error estimate for blocks of size 2^( 4) =       0.000536573197
  error estimate for blocks of size 2^( 5) =       0.000546486479
  error estimate for blocks of size 2^( 6) =       0.000554590682
  error estimate for blocks of size 2^( 7) =       0.000559548854

      target function =      -0.749758536653
              le_mean =     -22.815424855016
             les_mean =     520.988276530817
             stat err =       0.000549299803
             autocorr =       1.357111426748
   target nu stat err =       0.000549299803
   target dn stat err =       0.003018355601
      target stat err =       0.002647816523
              std dev =       0.666832391420
             le_variance =       0.444665438247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444667734252
                                         uncertainty =       0.002860567748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444667734252
                                         uncertainty =       0.002860567748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471521706
  error estimate for blocks of size 2^( 2) =       0.000496469865
  error estimate for blocks of size 2^( 3) =       0.000519765832
  error estimate for blocks of size 2^( 4) =       0.000536573197
  error estimate for blocks of size 2^( 5) =       0.000546486479
  error estimate for blocks of size 2^( 6) =       0.000554590682
  error estimate for blocks of size 2^( 7) =       0.000559548854

      target function =      -0.749758536653
              le_mean =     -22.815424855016
             les_mean =     520.988276530817
             stat err =       0.000549299803
             autocorr =       1.357111426744
   target nu stat err =       0.000549299803
   target dn stat err =       0.003018355601
      target stat err =       0.002647816523
              std dev =       0.666832391420
             le_variance =       0.444665438247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749758536653        initial
     2.5000e+09     2.5000e+10             3.8671e-13        -0.749758536653  <--
     1.0000e+10     1.0000e+11             9.4659e-14        -0.749758536653
     4.0000e+10     4.0000e+11             2.3852e-14        -0.749758536653

*****************************************************************************
Applying the update for shift_i =   2.5000e+09     and shift_s =   2.5000e+10
*****************************************************************************

  Execution time = 6.2956e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2216e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8594
    reference variance = 0.371326
====================================================
  Execution time = 4.5302e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4682e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4838e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446734987712
                                         uncertainty =       0.003131345307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446734987712
                                         uncertainty =       0.003131345307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472661191
  error estimate for blocks of size 2^( 2) =       0.000497539253
  error estimate for blocks of size 2^( 3) =       0.000520578455
  error estimate for blocks of size 2^( 4) =       0.000537592508
  error estimate for blocks of size 2^( 5) =       0.000548457366
  error estimate for blocks of size 2^( 6) =       0.000553570369
  error estimate for blocks of size 2^( 7) =       0.000555401205

      target function =      -0.747941332998
              le_mean =     -22.814507506388
             les_mean =     520.948569737713
             stat err =       0.000548755362
             autocorr =       1.347899971727
   target nu stat err =       0.000548755362
   target dn stat err =       0.003182172238
      target stat err =       0.002766598918
              std dev =       0.668443866072
             le_variance =       0.446817202089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281450750639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747950449481       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747950449481       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747950449481       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747950449481       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747950268431       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747950361265       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747950852614       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747949538364       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747949110659       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747952381575       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747949907237       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747948776756       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747950083199       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747950560556       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747950245247       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747949602433       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747951065438       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747948351409       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747952179075       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747950644203       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747950467567       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747950841044       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747953641912       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747950282850       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747950293695       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747952852605       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747950292307       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747949094269       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747951010098       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747949976729       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747950584109       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747949623331       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747953068298       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+08 is 1.548705e-12

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747950449481       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747950449481       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747950449481       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747951551155       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747950730688       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747951113406       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747958922437       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747950470699       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747948561490       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747952984719       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747948134861       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747949317833       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747949682538       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747950784554       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747948995410       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747950030399       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747953676004       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747961138519       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747947706100       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747957561729       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747942244334       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747950144549       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747955178926       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747952495921       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747948241903       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747954152403       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747947795469       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747954733248       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747944629024       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747951838670       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747952275555       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747953618966       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747952928450       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+09 is 3.871401e-13

solving harmonic davidson linear method for identity shift 1.0000e+10, overlap shift 1.0000e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747950449481       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747950449481       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747950449481       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747950449480       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747950448423       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747949988056       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747947160529       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747931265118       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747967505128       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747948863147       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747949299504       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747937435239       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747952821733       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747949691421       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747962016772       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747954075237       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747975704234       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747955604821       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747910021889       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747921283025       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747947815265       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747943401058       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747909234424       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747947371961       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747983435264       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747958786284       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747946452492       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747973692687       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747951600188       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747979175320       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747930742736       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747915312177       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747966366332       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747898926366       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747898102958       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747891943268       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.748014455296       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.747913958883       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748002659560       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.747965337244       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.747956974826       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.747829332948       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747882555485       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747934782225       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748060192076       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747745222172       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.748012777576       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.747960420084       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747948650184       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747429549034       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745958778857       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.749831709815       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.751359928222       residual = 8.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.750912257716       residual = 6.76e-03           smallest_sin_value = 9.99e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.06e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+10 is 9.693710e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.730198 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0229e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8358
    reference variance = 0.445042
====================================================
  Execution time = 4.3519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4428e-01
  Total weights = 2.0000e+06
  Execution time = 3.5522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444186082031
                                         uncertainty =       0.003144838479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444186082031
                                         uncertainty =       0.003144838479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471315799
  error estimate for blocks of size 2^( 2) =       0.000496489644
  error estimate for blocks of size 2^( 3) =       0.000520342626
  error estimate for blocks of size 2^( 4) =       0.000538414315
  error estimate for blocks of size 2^( 5) =       0.000549247573
  error estimate for blocks of size 2^( 6) =       0.000555036169
  error estimate for blocks of size 2^( 7) =       0.000554827998

      target function =      -0.750101391555
              le_mean =     -22.814401466163
             les_mean =     520.941191201451
             stat err =       0.000549381514
             autocorr =       1.358701603150
   target nu stat err =       0.000549381514
   target dn stat err =       0.003014420753
      target stat err =       0.002642828621
              std dev =       0.666541194772
             le_variance =       0.444277164328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444186082031
                                         uncertainty =       0.003144838479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444186082031
                                         uncertainty =       0.003144838479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471315799
  error estimate for blocks of size 2^( 2) =       0.000496489644
  error estimate for blocks of size 2^( 3) =       0.000520342626
  error estimate for blocks of size 2^( 4) =       0.000538414315
  error estimate for blocks of size 2^( 5) =       0.000549247573
  error estimate for blocks of size 2^( 6) =       0.000555036169
  error estimate for blocks of size 2^( 7) =       0.000554827998

      target function =      -0.750101391555
              le_mean =     -22.814401466163
             les_mean =     520.941191201451
             stat err =       0.000549381514
             autocorr =       1.358701603141
   target nu stat err =       0.000549381514
   target dn stat err =       0.003014420753
      target stat err =       0.002642828621
              std dev =       0.666541194772
             le_variance =       0.444277164328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444186082031
                                         uncertainty =       0.003144838479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444186082031
                                         uncertainty =       0.003144838479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471315799
  error estimate for blocks of size 2^( 2) =       0.000496489644
  error estimate for blocks of size 2^( 3) =       0.000520342626
  error estimate for blocks of size 2^( 4) =       0.000538414315
  error estimate for blocks of size 2^( 5) =       0.000549247573
  error estimate for blocks of size 2^( 6) =       0.000555036169
  error estimate for blocks of size 2^( 7) =       0.000554827998

      target function =      -0.750101391555
              le_mean =     -22.814401466163
             les_mean =     520.941191201451
             stat err =       0.000549381514
             autocorr =       1.358701603145
   target nu stat err =       0.000549381514
   target dn stat err =       0.003014420753
      target stat err =       0.002642828621
              std dev =       0.666541194772
             le_variance =       0.444277164328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444186082031
                                         uncertainty =       0.003144838479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444186082031
                                         uncertainty =       0.003144838479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471315799
  error estimate for blocks of size 2^( 2) =       0.000496489644
  error estimate for blocks of size 2^( 3) =       0.000520342626
  error estimate for blocks of size 2^( 4) =       0.000538414315
  error estimate for blocks of size 2^( 5) =       0.000549247573
  error estimate for blocks of size 2^( 6) =       0.000555036169
  error estimate for blocks of size 2^( 7) =       0.000554827998

      target function =      -0.750101391555
              le_mean =     -22.814401466163
             les_mean =     520.941191201451
             stat err =       0.000549381514
             autocorr =       1.358701603151
   target nu stat err =       0.000549381514
   target dn stat err =       0.003014420753
      target stat err =       0.002642828621
              std dev =       0.666541194772
             le_variance =       0.444277164328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750101391555        initial  <--
     6.2500e+08     6.2500e+09             1.5487e-12        -0.750101391555
     2.5000e+09     2.5000e+10             3.8714e-13        -0.750101391555
     1.0000e+10     1.0000e+11             9.6937e-14        -0.750101391555

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2978
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2153e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8187
    reference variance = 0.363492
====================================================
  Execution time = 4.4249e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6894e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5021e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468816162918
                                         uncertainty =       0.012981492931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468816162918
                                         uncertainty =       0.012981492931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484223406
  error estimate for blocks of size 2^( 2) =       0.000508464553
  error estimate for blocks of size 2^( 3) =       0.000531384486
  error estimate for blocks of size 2^( 4) =       0.000547766142
  error estimate for blocks of size 2^( 5) =       0.000557489710
  error estimate for blocks of size 2^( 6) =       0.000562056581
  error estimate for blocks of size 2^( 7) =       0.000564761537

      target function =      -0.729502583545
              le_mean =     -22.814517863726
             les_mean =     520.971169734573
             stat err =       0.000558018492
             autocorr =       1.328023088641
   target nu stat err =       0.000558018492
   target dn stat err =       0.013361351813
      target stat err =       0.010788266122
              std dev =       0.684795308660
             le_variance =       0.468944614762


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281451786373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.729662258172       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.729662258172       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.729662258172       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.729667079863       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.729662537116       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.729662258172       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.729662258172       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.729662258172       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.729662258172       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.729669906784       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.729668883699       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.729644134045       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.729640938374       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.729661372356       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.729660373091       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.729667412981       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.729638407031       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.729652495391       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.729644460281       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.729664644670       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.729671470350       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.729653537355       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.729660327145       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.729657827782       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.729649348993       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.729659942786       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.729653245121       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.729648026185       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.729666720749       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.729655952192       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.729632765657       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.729661107424       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.729664104003       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.729670938878       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.729650826308       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.729676712282       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.729680176049       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.729646002148       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.729704540611       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.729675783700       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.729600101261       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.729842175696       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.729665554761       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.729673959448       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.729638102022       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.729700459648       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.729586658336       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.729675968243       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.729600720255       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.729843953785       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.731206548460       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.729967341540       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.730662677018       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.729186132045       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.728422298769       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   55 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+09 is 9.372652e-14

solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.729662258172       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.729662258172       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.729662258172       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.729667164813       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.729658730838       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.729654715187       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.729662258172       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.729662258172       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.729662258172       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.729629101292       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.729673089235       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.729630256000       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.729645779942       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.729638309719       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.729651598664       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.729664875740       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.729640029698       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.729642513312       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.729638592293       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.729613223156       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.729599582168       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.729574998163       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.729729435686       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.729625011322       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.729602331109       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.729713043401       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.729677898070       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.729661476892       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.729632140041       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.729627757047       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.729652963816       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.729683264773       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.729635508558       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.729722949595       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.729567992719       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.729754556652       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.729863482326       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.729403192734       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.728960310904       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.729442926318       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.729587830724       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.729813423135       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.730254900324       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.729792383347       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.729767869497       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.730025032524       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.730072373298       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.729741564577       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.729461570700       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.729247980236       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.729609031362       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.736095261476       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.735032044236       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.719477162331       residual = 5.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.733499235330       residual = 6.52e-02           smallest_sin_value = 9.99e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+10 is 2.360565e-14

solving harmonic davidson linear method for identity shift 1.0000e+11, overlap shift 1.0000e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.729662258172       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.729662258172       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.729662258172       residual = 9.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.729685919673       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.729692835155       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.729679496369       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.729613986725       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.729648033012       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.729732100313       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.729891168154       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.729560386068       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.729575166771       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.729730799297       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.729857663473       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.729917693188       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.729613948628       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.729694751159       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.729605912483       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.729728976081       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.729936741401       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.729594887257       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.730115043356       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.729271000397       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.729396316383       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.729958177164       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.730523046937       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.729627991687       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.729658761880       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.729507326069       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.729785827734       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.729721497117       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.729616746736       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.729209507055       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.728818881442       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.729443021591       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.729927438928       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.729347788829       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.729259161797       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.731310987341       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.729266484832       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.730111722506       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.731481278517       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.728040641472       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.729567231999       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.728133163710       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.729476724110       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.731516391206       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.730091979875       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.730276672174       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.730113020484       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.727367569817       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746098237915       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.748439112822       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.716230199673       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -1.065779128830       residual = 5.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.785086735691       residual = 1.72e+00           smallest_sin_value = 9.99e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.39e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+11 is 6.049473e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.910674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9456e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7912
    reference variance = 0.479458
====================================================
  Execution time = 4.4055e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4793e-01
  Total weights = 2.0000e+06
  Execution time = 3.5585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448004838678
                                         uncertainty =       0.002977256623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448004838678
                                         uncertainty =       0.002977256623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473248410
  error estimate for blocks of size 2^( 2) =       0.000497813900
  error estimate for blocks of size 2^( 3) =       0.000520909710
  error estimate for blocks of size 2^( 4) =       0.000537804796
  error estimate for blocks of size 2^( 5) =       0.000549184727
  error estimate for blocks of size 2^( 6) =       0.000554303874
  error estimate for blocks of size 2^( 7) =       0.000557166776

      target function =      -0.747002228405
              le_mean =     -22.814346330926
             les_mean =     520.942326398442
             stat err =       0.000549615043
             autocorr =       1.348773098422
   target nu stat err =       0.000549615043
   target dn stat err =       0.003401994712
      target stat err =       0.002940623112
              std dev =       0.669274319677
             le_variance =       0.447928114979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448004838678
                                         uncertainty =       0.002977256623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448004838678
                                         uncertainty =       0.002977256623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473248410
  error estimate for blocks of size 2^( 2) =       0.000497813900
  error estimate for blocks of size 2^( 3) =       0.000520909710
  error estimate for blocks of size 2^( 4) =       0.000537804796
  error estimate for blocks of size 2^( 5) =       0.000549184727
  error estimate for blocks of size 2^( 6) =       0.000554303874
  error estimate for blocks of size 2^( 7) =       0.000557166776

      target function =      -0.747002228405
              le_mean =     -22.814346330926
             les_mean =     520.942326398442
             stat err =       0.000549615043
             autocorr =       1.348773098425
   target nu stat err =       0.000549615043
   target dn stat err =       0.003401994712
      target stat err =       0.002940623112
              std dev =       0.669274319677
             le_variance =       0.447928114979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448004838678
                                         uncertainty =       0.002977256623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448004838678
                                         uncertainty =       0.002977256623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473248410
  error estimate for blocks of size 2^( 2) =       0.000497813900
  error estimate for blocks of size 2^( 3) =       0.000520909710
  error estimate for blocks of size 2^( 4) =       0.000537804796
  error estimate for blocks of size 2^( 5) =       0.000549184727
  error estimate for blocks of size 2^( 6) =       0.000554303874
  error estimate for blocks of size 2^( 7) =       0.000557166776

      target function =      -0.747002228405
              le_mean =     -22.814346330926
             les_mean =     520.942326398442
             stat err =       0.000549615043
             autocorr =       1.348773098422
   target nu stat err =       0.000549615043
   target dn stat err =       0.003401994712
      target stat err =       0.002940623112
              std dev =       0.669274319677
             le_variance =       0.447928114979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448004838678
                                         uncertainty =       0.002977256623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448004838678
                                         uncertainty =       0.002977256623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473248410
  error estimate for blocks of size 2^( 2) =       0.000497813900
  error estimate for blocks of size 2^( 3) =       0.000520909710
  error estimate for blocks of size 2^( 4) =       0.000537804796
  error estimate for blocks of size 2^( 5) =       0.000549184727
  error estimate for blocks of size 2^( 6) =       0.000554303874
  error estimate for blocks of size 2^( 7) =       0.000557166776

      target function =      -0.747002228405
              le_mean =     -22.814346330926
             les_mean =     520.942326398442
             stat err =       0.000549615043
             autocorr =       1.348773098422
   target nu stat err =       0.000549615043
   target dn stat err =       0.003401994712
      target stat err =       0.002940623112
              std dev =       0.669274319677
             le_variance =       0.447928114979


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747002228405        initial  <--
     6.2500e+09     6.2500e+10             9.3727e-14        -0.747002228405
     2.5000e+10     2.5000e+11             2.3606e-14        -0.747002228405
     1.0000e+11     1.0000e+12             6.0495e-15        -0.747002228405

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8593
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2134e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7769
    reference variance = 0.564167
====================================================
  Execution time = 4.5506e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4615e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4791e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446176388511
                                         uncertainty =       0.002761821571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446176388511
                                         uncertainty =       0.002761821571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472308194
  error estimate for blocks of size 2^( 2) =       0.000497441067
  error estimate for blocks of size 2^( 3) =       0.000520238945
  error estimate for blocks of size 2^( 4) =       0.000537889906
  error estimate for blocks of size 2^( 5) =       0.000547388656
  error estimate for blocks of size 2^( 6) =       0.000554128103
  error estimate for blocks of size 2^( 7) =       0.000557075967

      target function =      -0.748509416343
              le_mean =     -22.814388449478
             les_mean =     520.942470161157
             stat err =       0.000549120658
             autocorr =       1.351713351037
   target nu stat err =       0.000549120658
   target dn stat err =       0.002985924703
      target stat err =       0.002608331039
              std dev =       0.667944653798
             le_variance =       0.446150060537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281438844948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748517606566       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748517606566       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748517606566       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748517606566       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748517606566       residual = 6.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748517606566       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748521870805       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748517606566       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748547838559       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748402473585       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748383385838       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748596431836       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748488781600       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748511149316       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748498158245       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748530677481       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748564910233       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748583238335       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748516781494       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748064907106       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748159758364       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748732612486       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748416494591       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748349756418       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748867437596       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748497658868       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748612415474       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748502614147       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747819553950       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748512453748       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748761586580       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748560556277       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749142408412       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748738833176       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748336670844       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748850217753       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747775543562       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748453622298       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.747565501777       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748182779147       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749041506331       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749182722224       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748948433018       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748801570695       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748926817227       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746784140329       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.749641178374       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745680294071       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.759589607674       residual = 5.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.749211890162       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.759104120106       residual = 5.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.736230604832       residual = 6.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.715368299475       residual = 8.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.759857095235       residual = 5.78e-02           smallest_sin_value = 9.94e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.18e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+10 is 1.872693e-14

solving harmonic davidson linear method for identity shift 2.5000e+11, overlap shift 2.5000e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748517606566       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748517606566       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748517606566       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748517606566       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748419604558       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748517606566       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748517606566       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748639621008       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748517606566       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748213572739       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748458542092       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748498084099       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749239583408       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748109068944       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749122573488       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748549801552       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748672518767       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749294866779       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748459019298       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747551432976       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749517582398       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747521074478       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749126118681       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748846650476       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748198858245       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748213175580       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747905617264       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747447974748       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748202331041       residual = 9.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748796643619       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746976971208       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749788439521       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748274634287       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746992149141       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748595124616       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.748254436069       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.753556769604       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.753021404396       residual = 9.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748866699658       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748623280339       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.749712305275       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749354780256       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.747928229969       residual = 9.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.748571748297       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.754339860763       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747012796336       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746124861242       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.750938807049       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.740756843200       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.742631103902       residual = 2.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.741401061406       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.793550532540       residual = 2.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.741465747115       residual = 5.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.744184917199       residual = 4.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.880627139891       residual = 9.02e+00           smallest_sin_value = 9.99e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.47e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+11 is 3.417325e-15

solving harmonic davidson linear method for identity shift 1.0000e+12, overlap shift 1.0000e+13 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748517606566       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748517606566       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748517606566       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748517606566       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749371733793       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748517606566       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748509382152       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747797303939       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748259611587       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748168162029       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751073588953       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746534573935       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745246471026       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751759671054       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750358049686       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749513681054       residual = 8.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748223224044       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750305570409       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747005089413       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746558719836       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746953656113       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747234851083       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.752734114528       residual = 8.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743038753939       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746006827522       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742754664855       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741305059200       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748260757837       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739568341892       residual = 3.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.754329435832       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741693231957       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.754949774485       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743739595875       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.749886244867       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745188210434       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745886501161       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.754758957051       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.738467744356       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746447789409       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.730517043611       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.763612703833       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.730394104389       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.760494273023       residual = 7.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.735273073647       residual = 8.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.718756057188       residual = 4.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741652396949       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.715792912311       residual = 6.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.719181147885       residual = 4.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.674345721643       residual = 2.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.711975347308       residual = 7.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.756616972626       residual = 5.21e-02           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.752064808730       residual = 3.41e+00           smallest_sin_value = 9.99e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+12 is 2.821304e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.080711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0473e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8895
    reference variance = 0.409674
====================================================
  Execution time = 4.5017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5166e-01
  Total weights = 2.0000e+06
  Execution time = 3.5641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451600526144
                                         uncertainty =       0.003758230516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451600526144
                                         uncertainty =       0.003758230516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475215074
  error estimate for blocks of size 2^( 2) =       0.000499880373
  error estimate for blocks of size 2^( 3) =       0.000523444680
  error estimate for blocks of size 2^( 4) =       0.000540898770
  error estimate for blocks of size 2^( 5) =       0.000549776974
  error estimate for blocks of size 2^( 6) =       0.000556745964
  error estimate for blocks of size 2^( 7) =       0.000558506877

      target function =      -0.743854434593
              le_mean =     -22.814595859648
             les_mean =     520.957442746524
             stat err =       0.000551482146
             autocorr =       1.346736088182
   target nu stat err =       0.000551482146
   target dn stat err =       0.004025598967
      target stat err =       0.003430452730
              std dev =       0.672055602818
             le_variance =       0.451658733278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451600526144
                                         uncertainty =       0.003758230516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451600526144
                                         uncertainty =       0.003758230516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475215074
  error estimate for blocks of size 2^( 2) =       0.000499880373
  error estimate for blocks of size 2^( 3) =       0.000523444680
  error estimate for blocks of size 2^( 4) =       0.000540898770
  error estimate for blocks of size 2^( 5) =       0.000549776974
  error estimate for blocks of size 2^( 6) =       0.000556745964
  error estimate for blocks of size 2^( 7) =       0.000558506877

      target function =      -0.743854434593
              le_mean =     -22.814595859648
             les_mean =     520.957442746524
             stat err =       0.000551482146
             autocorr =       1.346736088182
   target nu stat err =       0.000551482146
   target dn stat err =       0.004025598967
      target stat err =       0.003430452730
              std dev =       0.672055602818
             le_variance =       0.451658733279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451600526144
                                         uncertainty =       0.003758230516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451600526144
                                         uncertainty =       0.003758230516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475215074
  error estimate for blocks of size 2^( 2) =       0.000499880373
  error estimate for blocks of size 2^( 3) =       0.000523444680
  error estimate for blocks of size 2^( 4) =       0.000540898770
  error estimate for blocks of size 2^( 5) =       0.000549776974
  error estimate for blocks of size 2^( 6) =       0.000556745964
  error estimate for blocks of size 2^( 7) =       0.000558506877

      target function =      -0.743854434593
              le_mean =     -22.814595859648
             les_mean =     520.957442746524
             stat err =       0.000551482146
             autocorr =       1.346736088182
   target nu stat err =       0.000551482146
   target dn stat err =       0.004025598967
      target stat err =       0.003430452730
              std dev =       0.672055602818
             le_variance =       0.451658733279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451600526144
                                         uncertainty =       0.003758230516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451600526144
                                         uncertainty =       0.003758230516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475215074
  error estimate for blocks of size 2^( 2) =       0.000499880373
  error estimate for blocks of size 2^( 3) =       0.000523444680
  error estimate for blocks of size 2^( 4) =       0.000540898770
  error estimate for blocks of size 2^( 5) =       0.000549776974
  error estimate for blocks of size 2^( 6) =       0.000556745964
  error estimate for blocks of size 2^( 7) =       0.000558506877

      target function =      -0.743854434593
              le_mean =     -22.814595859648
             les_mean =     520.957442746524
             stat err =       0.000551482146
             autocorr =       1.346736088182
   target nu stat err =       0.000551482146
   target dn stat err =       0.004025598967
      target stat err =       0.003430452730
              std dev =       0.672055602818
             le_variance =       0.451658733278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743854434593        initial  <--
     6.2500e+10     6.2500e+11             1.8727e-14        -0.743854434593
     2.5000e+11     2.5000e+12             3.4173e-15        -0.743854434593
     1.0000e+12     1.0000e+13             2.8213e-16        -0.743854434593

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8566
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2334e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8593
    reference variance = 0.764141
====================================================
  Execution time = 4.3589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4507e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4822e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444942169925
                                         uncertainty =       0.002722953912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444942169925
                                         uncertainty =       0.002722953912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471735863
  error estimate for blocks of size 2^( 2) =       0.000496679293
  error estimate for blocks of size 2^( 3) =       0.000520279309
  error estimate for blocks of size 2^( 4) =       0.000538022003
  error estimate for blocks of size 2^( 5) =       0.000548063488
  error estimate for blocks of size 2^( 6) =       0.000552776826
  error estimate for blocks of size 2^( 7) =       0.000554402857

      target function =      -0.749432355529
              le_mean =     -22.814006976068
             les_mean =     520.923983530993
             stat err =       0.000548316294
             autocorr =       1.351028510877
   target nu stat err =       0.000548316294
   target dn stat err =       0.002868841647
      target stat err =       0.002516314591
              std dev =       0.667135255722
             le_variance =       0.445069449427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281400697607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749439667742       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749439667742       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749439667742       residual = 9.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749439667600       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749439667642       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749429092970       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749862989196       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748722124932       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749723192361       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748997175322       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750167559979       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748845674618       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749348778879       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748738768542       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749314130818       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749976071335       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749298587555       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749927717144       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746714910963       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750940079719       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742014086420       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749409224439       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747391133026       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.752156744485       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749289644059       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744916756170       residual = 9.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.757005269123       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747177524507       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746590733460       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749387452173       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748773724451       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745611396187       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.752393256249       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746052543858       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741921500819       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.757967524031       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.750248777338       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.754549898763       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.755323227958       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.751602785004       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748440503549       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745045876245       residual = 9.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.727882225216       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.750702400070       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.752017958877       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.754678051161       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.729564818686       residual = 2.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.751481917986       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.723663096790       residual = 3.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.631359318055       residual = 5.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.808971059062       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.711638937892       residual = 6.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.720746304104       residual = 4.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.544923507002       residual = 3.11e+02           smallest_sin_value = 9.99e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.58e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+11 is 9.276332e-16

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749439667742       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749439667742       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749439667742       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749439667742       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749439667742       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749439802470       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749822971317       residual = 8.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748667348534       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751243296425       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749736197105       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751130636449       residual = 7.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749859092215       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746557122368       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.754338882789       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748910740073       residual = 8.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742584058261       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739196313723       residual = 5.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745705694167       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741075427817       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737026890258       residual = 7.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751798454337       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751913637735       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741837781256       residual = 3.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.764223396917       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749481752234       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.754648149807       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.731555337635       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.769085911031       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.760788296773       residual = 6.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.769119632533       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.767051113694       residual = 1.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.759468545245       residual = 5.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.756283359875       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750476707505       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.730404005692       residual = 1.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.737663257583       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746902966970       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.711543185045       residual = 7.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.760443148791       residual = 6.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.742075976544       residual = 7.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.718567507022       residual = 4.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.766530941220       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.760874607124       residual = 8.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.774623380998       residual = 4.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746827593509       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745154821305       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.717506745391       residual = 5.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.916527070773       residual = 1.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.007940729926       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.811686499971       residual = 3.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =       0.727165797358       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =       1.680372925844       residual = 3.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -2.680274485783       residual = 2.54e+03           smallest_sin_value = 9.97e-01
davidson iteration   53 stopping due to small subspace S singular value of 8.99e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+12 is 8.945435e-17

solving harmonic davidson linear method for identity shift 1.0000e+13, overlap shift 1.0000e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749439667742       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749439667742       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749439667742       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749439667742       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747119442888       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.753090145184       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748750811542       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746117873954       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.754109547404       residual = 6.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.719406597437       residual = 4.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.752912843778       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.729904941224       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.720067402973       residual = 5.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.810145417599       residual = 1.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.726256843378       residual = 5.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.737692855759       residual = 9.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.702057487735       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.756835513737       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.734687050430       residual = 9.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.766474768055       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738329285034       residual = 6.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739338481375       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.803648892448       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.739622373142       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.808170901753       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.769672560085       residual = 2.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749025091597       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.822539106110       residual = 2.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.838468336794       residual = 3.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.764377914995       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.757402795490       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.748140938822       residual = 3.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.774131014448       residual = 3.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.838977585923       residual = 4.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.727622701434       residual = 2.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.643521256912       residual = 5.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.573810308764       residual = 1.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.691563978080       residual = 2.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.763991601996       residual = 3.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.681990516769       residual = 3.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.809419918299       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.838492854888       residual = 3.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.605135115324       residual = 9.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.751740354631       residual = 2.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.879958930992       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.595715575480       residual = 3.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.674974664012       residual = 4.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.732100074280       residual = 2.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =       0.657184551437       residual = 9.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.893587498494       residual = 2.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.977414521036       residual = 8.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.929940376478       residual = 1.65e+03           smallest_sin_value = 9.98e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+13 is 1.762342e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.248928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8585e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8214
    reference variance = 0.330162
====================================================
  Execution time = 4.3461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4841e-01
  Total weights = 2.0000e+06
  Execution time = 3.5534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448442476404
                                         uncertainty =       0.003518158691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448442476404
                                         uncertainty =       0.003518158691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473503395
  error estimate for blocks of size 2^( 2) =       0.000498166946
  error estimate for blocks of size 2^( 3) =       0.000521757094
  error estimate for blocks of size 2^( 4) =       0.000538942159
  error estimate for blocks of size 2^( 5) =       0.000550157914
  error estimate for blocks of size 2^( 6) =       0.000555726565
  error estimate for blocks of size 2^( 7) =       0.000557528922

      target function =      -0.746588610034
              le_mean =     -22.814804269022
             les_mean =     520.963704539247
             stat err =       0.000550588890
             autocorr =       1.352099628484
   target nu stat err =       0.000550588890
   target dn stat err =       0.003196269355
      target stat err =       0.002770159657
              std dev =       0.669634922660
             le_variance =       0.448410929646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448442476404
                                         uncertainty =       0.003518158691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448442476404
                                         uncertainty =       0.003518158691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473503395
  error estimate for blocks of size 2^( 2) =       0.000498166946
  error estimate for blocks of size 2^( 3) =       0.000521757094
  error estimate for blocks of size 2^( 4) =       0.000538942159
  error estimate for blocks of size 2^( 5) =       0.000550157914
  error estimate for blocks of size 2^( 6) =       0.000555726565
  error estimate for blocks of size 2^( 7) =       0.000557528922

      target function =      -0.746588610034
              le_mean =     -22.814804269022
             les_mean =     520.963704539247
             stat err =       0.000550588890
             autocorr =       1.352099628478
   target nu stat err =       0.000550588890
   target dn stat err =       0.003196269355
      target stat err =       0.002770159657
              std dev =       0.669634922660
             le_variance =       0.448410929646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448442476404
                                         uncertainty =       0.003518158691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448442476404
                                         uncertainty =       0.003518158691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473503395
  error estimate for blocks of size 2^( 2) =       0.000498166946
  error estimate for blocks of size 2^( 3) =       0.000521757094
  error estimate for blocks of size 2^( 4) =       0.000538942159
  error estimate for blocks of size 2^( 5) =       0.000550157914
  error estimate for blocks of size 2^( 6) =       0.000555726565
  error estimate for blocks of size 2^( 7) =       0.000557528922

      target function =      -0.746588610034
              le_mean =     -22.814804269022
             les_mean =     520.963704539247
             stat err =       0.000550588890
             autocorr =       1.352099628484
   target nu stat err =       0.000550588890
   target dn stat err =       0.003196269355
      target stat err =       0.002770159657
              std dev =       0.669634922660
             le_variance =       0.448410929646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448442476404
                                         uncertainty =       0.003518158691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448442476404
                                         uncertainty =       0.003518158691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473503395
  error estimate for blocks of size 2^( 2) =       0.000498166946
  error estimate for blocks of size 2^( 3) =       0.000521757094
  error estimate for blocks of size 2^( 4) =       0.000538942159
  error estimate for blocks of size 2^( 5) =       0.000550157914
  error estimate for blocks of size 2^( 6) =       0.000555726565
  error estimate for blocks of size 2^( 7) =       0.000557528922

      target function =      -0.746588610034
              le_mean =     -22.814804269022
             les_mean =     520.963704539247
             stat err =       0.000550588890
             autocorr =       1.352099628484
   target nu stat err =       0.000550588890
   target dn stat err =       0.003196269355
      target stat err =       0.002770159657
              std dev =       0.669634922660
             le_variance =       0.448410929646


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746588610034        initial  <--
     6.2500e+11     6.2500e+12             9.2763e-16        -0.746588610034
     2.5000e+12     2.5000e+13             8.9454e-17        -0.746588610034
     1.0000e+13     1.0000e+14             1.7623e-17        -0.746588610034

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2420
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1983e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8162
    reference variance = 0.333467
====================================================
  Execution time = 4.4374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4537e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4984e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445467845114
                                         uncertainty =       0.002518113928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445467845114
                                         uncertainty =       0.002518113928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471893432
  error estimate for blocks of size 2^( 2) =       0.000496651465
  error estimate for blocks of size 2^( 3) =       0.000519670262
  error estimate for blocks of size 2^( 4) =       0.000536544306
  error estimate for blocks of size 2^( 5) =       0.000548250053
  error estimate for blocks of size 2^( 6) =       0.000554541313
  error estimate for blocks of size 2^( 7) =       0.000559012992

      target function =      -0.749170155674
              le_mean =     -22.814857714778
             les_mean =     520.963099144951
             stat err =       0.000549587166
             autocorr =       1.356392250293
   target nu stat err =       0.000549587166
   target dn stat err =       0.002739801629
      target stat err =       0.002412041076
              std dev =       0.667358091342
             le_variance =       0.445366822080


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281485771478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749176909570       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749176909570       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.96e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+13, overlap shift 2.5000e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749176909570       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749176909570       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.96e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+14, overlap shift 1.0000e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749176909570       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749176909570       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.96e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.250020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9365e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8053
    reference variance = 0.798326
====================================================
  Execution time = 4.5544e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.7977e-01
  Total weights = 2.0000e+06
  Execution time = 3.5540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479788106513
                                         uncertainty =       0.031235743127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479788106513
                                         uncertainty =       0.031235743127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489783076
  error estimate for blocks of size 2^( 2) =       0.000514191727
  error estimate for blocks of size 2^( 3) =       0.000536525581
  error estimate for blocks of size 2^( 4) =       0.000553652693
  error estimate for blocks of size 2^( 5) =       0.000564555278
  error estimate for blocks of size 2^( 6) =       0.000570158230
  error estimate for blocks of size 2^( 7) =       0.000576003071

      target function =      -0.720187943796
              le_mean =     -22.814530846714
             les_mean =     520.982592439681
             stat err =       0.000566092318
             autocorr =       1.335878539736
   target nu stat err =       0.000566092318
   target dn stat err =       0.031302674090
      target stat err =       0.024624622762
              std dev =       0.692657869301
             le_variance =       0.479774923905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479788106513
                                         uncertainty =       0.031235743127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479788106513
                                         uncertainty =       0.031235743127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489783076
  error estimate for blocks of size 2^( 2) =       0.000514191727
  error estimate for blocks of size 2^( 3) =       0.000536525581
  error estimate for blocks of size 2^( 4) =       0.000553652693
  error estimate for blocks of size 2^( 5) =       0.000564555278
  error estimate for blocks of size 2^( 6) =       0.000570158230
  error estimate for blocks of size 2^( 7) =       0.000576003071

      target function =      -0.720187943796
              le_mean =     -22.814530846714
             les_mean =     520.982592439681
             stat err =       0.000566092318
             autocorr =       1.335878539736
   target nu stat err =       0.000566092318
   target dn stat err =       0.031302674090
      target stat err =       0.024624622762
              std dev =       0.692657869301
             le_variance =       0.479774923905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479788106513
                                         uncertainty =       0.031235743127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479788106513
                                         uncertainty =       0.031235743127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489783076
  error estimate for blocks of size 2^( 2) =       0.000514191727
  error estimate for blocks of size 2^( 3) =       0.000536525581
  error estimate for blocks of size 2^( 4) =       0.000553652693
  error estimate for blocks of size 2^( 5) =       0.000564555278
  error estimate for blocks of size 2^( 6) =       0.000570158230
  error estimate for blocks of size 2^( 7) =       0.000576003071

      target function =      -0.720187943796
              le_mean =     -22.814530846714
             les_mean =     520.982592439681
             stat err =       0.000566092318
             autocorr =       1.335878539736
   target nu stat err =       0.000566092318
   target dn stat err =       0.031302674090
      target stat err =       0.024624622762
              std dev =       0.692657869301
             le_variance =       0.479774923905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479788106513
                                         uncertainty =       0.031235743127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479788106513
                                         uncertainty =       0.031235743127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489783076
  error estimate for blocks of size 2^( 2) =       0.000514191727
  error estimate for blocks of size 2^( 3) =       0.000536525581
  error estimate for blocks of size 2^( 4) =       0.000553652693
  error estimate for blocks of size 2^( 5) =       0.000564555278
  error estimate for blocks of size 2^( 6) =       0.000570158230
  error estimate for blocks of size 2^( 7) =       0.000576003071

      target function =      -0.720187943796
              le_mean =     -22.814530846714
             les_mean =     520.982592439681
             stat err =       0.000566092318
             autocorr =       1.335878539736
   target nu stat err =       0.000566092318
   target dn stat err =       0.031302674090
      target stat err =       0.024624622762
              std dev =       0.692657869301
             le_variance =       0.479774923905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.720187943796        initial  <--
     6.2500e+12     6.2500e+13             0.0000e+00        -0.720187943796
     2.5000e+13     2.5000e+14             0.0000e+00        -0.720187943796
     1.0000e+14     1.0000e+15             0.0000e+00        -0.720187943796

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3264
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2271e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6873
    reference variance = 0.614966
====================================================
  Execution time = 4.5610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4984e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4847e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449833452748
                                         uncertainty =       0.003709293500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449833452748
                                         uncertainty =       0.003709293500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474259314
  error estimate for blocks of size 2^( 2) =       0.000499096084
  error estimate for blocks of size 2^( 3) =       0.000522784275
  error estimate for blocks of size 2^( 4) =       0.000539858811
  error estimate for blocks of size 2^( 5) =       0.000550050447
  error estimate for blocks of size 2^( 6) =       0.000556067638
  error estimate for blocks of size 2^( 7) =       0.000559888207

      target function =      -0.745374723322
              le_mean =     -22.814975319985
             les_mean =     520.972942421137
             stat err =       0.000551466276
             autocorr =       1.352091800611
   target nu stat err =       0.000551466276
   target dn stat err =       0.003609155240
      target stat err =       0.003102010890
              std dev =       0.670703954473
             le_variance =       0.449843794546


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281497531998e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745386693405       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745386693405       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745386693405       residual = 9.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.761657190896       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.763017764655       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739545288394       residual = 4.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.787767344554       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.693667349627       residual = 1.99e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736318315993       residual = 6.15e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.655329508520       residual = 5.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.846328082816       residual = 6.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.810899735268       residual = 4.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744350126781       residual = 6.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.907005426802       residual = 1.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.617017501535       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.707400484474       residual = 1.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.700596434688       residual = 4.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.871428706627       residual = 8.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.647174943092       residual = 1.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.671073218761       residual = 6.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.846926449013       residual = 6.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.783844978451       residual = 5.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.723881525644       residual = 3.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.649007917465       residual = 8.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.662381377066       residual = 6.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.817982664452       residual = 3.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.754578995831       residual = 2.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.673669901560       residual = 3.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.634325342278       residual = 3.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912034443742       residual = 3.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.191161854538       residual = 1.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.316591447495       residual = 1.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.484714607342       residual = 3.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.422891507049       residual = 5.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.572616297045       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.294767374515       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.001841471239       residual = 2.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.406730062458       residual = 3.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.311554740343       residual = 1.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.981185011183       residual = 5.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.317548904508       residual = 1.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.731864600645       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =       0.899889177027       residual = 1.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =       0.118573457491       residual = 6.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.049168789346       residual = 1.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -2.014741851409       residual = 7.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =       0.890335821052       residual = 2.41e+03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -7.073842717836       residual = 2.08e+04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -3.019216987385       residual = 4.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -2.279139885463       residual = 3.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   50 stopping due to too large eigenvalue change
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+13 is 1.418060e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+14, overlap shift 2.5000e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745386693405       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745386693405       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745386693405       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745386693405       residual = 5.70e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.633968829763       residual = 6.95e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745386693405       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.770618123674       residual = 3.34e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939491875645       residual = 3.92e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.571190575852       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.719456013975       residual = 3.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.807329530183       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.686799815168       residual = 4.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.858169972371       residual = 3.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.719177552382       residual = 3.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.253572464473       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.035902419870       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.655920949342       residual = 4.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.593717883522       residual = 3.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.170509483446       residual = 2.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.299569181586       residual = 1.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.267838964035       residual = 1.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.874096828963       residual = 5.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.450900589215       residual = 2.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.578533856981       residual = 5.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.622731247311       residual = 9.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.471730524504       residual = 4.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       1.216553885959       residual = 1.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.453184326993       residual = 4.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.649373406072       residual = 1.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.483912569043       residual = 7.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.129218868546       residual = 4.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.007958862549       residual = 1.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       1.196107586584       residual = 2.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -2.169398565930       residual = 1.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.353959377154       residual = 1.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -2.970176582798       residual = 2.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.563983822711       residual = 4.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.972956501860       residual = 5.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       2.540238342625       residual = 6.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.835854581765       residual = 3.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =       5.853595043964       residual = 2.53e+04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       2.980716437786       residual = 8.65e+03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -4.517986737565       residual = 8.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -3.046884809321       residual = 5.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       0.288652812778       residual = 9.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -3.280850174338       residual = 5.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   46 stopping due to too large eigenvalue change
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+14 is 8.147990e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+15, overlap shift 1.0000e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745386693405       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745386693405       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745386693405       residual = 1.63e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745386693405       residual = 7.73e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745386693395       residual = 5.00e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745437040031       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739336741936       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -2.157882347315       residual = 9.26e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.043030910239       residual = 4.54e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.430767405851       residual = 1.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.347219259294       residual = 1.62e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875538196711       residual = 8.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -3.063703879556       residual = 2.92e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.419655748708       residual = 4.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -5.474218720512       residual = 1.23e+04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.500274565114       residual = 3.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -3.029476396012       residual = 4.53e+03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.747410502515       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -6.441888987794       residual = 1.49e+04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.903584941045       residual = 1.03e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.532140639421       residual = 1.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -4.049200985488       residual = 5.64e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -4.105857011853       residual = 5.61e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.347363112165       residual = 3.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       1.297151530035       residual = 3.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -2.872829989543       residual = 2.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.198998299712       residual = 5.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.587933817815       residual = 5.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       7.836439227079       residual = 3.46e+04           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to too large eigenvalue change
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+15 is 8.862874e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.346850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0559e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8351
    reference variance = 0.414653
====================================================
  Execution time = 4.3707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4594e-01
  Total weights = 2.0000e+06
  Execution time = 3.5507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445928407683
                                         uncertainty =       0.003164412793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445928407683
                                         uncertainty =       0.003164412793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472198989
  error estimate for blocks of size 2^( 2) =       0.000497097744
  error estimate for blocks of size 2^( 3) =       0.000520354348
  error estimate for blocks of size 2^( 4) =       0.000538081198
  error estimate for blocks of size 2^( 5) =       0.000548929127
  error estimate for blocks of size 2^( 6) =       0.000552844194
  error estimate for blocks of size 2^( 7) =       0.000558670205

      target function =      -0.748684430647
              le_mean =     -22.814285750861
             les_mean =     520.937577868775
             stat err =       0.000549631181
             autocorr =       1.354854380760
   target nu stat err =       0.000549631181
   target dn stat err =       0.003239362128
      target stat err =       0.002818563150
              std dev =       0.667790213932
             le_variance =       0.445943769823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445928407683
                                         uncertainty =       0.003164412793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445928407683
                                         uncertainty =       0.003164412793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472198989
  error estimate for blocks of size 2^( 2) =       0.000497097744
  error estimate for blocks of size 2^( 3) =       0.000520354348
  error estimate for blocks of size 2^( 4) =       0.000538081198
  error estimate for blocks of size 2^( 5) =       0.000548929127
  error estimate for blocks of size 2^( 6) =       0.000552844194
  error estimate for blocks of size 2^( 7) =       0.000558670205

      target function =      -0.748684430647
              le_mean =     -22.814285750861
             les_mean =     520.937577868775
             stat err =       0.000549631181
             autocorr =       1.354854380760
   target nu stat err =       0.000549631181
   target dn stat err =       0.003239362128
      target stat err =       0.002818563150
              std dev =       0.667790213932
             le_variance =       0.445943769823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445928407683
                                         uncertainty =       0.003164412793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445928407683
                                         uncertainty =       0.003164412793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472198989
  error estimate for blocks of size 2^( 2) =       0.000497097744
  error estimate for blocks of size 2^( 3) =       0.000520354348
  error estimate for blocks of size 2^( 4) =       0.000538081198
  error estimate for blocks of size 2^( 5) =       0.000548929127
  error estimate for blocks of size 2^( 6) =       0.000552844194
  error estimate for blocks of size 2^( 7) =       0.000558670205

      target function =      -0.748684430647
              le_mean =     -22.814285750861
             les_mean =     520.937577868775
             stat err =       0.000549631181
             autocorr =       1.354854380760
   target nu stat err =       0.000549631181
   target dn stat err =       0.003239362128
      target stat err =       0.002818563150
              std dev =       0.667790213932
             le_variance =       0.445943769823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445928407683
                                         uncertainty =       0.003164412793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445928407683
                                         uncertainty =       0.003164412793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472198989
  error estimate for blocks of size 2^( 2) =       0.000497097744
  error estimate for blocks of size 2^( 3) =       0.000520354348
  error estimate for blocks of size 2^( 4) =       0.000538081198
  error estimate for blocks of size 2^( 5) =       0.000548929127
  error estimate for blocks of size 2^( 6) =       0.000552844194
  error estimate for blocks of size 2^( 7) =       0.000558670205

      target function =      -0.748684430647
              le_mean =     -22.814285750861
             les_mean =     520.937577868775
             stat err =       0.000549631181
             autocorr =       1.354854380760
   target nu stat err =       0.000549631181
   target dn stat err =       0.003239362128
      target stat err =       0.002818563150
              std dev =       0.667790213932
             le_variance =       0.445943769823


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748684430647        initial
     6.2500e+13     6.2500e+14             1.4181e-18        -0.748684430647  <--
     2.5000e+14     2.5000e+15             8.1480e-19        -0.748684430647
     1.0000e+15     1.0000e+16             8.8629e-20        -0.748684430647

*****************************************************************************
Applying the update for shift_i =   6.2500e+13     and shift_s =   6.2500e+14
*****************************************************************************

  Execution time = 6.1495e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2206e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.795
    reference variance = 0.307044
====================================================
  Execution time = 4.3976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4489e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4705e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444894911171
                                         uncertainty =       0.002874026891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444894911171
                                         uncertainty =       0.002874026891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471642890
  error estimate for blocks of size 2^( 2) =       0.000496642766
  error estimate for blocks of size 2^( 3) =       0.000519850149
  error estimate for blocks of size 2^( 4) =       0.000536382223
  error estimate for blocks of size 2^( 5) =       0.000547029375
  error estimate for blocks of size 2^( 6) =       0.000552517465
  error estimate for blocks of size 2^( 7) =       0.000556645397

      target function =      -0.749581529129
              le_mean =     -22.813779943976
             les_mean =     520.913449140302
             stat err =       0.000548143615
             autocorr =       1.350710066674
   target nu stat err =       0.000548143615
   target dn stat err =       0.003255907685
      target stat err =       0.002836343157
              std dev =       0.667003771040
             le_variance =       0.444894030582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281377994398e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749591137620       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749591137620       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749591137620       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749591137620       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+14, overlap shift 2.5000e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749591137620       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749591137620       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.347942 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8689e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8398
    reference variance = 0.328321
====================================================
  Execution time = 4.3140e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4885e-01
  Total weights = 2.0000e+06
  Execution time = 3.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448824007426
                                         uncertainty =       0.003858838579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448824007426
                                         uncertainty =       0.003858838579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473736710
  error estimate for blocks of size 2^( 2) =       0.000498580594
  error estimate for blocks of size 2^( 3) =       0.000522600275
  error estimate for blocks of size 2^( 4) =       0.000539216922
  error estimate for blocks of size 2^( 5) =       0.000549627715
  error estimate for blocks of size 2^( 6) =       0.000555287009
  error estimate for blocks of size 2^( 7) =       0.000559715045

      target function =      -0.746218101150
              le_mean =     -22.814441045640
             les_mean =     520.947572942287
             stat err =       0.000550961673
             autocorr =       1.352597861875
   target nu stat err =       0.000550961673
   target dn stat err =       0.003718186760
      target stat err =       0.003196389702
              std dev =       0.669964880980
             le_variance =       0.448852941747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448824007426
                                         uncertainty =       0.003858838579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448824007426
                                         uncertainty =       0.003858838579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473736710
  error estimate for blocks of size 2^( 2) =       0.000498580594
  error estimate for blocks of size 2^( 3) =       0.000522600275
  error estimate for blocks of size 2^( 4) =       0.000539216922
  error estimate for blocks of size 2^( 5) =       0.000549627715
  error estimate for blocks of size 2^( 6) =       0.000555287009
  error estimate for blocks of size 2^( 7) =       0.000559715045

      target function =      -0.746218101150
              le_mean =     -22.814441045640
             les_mean =     520.947572942287
             stat err =       0.000550961673
             autocorr =       1.352597861875
   target nu stat err =       0.000550961673
   target dn stat err =       0.003718186760
      target stat err =       0.003196389702
              std dev =       0.669964880980
             le_variance =       0.448852941747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448824007426
                                         uncertainty =       0.003858838579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448824007426
                                         uncertainty =       0.003858838579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473736710
  error estimate for blocks of size 2^( 2) =       0.000498580594
  error estimate for blocks of size 2^( 3) =       0.000522600275
  error estimate for blocks of size 2^( 4) =       0.000539216922
  error estimate for blocks of size 2^( 5) =       0.000549627715
  error estimate for blocks of size 2^( 6) =       0.000555287009
  error estimate for blocks of size 2^( 7) =       0.000559715045

      target function =      -0.746218101150
              le_mean =     -22.814441045640
             les_mean =     520.947572942287
             stat err =       0.000550961673
             autocorr =       1.352597861875
   target nu stat err =       0.000550961673
   target dn stat err =       0.003718186760
      target stat err =       0.003196389702
              std dev =       0.669964880980
             le_variance =       0.448852941747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448824007426
                                         uncertainty =       0.003858838579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448824007426
                                         uncertainty =       0.003858838579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473736710
  error estimate for blocks of size 2^( 2) =       0.000498580594
  error estimate for blocks of size 2^( 3) =       0.000522600275
  error estimate for blocks of size 2^( 4) =       0.000539216922
  error estimate for blocks of size 2^( 5) =       0.000549627715
  error estimate for blocks of size 2^( 6) =       0.000555287009
  error estimate for blocks of size 2^( 7) =       0.000559715045

      target function =      -0.746218101150
              le_mean =     -22.814441045640
             les_mean =     520.947572942287
             stat err =       0.000550961673
             autocorr =       1.352597861875
   target nu stat err =       0.000550961673
   target dn stat err =       0.003718186760
      target stat err =       0.003196389702
              std dev =       0.669964880980
             le_variance =       0.448852941747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746218101150        initial  <--
     1.5625e+13     1.5625e+14             0.0000e+00        -0.746218101150
     6.2500e+13     6.2500e+14             0.0000e+00        -0.746218101150
     2.5000e+14     2.5000e+15             0.0000e+00        -0.746218101150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9094
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1961e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.9071
    reference variance = 0.347362
====================================================
  Execution time = 4.5694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5982e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4935e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459776613335
                                         uncertainty =       0.010155262153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459776613335
                                         uncertainty =       0.010155262153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479490208
  error estimate for blocks of size 2^( 2) =       0.000504397698
  error estimate for blocks of size 2^( 3) =       0.000527467876
  error estimate for blocks of size 2^( 4) =       0.000544326765
  error estimate for blocks of size 2^( 5) =       0.000554359888
  error estimate for blocks of size 2^( 6) =       0.000559493709
  error estimate for blocks of size 2^( 7) =       0.000562479033

      target function =      -0.736978850073
              le_mean =     -22.814960732187
             les_mean =     520.982254700441
             stat err =       0.000555164849
             autocorr =       1.340554378407
   target nu stat err =       0.000555164849
   target dn stat err =       0.010467198139
      target stat err =       0.008638830118
              std dev =       0.678101555168
             le_variance =       0.459821719121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281496073219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+14, overlap shift 1.5625e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737079472363       residual = 9.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737079472363       residual = 9.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737079472363       residual = 9.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737079472363       residual = 9.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+15, overlap shift 2.5000e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737079472363       residual = 9.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737079472363       residual = 9.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.349033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0637e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8621
    reference variance = 0.418498
====================================================
  Execution time = 4.5003e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.9274e-01
  Total weights = 2.0000e+06
  Execution time = 3.5435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492839193596
                                         uncertainty =       0.042274598326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492839193596
                                         uncertainty =       0.042274598326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496357098
  error estimate for blocks of size 2^( 2) =       0.000520033301
  error estimate for blocks of size 2^( 3) =       0.000542517047
  error estimate for blocks of size 2^( 4) =       0.000558677934
  error estimate for blocks of size 2^( 5) =       0.000568884622
  error estimate for blocks of size 2^( 6) =       0.000573634125
  error estimate for blocks of size 2^( 7) =       0.000574517307

      target function =      -0.709497734202
              le_mean =     -22.814140831400
             les_mean =     520.977762365993
             stat err =       0.000568928497
             autocorr =       1.313792873356
   target nu stat err =       0.000568928497
   target dn stat err =       0.042778511354
      target stat err =       0.032667196465
              std dev =       0.701954939738
             le_variance =       0.492740737423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492839193596
                                         uncertainty =       0.042274598326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492839193596
                                         uncertainty =       0.042274598326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496357098
  error estimate for blocks of size 2^( 2) =       0.000520033301
  error estimate for blocks of size 2^( 3) =       0.000542517047
  error estimate for blocks of size 2^( 4) =       0.000558677934
  error estimate for blocks of size 2^( 5) =       0.000568884622
  error estimate for blocks of size 2^( 6) =       0.000573634125
  error estimate for blocks of size 2^( 7) =       0.000574517307

      target function =      -0.709497734202
              le_mean =     -22.814140831400
             les_mean =     520.977762365993
             stat err =       0.000568928497
             autocorr =       1.313792873360
   target nu stat err =       0.000568928497
   target dn stat err =       0.042778511354
      target stat err =       0.032667196465
              std dev =       0.701954939738
             le_variance =       0.492740737423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492839193596
                                         uncertainty =       0.042274598326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492839193596
                                         uncertainty =       0.042274598326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496357098
  error estimate for blocks of size 2^( 2) =       0.000520033301
  error estimate for blocks of size 2^( 3) =       0.000542517047
  error estimate for blocks of size 2^( 4) =       0.000558677934
  error estimate for blocks of size 2^( 5) =       0.000568884622
  error estimate for blocks of size 2^( 6) =       0.000573634125
  error estimate for blocks of size 2^( 7) =       0.000574517307

      target function =      -0.709497734202
              le_mean =     -22.814140831400
             les_mean =     520.977762365993
             stat err =       0.000568928497
             autocorr =       1.313792873360
   target nu stat err =       0.000568928497
   target dn stat err =       0.042778511354
      target stat err =       0.032667196465
              std dev =       0.701954939738
             le_variance =       0.492740737423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492839193596
                                         uncertainty =       0.042274598326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.492839193596
                                         uncertainty =       0.042274598326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496357098
  error estimate for blocks of size 2^( 2) =       0.000520033301
  error estimate for blocks of size 2^( 3) =       0.000542517047
  error estimate for blocks of size 2^( 4) =       0.000558677934
  error estimate for blocks of size 2^( 5) =       0.000568884622
  error estimate for blocks of size 2^( 6) =       0.000573634125
  error estimate for blocks of size 2^( 7) =       0.000574517307

      target function =      -0.709497734202
              le_mean =     -22.814140831400
             les_mean =     520.977762365993
             stat err =       0.000568928497
             autocorr =       1.313792873360
   target nu stat err =       0.000568928497
   target dn stat err =       0.042778511354
      target stat err =       0.032667196465
              std dev =       0.701954939738
             le_variance =       0.492740737423


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.709497734202        initial  <--
     1.5625e+14     1.5625e+15             0.0000e+00        -0.709497734202
     6.2500e+14     6.2500e+15             0.0000e+00        -0.709497734202
     2.5000e+15     2.5000e+16             0.0000e+00        -0.709497734202

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.7488
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2339e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7541
    reference variance = 0.284216
====================================================
  Execution time = 4.4269e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4523e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4774e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445297965470
                                         uncertainty =       0.003027318150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445297965470
                                         uncertainty =       0.003027318150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471820695
  error estimate for blocks of size 2^( 2) =       0.000496855508
  error estimate for blocks of size 2^( 3) =       0.000520377671
  error estimate for blocks of size 2^( 4) =       0.000537906823
  error estimate for blocks of size 2^( 5) =       0.000548365875
  error estimate for blocks of size 2^( 6) =       0.000554625862
  error estimate for blocks of size 2^( 7) =       0.000557910172

      target function =      -0.749275427619
              le_mean =     -22.815559134022
             les_mean =     520.994967911576
             stat err =       0.000549702183
             autocorr =       1.357378454679
   target nu stat err =       0.000549702183
   target dn stat err =       0.003143034681
      target stat err =       0.002748431783
              std dev =       0.667255225645
             le_variance =       0.445229536150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281555913402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+15, overlap shift 1.5625e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749284526969       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749284526969       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.88e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+15, overlap shift 6.2500e+16 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749284526969       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749284526969       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.88e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+16, overlap shift 2.5000e+17 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749284526969       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749284526969       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.350142 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9051e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8154
    reference variance = 0.339328
====================================================
  Execution time = 4.3073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6168e-01
  Total weights = 2.0000e+06
  Execution time = 3.5601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461680503173
                                         uncertainty =       0.007740836161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461680503173
                                         uncertainty =       0.007740836161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480457958
  error estimate for blocks of size 2^( 2) =       0.000504598731
  error estimate for blocks of size 2^( 3) =       0.000527501114
  error estimate for blocks of size 2^( 4) =       0.000543946195
  error estimate for blocks of size 2^( 5) =       0.000554258085
  error estimate for blocks of size 2^( 6) =       0.000560856384
  error estimate for blocks of size 2^( 7) =       0.000562665871

      target function =      -0.735497581540
              le_mean =     -22.815037345854
             les_mean =     520.987608560830
             stat err =       0.000555431634
             autocorr =       1.336442994420
   target nu stat err =       0.000555431634
   target dn stat err =       0.007630199794
      target stat err =       0.006286807223
              std dev =       0.679470160460
             le_variance =       0.461679698956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461680503173
                                         uncertainty =       0.007740836161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461680503173
                                         uncertainty =       0.007740836161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480457958
  error estimate for blocks of size 2^( 2) =       0.000504598731
  error estimate for blocks of size 2^( 3) =       0.000527501114
  error estimate for blocks of size 2^( 4) =       0.000543946195
  error estimate for blocks of size 2^( 5) =       0.000554258085
  error estimate for blocks of size 2^( 6) =       0.000560856384
  error estimate for blocks of size 2^( 7) =       0.000562665871

      target function =      -0.735497581540
              le_mean =     -22.815037345854
             les_mean =     520.987608560830
             stat err =       0.000555431634
             autocorr =       1.336442994416
   target nu stat err =       0.000555431634
   target dn stat err =       0.007630199794
      target stat err =       0.006286807223
              std dev =       0.679470160460
             le_variance =       0.461679698956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461680503173
                                         uncertainty =       0.007740836161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461680503173
                                         uncertainty =       0.007740836161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480457958
  error estimate for blocks of size 2^( 2) =       0.000504598731
  error estimate for blocks of size 2^( 3) =       0.000527501114
  error estimate for blocks of size 2^( 4) =       0.000543946195
  error estimate for blocks of size 2^( 5) =       0.000554258085
  error estimate for blocks of size 2^( 6) =       0.000560856384
  error estimate for blocks of size 2^( 7) =       0.000562665871

      target function =      -0.735497581540
              le_mean =     -22.815037345854
             les_mean =     520.987608560830
             stat err =       0.000555431634
             autocorr =       1.336442994416
   target nu stat err =       0.000555431634
   target dn stat err =       0.007630199794
      target stat err =       0.006286807223
              std dev =       0.679470160460
             le_variance =       0.461679698956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461680503173
                                         uncertainty =       0.007740836161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461680503173
                                         uncertainty =       0.007740836161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480457958
  error estimate for blocks of size 2^( 2) =       0.000504598731
  error estimate for blocks of size 2^( 3) =       0.000527501114
  error estimate for blocks of size 2^( 4) =       0.000543946195
  error estimate for blocks of size 2^( 5) =       0.000554258085
  error estimate for blocks of size 2^( 6) =       0.000560856384
  error estimate for blocks of size 2^( 7) =       0.000562665871

      target function =      -0.735497581540
              le_mean =     -22.815037345854
             les_mean =     520.987608560830
             stat err =       0.000555431634
             autocorr =       1.336442994416
   target nu stat err =       0.000555431634
   target dn stat err =       0.007630199794
      target stat err =       0.006286807223
              std dev =       0.679470160460
             le_variance =       0.461679698956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.735497581540        initial  <--
     1.5625e+15     1.5625e+16             0.0000e+00        -0.735497581540
     6.2500e+15     6.2500e+16             0.0000e+00        -0.735497581540
     2.5000e+16     2.5000e+17             0.0000e+00        -0.735497581540

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9096
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1997e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8132
    reference variance = 0.533941
====================================================
  Execution time = 4.4150e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5321e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4909e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453272610380
                                         uncertainty =       0.004495904671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453272610380
                                         uncertainty =       0.004495904671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476031329
  error estimate for blocks of size 2^( 2) =       0.000500941296
  error estimate for blocks of size 2^( 3) =       0.000523901013
  error estimate for blocks of size 2^( 4) =       0.000541014712
  error estimate for blocks of size 2^( 5) =       0.000551615673
  error estimate for blocks of size 2^( 6) =       0.000558959927
  error estimate for blocks of size 2^( 7) =       0.000562942401

      target function =      -0.742535286393
              le_mean =     -22.815335289122
             les_mean =     520.992735780805
             stat err =       0.000553633178
             autocorr =       1.352611719968
   target nu stat err =       0.000553633178
   target dn stat err =       0.004478150091
      target stat err =       0.003795431383
              std dev =       0.673209961562
             le_variance =       0.453211652347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281533528912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+16, overlap shift 1.5625e+17 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742553521295       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742553521295       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742553521295       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742553521295       residual = 7.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742553521295       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+16 is 8.733221e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+16, overlap shift 6.2500e+17 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742553521295       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742553521295       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742553521295       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.775140835074       residual = 4.62e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       8.267463166104       residual = 3.80e+04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+16 is 2.183305e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+17, overlap shift 2.5000e+18 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742553521295       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742553521295       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742553521295       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742553521295       residual = 8.85e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+17 is 5.458263e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.352053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9067e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7711
    reference variance = 0.543061
====================================================
  Execution time = 4.4726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5358e-01
  Total weights = 2.0000e+06
  Execution time = 3.5796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453563741965
                                         uncertainty =       0.005804385038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453563741965
                                         uncertainty =       0.005804385038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476224137
  error estimate for blocks of size 2^( 2) =       0.000500696838
  error estimate for blocks of size 2^( 3) =       0.000523739304
  error estimate for blocks of size 2^( 4) =       0.000541402934
  error estimate for blocks of size 2^( 5) =       0.000552547500
  error estimate for blocks of size 2^( 6) =       0.000557595565
  error estimate for blocks of size 2^( 7) =       0.000562312890

      target function =      -0.742222948686
              le_mean =     -22.815126897100
             les_mean =     520.983593960858
             stat err =       0.000553464722
             autocorr =       1.350694346934
   target nu stat err =       0.000553464722
   target dn stat err =       0.005532365531
      target stat err =       0.004661746587
              std dev =       0.673482632940
             le_variance =       0.453578856872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453563741965
                                         uncertainty =       0.005804385038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453563741965
                                         uncertainty =       0.005804385038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476224137
  error estimate for blocks of size 2^( 2) =       0.000500696838
  error estimate for blocks of size 2^( 3) =       0.000523739304
  error estimate for blocks of size 2^( 4) =       0.000541402934
  error estimate for blocks of size 2^( 5) =       0.000552547500
  error estimate for blocks of size 2^( 6) =       0.000557595565
  error estimate for blocks of size 2^( 7) =       0.000562312890

      target function =      -0.742222948686
              le_mean =     -22.815126897100
             les_mean =     520.983593960858
             stat err =       0.000553464722
             autocorr =       1.350694346932
   target nu stat err =       0.000553464722
   target dn stat err =       0.005532365531
      target stat err =       0.004661746587
              std dev =       0.673482632940
             le_variance =       0.453578856872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453563741965
                                         uncertainty =       0.005804385038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453563741965
                                         uncertainty =       0.005804385038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476224137
  error estimate for blocks of size 2^( 2) =       0.000500696838
  error estimate for blocks of size 2^( 3) =       0.000523739304
  error estimate for blocks of size 2^( 4) =       0.000541402934
  error estimate for blocks of size 2^( 5) =       0.000552547500
  error estimate for blocks of size 2^( 6) =       0.000557595565
  error estimate for blocks of size 2^( 7) =       0.000562312890

      target function =      -0.742222948686
              le_mean =     -22.815126897100
             les_mean =     520.983593960858
             stat err =       0.000553464722
             autocorr =       1.350694346932
   target nu stat err =       0.000553464722
   target dn stat err =       0.005532365531
      target stat err =       0.004661746587
              std dev =       0.673482632940
             le_variance =       0.453578856872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453563741965
                                         uncertainty =       0.005804385038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453563741965
                                         uncertainty =       0.005804385038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476224137
  error estimate for blocks of size 2^( 2) =       0.000500696838
  error estimate for blocks of size 2^( 3) =       0.000523739304
  error estimate for blocks of size 2^( 4) =       0.000541402934
  error estimate for blocks of size 2^( 5) =       0.000552547500
  error estimate for blocks of size 2^( 6) =       0.000557595565
  error estimate for blocks of size 2^( 7) =       0.000562312890

      target function =      -0.742222948686
              le_mean =     -22.815126897100
             les_mean =     520.983593960858
             stat err =       0.000553464722
             autocorr =       1.350694346932
   target nu stat err =       0.000553464722
   target dn stat err =       0.005532365531
      target stat err =       0.004661746587
              std dev =       0.673482632940
             le_variance =       0.453578856872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742222948686        initial  <--
     1.5625e+16     1.5625e+17             8.7332e-21        -0.742222948686
     6.2500e+16     6.2500e+17             2.1833e-21        -0.742222948686
     2.5000e+17     2.5000e+18             5.4583e-22        -0.742222948686

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6224
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2170e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7317
    reference variance = 0.412555
====================================================
  Execution time = 4.5710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4477e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5217e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444795401539
                                         uncertainty =       0.002509862140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444795401539
                                         uncertainty =       0.002509862140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471575306
  error estimate for blocks of size 2^( 2) =       0.000496678730
  error estimate for blocks of size 2^( 3) =       0.000519702510
  error estimate for blocks of size 2^( 4) =       0.000536832327
  error estimate for blocks of size 2^( 5) =       0.000548768624
  error estimate for blocks of size 2^( 6) =       0.000557020540
  error estimate for blocks of size 2^( 7) =       0.000560812218

      target function =      -0.749673957403
              le_mean =     -22.815427228837
             les_mean =     520.988485950711
             stat err =       0.000550858427
             autocorr =       1.364513651371
   target nu stat err =       0.000550858427
   target dn stat err =       0.002738498238
      target stat err =       0.002416564668
              std dev =       0.666908193642
             le_variance =       0.444766538747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281542722884e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+17, overlap shift 1.5625e+18 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749680719224       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749680719224       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+17, overlap shift 6.2500e+18 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749680719224       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749680719224       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+18, overlap shift 2.5000e+19 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749680719224       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749680719224       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.353168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0934e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7946
    reference variance = 0.382185
====================================================
  Execution time = 4.4171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5878e-01
  Total weights = 2.0000e+06
  Execution time = 3.5445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458833632050
                                         uncertainty =       0.007821714272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458833632050
                                         uncertainty =       0.007821714272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478946159
  error estimate for blocks of size 2^( 2) =       0.000503612287
  error estimate for blocks of size 2^( 3) =       0.000526376554
  error estimate for blocks of size 2^( 4) =       0.000544057000
  error estimate for blocks of size 2^( 5) =       0.000554906361
  error estimate for blocks of size 2^( 6) =       0.000561904653
  error estimate for blocks of size 2^( 7) =       0.000563971973

      target function =      -0.737876302903
              le_mean =     -22.815085325088
             les_mean =     520.986897008214
             stat err =       0.000556209997
             autocorr =       1.348665322707
   target nu stat err =       0.000556209997
   target dn stat err =       0.007992135029
      target stat err =       0.006625265311
              std dev =       0.677332153792
             le_variance =       0.458778846560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458833632050
                                         uncertainty =       0.007821714272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458833632050
                                         uncertainty =       0.007821714272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478946159
  error estimate for blocks of size 2^( 2) =       0.000503612287
  error estimate for blocks of size 2^( 3) =       0.000526376554
  error estimate for blocks of size 2^( 4) =       0.000544057000
  error estimate for blocks of size 2^( 5) =       0.000554906361
  error estimate for blocks of size 2^( 6) =       0.000561904653
  error estimate for blocks of size 2^( 7) =       0.000563971973

      target function =      -0.737876302903
              le_mean =     -22.815085325088
             les_mean =     520.986897008214
             stat err =       0.000556209997
             autocorr =       1.348665322707
   target nu stat err =       0.000556209997
   target dn stat err =       0.007992135029
      target stat err =       0.006625265311
              std dev =       0.677332153792
             le_variance =       0.458778846560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458833632050
                                         uncertainty =       0.007821714272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458833632050
                                         uncertainty =       0.007821714272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478946159
  error estimate for blocks of size 2^( 2) =       0.000503612287
  error estimate for blocks of size 2^( 3) =       0.000526376554
  error estimate for blocks of size 2^( 4) =       0.000544057000
  error estimate for blocks of size 2^( 5) =       0.000554906361
  error estimate for blocks of size 2^( 6) =       0.000561904653
  error estimate for blocks of size 2^( 7) =       0.000563971973

      target function =      -0.737876302903
              le_mean =     -22.815085325088
             les_mean =     520.986897008214
             stat err =       0.000556209997
             autocorr =       1.348665322707
   target nu stat err =       0.000556209997
   target dn stat err =       0.007992135029
      target stat err =       0.006625265311
              std dev =       0.677332153792
             le_variance =       0.458778846560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458833632050
                                         uncertainty =       0.007821714272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458833632050
                                         uncertainty =       0.007821714272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478946159
  error estimate for blocks of size 2^( 2) =       0.000503612287
  error estimate for blocks of size 2^( 3) =       0.000526376554
  error estimate for blocks of size 2^( 4) =       0.000544057000
  error estimate for blocks of size 2^( 5) =       0.000554906361
  error estimate for blocks of size 2^( 6) =       0.000561904653
  error estimate for blocks of size 2^( 7) =       0.000563971973

      target function =      -0.737876302903
              le_mean =     -22.815085325088
             les_mean =     520.986897008214
             stat err =       0.000556209997
             autocorr =       1.348665322707
   target nu stat err =       0.000556209997
   target dn stat err =       0.007992135029
      target stat err =       0.006625265311
              std dev =       0.677332153792
             le_variance =       0.458778846560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737876302903        initial  <--
     1.5625e+17     1.5625e+18             0.0000e+00        -0.737876302903
     6.2500e+17     6.2500e+18             0.0000e+00        -0.737876302903
     2.5000e+18     2.5000e+19             0.0000e+00        -0.737876302903

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9148
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2302e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.911
    reference variance = 0.42805
====================================================
  Execution time = 4.4262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5483e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5149e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453679906727
                                         uncertainty =       0.004737507141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453679906727
                                         uncertainty =       0.004737507141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476882136
  error estimate for blocks of size 2^( 2) =       0.000501509179
  error estimate for blocks of size 2^( 3) =       0.000524658883
  error estimate for blocks of size 2^( 4) =       0.000540966973
  error estimate for blocks of size 2^( 5) =       0.000551560206
  error estimate for blocks of size 2^( 6) =       0.000558593582
  error estimate for blocks of size 2^( 7) =       0.000561454819

      target function =      -0.741175269663
              le_mean =     -22.815367412960
             les_mean =     520.995823103834
             stat err =       0.000553143895
             autocorr =       1.345408414259
   target nu stat err =       0.000553143895
   target dn stat err =       0.005017363270
      target stat err =       0.004225564282
              std dev =       0.674413184100
             le_variance =       0.454833142888


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281536741296e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+18, overlap shift 1.5625e+19 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741199526607       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741199526607       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741199526607       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741199523219       residual = 2.00e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+18 is 6.341799e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+18, overlap shift 6.2500e+19 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741199526607       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741199526607       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741199526607       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+18 is 1.585450e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+19, overlap shift 2.5000e+20 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741199526607       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741199526607       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741199526607       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+19 is 3.963625e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.354680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9419e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7704
    reference variance = 0.370656
====================================================
  Execution time = 4.3347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4861e-01
  Total weights = 2.0000e+06
  Execution time = 3.5393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448690067066
                                         uncertainty =       0.006058703694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448690067066
                                         uncertainty =       0.006058703694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473606617
  error estimate for blocks of size 2^( 2) =       0.000498698360
  error estimate for blocks of size 2^( 3) =       0.000522074034
  error estimate for blocks of size 2^( 4) =       0.000539017821
  error estimate for blocks of size 2^( 5) =       0.000549332919
  error estimate for blocks of size 2^( 6) =       0.000554907991
  error estimate for blocks of size 2^( 7) =       0.000559677844

      target function =      -0.746388641517
              le_mean =     -22.815325476771
             les_mean =     520.987682842074
             stat err =       0.000550734144
             autocorr =       1.352223507459
   target nu stat err =       0.000550734144
   target dn stat err =       0.006084165584
      target stat err =       0.005177208463
              std dev =       0.669780901013
             le_variance =       0.448606455361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448690067066
                                         uncertainty =       0.006058703694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448690067066
                                         uncertainty =       0.006058703694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473606617
  error estimate for blocks of size 2^( 2) =       0.000498698360
  error estimate for blocks of size 2^( 3) =       0.000522074034
  error estimate for blocks of size 2^( 4) =       0.000539017821
  error estimate for blocks of size 2^( 5) =       0.000549332919
  error estimate for blocks of size 2^( 6) =       0.000554907991
  error estimate for blocks of size 2^( 7) =       0.000559677844

      target function =      -0.746388641517
              le_mean =     -22.815325476771
             les_mean =     520.987682842074
             stat err =       0.000550734144
             autocorr =       1.352223507459
   target nu stat err =       0.000550734144
   target dn stat err =       0.006084165584
      target stat err =       0.005177208463
              std dev =       0.669780901013
             le_variance =       0.448606455361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448690067066
                                         uncertainty =       0.006058703694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448690067066
                                         uncertainty =       0.006058703694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473606617
  error estimate for blocks of size 2^( 2) =       0.000498698360
  error estimate for blocks of size 2^( 3) =       0.000522074034
  error estimate for blocks of size 2^( 4) =       0.000539017821
  error estimate for blocks of size 2^( 5) =       0.000549332919
  error estimate for blocks of size 2^( 6) =       0.000554907991
  error estimate for blocks of size 2^( 7) =       0.000559677844

      target function =      -0.746388641517
              le_mean =     -22.815325476771
             les_mean =     520.987682842074
             stat err =       0.000550734144
             autocorr =       1.352223507459
   target nu stat err =       0.000550734144
   target dn stat err =       0.006084165584
      target stat err =       0.005177208463
              std dev =       0.669780901013
             le_variance =       0.448606455361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448690067066
                                         uncertainty =       0.006058703694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448690067066
                                         uncertainty =       0.006058703694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473606617
  error estimate for blocks of size 2^( 2) =       0.000498698360
  error estimate for blocks of size 2^( 3) =       0.000522074034
  error estimate for blocks of size 2^( 4) =       0.000539017821
  error estimate for blocks of size 2^( 5) =       0.000549332919
  error estimate for blocks of size 2^( 6) =       0.000554907991
  error estimate for blocks of size 2^( 7) =       0.000559677844

      target function =      -0.746388641517
              le_mean =     -22.815325476771
             les_mean =     520.987682842074
             stat err =       0.000550734144
             autocorr =       1.352223507459
   target nu stat err =       0.000550734144
   target dn stat err =       0.006084165584
      target stat err =       0.005177208463
              std dev =       0.669780901013
             le_variance =       0.448606455361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746388641517        initial  <--
     1.5625e+18     1.5625e+19             6.3418e-23        -0.746388641517
     6.2500e+18     6.2500e+19             1.5854e-23        -0.746388641517
     2.5000e+19     2.5000e+20             3.9636e-24        -0.746388641517

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1057
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2054e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8358
    reference variance = 0.290608
====================================================
  Execution time = 4.5852e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6058e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4806e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460620721251
                                         uncertainty =       0.009465842750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460620721251
                                         uncertainty =       0.009465842750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479886841
  error estimate for blocks of size 2^( 2) =       0.000504763670
  error estimate for blocks of size 2^( 3) =       0.000527370419
  error estimate for blocks of size 2^( 4) =       0.000544641010
  error estimate for blocks of size 2^( 5) =       0.000554023517
  error estimate for blocks of size 2^( 6) =       0.000559985124
  error estimate for blocks of size 2^( 7) =       0.000561833513

      target function =      -0.736372857128
              le_mean =     -22.815082535012
             les_mean =     520.988573610331
             stat err =       0.000555120791
             autocorr =       1.338126906041
   target nu stat err =       0.000555120791
   target dn stat err =       0.009225274286
      target stat err =       0.007608146176
              std dev =       0.678662479605
             le_variance =       0.460582761223


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281508253501e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+19, overlap shift 1.5625e+20 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736449606232       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736449606232       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736449606232       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+19 is 6.043989e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+19, overlap shift 6.2500e+20 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736449606232       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736449606232       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736449606232       residual = 5.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+19 is 1.510997e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+20, overlap shift 2.5000e+21 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736449606232       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736449606232       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736449606232       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+20 is 3.777493e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.356043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0664e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8227
    reference variance = 1.25565
====================================================
  Execution time = 4.5433e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5589e-01
  Total weights = 2.0000e+06
  Execution time = 3.5559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455816266986
                                         uncertainty =       0.004587951302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455816266986
                                         uncertainty =       0.004587951302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477438027
  error estimate for blocks of size 2^( 2) =       0.000502335797
  error estimate for blocks of size 2^( 3) =       0.000524632295
  error estimate for blocks of size 2^( 4) =       0.000540741139
  error estimate for blocks of size 2^( 5) =       0.000552233411
  error estimate for blocks of size 2^( 6) =       0.000559201196
  error estimate for blocks of size 2^( 7) =       0.000561616306

      target function =      -0.740291083338
              le_mean =     -22.815567412679
             les_mean =     521.006010274341
             stat err =       0.000553448013
             autocorr =       1.343753631727
   target nu stat err =       0.000553448013
   target dn stat err =       0.004692864203
      target stat err =       0.003950299038
              std dev =       0.675199333388
             le_variance =       0.455894139808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455816266986
                                         uncertainty =       0.004587951302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455816266986
                                         uncertainty =       0.004587951302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477438027
  error estimate for blocks of size 2^( 2) =       0.000502335797
  error estimate for blocks of size 2^( 3) =       0.000524632295
  error estimate for blocks of size 2^( 4) =       0.000540741139
  error estimate for blocks of size 2^( 5) =       0.000552233411
  error estimate for blocks of size 2^( 6) =       0.000559201196
  error estimate for blocks of size 2^( 7) =       0.000561616306

      target function =      -0.740291083338
              le_mean =     -22.815567412679
             les_mean =     521.006010274341
             stat err =       0.000553448013
             autocorr =       1.343753631727
   target nu stat err =       0.000553448013
   target dn stat err =       0.004692864203
      target stat err =       0.003950299038
              std dev =       0.675199333388
             le_variance =       0.455894139808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455816266986
                                         uncertainty =       0.004587951302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455816266986
                                         uncertainty =       0.004587951302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477438027
  error estimate for blocks of size 2^( 2) =       0.000502335797
  error estimate for blocks of size 2^( 3) =       0.000524632295
  error estimate for blocks of size 2^( 4) =       0.000540741139
  error estimate for blocks of size 2^( 5) =       0.000552233411
  error estimate for blocks of size 2^( 6) =       0.000559201196
  error estimate for blocks of size 2^( 7) =       0.000561616306

      target function =      -0.740291083338
              le_mean =     -22.815567412679
             les_mean =     521.006010274341
             stat err =       0.000553448013
             autocorr =       1.343753631727
   target nu stat err =       0.000553448013
   target dn stat err =       0.004692864203
      target stat err =       0.003950299038
              std dev =       0.675199333388
             le_variance =       0.455894139808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455816266986
                                         uncertainty =       0.004587951302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455816266986
                                         uncertainty =       0.004587951302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477438027
  error estimate for blocks of size 2^( 2) =       0.000502335797
  error estimate for blocks of size 2^( 3) =       0.000524632295
  error estimate for blocks of size 2^( 4) =       0.000540741139
  error estimate for blocks of size 2^( 5) =       0.000552233411
  error estimate for blocks of size 2^( 6) =       0.000559201196
  error estimate for blocks of size 2^( 7) =       0.000561616306

      target function =      -0.740291083338
              le_mean =     -22.815567412679
             les_mean =     521.006010274341
             stat err =       0.000553448013
             autocorr =       1.343753631727
   target nu stat err =       0.000553448013
   target dn stat err =       0.004692864203
      target stat err =       0.003950299038
              std dev =       0.675199333388
             le_variance =       0.455894139808


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740291083338        initial  <--
     1.5625e+19     1.5625e+20             6.0440e-24        -0.740291083338
     6.2500e+19     6.2500e+20             1.5110e-24        -0.740291083338
     2.5000e+20     2.5000e+21             3.7775e-25        -0.740291083338

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2376
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2391e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8469
    reference variance = 0.354438
====================================================
  Execution time = 4.3434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5227e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4661e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452374247367
                                         uncertainty =       0.004334299657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452374247367
                                         uncertainty =       0.004334299657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475538116
  error estimate for blocks of size 2^( 2) =       0.000500215614
  error estimate for blocks of size 2^( 3) =       0.000523696419
  error estimate for blocks of size 2^( 4) =       0.000540513467
  error estimate for blocks of size 2^( 5) =       0.000550963588
  error estimate for blocks of size 2^( 6) =       0.000555655495
  error estimate for blocks of size 2^( 7) =       0.000560280365

      target function =      -0.743317174196
              le_mean =     -22.815601424072
             les_mean =     521.003941114950
             stat err =       0.000551853229
             autocorr =       1.346717521323
   target nu stat err =       0.000551853229
   target dn stat err =       0.004173120567
      target stat err =       0.003552549465
              std dev =       0.672512452636
             le_variance =       0.452272998950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281560142407e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+20, overlap shift 1.5625e+21 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743333200373       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743333200373       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+20, overlap shift 6.2500e+21 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743333200373       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743333200373       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+21, overlap shift 2.5000e+22 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743333200373       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743333200373       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.357198 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8102e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7717
    reference variance = 0.277269
====================================================
  Execution time = 4.3737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4653e-01
  Total weights = 2.0000e+06
  Execution time = 3.5378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446595646540
                                         uncertainty =       0.003388247275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446595646540
                                         uncertainty =       0.003388247275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472510293
  error estimate for blocks of size 2^( 2) =       0.000497816305
  error estimate for blocks of size 2^( 3) =       0.000521213947
  error estimate for blocks of size 2^( 4) =       0.000537924940
  error estimate for blocks of size 2^( 5) =       0.000548807391
  error estimate for blocks of size 2^( 6) =       0.000555230593
  error estimate for blocks of size 2^( 7) =       0.000556289734

      target function =      -0.748175899309
              le_mean =     -22.814970580898
             les_mean =     520.969414338658
             stat err =       0.000549563165
             autocorr =       1.352734865696
   target nu stat err =       0.000549563165
   target dn stat err =       0.003297029227
      target stat err =       0.002865463346
              std dev =       0.668230465239
             le_variance =       0.446531954674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446595646540
                                         uncertainty =       0.003388247275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446595646540
                                         uncertainty =       0.003388247275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472510293
  error estimate for blocks of size 2^( 2) =       0.000497816305
  error estimate for blocks of size 2^( 3) =       0.000521213947
  error estimate for blocks of size 2^( 4) =       0.000537924940
  error estimate for blocks of size 2^( 5) =       0.000548807391
  error estimate for blocks of size 2^( 6) =       0.000555230593
  error estimate for blocks of size 2^( 7) =       0.000556289734

      target function =      -0.748175899309
              le_mean =     -22.814970580898
             les_mean =     520.969414338658
             stat err =       0.000549563165
             autocorr =       1.352734865696
   target nu stat err =       0.000549563165
   target dn stat err =       0.003297029227
      target stat err =       0.002865463346
              std dev =       0.668230465239
             le_variance =       0.446531954674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446595646540
                                         uncertainty =       0.003388247275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446595646540
                                         uncertainty =       0.003388247275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472510293
  error estimate for blocks of size 2^( 2) =       0.000497816305
  error estimate for blocks of size 2^( 3) =       0.000521213947
  error estimate for blocks of size 2^( 4) =       0.000537924940
  error estimate for blocks of size 2^( 5) =       0.000548807391
  error estimate for blocks of size 2^( 6) =       0.000555230593
  error estimate for blocks of size 2^( 7) =       0.000556289734

      target function =      -0.748175899309
              le_mean =     -22.814970580898
             les_mean =     520.969414338658
             stat err =       0.000549563165
             autocorr =       1.352734865696
   target nu stat err =       0.000549563165
   target dn stat err =       0.003297029227
      target stat err =       0.002865463346
              std dev =       0.668230465239
             le_variance =       0.446531954674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446595646540
                                         uncertainty =       0.003388247275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446595646540
                                         uncertainty =       0.003388247275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472510293
  error estimate for blocks of size 2^( 2) =       0.000497816305
  error estimate for blocks of size 2^( 3) =       0.000521213947
  error estimate for blocks of size 2^( 4) =       0.000537924940
  error estimate for blocks of size 2^( 5) =       0.000548807391
  error estimate for blocks of size 2^( 6) =       0.000555230593
  error estimate for blocks of size 2^( 7) =       0.000556289734

      target function =      -0.748175899309
              le_mean =     -22.814970580898
             les_mean =     520.969414338658
             stat err =       0.000549563165
             autocorr =       1.352734865696
   target nu stat err =       0.000549563165
   target dn stat err =       0.003297029227
      target stat err =       0.002865463346
              std dev =       0.668230465239
             le_variance =       0.446531954674


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748175899309        initial  <--
     1.5625e+20     1.5625e+21             0.0000e+00        -0.748175899309
     6.2500e+20     6.2500e+21             0.0000e+00        -0.748175899309
     2.5000e+21     2.5000e+22             0.0000e+00        -0.748175899309

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4525
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1956e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7955
    reference variance = 0.380739
====================================================
  Execution time = 4.3880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5438e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4774e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454253719971
                                         uncertainty =       0.005422948626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454253719971
                                         uncertainty =       0.005422948626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476644774
  error estimate for blocks of size 2^( 2) =       0.000501203766
  error estimate for blocks of size 2^( 3) =       0.000525166884
  error estimate for blocks of size 2^( 4) =       0.000541578762
  error estimate for blocks of size 2^( 5) =       0.000553626630
  error estimate for blocks of size 2^( 6) =       0.000559402669
  error estimate for blocks of size 2^( 7) =       0.000563744044

      target function =      -0.741527531443
              le_mean =     -22.816279721138
             les_mean =     521.037000567240
             stat err =       0.000554588026
             autocorr =       1.353790013537
   target nu stat err =       0.000554588026
   target dn stat err =       0.005335150347
      target stat err =       0.004498261417
              std dev =       0.674077503859
             le_variance =       0.454380481208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281627972114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+21, overlap shift 1.5625e+22 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741553619765       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741553619765       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741553619765       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+21 is 7.331663e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+21, overlap shift 6.2500e+22 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741553619765       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741553619765       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741553619765       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+21 is 1.832916e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+22, overlap shift 2.5000e+23 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741553619765       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741553619765       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741553619765       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+22 is 4.582289e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.358615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8661e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8139
    reference variance = 0.257579
====================================================
  Execution time = 4.5132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5368e-01
  Total weights = 2.0000e+06
  Execution time = 3.5340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453608854940
                                         uncertainty =       0.004152732682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453608854940
                                         uncertainty =       0.004152732682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476278416
  error estimate for blocks of size 2^( 2) =       0.000500665948
  error estimate for blocks of size 2^( 3) =       0.000523805809
  error estimate for blocks of size 2^( 4) =       0.000541257037
  error estimate for blocks of size 2^( 5) =       0.000553111829
  error estimate for blocks of size 2^( 6) =       0.000558026637
  error estimate for blocks of size 2^( 7) =       0.000560525831

      target function =      -0.742138292869
              le_mean =     -22.815517342003
             les_mean =     521.001513616320
             stat err =       0.000553230334
             autocorr =       1.349242979339
   target nu stat err =       0.000553230334
   target dn stat err =       0.004359765287
      target stat err =       0.003694880835
              std dev =       0.673559395982
             le_variance =       0.453682259916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453608854940
                                         uncertainty =       0.004152732682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453608854940
                                         uncertainty =       0.004152732682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476278416
  error estimate for blocks of size 2^( 2) =       0.000500665948
  error estimate for blocks of size 2^( 3) =       0.000523805809
  error estimate for blocks of size 2^( 4) =       0.000541257037
  error estimate for blocks of size 2^( 5) =       0.000553111829
  error estimate for blocks of size 2^( 6) =       0.000558026637
  error estimate for blocks of size 2^( 7) =       0.000560525831

      target function =      -0.742138292869
              le_mean =     -22.815517342003
             les_mean =     521.001513616320
             stat err =       0.000553230334
             autocorr =       1.349242979339
   target nu stat err =       0.000553230334
   target dn stat err =       0.004359765287
      target stat err =       0.003694880835
              std dev =       0.673559395982
             le_variance =       0.453682259916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453608854940
                                         uncertainty =       0.004152732682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453608854940
                                         uncertainty =       0.004152732682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476278416
  error estimate for blocks of size 2^( 2) =       0.000500665948
  error estimate for blocks of size 2^( 3) =       0.000523805809
  error estimate for blocks of size 2^( 4) =       0.000541257037
  error estimate for blocks of size 2^( 5) =       0.000553111829
  error estimate for blocks of size 2^( 6) =       0.000558026637
  error estimate for blocks of size 2^( 7) =       0.000560525831

      target function =      -0.742138292869
              le_mean =     -22.815517342003
             les_mean =     521.001513616320
             stat err =       0.000553230334
             autocorr =       1.349242979339
   target nu stat err =       0.000553230334
   target dn stat err =       0.004359765287
      target stat err =       0.003694880835
              std dev =       0.673559395982
             le_variance =       0.453682259916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453608854940
                                         uncertainty =       0.004152732682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453608854940
                                         uncertainty =       0.004152732682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476278416
  error estimate for blocks of size 2^( 2) =       0.000500665948
  error estimate for blocks of size 2^( 3) =       0.000523805809
  error estimate for blocks of size 2^( 4) =       0.000541257037
  error estimate for blocks of size 2^( 5) =       0.000553111829
  error estimate for blocks of size 2^( 6) =       0.000558026637
  error estimate for blocks of size 2^( 7) =       0.000560525831

      target function =      -0.742138292869
              le_mean =     -22.815517342003
             les_mean =     521.001513616320
             stat err =       0.000553230334
             autocorr =       1.349242979339
   target nu stat err =       0.000553230334
   target dn stat err =       0.004359765287
      target stat err =       0.003694880835
              std dev =       0.673559395982
             le_variance =       0.453682259916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742138292869        initial  <--
     1.5625e+21     1.5625e+22             7.3317e-26        -0.742138292869
     6.2500e+21     6.2500e+22             1.8329e-26        -0.742138292869
     2.5000e+22     2.5000e+23             4.5823e-27        -0.742138292869

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.6875
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2536e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.9329
    reference variance = 0.514908
====================================================
  Execution time = 4.3898e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5349e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4741e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453503031124
                                         uncertainty =       0.004370819154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453503031124
                                         uncertainty =       0.004370819154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476179758
  error estimate for blocks of size 2^( 2) =       0.000501211035
  error estimate for blocks of size 2^( 3) =       0.000524122821
  error estimate for blocks of size 2^( 4) =       0.000541502016
  error estimate for blocks of size 2^( 5) =       0.000552077016
  error estimate for blocks of size 2^( 6) =       0.000558870135
  error estimate for blocks of size 2^( 7) =       0.000560752774

      target function =      -0.742319922295
              le_mean =     -22.814547728699
             les_mean =     520.957082162317
             stat err =       0.000553300485
             autocorr =       1.350144469580
   target nu stat err =       0.000553300485
   target dn stat err =       0.004128885719
      target stat err =       0.003501462789
              std dev =       0.673419871970
             le_variance =       0.453494323965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281454772870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+22, overlap shift 1.5625e+23 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742335230131       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742335230131       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+22, overlap shift 6.2500e+23 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742335230131       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742335230131       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+23, overlap shift 2.5000e+24 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742335230131       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742335230131       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.359788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8646e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8217
    reference variance = 0.286631
====================================================
  Execution time = 4.3490e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4988e-01
  Total weights = 2.0000e+06
  Execution time = 3.5320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449814025411
                                         uncertainty =       0.007185810903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449814025411
                                         uncertainty =       0.007185810903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474280442
  error estimate for blocks of size 2^( 2) =       0.000499269479
  error estimate for blocks of size 2^( 3) =       0.000522760782
  error estimate for blocks of size 2^( 4) =       0.000539747591
  error estimate for blocks of size 2^( 5) =       0.000551009826
  error estimate for blocks of size 2^( 6) =       0.000557776256
  error estimate for blocks of size 2^( 7) =       0.000562371744

      target function =      -0.745307924823
              le_mean =     -22.814823649102
             les_mean =     520.966061790725
             stat err =       0.000552726354
             autocorr =       1.358156800522
   target nu stat err =       0.000552726354
   target dn stat err =       0.007166984300
      target stat err =       0.006064453048
              std dev =       0.670733833976
             le_variance =       0.449883876040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449814025411
                                         uncertainty =       0.007185810903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449814025411
                                         uncertainty =       0.007185810903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474280442
  error estimate for blocks of size 2^( 2) =       0.000499269479
  error estimate for blocks of size 2^( 3) =       0.000522760782
  error estimate for blocks of size 2^( 4) =       0.000539747591
  error estimate for blocks of size 2^( 5) =       0.000551009826
  error estimate for blocks of size 2^( 6) =       0.000557776256
  error estimate for blocks of size 2^( 7) =       0.000562371744

      target function =      -0.745307924823
              le_mean =     -22.814823649102
             les_mean =     520.966061790725
             stat err =       0.000552726354
             autocorr =       1.358156800522
   target nu stat err =       0.000552726354
   target dn stat err =       0.007166984300
      target stat err =       0.006064453048
              std dev =       0.670733833976
             le_variance =       0.449883876040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449814025411
                                         uncertainty =       0.007185810903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449814025411
                                         uncertainty =       0.007185810903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474280442
  error estimate for blocks of size 2^( 2) =       0.000499269479
  error estimate for blocks of size 2^( 3) =       0.000522760782
  error estimate for blocks of size 2^( 4) =       0.000539747591
  error estimate for blocks of size 2^( 5) =       0.000551009826
  error estimate for blocks of size 2^( 6) =       0.000557776256
  error estimate for blocks of size 2^( 7) =       0.000562371744

      target function =      -0.745307924823
              le_mean =     -22.814823649102
             les_mean =     520.966061790725
             stat err =       0.000552726354
             autocorr =       1.358156800522
   target nu stat err =       0.000552726354
   target dn stat err =       0.007166984300
      target stat err =       0.006064453048
              std dev =       0.670733833976
             le_variance =       0.449883876040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449814025411
                                         uncertainty =       0.007185810903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449814025411
                                         uncertainty =       0.007185810903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474280442
  error estimate for blocks of size 2^( 2) =       0.000499269479
  error estimate for blocks of size 2^( 3) =       0.000522760782
  error estimate for blocks of size 2^( 4) =       0.000539747591
  error estimate for blocks of size 2^( 5) =       0.000551009826
  error estimate for blocks of size 2^( 6) =       0.000557776256
  error estimate for blocks of size 2^( 7) =       0.000562371744

      target function =      -0.745307924823
              le_mean =     -22.814823649102
             les_mean =     520.966061790725
             stat err =       0.000552726354
             autocorr =       1.358156800522
   target nu stat err =       0.000552726354
   target dn stat err =       0.007166984300
      target stat err =       0.006064453048
              std dev =       0.670733833976
             le_variance =       0.449883876040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745307924823        initial  <--
     1.5625e+22     1.5625e+23             0.0000e+00        -0.745307924823
     6.2500e+22     6.2500e+23             0.0000e+00        -0.745307924823
     2.5000e+23     2.5000e+24             0.0000e+00        -0.745307924823

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1748
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1983e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8063
    reference variance = 0.324391
====================================================
  Execution time = 4.4391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5081e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4921e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450601415637
                                         uncertainty =       0.003452964918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450601415637
                                         uncertainty =       0.003452964918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474767810
  error estimate for blocks of size 2^( 2) =       0.000499432586
  error estimate for blocks of size 2^( 3) =       0.000523022847
  error estimate for blocks of size 2^( 4) =       0.000539939081
  error estimate for blocks of size 2^( 5) =       0.000550563060
  error estimate for blocks of size 2^( 6) =       0.000556720181
  error estimate for blocks of size 2^( 7) =       0.000558312102

      target function =      -0.744562797818
              le_mean =     -22.815091683303
             les_mean =     520.979217238908
             stat err =       0.000551383606
             autocorr =       1.348792578338
   target nu stat err =       0.000551383606
   target dn stat err =       0.003303337368
      target stat err =       0.002844649674
              std dev =       0.671423075846
             le_variance =       0.450808946778


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281509168330e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+23, overlap shift 1.5625e+24 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744572640056       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744572640056       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+23, overlap shift 6.2500e+24 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744572640056       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744572640056       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+24, overlap shift 2.5000e+25 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744572640056       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744572640056       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.360930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9319e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7726
    reference variance = 0.749236
====================================================
  Execution time = 4.3559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4981e-01
  Total weights = 2.0000e+06
  Execution time = 3.5494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449887060163
                                         uncertainty =       0.002801875031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449887060163
                                         uncertainty =       0.002801875031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474241972
  error estimate for blocks of size 2^( 2) =       0.000499143135
  error estimate for blocks of size 2^( 3) =       0.000521779909
  error estimate for blocks of size 2^( 4) =       0.000539430980
  error estimate for blocks of size 2^( 5) =       0.000548889229
  error estimate for blocks of size 2^( 6) =       0.000554697738
  error estimate for blocks of size 2^( 7) =       0.000556005746

      target function =      -0.745402652708
              le_mean =     -22.815205464654
             les_mean =     520.983411065124
             stat err =       0.000549755923
             autocorr =       1.343816159963
   target nu stat err =       0.000549755923
   target dn stat err =       0.002907479718
      target stat err =       0.002526614226
              std dev =       0.670679428394
             le_variance =       0.449810895671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449887060163
                                         uncertainty =       0.002801875031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449887060163
                                         uncertainty =       0.002801875031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474241972
  error estimate for blocks of size 2^( 2) =       0.000499143135
  error estimate for blocks of size 2^( 3) =       0.000521779909
  error estimate for blocks of size 2^( 4) =       0.000539430980
  error estimate for blocks of size 2^( 5) =       0.000548889229
  error estimate for blocks of size 2^( 6) =       0.000554697738
  error estimate for blocks of size 2^( 7) =       0.000556005746

      target function =      -0.745402652708
              le_mean =     -22.815205464654
             les_mean =     520.983411065124
             stat err =       0.000549755923
             autocorr =       1.343816159963
   target nu stat err =       0.000549755923
   target dn stat err =       0.002907479718
      target stat err =       0.002526614226
              std dev =       0.670679428394
             le_variance =       0.449810895671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449887060163
                                         uncertainty =       0.002801875031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449887060163
                                         uncertainty =       0.002801875031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474241972
  error estimate for blocks of size 2^( 2) =       0.000499143135
  error estimate for blocks of size 2^( 3) =       0.000521779909
  error estimate for blocks of size 2^( 4) =       0.000539430980
  error estimate for blocks of size 2^( 5) =       0.000548889229
  error estimate for blocks of size 2^( 6) =       0.000554697738
  error estimate for blocks of size 2^( 7) =       0.000556005746

      target function =      -0.745402652708
              le_mean =     -22.815205464654
             les_mean =     520.983411065124
             stat err =       0.000549755923
             autocorr =       1.343816159963
   target nu stat err =       0.000549755923
   target dn stat err =       0.002907479718
      target stat err =       0.002526614226
              std dev =       0.670679428394
             le_variance =       0.449810895671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449887060163
                                         uncertainty =       0.002801875031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449887060163
                                         uncertainty =       0.002801875031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474241972
  error estimate for blocks of size 2^( 2) =       0.000499143135
  error estimate for blocks of size 2^( 3) =       0.000521779909
  error estimate for blocks of size 2^( 4) =       0.000539430980
  error estimate for blocks of size 2^( 5) =       0.000548889229
  error estimate for blocks of size 2^( 6) =       0.000554697738
  error estimate for blocks of size 2^( 7) =       0.000556005746

      target function =      -0.745402652708
              le_mean =     -22.815205464654
             les_mean =     520.983411065124
             stat err =       0.000549755923
             autocorr =       1.343816159963
   target nu stat err =       0.000549755923
   target dn stat err =       0.002907479718
      target stat err =       0.002526614226
              std dev =       0.670679428394
             le_variance =       0.449810895671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745402652708        initial  <--
     1.5625e+23     1.5625e+24             0.0000e+00        -0.745402652708
     6.2500e+23     6.2500e+24             0.0000e+00        -0.745402652708
     2.5000e+24     2.5000e+25             0.0000e+00        -0.745402652708

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7490
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2308e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7878
    reference variance = 0.37914
====================================================
  Execution time = 4.3330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5126e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4747e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451238725940
                                         uncertainty =       0.004456680535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451238725940
                                         uncertainty =       0.004456680535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475007121
  error estimate for blocks of size 2^( 2) =       0.000499748809
  error estimate for blocks of size 2^( 3) =       0.000523147223
  error estimate for blocks of size 2^( 4) =       0.000539547428
  error estimate for blocks of size 2^( 5) =       0.000551720641
  error estimate for blocks of size 2^( 6) =       0.000558719452
  error estimate for blocks of size 2^( 7) =       0.000561804164

      target function =      -0.744162096659
              le_mean =     -22.815562442374
             les_mean =     521.001152866430
             stat err =       0.000552947921
             autocorr =       1.355090244324
   target nu stat err =       0.000552947921
   target dn stat err =       0.004508209867
      target stat err =       0.003837957679
              std dev =       0.671761512895
             le_variance =       0.451263530207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281556244237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+24, overlap shift 1.5625e+25 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744181078445       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744181078445       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+24, overlap shift 6.2500e+25 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744181078445       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744181078445       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+25, overlap shift 2.5000e+26 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744181078445       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744181078445       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.362075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8083e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.855
    reference variance = 0.247349
====================================================
  Execution time = 4.3681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5059e-01
  Total weights = 2.0000e+06
  Execution time = 3.5532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450613706412
                                         uncertainty =       0.003194171812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450613706412
                                         uncertainty =       0.003194171812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474651495
  error estimate for blocks of size 2^( 2) =       0.000499946137
  error estimate for blocks of size 2^( 3) =       0.000524142894
  error estimate for blocks of size 2^( 4) =       0.000541029538
  error estimate for blocks of size 2^( 5) =       0.000551903018
  error estimate for blocks of size 2^( 6) =       0.000556621100
  error estimate for blocks of size 2^( 7) =       0.000560156382

      target function =      -0.744756555923
              le_mean =     -22.814716464344
             les_mean =     520.961875205831
             stat err =       0.000552427509
             autocorr =       1.354568240710
   target nu stat err =       0.000552427509
   target dn stat err =       0.003156608057
      target stat err =       0.002724572084
              std dev =       0.671258581113
             le_variance =       0.450588082718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450613706412
                                         uncertainty =       0.003194171812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450613706412
                                         uncertainty =       0.003194171812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474651495
  error estimate for blocks of size 2^( 2) =       0.000499946137
  error estimate for blocks of size 2^( 3) =       0.000524142894
  error estimate for blocks of size 2^( 4) =       0.000541029538
  error estimate for blocks of size 2^( 5) =       0.000551903018
  error estimate for blocks of size 2^( 6) =       0.000556621100
  error estimate for blocks of size 2^( 7) =       0.000560156382

      target function =      -0.744756555923
              le_mean =     -22.814716464344
             les_mean =     520.961875205831
             stat err =       0.000552427509
             autocorr =       1.354568240710
   target nu stat err =       0.000552427509
   target dn stat err =       0.003156608057
      target stat err =       0.002724572084
              std dev =       0.671258581113
             le_variance =       0.450588082718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450613706412
                                         uncertainty =       0.003194171812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450613706412
                                         uncertainty =       0.003194171812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474651495
  error estimate for blocks of size 2^( 2) =       0.000499946137
  error estimate for blocks of size 2^( 3) =       0.000524142894
  error estimate for blocks of size 2^( 4) =       0.000541029538
  error estimate for blocks of size 2^( 5) =       0.000551903018
  error estimate for blocks of size 2^( 6) =       0.000556621100
  error estimate for blocks of size 2^( 7) =       0.000560156382

      target function =      -0.744756555923
              le_mean =     -22.814716464344
             les_mean =     520.961875205831
             stat err =       0.000552427509
             autocorr =       1.354568240710
   target nu stat err =       0.000552427509
   target dn stat err =       0.003156608057
      target stat err =       0.002724572084
              std dev =       0.671258581113
             le_variance =       0.450588082718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450613706412
                                         uncertainty =       0.003194171812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450613706412
                                         uncertainty =       0.003194171812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474651495
  error estimate for blocks of size 2^( 2) =       0.000499946137
  error estimate for blocks of size 2^( 3) =       0.000524142894
  error estimate for blocks of size 2^( 4) =       0.000541029538
  error estimate for blocks of size 2^( 5) =       0.000551903018
  error estimate for blocks of size 2^( 6) =       0.000556621100
  error estimate for blocks of size 2^( 7) =       0.000560156382

      target function =      -0.744756555923
              le_mean =     -22.814716464344
             les_mean =     520.961875205831
             stat err =       0.000552427509
             autocorr =       1.354568240710
   target nu stat err =       0.000552427509
   target dn stat err =       0.003156608057
      target stat err =       0.002724572084
              std dev =       0.671258581113
             le_variance =       0.450588082718


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744756555923        initial  <--
     1.5625e+24     1.5625e+25             0.0000e+00        -0.744756555923
     6.2500e+24     6.2500e+25             0.0000e+00        -0.744756555923
     2.5000e+25     2.5000e+26             0.0000e+00        -0.744756555923

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4875
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1958e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8094
    reference variance = 0.277303
====================================================
  Execution time = 4.4246e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6283e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4964e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462789976230
                                         uncertainty =       0.009404169656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462789976230
                                         uncertainty =       0.009404169656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481055912
  error estimate for blocks of size 2^( 2) =       0.000505576961
  error estimate for blocks of size 2^( 3) =       0.000528315757
  error estimate for blocks of size 2^( 4) =       0.000544819008
  error estimate for blocks of size 2^( 5) =       0.000555796668
  error estimate for blocks of size 2^( 6) =       0.000562308748
  error estimate for blocks of size 2^( 7) =       0.000565603607

      target function =      -0.734520299852
              le_mean =     -22.815099391988
             les_mean =     520.991589616500
             stat err =       0.000557132008
             autocorr =       1.341297472815
   target nu stat err =       0.000557132008
   target dn stat err =       0.009734104431
      target stat err =       0.007985346790
              std dev =       0.680315795502
             le_variance =       0.462829581610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281509939199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+25, overlap shift 1.5625e+26 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734606646046       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734606646046       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734607588924       residual = 3.24e+09           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734606646045       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+25 is 8.313741e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+25, overlap shift 6.2500e+26 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734606646046       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734606646046       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734633968979       residual = 1.30e+10           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734606646045       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749999999999       residual = 2.06e+09           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.764466161417       residual = 6.98e+08           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+25 is 3.248706e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+26, overlap shift 2.5000e+27 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734606646046       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734606646046       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734678454042       residual = 5.19e+10           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+26 is 3.043618e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.363888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9219e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8716
    reference variance = 0.503115
====================================================
  Execution time = 4.3552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5738e-01
  Total weights = 2.0000e+06
  Execution time = 3.5570e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457293580828
                                         uncertainty =       0.008242923382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457293580828
                                         uncertainty =       0.008242923382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478215324
  error estimate for blocks of size 2^( 2) =       0.000503259193
  error estimate for blocks of size 2^( 3) =       0.000526461008
  error estimate for blocks of size 2^( 4) =       0.000543134967
  error estimate for blocks of size 2^( 5) =       0.000554113130
  error estimate for blocks of size 2^( 6) =       0.000561548121
  error estimate for blocks of size 2^( 7) =       0.000562630238

      target function =      -0.739047231363
              le_mean =     -22.814501776114
             les_mean =     520.958870855910
             stat err =       0.000555356614
             autocorr =       1.348642741902
   target nu stat err =       0.000555356614
   target dn stat err =       0.008135651113
      target stat err =       0.006758471011
              std dev =       0.676298596986
             le_variance =       0.457379792286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457293580828
                                         uncertainty =       0.008242923382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457293580828
                                         uncertainty =       0.008242923382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478215324
  error estimate for blocks of size 2^( 2) =       0.000503259193
  error estimate for blocks of size 2^( 3) =       0.000526461008
  error estimate for blocks of size 2^( 4) =       0.000543134967
  error estimate for blocks of size 2^( 5) =       0.000554113130
  error estimate for blocks of size 2^( 6) =       0.000561548121
  error estimate for blocks of size 2^( 7) =       0.000562630238

      target function =      -0.739047231363
              le_mean =     -22.814501776114
             les_mean =     520.958870855910
             stat err =       0.000555356614
             autocorr =       1.348642741902
   target nu stat err =       0.000555356614
   target dn stat err =       0.008135651113
      target stat err =       0.006758471011
              std dev =       0.676298596986
             le_variance =       0.457379792286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457293580828
                                         uncertainty =       0.008242923382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457293580828
                                         uncertainty =       0.008242923382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478215324
  error estimate for blocks of size 2^( 2) =       0.000503259193
  error estimate for blocks of size 2^( 3) =       0.000526461008
  error estimate for blocks of size 2^( 4) =       0.000543134967
  error estimate for blocks of size 2^( 5) =       0.000554113130
  error estimate for blocks of size 2^( 6) =       0.000561548121
  error estimate for blocks of size 2^( 7) =       0.000562630238

      target function =      -0.739047231363
              le_mean =     -22.814501776114
             les_mean =     520.958870855910
             stat err =       0.000555356614
             autocorr =       1.348642741902
   target nu stat err =       0.000555356614
   target dn stat err =       0.008135651113
      target stat err =       0.006758471011
              std dev =       0.676298596986
             le_variance =       0.457379792286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457293580828
                                         uncertainty =       0.008242923382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457293580828
                                         uncertainty =       0.008242923382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478215324
  error estimate for blocks of size 2^( 2) =       0.000503259193
  error estimate for blocks of size 2^( 3) =       0.000526461008
  error estimate for blocks of size 2^( 4) =       0.000543134967
  error estimate for blocks of size 2^( 5) =       0.000554113130
  error estimate for blocks of size 2^( 6) =       0.000561548121
  error estimate for blocks of size 2^( 7) =       0.000562630238

      target function =      -0.739047231363
              le_mean =     -22.814501776114
             les_mean =     520.958870855910
             stat err =       0.000555356614
             autocorr =       1.348642741902
   target nu stat err =       0.000555356614
   target dn stat err =       0.008135651113
      target stat err =       0.006758471011
              std dev =       0.676298596986
             le_variance =       0.457379792286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739047231363        initial  <--
     1.5625e+25     1.5625e+26             8.3137e-30        -0.739047231363
     6.2500e+25     6.2500e+26             3.2487e-30        -0.739047231363
     2.5000e+26     2.5000e+27             3.0436e-31        -0.739047231363

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3665
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2069e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8557
    reference variance = 0.280374
====================================================
  Execution time = 4.3780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4439e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5081e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444483816444
                                         uncertainty =       0.002950260197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444483816444
                                         uncertainty =       0.002950260197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471377030
  error estimate for blocks of size 2^( 2) =       0.000496532520
  error estimate for blocks of size 2^( 3) =       0.000520172848
  error estimate for blocks of size 2^( 4) =       0.000538440971
  error estimate for blocks of size 2^( 5) =       0.000548739137
  error estimate for blocks of size 2^( 6) =       0.000557477998
  error estimate for blocks of size 2^( 7) =       0.000559708025

      target function =      -0.749995278797
              le_mean =     -22.815252998398
             les_mean =     520.980161768091
             stat err =       0.000551091533
             autocorr =       1.366817859040
   target nu stat err =       0.000551091533
   target dn stat err =       0.002680876603
      target stat err =       0.002370569099
              std dev =       0.666627789230
             le_variance =       0.444392609373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281525299840e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+26, overlap shift 1.5625e+27 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750001684380       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750001684380       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750001684380       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+26 is 1.046902e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+26, overlap shift 6.2500e+27 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750001684380       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750001684380       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750001684380       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750001684380       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750001684380       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750000000000       residual = 2.44e+09           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+26 is 3.356660e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+27, overlap shift 2.5000e+28 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750001684380       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750001684380       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750001684380       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750001684384       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750001683831       residual = 6.43e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750000000000       residual = 4.29e+09           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+27 is 6.543139e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.365922 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8868e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7119
    reference variance = 0.319336
====================================================
  Execution time = 4.3306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4464e-01
  Total weights = 2.0000e+06
  Execution time = 3.5432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444743927017
                                         uncertainty =       0.003615248129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444743927017
                                         uncertainty =       0.003615248129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471506317
  error estimate for blocks of size 2^( 2) =       0.000496173738
  error estimate for blocks of size 2^( 3) =       0.000518788835
  error estimate for blocks of size 2^( 4) =       0.000535060644
  error estimate for blocks of size 2^( 5) =       0.000545080590
  error estimate for blocks of size 2^( 6) =       0.000550097447
  error estimate for blocks of size 2^( 7) =       0.000551868292

      target function =      -0.749783585354
              le_mean =     -22.815229533674
             les_mean =     520.979334865183
             stat err =       0.000545526743
             autocorr =       1.338619233544
   target nu stat err =       0.000545526743
   target dn stat err =       0.003385047062
      target stat err =       0.002950938330
              std dev =       0.666810627738
             le_variance =       0.444636413265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444743927017
                                         uncertainty =       0.003615248129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444743927017
                                         uncertainty =       0.003615248129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471506317
  error estimate for blocks of size 2^( 2) =       0.000496173738
  error estimate for blocks of size 2^( 3) =       0.000518788835
  error estimate for blocks of size 2^( 4) =       0.000535060644
  error estimate for blocks of size 2^( 5) =       0.000545080590
  error estimate for blocks of size 2^( 6) =       0.000550097447
  error estimate for blocks of size 2^( 7) =       0.000551868292

      target function =      -0.749783585354
              le_mean =     -22.815229533674
             les_mean =     520.979334865183
             stat err =       0.000545526743
             autocorr =       1.338619233544
   target nu stat err =       0.000545526743
   target dn stat err =       0.003385047062
      target stat err =       0.002950938330
              std dev =       0.666810627738
             le_variance =       0.444636413265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444743927017
                                         uncertainty =       0.003615248129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444743927017
                                         uncertainty =       0.003615248129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471506317
  error estimate for blocks of size 2^( 2) =       0.000496173738
  error estimate for blocks of size 2^( 3) =       0.000518788835
  error estimate for blocks of size 2^( 4) =       0.000535060644
  error estimate for blocks of size 2^( 5) =       0.000545080590
  error estimate for blocks of size 2^( 6) =       0.000550097447
  error estimate for blocks of size 2^( 7) =       0.000551868292

      target function =      -0.749783585354
              le_mean =     -22.815229533674
             les_mean =     520.979334865183
             stat err =       0.000545526743
             autocorr =       1.338619233544
   target nu stat err =       0.000545526743
   target dn stat err =       0.003385047062
      target stat err =       0.002950938330
              std dev =       0.666810627738
             le_variance =       0.444636413265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444743927017
                                         uncertainty =       0.003615248129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444743927017
                                         uncertainty =       0.003615248129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471506317
  error estimate for blocks of size 2^( 2) =       0.000496173738
  error estimate for blocks of size 2^( 3) =       0.000518788835
  error estimate for blocks of size 2^( 4) =       0.000535060644
  error estimate for blocks of size 2^( 5) =       0.000545080590
  error estimate for blocks of size 2^( 6) =       0.000550097447
  error estimate for blocks of size 2^( 7) =       0.000551868292

      target function =      -0.749783585354
              le_mean =     -22.815229533674
             les_mean =     520.979334865183
             stat err =       0.000545526743
             autocorr =       1.338619233544
   target nu stat err =       0.000545526743
   target dn stat err =       0.003385047062
      target stat err =       0.002950938330
              std dev =       0.666810627738
             le_variance =       0.444636413265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749783585354        initial  <--
     1.5625e+26     1.5625e+27             1.0469e-30        -0.749783585354
     6.2500e+26     6.2500e+27             3.3567e-31        -0.749783585354
     2.5000e+27     2.5000e+28             6.5431e-32        -0.749783585354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.8571
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2373e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7274
    reference variance = 0.4924
====================================================
  Execution time = 4.3829e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5331e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4762e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453319346863
                                         uncertainty =       0.006706837273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453319346863
                                         uncertainty =       0.006706837273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476085357
  error estimate for blocks of size 2^( 2) =       0.000500019160
  error estimate for blocks of size 2^( 3) =       0.000523076980
  error estimate for blocks of size 2^( 4) =       0.000540563321
  error estimate for blocks of size 2^( 5) =       0.000549081756
  error estimate for blocks of size 2^( 6) =       0.000554784310
  error estimate for blocks of size 2^( 7) =       0.000558522630

      target function =      -0.742450129915
              le_mean =     -22.814125810351
             les_mean =     520.937650798731
             stat err =       0.000550738004
             autocorr =       1.338198209044
   target nu stat err =       0.000550738004
   target dn stat err =       0.006952954038
      target stat err =       0.005834070414
              std dev =       0.673286369123
             le_variance =       0.453314534847


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281412581035e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+27, overlap shift 1.5625e+28 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742494395053       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742494395053       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+27, overlap shift 6.2500e+28 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742494395053       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742494395053       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+28, overlap shift 2.5000e+29 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742494395053       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742494395053       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.367068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8598e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8693
    reference variance = 0.243478
====================================================
  Execution time = 4.3481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5163e-01
  Total weights = 2.0000e+06
  Execution time = 3.5523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451668299849
                                         uncertainty =       0.004373231305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451668299849
                                         uncertainty =       0.004373231305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475202629
  error estimate for blocks of size 2^( 2) =       0.000500015728
  error estimate for blocks of size 2^( 3) =       0.000523048350
  error estimate for blocks of size 2^( 4) =       0.000540021036
  error estimate for blocks of size 2^( 5) =       0.000551382178
  error estimate for blocks of size 2^( 6) =       0.000557128374
  error estimate for blocks of size 2^( 7) =       0.000557545998

      target function =      -0.743860786150
              le_mean =     -22.815160978315
             les_mean =     520.983205318318
             stat err =       0.000551519397
             autocorr =       1.346988574435
   target nu stat err =       0.000551519397
   target dn stat err =       0.004300966773
      target stat err =       0.003660862543
              std dev =       0.672038003187
             le_variance =       0.451635077727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451668299849
                                         uncertainty =       0.004373231305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451668299849
                                         uncertainty =       0.004373231305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475202629
  error estimate for blocks of size 2^( 2) =       0.000500015728
  error estimate for blocks of size 2^( 3) =       0.000523048350
  error estimate for blocks of size 2^( 4) =       0.000540021036
  error estimate for blocks of size 2^( 5) =       0.000551382178
  error estimate for blocks of size 2^( 6) =       0.000557128374
  error estimate for blocks of size 2^( 7) =       0.000557545998

      target function =      -0.743860786150
              le_mean =     -22.815160978315
             les_mean =     520.983205318318
             stat err =       0.000551519397
             autocorr =       1.346988574435
   target nu stat err =       0.000551519397
   target dn stat err =       0.004300966773
      target stat err =       0.003660862543
              std dev =       0.672038003187
             le_variance =       0.451635077727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451668299849
                                         uncertainty =       0.004373231305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451668299849
                                         uncertainty =       0.004373231305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475202629
  error estimate for blocks of size 2^( 2) =       0.000500015728
  error estimate for blocks of size 2^( 3) =       0.000523048350
  error estimate for blocks of size 2^( 4) =       0.000540021036
  error estimate for blocks of size 2^( 5) =       0.000551382178
  error estimate for blocks of size 2^( 6) =       0.000557128374
  error estimate for blocks of size 2^( 7) =       0.000557545998

      target function =      -0.743860786150
              le_mean =     -22.815160978315
             les_mean =     520.983205318318
             stat err =       0.000551519397
             autocorr =       1.346988574435
   target nu stat err =       0.000551519397
   target dn stat err =       0.004300966773
      target stat err =       0.003660862543
              std dev =       0.672038003187
             le_variance =       0.451635077727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451668299849
                                         uncertainty =       0.004373231305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451668299849
                                         uncertainty =       0.004373231305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475202629
  error estimate for blocks of size 2^( 2) =       0.000500015728
  error estimate for blocks of size 2^( 3) =       0.000523048350
  error estimate for blocks of size 2^( 4) =       0.000540021036
  error estimate for blocks of size 2^( 5) =       0.000551382178
  error estimate for blocks of size 2^( 6) =       0.000557128374
  error estimate for blocks of size 2^( 7) =       0.000557545998

      target function =      -0.743860786150
              le_mean =     -22.815160978315
             les_mean =     520.983205318318
             stat err =       0.000551519397
             autocorr =       1.346988574435
   target nu stat err =       0.000551519397
   target dn stat err =       0.004300966773
      target stat err =       0.003660862543
              std dev =       0.672038003187
             le_variance =       0.451635077727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743860786150        initial  <--
     1.5625e+27     1.5625e+28             0.0000e+00        -0.743860786150
     6.2500e+27     6.2500e+28             0.0000e+00        -0.743860786150
     2.5000e+28     2.5000e+29             0.0000e+00        -0.743860786150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2382
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1984e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7809
    reference variance = 0.315773
====================================================
  Execution time = 4.3485e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5135e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4966e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451320773439
                                         uncertainty =       0.003659728347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451320773439
                                         uncertainty =       0.003659728347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475054115
  error estimate for blocks of size 2^( 2) =       0.000499917623
  error estimate for blocks of size 2^( 3) =       0.000523479943
  error estimate for blocks of size 2^( 4) =       0.000541533814
  error estimate for blocks of size 2^( 5) =       0.000554310161
  error estimate for blocks of size 2^( 6) =       0.000562164517
  error estimate for blocks of size 2^( 7) =       0.000566295763

      target function =      -0.744106507387
              le_mean =     -22.814975782757
             les_mean =     520.974472566413
             stat err =       0.000556076064
             autocorr =       1.370194544262
   target nu stat err =       0.000556076064
   target dn stat err =       0.003589476627
      target stat err =       0.003076560079
              std dev =       0.671827972254
             le_variance =       0.451352824303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281497578276e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+28, overlap shift 1.5625e+29 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744118259973       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744118259973       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+28, overlap shift 6.2500e+29 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744118259973       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744118259973       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+29, overlap shift 2.5000e+30 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744118259973       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744118259973       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.368194 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8458e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8856
    reference variance = 0.298882
====================================================
  Execution time = 4.3192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4277e-01
  Total weights = 2.0000e+06
  Execution time = 3.5484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638159903
                                         uncertainty =       0.002348960023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638159903
                                         uncertainty =       0.002348960023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470518373
  error estimate for blocks of size 2^( 2) =       0.000495822860
  error estimate for blocks of size 2^( 3) =       0.000519108014
  error estimate for blocks of size 2^( 4) =       0.000536533073
  error estimate for blocks of size 2^( 5) =       0.000545873770
  error estimate for blocks of size 2^( 6) =       0.000551309085
  error estimate for blocks of size 2^( 7) =       0.000553571888

      target function =      -0.751389476727
              le_mean =     -22.814099124120
             les_mean =     520.925893702162
             stat err =       0.000546821954
             autocorr =       1.350637215449
   target nu stat err =       0.000546821954
   target dn stat err =       0.002290379204
      target stat err =       0.002053490346
              std dev =       0.665413464228
             le_variance =       0.442775078376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638159903
                                         uncertainty =       0.002348960023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638159903
                                         uncertainty =       0.002348960023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470518373
  error estimate for blocks of size 2^( 2) =       0.000495822860
  error estimate for blocks of size 2^( 3) =       0.000519108014
  error estimate for blocks of size 2^( 4) =       0.000536533073
  error estimate for blocks of size 2^( 5) =       0.000545873770
  error estimate for blocks of size 2^( 6) =       0.000551309085
  error estimate for blocks of size 2^( 7) =       0.000553571888

      target function =      -0.751389476727
              le_mean =     -22.814099124120
             les_mean =     520.925893702162
             stat err =       0.000546821954
             autocorr =       1.350637215449
   target nu stat err =       0.000546821954
   target dn stat err =       0.002290379204
      target stat err =       0.002053490346
              std dev =       0.665413464228
             le_variance =       0.442775078376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638159903
                                         uncertainty =       0.002348960023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638159903
                                         uncertainty =       0.002348960023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470518373
  error estimate for blocks of size 2^( 2) =       0.000495822860
  error estimate for blocks of size 2^( 3) =       0.000519108014
  error estimate for blocks of size 2^( 4) =       0.000536533073
  error estimate for blocks of size 2^( 5) =       0.000545873770
  error estimate for blocks of size 2^( 6) =       0.000551309085
  error estimate for blocks of size 2^( 7) =       0.000553571888

      target function =      -0.751389476727
              le_mean =     -22.814099124120
             les_mean =     520.925893702162
             stat err =       0.000546821954
             autocorr =       1.350637215449
   target nu stat err =       0.000546821954
   target dn stat err =       0.002290379204
      target stat err =       0.002053490346
              std dev =       0.665413464228
             le_variance =       0.442775078376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638159903
                                         uncertainty =       0.002348960023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638159903
                                         uncertainty =       0.002348960023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470518373
  error estimate for blocks of size 2^( 2) =       0.000495822860
  error estimate for blocks of size 2^( 3) =       0.000519108014
  error estimate for blocks of size 2^( 4) =       0.000536533073
  error estimate for blocks of size 2^( 5) =       0.000545873770
  error estimate for blocks of size 2^( 6) =       0.000551309085
  error estimate for blocks of size 2^( 7) =       0.000553571888

      target function =      -0.751389476727
              le_mean =     -22.814099124120
             les_mean =     520.925893702162
             stat err =       0.000546821954
             autocorr =       1.350637215449
   target nu stat err =       0.000546821954
   target dn stat err =       0.002290379204
      target stat err =       0.002053490346
              std dev =       0.665413464228
             le_variance =       0.442775078376


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751389476727        initial  <--
     1.5625e+28     1.5625e+29             0.0000e+00        -0.751389476727
     6.2500e+28     6.2500e+29             0.0000e+00        -0.751389476727
     2.5000e+29     2.5000e+30             0.0000e+00        -0.751389476727

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.7918
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2326e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7974
    reference variance = 0.41203
====================================================
  Execution time = 4.4638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4534e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4762e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445383380002
                                         uncertainty =       0.003913279590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445383380002
                                         uncertainty =       0.003913279590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471877666
  error estimate for blocks of size 2^( 2) =       0.000496484574
  error estimate for blocks of size 2^( 3) =       0.000519619072
  error estimate for blocks of size 2^( 4) =       0.000536859698
  error estimate for blocks of size 2^( 5) =       0.000548055111
  error estimate for blocks of size 2^( 6) =       0.000554504144
  error estimate for blocks of size 2^( 7) =       0.000557671279

      target function =      -0.749197876635
              le_mean =     -22.814319717847
             les_mean =     520.938521028367
             stat err =       0.000549272558
             autocorr =       1.354930313000
   target nu stat err =       0.000549272558
   target dn stat err =       0.003431748460
      target stat err =       0.002982069616
              std dev =       0.667335794710
             le_variance =       0.445337062901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281431971785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+29, overlap shift 1.5625e+30 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749208730897       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749208730897       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+29, overlap shift 6.2500e+30 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749208730897       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749208730897       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749208730896       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+29 is 1.536874e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+30, overlap shift 2.5000e+31 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749208730897       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749208730897       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.369423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9407e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7069
    reference variance = 0.254455
====================================================
  Execution time = 4.3682e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4501e-01
  Total weights = 2.0000e+06
  Execution time = 3.5459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021904590
                                         uncertainty =       0.002560736969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021904590
                                         uncertainty =       0.002560736969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471705697
  error estimate for blocks of size 2^( 2) =       0.000496821103
  error estimate for blocks of size 2^( 3) =       0.000520178004
  error estimate for blocks of size 2^( 4) =       0.000536461194
  error estimate for blocks of size 2^( 5) =       0.000547411971
  error estimate for blocks of size 2^( 6) =       0.000554849310
  error estimate for blocks of size 2^( 7) =       0.000557449069

      target function =      -0.749471276746
              le_mean =     -22.814922747362
             les_mean =     520.965712274432
             stat err =       0.000549042886
             autocorr =       1.354784734590
   target nu stat err =       0.000549042886
   target dn stat err =       0.002638840982
      target stat err =       0.002331078447
              std dev =       0.667092593905
             le_variance =       0.445012528843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021904590
                                         uncertainty =       0.002560736969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021904590
                                         uncertainty =       0.002560736969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471705697
  error estimate for blocks of size 2^( 2) =       0.000496821103
  error estimate for blocks of size 2^( 3) =       0.000520178004
  error estimate for blocks of size 2^( 4) =       0.000536461194
  error estimate for blocks of size 2^( 5) =       0.000547411971
  error estimate for blocks of size 2^( 6) =       0.000554849310
  error estimate for blocks of size 2^( 7) =       0.000557449069

      target function =      -0.749471276746
              le_mean =     -22.814922747362
             les_mean =     520.965712274432
             stat err =       0.000549042886
             autocorr =       1.354784734590
   target nu stat err =       0.000549042886
   target dn stat err =       0.002638840982
      target stat err =       0.002331078447
              std dev =       0.667092593905
             le_variance =       0.445012528843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021904590
                                         uncertainty =       0.002560736969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021904590
                                         uncertainty =       0.002560736969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471705697
  error estimate for blocks of size 2^( 2) =       0.000496821103
  error estimate for blocks of size 2^( 3) =       0.000520178004
  error estimate for blocks of size 2^( 4) =       0.000536461194
  error estimate for blocks of size 2^( 5) =       0.000547411971
  error estimate for blocks of size 2^( 6) =       0.000554849310
  error estimate for blocks of size 2^( 7) =       0.000557449069

      target function =      -0.749471276746
              le_mean =     -22.814922747362
             les_mean =     520.965712274432
             stat err =       0.000549042886
             autocorr =       1.354784734590
   target nu stat err =       0.000549042886
   target dn stat err =       0.002638840982
      target stat err =       0.002331078447
              std dev =       0.667092593905
             le_variance =       0.445012528843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021904590
                                         uncertainty =       0.002560736969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021904590
                                         uncertainty =       0.002560736969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471705697
  error estimate for blocks of size 2^( 2) =       0.000496821103
  error estimate for blocks of size 2^( 3) =       0.000520178004
  error estimate for blocks of size 2^( 4) =       0.000536461194
  error estimate for blocks of size 2^( 5) =       0.000547411971
  error estimate for blocks of size 2^( 6) =       0.000554849310
  error estimate for blocks of size 2^( 7) =       0.000557449069

      target function =      -0.749471276746
              le_mean =     -22.814922747362
             les_mean =     520.965712274432
             stat err =       0.000549042886
             autocorr =       1.354784734590
   target nu stat err =       0.000549042886
   target dn stat err =       0.002638840982
      target stat err =       0.002331078447
              std dev =       0.667092593905
             le_variance =       0.445012528843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749471276746        initial  <--
     1.5625e+29     1.5625e+30             0.0000e+00        -0.749471276746
     6.2500e+29     6.2500e+30             1.5369e-34        -0.749471276746
     2.5000e+30     2.5000e+31             0.0000e+00        -0.749471276746

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3958
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2081e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7925
    reference variance = 0.3311
====================================================
  Execution time = 4.3219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5110e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4853e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451136407840
                                         uncertainty =       0.003221388773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451136407840
                                         uncertainty =       0.003221388773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474922761
  error estimate for blocks of size 2^( 2) =       0.000500132884
  error estimate for blocks of size 2^( 3) =       0.000523796140
  error estimate for blocks of size 2^( 4) =       0.000539724030
  error estimate for blocks of size 2^( 5) =       0.000550574682
  error estimate for blocks of size 2^( 6) =       0.000555903403
  error estimate for blocks of size 2^( 7) =       0.000559084081

      target function =      -0.744328015433
              le_mean =     -22.814463150091
             les_mean =     520.950831859170
             stat err =       0.000551321549
             autocorr =       1.347609200167
   target nu stat err =       0.000551321549
   target dn stat err =       0.003276883223
      target stat err =       0.002818525292
              std dev =       0.671642209695
             le_variance =       0.451103257843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281446315009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+30, overlap shift 1.5625e+31 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744337734940       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744337734940       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+30, overlap shift 6.2500e+31 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744337734940       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744337734940       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+31, overlap shift 2.5000e+32 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744337734940       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744337734940       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.370668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8078e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7522
    reference variance = 0.344594
====================================================
  Execution time = 4.3230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5256e-01
  Total weights = 2.0000e+06
  Execution time = 3.5605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452490694993
                                         uncertainty =       0.005007262924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452490694993
                                         uncertainty =       0.005007262924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475688877
  error estimate for blocks of size 2^( 2) =       0.000500204178
  error estimate for blocks of size 2^( 3) =       0.000523414286
  error estimate for blocks of size 2^( 4) =       0.000539586330
  error estimate for blocks of size 2^( 5) =       0.000549525050
  error estimate for blocks of size 2^( 6) =       0.000555475295
  error estimate for blocks of size 2^( 7) =       0.000561767040

      target function =      -0.743094492582
              le_mean =     -22.814313752230
             les_mean =     520.945471573594
             stat err =       0.000551588429
             autocorr =       1.344572739468
   target nu stat err =       0.000551588429
   target dn stat err =       0.005310081821
      target stat err =       0.004482442826
              std dev =       0.672725660788
             le_variance =       0.452559814682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452490694993
                                         uncertainty =       0.005007262924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452490694993
                                         uncertainty =       0.005007262924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475688877
  error estimate for blocks of size 2^( 2) =       0.000500204178
  error estimate for blocks of size 2^( 3) =       0.000523414286
  error estimate for blocks of size 2^( 4) =       0.000539586330
  error estimate for blocks of size 2^( 5) =       0.000549525050
  error estimate for blocks of size 2^( 6) =       0.000555475295
  error estimate for blocks of size 2^( 7) =       0.000561767040

      target function =      -0.743094492582
              le_mean =     -22.814313752230
             les_mean =     520.945471573594
             stat err =       0.000551588429
             autocorr =       1.344572739468
   target nu stat err =       0.000551588429
   target dn stat err =       0.005310081821
      target stat err =       0.004482442826
              std dev =       0.672725660788
             le_variance =       0.452559814682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452490694993
                                         uncertainty =       0.005007262924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452490694993
                                         uncertainty =       0.005007262924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475688877
  error estimate for blocks of size 2^( 2) =       0.000500204178
  error estimate for blocks of size 2^( 3) =       0.000523414286
  error estimate for blocks of size 2^( 4) =       0.000539586330
  error estimate for blocks of size 2^( 5) =       0.000549525050
  error estimate for blocks of size 2^( 6) =       0.000555475295
  error estimate for blocks of size 2^( 7) =       0.000561767040

      target function =      -0.743094492582
              le_mean =     -22.814313752230
             les_mean =     520.945471573594
             stat err =       0.000551588429
             autocorr =       1.344572739468
   target nu stat err =       0.000551588429
   target dn stat err =       0.005310081821
      target stat err =       0.004482442826
              std dev =       0.672725660788
             le_variance =       0.452559814682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452490694993
                                         uncertainty =       0.005007262924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452490694993
                                         uncertainty =       0.005007262924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475688877
  error estimate for blocks of size 2^( 2) =       0.000500204178
  error estimate for blocks of size 2^( 3) =       0.000523414286
  error estimate for blocks of size 2^( 4) =       0.000539586330
  error estimate for blocks of size 2^( 5) =       0.000549525050
  error estimate for blocks of size 2^( 6) =       0.000555475295
  error estimate for blocks of size 2^( 7) =       0.000561767040

      target function =      -0.743094492582
              le_mean =     -22.814313752230
             les_mean =     520.945471573594
             stat err =       0.000551588429
             autocorr =       1.344572739468
   target nu stat err =       0.000551588429
   target dn stat err =       0.005310081821
      target stat err =       0.004482442826
              std dev =       0.672725660788
             le_variance =       0.452559814682


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743094492582        initial  <--
     1.5625e+30     1.5625e+31             0.0000e+00        -0.743094492582
     6.2500e+30     6.2500e+31             0.0000e+00        -0.743094492582
     2.5000e+31     2.5000e+32             0.0000e+00        -0.743094492582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0224
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1911e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7554
    reference variance = 0.376133
====================================================
  Execution time = 4.3644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5174e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5309e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451739912336
                                         uncertainty =       0.003185050382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451739912336
                                         uncertainty =       0.003185050382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475260506
  error estimate for blocks of size 2^( 2) =       0.000499631941
  error estimate for blocks of size 2^( 3) =       0.000522875236
  error estimate for blocks of size 2^( 4) =       0.000540002506
  error estimate for blocks of size 2^( 5) =       0.000550192987
  error estimate for blocks of size 2^( 6) =       0.000557219426
  error estimate for blocks of size 2^( 7) =       0.000561929086

      target function =      -0.743794817563
              le_mean =     -22.814134935274
             les_mean =     520.936497715425
             stat err =       0.000552336001
             autocorr =       1.350651332917
   target nu stat err =       0.000552336001
   target dn stat err =       0.003535813725
      target stat err =       0.003025278030
              std dev =       0.672119852712
             le_variance =       0.451745096409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281413493527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+31, overlap shift 1.5625e+32 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743806061422       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743806061422       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+31, overlap shift 6.2500e+32 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743806061422       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743806061422       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+32, overlap shift 2.5000e+33 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743806061422       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743806061422       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.371832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8960e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8258
    reference variance = 0.299082
====================================================
  Execution time = 4.3381e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4500e-01
  Total weights = 2.0000e+06
  Execution time = 4.2751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445108807812
                                         uncertainty =       0.002216775703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445108807812
                                         uncertainty =       0.002216775703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471696979
  error estimate for blocks of size 2^( 2) =       0.000496745334
  error estimate for blocks of size 2^( 3) =       0.000519988035
  error estimate for blocks of size 2^( 4) =       0.000536975809
  error estimate for blocks of size 2^( 5) =       0.000548022604
  error estimate for blocks of size 2^( 6) =       0.000554412611
  error estimate for blocks of size 2^( 7) =       0.000558711218

      target function =      -0.749488542192
              le_mean =     -22.814670568983
             les_mean =     520.954189028858
             stat err =       0.000549530560
             autocorr =       1.357242682900
   target nu stat err =       0.000549530560
   target dn stat err =       0.002617337170
      target stat err =       0.002312814565
              std dev =       0.667080265136
             le_variance =       0.444996080134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445108807812
                                         uncertainty =       0.002216775703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445108807812
                                         uncertainty =       0.002216775703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471696979
  error estimate for blocks of size 2^( 2) =       0.000496745334
  error estimate for blocks of size 2^( 3) =       0.000519988035
  error estimate for blocks of size 2^( 4) =       0.000536975809
  error estimate for blocks of size 2^( 5) =       0.000548022604
  error estimate for blocks of size 2^( 6) =       0.000554412611
  error estimate for blocks of size 2^( 7) =       0.000558711218

      target function =      -0.749488542192
              le_mean =     -22.814670568983
             les_mean =     520.954189028858
             stat err =       0.000549530560
             autocorr =       1.357242682900
   target nu stat err =       0.000549530560
   target dn stat err =       0.002617337170
      target stat err =       0.002312814565
              std dev =       0.667080265136
             le_variance =       0.444996080134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445108807812
                                         uncertainty =       0.002216775703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445108807812
                                         uncertainty =       0.002216775703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471696979
  error estimate for blocks of size 2^( 2) =       0.000496745334
  error estimate for blocks of size 2^( 3) =       0.000519988035
  error estimate for blocks of size 2^( 4) =       0.000536975809
  error estimate for blocks of size 2^( 5) =       0.000548022604
  error estimate for blocks of size 2^( 6) =       0.000554412611
  error estimate for blocks of size 2^( 7) =       0.000558711218

      target function =      -0.749488542192
              le_mean =     -22.814670568983
             les_mean =     520.954189028858
             stat err =       0.000549530560
             autocorr =       1.357242682900
   target nu stat err =       0.000549530560
   target dn stat err =       0.002617337170
      target stat err =       0.002312814565
              std dev =       0.667080265136
             le_variance =       0.444996080134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445108807812
                                         uncertainty =       0.002216775703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445108807812
                                         uncertainty =       0.002216775703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471696979
  error estimate for blocks of size 2^( 2) =       0.000496745334
  error estimate for blocks of size 2^( 3) =       0.000519988035
  error estimate for blocks of size 2^( 4) =       0.000536975809
  error estimate for blocks of size 2^( 5) =       0.000548022604
  error estimate for blocks of size 2^( 6) =       0.000554412611
  error estimate for blocks of size 2^( 7) =       0.000558711218

      target function =      -0.749488542192
              le_mean =     -22.814670568983
             les_mean =     520.954189028858
             stat err =       0.000549530560
             autocorr =       1.357242682900
   target nu stat err =       0.000549530560
   target dn stat err =       0.002617337170
      target stat err =       0.002312814565
              std dev =       0.667080265136
             le_variance =       0.444996080134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749488542192        initial  <--
     1.5625e+31     1.5625e+32             0.0000e+00        -0.749488542192
     6.2500e+31     6.2500e+32             0.0000e+00        -0.749488542192
     2.5000e+32     2.5000e+33             0.0000e+00        -0.749488542192

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8495
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2082e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.9771
    reference variance = 0.414042
====================================================
  Execution time = 4.3481e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.7545e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4698e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475431268058
                                         uncertainty =       0.025466844580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475431268058
                                         uncertainty =       0.025466844580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487569866
  error estimate for blocks of size 2^( 2) =       0.000511556949
  error estimate for blocks of size 2^( 3) =       0.000534475367
  error estimate for blocks of size 2^( 4) =       0.000551874067
  error estimate for blocks of size 2^( 5) =       0.000561154181
  error estimate for blocks of size 2^( 6) =       0.000566128492
  error estimate for blocks of size 2^( 7) =       0.000569437084

      target function =      -0.723868745704
              le_mean =     -22.814763449855
             les_mean =     520.988879784005
             stat err =       0.000562148456
             autocorr =       1.329316303668
   target nu stat err =       0.000562148456
   target dn stat err =       0.025631171791
      target stat err =       0.020372099802
              std dev =       0.689527917423
             le_variance =       0.475448748906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281476344985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+32, overlap shift 1.5625e+33 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724443821831       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724443821831       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+32, overlap shift 6.2500e+33 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724443821831       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724443821831       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+33, overlap shift 2.5000e+34 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724443821831       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724443821831       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.372972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8186e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8081
    reference variance = 0.413436
====================================================
  Execution time = 4.3002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5220e-01
  Total weights = 2.0000e+06
  Execution time = 3.5527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452199349104
                                         uncertainty =       0.005599964861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452199349104
                                         uncertainty =       0.005599964861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475502415
  error estimate for blocks of size 2^( 2) =       0.000500400606
  error estimate for blocks of size 2^( 3) =       0.000523248845
  error estimate for blocks of size 2^( 4) =       0.000540228714
  error estimate for blocks of size 2^( 5) =       0.000551222590
  error estimate for blocks of size 2^( 6) =       0.000557807042
  error estimate for blocks of size 2^( 7) =       0.000563037224

      target function =      -0.743409413527
              le_mean =     -22.813541989640
             les_mean =     520.909902980748
             stat err =       0.000553073893
             autocorr =       1.352884940228
   target nu stat err =       0.000553073893
   target dn stat err =       0.005044147854
      target stat err =       0.004261193136
              std dev =       0.672461964563
             le_variance =       0.452205093784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452199349104
                                         uncertainty =       0.005599964861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452199349104
                                         uncertainty =       0.005599964861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475502415
  error estimate for blocks of size 2^( 2) =       0.000500400606
  error estimate for blocks of size 2^( 3) =       0.000523248845
  error estimate for blocks of size 2^( 4) =       0.000540228714
  error estimate for blocks of size 2^( 5) =       0.000551222590
  error estimate for blocks of size 2^( 6) =       0.000557807042
  error estimate for blocks of size 2^( 7) =       0.000563037224

      target function =      -0.743409413527
              le_mean =     -22.813541989640
             les_mean =     520.909902980748
             stat err =       0.000553073893
             autocorr =       1.352884940232
   target nu stat err =       0.000553073893
   target dn stat err =       0.005044147854
      target stat err =       0.004261193136
              std dev =       0.672461964563
             le_variance =       0.452205093784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452199349104
                                         uncertainty =       0.005599964861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452199349104
                                         uncertainty =       0.005599964861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475502415
  error estimate for blocks of size 2^( 2) =       0.000500400606
  error estimate for blocks of size 2^( 3) =       0.000523248845
  error estimate for blocks of size 2^( 4) =       0.000540228714
  error estimate for blocks of size 2^( 5) =       0.000551222590
  error estimate for blocks of size 2^( 6) =       0.000557807042
  error estimate for blocks of size 2^( 7) =       0.000563037224

      target function =      -0.743409413527
              le_mean =     -22.813541989640
             les_mean =     520.909902980748
             stat err =       0.000553073893
             autocorr =       1.352884940232
   target nu stat err =       0.000553073893
   target dn stat err =       0.005044147854
      target stat err =       0.004261193136
              std dev =       0.672461964563
             le_variance =       0.452205093784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452199349104
                                         uncertainty =       0.005599964861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452199349104
                                         uncertainty =       0.005599964861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475502415
  error estimate for blocks of size 2^( 2) =       0.000500400606
  error estimate for blocks of size 2^( 3) =       0.000523248845
  error estimate for blocks of size 2^( 4) =       0.000540228714
  error estimate for blocks of size 2^( 5) =       0.000551222590
  error estimate for blocks of size 2^( 6) =       0.000557807042
  error estimate for blocks of size 2^( 7) =       0.000563037224

      target function =      -0.743409413527
              le_mean =     -22.813541989640
             les_mean =     520.909902980748
             stat err =       0.000553073893
             autocorr =       1.352884940232
   target nu stat err =       0.000553073893
   target dn stat err =       0.005044147854
      target stat err =       0.004261193136
              std dev =       0.672461964563
             le_variance =       0.452205093784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743409413527        initial  <--
     1.5625e+32     1.5625e+33             0.0000e+00        -0.743409413527
     6.2500e+32     6.2500e+33             0.0000e+00        -0.743409413527
     2.5000e+33     2.5000e+34             0.0000e+00        -0.743409413527

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.7575
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1897e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7596
    reference variance = 0.492368
====================================================
  Execution time = 4.3975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4604e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4814e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446001324731
                                         uncertainty =       0.002731459002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446001324731
                                         uncertainty =       0.002731459002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472248568
  error estimate for blocks of size 2^( 2) =       0.000497325087
  error estimate for blocks of size 2^( 3) =       0.000520118959
  error estimate for blocks of size 2^( 4) =       0.000537558150
  error estimate for blocks of size 2^( 5) =       0.000548318836
  error estimate for blocks of size 2^( 6) =       0.000554014365
  error estimate for blocks of size 2^( 7) =       0.000557688350

      target function =      -0.748609948235
              le_mean =     -22.813884045029
             les_mean =     520.919342416591
             stat err =       0.000549394925
             autocorr =       1.353405658813
   target nu stat err =       0.000549394925
   target dn stat err =       0.003219539883
      target stat err =       0.002799854508
              std dev =       0.667860329413
             le_variance =       0.446037419604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281388404503e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+33, overlap shift 1.5625e+34 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748619329108       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748619329108       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748619329097       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+33 is 5.520495e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+33, overlap shift 6.2500e+34 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748619329108       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748619329108       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748619329126       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+33 is 1.380124e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+34, overlap shift 2.5000e+35 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748619329108       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748619329108       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748619329068       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+34 is 3.450310e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.374350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8796e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8268
    reference variance = 0.280472
====================================================
  Execution time = 4.3291e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.6410e-01
  Total weights = 2.0000e+06
  Execution time = 3.7775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464214543781
                                         uncertainty =       0.014780075266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464214543781
                                         uncertainty =       0.014780075266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481714554
  error estimate for blocks of size 2^( 2) =       0.000506164916
  error estimate for blocks of size 2^( 3) =       0.000529227193
  error estimate for blocks of size 2^( 4) =       0.000546939845
  error estimate for blocks of size 2^( 5) =       0.000557466327
  error estimate for blocks of size 2^( 6) =       0.000563140963
  error estimate for blocks of size 2^( 7) =       0.000567611621

      target function =      -0.733411988056
              le_mean =     -22.813773297325
             les_mean =     520.932349652680
             stat err =       0.000558789689
             autocorr =       1.345603884001
   target nu stat err =       0.000558789689
   target dn stat err =       0.015018886119
      target stat err =       0.012239551293
              std dev =       0.681247255399
             le_variance =       0.464097822989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464214543781
                                         uncertainty =       0.014780075266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464214543781
                                         uncertainty =       0.014780075266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481714554
  error estimate for blocks of size 2^( 2) =       0.000506164916
  error estimate for blocks of size 2^( 3) =       0.000529227193
  error estimate for blocks of size 2^( 4) =       0.000546939845
  error estimate for blocks of size 2^( 5) =       0.000557466327
  error estimate for blocks of size 2^( 6) =       0.000563140963
  error estimate for blocks of size 2^( 7) =       0.000567611621

      target function =      -0.733411988056
              le_mean =     -22.813773297325
             les_mean =     520.932349652680
             stat err =       0.000558789689
             autocorr =       1.345603884002
   target nu stat err =       0.000558789689
   target dn stat err =       0.015018886119
      target stat err =       0.012239551293
              std dev =       0.681247255399
             le_variance =       0.464097822989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464214543781
                                         uncertainty =       0.014780075266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464214543781
                                         uncertainty =       0.014780075266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481714554
  error estimate for blocks of size 2^( 2) =       0.000506164916
  error estimate for blocks of size 2^( 3) =       0.000529227193
  error estimate for blocks of size 2^( 4) =       0.000546939845
  error estimate for blocks of size 2^( 5) =       0.000557466327
  error estimate for blocks of size 2^( 6) =       0.000563140963
  error estimate for blocks of size 2^( 7) =       0.000567611621

      target function =      -0.733411988056
              le_mean =     -22.813773297325
             les_mean =     520.932349652680
             stat err =       0.000558789689
             autocorr =       1.345603884002
   target nu stat err =       0.000558789689
   target dn stat err =       0.015018886119
      target stat err =       0.012239551293
              std dev =       0.681247255399
             le_variance =       0.464097822989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464214543781
                                         uncertainty =       0.014780075266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464214543781
                                         uncertainty =       0.014780075266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481714554
  error estimate for blocks of size 2^( 2) =       0.000506164916
  error estimate for blocks of size 2^( 3) =       0.000529227193
  error estimate for blocks of size 2^( 4) =       0.000546939845
  error estimate for blocks of size 2^( 5) =       0.000557466327
  error estimate for blocks of size 2^( 6) =       0.000563140963
  error estimate for blocks of size 2^( 7) =       0.000567611621

      target function =      -0.733411988056
              le_mean =     -22.813773297325
             les_mean =     520.932349652680
             stat err =       0.000558789689
             autocorr =       1.345603884002
   target nu stat err =       0.000558789689
   target dn stat err =       0.015018886119
      target stat err =       0.012239551293
              std dev =       0.681247255399
             le_variance =       0.464097822989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.733411988056        initial  <--
     1.5625e+33     1.5625e+34             5.5205e-38        -0.733411988056
     6.2500e+33     6.2500e+34             1.3801e-38        -0.733411988056
     2.5000e+34     2.5000e+35             3.4503e-39        -0.733411988056

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.3397
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2114e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.9109
    reference variance = 0.528122
====================================================
  Execution time = 4.5550e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4200e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4624e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442007617485
                                         uncertainty =       0.002641282013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442007617485
                                         uncertainty =       0.002641282013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470103958
  error estimate for blocks of size 2^( 2) =       0.000494912551
  error estimate for blocks of size 2^( 3) =       0.000518149011
  error estimate for blocks of size 2^( 4) =       0.000535015551
  error estimate for blocks of size 2^( 5) =       0.000546435644
  error estimate for blocks of size 2^( 6) =       0.000552124796
  error estimate for blocks of size 2^( 7) =       0.000555974623

      target function =      -0.752055730488
              le_mean =     -22.813830263213
             les_mean =     520.912846520057
             stat err =       0.000547387654
             autocorr =       1.355820449548
   target nu stat err =       0.000547387654
   target dn stat err =       0.002754266374
      target stat err =       0.002437578403
              std dev =       0.664827392920
             le_variance =       0.441995462377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281383026321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+34, overlap shift 1.5625e+35 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752062643835       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752062643835       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752062643835       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752062643835       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752062643835       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+34 is 1.579327e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+34, overlap shift 6.2500e+35 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752062643835       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752062643835       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752062643835       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752062643835       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752075195312       residual = 2.67e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+34 is 3.587726e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+35, overlap shift 2.5000e+36 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752062643835       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752062643835       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752062643835       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752062559128       residual = 8.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 6.27e+16           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+35 is 7.980024e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.376342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0181e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8944
    reference variance = 0.562105
====================================================
  Execution time = 4.3287e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4564e-01
  Total weights = 2.0000e+06
  Execution time = 3.5485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445511747569
                                         uncertainty =       0.003953939748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445511747569
                                         uncertainty =       0.003953939748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472036691
  error estimate for blocks of size 2^( 2) =       0.000496833501
  error estimate for blocks of size 2^( 3) =       0.000519954727
  error estimate for blocks of size 2^( 4) =       0.000537760794
  error estimate for blocks of size 2^( 5) =       0.000547990930
  error estimate for blocks of size 2^( 6) =       0.000553045232
  error estimate for blocks of size 2^( 7) =       0.000554687554

      target function =      -0.748935497860
              le_mean =     -22.814508802639
             les_mean =     520.947448958338
             stat err =       0.000548371127
             autocorr =       1.349576931747
   target nu stat err =       0.000548371127
   target dn stat err =       0.004140676817
      target stat err =       0.003571835837
              std dev =       0.667560690475
             le_variance =       0.445637275468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445511747569
                                         uncertainty =       0.003953939748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445511747569
                                         uncertainty =       0.003953939748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472036691
  error estimate for blocks of size 2^( 2) =       0.000496833501
  error estimate for blocks of size 2^( 3) =       0.000519954727
  error estimate for blocks of size 2^( 4) =       0.000537760794
  error estimate for blocks of size 2^( 5) =       0.000547990930
  error estimate for blocks of size 2^( 6) =       0.000553045232
  error estimate for blocks of size 2^( 7) =       0.000554687554

      target function =      -0.748935497860
              le_mean =     -22.814508802639
             les_mean =     520.947448958338
             stat err =       0.000548371127
             autocorr =       1.349576931747
   target nu stat err =       0.000548371127
   target dn stat err =       0.004140676817
      target stat err =       0.003571835837
              std dev =       0.667560690475
             le_variance =       0.445637275468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445511747569
                                         uncertainty =       0.003953939748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445511747569
                                         uncertainty =       0.003953939748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472036691
  error estimate for blocks of size 2^( 2) =       0.000496833501
  error estimate for blocks of size 2^( 3) =       0.000519954727
  error estimate for blocks of size 2^( 4) =       0.000537760794
  error estimate for blocks of size 2^( 5) =       0.000547990930
  error estimate for blocks of size 2^( 6) =       0.000553045232
  error estimate for blocks of size 2^( 7) =       0.000554687554

      target function =      -0.748935497860
              le_mean =     -22.814508802639
             les_mean =     520.947448958338
             stat err =       0.000548371127
             autocorr =       1.349576931747
   target nu stat err =       0.000548371127
   target dn stat err =       0.004140676817
      target stat err =       0.003571835837
              std dev =       0.667560690475
             le_variance =       0.445637275468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445511747569
                                         uncertainty =       0.003953939748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445511747569
                                         uncertainty =       0.003953939748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472036691
  error estimate for blocks of size 2^( 2) =       0.000496833501
  error estimate for blocks of size 2^( 3) =       0.000519954727
  error estimate for blocks of size 2^( 4) =       0.000537760794
  error estimate for blocks of size 2^( 5) =       0.000547990930
  error estimate for blocks of size 2^( 6) =       0.000553045232
  error estimate for blocks of size 2^( 7) =       0.000554687554

      target function =      -0.748935497860
              le_mean =     -22.814508802639
             les_mean =     520.947448958338
             stat err =       0.000548371127
             autocorr =       1.349576931747
   target nu stat err =       0.000548371127
   target dn stat err =       0.004140676817
      target stat err =       0.003571835837
              std dev =       0.667560690475
             le_variance =       0.445637275468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748935497860        initial  <--
     1.5625e+34     1.5625e+35             1.5793e-38        -0.748935497860
     6.2500e+34     6.2500e+35             3.5877e-39        -0.748935497860
     2.5000e+35     2.5000e+36             7.9800e-40        -0.748935497860

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0187
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2123e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.804
    reference variance = 0.513573
====================================================
  Execution time = 4.3678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4869e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4871e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448720591461
                                         uncertainty =       0.002705600782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448720591461
                                         uncertainty =       0.002705600782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473650736
  error estimate for blocks of size 2^( 2) =       0.000498938821
  error estimate for blocks of size 2^( 3) =       0.000522711906
  error estimate for blocks of size 2^( 4) =       0.000539741913
  error estimate for blocks of size 2^( 5) =       0.000551727546
  error estimate for blocks of size 2^( 6) =       0.000557629135
  error estimate for blocks of size 2^( 7) =       0.000560691276

      target function =      -0.746353792772
              le_mean =     -22.814838747499
             les_mean =     520.965556890196
             stat err =       0.000552447467
             autocorr =       1.360396607164
   target nu stat err =       0.000552447467
   target dn stat err =       0.002976408128
      target stat err =       0.002588632277
              std dev =       0.669843295240
             le_variance =       0.448690040178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281483874750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+35, overlap shift 1.5625e+36 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746361710844       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746361710844       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746361732483       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+35 is 6.194809e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+35, overlap shift 6.2500e+36 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746361710844       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746361710844       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746361732483       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+35 is 1.548702e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+36, overlap shift 2.5000e+37 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746361710844       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746361710844       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746360778809       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+36 is 3.871756e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.377765 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8555e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8386
    reference variance = 0.356875
====================================================
  Execution time = 4.3275e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5603e-01
  Total weights = 2.0000e+06
  Execution time = 3.5590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040687745
                                         uncertainty =       0.004538835945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040687745
                                         uncertainty =       0.004538835945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477509404
  error estimate for blocks of size 2^( 2) =       0.000502048691
  error estimate for blocks of size 2^( 3) =       0.000525458671
  error estimate for blocks of size 2^( 4) =       0.000541654631
  error estimate for blocks of size 2^( 5) =       0.000552319495
  error estimate for blocks of size 2^( 6) =       0.000558922316
  error estimate for blocks of size 2^( 7) =       0.000559925960

      target function =      -0.740208428166
              le_mean =     -22.814637196722
             les_mean =     520.963700651457
             stat err =       0.000553205600
             autocorr =       1.342175412402
   target nu stat err =       0.000553205600
   target dn stat err =       0.003936558712
      target stat err =       0.003325389936
              std dev =       0.675300275010
             le_variance =       0.456030461428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040687745
                                         uncertainty =       0.004538835945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040687745
                                         uncertainty =       0.004538835945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477509404
  error estimate for blocks of size 2^( 2) =       0.000502048691
  error estimate for blocks of size 2^( 3) =       0.000525458671
  error estimate for blocks of size 2^( 4) =       0.000541654631
  error estimate for blocks of size 2^( 5) =       0.000552319495
  error estimate for blocks of size 2^( 6) =       0.000558922316
  error estimate for blocks of size 2^( 7) =       0.000559925960

      target function =      -0.740208428166
              le_mean =     -22.814637196722
             les_mean =     520.963700651457
             stat err =       0.000553205600
             autocorr =       1.342175412402
   target nu stat err =       0.000553205600
   target dn stat err =       0.003936558712
      target stat err =       0.003325389936
              std dev =       0.675300275010
             le_variance =       0.456030461428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040687745
                                         uncertainty =       0.004538835945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040687745
                                         uncertainty =       0.004538835945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477509404
  error estimate for blocks of size 2^( 2) =       0.000502048691
  error estimate for blocks of size 2^( 3) =       0.000525458671
  error estimate for blocks of size 2^( 4) =       0.000541654631
  error estimate for blocks of size 2^( 5) =       0.000552319495
  error estimate for blocks of size 2^( 6) =       0.000558922316
  error estimate for blocks of size 2^( 7) =       0.000559925960

      target function =      -0.740208428166
              le_mean =     -22.814637196722
             les_mean =     520.963700651457
             stat err =       0.000553205600
             autocorr =       1.342175412402
   target nu stat err =       0.000553205600
   target dn stat err =       0.003936558712
      target stat err =       0.003325389936
              std dev =       0.675300275010
             le_variance =       0.456030461428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040687745
                                         uncertainty =       0.004538835945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456040687745
                                         uncertainty =       0.004538835945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477509404
  error estimate for blocks of size 2^( 2) =       0.000502048691
  error estimate for blocks of size 2^( 3) =       0.000525458671
  error estimate for blocks of size 2^( 4) =       0.000541654631
  error estimate for blocks of size 2^( 5) =       0.000552319495
  error estimate for blocks of size 2^( 6) =       0.000558922316
  error estimate for blocks of size 2^( 7) =       0.000559925960

      target function =      -0.740208428166
              le_mean =     -22.814637196722
             les_mean =     520.963700651457
             stat err =       0.000553205600
             autocorr =       1.342175412402
   target nu stat err =       0.000553205600
   target dn stat err =       0.003936558712
      target stat err =       0.003325389936
              std dev =       0.675300275010
             le_variance =       0.456030461428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740208428166        initial  <--
     1.5625e+35     1.5625e+36             6.1948e-40        -0.740208428166
     6.2500e+35     6.2500e+36             1.5487e-40        -0.740208428166
     2.5000e+36     2.5000e+37             3.8718e-41        -0.740208428166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0623
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1970e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7616
    reference variance = 0.295093
====================================================
  Execution time = 4.4833e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4796e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5267e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448005034992
                                         uncertainty =       0.002729655214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448005034992
                                         uncertainty =       0.002729655214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473263289
  error estimate for blocks of size 2^( 2) =       0.000498001705
  error estimate for blocks of size 2^( 3) =       0.000521437017
  error estimate for blocks of size 2^( 4) =       0.000538542253
  error estimate for blocks of size 2^( 5) =       0.000549621752
  error estimate for blocks of size 2^( 6) =       0.000555731401
  error estimate for blocks of size 2^( 7) =       0.000559352629

      target function =      -0.746978791032
              le_mean =     -22.814496515734
             les_mean =     520.949207323101
             stat err =       0.000550812009
             autocorr =       1.354569104218
   target nu stat err =       0.000550812009
   target dn stat err =       0.002987420143
      target stat err =       0.002600087305
              std dev =       0.669295361303
             le_variance =       0.447956280662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281449651573e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+36, overlap shift 1.5625e+37 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746986844175       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746986844175       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+36, overlap shift 6.2500e+37 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746986844175       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746986844175       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+37, overlap shift 2.5000e+38 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746986844175       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746986844175       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.378904 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0107e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8069
    reference variance = 0.592279
====================================================
  Execution time = 4.5585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5196e-01
  Total weights = 2.0000e+06
  Execution time = 3.5665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451885159116
                                         uncertainty =       0.004345077286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451885159116
                                         uncertainty =       0.004345077286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475371424
  error estimate for blocks of size 2^( 2) =       0.000500042645
  error estimate for blocks of size 2^( 3) =       0.000523432567
  error estimate for blocks of size 2^( 4) =       0.000540628497
  error estimate for blocks of size 2^( 5) =       0.000552138816
  error estimate for blocks of size 2^( 6) =       0.000558852431
  error estimate for blocks of size 2^( 7) =       0.000561030807

      target function =      -0.743604442240
              le_mean =     -22.814529889675
             les_mean =     520.954729842820
             stat err =       0.000553162638
             autocorr =       1.354065067535
   target nu stat err =       0.000553162638
   target dn stat err =       0.004367367924
      target stat err =       0.003710000844
              std dev =       0.672276715285
             le_variance =       0.451955981915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451885159116
                                         uncertainty =       0.004345077286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451885159116
                                         uncertainty =       0.004345077286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475371424
  error estimate for blocks of size 2^( 2) =       0.000500042645
  error estimate for blocks of size 2^( 3) =       0.000523432567
  error estimate for blocks of size 2^( 4) =       0.000540628497
  error estimate for blocks of size 2^( 5) =       0.000552138816
  error estimate for blocks of size 2^( 6) =       0.000558852431
  error estimate for blocks of size 2^( 7) =       0.000561030807

      target function =      -0.743604442240
              le_mean =     -22.814529889675
             les_mean =     520.954729842820
             stat err =       0.000553162638
             autocorr =       1.354065067535
   target nu stat err =       0.000553162638
   target dn stat err =       0.004367367924
      target stat err =       0.003710000844
              std dev =       0.672276715285
             le_variance =       0.451955981915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451885159116
                                         uncertainty =       0.004345077286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451885159116
                                         uncertainty =       0.004345077286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475371424
  error estimate for blocks of size 2^( 2) =       0.000500042645
  error estimate for blocks of size 2^( 3) =       0.000523432567
  error estimate for blocks of size 2^( 4) =       0.000540628497
  error estimate for blocks of size 2^( 5) =       0.000552138816
  error estimate for blocks of size 2^( 6) =       0.000558852431
  error estimate for blocks of size 2^( 7) =       0.000561030807

      target function =      -0.743604442240
              le_mean =     -22.814529889675
             les_mean =     520.954729842820
             stat err =       0.000553162638
             autocorr =       1.354065067535
   target nu stat err =       0.000553162638
   target dn stat err =       0.004367367924
      target stat err =       0.003710000844
              std dev =       0.672276715285
             le_variance =       0.451955981915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451885159116
                                         uncertainty =       0.004345077286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451885159116
                                         uncertainty =       0.004345077286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475371424
  error estimate for blocks of size 2^( 2) =       0.000500042645
  error estimate for blocks of size 2^( 3) =       0.000523432567
  error estimate for blocks of size 2^( 4) =       0.000540628497
  error estimate for blocks of size 2^( 5) =       0.000552138816
  error estimate for blocks of size 2^( 6) =       0.000558852431
  error estimate for blocks of size 2^( 7) =       0.000561030807

      target function =      -0.743604442240
              le_mean =     -22.814529889675
             les_mean =     520.954729842820
             stat err =       0.000553162638
             autocorr =       1.354065067535
   target nu stat err =       0.000553162638
   target dn stat err =       0.004367367924
      target stat err =       0.003710000844
              std dev =       0.672276715285
             le_variance =       0.451955981915


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743604442240        initial  <--
     1.5625e+36     1.5625e+37             0.0000e+00        -0.743604442240
     6.2500e+36     6.2500e+37             0.0000e+00        -0.743604442240
     2.5000e+37     2.5000e+38             0.0000e+00        -0.743604442240

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3828
  </log>
  <optVariables href="FORM.s040.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2350e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7925
    reference variance = 0.319118
====================================================
  Execution time = 4.3991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4594e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4686e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445878259189
                                         uncertainty =       0.002636337168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445878259189
                                         uncertainty =       0.002636337168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472196728
  error estimate for blocks of size 2^( 2) =       0.000497366238
  error estimate for blocks of size 2^( 3) =       0.000520991321
  error estimate for blocks of size 2^( 4) =       0.000538398934
  error estimate for blocks of size 2^( 5) =       0.000549695956
  error estimate for blocks of size 2^( 6) =       0.000554470135
  error estimate for blocks of size 2^( 7) =       0.000558200255

      target function =      -0.748678219381
              le_mean =     -22.815226752633
             les_mean =     520.980511051128
             stat err =       0.000550191320
             autocorr =       1.357630299666
   target nu stat err =       0.000550191320
   target dn stat err =       0.002780070439
      target stat err =       0.002443573456
              std dev =       0.667787016987
             le_variance =       0.445939500056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281522675263e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+37, overlap shift 1.5625e+38 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748685170084       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748685170084       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+37, overlap shift 6.2500e+38 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748685170084       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748685170084       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+38, overlap shift 2.5000e+39 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748685170084       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748685170084       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.380046 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8684e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.9601
    reference variance = 1.15872
====================================================
  Execution time = 4.3348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5357e-01
  Total weights = 2.0000e+06
  Execution time = 3.5642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453575918080
                                         uncertainty =       0.006190739222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453575918080
                                         uncertainty =       0.006190739222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476219432
  error estimate for blocks of size 2^( 2) =       0.000500984239
  error estimate for blocks of size 2^( 3) =       0.000523782566
  error estimate for blocks of size 2^( 4) =       0.000540423111
  error estimate for blocks of size 2^( 5) =       0.000550249090
  error estimate for blocks of size 2^( 6) =       0.000554587590
  error estimate for blocks of size 2^( 7) =       0.000557051922

      target function =      -0.742234729115
              le_mean =     -22.814426781697
             les_mean =     520.951639045509
             stat err =       0.000550577928
             autocorr =       1.336667438839
   target nu stat err =       0.000550577928
   target dn stat err =       0.006618380255
      target stat err =       0.005555851283
              std dev =       0.673475979428
             le_variance =       0.453569894867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453575918080
                                         uncertainty =       0.006190739222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453575918080
                                         uncertainty =       0.006190739222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476219432
  error estimate for blocks of size 2^( 2) =       0.000500984239
  error estimate for blocks of size 2^( 3) =       0.000523782566
  error estimate for blocks of size 2^( 4) =       0.000540423111
  error estimate for blocks of size 2^( 5) =       0.000550249090
  error estimate for blocks of size 2^( 6) =       0.000554587590
  error estimate for blocks of size 2^( 7) =       0.000557051922

      target function =      -0.742234729115
              le_mean =     -22.814426781697
             les_mean =     520.951639045509
             stat err =       0.000550577928
             autocorr =       1.336667438839
   target nu stat err =       0.000550577928
   target dn stat err =       0.006618380255
      target stat err =       0.005555851283
              std dev =       0.673475979428
             le_variance =       0.453569894867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453575918080
                                         uncertainty =       0.006190739222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453575918080
                                         uncertainty =       0.006190739222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476219432
  error estimate for blocks of size 2^( 2) =       0.000500984239
  error estimate for blocks of size 2^( 3) =       0.000523782566
  error estimate for blocks of size 2^( 4) =       0.000540423111
  error estimate for blocks of size 2^( 5) =       0.000550249090
  error estimate for blocks of size 2^( 6) =       0.000554587590
  error estimate for blocks of size 2^( 7) =       0.000557051922

      target function =      -0.742234729115
              le_mean =     -22.814426781697
             les_mean =     520.951639045509
             stat err =       0.000550577928
             autocorr =       1.336667438839
   target nu stat err =       0.000550577928
   target dn stat err =       0.006618380255
      target stat err =       0.005555851283
              std dev =       0.673475979428
             le_variance =       0.453569894867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453575918080
                                         uncertainty =       0.006190739222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453575918080
                                         uncertainty =       0.006190739222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476219432
  error estimate for blocks of size 2^( 2) =       0.000500984239
  error estimate for blocks of size 2^( 3) =       0.000523782566
  error estimate for blocks of size 2^( 4) =       0.000540423111
  error estimate for blocks of size 2^( 5) =       0.000550249090
  error estimate for blocks of size 2^( 6) =       0.000554587590
  error estimate for blocks of size 2^( 7) =       0.000557051922

      target function =      -0.742234729115
              le_mean =     -22.814426781697
             les_mean =     520.951639045509
             stat err =       0.000550577928
             autocorr =       1.336667438839
   target nu stat err =       0.000550577928
   target dn stat err =       0.006618380255
      target stat err =       0.005555851283
              std dev =       0.673475979428
             le_variance =       0.453569894867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742234729115        initial  <--
     1.5625e+37     1.5625e+38             0.0000e+00        -0.742234729115
     6.2500e+37     6.2500e+38             0.0000e+00        -0.742234729115
     2.5000e+38     2.5000e+39             0.0000e+00        -0.742234729115

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1476
  </log>
  <optVariables href="FORM.s041.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1986e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8088
    reference variance = 0.286862
====================================================
  Execution time = 4.3893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 5.0887e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4923e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508931014607
                                         uncertainty =       0.056883899897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508931014607
                                         uncertainty =       0.056883899897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504416516
  error estimate for blocks of size 2^( 2) =       0.000528168117
  error estimate for blocks of size 2^( 3) =       0.000550714149
  error estimate for blocks of size 2^( 4) =       0.000568517137
  error estimate for blocks of size 2^( 5) =       0.000580142963
  error estimate for blocks of size 2^( 6) =       0.000586980545
  error estimate for blocks of size 2^( 7) =       0.000592036331

      target function =      -0.696209479136
              le_mean =     -22.815792912372
             les_mean =     521.069278009674
             stat err =       0.000581919244
             autocorr =       1.330904342773
   target nu stat err =       0.000581919244
   target dn stat err =       0.056599694405
      target stat err =       0.041781949928
              std dev =       0.713352678453
             le_variance =       0.508872043856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281579291237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+38, overlap shift 1.5625e+39 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698724480311       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698724480311       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+38, overlap shift 6.2500e+39 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698724480311       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698724480311       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+39, overlap shift 2.5000e+40 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.698724480311       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.698724480311       residual = 9.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.381210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8822e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.9107
    reference variance = 0.261677
====================================================
  Execution time = 4.4927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6127e-01
  Total weights = 2.0000e+06
  Execution time = 3.6112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461376628991
                                         uncertainty =       0.008591179295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461376628991
                                         uncertainty =       0.008591179295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480245362
  error estimate for blocks of size 2^( 2) =       0.000505163606
  error estimate for blocks of size 2^( 3) =       0.000528423366
  error estimate for blocks of size 2^( 4) =       0.000544599294
  error estimate for blocks of size 2^( 5) =       0.000556318715
  error estimate for blocks of size 2^( 6) =       0.000562812584
  error estimate for blocks of size 2^( 7) =       0.000565891124

      target function =      -0.735801938299
              le_mean =     -22.815421260453
             les_mean =     521.004718276817
             stat err =       0.000557405429
             autocorr =       1.347150231510
   target nu stat err =       0.000557405429
   target dn stat err =       0.008857204089
      target stat err =       0.007299275307
              std dev =       0.679169504277
             le_variance =       0.461271215540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461376628991
                                         uncertainty =       0.008591179295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461376628991
                                         uncertainty =       0.008591179295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480245362
  error estimate for blocks of size 2^( 2) =       0.000505163606
  error estimate for blocks of size 2^( 3) =       0.000528423366
  error estimate for blocks of size 2^( 4) =       0.000544599294
  error estimate for blocks of size 2^( 5) =       0.000556318715
  error estimate for blocks of size 2^( 6) =       0.000562812584
  error estimate for blocks of size 2^( 7) =       0.000565891124

      target function =      -0.735801938299
              le_mean =     -22.815421260453
             les_mean =     521.004718276817
             stat err =       0.000557405429
             autocorr =       1.347150231510
   target nu stat err =       0.000557405429
   target dn stat err =       0.008857204089
      target stat err =       0.007299275307
              std dev =       0.679169504277
             le_variance =       0.461271215540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461376628991
                                         uncertainty =       0.008591179295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461376628991
                                         uncertainty =       0.008591179295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480245362
  error estimate for blocks of size 2^( 2) =       0.000505163606
  error estimate for blocks of size 2^( 3) =       0.000528423366
  error estimate for blocks of size 2^( 4) =       0.000544599294
  error estimate for blocks of size 2^( 5) =       0.000556318715
  error estimate for blocks of size 2^( 6) =       0.000562812584
  error estimate for blocks of size 2^( 7) =       0.000565891124

      target function =      -0.735801938299
              le_mean =     -22.815421260453
             les_mean =     521.004718276817
             stat err =       0.000557405429
             autocorr =       1.347150231510
   target nu stat err =       0.000557405429
   target dn stat err =       0.008857204089
      target stat err =       0.007299275307
              std dev =       0.679169504277
             le_variance =       0.461271215540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461376628991
                                         uncertainty =       0.008591179295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461376628991
                                         uncertainty =       0.008591179295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480245362
  error estimate for blocks of size 2^( 2) =       0.000505163606
  error estimate for blocks of size 2^( 3) =       0.000528423366
  error estimate for blocks of size 2^( 4) =       0.000544599294
  error estimate for blocks of size 2^( 5) =       0.000556318715
  error estimate for blocks of size 2^( 6) =       0.000562812584
  error estimate for blocks of size 2^( 7) =       0.000565891124

      target function =      -0.735801938299
              le_mean =     -22.815421260453
             les_mean =     521.004718276817
             stat err =       0.000557405429
             autocorr =       1.347150231510
   target nu stat err =       0.000557405429
   target dn stat err =       0.008857204089
      target stat err =       0.007299275307
              std dev =       0.679169504277
             le_variance =       0.461271215540


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.735801938299        initial  <--
     1.5625e+38     1.5625e+39             0.0000e+00        -0.735801938299
     6.2500e+38     6.2500e+39             0.0000e+00        -0.735801938299
     2.5000e+39     2.5000e+40             0.0000e+00        -0.735801938299

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8279
  </log>
  <optVariables href="FORM.s042.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2166e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7466
    reference variance = 0.407399
====================================================
  Execution time = 4.5904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5347e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4846e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453499691251
                                         uncertainty =       0.004343442094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453499691251
                                         uncertainty =       0.004343442094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476167014
  error estimate for blocks of size 2^( 2) =       0.000500653193
  error estimate for blocks of size 2^( 3) =       0.000523146259
  error estimate for blocks of size 2^( 4) =       0.000540429414
  error estimate for blocks of size 2^( 5) =       0.000551975412
  error estimate for blocks of size 2^( 6) =       0.000557707474
  error estimate for blocks of size 2^( 7) =       0.000556136424

      target function =      -0.742343438897
              le_mean =     -22.814304034830
             les_mean =     520.945938417648
             stat err =       0.000551562181
             autocorr =       1.341746115747
   target nu stat err =       0.000551562181
   target dn stat err =       0.004356971366
      target stat err =       0.003687489728
              std dev =       0.673401849355
             le_variance =       0.453470050715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281430403483e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+39, overlap shift 1.5625e+40 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742360821309       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742360821309       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+39, overlap shift 6.2500e+40 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742360821309       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742360821309       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+40, overlap shift 2.5000e+41 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742360821309       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742360821309       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.382336 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0756e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.931
    reference variance = 0.593796
====================================================
  Execution time = 4.3535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4969e-01
  Total weights = 2.0000e+06
  Execution time = 3.5587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449606862602
                                         uncertainty =       0.003111308840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449606862602
                                         uncertainty =       0.003111308840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474180328
  error estimate for blocks of size 2^( 2) =       0.000499316135
  error estimate for blocks of size 2^( 3) =       0.000522258176
  error estimate for blocks of size 2^( 4) =       0.000539625804
  error estimate for blocks of size 2^( 5) =       0.000550318468
  error estimate for blocks of size 2^( 6) =       0.000557434581
  error estimate for blocks of size 2^( 7) =       0.000562407363

      target function =      -0.745491802450
              le_mean =     -22.815594124943
             les_mean =     521.001029016750
             stat err =       0.000552446554
             autocorr =       1.357355076522
   target nu stat err =       0.000552446554
   target dn stat err =       0.003244875490
      target stat err =       0.002805948472
              std dev =       0.670592251260
             le_variance =       0.449693967451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449606862602
                                         uncertainty =       0.003111308840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449606862602
                                         uncertainty =       0.003111308840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474180328
  error estimate for blocks of size 2^( 2) =       0.000499316135
  error estimate for blocks of size 2^( 3) =       0.000522258176
  error estimate for blocks of size 2^( 4) =       0.000539625804
  error estimate for blocks of size 2^( 5) =       0.000550318468
  error estimate for blocks of size 2^( 6) =       0.000557434581
  error estimate for blocks of size 2^( 7) =       0.000562407363

      target function =      -0.745491802450
              le_mean =     -22.815594124943
             les_mean =     521.001029016750
             stat err =       0.000552446554
             autocorr =       1.357355076522
   target nu stat err =       0.000552446554
   target dn stat err =       0.003244875490
      target stat err =       0.002805948472
              std dev =       0.670592251260
             le_variance =       0.449693967451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449606862602
                                         uncertainty =       0.003111308840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449606862602
                                         uncertainty =       0.003111308840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474180328
  error estimate for blocks of size 2^( 2) =       0.000499316135
  error estimate for blocks of size 2^( 3) =       0.000522258176
  error estimate for blocks of size 2^( 4) =       0.000539625804
  error estimate for blocks of size 2^( 5) =       0.000550318468
  error estimate for blocks of size 2^( 6) =       0.000557434581
  error estimate for blocks of size 2^( 7) =       0.000562407363

      target function =      -0.745491802450
              le_mean =     -22.815594124943
             les_mean =     521.001029016750
             stat err =       0.000552446554
             autocorr =       1.357355076522
   target nu stat err =       0.000552446554
   target dn stat err =       0.003244875490
      target stat err =       0.002805948472
              std dev =       0.670592251260
             le_variance =       0.449693967451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449606862602
                                         uncertainty =       0.003111308840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449606862602
                                         uncertainty =       0.003111308840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474180328
  error estimate for blocks of size 2^( 2) =       0.000499316135
  error estimate for blocks of size 2^( 3) =       0.000522258176
  error estimate for blocks of size 2^( 4) =       0.000539625804
  error estimate for blocks of size 2^( 5) =       0.000550318468
  error estimate for blocks of size 2^( 6) =       0.000557434581
  error estimate for blocks of size 2^( 7) =       0.000562407363

      target function =      -0.745491802450
              le_mean =     -22.815594124943
             les_mean =     521.001029016750
             stat err =       0.000552446554
             autocorr =       1.357355076522
   target nu stat err =       0.000552446554
   target dn stat err =       0.003244875490
      target stat err =       0.002805948472
              std dev =       0.670592251260
             le_variance =       0.449693967451


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745491802450        initial  <--
     1.5625e+39     1.5625e+40             0.0000e+00        -0.745491802450
     6.2500e+39     6.2500e+40             0.0000e+00        -0.745491802450
     2.5000e+40     2.5000e+41             0.0000e+00        -0.745491802450

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3231
  </log>
  <optVariables href="FORM.s043.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2209e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7804
    reference variance = 0.477052
====================================================
  Execution time = 4.3824e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4528e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4662e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445342960186
                                         uncertainty =       0.002657836293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445342960186
                                         uncertainty =       0.002657836293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471848765
  error estimate for blocks of size 2^( 2) =       0.000496728701
  error estimate for blocks of size 2^( 3) =       0.000519598447
  error estimate for blocks of size 2^( 4) =       0.000535999994
  error estimate for blocks of size 2^( 5) =       0.000547039177
  error estimate for blocks of size 2^( 6) =       0.000551825609
  error estimate for blocks of size 2^( 7) =       0.000557141077

      target function =      -0.749240197931
              le_mean =     -22.814920110287
             les_mean =     520.965861930738
             stat err =       0.000548001464
             autocorr =       1.348831786486
   target nu stat err =       0.000548001464
   target dn stat err =       0.002913837360
      target stat err =       0.002555563476
              std dev =       0.667294923268
             le_variance =       0.445282514620


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281492011029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+40, overlap shift 1.5625e+41 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749247829772       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749247829772       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749247829772       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749247829771       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+40 is 1.027518e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+40, overlap shift 6.2500e+41 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749247829772       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749247829772       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749247829772       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749247829771       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+40 is 2.568794e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+41, overlap shift 2.5000e+42 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749247829772       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749247829772       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749247829772       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749267578125       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+41 is 5.531668e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.384007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8494e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7736
    reference variance = 0.261135
====================================================
  Execution time = 4.3727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4374e-01
  Total weights = 2.0000e+06
  Execution time = 3.5685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443754905433
                                         uncertainty =       0.002507303161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443754905433
                                         uncertainty =       0.002507303161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471031876
  error estimate for blocks of size 2^( 2) =       0.000496312254
  error estimate for blocks of size 2^( 3) =       0.000519788926
  error estimate for blocks of size 2^( 4) =       0.000537829717
  error estimate for blocks of size 2^( 5) =       0.000549145617
  error estimate for blocks of size 2^( 6) =       0.000555534069
  error estimate for blocks of size 2^( 7) =       0.000562946972

      target function =      -0.750547825542
              le_mean =     -22.815560333119
             les_mean =     520.993535149440
             stat err =       0.000551364094
             autocorr =       1.370176023862
   target nu stat err =       0.000551364094
   target dn stat err =       0.002485167914
      target stat err =       0.002214289697
              std dev =       0.666139667865
             le_variance =       0.443742057103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443754905433
                                         uncertainty =       0.002507303161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443754905433
                                         uncertainty =       0.002507303161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471031876
  error estimate for blocks of size 2^( 2) =       0.000496312254
  error estimate for blocks of size 2^( 3) =       0.000519788926
  error estimate for blocks of size 2^( 4) =       0.000537829717
  error estimate for blocks of size 2^( 5) =       0.000549145617
  error estimate for blocks of size 2^( 6) =       0.000555534069
  error estimate for blocks of size 2^( 7) =       0.000562946972

      target function =      -0.750547825542
              le_mean =     -22.815560333119
             les_mean =     520.993535149440
             stat err =       0.000551364094
             autocorr =       1.370176023862
   target nu stat err =       0.000551364094
   target dn stat err =       0.002485167914
      target stat err =       0.002214289697
              std dev =       0.666139667865
             le_variance =       0.443742057103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443754905433
                                         uncertainty =       0.002507303161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443754905433
                                         uncertainty =       0.002507303161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471031876
  error estimate for blocks of size 2^( 2) =       0.000496312254
  error estimate for blocks of size 2^( 3) =       0.000519788926
  error estimate for blocks of size 2^( 4) =       0.000537829717
  error estimate for blocks of size 2^( 5) =       0.000549145617
  error estimate for blocks of size 2^( 6) =       0.000555534069
  error estimate for blocks of size 2^( 7) =       0.000562946972

      target function =      -0.750547825542
              le_mean =     -22.815560333119
             les_mean =     520.993535149440
             stat err =       0.000551364094
             autocorr =       1.370176023862
   target nu stat err =       0.000551364094
   target dn stat err =       0.002485167914
      target stat err =       0.002214289697
              std dev =       0.666139667865
             le_variance =       0.443742057103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443754905433
                                         uncertainty =       0.002507303161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443754905433
                                         uncertainty =       0.002507303161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471031876
  error estimate for blocks of size 2^( 2) =       0.000496312254
  error estimate for blocks of size 2^( 3) =       0.000519788926
  error estimate for blocks of size 2^( 4) =       0.000537829717
  error estimate for blocks of size 2^( 5) =       0.000549145617
  error estimate for blocks of size 2^( 6) =       0.000555534069
  error estimate for blocks of size 2^( 7) =       0.000562946972

      target function =      -0.750547825542
              le_mean =     -22.815560333119
             les_mean =     520.993535149440
             stat err =       0.000551364094
             autocorr =       1.370176023862
   target nu stat err =       0.000551364094
   target dn stat err =       0.002485167914
      target stat err =       0.002214289697
              std dev =       0.666139667865
             le_variance =       0.443742057103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750547825542        initial  <--
     1.5625e+40     1.5625e+41             1.0275e-44        -0.750547825542
     6.2500e+40     6.2500e+41             2.5688e-45        -0.750547825542
     2.5000e+41     2.5000e+42             5.5317e-46        -0.750547825542

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.5630
  </log>
  <optVariables href="FORM.s044.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2006e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8221
    reference variance = 0.522249
====================================================
  Execution time = 4.5840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4939e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4700e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449472840790
                                         uncertainty =       0.003367727510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449472840790
                                         uncertainty =       0.003367727510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474020346
  error estimate for blocks of size 2^( 2) =       0.000499182405
  error estimate for blocks of size 2^( 3) =       0.000523410120
  error estimate for blocks of size 2^( 4) =       0.000539741819
  error estimate for blocks of size 2^( 5) =       0.000550543751
  error estimate for blocks of size 2^( 6) =       0.000556357418
  error estimate for blocks of size 2^( 7) =       0.000560197831

      target function =      -0.745759572597
              le_mean =     -22.814884520076
             les_mean =     520.968346017411
             stat err =       0.000551710205
             autocorr =       1.354653012319
   target nu stat err =       0.000551710205
   target dn stat err =       0.003423075535
      target stat err =       0.002951320095
              std dev =       0.670366002787
             le_variance =       0.449390577692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281488452008e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+41, overlap shift 1.5625e+42 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745770104914       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745770104914       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745770104914       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745770104914       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746093750000       residual = 4.67e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+41 is 1.136093e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+41, overlap shift 6.2500e+42 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745770104914       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745770104914       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745770104914       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745770104914       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750000000000       residual = 2.13e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+41 is 2.840232e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+42, overlap shift 2.5000e+43 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745770104914       residual = 4.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745770104914       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745770104914       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745770104914       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745770104913       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745768572552       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+42 is 8.229116e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.386100 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0547e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8573
    reference variance = 0.355401
====================================================
  Execution time = 4.5020e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4716e-01
  Total weights = 2.0000e+06
  Execution time = 3.5700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447194133780
                                         uncertainty =       0.003559673788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447194133780
                                         uncertainty =       0.003559673788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472845046
  error estimate for blocks of size 2^( 2) =       0.000497981654
  error estimate for blocks of size 2^( 3) =       0.000521690472
  error estimate for blocks of size 2^( 4) =       0.000539296090
  error estimate for blocks of size 2^( 5) =       0.000550910196
  error estimate for blocks of size 2^( 6) =       0.000559167672
  error estimate for blocks of size 2^( 7) =       0.000563760764

      target function =      -0.747641454332
              le_mean =     -22.814692109121
             les_mean =     520.957340685871
             stat err =       0.000553283681
             autocorr =       1.369172079815
   target nu stat err =       0.000553283681
   target dn stat err =       0.003603180569
      target stat err =       0.003114643285
              std dev =       0.668703877259
             le_variance =       0.447164875461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447194133780
                                         uncertainty =       0.003559673788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447194133780
                                         uncertainty =       0.003559673788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472845046
  error estimate for blocks of size 2^( 2) =       0.000497981654
  error estimate for blocks of size 2^( 3) =       0.000521690472
  error estimate for blocks of size 2^( 4) =       0.000539296090
  error estimate for blocks of size 2^( 5) =       0.000550910196
  error estimate for blocks of size 2^( 6) =       0.000559167672
  error estimate for blocks of size 2^( 7) =       0.000563760764

      target function =      -0.747641454332
              le_mean =     -22.814692109121
             les_mean =     520.957340685871
             stat err =       0.000553283681
             autocorr =       1.369172079815
   target nu stat err =       0.000553283681
   target dn stat err =       0.003603180569
      target stat err =       0.003114643285
              std dev =       0.668703877259
             le_variance =       0.447164875461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447194133780
                                         uncertainty =       0.003559673788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447194133780
                                         uncertainty =       0.003559673788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472845046
  error estimate for blocks of size 2^( 2) =       0.000497981654
  error estimate for blocks of size 2^( 3) =       0.000521690472
  error estimate for blocks of size 2^( 4) =       0.000539296090
  error estimate for blocks of size 2^( 5) =       0.000550910196
  error estimate for blocks of size 2^( 6) =       0.000559167672
  error estimate for blocks of size 2^( 7) =       0.000563760764

      target function =      -0.747641454332
              le_mean =     -22.814692109121
             les_mean =     520.957340685871
             stat err =       0.000553283681
             autocorr =       1.369172079815
   target nu stat err =       0.000553283681
   target dn stat err =       0.003603180569
      target stat err =       0.003114643285
              std dev =       0.668703877259
             le_variance =       0.447164875461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447194133780
                                         uncertainty =       0.003559673788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447194133780
                                         uncertainty =       0.003559673788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472845046
  error estimate for blocks of size 2^( 2) =       0.000497981654
  error estimate for blocks of size 2^( 3) =       0.000521690472
  error estimate for blocks of size 2^( 4) =       0.000539296090
  error estimate for blocks of size 2^( 5) =       0.000550910196
  error estimate for blocks of size 2^( 6) =       0.000559167672
  error estimate for blocks of size 2^( 7) =       0.000563760764

      target function =      -0.747641454332
              le_mean =     -22.814692109121
             les_mean =     520.957340685871
             stat err =       0.000553283681
             autocorr =       1.369172079815
   target nu stat err =       0.000553283681
   target dn stat err =       0.003603180569
      target stat err =       0.003114643285
              std dev =       0.668703877259
             le_variance =       0.447164875461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747641454332        initial  <--
     1.5625e+41     1.5625e+42             1.1361e-45        -0.747641454332
     6.2500e+41     6.2500e+42             2.8402e-46        -0.747641454332
     2.5000e+42     2.5000e+43             8.2291e-47        -0.747641454332

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8708
  </log>
  <optVariables href="FORM.s045.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2347e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7874
    reference variance = 0.322778
====================================================
  Execution time = 4.4058e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4939e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5146e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449476207221
                                         uncertainty =       0.003182058689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449476207221
                                         uncertainty =       0.003182058689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474017875
  error estimate for blocks of size 2^( 2) =       0.000498920895
  error estimate for blocks of size 2^( 3) =       0.000522278603
  error estimate for blocks of size 2^( 4) =       0.000539517936
  error estimate for blocks of size 2^( 5) =       0.000549258773
  error estimate for blocks of size 2^( 6) =       0.000554986268
  error estimate for blocks of size 2^( 7) =       0.000558081910

      target function =      -0.745777462313
              le_mean =     -22.814155255544
             les_mean =     520.935065691711
             stat err =       0.000550461222
             autocorr =       1.348540582397
   target nu stat err =       0.000550461222
   target dn stat err =       0.003179470478
      target stat err =       0.002747769240
              std dev =       0.670362508167
             le_variance =       0.449385892356


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281415525554e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+42, overlap shift 1.5625e+43 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745786480940       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745786480940       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+42, overlap shift 6.2500e+43 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745786480940       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745786480940       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+43, overlap shift 2.5000e+44 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745786480940       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745786480940       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.387257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9212e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8671
    reference variance = 0.639351
====================================================
  Execution time = 4.3890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5048e-01
  Total weights = 2.0000e+06
  Execution time = 3.5654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450463958266
                                         uncertainty =       0.004416004279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450463958266
                                         uncertainty =       0.004416004279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474592860
  error estimate for blocks of size 2^( 2) =       0.000499819589
  error estimate for blocks of size 2^( 3) =       0.000522791451
  error estimate for blocks of size 2^( 4) =       0.000539989981
  error estimate for blocks of size 2^( 5) =       0.000549585531
  error estimate for blocks of size 2^( 6) =       0.000556429786
  error estimate for blocks of size 2^( 7) =       0.000561020826

      target function =      -0.744826879013
              le_mean =     -22.815365042570
             les_mean =     520.991358565345
             stat err =       0.000551756531
             autocorr =       1.351613638940
   target nu stat err =       0.000551756531
   target dn stat err =       0.004629946764
      target stat err =       0.003944451374
              std dev =       0.671175658724
             le_variance =       0.450476764864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450463958266
                                         uncertainty =       0.004416004279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450463958266
                                         uncertainty =       0.004416004279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474592860
  error estimate for blocks of size 2^( 2) =       0.000499819589
  error estimate for blocks of size 2^( 3) =       0.000522791451
  error estimate for blocks of size 2^( 4) =       0.000539989981
  error estimate for blocks of size 2^( 5) =       0.000549585531
  error estimate for blocks of size 2^( 6) =       0.000556429786
  error estimate for blocks of size 2^( 7) =       0.000561020826

      target function =      -0.744826879013
              le_mean =     -22.815365042570
             les_mean =     520.991358565345
             stat err =       0.000551756531
             autocorr =       1.351613638940
   target nu stat err =       0.000551756531
   target dn stat err =       0.004629946764
      target stat err =       0.003944451374
              std dev =       0.671175658724
             le_variance =       0.450476764864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450463958266
                                         uncertainty =       0.004416004279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450463958266
                                         uncertainty =       0.004416004279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474592860
  error estimate for blocks of size 2^( 2) =       0.000499819589
  error estimate for blocks of size 2^( 3) =       0.000522791451
  error estimate for blocks of size 2^( 4) =       0.000539989981
  error estimate for blocks of size 2^( 5) =       0.000549585531
  error estimate for blocks of size 2^( 6) =       0.000556429786
  error estimate for blocks of size 2^( 7) =       0.000561020826

      target function =      -0.744826879013
              le_mean =     -22.815365042570
             les_mean =     520.991358565345
             stat err =       0.000551756531
             autocorr =       1.351613638940
   target nu stat err =       0.000551756531
   target dn stat err =       0.004629946764
      target stat err =       0.003944451374
              std dev =       0.671175658724
             le_variance =       0.450476764864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450463958266
                                         uncertainty =       0.004416004279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450463958266
                                         uncertainty =       0.004416004279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474592860
  error estimate for blocks of size 2^( 2) =       0.000499819589
  error estimate for blocks of size 2^( 3) =       0.000522791451
  error estimate for blocks of size 2^( 4) =       0.000539989981
  error estimate for blocks of size 2^( 5) =       0.000549585531
  error estimate for blocks of size 2^( 6) =       0.000556429786
  error estimate for blocks of size 2^( 7) =       0.000561020826

      target function =      -0.744826879013
              le_mean =     -22.815365042570
             les_mean =     520.991358565345
             stat err =       0.000551756531
             autocorr =       1.351613638940
   target nu stat err =       0.000551756531
   target dn stat err =       0.004629946764
      target stat err =       0.003944451374
              std dev =       0.671175658724
             le_variance =       0.450476764864


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744826879013        initial  <--
     1.5625e+42     1.5625e+43             0.0000e+00        -0.744826879013
     6.2500e+42     6.2500e+43             0.0000e+00        -0.744826879013
     2.5000e+43     2.5000e+44             0.0000e+00        -0.744826879013

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.7200
  </log>
  <optVariables href="FORM.s046.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2094e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.771
    reference variance = 0.384373
====================================================
  Execution time = 4.4258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4679e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4546e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446763351602
                                         uncertainty =       0.002833218661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446763351602
                                         uncertainty =       0.002833218661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472644481
  error estimate for blocks of size 2^( 2) =       0.000498163562
  error estimate for blocks of size 2^( 3) =       0.000521700556
  error estimate for blocks of size 2^( 4) =       0.000539547576
  error estimate for blocks of size 2^( 5) =       0.000550504113
  error estimate for blocks of size 2^( 6) =       0.000558077590
  error estimate for blocks of size 2^( 7) =       0.000561870273

      target function =      -0.747963587939
              le_mean =     -22.814881484371
             les_mean =     520.965602533389
             stat err =       0.000552499888
             autocorr =       1.366454598294
   target nu stat err =       0.000552499888
   target dn stat err =       0.003023772224
      target stat err =       0.002638656124
              std dev =       0.668420235260
             le_variance =       0.446785610905


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281488148437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+43, overlap shift 1.5625e+44 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747971937988       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747971937988       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747970581055       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+43 is 5.446059e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+43, overlap shift 6.2500e+44 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747971937988       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747971937988       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+43 is 1.361515e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+44, overlap shift 2.5000e+45 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747971937988       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747971937988       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747970581055       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+44 is 3.403787e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.388662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8811e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.8738
    reference variance = 0.308374
====================================================
  Execution time = 4.5489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4723e-01
  Total weights = 2.0000e+06
  Execution time = 3.5445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447280402139
                                         uncertainty =       0.002805684240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447280402139
                                         uncertainty =       0.002805684240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472880603
  error estimate for blocks of size 2^( 2) =       0.000497654036
  error estimate for blocks of size 2^( 3) =       0.000521272938
  error estimate for blocks of size 2^( 4) =       0.000538468219
  error estimate for blocks of size 2^( 5) =       0.000549449700
  error estimate for blocks of size 2^( 6) =       0.000555177935
  error estimate for blocks of size 2^( 7) =       0.000559869375

      target function =      -0.747589779440
              le_mean =     -22.814610953921
             les_mean =     520.953704884335
             stat err =       0.000550741307
             autocorr =       1.356414120689
   target nu stat err =       0.000550741307
   target dn stat err =       0.002947361616
      target stat err =       0.002571740682
              std dev =       0.668754162003
             le_variance =       0.447232129196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447280402139
                                         uncertainty =       0.002805684240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447280402139
                                         uncertainty =       0.002805684240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472880603
  error estimate for blocks of size 2^( 2) =       0.000497654036
  error estimate for blocks of size 2^( 3) =       0.000521272938
  error estimate for blocks of size 2^( 4) =       0.000538468219
  error estimate for blocks of size 2^( 5) =       0.000549449700
  error estimate for blocks of size 2^( 6) =       0.000555177935
  error estimate for blocks of size 2^( 7) =       0.000559869375

      target function =      -0.747589779440
              le_mean =     -22.814610953921
             les_mean =     520.953704884335
             stat err =       0.000550741307
             autocorr =       1.356414120687
   target nu stat err =       0.000550741307
   target dn stat err =       0.002947361616
      target stat err =       0.002571740682
              std dev =       0.668754162003
             le_variance =       0.447232129196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447280402139
                                         uncertainty =       0.002805684240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447280402139
                                         uncertainty =       0.002805684240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472880603
  error estimate for blocks of size 2^( 2) =       0.000497654036
  error estimate for blocks of size 2^( 3) =       0.000521272938
  error estimate for blocks of size 2^( 4) =       0.000538468219
  error estimate for blocks of size 2^( 5) =       0.000549449700
  error estimate for blocks of size 2^( 6) =       0.000555177935
  error estimate for blocks of size 2^( 7) =       0.000559869375

      target function =      -0.747589779440
              le_mean =     -22.814610953921
             les_mean =     520.953704884335
             stat err =       0.000550741307
             autocorr =       1.356414120687
   target nu stat err =       0.000550741307
   target dn stat err =       0.002947361616
      target stat err =       0.002571740682
              std dev =       0.668754162003
             le_variance =       0.447232129196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447280402139
                                         uncertainty =       0.002805684240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447280402139
                                         uncertainty =       0.002805684240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472880603
  error estimate for blocks of size 2^( 2) =       0.000497654036
  error estimate for blocks of size 2^( 3) =       0.000521272938
  error estimate for blocks of size 2^( 4) =       0.000538468219
  error estimate for blocks of size 2^( 5) =       0.000549449700
  error estimate for blocks of size 2^( 6) =       0.000555177935
  error estimate for blocks of size 2^( 7) =       0.000559869375

      target function =      -0.747589779440
              le_mean =     -22.814610953921
             les_mean =     520.953704884335
             stat err =       0.000550741307
             autocorr =       1.356414120687
   target nu stat err =       0.000550741307
   target dn stat err =       0.002947361616
      target stat err =       0.002571740682
              std dev =       0.668754162003
             le_variance =       0.447232129196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747589779440        initial  <--
     1.5625e+43     1.5625e+44             5.4461e-48        -0.747589779440
     6.2500e+43     6.2500e+44             1.3615e-48        -0.747589779440
     2.5000e+44     2.5000e+45             3.4038e-49        -0.747589779440

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.2099
  </log>
  <optVariables href="FORM.s047.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2203e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7028
    reference variance = 0.291056
====================================================
  Execution time = 4.5429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4532e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4704e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445327075921
                                         uncertainty =       0.002758953209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445327075921
                                         uncertainty =       0.002758953209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471870575
  error estimate for blocks of size 2^( 2) =       0.000496784144
  error estimate for blocks of size 2^( 3) =       0.000519375056
  error estimate for blocks of size 2^( 4) =       0.000536849520
  error estimate for blocks of size 2^( 5) =       0.000546821609
  error estimate for blocks of size 2^( 6) =       0.000553931224
  error estimate for blocks of size 2^( 7) =       0.000557975383

      target function =      -0.749204273810
              le_mean =     -22.814976255721
             les_mean =     520.968465005738
             stat err =       0.000548894434
             autocorr =       1.353106127692
   target nu stat err =       0.000548894434
   target dn stat err =       0.002948067183
      target stat err =       0.002584039074
              std dev =       0.667325766995
             le_variance =       0.445323679295


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281497625572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+44, overlap shift 1.5625e+45 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749212100347       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749212100347       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749212100347       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749023437500       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+44 is 1.004525e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+44, overlap shift 6.2500e+45 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749212100347       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749212100347       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749212100347       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750000000000       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+44 is 2.511312e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+45, overlap shift 2.5000e+46 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749212100347       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749212100347       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749212100347       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+45 is 3.789253e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.390243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0140e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8478
    reference variance = 0.385821
====================================================
  Execution time = 4.3564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5169e-01
  Total weights = 2.0000e+06
  Execution time = 3.5395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451710080761
                                         uncertainty =       0.006417707877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451710080761
                                         uncertainty =       0.006417707877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475232148
  error estimate for blocks of size 2^( 2) =       0.000499906708
  error estimate for blocks of size 2^( 3) =       0.000523294886
  error estimate for blocks of size 2^( 4) =       0.000539117149
  error estimate for blocks of size 2^( 5) =       0.000549885502
  error estimate for blocks of size 2^( 6) =       0.000554585292
  error estimate for blocks of size 2^( 7) =       0.000557072378

      target function =      -0.743781040044
              le_mean =     -22.815687934037
             les_mean =     521.007306866602
             stat err =       0.000550165080
             autocorr =       1.340214831652
   target nu stat err =       0.000550165080
   target dn stat err =       0.006355518440
      target stat err =       0.005370285547
              std dev =       0.672079749042
             le_variance =       0.451691189072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451710080761
                                         uncertainty =       0.006417707877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451710080761
                                         uncertainty =       0.006417707877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475232148
  error estimate for blocks of size 2^( 2) =       0.000499906708
  error estimate for blocks of size 2^( 3) =       0.000523294886
  error estimate for blocks of size 2^( 4) =       0.000539117149
  error estimate for blocks of size 2^( 5) =       0.000549885502
  error estimate for blocks of size 2^( 6) =       0.000554585292
  error estimate for blocks of size 2^( 7) =       0.000557072378

      target function =      -0.743781040044
              le_mean =     -22.815687934037
             les_mean =     521.007306866602
             stat err =       0.000550165080
             autocorr =       1.340214831652
   target nu stat err =       0.000550165080
   target dn stat err =       0.006355518440
      target stat err =       0.005370285547
              std dev =       0.672079749042
             le_variance =       0.451691189072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451710080761
                                         uncertainty =       0.006417707877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451710080761
                                         uncertainty =       0.006417707877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475232148
  error estimate for blocks of size 2^( 2) =       0.000499906708
  error estimate for blocks of size 2^( 3) =       0.000523294886
  error estimate for blocks of size 2^( 4) =       0.000539117149
  error estimate for blocks of size 2^( 5) =       0.000549885502
  error estimate for blocks of size 2^( 6) =       0.000554585292
  error estimate for blocks of size 2^( 7) =       0.000557072378

      target function =      -0.743781040044
              le_mean =     -22.815687934037
             les_mean =     521.007306866602
             stat err =       0.000550165080
             autocorr =       1.340214831652
   target nu stat err =       0.000550165080
   target dn stat err =       0.006355518440
      target stat err =       0.005370285547
              std dev =       0.672079749042
             le_variance =       0.451691189072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451710080761
                                         uncertainty =       0.006417707877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451710080761
                                         uncertainty =       0.006417707877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475232148
  error estimate for blocks of size 2^( 2) =       0.000499906708
  error estimate for blocks of size 2^( 3) =       0.000523294886
  error estimate for blocks of size 2^( 4) =       0.000539117149
  error estimate for blocks of size 2^( 5) =       0.000549885502
  error estimate for blocks of size 2^( 6) =       0.000554585292
  error estimate for blocks of size 2^( 7) =       0.000557072378

      target function =      -0.743781040044
              le_mean =     -22.815687934037
             les_mean =     521.007306866602
             stat err =       0.000550165080
             autocorr =       1.340214831652
   target nu stat err =       0.000550165080
   target dn stat err =       0.006355518440
      target stat err =       0.005370285547
              std dev =       0.672079749042
             le_variance =       0.451691189072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743781040044        initial  <--
     1.5625e+44     1.5625e+45             1.0045e-48        -0.743781040044
     6.2500e+44     6.2500e+45             2.5113e-49        -0.743781040044
     2.5000e+45     2.5000e+46             3.7893e-50        -0.743781040044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2528
  </log>
  <optVariables href="FORM.s048.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2140e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8155
    reference variance = 0.632887
====================================================
  Execution time = 4.3776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4805e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4625e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448079580162
                                         uncertainty =       0.002687271950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448079580162
                                         uncertainty =       0.002687271950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473310351
  error estimate for blocks of size 2^( 2) =       0.000498397931
  error estimate for blocks of size 2^( 3) =       0.000521427380
  error estimate for blocks of size 2^( 4) =       0.000538557423
  error estimate for blocks of size 2^( 5) =       0.000549021652
  error estimate for blocks of size 2^( 6) =       0.000555663252
  error estimate for blocks of size 2^( 7) =       0.000555167851

      target function =      -0.746889949873
              le_mean =     -22.815395446260
             les_mean =     520.990314521790
             stat err =       0.000549602544
             autocorr =       1.348358772054
   target nu stat err =       0.000549602544
   target dn stat err =       0.002813695941
      target stat err =       0.002460255732
              std dev =       0.669361917477
             le_variance =       0.448045376569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281539544626e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+45, overlap shift 1.5625e+46 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746897077192       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746897077192       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746897077192       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746897077192       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+45 is 9.689781e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+45, overlap shift 6.2500e+46 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746897077192       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746897077192       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746897077192       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750000000000       residual = 9.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.99e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+45 is 2.422445e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+46, overlap shift 2.5000e+47 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746897077192       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746897077192       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746897077192       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746897077192       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+46 is 6.056113e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.392017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8409e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8577
    reference variance = 0.333346
====================================================
  Execution time = 4.3315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4604e-01
  Total weights = 2.0000e+06
  Execution time = 3.5590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446078830109
                                         uncertainty =       0.002252845229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446078830109
                                         uncertainty =       0.002252845229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472247784
  error estimate for blocks of size 2^( 2) =       0.000497340631
  error estimate for blocks of size 2^( 3) =       0.000520558685
  error estimate for blocks of size 2^( 4) =       0.000537021963
  error estimate for blocks of size 2^( 5) =       0.000548328233
  error estimate for blocks of size 2^( 6) =       0.000555241328
  error estimate for blocks of size 2^( 7) =       0.000558275374

      target function =      -0.748602143486
              le_mean =     -22.814826270915
             les_mean =     520.962333487680
             stat err =       0.000549716725
             autocorr =       1.354996094768
   target nu stat err =       0.000549716725
   target dn stat err =       0.002713611435
      target stat err =       0.002386957347
              std dev =       0.667859220694
             le_variance =       0.446035938666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446078830109
                                         uncertainty =       0.002252845229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446078830109
                                         uncertainty =       0.002252845229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472247784
  error estimate for blocks of size 2^( 2) =       0.000497340631
  error estimate for blocks of size 2^( 3) =       0.000520558685
  error estimate for blocks of size 2^( 4) =       0.000537021963
  error estimate for blocks of size 2^( 5) =       0.000548328233
  error estimate for blocks of size 2^( 6) =       0.000555241328
  error estimate for blocks of size 2^( 7) =       0.000558275374

      target function =      -0.748602143486
              le_mean =     -22.814826270915
             les_mean =     520.962333487680
             stat err =       0.000549716725
             autocorr =       1.354996094765
   target nu stat err =       0.000549716725
   target dn stat err =       0.002713611435
      target stat err =       0.002386957347
              std dev =       0.667859220694
             le_variance =       0.446035938666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446078830109
                                         uncertainty =       0.002252845229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446078830109
                                         uncertainty =       0.002252845229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472247784
  error estimate for blocks of size 2^( 2) =       0.000497340631
  error estimate for blocks of size 2^( 3) =       0.000520558685
  error estimate for blocks of size 2^( 4) =       0.000537021963
  error estimate for blocks of size 2^( 5) =       0.000548328233
  error estimate for blocks of size 2^( 6) =       0.000555241328
  error estimate for blocks of size 2^( 7) =       0.000558275374

      target function =      -0.748602143486
              le_mean =     -22.814826270915
             les_mean =     520.962333487680
             stat err =       0.000549716725
             autocorr =       1.354996094765
   target nu stat err =       0.000549716725
   target dn stat err =       0.002713611435
      target stat err =       0.002386957347
              std dev =       0.667859220694
             le_variance =       0.446035938666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446078830109
                                         uncertainty =       0.002252845229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446078830109
                                         uncertainty =       0.002252845229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472247784
  error estimate for blocks of size 2^( 2) =       0.000497340631
  error estimate for blocks of size 2^( 3) =       0.000520558685
  error estimate for blocks of size 2^( 4) =       0.000537021963
  error estimate for blocks of size 2^( 5) =       0.000548328233
  error estimate for blocks of size 2^( 6) =       0.000555241328
  error estimate for blocks of size 2^( 7) =       0.000558275374

      target function =      -0.748602143486
              le_mean =     -22.814826270915
             les_mean =     520.962333487680
             stat err =       0.000549716725
             autocorr =       1.354996094765
   target nu stat err =       0.000549716725
   target dn stat err =       0.002713611435
      target stat err =       0.002386957347
              std dev =       0.667859220694
             le_variance =       0.446035938666


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748602143486        initial  <--
     1.5625e+45     1.5625e+46             9.6898e-50        -0.748602143486
     6.2500e+45     6.2500e+46             2.4224e-50        -0.748602143486
     2.5000e+46     2.5000e+47             6.0561e-51        -0.748602143486

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1086
  </log>
  <optVariables href="FORM.s049.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1953e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.7591
    reference variance = 0.398683
====================================================
  Execution time = 4.5273e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4256e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4788e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442431806117
                                         uncertainty =       0.002244097179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442431806117
                                         uncertainty =       0.002244097179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470401558
  error estimate for blocks of size 2^( 2) =       0.000495386173
  error estimate for blocks of size 2^( 3) =       0.000519202580
  error estimate for blocks of size 2^( 4) =       0.000535646595
  error estimate for blocks of size 2^( 5) =       0.000546247605
  error estimate for blocks of size 2^( 6) =       0.000552878864
  error estimate for blocks of size 2^( 7) =       0.000555844707

      target function =      -0.751572785647
              le_mean =     -22.814549309749
             les_mean =     520.946215236900
             stat err =       0.000547654443
             autocorr =       1.355425737938
   target nu stat err =       0.000547654443
   target dn stat err =       0.002476710526
      target stat err =       0.002208565345
              std dev =       0.665248262833
             le_variance =       0.442555251203


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281454930975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+46, overlap shift 1.5625e+47 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751578293304       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751578293304       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+46, overlap shift 6.2500e+47 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751578293304       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751578293304       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+47, overlap shift 2.5000e+48 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751578293304       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751578293304       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.393147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0067e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8408
    reference variance = 0.606186
====================================================
  Execution time = 4.4988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4456e-01
  Total weights = 2.0000e+06
  Execution time = 3.5675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530235247
                                         uncertainty =       0.002509999092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530235247
                                         uncertainty =       0.002509999092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471466144
  error estimate for blocks of size 2^( 2) =       0.000496569199
  error estimate for blocks of size 2^( 3) =       0.000519701566
  error estimate for blocks of size 2^( 4) =       0.000536473856
  error estimate for blocks of size 2^( 5) =       0.000546928893
  error estimate for blocks of size 2^( 6) =       0.000552094646
  error estimate for blocks of size 2^( 7) =       0.000557683380

      target function =      -0.749867124658
              le_mean =     -22.813810416279
             les_mean =     520.914506137430
             stat err =       0.000548295194
             autocorr =       1.352470667557
   target nu stat err =       0.000548295194
   target dn stat err =       0.002843770734
      target stat err =       0.002497730139
              std dev =       0.666753814971
             le_variance =       0.444560649778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530235247
                                         uncertainty =       0.002509999092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530235247
                                         uncertainty =       0.002509999092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471466144
  error estimate for blocks of size 2^( 2) =       0.000496569199
  error estimate for blocks of size 2^( 3) =       0.000519701566
  error estimate for blocks of size 2^( 4) =       0.000536473856
  error estimate for blocks of size 2^( 5) =       0.000546928893
  error estimate for blocks of size 2^( 6) =       0.000552094646
  error estimate for blocks of size 2^( 7) =       0.000557683380

      target function =      -0.749867124658
              le_mean =     -22.813810416279
             les_mean =     520.914506137430
             stat err =       0.000548295194
             autocorr =       1.352470667553
   target nu stat err =       0.000548295194
   target dn stat err =       0.002843770734
      target stat err =       0.002497730139
              std dev =       0.666753814971
             le_variance =       0.444560649778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530235247
                                         uncertainty =       0.002509999092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530235247
                                         uncertainty =       0.002509999092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471466144
  error estimate for blocks of size 2^( 2) =       0.000496569199
  error estimate for blocks of size 2^( 3) =       0.000519701566
  error estimate for blocks of size 2^( 4) =       0.000536473856
  error estimate for blocks of size 2^( 5) =       0.000546928893
  error estimate for blocks of size 2^( 6) =       0.000552094646
  error estimate for blocks of size 2^( 7) =       0.000557683380

      target function =      -0.749867124658
              le_mean =     -22.813810416279
             les_mean =     520.914506137430
             stat err =       0.000548295194
             autocorr =       1.352470667553
   target nu stat err =       0.000548295194
   target dn stat err =       0.002843770734
      target stat err =       0.002497730139
              std dev =       0.666753814971
             le_variance =       0.444560649778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530235247
                                         uncertainty =       0.002509999092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444530235247
                                         uncertainty =       0.002509999092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471466144
  error estimate for blocks of size 2^( 2) =       0.000496569199
  error estimate for blocks of size 2^( 3) =       0.000519701566
  error estimate for blocks of size 2^( 4) =       0.000536473856
  error estimate for blocks of size 2^( 5) =       0.000546928893
  error estimate for blocks of size 2^( 6) =       0.000552094646
  error estimate for blocks of size 2^( 7) =       0.000557683380

      target function =      -0.749867124658
              le_mean =     -22.813810416279
             les_mean =     520.914506137430
             stat err =       0.000548295194
             autocorr =       1.352470667553
   target nu stat err =       0.000548295194
   target dn stat err =       0.002843770734
      target stat err =       0.002497730139
              std dev =       0.666753814971
             le_variance =       0.444560649778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749867124658        initial  <--
     1.5625e+46     1.5625e+47             0.0000e+00        -0.749867124658
     6.2500e+46     6.2500e+47             0.0000e+00        -0.749867124658
     2.5000e+47     2.5000e+48             0.0000e+00        -0.749867124658

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8248
  </log>
  <optVariables href="FORM.s050.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2290e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.9234
    reference variance = 0.467509
====================================================
  Execution time = 4.3693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4526e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4687e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445291352729
                                         uncertainty =       0.002638555585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445291352729
                                         uncertainty =       0.002638555585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471836601
  error estimate for blocks of size 2^( 2) =       0.000496710023
  error estimate for blocks of size 2^( 3) =       0.000519795453
  error estimate for blocks of size 2^( 4) =       0.000536966296
  error estimate for blocks of size 2^( 5) =       0.000548317011
  error estimate for blocks of size 2^( 6) =       0.000554242768
  error estimate for blocks of size 2^( 7) =       0.000557892546

      target function =      -0.749272353858
              le_mean =     -22.813875112737
             les_mean =     520.918156993500
             stat err =       0.000549354655
             autocorr =       1.355571297327
   target nu stat err =       0.000549354655
   target dn stat err =       0.002857470308
      target stat err =       0.002505705419
              std dev =       0.667277720722
             le_variance =       0.445259556572


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281387511274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+47, overlap shift 1.5625e+48 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749279561397       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749279561397       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+47 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+47, overlap shift 6.2500e+48 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749279561397       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749279561397       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+48, overlap shift 2.5000e+49 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749279561397       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749279561397       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+48 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.394257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8387e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.76
    reference variance = 0.390263
====================================================
  Execution time = 4.3065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4729e-01
  Total weights = 2.0000e+06
  Execution time = 3.5499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447310559318
                                         uncertainty =       0.002991110592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447310559318
                                         uncertainty =       0.002991110592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472911361
  error estimate for blocks of size 2^( 2) =       0.000497977972
  error estimate for blocks of size 2^( 3) =       0.000520973273
  error estimate for blocks of size 2^( 4) =       0.000538263791
  error estimate for blocks of size 2^( 5) =       0.000548719032
  error estimate for blocks of size 2^( 6) =       0.000554806095
  error estimate for blocks of size 2^( 7) =       0.000556806654

      target function =      -0.747545506897
              le_mean =     -22.814228646863
             les_mean =     520.936318838588
             stat err =       0.000549648893
             autocorr =       1.350862732608
   target nu stat err =       0.000549648893
   target dn stat err =       0.003026718174
      target stat err =       0.002634842686
              std dev =       0.668797660657
             le_variance =       0.447290310900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447310559318
                                         uncertainty =       0.002991110592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447310559318
                                         uncertainty =       0.002991110592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472911361
  error estimate for blocks of size 2^( 2) =       0.000497977972
  error estimate for blocks of size 2^( 3) =       0.000520973273
  error estimate for blocks of size 2^( 4) =       0.000538263791
  error estimate for blocks of size 2^( 5) =       0.000548719032
  error estimate for blocks of size 2^( 6) =       0.000554806095
  error estimate for blocks of size 2^( 7) =       0.000556806654

      target function =      -0.747545506897
              le_mean =     -22.814228646863
             les_mean =     520.936318838588
             stat err =       0.000549648893
             autocorr =       1.350862732608
   target nu stat err =       0.000549648893
   target dn stat err =       0.003026718174
      target stat err =       0.002634842686
              std dev =       0.668797660657
             le_variance =       0.447290310900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447310559318
                                         uncertainty =       0.002991110592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447310559318
                                         uncertainty =       0.002991110592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472911361
  error estimate for blocks of size 2^( 2) =       0.000497977972
  error estimate for blocks of size 2^( 3) =       0.000520973273
  error estimate for blocks of size 2^( 4) =       0.000538263791
  error estimate for blocks of size 2^( 5) =       0.000548719032
  error estimate for blocks of size 2^( 6) =       0.000554806095
  error estimate for blocks of size 2^( 7) =       0.000556806654

      target function =      -0.747545506897
              le_mean =     -22.814228646863
             les_mean =     520.936318838588
             stat err =       0.000549648893
             autocorr =       1.350862732608
   target nu stat err =       0.000549648893
   target dn stat err =       0.003026718174
      target stat err =       0.002634842686
              std dev =       0.668797660657
             le_variance =       0.447290310900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447310559318
                                         uncertainty =       0.002991110592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447310559318
                                         uncertainty =       0.002991110592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472911361
  error estimate for blocks of size 2^( 2) =       0.000497977972
  error estimate for blocks of size 2^( 3) =       0.000520973273
  error estimate for blocks of size 2^( 4) =       0.000538263791
  error estimate for blocks of size 2^( 5) =       0.000548719032
  error estimate for blocks of size 2^( 6) =       0.000554806095
  error estimate for blocks of size 2^( 7) =       0.000556806654

      target function =      -0.747545506897
              le_mean =     -22.814228646863
             les_mean =     520.936318838588
             stat err =       0.000549648893
             autocorr =       1.350862732608
   target nu stat err =       0.000549648893
   target dn stat err =       0.003026718174
      target stat err =       0.002634842686
              std dev =       0.668797660657
             le_variance =       0.447290310900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747545506897        initial  <--
     1.5625e+47     1.5625e+48             0.0000e+00        -0.747545506897
     6.2500e+47     6.2500e+48             0.0000e+00        -0.747545506897
     2.5000e+48     2.5000e+49             0.0000e+00        -0.747545506897

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8118
  </log>
  <optVariables href="FORM.s051.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1920e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7665
    reference variance = 0.339488
====================================================
  Execution time = 4.3837e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4549e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4630e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445468656701
                                         uncertainty =       0.003335854460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445468656701
                                         uncertainty =       0.003335854460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471957306
  error estimate for blocks of size 2^( 2) =       0.000497181164
  error estimate for blocks of size 2^( 3) =       0.000520878352
  error estimate for blocks of size 2^( 4) =       0.000538288515
  error estimate for blocks of size 2^( 5) =       0.000548612838
  error estimate for blocks of size 2^( 6) =       0.000554037848
  error estimate for blocks of size 2^( 7) =       0.000558127416

      target function =      -0.749053581959
              le_mean =     -22.815834546575
             les_mean =     521.007793232100
             stat err =       0.000549766654
             autocorr =       1.356910992835
   target nu stat err =       0.000549766654
   target dn stat err =       0.002876108532
      target stat err =       0.002527223982
              std dev =       0.667448423605
             le_variance =       0.445487398173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281583454657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+48, overlap shift 1.5625e+49 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749061086039       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749061086039       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+48, overlap shift 6.2500e+49 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749061086039       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749061086039       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+49, overlap shift 2.5000e+50 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749061086039       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749061086039       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.395373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8473e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7699
    reference variance = 0.310618
====================================================
  Execution time = 4.4761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4832e-01
  Total weights = 2.0000e+06
  Execution time = 3.5609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256289503
                                         uncertainty =       0.003435023673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256289503
                                         uncertainty =       0.003435023673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473456958
  error estimate for blocks of size 2^( 2) =       0.000498728664
  error estimate for blocks of size 2^( 3) =       0.000522399947
  error estimate for blocks of size 2^( 4) =       0.000540162802
  error estimate for blocks of size 2^( 5) =       0.000551515502
  error estimate for blocks of size 2^( 6) =       0.000558913684
  error estimate for blocks of size 2^( 7) =       0.000562907337

      target function =      -0.746653710996
              le_mean =     -22.815175712145
             les_mean =     520.980565534074
             stat err =       0.000553374831
             autocorr =       1.366085238660
   target nu stat err =       0.000553374831
   target dn stat err =       0.003660407814
      target stat err =       0.003156272912
              std dev =       0.669569251214
             le_variance =       0.448322982172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256289503
                                         uncertainty =       0.003435023673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256289503
                                         uncertainty =       0.003435023673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473456958
  error estimate for blocks of size 2^( 2) =       0.000498728664
  error estimate for blocks of size 2^( 3) =       0.000522399947
  error estimate for blocks of size 2^( 4) =       0.000540162802
  error estimate for blocks of size 2^( 5) =       0.000551515502
  error estimate for blocks of size 2^( 6) =       0.000558913684
  error estimate for blocks of size 2^( 7) =       0.000562907337

      target function =      -0.746653710996
              le_mean =     -22.815175712145
             les_mean =     520.980565534074
             stat err =       0.000553374831
             autocorr =       1.366085238660
   target nu stat err =       0.000553374831
   target dn stat err =       0.003660407814
      target stat err =       0.003156272912
              std dev =       0.669569251214
             le_variance =       0.448322982172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256289503
                                         uncertainty =       0.003435023673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256289503
                                         uncertainty =       0.003435023673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473456958
  error estimate for blocks of size 2^( 2) =       0.000498728664
  error estimate for blocks of size 2^( 3) =       0.000522399947
  error estimate for blocks of size 2^( 4) =       0.000540162802
  error estimate for blocks of size 2^( 5) =       0.000551515502
  error estimate for blocks of size 2^( 6) =       0.000558913684
  error estimate for blocks of size 2^( 7) =       0.000562907337

      target function =      -0.746653710996
              le_mean =     -22.815175712145
             les_mean =     520.980565534074
             stat err =       0.000553374831
             autocorr =       1.366085238660
   target nu stat err =       0.000553374831
   target dn stat err =       0.003660407814
      target stat err =       0.003156272912
              std dev =       0.669569251214
             le_variance =       0.448322982172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256289503
                                         uncertainty =       0.003435023673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448256289503
                                         uncertainty =       0.003435023673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473456958
  error estimate for blocks of size 2^( 2) =       0.000498728664
  error estimate for blocks of size 2^( 3) =       0.000522399947
  error estimate for blocks of size 2^( 4) =       0.000540162802
  error estimate for blocks of size 2^( 5) =       0.000551515502
  error estimate for blocks of size 2^( 6) =       0.000558913684
  error estimate for blocks of size 2^( 7) =       0.000562907337

      target function =      -0.746653710996
              le_mean =     -22.815175712145
             les_mean =     520.980565534074
             stat err =       0.000553374831
             autocorr =       1.366085238660
   target nu stat err =       0.000553374831
   target dn stat err =       0.003660407814
      target stat err =       0.003156272912
              std dev =       0.669569251214
             le_variance =       0.448322982172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746653710996        initial  <--
     1.5625e+48     1.5625e+49             0.0000e+00        -0.746653710996
     6.2500e+48     6.2500e+49             0.0000e+00        -0.746653710996
     2.5000e+49     2.5000e+50             0.0000e+00        -0.746653710996

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.5503
  </log>
  <optVariables href="FORM.s052.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2119e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8166
    reference variance = 0.549079
====================================================
  Execution time = 4.5869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5002e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4616e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028099730
                                         uncertainty =       0.003437172698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450028099730
                                         uncertainty =       0.003437172698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474353628
  error estimate for blocks of size 2^( 2) =       0.000498722724
  error estimate for blocks of size 2^( 3) =       0.000521743896
  error estimate for blocks of size 2^( 4) =       0.000538833667
  error estimate for blocks of size 2^( 5) =       0.000550292551
  error estimate for blocks of size 2^( 6) =       0.000556873169
  error estimate for blocks of size 2^( 7) =       0.000560689433

      target function =      -0.745217169497
              le_mean =     -22.815404206910
             les_mean =     520.992691628510
             stat err =       0.000551672205
             autocorr =       1.352563780282
   target nu stat err =       0.000551672205
   target dn stat err =       0.003458680400
      target stat err =       0.002978753080
              std dev =       0.670837334097
             le_variance =       0.450022728819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281540420691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+49, overlap shift 1.5625e+50 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745227917829       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745227917829       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746093750000       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+49 is 4.912577e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+49, overlap shift 6.2500e+50 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745227917829       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745227917829       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745227917829       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+49 is 1.228144e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+50, overlap shift 2.5000e+51 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745227917829       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745227917829       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742187500000       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+50 is 3.070361e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.396782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0491e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7264
    reference variance = 0.332719
====================================================
  Execution time = 4.3602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4875e-01
  Total weights = 2.0000e+06
  Execution time = 3.5515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448740599133
                                         uncertainty =       0.004565120510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448740599133
                                         uncertainty =       0.004565120510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473679875
  error estimate for blocks of size 2^( 2) =       0.000498530303
  error estimate for blocks of size 2^( 3) =       0.000521466039
  error estimate for blocks of size 2^( 4) =       0.000539166784
  error estimate for blocks of size 2^( 5) =       0.000549174351
  error estimate for blocks of size 2^( 6) =       0.000556184966
  error estimate for blocks of size 2^( 7) =       0.000558836490

      target function =      -0.746303621279
              le_mean =     -22.814380837555
             les_mean =     520.944718023817
             stat err =       0.000550840648
             autocorr =       1.352328169026
   target nu stat err =       0.000550840648
   target dn stat err =       0.004553159093
      target stat err =       0.003889909020
              std dev =       0.669884502882
             le_variance =       0.448745247201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448740599133
                                         uncertainty =       0.004565120510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448740599133
                                         uncertainty =       0.004565120510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473679875
  error estimate for blocks of size 2^( 2) =       0.000498530303
  error estimate for blocks of size 2^( 3) =       0.000521466039
  error estimate for blocks of size 2^( 4) =       0.000539166784
  error estimate for blocks of size 2^( 5) =       0.000549174351
  error estimate for blocks of size 2^( 6) =       0.000556184966
  error estimate for blocks of size 2^( 7) =       0.000558836490

      target function =      -0.746303621279
              le_mean =     -22.814380837555
             les_mean =     520.944718023817
             stat err =       0.000550840648
             autocorr =       1.352328169034
   target nu stat err =       0.000550840648
   target dn stat err =       0.004553159093
      target stat err =       0.003889909020
              std dev =       0.669884502882
             le_variance =       0.448745247201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448740599133
                                         uncertainty =       0.004565120510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448740599133
                                         uncertainty =       0.004565120510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473679875
  error estimate for blocks of size 2^( 2) =       0.000498530303
  error estimate for blocks of size 2^( 3) =       0.000521466039
  error estimate for blocks of size 2^( 4) =       0.000539166784
  error estimate for blocks of size 2^( 5) =       0.000549174351
  error estimate for blocks of size 2^( 6) =       0.000556184966
  error estimate for blocks of size 2^( 7) =       0.000558836490

      target function =      -0.746303621279
              le_mean =     -22.814380837555
             les_mean =     520.944718023817
             stat err =       0.000550840648
             autocorr =       1.352328169034
   target nu stat err =       0.000550840648
   target dn stat err =       0.004553159093
      target stat err =       0.003889909020
              std dev =       0.669884502882
             le_variance =       0.448745247201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448740599133
                                         uncertainty =       0.004565120510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448740599133
                                         uncertainty =       0.004565120510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473679875
  error estimate for blocks of size 2^( 2) =       0.000498530303
  error estimate for blocks of size 2^( 3) =       0.000521466039
  error estimate for blocks of size 2^( 4) =       0.000539166784
  error estimate for blocks of size 2^( 5) =       0.000549174351
  error estimate for blocks of size 2^( 6) =       0.000556184966
  error estimate for blocks of size 2^( 7) =       0.000558836490

      target function =      -0.746303621279
              le_mean =     -22.814380837555
             les_mean =     520.944718023817
             stat err =       0.000550840648
             autocorr =       1.352328169034
   target nu stat err =       0.000550840648
   target dn stat err =       0.004553159093
      target stat err =       0.003889909020
              std dev =       0.669884502882
             le_variance =       0.448745247201


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746303621279        initial  <--
     1.5625e+49     1.5625e+50             4.9126e-54        -0.746303621279
     6.2500e+49     6.2500e+50             1.2281e-54        -0.746303621279
     2.5000e+50     2.5000e+51             3.0704e-55        -0.746303621279

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3604
  </log>
  <optVariables href="FORM.s053.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2186e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8638
    reference variance = 0.53267
====================================================
  Execution time = 4.3517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.8322e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4706e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483241264680
                                         uncertainty =       0.036153398211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483241264680
                                         uncertainty =       0.036153398211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491540730
  error estimate for blocks of size 2^( 2) =       0.000515958557
  error estimate for blocks of size 2^( 3) =       0.000538435136
  error estimate for blocks of size 2^( 4) =       0.000554393612
  error estimate for blocks of size 2^( 5) =       0.000564905325
  error estimate for blocks of size 2^( 6) =       0.000573596252
  error estimate for blocks of size 2^( 7) =       0.000574919556

      target function =      -0.717182840629
              le_mean =     -22.815010118272
             les_mean =     521.007911034451
             stat err =       0.000566953686
             autocorr =       1.330381342783
   target nu stat err =       0.000566953686
   target dn stat err =       0.036178160902
      target stat err =       0.028252157422
              std dev =       0.695143567329
             le_variance =       0.483224579198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281501011827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+50, overlap shift 1.5625e+51 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.718299764026       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.718299764026       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.49e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.49e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+50 is 1.194802e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+50, overlap shift 6.2500e+51 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.718299764026       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.718299764026       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.718299764026       residual = 8.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.50e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+50 is 2.987004e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+51, overlap shift 2.5000e+52 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.718299764026       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.718299764026       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =       0.000000000000       residual = 2.49e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.49e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+51 is 7.467511e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.398467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8230e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7441
    reference variance = 0.35154
====================================================
  Execution time = 4.4110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5195e-01
  Total weights = 2.0000e+06
  Execution time = 3.5503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451966772559
                                         uncertainty =       0.002924576744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451966772559
                                         uncertainty =       0.002924576744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475370564
  error estimate for blocks of size 2^( 2) =       0.000500308481
  error estimate for blocks of size 2^( 3) =       0.000523631551
  error estimate for blocks of size 2^( 4) =       0.000540906770
  error estimate for blocks of size 2^( 5) =       0.000552005998
  error estimate for blocks of size 2^( 6) =       0.000557869996
  error estimate for blocks of size 2^( 7) =       0.000561109331

      target function =      -0.743620591103
              le_mean =     -22.814206746266
             les_mean =     520.939983580842
             stat err =       0.000552973024
             autocorr =       1.353141831378
   target nu stat err =       0.000552973024
   target dn stat err =       0.003156032446
      target stat err =       0.002714059986
              std dev =       0.672275498192
             le_variance =       0.451954345470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451966772559
                                         uncertainty =       0.002924576744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451966772559
                                         uncertainty =       0.002924576744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475370564
  error estimate for blocks of size 2^( 2) =       0.000500308481
  error estimate for blocks of size 2^( 3) =       0.000523631551
  error estimate for blocks of size 2^( 4) =       0.000540906770
  error estimate for blocks of size 2^( 5) =       0.000552005998
  error estimate for blocks of size 2^( 6) =       0.000557869996
  error estimate for blocks of size 2^( 7) =       0.000561109331

      target function =      -0.743620591103
              le_mean =     -22.814206746266
             les_mean =     520.939983580842
             stat err =       0.000552973024
             autocorr =       1.353141831378
   target nu stat err =       0.000552973024
   target dn stat err =       0.003156032446
      target stat err =       0.002714059986
              std dev =       0.672275498192
             le_variance =       0.451954345470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451966772559
                                         uncertainty =       0.002924576744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451966772559
                                         uncertainty =       0.002924576744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475370564
  error estimate for blocks of size 2^( 2) =       0.000500308481
  error estimate for blocks of size 2^( 3) =       0.000523631551
  error estimate for blocks of size 2^( 4) =       0.000540906770
  error estimate for blocks of size 2^( 5) =       0.000552005998
  error estimate for blocks of size 2^( 6) =       0.000557869996
  error estimate for blocks of size 2^( 7) =       0.000561109331

      target function =      -0.743620591103
              le_mean =     -22.814206746266
             les_mean =     520.939983580842
             stat err =       0.000552973024
             autocorr =       1.353141831378
   target nu stat err =       0.000552973024
   target dn stat err =       0.003156032446
      target stat err =       0.002714059986
              std dev =       0.672275498192
             le_variance =       0.451954345470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451966772559
                                         uncertainty =       0.002924576744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451966772559
                                         uncertainty =       0.002924576744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475370564
  error estimate for blocks of size 2^( 2) =       0.000500308481
  error estimate for blocks of size 2^( 3) =       0.000523631551
  error estimate for blocks of size 2^( 4) =       0.000540906770
  error estimate for blocks of size 2^( 5) =       0.000552005998
  error estimate for blocks of size 2^( 6) =       0.000557869996
  error estimate for blocks of size 2^( 7) =       0.000561109331

      target function =      -0.743620591103
              le_mean =     -22.814206746266
             les_mean =     520.939983580842
             stat err =       0.000552973024
             autocorr =       1.353141831378
   target nu stat err =       0.000552973024
   target dn stat err =       0.003156032446
      target stat err =       0.002714059986
              std dev =       0.672275498192
             le_variance =       0.451954345470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743620591103        initial  <--
     1.5625e+50     1.5625e+51             1.1948e-54        -0.743620591103
     6.2500e+50     6.2500e+51             2.9870e-55        -0.743620591103
     2.5000e+51     2.5000e+52             7.4675e-56        -0.743620591103

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8596
  </log>
  <optVariables href="FORM.s054.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2010e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8143
    reference variance = 0.277526
====================================================
  Execution time = 4.5057e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.7699e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4792e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477068028424
                                         uncertainty =       0.016982570419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477068028424
                                         uncertainty =       0.016982570419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488359703
  error estimate for blocks of size 2^( 2) =       0.000512595458
  error estimate for blocks of size 2^( 3) =       0.000535157640
  error estimate for blocks of size 2^( 4) =       0.000552905576
  error estimate for blocks of size 2^( 5) =       0.000563334875
  error estimate for blocks of size 2^( 6) =       0.000571996825
  error estimate for blocks of size 2^( 7) =       0.000574515408

      target function =      -0.722932626787
              le_mean =     -22.815385661339
             les_mean =     521.018813035242
             stat err =       0.000565688171
             autocorr =       1.341759115088
   target nu stat err =       0.000565688171
   target dn stat err =       0.017115184387
      target stat err =       0.013583063584
              std dev =       0.690644914638
             le_variance =       0.476990398115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281538566134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+51, overlap shift 1.5625e+52 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.723188978848       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.723188978848       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+51, overlap shift 6.2500e+52 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.723188978848       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.723188978848       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+52, overlap shift 2.5000e+53 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.723188978848       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.723188978848       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.399643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9857e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.9035
    reference variance = 0.351261
====================================================
  Execution time = 4.5319e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4776e-01
  Total weights = 2.0000e+06
  Execution time = 3.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447724499358
                                         uncertainty =       0.005269374182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447724499358
                                         uncertainty =       0.005269374182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159714
  error estimate for blocks of size 2^( 2) =       0.000497864548
  error estimate for blocks of size 2^( 3) =       0.000521080727
  error estimate for blocks of size 2^( 4) =       0.000537870513
  error estimate for blocks of size 2^( 5) =       0.000548103181
  error estimate for blocks of size 2^( 6) =       0.000552143492
  error estimate for blocks of size 2^( 7) =       0.000553872584

      target function =      -0.747132437085
              le_mean =     -22.813987560611
             les_mean =     520.925788421182
             stat err =       0.000547997442
             autocorr =       1.341348236234
   target nu stat err =       0.000547997442
   target dn stat err =       0.005445072614
      target stat err =       0.004641015588
              std dev =       0.669148884282
             le_variance =       0.447760229335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447724499358
                                         uncertainty =       0.005269374182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447724499358
                                         uncertainty =       0.005269374182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159714
  error estimate for blocks of size 2^( 2) =       0.000497864548
  error estimate for blocks of size 2^( 3) =       0.000521080727
  error estimate for blocks of size 2^( 4) =       0.000537870513
  error estimate for blocks of size 2^( 5) =       0.000548103181
  error estimate for blocks of size 2^( 6) =       0.000552143492
  error estimate for blocks of size 2^( 7) =       0.000553872584

      target function =      -0.747132437085
              le_mean =     -22.813987560611
             les_mean =     520.925788421182
             stat err =       0.000547997442
             autocorr =       1.341348236234
   target nu stat err =       0.000547997442
   target dn stat err =       0.005445072614
      target stat err =       0.004641015588
              std dev =       0.669148884282
             le_variance =       0.447760229335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447724499358
                                         uncertainty =       0.005269374182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447724499358
                                         uncertainty =       0.005269374182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159714
  error estimate for blocks of size 2^( 2) =       0.000497864548
  error estimate for blocks of size 2^( 3) =       0.000521080727
  error estimate for blocks of size 2^( 4) =       0.000537870513
  error estimate for blocks of size 2^( 5) =       0.000548103181
  error estimate for blocks of size 2^( 6) =       0.000552143492
  error estimate for blocks of size 2^( 7) =       0.000553872584

      target function =      -0.747132437085
              le_mean =     -22.813987560611
             les_mean =     520.925788421182
             stat err =       0.000547997442
             autocorr =       1.341348236234
   target nu stat err =       0.000547997442
   target dn stat err =       0.005445072614
      target stat err =       0.004641015588
              std dev =       0.669148884282
             le_variance =       0.447760229335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447724499358
                                         uncertainty =       0.005269374182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447724499358
                                         uncertainty =       0.005269374182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473159714
  error estimate for blocks of size 2^( 2) =       0.000497864548
  error estimate for blocks of size 2^( 3) =       0.000521080727
  error estimate for blocks of size 2^( 4) =       0.000537870513
  error estimate for blocks of size 2^( 5) =       0.000548103181
  error estimate for blocks of size 2^( 6) =       0.000552143492
  error estimate for blocks of size 2^( 7) =       0.000553872584

      target function =      -0.747132437085
              le_mean =     -22.813987560611
             les_mean =     520.925788421182
             stat err =       0.000547997442
             autocorr =       1.341348236234
   target nu stat err =       0.000547997442
   target dn stat err =       0.005445072614
      target stat err =       0.004641015588
              std dev =       0.669148884282
             le_variance =       0.447760229335


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747132437085        initial  <--
     1.5625e+51     1.5625e+52             0.0000e+00        -0.747132437085
     6.2500e+51     6.2500e+52             0.0000e+00        -0.747132437085
     2.5000e+52     2.5000e+53             0.0000e+00        -0.747132437085

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0620
  </log>
  <optVariables href="FORM.s055.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2292e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8648
    reference variance = 0.307629
====================================================
  Execution time = 4.4028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4755e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4672e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447638055857
                                         uncertainty =       0.005363270659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447638055857
                                         uncertainty =       0.005363270659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473049032
  error estimate for blocks of size 2^( 2) =       0.000497843871
  error estimate for blocks of size 2^( 3) =       0.000521039717
  error estimate for blocks of size 2^( 4) =       0.000538527312
  error estimate for blocks of size 2^( 5) =       0.000549686864
  error estimate for blocks of size 2^( 6) =       0.000554519026
  error estimate for blocks of size 2^( 7) =       0.000557737246

      target function =      -0.747308468473
              le_mean =     -22.813899205298
             les_mean =     520.921547498628
             stat err =       0.000550117612
             autocorr =       1.352380133994
   target nu stat err =       0.000550117612
   target dn stat err =       0.005654080362
      target stat err =       0.004817972245
              std dev =       0.668992356386
             le_variance =       0.447550772902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281389920530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+52, overlap shift 1.5625e+53 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747338136788       residual = 8.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747338136788       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 8.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 7.62e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 7.20e+06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+52 is 7.272251e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+52, overlap shift 6.2500e+53 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747338136788       residual = 8.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747338136788       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747338136788       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 3.60e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747338136788       residual = 8.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+52 is 3.583939e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+53, overlap shift 2.5000e+54 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747338136788       residual = 8.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747338136788       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -1.000000000000       residual = 2.94e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 8.27e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 3.09e+06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+53 is 4.545157e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.401646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8707e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8696
    reference variance = 1.05067
====================================================
  Execution time = 4.3315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4334e-01
  Total weights = 2.0000e+06
  Execution time = 3.5668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443154603081
                                         uncertainty =       0.002415291809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443154603081
                                         uncertainty =       0.002415291809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470818553
  error estimate for blocks of size 2^( 2) =       0.000495868035
  error estimate for blocks of size 2^( 3) =       0.000519276137
  error estimate for blocks of size 2^( 4) =       0.000537218826
  error estimate for blocks of size 2^( 5) =       0.000548618968
  error estimate for blocks of size 2^( 6) =       0.000555943059
  error estimate for blocks of size 2^( 7) =       0.000559680573

      target function =      -0.750898915087
              le_mean =     -22.814863219284
             les_mean =     520.961323713095
             stat err =       0.000550365357
             autocorr =       1.366454077506
   target nu stat err =       0.000550365357
   target dn stat err =       0.002446434634
      target stat err =       0.002181895354
              std dev =       0.665837983392
             le_variance =       0.443340220128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443154603081
                                         uncertainty =       0.002415291809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443154603081
                                         uncertainty =       0.002415291809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470818553
  error estimate for blocks of size 2^( 2) =       0.000495868035
  error estimate for blocks of size 2^( 3) =       0.000519276137
  error estimate for blocks of size 2^( 4) =       0.000537218826
  error estimate for blocks of size 2^( 5) =       0.000548618968
  error estimate for blocks of size 2^( 6) =       0.000555943059
  error estimate for blocks of size 2^( 7) =       0.000559680573

      target function =      -0.750898915087
              le_mean =     -22.814863219284
             les_mean =     520.961323713095
             stat err =       0.000550365357
             autocorr =       1.366454077506
   target nu stat err =       0.000550365357
   target dn stat err =       0.002446434634
      target stat err =       0.002181895354
              std dev =       0.665837983392
             le_variance =       0.443340220128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443154603081
                                         uncertainty =       0.002415291809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443154603081
                                         uncertainty =       0.002415291809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470818553
  error estimate for blocks of size 2^( 2) =       0.000495868035
  error estimate for blocks of size 2^( 3) =       0.000519276137
  error estimate for blocks of size 2^( 4) =       0.000537218826
  error estimate for blocks of size 2^( 5) =       0.000548618968
  error estimate for blocks of size 2^( 6) =       0.000555943059
  error estimate for blocks of size 2^( 7) =       0.000559680573

      target function =      -0.750898915087
              le_mean =     -22.814863219284
             les_mean =     520.961323713095
             stat err =       0.000550365357
             autocorr =       1.366454077506
   target nu stat err =       0.000550365357
   target dn stat err =       0.002446434634
      target stat err =       0.002181895354
              std dev =       0.665837983392
             le_variance =       0.443340220128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443154603081
                                         uncertainty =       0.002415291809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443154603081
                                         uncertainty =       0.002415291809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470818553
  error estimate for blocks of size 2^( 2) =       0.000495868035
  error estimate for blocks of size 2^( 3) =       0.000519276137
  error estimate for blocks of size 2^( 4) =       0.000537218826
  error estimate for blocks of size 2^( 5) =       0.000548618968
  error estimate for blocks of size 2^( 6) =       0.000555943059
  error estimate for blocks of size 2^( 7) =       0.000559680573

      target function =      -0.750898915087
              le_mean =     -22.814863219284
             les_mean =     520.961323713095
             stat err =       0.000550365357
             autocorr =       1.366454077506
   target nu stat err =       0.000550365357
   target dn stat err =       0.002446434634
      target stat err =       0.002181895354
              std dev =       0.665837983392
             le_variance =       0.443340220128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750898915087        initial  <--
     1.5625e+52     1.5625e+53             7.2723e-57        -0.750898915087
     6.2500e+52     6.2500e+53             3.5839e-57        -0.750898915087
     2.5000e+53     2.5000e+54             4.5452e-58        -0.750898915087

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1697
  </log>
  <optVariables href="FORM.s056.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1989e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8054
    reference variance = 0.486619
====================================================
  Execution time = 4.3761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4921e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4870e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448931412405
                                         uncertainty =       0.003120805377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448931412405
                                         uncertainty =       0.003120805377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473925950
  error estimate for blocks of size 2^( 2) =       0.000499364303
  error estimate for blocks of size 2^( 3) =       0.000522591049
  error estimate for blocks of size 2^( 4) =       0.000540233506
  error estimate for blocks of size 2^( 5) =       0.000550562515
  error estimate for blocks of size 2^( 6) =       0.000556349995
  error estimate for blocks of size 2^( 7) =       0.000556758062

      target function =      -0.745907092561
              le_mean =     -22.815023124032
             les_mean =     520.974491537471
             stat err =       0.000550976019
             autocorr =       1.351588275621
   target nu stat err =       0.000550976019
   target dn stat err =       0.003530960020
      target stat err =       0.003041896333
              std dev =       0.670232505911
             le_variance =       0.449211611980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281502312403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+53, overlap shift 1.5625e+54 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745918520332       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745918520332       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+53, overlap shift 6.2500e+54 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745918520332       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745918520332       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+54, overlap shift 2.5000e+55 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745918520332       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745918520332       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.402807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8638e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8666
    reference variance = 0.345394
====================================================
  Execution time = 4.4866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 5.2635e-01
  Total weights = 2.0000e+06
  Execution time = 3.5549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526408479668
                                         uncertainty =       0.071468481105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526408479668
                                         uncertainty =       0.071468481105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513007556
  error estimate for blocks of size 2^( 2) =       0.000536391376
  error estimate for blocks of size 2^( 3) =       0.000558115333
  error estimate for blocks of size 2^( 4) =       0.000573931385
  error estimate for blocks of size 2^( 5) =       0.000584267497
  error estimate for blocks of size 2^( 6) =       0.000590851979
  error estimate for blocks of size 2^( 7) =       0.000592750010

      target function =      -0.682388338303
              le_mean =     -22.814225108153
             les_mean =     521.015220527950
             stat err =       0.000585450218
             autocorr =       1.302364110055
   target nu stat err =       0.000585450218
   target dn stat err =       0.071512271912
      target stat err =       0.050689849192
              std dev =       0.725502243724
             le_variance =       0.526353505649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526408479668
                                         uncertainty =       0.071468481105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526408479668
                                         uncertainty =       0.071468481105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513007556
  error estimate for blocks of size 2^( 2) =       0.000536391376
  error estimate for blocks of size 2^( 3) =       0.000558115333
  error estimate for blocks of size 2^( 4) =       0.000573931385
  error estimate for blocks of size 2^( 5) =       0.000584267497
  error estimate for blocks of size 2^( 6) =       0.000590851979
  error estimate for blocks of size 2^( 7) =       0.000592750010

      target function =      -0.682388338303
              le_mean =     -22.814225108153
             les_mean =     521.015220527950
             stat err =       0.000585450218
             autocorr =       1.302364110055
   target nu stat err =       0.000585450218
   target dn stat err =       0.071512271912
      target stat err =       0.050689849192
              std dev =       0.725502243724
             le_variance =       0.526353505649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526408479668
                                         uncertainty =       0.071468481105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526408479668
                                         uncertainty =       0.071468481105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513007556
  error estimate for blocks of size 2^( 2) =       0.000536391376
  error estimate for blocks of size 2^( 3) =       0.000558115333
  error estimate for blocks of size 2^( 4) =       0.000573931385
  error estimate for blocks of size 2^( 5) =       0.000584267497
  error estimate for blocks of size 2^( 6) =       0.000590851979
  error estimate for blocks of size 2^( 7) =       0.000592750010

      target function =      -0.682388338303
              le_mean =     -22.814225108153
             les_mean =     521.015220527950
             stat err =       0.000585450218
             autocorr =       1.302364110055
   target nu stat err =       0.000585450218
   target dn stat err =       0.071512271912
      target stat err =       0.050689849192
              std dev =       0.725502243724
             le_variance =       0.526353505649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526408479668
                                         uncertainty =       0.071468481105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526408479668
                                         uncertainty =       0.071468481105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513007556
  error estimate for blocks of size 2^( 2) =       0.000536391376
  error estimate for blocks of size 2^( 3) =       0.000558115333
  error estimate for blocks of size 2^( 4) =       0.000573931385
  error estimate for blocks of size 2^( 5) =       0.000584267497
  error estimate for blocks of size 2^( 6) =       0.000590851979
  error estimate for blocks of size 2^( 7) =       0.000592750010

      target function =      -0.682388338303
              le_mean =     -22.814225108153
             les_mean =     521.015220527950
             stat err =       0.000585450218
             autocorr =       1.302364110055
   target nu stat err =       0.000585450218
   target dn stat err =       0.071512271912
      target stat err =       0.050689849192
              std dev =       0.725502243724
             le_variance =       0.526353505649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.682388338303        initial  <--
     1.5625e+53     1.5625e+54             0.0000e+00        -0.682388338303
     6.2500e+53     6.2500e+54             0.0000e+00        -0.682388338303
     2.5000e+54     2.5000e+55             0.0000e+00        -0.682388338303

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6275
  </log>
  <optVariables href="FORM.s057.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2127e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8927
    reference variance = 0.38005
====================================================
  Execution time = 4.6070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4999e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4835e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450045014660
                                         uncertainty =       0.003987741060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450045014660
                                         uncertainty =       0.003987741060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474336181
  error estimate for blocks of size 2^( 2) =       0.000499280612
  error estimate for blocks of size 2^( 3) =       0.000523125633
  error estimate for blocks of size 2^( 4) =       0.000540645653
  error estimate for blocks of size 2^( 5) =       0.000550264575
  error estimate for blocks of size 2^( 6) =       0.000554370139
  error estimate for blocks of size 2^( 7) =       0.000554855319

      target function =      -0.745245659473
              le_mean =     -22.815229267309
             les_mean =     520.984675920839
             stat err =       0.000550033921
             autocorr =       1.344641286447
   target nu stat err =       0.000550033921
   target dn stat err =       0.003822690093
      target stat err =       0.003278184716
              std dev =       0.670812660855
             le_variance =       0.449989625963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281522926731e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+54, overlap shift 1.5625e+55 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745259151301       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745259151301       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+54, overlap shift 6.2500e+55 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745259151301       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745259151301       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+55, overlap shift 2.5000e+56 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745259151301       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745259151301       residual = 5.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.403945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0911e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8129
    reference variance = 0.516961
====================================================
  Execution time = 4.3650e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5059e-01
  Total weights = 2.0000e+06
  Execution time = 3.5819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450640028826
                                         uncertainty =       0.004592463138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450640028826
                                         uncertainty =       0.004592463138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474650703
  error estimate for blocks of size 2^( 2) =       0.000499339645
  error estimate for blocks of size 2^( 3) =       0.000522839620
  error estimate for blocks of size 2^( 4) =       0.000539089154
  error estimate for blocks of size 2^( 5) =       0.000550620509
  error estimate for blocks of size 2^( 6) =       0.000557310735
  error estimate for blocks of size 2^( 7) =       0.000561095006

      target function =      -0.744745005584
              le_mean =     -22.815005291303
             les_mean =     520.975052795808
             stat err =       0.000552028851
             autocorr =       1.352618415553
   target nu stat err =       0.000552028851
   target dn stat err =       0.004189635010
      target stat err =       0.003576483706
              std dev =       0.671257460964
             le_variance =       0.450586578900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450640028826
                                         uncertainty =       0.004592463138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450640028826
                                         uncertainty =       0.004592463138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474650703
  error estimate for blocks of size 2^( 2) =       0.000499339645
  error estimate for blocks of size 2^( 3) =       0.000522839620
  error estimate for blocks of size 2^( 4) =       0.000539089154
  error estimate for blocks of size 2^( 5) =       0.000550620509
  error estimate for blocks of size 2^( 6) =       0.000557310735
  error estimate for blocks of size 2^( 7) =       0.000561095006

      target function =      -0.744745005584
              le_mean =     -22.815005291303
             les_mean =     520.975052795808
             stat err =       0.000552028851
             autocorr =       1.352618415553
   target nu stat err =       0.000552028851
   target dn stat err =       0.004189635010
      target stat err =       0.003576483706
              std dev =       0.671257460964
             le_variance =       0.450586578900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450640028826
                                         uncertainty =       0.004592463138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450640028826
                                         uncertainty =       0.004592463138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474650703
  error estimate for blocks of size 2^( 2) =       0.000499339645
  error estimate for blocks of size 2^( 3) =       0.000522839620
  error estimate for blocks of size 2^( 4) =       0.000539089154
  error estimate for blocks of size 2^( 5) =       0.000550620509
  error estimate for blocks of size 2^( 6) =       0.000557310735
  error estimate for blocks of size 2^( 7) =       0.000561095006

      target function =      -0.744745005584
              le_mean =     -22.815005291303
             les_mean =     520.975052795808
             stat err =       0.000552028851
             autocorr =       1.352618415553
   target nu stat err =       0.000552028851
   target dn stat err =       0.004189635010
      target stat err =       0.003576483706
              std dev =       0.671257460964
             le_variance =       0.450586578900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450640028826
                                         uncertainty =       0.004592463138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450640028826
                                         uncertainty =       0.004592463138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474650703
  error estimate for blocks of size 2^( 2) =       0.000499339645
  error estimate for blocks of size 2^( 3) =       0.000522839620
  error estimate for blocks of size 2^( 4) =       0.000539089154
  error estimate for blocks of size 2^( 5) =       0.000550620509
  error estimate for blocks of size 2^( 6) =       0.000557310735
  error estimate for blocks of size 2^( 7) =       0.000561095006

      target function =      -0.744745005584
              le_mean =     -22.815005291303
             les_mean =     520.975052795808
             stat err =       0.000552028851
             autocorr =       1.352618415553
   target nu stat err =       0.000552028851
   target dn stat err =       0.004189635010
      target stat err =       0.003576483706
              std dev =       0.671257460964
             le_variance =       0.450586578900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744745005584        initial  <--
     1.5625e+54     1.5625e+55             0.0000e+00        -0.744745005584
     6.2500e+54     6.2500e+55             0.0000e+00        -0.744745005584
     2.5000e+55     2.5000e+56             0.0000e+00        -0.744745005584

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.5707
  </log>
  <optVariables href="FORM.s058.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2251e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6673
    reference variance = 0.385436
====================================================
  Execution time = 4.4033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4817e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4701e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448198972013
                                         uncertainty =       0.003297337535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448198972013
                                         uncertainty =       0.003297337535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473375483
  error estimate for blocks of size 2^( 2) =       0.000497841875
  error estimate for blocks of size 2^( 3) =       0.000521317380
  error estimate for blocks of size 2^( 4) =       0.000537718270
  error estimate for blocks of size 2^( 5) =       0.000547987816
  error estimate for blocks of size 2^( 6) =       0.000555117769
  error estimate for blocks of size 2^( 7) =       0.000558587096

      target function =      -0.746801213146
              le_mean =     -22.814181429100
             les_mean =     520.935042751655
             stat err =       0.000549852738
             autocorr =       1.349215311531
   target nu stat err =       0.000549852738
   target dn stat err =       0.003442859725
      target stat err =       0.002972126414
              std dev =       0.669454028194
             le_variance =       0.448168695865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281418142910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+55, overlap shift 1.5625e+56 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746812192303       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746812192303       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746812192303       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.60e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.79e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+55 is 1.022909e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+55, overlap shift 6.2500e+56 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746812192303       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746812192303       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746812192303       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 2.60e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 2.79e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+55 is 2.557271e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+56, overlap shift 2.5000e+57 and omega -2.3475e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746812192303       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746812192303       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746812192303       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746812192303       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746812192303       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+56 is 7.281596e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.405958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8741e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.8409
    reference variance = 0.33084
====================================================
  Execution time = 4.3403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4673e-01
  Total weights = 2.0000e+06
  Execution time = 3.5656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446788379455
                                         uncertainty =       0.003506859696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446788379455
                                         uncertainty =       0.003506859696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472613617
  error estimate for blocks of size 2^( 2) =       0.000497606104
  error estimate for blocks of size 2^( 3) =       0.000521003426
  error estimate for blocks of size 2^( 4) =       0.000538745986
  error estimate for blocks of size 2^( 5) =       0.000548799293
  error estimate for blocks of size 2^( 6) =       0.000553525038
  error estimate for blocks of size 2^( 7) =       0.000557589756

      target function =      -0.748017515329
              le_mean =     -22.814522212054
             les_mean =     520.949150803198
             stat err =       0.000549665018
             autocorr =       1.352644701583
   target nu stat err =       0.000549665018
   target dn stat err =       0.003138276405
      target stat err =       0.002731211439
              std dev =       0.668376587147
             le_variance =       0.446727262247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446788379455
                                         uncertainty =       0.003506859696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446788379455
                                         uncertainty =       0.003506859696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472613617
  error estimate for blocks of size 2^( 2) =       0.000497606104
  error estimate for blocks of size 2^( 3) =       0.000521003426
  error estimate for blocks of size 2^( 4) =       0.000538745986
  error estimate for blocks of size 2^( 5) =       0.000548799293
  error estimate for blocks of size 2^( 6) =       0.000553525038
  error estimate for blocks of size 2^( 7) =       0.000557589756

      target function =      -0.748017515329
              le_mean =     -22.814522212054
             les_mean =     520.949150803198
             stat err =       0.000549665018
             autocorr =       1.352644701583
   target nu stat err =       0.000549665018
   target dn stat err =       0.003138276405
      target stat err =       0.002731211439
              std dev =       0.668376587147
             le_variance =       0.446727262247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446788379455
                                         uncertainty =       0.003506859696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446788379455
                                         uncertainty =       0.003506859696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472613617
  error estimate for blocks of size 2^( 2) =       0.000497606104
  error estimate for blocks of size 2^( 3) =       0.000521003426
  error estimate for blocks of size 2^( 4) =       0.000538745986
  error estimate for blocks of size 2^( 5) =       0.000548799293
  error estimate for blocks of size 2^( 6) =       0.000553525038
  error estimate for blocks of size 2^( 7) =       0.000557589756

      target function =      -0.748017515329
              le_mean =     -22.814522212054
             les_mean =     520.949150803198
             stat err =       0.000549665018
             autocorr =       1.352644701583
   target nu stat err =       0.000549665018
   target dn stat err =       0.003138276405
      target stat err =       0.002731211439
              std dev =       0.668376587147
             le_variance =       0.446727262247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446788379455
                                         uncertainty =       0.003506859696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446788379455
                                         uncertainty =       0.003506859696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472613617
  error estimate for blocks of size 2^( 2) =       0.000497606104
  error estimate for blocks of size 2^( 3) =       0.000521003426
  error estimate for blocks of size 2^( 4) =       0.000538745986
  error estimate for blocks of size 2^( 5) =       0.000548799293
  error estimate for blocks of size 2^( 6) =       0.000553525038
  error estimate for blocks of size 2^( 7) =       0.000557589756

      target function =      -0.748017515329
              le_mean =     -22.814522212054
             les_mean =     520.949150803198
             stat err =       0.000549665018
             autocorr =       1.352644701583
   target nu stat err =       0.000549665018
   target dn stat err =       0.003138276405
      target stat err =       0.002731211439
              std dev =       0.668376587147
             le_variance =       0.446727262247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748017515329        initial  <--
     1.5625e+55     1.5625e+56             1.0229e-59        -0.748017515329
     6.2500e+55     6.2500e+56             2.5573e-60        -0.748017515329
     2.5000e+56     2.5000e+57             7.2816e-61        -0.748017515329

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2203
  </log>
  <optVariables href="FORM.s059.opt.xml">
 uu_0                 2.624554e-01 1 1  ON 0
 uu_1                 1.011863e-01 1 1  ON 1
 uu_2                 3.659226e-03 1 1  ON 2
 uu_3                -5.375161e-02 1 1  ON 3
 uu_4                -8.591702e-02 1 1  ON 4
 uu_5                -1.029990e-01 1 1  ON 5
 uu_6                -1.108447e-01 1 1  ON 6
 uu_7                -1.087609e-01 1 1  ON 7
 uu_8                -9.325173e-02 1 1  ON 8
 uu_9                -5.957390e-02 1 1  ON 9
 ud_0                 3.378549e-01 1 1  ON 10
 ud_1                 9.967815e-02 1 1  ON 11
 ud_2                -1.443990e-02 1 1  ON 12
 ud_3                -7.376538e-02 1 1  ON 13
 ud_4                -1.061181e-01 1 1  ON 14
 ud_5                -1.224040e-01 1 1  ON 15
 ud_6                -1.277130e-01 1 1  ON 16
 ud_7                -1.191873e-01 1 1  ON 17
 ud_8                -9.272569e-02 1 1  ON 18
 ud_9                -4.447679e-02 1 1  ON 19
 eC_0                -4.563379e-01 1 1  ON 20
 eC_1                -3.182912e-01 1 1  ON 21
 eC_2                -6.732177e-02 1 1  ON 22
 eC_3                 9.506706e-02 1 1  ON 23
 eC_4                 1.375986e-01 1 1  ON 24
 eC_5                 1.931335e-01 1 1  ON 25
 eC_6                 2.098757e-01 1 1  ON 26
 eC_7                 1.661996e-01 1 1  ON 27
 eC_8                 3.840237e-02 1 1  ON 28
 eC_9                 1.377137e-03 1 1  ON 29
 eO_0                -8.227972e-01 1 1  ON 30
 eO_1                -5.297360e-01 1 1  ON 31
 eO_2                -1.492259e-01 1 1  ON 32
 eO_3                 1.025706e-01 1 1  ON 33
 eO_4                 2.270539e-01 1 1  ON 34
 eO_5                 3.212686e-01 1 1  ON 35
 eO_6                 3.347758e-01 1 1  ON 36
 eO_7                 3.060194e-01 1 1  ON 37
 eO_8                 1.433530e-01 1 1  ON 38
 eO_9                 3.830540e-02 1 1  ON 39
eH1_0                -1.277008e-01 1 1  ON 40
eH1_1                -3.779999e-02 1 1  ON 41
eH1_2                -1.874707e-02 1 1  ON 42
eH1_3                -3.712827e-02 1 1  ON 43
eH1_4                -1.241675e-02 1 1  ON 44
eH1_5                 8.974315e-03 1 1  ON 45
eH1_6                 5.391205e-02 1 1  ON 46
eH1_7                 6.334551e-02 1 1  ON 47
eH1_8                 6.498479e-02 1 1  ON 48
eH1_9                 4.352531e-02 1 1  ON 49
eH2_0                -1.183001e-01 1 1  ON 50
eH2_1                -2.576170e-02 1 1  ON 51
eH2_2                -1.319036e-02 1 1  ON 52
eH2_3                -3.560919e-02 1 1  ON 53
eH2_4                -1.653925e-02 1 1  ON 54
eH2_5                 7.920534e-03 1 1  ON 55
eH2_6                 4.215155e-02 1 1  ON 56
eH2_7                 4.045401e-02 1 1  ON 57
eH2_8                 5.493390e-02 1 1  ON 58
eH2_9                 5.404523e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1997e+02 secs
  Total Execution time = 7.2874e+03 secs

=========================================================
  A new xml input file : FORM.s059.cont.xml
