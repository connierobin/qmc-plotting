Rank =    0  Free Memory = 66651 MB
Rank =    1  Free Memory = 66651 MB
Rank =    2  Free Memory = 66651 MB
Rank =    3  Free Memory = 66651 MB
Rank =    4  Free Memory = 66651 MB
Rank =    5  Free Memory = 66651 MB
Rank =    6  Free Memory = 66651 MB
Rank =    7  Free Memory = 66651 MB
Rank =    8  Free Memory = 66651 MB
Rank =    9  Free Memory = 66651 MB
Rank =   10  Free Memory = 66650 MB
Rank =   11  Free Memory = 66650 MB
Rank =   12  Free Memory = 66650 MB
Rank =   13  Free Memory = 66650 MB
Rank =   14  Free Memory = 66649 MB
Rank =   15  Free Memory = 66635 MB
Rank =   16  Free Memory = 66635 MB
Rank =   17  Free Memory = 66635 MB
Rank =   18  Free Memory = 66635 MB
Rank =   19  Free Memory = 66635 MB
Rank =   20  Free Memory = 66635 MB
Rank =   21  Free Memory = 66635 MB
Rank =   22  Free Memory = 66635 MB
Rank =   23  Free Memory = 66635 MB
Rank =   24  Free Memory = 66635 MB
Rank =   25  Free Memory = 66635 MB
Rank =   26  Free Memory = 66635 MB
Rank =   27  Free Memory = 66635 MB
Rank =   28  Free Memory = 66635 MB
Rank =   29  Free Memory = 66635 MB
Rank =   30  Free Memory = 66635 MB
Rank =   31  Free Memory = 66635 MB
Rank =   32  Free Memory = 78465 MB
Rank =   33  Free Memory = 78465 MB
Rank =   34  Free Memory = 78465 MB
Rank =   35  Free Memory = 78465 MB
Rank =   36  Free Memory = 78465 MB
Rank =   37  Free Memory = 78464 MB
Rank =   38  Free Memory = 78464 MB
Rank =   39  Free Memory = 78464 MB
Rank =   40  Free Memory = 78464 MB
Rank =   41  Free Memory = 78464 MB
Rank =   42  Free Memory = 78464 MB
Rank =   43  Free Memory = 78464 MB
Rank =   44  Free Memory = 78464 MB
Rank =   45  Free Memory = 78464 MB
Rank =   46  Free Memory = 78464 MB
Rank =   47  Free Memory = 78464 MB
Rank =   48  Free Memory = 78464 MB
Rank =   49  Free Memory = 78464 MB
Rank =   50  Free Memory = 78464 MB
Rank =   51  Free Memory = 78464 MB
Rank =   52  Free Memory = 78464 MB
Rank =   53  Free Memory = 78464 MB
Rank =   54  Free Memory = 78464 MB
Rank =   55  Free Memory = 78464 MB
Rank =   56  Free Memory = 78464 MB
Rank =   57  Free Memory = 78464 MB
Rank =   58  Free Memory = 78464 MB
Rank =   59  Free Memory = 78464 MB
Rank =   60  Free Memory = 78464 MB
Rank =   61  Free Memory = 78464 MB
Rank =   62  Free Memory = 78464 MB
Rank =   63  Free Memory = 78464 MB
Rank =   64  Free Memory = 90194 MB
Rank =   65  Free Memory = 90193 MB
Rank =   66  Free Memory = 90193 MB
Rank =   67  Free Memory = 90193 MB
Rank =   68  Free Memory = 90193 MB
Rank =   69  Free Memory = 90193 MB
Rank =   70  Free Memory = 90193 MB
Rank =   71  Free Memory = 90193 MB
Rank =   72  Free Memory = 90193 MB
Rank =   73  Free Memory = 90193 MB
Rank =   74  Free Memory = 90193 MB
Rank =   75  Free Memory = 90193 MB
Rank =   76  Free Memory = 90193 MB
Rank =   77  Free Memory = 90193 MB
Rank =   78  Free Memory = 90193 MB
Rank =   79  Free Memory = 90193 MB
Rank =   80  Free Memory = 90193 MB
Rank =   81  Free Memory = 90193 MB
Rank =   82  Free Memory = 90193 MB
Rank =   83  Free Memory = 90193 MB
Rank =   84  Free Memory = 90193 MB
Rank =   85  Free Memory = 90193 MB
Rank =   86  Free Memory = 90193 MB
Rank =   87  Free Memory = 90193 MB
Rank =   88  Free Memory = 90193 MB
Rank =   89  Free Memory = 90193 MB
Rank =   90  Free Memory = 90193 MB
Rank =   91  Free Memory = 90193 MB
Rank =   92  Free Memory = 90193 MB
Rank =   93  Free Memory = 90193 MB
Rank =   94  Free Memory = 90193 MB
Rank =   95  Free Memory = 90193 MB
Rank =   96  Free Memory = 88203 MB
Rank =   97  Free Memory = 88203 MB
Rank =   98  Free Memory = 88203 MB
Rank =   99  Free Memory = 88203 MB
Rank =  100  Free Memory = 88203 MB
Rank =  101  Free Memory = 88203 MB
Rank =  102  Free Memory = 88203 MB
Rank =  103  Free Memory = 88202 MB
Rank =  104  Free Memory = 88202 MB
Rank =  105  Free Memory = 88202 MB
Rank =  106  Free Memory = 88202 MB
Rank =  107  Free Memory = 88202 MB
Rank =  108  Free Memory = 88202 MB
Rank =  109  Free Memory = 88202 MB
Rank =  110  Free Memory = 88202 MB
Rank =  111  Free Memory = 88202 MB
Rank =  112  Free Memory = 88202 MB
Rank =  113  Free Memory = 88202 MB
Rank =  114  Free Memory = 88202 MB
Rank =  115  Free Memory = 88202 MB
Rank =  116  Free Memory = 88202 MB
Rank =  117  Free Memory = 88202 MB
Rank =  118  Free Memory = 88202 MB
Rank =  119  Free Memory = 88202 MB
Rank =  120  Free Memory = 88202 MB
Rank =  121  Free Memory = 88202 MB
Rank =  122  Free Memory = 88202 MB
Rank =  123  Free Memory = 88202 MB
Rank =  124  Free Memory = 88202 MB
Rank =  125  Free Memory = 88202 MB
Rank =  126  Free Memory = 88202 MB
Rank =  127  Free Memory = 88202 MB
  Input file(s): opt_form_gs_gvptt_run002d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_gvptt_run002d.xml

  Project = FORM
  date    = 2023-02-14 11:39:40 PST
  host    = n0062.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 892

  Range of prime numbers to use as seeds over processors and threads = 6961-8123


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.680893e-01    1         1  ON     0
     uu_1                 9.418728e-02    1         1  ON     1
     uu_2                -1.667355e-02    1         1  ON     2
     uu_3                -8.194632e-02    1         1  ON     3
     uu_4                -1.193396e-01    1         1  ON     4
     uu_5                -1.419865e-01    1         1  ON     5
     uu_6                -1.547670e-01    1         1  ON     6
     uu_7                -1.568935e-01    1         1  ON     7
     uu_8                -1.461357e-01    1         1  ON     8
     uu_9                -1.139248e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.376333e-01    1         1  ON     0
     ud_1                 1.558882e-01    1         1  ON     1
     ud_2                 1.103529e-02    1         1  ON     2
     ud_3                -6.816170e-02    1         1  ON     3
     ud_4                -1.148095e-01    1         1  ON     4
     ud_5                -1.441725e-01    1         1  ON     5
     ud_6                -1.616961e-01    1         1  ON     6
     ud_7                -1.673089e-01    1         1  ON     7
     ud_8                -1.584490e-01    1         1  ON     8
     ud_9                -1.297023e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.610836e-01    1         1  ON     0
     eC_1                -4.074056e-01    1         1  ON     1
     eC_2                -1.599239e-01    1         1  ON     2
     eC_3                -1.569873e-02    1         1  ON     3
     eC_4                 3.137893e-02    1         1  ON     4
     eC_5                 1.170499e-01    1         1  ON     5
     eC_6                 2.353872e-01    1         1  ON     6
     eC_7                 3.972203e-01    1         1  ON     7
     eC_8                 2.822436e-01    1         1  ON     8
     eC_9                 7.428501e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.238185e+00    1         1  ON     0
     eO_1                -8.610657e-01    1         1  ON     1
     eO_2                -3.844098e-01    1         1  ON     2
     eO_3                -4.089142e-02    1         1  ON     3
     eO_4                 1.869098e-01    1         1  ON     4
     eO_5                 3.708503e-01    1         1  ON     5
     eO_6                 4.614668e-01    1         1  ON     6
     eO_7                 5.223697e-01    1         1  ON     7
     eO_8                 4.807718e-01    1         1  ON     8
     eO_9                 3.293198e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.846161e-01    1         1  ON     0
     eH1_1                -9.719121e-02    1         1  ON     1
     eH1_2                -6.430882e-02    1         1  ON     2
     eH1_3                -4.884170e-02    1         1  ON     3
     eH1_4                 1.275449e-02    1         1  ON     4
     eH1_5                 6.950987e-02    1         1  ON     5
     eH1_6                 1.258906e-01    1         1  ON     6
     eH1_7                 1.005584e-01    1         1  ON     7
     eH1_8                 9.508488e-03    1         1  ON     8
     eH1_9                -1.634331e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.863829e-01    1         1  ON     0
     eH2_1                -9.872272e-02    1         1  ON     1
     eH2_2                -6.553424e-02    1         1  ON     2
     eH2_3                -5.060985e-02    1         1  ON     3
     eH2_4                 1.105087e-02    1         1  ON     4
     eH2_5                 6.782617e-02    1         1  ON     5
     eH2_6                 1.239681e-01    1         1  ON     6
     eH2_7                 9.876623e-02    1         1  ON     7
     eH2_8                 7.565546e-03    1         1  ON     8
     eH2_9                -9.669461e-03    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.711568e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.4439e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.859
    reference variance = 0.391653
====================================================
  Execution time = 4.4536e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0086e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4839e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500778956815
                                         uncertainty =       0.004965642106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500778956815
                                         uncertainty =       0.004965642106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500428645
  error estimate for blocks of size 2^( 2) =       0.000518391122
  error estimate for blocks of size 2^( 3) =       0.000534081225
  error estimate for blocks of size 2^( 4) =       0.000545342378
  error estimate for blocks of size 2^( 5) =       0.000552002904
  error estimate for blocks of size 2^( 6) =       0.000555419068
  error estimate for blocks of size 2^( 7) =       0.000557219611

      target function =                  N/A
              le_mean =     -22.824964823203
             les_mean =     521.479876587048
             stat err =       0.000552495990
             autocorr =       1.218916451332
              std dev =       0.707712976442
             le_variance =       0.500857657024


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.282496482320e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824964823203       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824966898297       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824967872821       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824967319014       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824972264569       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824972384184       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824971527290       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824971916905       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824973265706       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824972682928       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824972111101       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824972463891       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824972248406       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824972158647       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 9.428740e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824964823203       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824965676859       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824966088543       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824965736531       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824967518951       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824967776662       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824967483474       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824967568309       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824967968147       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824967858846       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824967708199       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824967728215       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.989662e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824964823203       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824965077686       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824965203982       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824965094047       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824965569831       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824965650273       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824965579743       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824965615477       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824965701139       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824965686658       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824965652011       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 8.516980e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9389e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.680133e-01                 1 1 ON  0
uu_1  9.418688e-02                 1 1 ON  1
uu_2  -1.675897e-02                1 1 ON  2
uu_3  -8.198553e-02                1 1 ON  3
uu_4  -1.193846e-01                1 1 ON  4
uu_5  -1.420177e-01                1 1 ON  5
uu_6  -1.547653e-01                1 1 ON  6
uu_7  -1.568227e-01                1 1 ON  7
uu_8  -1.459917e-01                1 1 ON  8
uu_9  -1.138784e-01                1 1 ON  9
ud_0  4.379156e-01                 1 1 ON  10
ud_1  1.560493e-01                 1 1 ON  11
ud_2  1.100443e-02                 1 1 ON  12
ud_3  -6.828860e-02                1 1 ON  13
ud_4  -1.148766e-01                1 1 ON  14
ud_5  -1.442114e-01                1 1 ON  15
ud_6  -1.617094e-01                1 1 ON  16
ud_7  -1.674644e-01                1 1 ON  17
ud_8  -1.584182e-01                1 1 ON  18
ud_9  -1.296215e-01                1 1 ON  19
eC_0  -5.612764e-01                1 1 ON  20
eC_1  -4.074524e-01                1 1 ON  21
eC_2  -1.598829e-01                1 1 ON  22
eC_3  -1.553122e-02                1 1 ON  23
eC_4  3.138002e-02                 1 1 ON  24
eC_5  1.169786e-01                 1 1 ON  25
eC_6  2.353402e-01                 1 1 ON  26
eC_7  3.972004e-01                 1 1 ON  27
eC_8  2.823525e-01                 1 1 ON  28
eC_9  7.433957e-02                 1 1 ON  29
eO_0  -1.238455e+00                1 1 ON  30
eO_1  -8.613647e-01                1 1 ON  31
eO_2  -3.842529e-01                1 1 ON  32
eO_3  -4.072167e-02                1 1 ON  33
eO_4  1.870146e-01                 1 1 ON  34
eO_5  3.708294e-01                 1 1 ON  35
eO_6  4.613972e-01                 1 1 ON  36
eO_7  5.223922e-01                 1 1 ON  37
eO_8  4.807896e-01                 1 1 ON  38
eO_9  3.294192e-01                 1 1 ON  39
eH1_0 -1.845829e-01                1 1 ON  40
eH1_1 -9.713018e-02                1 1 ON  41
eH1_2 -6.427408e-02                1 1 ON  42
eH1_3 -4.876063e-02                1 1 ON  43
eH1_4 1.262843e-02                 1 1 ON  44
eH1_5 6.936902e-02                 1 1 ON  45
eH1_6 1.258873e-01                 1 1 ON  46
eH1_7 1.005675e-01                 1 1 ON  47
eH1_8 9.542399e-03                 1 1 ON  48
eH1_9 -1.637301e-02                1 1 ON  49
eH2_0 -1.864242e-01                1 1 ON  50
eH2_1 -9.887936e-02                1 1 ON  51
eH2_2 -6.565956e-02                1 1 ON  52
eH2_3 -5.043261e-02                1 1 ON  53
eH2_4 1.105400e-02                 1 1 ON  54
eH2_5 6.787003e-02                 1 1 ON  55
eH2_6 1.240048e-01                 1 1 ON  56
eH2_7 9.883139e-02                 1 1 ON  57
eH2_8 7.589197e-03                 1 1 ON  58
eH2_9 -9.723410e-03                1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8793
    reference variance = 0.472007
====================================================
  Execution time = 4.5530e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9880e-01
  Total weights = 2.0000e+06
  Execution time = 3.5520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498422076512
                                         uncertainty =       0.003829181388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498422076512
                                         uncertainty =       0.003829181388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499186879
  error estimate for blocks of size 2^( 2) =       0.000517222659
  error estimate for blocks of size 2^( 3) =       0.000532573705
  error estimate for blocks of size 2^( 4) =       0.000544089594
  error estimate for blocks of size 2^( 5) =       0.000549651767
  error estimate for blocks of size 2^( 6) =       0.000553667979
  error estimate for blocks of size 2^( 7) =       0.000558282411

      target function =                  N/A
              le_mean =     -22.826162733246
             les_mean =     521.532079954986
             stat err =       0.000551422938
             autocorr =       1.220234593696
              std dev =       0.705956853890
             le_variance =       0.498375079555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499534438171
                                         uncertainty =       0.003833152876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499534438171
                                         uncertainty =       0.003833152876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499743692
  error estimate for blocks of size 2^( 2) =       0.000517748597
  error estimate for blocks of size 2^( 3) =       0.000533053051
  error estimate for blocks of size 2^( 4) =       0.000544532831
  error estimate for blocks of size 2^( 5) =       0.000550082743
  error estimate for blocks of size 2^( 6) =       0.000554080177
  error estimate for blocks of size 2^( 7) =       0.000558679231

      target function =                  N/A
              le_mean =     -22.826165191035
             les_mean =     521.533304593810
             stat err =       0.000551843746
             autocorr =       1.219375901717
              std dev =       0.706744306750
             le_variance =       0.499487515123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499285075805
                                         uncertainty =       0.003831719905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499285075805
                                         uncertainty =       0.003831719905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499618929
  error estimate for blocks of size 2^( 2) =       0.000517630153
  error estimate for blocks of size 2^( 3) =       0.000532944413
  error estimate for blocks of size 2^( 4) =       0.000544432593
  error estimate for blocks of size 2^( 5) =       0.000549986183
  error estimate for blocks of size 2^( 6) =       0.000553987355
  error estimate for blocks of size 2^( 7) =       0.000558588254

      target function =                  N/A
              le_mean =     -22.826163815827
             les_mean =     521.532992446375
             stat err =       0.000551748596
             autocorr =       1.219564306928
              std dev =       0.706567865845
             le_variance =       0.499238149044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550696460
                                         uncertainty =       0.003829539361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498550696460
                                         uncertainty =       0.003829539361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499251294
  error estimate for blocks of size 2^( 2) =       0.000517283309
  error estimate for blocks of size 2^( 3) =       0.000532628820
  error estimate for blocks of size 2^( 4) =       0.000544140622
  error estimate for blocks of size 2^( 5) =       0.000549701625
  error estimate for blocks of size 2^( 6) =       0.000553715615
  error estimate for blocks of size 2^( 7) =       0.000558327956

      target function =                  N/A
              le_mean =     -22.826162671147
             les_mean =     521.532205749030
             stat err =       0.000551471455
             autocorr =       1.220134413869
              std dev =       0.706047950639
             le_variance =       0.498503708601


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826162733246        initial
     2.5000e-01     2.5000e+00             9.4287e-04       -22.826165191035  <--
     1.0000e+00     1.0000e+01             2.9897e-04       -22.826163815827
     4.0000e+00     4.0000e+01             8.5170e-05       -22.826162671147

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.3349e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.678875e-01 1 1  ON 0
 uu_1                 9.412116e-02 1 1  ON 1
 uu_2                -1.692143e-02 1 1  ON 2
 uu_3                -8.212324e-02 1 1  ON 3
 uu_4                -1.195166e-01 1 1  ON 4
 uu_5                -1.421081e-01 1 1  ON 5
 uu_6                -1.547831e-01 1 1  ON 6
 uu_7                -1.566755e-01 1 1  ON 7
 uu_8                -1.456101e-01 1 1  ON 8
 uu_9                -1.137293e-01 1 1  ON 9
 ud_0                 4.384123e-01 1 1  ON 10
 ud_1                 1.563449e-01 1 1  ON 11
 ud_2                 1.102697e-02 1 1  ON 12
 ud_3                -6.845399e-02 1 1  ON 13
 ud_4                -1.150158e-01 1 1  ON 14
 ud_5                -1.443019e-01 1 1  ON 15
 ud_6                -1.617694e-01 1 1  ON 16
 ud_7                -1.677133e-01 1 1  ON 17
 ud_8                -1.583879e-01 1 1  ON 18
 ud_9                -1.294054e-01 1 1  ON 19
 eC_0                -5.617355e-01 1 1  ON 20
 eC_1                -4.076023e-01 1 1  ON 21
 eC_2                -1.598255e-01 1 1  ON 22
 eC_3                -1.515974e-02 1 1  ON 23
 eC_4                 3.147375e-02 1 1  ON 24
 eC_5                 1.167728e-01 1 1  ON 25
 eC_6                 2.351889e-01 1 1  ON 26
 eC_7                 3.971404e-01 1 1  ON 27
 eC_8                 2.826783e-01 1 1  ON 28
 eC_9                 7.450286e-02 1 1  ON 29
 eO_0                -1.239128e+00 1 1  ON 30
 eO_1                -8.619547e-01 1 1  ON 31
 eO_2                -3.841160e-01 1 1  ON 32
 eO_3                -4.039073e-02 1 1  ON 33
 eO_4                 1.872680e-01 1 1  ON 34
 eO_5                 3.708479e-01 1 1  ON 35
 eO_6                 4.612438e-01 1 1  ON 36
 eO_7                 5.224564e-01 1 1  ON 37
 eO_8                 4.808404e-01 1 1  ON 38
 eO_9                 3.297167e-01 1 1  ON 39
eH1_0                -1.844759e-01 1 1  ON 40
eH1_1                -9.702150e-02 1 1  ON 41
eH1_2                -6.418207e-02 1 1  ON 42
eH1_3                -4.866346e-02 1 1  ON 43
eH1_4                 1.242332e-02 1 1  ON 44
eH1_5                 6.904105e-02 1 1  ON 45
eH1_6                 1.258351e-01 1 1  ON 46
eH1_7                 1.005957e-01 1 1  ON 47
eH1_8                 9.642138e-03 1 1  ON 48
eH1_9                -1.646073e-02 1 1  ON 49
eH2_0                -1.865697e-01 1 1  ON 50
eH2_1                -9.921418e-02 1 1  ON 51
eH2_2                -6.585907e-02 1 1  ON 52
eH2_3                -5.016516e-02 1 1  ON 53
eH2_4                 1.110065e-02 1 1  ON 54
eH2_5                 6.794549e-02 1 1  ON 55
eH2_6                 1.241277e-01 1 1  ON 56
eH2_7                 9.901314e-02 1 1  ON 57
eH2_8                 7.653653e-03 1 1  ON 58
eH2_9                -9.884511e-03 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2274e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2869e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7943
    reference variance = 0.349823
====================================================
  Execution time = 4.4371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5320e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497129278875
                                         uncertainty =       0.003664311050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497129278875
                                         uncertainty =       0.003664311050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498530865
  error estimate for blocks of size 2^( 2) =       0.000516537699
  error estimate for blocks of size 2^( 3) =       0.000532691429
  error estimate for blocks of size 2^( 4) =       0.000543470067
  error estimate for blocks of size 2^( 5) =       0.000550252999
  error estimate for blocks of size 2^( 6) =       0.000554204418
  error estimate for blocks of size 2^( 7) =       0.000556233459

      target function =                  N/A
              le_mean =     -22.825781522385
             les_mean =     521.513367906359
             stat err =       0.000551040236
             autocorr =       1.221750482396
              std dev =       0.705029110908
             le_variance =       0.497066047227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282578152239e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825781522385       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825787361027       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825792595918       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825798627945       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825798514893       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825798904705       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825799413322       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825799120694       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825798414875       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825799754135       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825800980378       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825800388786       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825799756328       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825799319222       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825799792198       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825799928977       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825800128026       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825799956208       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 3.361609e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825781522385       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825784750873       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825786936843       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825791545911       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825792027314       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825792297102       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825792153612       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825792107674       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825791559880       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825791820404       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825792224542       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825792086765       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825791930892       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 1.343192e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825781522385       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825782680299       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825783468462       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825785203886       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825785661646       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825785975584       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825785799844       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825785808782       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825785705758       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825785676849       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825785727717       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825785732298       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 4.503158e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015904 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9702e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.675290e-01 1 1  ON 0
 uu_1                 9.414184e-02 1 1  ON 1
 uu_2                -1.704383e-02 1 1  ON 2
 uu_3                -8.214836e-02 1 1  ON 3
 uu_4                -1.195567e-01 1 1  ON 4
 uu_5                -1.418141e-01 1 1  ON 5
 uu_6                -1.546595e-01 1 1  ON 6
 uu_7                -1.563512e-01 1 1  ON 7
 uu_8                -1.454598e-01 1 1  ON 8
 uu_9                -1.138363e-01 1 1  ON 9
 ud_0                 4.388774e-01 1 1  ON 10
 ud_1                 1.568802e-01 1 1  ON 11
 ud_2                 1.133631e-02 1 1  ON 12
 ud_3                -6.841764e-02 1 1  ON 13
 ud_4                -1.152367e-01 1 1  ON 14
 ud_5                -1.445934e-01 1 1  ON 15
 ud_6                -1.620496e-01 1 1  ON 16
 ud_7                -1.678497e-01 1 1  ON 17
 ud_8                -1.584392e-01 1 1  ON 18
 ud_9                -1.292131e-01 1 1  ON 19
 eC_0                -5.619503e-01 1 1  ON 20
 eC_1                -4.080122e-01 1 1  ON 21
 eC_2                -1.596609e-01 1 1  ON 22
 eC_3                -1.521711e-02 1 1  ON 23
 eC_4                 3.165721e-02 1 1  ON 24
 eC_5                 1.167746e-01 1 1  ON 25
 eC_6                 2.350323e-01 1 1  ON 26
 eC_7                 3.970364e-01 1 1  ON 27
 eC_8                 2.830806e-01 1 1  ON 28
 eC_9                 7.467510e-02 1 1  ON 29
 eO_0                -1.240471e+00 1 1  ON 30
 eO_1                -8.625532e-01 1 1  ON 31
 eO_2                -3.839202e-01 1 1  ON 32
 eO_3                -4.019945e-02 1 1  ON 33
 eO_4                 1.876603e-01 1 1  ON 34
 eO_5                 3.712994e-01 1 1  ON 35
 eO_6                 4.612259e-01 1 1  ON 36
 eO_7                 5.226056e-01 1 1  ON 37
 eO_8                 4.808182e-01 1 1  ON 38
 eO_9                 3.300075e-01 1 1  ON 39
eH1_0                -1.848059e-01 1 1  ON 40
eH1_1                -9.711519e-02 1 1  ON 41
eH1_2                -6.430898e-02 1 1  ON 42
eH1_3                -4.850254e-02 1 1  ON 43
eH1_4                 1.239079e-02 1 1  ON 44
eH1_5                 6.923745e-02 1 1  ON 45
eH1_6                 1.256267e-01 1 1  ON 46
eH1_7                 1.008445e-01 1 1  ON 47
eH1_8                 9.751197e-03 1 1  ON 48
eH1_9                -1.654055e-02 1 1  ON 49
eH2_0                -1.864265e-01 1 1  ON 50
eH2_1                -9.919848e-02 1 1  ON 51
eH2_2                -6.568080e-02 1 1  ON 52
eH2_3                -5.012236e-02 1 1  ON 53
eH2_4                 1.086158e-02 1 1  ON 54
eH2_5                 6.799688e-02 1 1  ON 55
eH2_6                 1.238828e-01 1 1  ON 56
eH2_7                 9.910378e-02 1 1  ON 57
eH2_8                 7.675983e-03 1 1  ON 58
eH2_9                -1.004706e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.9124
    reference variance = 0.430349
====================================================
  Execution time = 4.4130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9808e-01
  Total weights = 2.0000e+06
  Execution time = 3.5551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497721369495
                                         uncertainty =       0.002870302024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497721369495
                                         uncertainty =       0.002870302024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498855728
  error estimate for blocks of size 2^( 2) =       0.000517023692
  error estimate for blocks of size 2^( 3) =       0.000532642869
  error estimate for blocks of size 2^( 4) =       0.000543388051
  error estimate for blocks of size 2^( 5) =       0.000549176506
  error estimate for blocks of size 2^( 6) =       0.000551701058
  error estimate for blocks of size 2^( 7) =       0.000553441713

      target function =                  N/A
              le_mean =     -22.825741902109
             les_mean =     521.512207208253
             stat err =       0.000549426832
             autocorr =       1.213025141848
              std dev =       0.705488536716
             le_variance =       0.497714075438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498672182594
                                         uncertainty =       0.002870287480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498672182594
                                         uncertainty =       0.002870287480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499332073
  error estimate for blocks of size 2^( 2) =       0.000517482565
  error estimate for blocks of size 2^( 3) =       0.000533067741
  error estimate for blocks of size 2^( 4) =       0.000543782952
  error estimate for blocks of size 2^( 5) =       0.000549534369
  error estimate for blocks of size 2^( 6) =       0.000552022219
  error estimate for blocks of size 2^( 7) =       0.000553775698

      target function =                  N/A
              le_mean =     -22.825748391996
             les_mean =     521.513454444545
             stat err =       0.000549778809
             autocorr =       1.212263605887
              std dev =       0.706162190421
             le_variance =       0.498665039180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498469790119
                                         uncertainty =       0.002867934673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498469790119
                                         uncertainty =       0.002867934673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499230798
  error estimate for blocks of size 2^( 2) =       0.000517388671
  error estimate for blocks of size 2^( 3) =       0.000532980523
  error estimate for blocks of size 2^( 4) =       0.000543700551
  error estimate for blocks of size 2^( 5) =       0.000549452642
  error estimate for blocks of size 2^( 6) =       0.000551939355
  error estimate for blocks of size 2^( 7) =       0.000553689350

      target function =                  N/A
              le_mean =     -22.825748728412
             les_mean =     521.513267542299
             stat err =       0.000549695475
             autocorr =       1.212387875299
              std dev =       0.706018964978
             le_variance =       0.498462778908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497800691075
                                         uncertainty =       0.002869494275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497800691075
                                         uncertainty =       0.002869494275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498895516
  error estimate for blocks of size 2^( 2) =       0.000517062901
  error estimate for blocks of size 2^( 3) =       0.000532678168
  error estimate for blocks of size 2^( 4) =       0.000543419723
  error estimate for blocks of size 2^( 5) =       0.000549201731
  error estimate for blocks of size 2^( 6) =       0.000551719108
  error estimate for blocks of size 2^( 7) =       0.000553461250

      target function =                  N/A
              le_mean =     -22.825741777485
             les_mean =     521.512280915805
             stat err =       0.000549450453
             autocorr =       1.212935955548
              std dev =       0.705544805285
             le_variance =       0.497793472265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825741902109        initial
     6.2500e-02     6.2500e-01             3.3616e-03       -22.825748391996
     2.5000e-01     2.5000e+00             1.3432e-03       -22.825748728412  <--
     1.0000e+00     1.0000e+01             4.5032e-04       -22.825741777485

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.1953e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.675290e-01 1 1  ON 0
 uu_1                 9.414184e-02 1 1  ON 1
 uu_2                -1.704383e-02 1 1  ON 2
 uu_3                -8.214836e-02 1 1  ON 3
 uu_4                -1.195567e-01 1 1  ON 4
 uu_5                -1.418141e-01 1 1  ON 5
 uu_6                -1.546595e-01 1 1  ON 6
 uu_7                -1.563512e-01 1 1  ON 7
 uu_8                -1.454598e-01 1 1  ON 8
 uu_9                -1.138363e-01 1 1  ON 9
 ud_0                 4.388774e-01 1 1  ON 10
 ud_1                 1.568802e-01 1 1  ON 11
 ud_2                 1.133631e-02 1 1  ON 12
 ud_3                -6.841764e-02 1 1  ON 13
 ud_4                -1.152367e-01 1 1  ON 14
 ud_5                -1.445934e-01 1 1  ON 15
 ud_6                -1.620496e-01 1 1  ON 16
 ud_7                -1.678497e-01 1 1  ON 17
 ud_8                -1.584392e-01 1 1  ON 18
 ud_9                -1.292131e-01 1 1  ON 19
 eC_0                -5.619503e-01 1 1  ON 20
 eC_1                -4.080122e-01 1 1  ON 21
 eC_2                -1.596609e-01 1 1  ON 22
 eC_3                -1.521711e-02 1 1  ON 23
 eC_4                 3.165721e-02 1 1  ON 24
 eC_5                 1.167746e-01 1 1  ON 25
 eC_6                 2.350323e-01 1 1  ON 26
 eC_7                 3.970364e-01 1 1  ON 27
 eC_8                 2.830806e-01 1 1  ON 28
 eC_9                 7.467510e-02 1 1  ON 29
 eO_0                -1.240471e+00 1 1  ON 30
 eO_1                -8.625532e-01 1 1  ON 31
 eO_2                -3.839202e-01 1 1  ON 32
 eO_3                -4.019945e-02 1 1  ON 33
 eO_4                 1.876603e-01 1 1  ON 34
 eO_5                 3.712994e-01 1 1  ON 35
 eO_6                 4.612259e-01 1 1  ON 36
 eO_7                 5.226056e-01 1 1  ON 37
 eO_8                 4.808182e-01 1 1  ON 38
 eO_9                 3.300075e-01 1 1  ON 39
eH1_0                -1.848059e-01 1 1  ON 40
eH1_1                -9.711519e-02 1 1  ON 41
eH1_2                -6.430898e-02 1 1  ON 42
eH1_3                -4.850254e-02 1 1  ON 43
eH1_4                 1.239079e-02 1 1  ON 44
eH1_5                 6.923745e-02 1 1  ON 45
eH1_6                 1.256267e-01 1 1  ON 46
eH1_7                 1.008445e-01 1 1  ON 47
eH1_8                 9.751197e-03 1 1  ON 48
eH1_9                -1.654055e-02 1 1  ON 49
eH2_0                -1.864265e-01 1 1  ON 50
eH2_1                -9.919848e-02 1 1  ON 51
eH2_2                -6.568080e-02 1 1  ON 52
eH2_3                -5.012236e-02 1 1  ON 53
eH2_4                 1.086158e-02 1 1  ON 54
eH2_5                 6.799688e-02 1 1  ON 55
eH2_6                 1.238828e-01 1 1  ON 56
eH2_7                 9.910378e-02 1 1  ON 57
eH2_8                 7.675983e-03 1 1  ON 58
eH2_9                -1.004706e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2166e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2861e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.884
    reference variance = 0.332693
====================================================
  Execution time = 4.4227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9832e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5502e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498385840117
                                         uncertainty =       0.003453962573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498385840117
                                         uncertainty =       0.003453962573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499160131
  error estimate for blocks of size 2^( 2) =       0.000517192914
  error estimate for blocks of size 2^( 3) =       0.000533133506
  error estimate for blocks of size 2^( 4) =       0.000545108393
  error estimate for blocks of size 2^( 5) =       0.000552159758
  error estimate for blocks of size 2^( 6) =       0.000558690687
  error estimate for blocks of size 2^( 7) =       0.000560857461

      target function =                  N/A
              le_mean =     -22.825380786652
             les_mean =     521.496329479858
             stat err =       0.000554204075
             autocorr =       1.232706393723
              std dev =       0.705919027490
             le_variance =       0.498321673373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282538078665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825380786652       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825381838617       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825385363631       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825388579960       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825389538208       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825388248412       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825389880196       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825390567288       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825390931844       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825391894048       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825391371733       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825391492968       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825391662082       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825392002832       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825392032825       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825392025071       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825392129352       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825392192406       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 2.104446e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825380786652       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825381336343       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825383795198       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825385416772       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825385900527       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825385150493       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825385906336       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825386241657       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825386210740       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825386671405       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825386515222       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825386451856       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825386454150       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 6.662132e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825380786652       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825380975559       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825382052822       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825382590901       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825382762341       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825382498253       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825382775656       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825382822711       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825382847045       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825382928169       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.885265e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022838 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9740e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.679398e-01 1 1  ON 0
 uu_1                 9.431698e-02 1 1  ON 1
 uu_2                -1.687588e-02 1 1  ON 2
 uu_3                -8.211204e-02 1 1  ON 3
 uu_4                -1.196278e-01 1 1  ON 4
 uu_5                -1.420101e-01 1 1  ON 5
 uu_6                -1.547254e-01 1 1  ON 6
 uu_7                -1.566388e-01 1 1  ON 7
 uu_8                -1.456919e-01 1 1  ON 8
 uu_9                -1.138280e-01 1 1  ON 9
 ud_0                 4.388975e-01 1 1  ON 10
 ud_1                 1.568355e-01 1 1  ON 11
 ud_2                 1.122887e-02 1 1  ON 12
 ud_3                -6.841651e-02 1 1  ON 13
 ud_4                -1.152048e-01 1 1  ON 14
 ud_5                -1.444110e-01 1 1  ON 15
 ud_6                -1.617506e-01 1 1  ON 16
 ud_7                -1.678197e-01 1 1  ON 17
 ud_8                -1.584085e-01 1 1  ON 18
 ud_9                -1.292411e-01 1 1  ON 19
 eC_0                -5.623624e-01 1 1  ON 20
 eC_1                -4.082178e-01 1 1  ON 21
 eC_2                -1.597590e-01 1 1  ON 22
 eC_3                -1.508899e-02 1 1  ON 23
 eC_4                 3.195261e-02 1 1  ON 24
 eC_5                 1.168829e-01 1 1  ON 25
 eC_6                 2.346414e-01 1 1  ON 26
 eC_7                 3.969440e-01 1 1  ON 27
 eC_8                 2.835145e-01 1 1  ON 28
 eC_9                 7.486668e-02 1 1  ON 29
 eO_0                -1.241137e+00 1 1  ON 30
 eO_1                -8.629074e-01 1 1  ON 31
 eO_2                -3.842179e-01 1 1  ON 32
 eO_3                -3.993062e-02 1 1  ON 33
 eO_4                 1.876615e-01 1 1  ON 34
 eO_5                 3.712118e-01 1 1  ON 35
 eO_6                 4.615022e-01 1 1  ON 36
 eO_7                 5.225586e-01 1 1  ON 37
 eO_8                 4.809588e-01 1 1  ON 38
 eO_9                 3.303939e-01 1 1  ON 39
eH1_0                -1.848325e-01 1 1  ON 40
eH1_1                -9.744599e-02 1 1  ON 41
eH1_2                -6.428135e-02 1 1  ON 42
eH1_3                -4.877331e-02 1 1  ON 43
eH1_4                 1.247050e-02 1 1  ON 44
eH1_5                 6.937386e-02 1 1  ON 45
eH1_6                 1.259446e-01 1 1  ON 46
eH1_7                 1.010131e-01 1 1  ON 47
eH1_8                 9.707677e-03 1 1  ON 48
eH1_9                -1.670884e-02 1 1  ON 49
eH2_0                -1.865884e-01 1 1  ON 50
eH2_1                -9.962452e-02 1 1  ON 51
eH2_2                -6.555690e-02 1 1  ON 52
eH2_3                -4.981773e-02 1 1  ON 53
eH2_4                 1.113066e-02 1 1  ON 54
eH2_5                 6.809013e-02 1 1  ON 55
eH2_6                 1.239202e-01 1 1  ON 56
eH2_7                 9.877637e-02 1 1  ON 57
eH2_8                 7.634643e-03 1 1  ON 58
eH2_9                -1.011045e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.9077
    reference variance = 0.632773
====================================================
  Execution time = 4.3277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2827e+01
  VMC Evar = 5.0857e-01
  Total weights = 2.0000e+06
  Execution time = 3.5486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508344612963
                                         uncertainty =       0.004581765832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508344612963
                                         uncertainty =       0.004581765832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504151166
  error estimate for blocks of size 2^( 2) =       0.000522120006
  error estimate for blocks of size 2^( 3) =       0.000537797822
  error estimate for blocks of size 2^( 4) =       0.000548495340
  error estimate for blocks of size 2^( 5) =       0.000554909244
  error estimate for blocks of size 2^( 6) =       0.000556325449
  error estimate for blocks of size 2^( 7) =       0.000557544645

      target function =                  N/A
              le_mean =     -22.826923373285
             les_mean =     521.576767231076
             stat err =       0.000554318670
             autocorr =       1.208919717432
              std dev =       0.712977415777
             le_variance =       0.508336795408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508812952297
                                         uncertainty =       0.004586615542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508812952297
                                         uncertainty =       0.004586615542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504383360
  error estimate for blocks of size 2^( 2) =       0.000522336987
  error estimate for blocks of size 2^( 3) =       0.000537998440
  error estimate for blocks of size 2^( 4) =       0.000548693758
  error estimate for blocks of size 2^( 5) =       0.000555101139
  error estimate for blocks of size 2^( 6) =       0.000556518643
  error estimate for blocks of size 2^( 7) =       0.000557730166

      target function =                  N/A
              le_mean =     -22.826922698158
             les_mean =     521.577204760129
             stat err =       0.000554510927
             autocorr =       1.208644880103
              std dev =       0.713305787744
             le_variance =       0.508805146830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508825006468
                                         uncertainty =       0.004586924671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508825006468
                                         uncertainty =       0.004586924671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504389334
  error estimate for blocks of size 2^( 2) =       0.000522340717
  error estimate for blocks of size 2^( 3) =       0.000538001778
  error estimate for blocks of size 2^( 4) =       0.000548697843
  error estimate for blocks of size 2^( 5) =       0.000555105373
  error estimate for blocks of size 2^( 6) =       0.000556523873
  error estimate for blocks of size 2^( 7) =       0.000557734797

      target function =                  N/A
              le_mean =     -22.826923169342
             les_mean =     521.577238324883
             stat err =       0.000554515472
             autocorr =       1.208636060489
              std dev =       0.713314236690
             le_variance =       0.508817200265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508434235944
                                         uncertainty =       0.004582666233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508434235944
                                         uncertainty =       0.004582666233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504195608
  error estimate for blocks of size 2^( 2) =       0.000522160651
  error estimate for blocks of size 2^( 3) =       0.000537834969
  error estimate for blocks of size 2^( 4) =       0.000548532062
  error estimate for blocks of size 2^( 5) =       0.000554944499
  error estimate for blocks of size 2^( 6) =       0.000556360912
  error estimate for blocks of size 2^( 7) =       0.000557579182

      target function =                  N/A
              le_mean =     -22.826922732829
             les_mean =     521.576827619158
             stat err =       0.000554354163
             autocorr =       1.208861399723
              std dev =       0.713040267323
             le_variance =       0.508426422824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826923373285        initial  <--
     6.2500e-02     6.2500e-01             2.1044e-03       -22.826922698158
     2.5000e-01     2.5000e+00             6.6621e-04       -22.826923169342
     1.0000e+00     1.0000e+01             1.8853e-04       -22.826922732829

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0760
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.675290e-01 1 1  ON 0
 uu_1                 9.414184e-02 1 1  ON 1
 uu_2                -1.704383e-02 1 1  ON 2
 uu_3                -8.214836e-02 1 1  ON 3
 uu_4                -1.195567e-01 1 1  ON 4
 uu_5                -1.418141e-01 1 1  ON 5
 uu_6                -1.546595e-01 1 1  ON 6
 uu_7                -1.563512e-01 1 1  ON 7
 uu_8                -1.454598e-01 1 1  ON 8
 uu_9                -1.138363e-01 1 1  ON 9
 ud_0                 4.388774e-01 1 1  ON 10
 ud_1                 1.568802e-01 1 1  ON 11
 ud_2                 1.133631e-02 1 1  ON 12
 ud_3                -6.841764e-02 1 1  ON 13
 ud_4                -1.152367e-01 1 1  ON 14
 ud_5                -1.445934e-01 1 1  ON 15
 ud_6                -1.620496e-01 1 1  ON 16
 ud_7                -1.678497e-01 1 1  ON 17
 ud_8                -1.584392e-01 1 1  ON 18
 ud_9                -1.292131e-01 1 1  ON 19
 eC_0                -5.619503e-01 1 1  ON 20
 eC_1                -4.080122e-01 1 1  ON 21
 eC_2                -1.596609e-01 1 1  ON 22
 eC_3                -1.521711e-02 1 1  ON 23
 eC_4                 3.165721e-02 1 1  ON 24
 eC_5                 1.167746e-01 1 1  ON 25
 eC_6                 2.350323e-01 1 1  ON 26
 eC_7                 3.970364e-01 1 1  ON 27
 eC_8                 2.830806e-01 1 1  ON 28
 eC_9                 7.467510e-02 1 1  ON 29
 eO_0                -1.240471e+00 1 1  ON 30
 eO_1                -8.625532e-01 1 1  ON 31
 eO_2                -3.839202e-01 1 1  ON 32
 eO_3                -4.019945e-02 1 1  ON 33
 eO_4                 1.876603e-01 1 1  ON 34
 eO_5                 3.712994e-01 1 1  ON 35
 eO_6                 4.612259e-01 1 1  ON 36
 eO_7                 5.226056e-01 1 1  ON 37
 eO_8                 4.808182e-01 1 1  ON 38
 eO_9                 3.300075e-01 1 1  ON 39
eH1_0                -1.848059e-01 1 1  ON 40
eH1_1                -9.711519e-02 1 1  ON 41
eH1_2                -6.430898e-02 1 1  ON 42
eH1_3                -4.850254e-02 1 1  ON 43
eH1_4                 1.239079e-02 1 1  ON 44
eH1_5                 6.923745e-02 1 1  ON 45
eH1_6                 1.256267e-01 1 1  ON 46
eH1_7                 1.008445e-01 1 1  ON 47
eH1_8                 9.751197e-03 1 1  ON 48
eH1_9                -1.654055e-02 1 1  ON 49
eH2_0                -1.864265e-01 1 1  ON 50
eH2_1                -9.919848e-02 1 1  ON 51
eH2_2                -6.568080e-02 1 1  ON 52
eH2_3                -5.012236e-02 1 1  ON 53
eH2_4                 1.086158e-02 1 1  ON 54
eH2_5                 6.799688e-02 1 1  ON 55
eH2_6                 1.238828e-01 1 1  ON 56
eH2_7                 9.910378e-02 1 1  ON 57
eH2_8                 7.675983e-03 1 1  ON 58
eH2_9                -1.004706e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2082e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2873e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8004
    reference variance = 0.230947
====================================================
  Execution time = 4.5846e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1114e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4912e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511174955769
                                         uncertainty =       0.006205994260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511174955769
                                         uncertainty =       0.006205994260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505540728
  error estimate for blocks of size 2^( 2) =       0.000523840186
  error estimate for blocks of size 2^( 3) =       0.000539389116
  error estimate for blocks of size 2^( 4) =       0.000550600010
  error estimate for blocks of size 2^( 5) =       0.000557650189
  error estimate for blocks of size 2^( 6) =       0.000562793552
  error estimate for blocks of size 2^( 7) =       0.000565425382

      target function =                  N/A
              le_mean =     -22.825053512808
             les_mean =     521.494210462377
             stat err =       0.000559117283
             autocorr =       1.223188911393
              std dev =       0.714942553911
             le_variance =       0.511142855393


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282505351281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825053512808       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825054131560       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825054793254       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825055189188       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825055532210       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825055287150       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825054847267       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825055213633       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825055411800       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825055453347       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825055406953       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825055412234       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.335529e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825053512808       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825053691957       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825053870777       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825053998953       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825054110980       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825054076614       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825053977494       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825054024496       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825054075062       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825054089326       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 8.555116e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825053512808       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825053559439       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825053605374       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825053640091       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825053670080       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825053663301       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825053642848       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825053651541       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825053659069       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825053664599       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 2.166517e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0766e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.675898e-01 1 1  ON 0
 uu_1                 9.410761e-02 1 1  ON 1
 uu_2                -1.706507e-02 1 1  ON 2
 uu_3                -8.218035e-02 1 1  ON 3
 uu_4                -1.195462e-01 1 1  ON 4
 uu_5                -1.418494e-01 1 1  ON 5
 uu_6                -1.546303e-01 1 1  ON 6
 uu_7                -1.563975e-01 1 1  ON 7
 uu_8                -1.454420e-01 1 1  ON 8
 uu_9                -1.138059e-01 1 1  ON 9
 ud_0                 4.389130e-01 1 1  ON 10
 ud_1                 1.568966e-01 1 1  ON 11
 ud_2                 1.131567e-02 1 1  ON 12
 ud_3                -6.843079e-02 1 1  ON 13
 ud_4                -1.152524e-01 1 1  ON 14
 ud_5                -1.445907e-01 1 1  ON 15
 ud_6                -1.621093e-01 1 1  ON 16
 ud_7                -1.678206e-01 1 1  ON 17
 ud_8                -1.584006e-01 1 1  ON 18
 ud_9                -1.292012e-01 1 1  ON 19
 eC_0                -5.619298e-01 1 1  ON 20
 eC_1                -4.080833e-01 1 1  ON 21
 eC_2                -1.596886e-01 1 1  ON 22
 eC_3                -1.519192e-02 1 1  ON 23
 eC_4                 3.168004e-02 1 1  ON 24
 eC_5                 1.167450e-01 1 1  ON 25
 eC_6                 2.350151e-01 1 1  ON 26
 eC_7                 3.970347e-01 1 1  ON 27
 eC_8                 2.831342e-01 1 1  ON 28
 eC_9                 7.469796e-02 1 1  ON 29
 eO_0                -1.240556e+00 1 1  ON 30
 eO_1                -8.626056e-01 1 1  ON 31
 eO_2                -3.839363e-01 1 1  ON 32
 eO_3                -4.019173e-02 1 1  ON 33
 eO_4                 1.876603e-01 1 1  ON 34
 eO_5                 3.713337e-01 1 1  ON 35
 eO_6                 4.612321e-01 1 1  ON 36
 eO_7                 5.226243e-01 1 1  ON 37
 eO_8                 4.808220e-01 1 1  ON 38
 eO_9                 3.300495e-01 1 1  ON 39
eH1_0                -1.847830e-01 1 1  ON 40
eH1_1                -9.713824e-02 1 1  ON 41
eH1_2                -6.429585e-02 1 1  ON 42
eH1_3                -4.846719e-02 1 1  ON 43
eH1_4                 1.242221e-02 1 1  ON 44
eH1_5                 6.920712e-02 1 1  ON 45
eH1_6                 1.255787e-01 1 1  ON 46
eH1_7                 1.008134e-01 1 1  ON 47
eH1_8                 9.766019e-03 1 1  ON 48
eH1_9                -1.654391e-02 1 1  ON 49
eH2_0                -1.865098e-01 1 1  ON 50
eH2_1                -9.919036e-02 1 1  ON 51
eH2_2                -6.567566e-02 1 1  ON 52
eH2_3                -5.011239e-02 1 1  ON 53
eH2_4                 1.085096e-02 1 1  ON 54
eH2_5                 6.796665e-02 1 1  ON 55
eH2_6                 1.239201e-01 1 1  ON 56
eH2_7                 9.915341e-02 1 1  ON 57
eH2_8                 7.694802e-03 1 1  ON 58
eH2_9                -1.006709e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.741
    reference variance = 0.821487
====================================================
  Execution time = 4.3089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0873e-01
  Total weights = 2.0000e+06
  Execution time = 3.5485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508576875135
                                         uncertainty =       0.005516591539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508576875135
                                         uncertainty =       0.005516591539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504302933
  error estimate for blocks of size 2^( 2) =       0.000521754070
  error estimate for blocks of size 2^( 3) =       0.000537309635
  error estimate for blocks of size 2^( 4) =       0.000547972910
  error estimate for blocks of size 2^( 5) =       0.000554375372
  error estimate for blocks of size 2^( 6) =       0.000558861099
  error estimate for blocks of size 2^( 7) =       0.000558758223

      target function =                  N/A
              le_mean =     -22.826370634666
             les_mean =     521.551838993265
             stat err =       0.000554991901
             autocorr =       1.211128719691
              std dev =       0.713192047383
             le_variance =       0.508642896451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508838119686
                                         uncertainty =       0.005517940113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508838119686
                                         uncertainty =       0.005517940113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504432423
  error estimate for blocks of size 2^( 2) =       0.000521876618
  error estimate for blocks of size 2^( 3) =       0.000537424400
  error estimate for blocks of size 2^( 4) =       0.000548083855
  error estimate for blocks of size 2^( 5) =       0.000554479168
  error estimate for blocks of size 2^( 6) =       0.000558966417
  error estimate for blocks of size 2^( 7) =       0.000558854628

      target function =                  N/A
              le_mean =     -22.826368779690
             les_mean =     521.552015550076
             stat err =       0.000555096017
             autocorr =       1.210961220609
              std dev =       0.713375173458
             le_variance =       0.508904138106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508751138854
                                         uncertainty =       0.005517945464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508751138854
                                         uncertainty =       0.005517945464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504389307
  error estimate for blocks of size 2^( 2) =       0.000521835666
  error estimate for blocks of size 2^( 3) =       0.000537385830
  error estimate for blocks of size 2^( 4) =       0.000548046447
  error estimate for blocks of size 2^( 5) =       0.000554443972
  error estimate for blocks of size 2^( 6) =       0.000558931280
  error estimate for blocks of size 2^( 7) =       0.000558822311

      target function =                  N/A
              le_mean =     -22.826369329140
             les_mean =     521.551953642568
             stat err =       0.000555061003
             autocorr =       1.211015464051
              std dev =       0.713314199137
             le_variance =       0.508817146690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508600313165
                                         uncertainty =       0.005516781747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508600313165
                                         uncertainty =       0.005516781747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504314551
  error estimate for blocks of size 2^( 2) =       0.000521765030
  error estimate for blocks of size 2^( 3) =       0.000537319843
  error estimate for blocks of size 2^( 4) =       0.000547982743
  error estimate for blocks of size 2^( 5) =       0.000554384516
  error estimate for blocks of size 2^( 6) =       0.000558870488
  error estimate for blocks of size 2^( 7) =       0.000558766773

      target function =                  N/A
              le_mean =     -22.826370434234
             les_mean =     521.551853278483
             stat err =       0.000555001130
             autocorr =       1.211113199498
              std dev =       0.713208477207
             le_variance =       0.508666331960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826370634666        initial  <--
     6.2500e-01     6.2500e+00             3.3355e-04       -22.826368779690
     2.5000e+00     2.5000e+01             8.5551e-05       -22.826369329140
     1.0000e+01     1.0000e+02             2.1665e-05       -22.826370434234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8637
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.675290e-01 1 1  ON 0
 uu_1                 9.414184e-02 1 1  ON 1
 uu_2                -1.704383e-02 1 1  ON 2
 uu_3                -8.214836e-02 1 1  ON 3
 uu_4                -1.195567e-01 1 1  ON 4
 uu_5                -1.418141e-01 1 1  ON 5
 uu_6                -1.546595e-01 1 1  ON 6
 uu_7                -1.563512e-01 1 1  ON 7
 uu_8                -1.454598e-01 1 1  ON 8
 uu_9                -1.138363e-01 1 1  ON 9
 ud_0                 4.388774e-01 1 1  ON 10
 ud_1                 1.568802e-01 1 1  ON 11
 ud_2                 1.133631e-02 1 1  ON 12
 ud_3                -6.841764e-02 1 1  ON 13
 ud_4                -1.152367e-01 1 1  ON 14
 ud_5                -1.445934e-01 1 1  ON 15
 ud_6                -1.620496e-01 1 1  ON 16
 ud_7                -1.678497e-01 1 1  ON 17
 ud_8                -1.584392e-01 1 1  ON 18
 ud_9                -1.292131e-01 1 1  ON 19
 eC_0                -5.619503e-01 1 1  ON 20
 eC_1                -4.080122e-01 1 1  ON 21
 eC_2                -1.596609e-01 1 1  ON 22
 eC_3                -1.521711e-02 1 1  ON 23
 eC_4                 3.165721e-02 1 1  ON 24
 eC_5                 1.167746e-01 1 1  ON 25
 eC_6                 2.350323e-01 1 1  ON 26
 eC_7                 3.970364e-01 1 1  ON 27
 eC_8                 2.830806e-01 1 1  ON 28
 eC_9                 7.467510e-02 1 1  ON 29
 eO_0                -1.240471e+00 1 1  ON 30
 eO_1                -8.625532e-01 1 1  ON 31
 eO_2                -3.839202e-01 1 1  ON 32
 eO_3                -4.019945e-02 1 1  ON 33
 eO_4                 1.876603e-01 1 1  ON 34
 eO_5                 3.712994e-01 1 1  ON 35
 eO_6                 4.612259e-01 1 1  ON 36
 eO_7                 5.226056e-01 1 1  ON 37
 eO_8                 4.808182e-01 1 1  ON 38
 eO_9                 3.300075e-01 1 1  ON 39
eH1_0                -1.848059e-01 1 1  ON 40
eH1_1                -9.711519e-02 1 1  ON 41
eH1_2                -6.430898e-02 1 1  ON 42
eH1_3                -4.850254e-02 1 1  ON 43
eH1_4                 1.239079e-02 1 1  ON 44
eH1_5                 6.923745e-02 1 1  ON 45
eH1_6                 1.256267e-01 1 1  ON 46
eH1_7                 1.008445e-01 1 1  ON 47
eH1_8                 9.751197e-03 1 1  ON 48
eH1_9                -1.654055e-02 1 1  ON 49
eH2_0                -1.864265e-01 1 1  ON 50
eH2_1                -9.919848e-02 1 1  ON 51
eH2_2                -6.568080e-02 1 1  ON 52
eH2_3                -5.012236e-02 1 1  ON 53
eH2_4                 1.086158e-02 1 1  ON 54
eH2_5                 6.799688e-02 1 1  ON 55
eH2_6                 1.238828e-01 1 1  ON 56
eH2_7                 9.910378e-02 1 1  ON 57
eH2_8                 7.675983e-03 1 1  ON 58
eH2_9                -1.004706e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2170e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2847e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.9456
    reference variance = 1.18083
====================================================
  Execution time = 4.4504e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.1607e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5028e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516142268668
                                         uncertainty =       0.017406583256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516142268668
                                         uncertainty =       0.017406583256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507970265
  error estimate for blocks of size 2^( 2) =       0.000525553503
  error estimate for blocks of size 2^( 3) =       0.000540785253
  error estimate for blocks of size 2^( 4) =       0.000551380429
  error estimate for blocks of size 2^( 5) =       0.000558053054
  error estimate for blocks of size 2^( 6) =       0.000560158113
  error estimate for blocks of size 2^( 7) =       0.000561621057

      target function =                  N/A
              le_mean =     -22.824108745452
             les_mean =     521.456007346928
             stat err =       0.000557803163
             autocorr =       1.205827998800
              std dev =       0.718378438375
             le_variance =       0.516067580722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282410874545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824108745452       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824108751643       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824108730556       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824108851167       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824109021795       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824109068275       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824109075614       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824109084229       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824109101747       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824109110827       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 6.984106e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824108745452       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824108747043       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824108741303       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824108770817       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824108814264       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824108828875       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824108831110       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824108832832       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824108837940       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824108840331       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 1.841673e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824108745452       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824108745853       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824108744387       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824108751721       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824108762627       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824108766483       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824108767076       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824108767485       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824108768803       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824108769413       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 4.668737e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030686 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9540e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.675386e-01 1 1  ON 0
 uu_1                 9.413914e-02 1 1  ON 1
 uu_2                -1.704309e-02 1 1  ON 2
 uu_3                -8.215175e-02 1 1  ON 3
 uu_4                -1.195572e-01 1 1  ON 4
 uu_5                -1.418174e-01 1 1  ON 5
 uu_6                -1.546578e-01 1 1  ON 6
 uu_7                -1.563521e-01 1 1  ON 7
 uu_8                -1.454562e-01 1 1  ON 8
 uu_9                -1.138375e-01 1 1  ON 9
 ud_0                 4.388958e-01 1 1  ON 10
 ud_1                 1.568788e-01 1 1  ON 11
 ud_2                 1.133647e-02 1 1  ON 12
 ud_3                -6.842109e-02 1 1  ON 13
 ud_4                -1.152335e-01 1 1  ON 14
 ud_5                -1.445935e-01 1 1  ON 15
 ud_6                -1.620582e-01 1 1  ON 16
 ud_7                -1.678480e-01 1 1  ON 17
 ud_8                -1.584354e-01 1 1  ON 18
 ud_9                -1.292172e-01 1 1  ON 19
 eC_0                -5.619536e-01 1 1  ON 20
 eC_1                -4.080134e-01 1 1  ON 21
 eC_2                -1.596627e-01 1 1  ON 22
 eC_3                -1.521325e-02 1 1  ON 23
 eC_4                 3.166102e-02 1 1  ON 24
 eC_5                 1.167720e-01 1 1  ON 25
 eC_6                 2.350290e-01 1 1  ON 26
 eC_7                 3.970357e-01 1 1  ON 27
 eC_8                 2.830842e-01 1 1  ON 28
 eC_9                 7.467656e-02 1 1  ON 29
 eO_0                -1.240472e+00 1 1  ON 30
 eO_1                -8.625652e-01 1 1  ON 31
 eO_2                -3.839217e-01 1 1  ON 32
 eO_3                -4.019800e-02 1 1  ON 33
 eO_4                 1.876610e-01 1 1  ON 34
 eO_5                 3.713033e-01 1 1  ON 35
 eO_6                 4.612299e-01 1 1  ON 36
 eO_7                 5.226052e-01 1 1  ON 37
 eO_8                 4.808180e-01 1 1  ON 38
 eO_9                 3.300102e-01 1 1  ON 39
eH1_0                -1.848049e-01 1 1  ON 40
eH1_1                -9.711330e-02 1 1  ON 41
eH1_2                -6.430733e-02 1 1  ON 42
eH1_3                -4.850217e-02 1 1  ON 43
eH1_4                 1.239567e-02 1 1  ON 44
eH1_5                 6.923471e-02 1 1  ON 45
eH1_6                 1.256242e-01 1 1  ON 46
eH1_7                 1.008414e-01 1 1  ON 47
eH1_8                 9.750978e-03 1 1  ON 48
eH1_9                -1.654243e-02 1 1  ON 49
eH2_0                -1.864265e-01 1 1  ON 50
eH2_1                -9.919751e-02 1 1  ON 51
eH2_2                -6.568727e-02 1 1  ON 52
eH2_3                -5.012238e-02 1 1  ON 53
eH2_4                 1.086431e-02 1 1  ON 54
eH2_5                 6.799432e-02 1 1  ON 55
eH2_6                 1.238841e-01 1 1  ON 56
eH2_7                 9.910518e-02 1 1  ON 57
eH2_8                 7.679459e-03 1 1  ON 58
eH2_9                -1.004852e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8275
    reference variance = 0.854807
====================================================
  Execution time = 4.3301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0030e-01
  Total weights = 2.0000e+06
  Execution time = 3.5611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500336056573
                                         uncertainty =       0.003144546005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500336056573
                                         uncertainty =       0.003144546005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500137446
  error estimate for blocks of size 2^( 2) =       0.000517936378
  error estimate for blocks of size 2^( 3) =       0.000534057053
  error estimate for blocks of size 2^( 4) =       0.000545971676
  error estimate for blocks of size 2^( 5) =       0.000553114346
  error estimate for blocks of size 2^( 6) =       0.000556413768
  error estimate for blocks of size 2^( 7) =       0.000556209629

      target function =                  N/A
              le_mean =     -22.826168417501
             les_mean =     521.534239303651
             stat err =       0.000552927355
             autocorr =       1.222242576151
              std dev =       0.707301159091
             le_variance =       0.500274929652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500420067644
                                         uncertainty =       0.003145278177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500420067644
                                         uncertainty =       0.003145278177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500179420
  error estimate for blocks of size 2^( 2) =       0.000517976208
  error estimate for blocks of size 2^( 3) =       0.000534094884
  error estimate for blocks of size 2^( 4) =       0.000546008369
  error estimate for blocks of size 2^( 5) =       0.000553150259
  error estimate for blocks of size 2^( 6) =       0.000556449457
  error estimate for blocks of size 2^( 7) =       0.000556245343

      target function =                  N/A
              le_mean =     -22.826168578658
             les_mean =     521.534330635067
             stat err =       0.000552963357
             autocorr =       1.222196594857
              std dev =       0.707360519051
             le_variance =       0.500358903912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500380202199
                                         uncertainty =       0.003144932418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500380202199
                                         uncertainty =       0.003144932418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500159502
  error estimate for blocks of size 2^( 2) =       0.000517957309
  error estimate for blocks of size 2^( 3) =       0.000534076931
  error estimate for blocks of size 2^( 4) =       0.000545990961
  error estimate for blocks of size 2^( 5) =       0.000553133214
  error estimate for blocks of size 2^( 6) =       0.000556432516
  error estimate for blocks of size 2^( 7) =       0.000556228397

      target function =                  N/A
              le_mean =     -22.826168500040
             les_mean =     521.534287197819
             stat err =       0.000552946272
             autocorr =       1.222218406882
              std dev =       0.707332351696
             le_variance =       0.500319055756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500341642884
                                         uncertainty =       0.003144594985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500341642884
                                         uncertainty =       0.003144594985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500140237
  error estimate for blocks of size 2^( 2) =       0.000517939027
  error estimate for blocks of size 2^( 3) =       0.000534059568
  error estimate for blocks of size 2^( 4) =       0.000545974116
  error estimate for blocks of size 2^( 5) =       0.000553116733
  error estimate for blocks of size 2^( 6) =       0.000556416140
  error estimate for blocks of size 2^( 7) =       0.000556212003

      target function =                  N/A
              le_mean =     -22.826168427552
             les_mean =     521.534245346333
             stat err =       0.000552929748
             autocorr =       1.222239515831
              std dev =       0.707305106361
             le_variance =       0.500280513485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826168417501        initial
     6.2500e+00     6.2500e+01             6.9841e-05       -22.826168578658  <--
     2.5000e+01     2.5000e+02             1.8417e-05       -22.826168500040
     1.0000e+02     1.0000e+03             4.6687e-06       -22.826168427552

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 6.1140e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.675660e-01 1 1  ON 0
 uu_1                 9.413160e-02 1 1  ON 1
 uu_2                -1.704129e-02 1 1  ON 2
 uu_3                -8.216127e-02 1 1  ON 3
 uu_4                -1.195591e-01 1 1  ON 4
 uu_5                -1.418266e-01 1 1  ON 5
 uu_6                -1.546531e-01 1 1  ON 6
 uu_7                -1.563545e-01 1 1  ON 7
 uu_8                -1.454452e-01 1 1  ON 8
 uu_9                -1.138408e-01 1 1  ON 9
 ud_0                 4.389473e-01 1 1  ON 10
 ud_1                 1.568760e-01 1 1  ON 11
 ud_2                 1.133707e-02 1 1  ON 12
 ud_3                -6.843021e-02 1 1  ON 13
 ud_4                -1.152243e-01 1 1  ON 14
 ud_5                -1.445936e-01 1 1  ON 15
 ud_6                -1.620827e-01 1 1  ON 16
 ud_7                -1.678433e-01 1 1  ON 17
 ud_8                -1.584240e-01 1 1  ON 18
 ud_9                -1.292294e-01 1 1  ON 19
 eC_0                -5.619633e-01 1 1  ON 20
 eC_1                -4.080170e-01 1 1  ON 21
 eC_2                -1.596677e-01 1 1  ON 22
 eC_3                -1.520191e-02 1 1  ON 23
 eC_4                 3.167261e-02 1 1  ON 24
 eC_5                 1.167644e-01 1 1  ON 25
 eC_6                 2.350191e-01 1 1  ON 26
 eC_7                 3.970335e-01 1 1  ON 27
 eC_8                 2.830947e-01 1 1  ON 28
 eC_9                 7.468094e-02 1 1  ON 29
 eO_0                -1.240479e+00 1 1  ON 30
 eO_1                -8.625995e-01 1 1  ON 31
 eO_2                -3.839266e-01 1 1  ON 32
 eO_3                -4.019380e-02 1 1  ON 33
 eO_4                 1.876637e-01 1 1  ON 34
 eO_5                 3.713150e-01 1 1  ON 35
 eO_6                 4.612417e-01 1 1  ON 36
 eO_7                 5.226043e-01 1 1  ON 37
 eO_8                 4.808174e-01 1 1  ON 38
 eO_9                 3.300184e-01 1 1  ON 39
eH1_0                -1.848019e-01 1 1  ON 40
eH1_1                -9.710760e-02 1 1  ON 41
eH1_2                -6.430257e-02 1 1  ON 42
eH1_3                -4.850078e-02 1 1  ON 43
eH1_4                 1.240963e-02 1 1  ON 44
eH1_5                 6.922700e-02 1 1  ON 45
eH1_6                 1.256167e-01 1 1  ON 46
eH1_7                 1.008319e-01 1 1  ON 47
eH1_8                 9.750349e-03 1 1  ON 48
eH1_9                -1.654803e-02 1 1  ON 49
eH2_0                -1.864266e-01 1 1  ON 50
eH2_1                -9.919473e-02 1 1  ON 51
eH2_2                -6.570631e-02 1 1  ON 52
eH2_3                -5.012245e-02 1 1  ON 53
eH2_4                 1.087200e-02 1 1  ON 54
eH2_5                 6.798698e-02 1 1  ON 55
eH2_6                 1.238876e-01 1 1  ON 56
eH2_7                 9.910942e-02 1 1  ON 57
eH2_8                 7.689888e-03 1 1  ON 58
eH2_9                -1.005286e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2069e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2855e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7872
    reference variance = 0.428531
====================================================
  Execution time = 4.4745e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.5995e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5828e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560070280442
                                         uncertainty =       0.058630225806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560070280442
                                         uncertainty =       0.058630225806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529126531
  error estimate for blocks of size 2^( 2) =       0.000546045601
  error estimate for blocks of size 2^( 3) =       0.000560673708
  error estimate for blocks of size 2^( 4) =       0.000571052218
  error estimate for blocks of size 2^( 5) =       0.000576844717
  error estimate for blocks of size 2^( 6) =       0.000581922219
  error estimate for blocks of size 2^( 7) =       0.000580771105

      target function =                  N/A
              le_mean =     -22.824825985395
             les_mean =     521.532630755157
             stat err =       0.000577647565
             autocorr =       1.191809430045
              std dev =       0.748297916331
             le_variance =       0.559949771586


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282482598539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824825985395       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824826432789       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824826429972       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824826363127       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824826278773       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824826351371       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824826423244       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824826285837       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824826376554       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824826337791       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.246852e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824825985395       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824826105563       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824826110762       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824826096762       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824826083906       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824826108913       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824826135889       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824826096778       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824826111543       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824826102129       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 3.225427e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824825985395       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824826016006       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824826017785       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824826014573       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824826012349       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824826019128       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824826026616       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824826016734       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824826019300       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824826017047       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 8.120592e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034340 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0580e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.675711e-01 1 1  ON 0
 uu_1                 9.413007e-02 1 1  ON 1
 uu_2                -1.703795e-02 1 1  ON 2
 uu_3                -8.218223e-02 1 1  ON 3
 uu_4                -1.195416e-01 1 1  ON 4
 uu_5                -1.418302e-01 1 1  ON 5
 uu_6                -1.546450e-01 1 1  ON 6
 uu_7                -1.563591e-01 1 1  ON 7
 uu_8                -1.454481e-01 1 1  ON 8
 uu_9                -1.138430e-01 1 1  ON 9
 ud_0                 4.389523e-01 1 1  ON 10
 ud_1                 1.568883e-01 1 1  ON 11
 ud_2                 1.133688e-02 1 1  ON 12
 ud_3                -6.842983e-02 1 1  ON 13
 ud_4                -1.152282e-01 1 1  ON 14
 ud_5                -1.445801e-01 1 1  ON 15
 ud_6                -1.620981e-01 1 1  ON 16
 ud_7                -1.678426e-01 1 1  ON 17
 ud_8                -1.584225e-01 1 1  ON 18
 ud_9                -1.292297e-01 1 1  ON 19
 eC_0                -5.619746e-01 1 1  ON 20
 eC_1                -4.080237e-01 1 1  ON 21
 eC_2                -1.596726e-01 1 1  ON 22
 eC_3                -1.519810e-02 1 1  ON 23
 eC_4                 3.167992e-02 1 1  ON 24
 eC_5                 1.167566e-01 1 1  ON 25
 eC_6                 2.350108e-01 1 1  ON 26
 eC_7                 3.970325e-01 1 1  ON 27
 eC_8                 2.831148e-01 1 1  ON 28
 eC_9                 7.468895e-02 1 1  ON 29
 eO_0                -1.240511e+00 1 1  ON 30
 eO_1                -8.626241e-01 1 1  ON 31
 eO_2                -3.839359e-01 1 1  ON 32
 eO_3                -4.018898e-02 1 1  ON 33
 eO_4                 1.876815e-01 1 1  ON 34
 eO_5                 3.713041e-01 1 1  ON 35
 eO_6                 4.612596e-01 1 1  ON 36
 eO_7                 5.226130e-01 1 1  ON 37
 eO_8                 4.808175e-01 1 1  ON 38
 eO_9                 3.300295e-01 1 1  ON 39
eH1_0                -1.848084e-01 1 1  ON 40
eH1_1                -9.711405e-02 1 1  ON 41
eH1_2                -6.429474e-02 1 1  ON 42
eH1_3                -4.851126e-02 1 1  ON 43
eH1_4                 1.241242e-02 1 1  ON 44
eH1_5                 6.923704e-02 1 1  ON 45
eH1_6                 1.256263e-01 1 1  ON 46
eH1_7                 1.008275e-01 1 1  ON 47
eH1_8                 9.744685e-03 1 1  ON 48
eH1_9                -1.655182e-02 1 1  ON 49
eH2_0                -1.864403e-01 1 1  ON 50
eH2_1                -9.918199e-02 1 1  ON 51
eH2_2                -6.570423e-02 1 1  ON 52
eH2_3                -5.010929e-02 1 1  ON 53
eH2_4                 1.086460e-02 1 1  ON 54
eH2_5                 6.797004e-02 1 1  ON 55
eH2_6                 1.238721e-01 1 1  ON 56
eH2_7                 9.912318e-02 1 1  ON 57
eH2_8                 7.696743e-03 1 1  ON 58
eH2_9                -1.005363e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8174
    reference variance = 0.296549
====================================================
  Execution time = 4.6219e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.2309e-01
  Total weights = 2.0000e+06
  Execution time = 3.5390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523253260708
                                         uncertainty =       0.014031203501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523253260708
                                         uncertainty =       0.014031203501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511406652
  error estimate for blocks of size 2^( 2) =       0.000529151223
  error estimate for blocks of size 2^( 3) =       0.000544693868
  error estimate for blocks of size 2^( 4) =       0.000554252865
  error estimate for blocks of size 2^( 5) =       0.000559973654
  error estimate for blocks of size 2^( 6) =       0.000563122623
  error estimate for blocks of size 2^( 7) =       0.000563412826

      target function =                  N/A
              le_mean =     -22.826057504452
             les_mean =     521.551974462975
             stat err =       0.000560190492
             autocorr =       1.199882505538
              std dev =       0.723238223519
             le_variance =       0.523073527959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523309396377
                                         uncertainty =       0.014040955218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523309396377
                                         uncertainty =       0.014040955218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511434069
  error estimate for blocks of size 2^( 2) =       0.000529177037
  error estimate for blocks of size 2^( 3) =       0.000544716692
  error estimate for blocks of size 2^( 4) =       0.000554273296
  error estimate for blocks of size 2^( 5) =       0.000559993147
  error estimate for blocks of size 2^( 6) =       0.000563139921
  error estimate for blocks of size 2^( 7) =       0.000563433221

      target function =                  N/A
              le_mean =     -22.826058099998
             les_mean =     521.552057736143
             stat err =       0.000560209897
             autocorr =       1.199836982008
              std dev =       0.723276996193
             le_variance =       0.523129613223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523281135087
                                         uncertainty =       0.014036719267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523281135087
                                         uncertainty =       0.014036719267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511420265
  error estimate for blocks of size 2^( 2) =       0.000529164047
  error estimate for blocks of size 2^( 3) =       0.000544705032
  error estimate for blocks of size 2^( 4) =       0.000554262713
  error estimate for blocks of size 2^( 5) =       0.000559982936
  error estimate for blocks of size 2^( 6) =       0.000563130423
  error estimate for blocks of size 2^( 7) =       0.000563422529

      target function =                  N/A
              le_mean =     -22.826057811626
             les_mean =     521.552016333139
             stat err =       0.000560199650
             autocorr =       1.199857860126
              std dev =       0.723257474913
             le_variance =       0.523101375017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523256647478
                                         uncertainty =       0.014031916224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.523256647478
                                         uncertainty =       0.014031916224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000511408306
  error estimate for blocks of size 2^( 2) =       0.000529152781
  error estimate for blocks of size 2^( 3) =       0.000544695212
  error estimate for blocks of size 2^( 4) =       0.000554254041
  error estimate for blocks of size 2^( 5) =       0.000559974756
  error estimate for blocks of size 2^( 6) =       0.000563123522
  error estimate for blocks of size 2^( 7) =       0.000563413978

      target function =                  N/A
              le_mean =     -22.826057539931
             les_mean =     521.551979465936
             stat err =       0.000560191574
             autocorr =       1.199879378535
              std dev =       0.723240562493
             le_variance =       0.523076911235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826057504452        initial
     1.5625e+00     1.5625e+01             1.2469e-04       -22.826058099998  <--
     6.2500e+00     6.2500e+01             3.2254e-05       -22.826057811626
     2.5000e+01     2.5000e+02             8.1206e-06       -22.826057539931

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 6.3963e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.675837e-01 1 1  ON 0
 uu_1                 9.412860e-02 1 1  ON 1
 uu_2                -1.703526e-02 1 1  ON 2
 uu_3                -8.222739e-02 1 1  ON 3
 uu_4                -1.195058e-01 1 1  ON 4
 uu_5                -1.418323e-01 1 1  ON 5
 uu_6                -1.546271e-01 1 1  ON 6
 uu_7                -1.563691e-01 1 1  ON 7
 uu_8                -1.454565e-01 1 1  ON 8
 uu_9                -1.138497e-01 1 1  ON 9
 ud_0                 4.389717e-01 1 1  ON 10
 ud_1                 1.569184e-01 1 1  ON 11
 ud_2                 1.133921e-02 1 1  ON 12
 ud_3                -6.843014e-02 1 1  ON 13
 ud_4                -1.152370e-01 1 1  ON 14
 ud_5                -1.445491e-01 1 1  ON 15
 ud_6                -1.621322e-01 1 1  ON 16
 ud_7                -1.678456e-01 1 1  ON 17
 ud_8                -1.584189e-01 1 1  ON 18
 ud_9                -1.292304e-01 1 1  ON 19
 eC_0                -5.620058e-01 1 1  ON 20
 eC_1                -4.080437e-01 1 1  ON 21
 eC_2                -1.596870e-01 1 1  ON 22
 eC_3                -1.518722e-02 1 1  ON 23
 eC_4                 3.170154e-02 1 1  ON 24
 eC_5                 1.167335e-01 1 1  ON 25
 eC_6                 2.349866e-01 1 1  ON 26
 eC_7                 3.970296e-01 1 1  ON 27
 eC_8                 2.831730e-01 1 1  ON 28
 eC_9                 7.471203e-02 1 1  ON 29
 eO_0                -1.240604e+00 1 1  ON 30
 eO_1                -8.626917e-01 1 1  ON 31
 eO_2                -3.839659e-01 1 1  ON 32
 eO_3                -4.017934e-02 1 1  ON 33
 eO_4                 1.877339e-01 1 1  ON 34
 eO_5                 3.712761e-01 1 1  ON 35
 eO_6                 4.613104e-01 1 1  ON 36
 eO_7                 5.226379e-01 1 1  ON 37
 eO_8                 4.808175e-01 1 1  ON 38
 eO_9                 3.300616e-01 1 1  ON 39
eH1_0                -1.848276e-01 1 1  ON 40
eH1_1                -9.713288e-02 1 1  ON 41
eH1_2                -6.427541e-02 1 1  ON 42
eH1_3                -4.853758e-02 1 1  ON 43
eH1_4                 1.242208e-02 1 1  ON 44
eH1_5                 6.926354e-02 1 1  ON 45
eH1_6                 1.256559e-01 1 1  ON 46
eH1_7                 1.008144e-01 1 1  ON 47
eH1_8                 9.728121e-03 1 1  ON 48
eH1_9                -1.656275e-02 1 1  ON 49
eH2_0                -1.864769e-01 1 1  ON 50
eH2_1                -9.914459e-02 1 1  ON 51
eH2_2                -6.569816e-02 1 1  ON 52
eH2_3                -5.007587e-02 1 1  ON 53
eH2_4                 1.084596e-02 1 1  ON 54
eH2_5                 6.792274e-02 1 1  ON 55
eH2_6                 1.238249e-01 1 1  ON 56
eH2_7                 9.916195e-02 1 1  ON 57
eH2_8                 7.716806e-03 1 1  ON 58
eH2_9                -1.005575e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2455e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2846e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7839
    reference variance = 0.31263
====================================================
  Execution time = 4.3663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0246e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5282e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502394314148
                                         uncertainty =       0.003769382198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502394314148
                                         uncertainty =       0.003769382198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501230848
  error estimate for blocks of size 2^( 2) =       0.000519055282
  error estimate for blocks of size 2^( 3) =       0.000534574276
  error estimate for blocks of size 2^( 4) =       0.000545461462
  error estimate for blocks of size 2^( 5) =       0.000552803227
  error estimate for blocks of size 2^( 6) =       0.000556171551
  error estimate for blocks of size 2^( 7) =       0.000554306226

      target function =                  N/A
              le_mean =     -22.825655369317
             les_mean =     521.513007512921
             stat err =       0.000552185616
             autocorr =       1.213653176339
              std dev =       0.708847462666
             le_variance =       0.502464725328


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282565536932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825655369317       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825655815543       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825655540179       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825656171026       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825656221860       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825655364901       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825654944328       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825655024533       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825654932758       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825655134216       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825655321342       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825655263302       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 4.323182e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825655369317       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825655512159       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825655437104       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825655564172       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825655635834       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825655467936       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825655164490       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825655048051       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825655085147       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825655137123       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825655164183       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.431141e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825655369317       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825655407720       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825655389021       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825655414995       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825655437865       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825655413436       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825655307467       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825655262668       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825655270705       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825655283139       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 4.007723e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038673 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8953e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.677100e-01 1 1  ON 0
 uu_1                 9.410935e-02 1 1  ON 1
 uu_2                -1.704798e-02 1 1  ON 2
 uu_3                -8.221638e-02 1 1  ON 3
 uu_4                -1.194930e-01 1 1  ON 4
 uu_5                -1.418273e-01 1 1  ON 5
 uu_6                -1.546044e-01 1 1  ON 6
 uu_7                -1.563802e-01 1 1  ON 7
 uu_8                -1.454813e-01 1 1  ON 8
 uu_9                -1.138854e-01 1 1  ON 9
 ud_0                 4.390605e-01 1 1  ON 10
 ud_1                 1.569465e-01 1 1  ON 11
 ud_2                 1.139244e-02 1 1  ON 12
 ud_3                -6.842554e-02 1 1  ON 13
 ud_4                -1.152299e-01 1 1  ON 14
 ud_5                -1.445560e-01 1 1  ON 15
 ud_6                -1.620670e-01 1 1  ON 16
 ud_7                -1.678554e-01 1 1  ON 17
 ud_8                -1.584851e-01 1 1  ON 18
 ud_9                -1.292524e-01 1 1  ON 19
 eC_0                -5.619763e-01 1 1  ON 20
 eC_1                -4.080636e-01 1 1  ON 21
 eC_2                -1.597082e-01 1 1  ON 22
 eC_3                -1.518152e-02 1 1  ON 23
 eC_4                 3.174175e-02 1 1  ON 24
 eC_5                 1.167031e-01 1 1  ON 25
 eC_6                 2.349214e-01 1 1  ON 26
 eC_7                 3.970187e-01 1 1  ON 27
 eC_8                 2.832261e-01 1 1  ON 28
 eC_9                 7.473089e-02 1 1  ON 29
 eO_0                -1.240617e+00 1 1  ON 30
 eO_1                -8.628348e-01 1 1  ON 31
 eO_2                -3.840105e-01 1 1  ON 32
 eO_3                -4.017261e-02 1 1  ON 33
 eO_4                 1.877464e-01 1 1  ON 34
 eO_5                 3.713703e-01 1 1  ON 35
 eO_6                 4.613048e-01 1 1  ON 36
 eO_7                 5.226469e-01 1 1  ON 37
 eO_8                 4.808084e-01 1 1  ON 38
 eO_9                 3.301116e-01 1 1  ON 39
eH1_0                -1.847328e-01 1 1  ON 40
eH1_1                -9.718341e-02 1 1  ON 41
eH1_2                -6.424484e-02 1 1  ON 42
eH1_3                -4.854531e-02 1 1  ON 43
eH1_4                 1.241957e-02 1 1  ON 44
eH1_5                 6.928865e-02 1 1  ON 45
eH1_6                 1.255795e-01 1 1  ON 46
eH1_7                 1.007724e-01 1 1  ON 47
eH1_8                 9.738421e-03 1 1  ON 48
eH1_9                -1.656032e-02 1 1  ON 49
eH2_0                -1.864646e-01 1 1  ON 50
eH2_1                -9.912721e-02 1 1  ON 51
eH2_2                -6.572154e-02 1 1  ON 52
eH2_3                -5.006950e-02 1 1  ON 53
eH2_4                 1.090489e-02 1 1  ON 54
eH2_5                 6.782355e-02 1 1  ON 55
eH2_6                 1.239106e-01 1 1  ON 56
eH2_7                 9.915049e-02 1 1  ON 57
eH2_8                 7.725438e-03 1 1  ON 58
eH2_9                -1.011238e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8573
    reference variance = 0.294325
====================================================
  Execution time = 4.3607e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1187e-01
  Total weights = 2.0000e+06
  Execution time = 3.5439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511913206333
                                         uncertainty =       0.004507899092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511913206333
                                         uncertainty =       0.004507899092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505866553
  error estimate for blocks of size 2^( 2) =       0.000523707091
  error estimate for blocks of size 2^( 3) =       0.000539841670
  error estimate for blocks of size 2^( 4) =       0.000551147584
  error estimate for blocks of size 2^( 5) =       0.000556935566
  error estimate for blocks of size 2^( 6) =       0.000560575475
  error estimate for blocks of size 2^( 7) =       0.000564073232

      target function =                  N/A
              le_mean =     -22.825615671727
             les_mean =     521.520532477167
             stat err =       0.000558182964
             autocorr =       1.217534351746
              std dev =       0.715403340552
             le_variance =       0.511801939673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512084945604
                                         uncertainty =       0.004511602010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512084945604
                                         uncertainty =       0.004511602010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505951381
  error estimate for blocks of size 2^( 2) =       0.000523790211
  error estimate for blocks of size 2^( 3) =       0.000539921239
  error estimate for blocks of size 2^( 4) =       0.000551223546
  error estimate for blocks of size 2^( 5) =       0.000557008283
  error estimate for blocks of size 2^( 6) =       0.000560647427
  error estimate for blocks of size 2^( 7) =       0.000564156951

      target function =                  N/A
              le_mean =     -22.825616869278
             les_mean =     521.520758807567
             stat err =       0.000558259052
             autocorr =       1.217457965148
              std dev =       0.715523305356
             le_variance =       0.511973600508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512059039314
                                         uncertainty =       0.004511308909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512059039314
                                         uncertainty =       0.004511308909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505938583
  error estimate for blocks of size 2^( 2) =       0.000523777721
  error estimate for blocks of size 2^( 3) =       0.000539909690
  error estimate for blocks of size 2^( 4) =       0.000551212958
  error estimate for blocks of size 2^( 5) =       0.000556997817
  error estimate for blocks of size 2^( 6) =       0.000560636732
  error estimate for blocks of size 2^( 7) =       0.000564144002

      target function =                  N/A
              le_mean =     -22.825616412754
             les_mean =     521.520712066501
             stat err =       0.000558247877
             autocorr =       1.217470816764
              std dev =       0.715505206323
             le_variance =       0.511947700275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511934352990
                                         uncertainty =       0.004508430189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511934352990
                                         uncertainty =       0.004508430189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505876998
  error estimate for blocks of size 2^( 2) =       0.000523717357
  error estimate for blocks of size 2^( 3) =       0.000539851592
  error estimate for blocks of size 2^( 4) =       0.000551157142
  error estimate for blocks of size 2^( 5) =       0.000556944646
  error estimate for blocks of size 2^( 6) =       0.000560584456
  error estimate for blocks of size 2^( 7) =       0.000564083635

      target function =                  N/A
              le_mean =     -22.825615742008
             les_mean =     521.520556819841
             stat err =       0.000558192470
             autocorr =       1.217525543856
              std dev =       0.715418111291
             le_variance =       0.511823073963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825615671727        initial
     3.9062e-01     3.9062e+00             4.3232e-04       -22.825616869278  <--
     1.5625e+00     1.5625e+01             1.4311e-04       -22.825616412754
     6.2500e+00     6.2500e+01             4.0077e-05       -22.825615742008

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 6.1376e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.679182e-01 1 1  ON 0
 uu_1                 9.409648e-02 1 1  ON 1
 uu_2                -1.703341e-02 1 1  ON 2
 uu_3                -8.218774e-02 1 1  ON 3
 uu_4                -1.194502e-01 1 1  ON 4
 uu_5                -1.418005e-01 1 1  ON 5
 uu_6                -1.545515e-01 1 1  ON 6
 uu_7                -1.563671e-01 1 1  ON 7
 uu_8                -1.455356e-01 1 1  ON 8
 uu_9                -1.139884e-01 1 1  ON 9
 ud_0                 4.392189e-01 1 1  ON 10
 ud_1                 1.570444e-01 1 1  ON 11
 ud_2                 1.150898e-02 1 1  ON 12
 ud_3                -6.837701e-02 1 1  ON 13
 ud_4                -1.151994e-01 1 1  ON 14
 ud_5                -1.445323e-01 1 1  ON 15
 ud_6                -1.619433e-01 1 1  ON 16
 ud_7                -1.678168e-01 1 1  ON 17
 ud_8                -1.586435e-01 1 1  ON 18
 ud_9                -1.293194e-01 1 1  ON 19
 eC_0                -5.619250e-01 1 1  ON 20
 eC_1                -4.081151e-01 1 1  ON 21
 eC_2                -1.597582e-01 1 1  ON 22
 eC_3                -1.515556e-02 1 1  ON 23
 eC_4                 3.183564e-02 1 1  ON 24
 eC_5                 1.166401e-01 1 1  ON 25
 eC_6                 2.347418e-01 1 1  ON 26
 eC_7                 3.969848e-01 1 1  ON 27
 eC_8                 2.833782e-01 1 1  ON 28
 eC_9                 7.478500e-02 1 1  ON 29
 eO_0                -1.240769e+00 1 1  ON 30
 eO_1                -8.631240e-01 1 1  ON 31
 eO_2                -3.841558e-01 1 1  ON 32
 eO_3                -4.015322e-02 1 1  ON 33
 eO_4                 1.877875e-01 1 1  ON 34
 eO_5                 3.716074e-01 1 1  ON 35
 eO_6                 4.613208e-01 1 1  ON 36
 eO_7                 5.226804e-01 1 1  ON 37
 eO_8                 4.807806e-01 1 1  ON 38
 eO_9                 3.302543e-01 1 1  ON 39
eH1_0                -1.844954e-01 1 1  ON 40
eH1_1                -9.728188e-02 1 1  ON 41
eH1_2                -6.418830e-02 1 1  ON 42
eH1_3                -4.855904e-02 1 1  ON 43
eH1_4                 1.241913e-02 1 1  ON 44
eH1_5                 6.932025e-02 1 1  ON 45
eH1_6                 1.254032e-01 1 1  ON 46
eH1_7                 1.006573e-01 1 1  ON 47
eH1_8                 9.765237e-03 1 1  ON 48
eH1_9                -1.655418e-02 1 1  ON 49
eH2_0                -1.864264e-01 1 1  ON 50
eH2_1                -9.909785e-02 1 1  ON 51
eH2_2                -6.577265e-02 1 1  ON 52
eH2_3                -5.003925e-02 1 1  ON 53
eH2_4                 1.100795e-02 1 1  ON 54
eH2_5                 6.765594e-02 1 1  ON 55
eH2_6                 1.240647e-01 1 1  ON 56
eH2_7                 9.914413e-02 1 1  ON 57
eH2_8                 7.755537e-03 1 1  ON 58
eH2_9                -1.027607e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2034e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2843e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8353
    reference variance = 0.279674
====================================================
  Execution time = 4.4145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0718e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4995e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507273239864
                                         uncertainty =       0.004688671517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507273239864
                                         uncertainty =       0.004688671517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503578745
  error estimate for blocks of size 2^( 2) =       0.000521402392
  error estimate for blocks of size 2^( 3) =       0.000536787636
  error estimate for blocks of size 2^( 4) =       0.000547931755
  error estimate for blocks of size 2^( 5) =       0.000554111236
  error estimate for blocks of size 2^( 6) =       0.000557377496
  error estimate for blocks of size 2^( 7) =       0.000559514533

      target function =                  N/A
              le_mean =     -22.826325827728
             les_mean =     521.548333644915
             stat err =       0.000554733755
             autocorr =       1.213484976058
              std dev =       0.712167890964
             le_variance =       0.507183104920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282632582773e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826325827728       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826328901035       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826328537708       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826328801656       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826329848279       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826329930836       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826329264603       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826328417333       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826329342172       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826330085768       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826330278422       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826330420706       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826330649343       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.826331301565       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.826330646033       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.826330485688       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 1.617692e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826325827728       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826327266899       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826327155455       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826327260217       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826327836950       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826327992685       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826327668919       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826327219404       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826327546134       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826327692895       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826327697633       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826327760163       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 5.443148e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826325827728       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826326287986       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826326275437       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826326326701       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826326549165       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826326713510       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826326547744       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826326448230       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826326529771       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826326532757       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826326526424       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.684119e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9151e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.678222e-01 1 1  ON 0
 uu_1                 9.409524e-02 1 1  ON 1
 uu_2                -1.706403e-02 1 1  ON 2
 uu_3                -8.215136e-02 1 1  ON 3
 uu_4                -1.194666e-01 1 1  ON 4
 uu_5                -1.417642e-01 1 1  ON 5
 uu_6                -1.543972e-01 1 1  ON 6
 uu_7                -1.563970e-01 1 1  ON 7
 uu_8                -1.454690e-01 1 1  ON 8
 uu_9                -1.139291e-01 1 1  ON 9
 ud_0                 4.394304e-01 1 1  ON 10
 ud_1                 1.572056e-01 1 1  ON 11
 ud_2                 1.153902e-02 1 1  ON 12
 ud_3                -6.819110e-02 1 1  ON 13
 ud_4                -1.151350e-01 1 1  ON 14
 ud_5                -1.445629e-01 1 1  ON 15
 ud_6                -1.619024e-01 1 1  ON 16
 ud_7                -1.678587e-01 1 1  ON 17
 ud_8                -1.587869e-01 1 1  ON 18
 ud_9                -1.294286e-01 1 1  ON 19
 eC_0                -5.622513e-01 1 1  ON 20
 eC_1                -4.082637e-01 1 1  ON 21
 eC_2                -1.597078e-01 1 1  ON 22
 eC_3                -1.486290e-02 1 1  ON 23
 eC_4                 3.180999e-02 1 1  ON 24
 eC_5                 1.166323e-01 1 1  ON 25
 eC_6                 2.346959e-01 1 1  ON 26
 eC_7                 3.969081e-01 1 1  ON 27
 eC_8                 2.835828e-01 1 1  ON 28
 eC_9                 7.486132e-02 1 1  ON 29
 eO_0                -1.241314e+00 1 1  ON 30
 eO_1                -8.632777e-01 1 1  ON 31
 eO_2                -3.843592e-01 1 1  ON 32
 eO_3                -4.031027e-02 1 1  ON 33
 eO_4                 1.879429e-01 1 1  ON 34
 eO_5                 3.718758e-01 1 1  ON 35
 eO_6                 4.614259e-01 1 1  ON 36
 eO_7                 5.227348e-01 1 1  ON 37
 eO_8                 4.807837e-01 1 1  ON 38
 eO_9                 3.305116e-01 1 1  ON 39
eH1_0                -1.843276e-01 1 1  ON 40
eH1_1                -9.729358e-02 1 1  ON 41
eH1_2                -6.441621e-02 1 1  ON 42
eH1_3                -4.846960e-02 1 1  ON 43
eH1_4                 1.238084e-02 1 1  ON 44
eH1_5                 6.932909e-02 1 1  ON 45
eH1_6                 1.254086e-01 1 1  ON 46
eH1_7                 1.006089e-01 1 1  ON 47
eH1_8                 9.837207e-03 1 1  ON 48
eH1_9                -1.664530e-02 1 1  ON 49
eH2_0                -1.866704e-01 1 1  ON 50
eH2_1                -9.890009e-02 1 1  ON 51
eH2_2                -6.551206e-02 1 1  ON 52
eH2_3                -5.014787e-02 1 1  ON 53
eH2_4                 1.088918e-02 1 1  ON 54
eH2_5                 6.758025e-02 1 1  ON 55
eH2_6                 1.241863e-01 1 1  ON 56
eH2_7                 9.936035e-02 1 1  ON 57
eH2_8                 7.709704e-03 1 1  ON 58
eH2_9                -1.047507e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7478
    reference variance = 0.413904
====================================================
  Execution time = 4.3132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0395e-01
  Total weights = 2.0000e+06
  Execution time = 3.5478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503918006411
                                         uncertainty =       0.003522808491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503918006411
                                         uncertainty =       0.003522808491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501898181
  error estimate for blocks of size 2^( 2) =       0.000519922782
  error estimate for blocks of size 2^( 3) =       0.000535490252
  error estimate for blocks of size 2^( 4) =       0.000546181008
  error estimate for blocks of size 2^( 5) =       0.000553058667
  error estimate for blocks of size 2^( 6) =       0.000555216938
  error estimate for blocks of size 2^( 7) =       0.000557103845

      target function =                  N/A
              le_mean =     -22.825140615382
             les_mean =     521.490847428386
             stat err =       0.000552890115
             autocorr =       1.213518514290
              std dev =       0.709791214589
             le_variance =       0.503803568308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504227443591
                                         uncertainty =       0.003524666668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504227443591
                                         uncertainty =       0.003524666668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502052279
  error estimate for blocks of size 2^( 2) =       0.000520067467
  error estimate for blocks of size 2^( 3) =       0.000535628869
  error estimate for blocks of size 2^( 4) =       0.000546319382
  error estimate for blocks of size 2^( 5) =       0.000553198212
  error estimate for blocks of size 2^( 6) =       0.000555371732
  error estimate for blocks of size 2^( 7) =       0.000557239150

      target function =                  N/A
              le_mean =     -22.825143642992
             les_mean =     521.491295053031
             stat err =       0.000553032119
             autocorr =       1.213396740908
              std dev =       0.710009142100
             le_variance =       0.504112981866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504213464938
                                         uncertainty =       0.003525468639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504213464938
                                         uncertainty =       0.003525468639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502045336
  error estimate for blocks of size 2^( 2) =       0.000520058831
  error estimate for blocks of size 2^( 3) =       0.000535622353
  error estimate for blocks of size 2^( 4) =       0.000546315384
  error estimate for blocks of size 2^( 5) =       0.000553197001
  error estimate for blocks of size 2^( 6) =       0.000555372835
  error estimate for blocks of size 2^( 7) =       0.000557241787

      target function =                  N/A
              le_mean =     -22.825142190511
             les_mean =     521.491214802965
             stat err =       0.000553031752
             autocorr =       1.213428692935
              std dev =       0.709999322505
             le_variance =       0.504099037958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503972287057
                                         uncertainty =       0.003523424856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503972287057
                                         uncertainty =       0.003523424856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501925219
  error estimate for blocks of size 2^( 2) =       0.000519947372
  error estimate for blocks of size 2^( 3) =       0.000535514056
  error estimate for blocks of size 2^( 4) =       0.000546205112
  error estimate for blocks of size 2^( 5) =       0.000553083772
  error estimate for blocks of size 2^( 6) =       0.000555245442
  error estimate for blocks of size 2^( 7) =       0.000557129262

      target function =                  N/A
              le_mean =     -22.825140339053
             les_mean =     521.490889097274
             stat err =       0.000552915897
             autocorr =       1.213500943296
              std dev =       0.709829452565
             le_variance =       0.503857851728


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825140615382        initial
     9.7656e-02     9.7656e-01             1.6177e-03       -22.825143642992  <--
     3.9062e-01     3.9062e+00             5.4431e-04       -22.825142190511
     1.5625e+00     1.5625e+01             1.6841e-04       -22.825140339053

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 6.0927e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.678611e-01 1 1  ON 0
 uu_1                 9.413243e-02 1 1  ON 1
 uu_2                -1.704295e-02 1 1  ON 2
 uu_3                -8.213945e-02 1 1  ON 3
 uu_4                -1.194820e-01 1 1  ON 4
 uu_5                -1.417568e-01 1 1  ON 5
 uu_6                -1.542903e-01 1 1  ON 6
 uu_7                -1.564145e-01 1 1  ON 7
 uu_8                -1.452762e-01 1 1  ON 8
 uu_9                -1.137560e-01 1 1  ON 9
 ud_0                 4.398686e-01 1 1  ON 10
 ud_1                 1.575906e-01 1 1  ON 11
 ud_2                 1.184489e-02 1 1  ON 12
 ud_3                -6.788688e-02 1 1  ON 13
 ud_4                -1.149464e-01 1 1  ON 14
 ud_5                -1.444967e-01 1 1  ON 15
 ud_6                -1.618671e-01 1 1  ON 16
 ud_7                -1.678945e-01 1 1  ON 17
 ud_8                -1.590045e-01 1 1  ON 18
 ud_9                -1.297407e-01 1 1  ON 19
 eC_0                -5.628708e-01 1 1  ON 20
 eC_1                -4.086336e-01 1 1  ON 21
 eC_2                -1.597593e-01 1 1  ON 22
 eC_3                -1.455697e-02 1 1  ON 23
 eC_4                 3.200724e-02 1 1  ON 24
 eC_5                 1.166343e-01 1 1  ON 25
 eC_6                 2.345812e-01 1 1  ON 26
 eC_7                 3.966844e-01 1 1  ON 27
 eC_8                 2.842043e-01 1 1  ON 28
 eC_9                 7.509340e-02 1 1  ON 29
 eO_0                -1.242387e+00 1 1  ON 30
 eO_1                -8.640798e-01 1 1  ON 31
 eO_2                -3.850215e-01 1 1  ON 32
 eO_3                -4.065239e-02 1 1  ON 33
 eO_4                 1.881519e-01 1 1  ON 34
 eO_5                 3.723723e-01 1 1  ON 35
 eO_6                 4.619350e-01 1 1  ON 36
 eO_7                 5.229615e-01 1 1  ON 37
 eO_8                 4.807901e-01 1 1  ON 38
 eO_9                 3.312897e-01 1 1  ON 39
eH1_0                -1.840886e-01 1 1  ON 40
eH1_1                -9.739130e-02 1 1  ON 41
eH1_2                -6.467202e-02 1 1  ON 42
eH1_3                -4.842058e-02 1 1  ON 43
eH1_4                 1.236084e-02 1 1  ON 44
eH1_5                 6.929167e-02 1 1  ON 45
eH1_6                 1.254573e-01 1 1  ON 46
eH1_7                 1.005207e-01 1 1  ON 47
eH1_8                 1.005381e-02 1 1  ON 48
eH1_9                -1.692397e-02 1 1  ON 49
eH2_0                -1.869037e-01 1 1  ON 50
eH2_1                -9.868022e-02 1 1  ON 51
eH2_2                -6.524670e-02 1 1  ON 52
eH2_3                -5.022461e-02 1 1  ON 53
eH2_4                 1.077192e-02 1 1  ON 54
eH2_5                 6.745429e-02 1 1  ON 55
eH2_6                 1.243716e-01 1 1  ON 56
eH2_7                 9.994339e-02 1 1  ON 57
eH2_8                 7.620844e-03 1 1  ON 58
eH2_9                -1.107188e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2008e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7053
    reference variance = 0.462488
====================================================
  Execution time = 4.5464e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0387e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4766e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503839221110
                                         uncertainty =       0.004342682424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503839221110
                                         uncertainty =       0.004342682424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501933185
  error estimate for blocks of size 2^( 2) =       0.000519595049
  error estimate for blocks of size 2^( 3) =       0.000536033188
  error estimate for blocks of size 2^( 4) =       0.000546743470
  error estimate for blocks of size 2^( 5) =       0.000552737034
  error estimate for blocks of size 2^( 6) =       0.000557660588
  error estimate for blocks of size 2^( 7) =       0.000559888686

      target function =                  N/A
              le_mean =     -22.826233759323
             les_mean =     521.540821227656
             stat err =       0.000554257444
             autocorr =       1.219358051627
              std dev =       0.709840717566
             le_variance =       0.503873844314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282623375932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826233759323       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826232438907       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826233768701       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826236533484       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826235553269       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826233967677       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826236223834       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826238370455       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826237243059       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826237622602       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826238135298       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826237520303       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826234553268       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.826235509061       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.826236659397       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.826236043178       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.826235350113       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.826235992488       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.826236077549       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.826235863999       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.826236527764       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.826236998756       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-02 is 4.536947e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826233759323       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826232847452       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826232696614       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826234676733       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826234735097       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826233411776       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826235370093       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826236009964       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826235845140       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826235345378       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826235768986       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826235476140       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826234553984       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.826235131285       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.826235108439       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-02 is 1.087528e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826233759323       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826233351805       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826232583368       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826233399360       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826233857302       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826233345103       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826233768299       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826234435686       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826234165139       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826233909698       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826233987490       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826233918081       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 3.686495e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0245e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.682386e-01 1 1  ON 0
 uu_1                 9.458615e-02 1 1  ON 1
 uu_2                -1.664651e-02 1 1  ON 2
 uu_3                -8.181461e-02 1 1  ON 3
 uu_4                -1.195218e-01 1 1  ON 4
 uu_5                -1.418631e-01 1 1  ON 5
 uu_6                -1.547708e-01 1 1  ON 6
 uu_7                -1.573086e-01 1 1  ON 7
 uu_8                -1.458935e-01 1 1  ON 8
 uu_9                -1.132075e-01 1 1  ON 9
 ud_0                 4.400409e-01 1 1  ON 10
 ud_1                 1.577114e-01 1 1  ON 11
 ud_2                 1.202619e-02 1 1  ON 12
 ud_3                -6.781121e-02 1 1  ON 13
 ud_4                -1.149213e-01 1 1  ON 14
 ud_5                -1.444539e-01 1 1  ON 15
 ud_6                -1.619507e-01 1 1  ON 16
 ud_7                -1.677602e-01 1 1  ON 17
 ud_8                -1.583103e-01 1 1  ON 18
 ud_9                -1.297720e-01 1 1  ON 19
 eC_0                -5.636809e-01 1 1  ON 20
 eC_1                -4.093183e-01 1 1  ON 21
 eC_2                -1.602320e-01 1 1  ON 22
 eC_3                -1.436552e-02 1 1  ON 23
 eC_4                 3.264180e-02 1 1  ON 24
 eC_5                 1.167782e-01 1 1  ON 25
 eC_6                 2.340884e-01 1 1  ON 26
 eC_7                 3.966179e-01 1 1  ON 27
 eC_8                 2.852918e-01 1 1  ON 28
 eC_9                 7.554453e-02 1 1  ON 29
 eO_0                -1.243169e+00 1 1  ON 30
 eO_1                -8.648078e-01 1 1  ON 31
 eO_2                -3.856123e-01 1 1  ON 32
 eO_3                -4.069639e-02 1 1  ON 33
 eO_4                 1.881634e-01 1 1  ON 34
 eO_5                 3.722837e-01 1 1  ON 35
 eO_6                 4.621216e-01 1 1  ON 36
 eO_7                 5.228920e-01 1 1  ON 37
 eO_8                 4.811948e-01 1 1  ON 38
 eO_9                 3.321506e-01 1 1  ON 39
eH1_0                -1.850936e-01 1 1  ON 40
eH1_1                -9.824053e-02 1 1  ON 41
eH1_2                -6.449372e-02 1 1  ON 42
eH1_3                -4.824218e-02 1 1  ON 43
eH1_4                 1.250008e-02 1 1  ON 44
eH1_5                 6.953904e-02 1 1  ON 45
eH1_6                 1.263553e-01 1 1  ON 46
eH1_7                 1.007636e-01 1 1  ON 47
eH1_8                 9.891746e-03 1 1  ON 48
eH1_9                -1.711231e-02 1 1  ON 49
eH2_0                -1.866511e-01 1 1  ON 50
eH2_1                -9.885675e-02 1 1  ON 51
eH2_2                -6.581033e-02 1 1  ON 52
eH2_3                -5.076447e-02 1 1  ON 53
eH2_4                 1.051884e-02 1 1  ON 54
eH2_5                 6.750153e-02 1 1  ON 55
eH2_6                 1.246758e-01 1 1  ON 56
eH2_7                 1.005747e-01 1 1  ON 57
eH2_8                 7.913347e-03 1 1  ON 58
eH2_9                -1.141713e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.9038
    reference variance = 0.945638
====================================================
  Execution time = 4.3481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9833e-01
  Total weights = 2.0000e+06
  Execution time = 3.5726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498425290981
                                         uncertainty =       0.003057550646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498425290981
                                         uncertainty =       0.003057550646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499154710
  error estimate for blocks of size 2^( 2) =       0.000516699106
  error estimate for blocks of size 2^( 3) =       0.000533104621
  error estimate for blocks of size 2^( 4) =       0.000544908751
  error estimate for blocks of size 2^( 5) =       0.000550927072
  error estimate for blocks of size 2^( 6) =       0.000553407859
  error estimate for blocks of size 2^( 7) =       0.000556996021

      target function =                  N/A
              le_mean =     -22.826215412366
             les_mean =     521.534420651204
             stat err =       0.000551559926
             autocorr =       1.220998307860
              std dev =       0.705911360320
             le_variance =       0.498310848629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498654140026
                                         uncertainty =       0.003058526305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498654140026
                                         uncertainty =       0.003058526305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499269340
  error estimate for blocks of size 2^( 2) =       0.000516809027
  error estimate for blocks of size 2^( 3) =       0.000533204482
  error estimate for blocks of size 2^( 4) =       0.000545007784
  error estimate for blocks of size 2^( 5) =       0.000551016171
  error estimate for blocks of size 2^( 6) =       0.000553496591
  error estimate for blocks of size 2^( 7) =       0.000557075445

      target function =                  N/A
              le_mean =     -22.826213418932
             les_mean =     521.534558544646
             stat err =       0.000551648997
             autocorr =       1.220831911882
              std dev =       0.706073471577
             le_variance =       0.498539747265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498488031576
                                         uncertainty =       0.003057175992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498488031576
                                         uncertainty =       0.003057175992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499186150
  error estimate for blocks of size 2^( 2) =       0.000516731442
  error estimate for blocks of size 2^( 3) =       0.000533131924
  error estimate for blocks of size 2^( 4) =       0.000544945804
  error estimate for blocks of size 2^( 5) =       0.000550958429
  error estimate for blocks of size 2^( 6) =       0.000553444384
  error estimate for blocks of size 2^( 7) =       0.000557017565

      target function =                  N/A
              le_mean =     -22.826214444619
             les_mean =     521.534439247536
             stat err =       0.000551591545
             autocorr =       1.220984489388
              std dev =       0.705955823682
             le_variance =       0.498373624991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498359721422
                                         uncertainty =       0.003056906609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498359721422
                                         uncertainty =       0.003056906609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499121872
  error estimate for blocks of size 2^( 2) =       0.000516667757
  error estimate for blocks of size 2^( 3) =       0.000533073173
  error estimate for blocks of size 2^( 4) =       0.000544881232
  error estimate for blocks of size 2^( 5) =       0.000550899086
  error estimate for blocks of size 2^( 6) =       0.000553382115
  error estimate for blocks of size 2^( 7) =       0.000556965236

      target function =                  N/A
              le_mean =     -22.826213410853
             les_mean =     521.534263714493
             stat err =       0.000551531917
             autocorr =       1.221034957327
              std dev =       0.705864920384
             le_variance =       0.498245285829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826215412366        initial  <--
     2.4414e-02     2.4414e-01             4.5369e-03       -22.826213418932
     9.7656e-02     9.7656e-01             1.0875e-03       -22.826214444619
     3.9062e-01     3.9062e+00             3.6865e-04       -22.826213410853

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2584
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.678611e-01 1 1  ON 0
 uu_1                 9.413243e-02 1 1  ON 1
 uu_2                -1.704295e-02 1 1  ON 2
 uu_3                -8.213945e-02 1 1  ON 3
 uu_4                -1.194820e-01 1 1  ON 4
 uu_5                -1.417568e-01 1 1  ON 5
 uu_6                -1.542903e-01 1 1  ON 6
 uu_7                -1.564145e-01 1 1  ON 7
 uu_8                -1.452762e-01 1 1  ON 8
 uu_9                -1.137560e-01 1 1  ON 9
 ud_0                 4.398686e-01 1 1  ON 10
 ud_1                 1.575906e-01 1 1  ON 11
 ud_2                 1.184489e-02 1 1  ON 12
 ud_3                -6.788688e-02 1 1  ON 13
 ud_4                -1.149464e-01 1 1  ON 14
 ud_5                -1.444967e-01 1 1  ON 15
 ud_6                -1.618671e-01 1 1  ON 16
 ud_7                -1.678945e-01 1 1  ON 17
 ud_8                -1.590045e-01 1 1  ON 18
 ud_9                -1.297407e-01 1 1  ON 19
 eC_0                -5.628708e-01 1 1  ON 20
 eC_1                -4.086336e-01 1 1  ON 21
 eC_2                -1.597593e-01 1 1  ON 22
 eC_3                -1.455697e-02 1 1  ON 23
 eC_4                 3.200724e-02 1 1  ON 24
 eC_5                 1.166343e-01 1 1  ON 25
 eC_6                 2.345812e-01 1 1  ON 26
 eC_7                 3.966844e-01 1 1  ON 27
 eC_8                 2.842043e-01 1 1  ON 28
 eC_9                 7.509340e-02 1 1  ON 29
 eO_0                -1.242387e+00 1 1  ON 30
 eO_1                -8.640798e-01 1 1  ON 31
 eO_2                -3.850215e-01 1 1  ON 32
 eO_3                -4.065239e-02 1 1  ON 33
 eO_4                 1.881519e-01 1 1  ON 34
 eO_5                 3.723723e-01 1 1  ON 35
 eO_6                 4.619350e-01 1 1  ON 36
 eO_7                 5.229615e-01 1 1  ON 37
 eO_8                 4.807901e-01 1 1  ON 38
 eO_9                 3.312897e-01 1 1  ON 39
eH1_0                -1.840886e-01 1 1  ON 40
eH1_1                -9.739130e-02 1 1  ON 41
eH1_2                -6.467202e-02 1 1  ON 42
eH1_3                -4.842058e-02 1 1  ON 43
eH1_4                 1.236084e-02 1 1  ON 44
eH1_5                 6.929167e-02 1 1  ON 45
eH1_6                 1.254573e-01 1 1  ON 46
eH1_7                 1.005207e-01 1 1  ON 47
eH1_8                 1.005381e-02 1 1  ON 48
eH1_9                -1.692397e-02 1 1  ON 49
eH2_0                -1.869037e-01 1 1  ON 50
eH2_1                -9.868022e-02 1 1  ON 51
eH2_2                -6.524670e-02 1 1  ON 52
eH2_3                -5.022461e-02 1 1  ON 53
eH2_4                 1.077192e-02 1 1  ON 54
eH2_5                 6.745429e-02 1 1  ON 55
eH2_6                 1.243716e-01 1 1  ON 56
eH2_7                 9.994339e-02 1 1  ON 57
eH2_8                 7.620844e-03 1 1  ON 58
eH2_9                -1.107188e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2151e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8214
    reference variance = 0.336606
====================================================
  Execution time = 4.3495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0884e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4728e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508989573890
                                         uncertainty =       0.005968395324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508989573890
                                         uncertainty =       0.005968395324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504402043
  error estimate for blocks of size 2^( 2) =       0.000522410616
  error estimate for blocks of size 2^( 3) =       0.000537995685
  error estimate for blocks of size 2^( 4) =       0.000548336906
  error estimate for blocks of size 2^( 5) =       0.000555738212
  error estimate for blocks of size 2^( 6) =       0.000559524663
  error estimate for blocks of size 2^( 7) =       0.000560059187

      target function =                  N/A
              le_mean =     -22.825447018982
             les_mean =     521.509874204458
             stat err =       0.000555914742
             autocorr =       1.214682312253
              std dev =       0.713332210498
             le_variance =       0.508842842534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282544701898e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825447018982       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825448549198       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825451034188       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825451957817       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825452768937       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825451972292       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825451378222       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825452471008       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825451951304       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825452122356       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825452234720       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825452337629       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825452334436       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 5.358418e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825447018982       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825447537924       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825448731330       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825449163563       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825449445707       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825449147812       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825448829026       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825449043072       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825448952008       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825449031857       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 1.686087e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825447018982       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825447161412       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825447544644       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825447686727       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825447768719       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825447697356       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825447591029       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825447622956       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825447631866       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825447619708       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 5.044783e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060097 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8231e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.679438e-01 1 1  ON 0
 uu_1                 9.417272e-02 1 1  ON 1
 uu_2                -1.700511e-02 1 1  ON 2
 uu_3                -8.215786e-02 1 1  ON 3
 uu_4                -1.194724e-01 1 1  ON 4
 uu_5                -1.417879e-01 1 1  ON 5
 uu_6                -1.544589e-01 1 1  ON 6
 uu_7                -1.564184e-01 1 1  ON 7
 uu_8                -1.451775e-01 1 1  ON 8
 uu_9                -1.137125e-01 1 1  ON 9
 ud_0                 4.398016e-01 1 1  ON 10
 ud_1                 1.576281e-01 1 1  ON 11
 ud_2                 1.188659e-02 1 1  ON 12
 ud_3                -6.789665e-02 1 1  ON 13
 ud_4                -1.149204e-01 1 1  ON 14
 ud_5                -1.445012e-01 1 1  ON 15
 ud_6                -1.619323e-01 1 1  ON 16
 ud_7                -1.677809e-01 1 1  ON 17
 ud_8                -1.588584e-01 1 1  ON 18
 ud_9                -1.297383e-01 1 1  ON 19
 eC_0                -5.629262e-01 1 1  ON 20
 eC_1                -4.086043e-01 1 1  ON 21
 eC_2                -1.598027e-01 1 1  ON 22
 eC_3                -1.451598e-02 1 1  ON 23
 eC_4                 3.199933e-02 1 1  ON 24
 eC_5                 1.166129e-01 1 1  ON 25
 eC_6                 2.344898e-01 1 1  ON 26
 eC_7                 3.966821e-01 1 1  ON 27
 eC_8                 2.843169e-01 1 1  ON 28
 eC_9                 7.513508e-02 1 1  ON 29
 eO_0                -1.242415e+00 1 1  ON 30
 eO_1                -8.642214e-01 1 1  ON 31
 eO_2                -3.850969e-01 1 1  ON 32
 eO_3                -4.073119e-02 1 1  ON 33
 eO_4                 1.881391e-01 1 1  ON 34
 eO_5                 3.723927e-01 1 1  ON 35
 eO_6                 4.619984e-01 1 1  ON 36
 eO_7                 5.230176e-01 1 1  ON 37
 eO_8                 4.808302e-01 1 1  ON 38
 eO_9                 3.313738e-01 1 1  ON 39
eH1_0                -1.842274e-01 1 1  ON 40
eH1_1                -9.729364e-02 1 1  ON 41
eH1_2                -6.455554e-02 1 1  ON 42
eH1_3                -4.839984e-02 1 1  ON 43
eH1_4                 1.235769e-02 1 1  ON 44
eH1_5                 6.923033e-02 1 1  ON 45
eH1_6                 1.254470e-01 1 1  ON 46
eH1_7                 1.005301e-01 1 1  ON 47
eH1_8                 1.003741e-02 1 1  ON 48
eH1_9                -1.695865e-02 1 1  ON 49
eH2_0                -1.868516e-01 1 1  ON 50
eH2_1                -9.865010e-02 1 1  ON 51
eH2_2                -6.533989e-02 1 1  ON 52
eH2_3                -5.022472e-02 1 1  ON 53
eH2_4                 1.067869e-02 1 1  ON 54
eH2_5                 6.755700e-02 1 1  ON 55
eH2_6                 1.244170e-01 1 1  ON 56
eH2_7                 9.989232e-02 1 1  ON 57
eH2_8                 7.622479e-03 1 1  ON 58
eH2_9                -1.110333e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7916
    reference variance = 0.555303
====================================================
  Execution time = 4.3439e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0039e-01
  Total weights = 2.0000e+06
  Execution time = 3.5347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500601646651
                                         uncertainty =       0.003264929814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500601646651
                                         uncertainty =       0.003264929814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500240687
  error estimate for blocks of size 2^( 2) =       0.000517933835
  error estimate for blocks of size 2^( 3) =       0.000533714760
  error estimate for blocks of size 2^( 4) =       0.000545030609
  error estimate for blocks of size 2^( 5) =       0.000551140585
  error estimate for blocks of size 2^( 6) =       0.000553972155
  error estimate for blocks of size 2^( 7) =       0.000557164167

      target function =                  N/A
              le_mean =     -22.825580691695
             les_mean =     521.507615153502
             stat err =       0.000551826879
             autocorr =       1.216879785005
              std dev =       0.707447164581
             le_variance =       0.500481490674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500499166301
                                         uncertainty =       0.003265296047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500499166301
                                         uncertainty =       0.003265296047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500189458
  error estimate for blocks of size 2^( 2) =       0.000517888273
  error estimate for blocks of size 2^( 3) =       0.000533669175
  error estimate for blocks of size 2^( 4) =       0.000544981078
  error estimate for blocks of size 2^( 5) =       0.000551087948
  error estimate for blocks of size 2^( 6) =       0.000553916179
  error estimate for blocks of size 2^( 7) =       0.000557115846

      target function =                  N/A
              le_mean =     -22.825580868128
             les_mean =     521.507520704255
             stat err =       0.000551775263
             autocorr =       1.216901382555
              std dev =       0.707374714703
             le_variance =       0.500378987001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500428042801
                                         uncertainty =       0.003264382561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500428042801
                                         uncertainty =       0.003264382561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500153927
  error estimate for blocks of size 2^( 2) =       0.000517854079
  error estimate for blocks of size 2^( 3) =       0.000533637136
  error estimate for blocks of size 2^( 4) =       0.000544951022
  error estimate for blocks of size 2^( 5) =       0.000551058370
  error estimate for blocks of size 2^( 6) =       0.000553888492
  error estimate for blocks of size 2^( 7) =       0.000557085426

      target function =                  N/A
              le_mean =     -22.825580111187
             les_mean =     521.507415063659
             stat err =       0.000551745827
             autocorr =       1.216944434065
              std dev =       0.707324466998
             le_variance =       0.500307901614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500570065781
                                         uncertainty =       0.003264793797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500570065781
                                         uncertainty =       0.003264793797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500224907
  error estimate for blocks of size 2^( 2) =       0.000517919236
  error estimate for blocks of size 2^( 3) =       0.000533700566
  error estimate for blocks of size 2^( 4) =       0.000545016150
  error estimate for blocks of size 2^( 5) =       0.000551125719
  error estimate for blocks of size 2^( 6) =       0.000553957174
  error estimate for blocks of size 2^( 7) =       0.000557149832

      target function =                  N/A
              le_mean =     -22.825580453598
             les_mean =     521.507572707968
             stat err =       0.000551812219
             autocorr =       1.216891904189
              std dev =       0.707424847242
             le_variance =       0.500449914496


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825580691695        initial
     2.4414e-01     2.4414e+00             5.3584e-04       -22.825580868128  <--
     9.7656e-01     9.7656e+00             1.6861e-04       -22.825580111187
     3.9062e+00     3.9062e+01             5.0448e-05       -22.825580453598

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 6.1195e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.681060e-01 1 1  ON 0
 uu_1                 9.428024e-02 1 1  ON 1
 uu_2                -1.691779e-02 1 1  ON 2
 uu_3                -8.213824e-02 1 1  ON 3
 uu_4                -1.194665e-01 1 1  ON 4
 uu_5                -1.418632e-01 1 1  ON 5
 uu_6                -1.547322e-01 1 1  ON 6
 uu_7                -1.565203e-01 1 1  ON 7
 uu_8                -1.449624e-01 1 1  ON 8
 uu_9                -1.135792e-01 1 1  ON 9
 ud_0                 4.398011e-01 1 1  ON 10
 ud_1                 1.576941e-01 1 1  ON 11
 ud_2                 1.195328e-02 1 1  ON 12
 ud_3                -6.787640e-02 1 1  ON 13
 ud_4                -1.148936e-01 1 1  ON 14
 ud_5                -1.445032e-01 1 1  ON 15
 ud_6                -1.620027e-01 1 1  ON 16
 ud_7                -1.676103e-01 1 1  ON 17
 ud_8                -1.584687e-01 1 1  ON 18
 ud_9                -1.297121e-01 1 1  ON 19
 eC_0                -5.630523e-01 1 1  ON 20
 eC_1                -4.086059e-01 1 1  ON 21
 eC_2                -1.598644e-01 1 1  ON 22
 eC_3                -1.442629e-02 1 1  ON 23
 eC_4                 3.195965e-02 1 1  ON 24
 eC_5                 1.165549e-01 1 1  ON 25
 eC_6                 2.342137e-01 1 1  ON 26
 eC_7                 3.966740e-01 1 1  ON 27
 eC_8                 2.846741e-01 1 1  ON 28
 eC_9                 7.526791e-02 1 1  ON 29
 eO_0                -1.242632e+00 1 1  ON 30
 eO_1                -8.645233e-01 1 1  ON 31
 eO_2                -3.853147e-01 1 1  ON 32
 eO_3                -4.092136e-02 1 1  ON 33
 eO_4                 1.881005e-01 1 1  ON 34
 eO_5                 3.724172e-01 1 1  ON 35
 eO_6                 4.621468e-01 1 1  ON 36
 eO_7                 5.231799e-01 1 1  ON 37
 eO_8                 4.809592e-01 1 1  ON 38
 eO_9                 3.316424e-01 1 1  ON 39
eH1_0                -1.845078e-01 1 1  ON 40
eH1_1                -9.708463e-02 1 1  ON 41
eH1_2                -6.434627e-02 1 1  ON 42
eH1_3                -4.835551e-02 1 1  ON 43
eH1_4                 1.232699e-02 1 1  ON 44
eH1_5                 6.914164e-02 1 1  ON 45
eH1_6                 1.254358e-01 1 1  ON 46
eH1_7                 1.005690e-01 1 1  ON 47
eH1_8                 9.992102e-03 1 1  ON 48
eH1_9                -1.706871e-02 1 1  ON 49
eH2_0                -1.867485e-01 1 1  ON 50
eH2_1                -9.862895e-02 1 1  ON 51
eH2_2                -6.546818e-02 1 1  ON 52
eH2_3                -5.028230e-02 1 1  ON 53
eH2_4                 1.053892e-02 1 1  ON 54
eH2_5                 6.769584e-02 1 1  ON 55
eH2_6                 1.245746e-01 1 1  ON 56
eH2_7                 9.977446e-02 1 1  ON 57
eH2_8                 7.629180e-03 1 1  ON 58
eH2_9                -1.120504e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1943e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8745
    reference variance = 0.702634
====================================================
  Execution time = 4.4288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0628e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5090e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505883589367
                                         uncertainty =       0.004690712760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505883589367
                                         uncertainty =       0.004690712760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503128458
  error estimate for blocks of size 2^( 2) =       0.000521099014
  error estimate for blocks of size 2^( 3) =       0.000536840693
  error estimate for blocks of size 2^( 4) =       0.000547996449
  error estimate for blocks of size 2^( 5) =       0.000554223774
  error estimate for blocks of size 2^( 6) =       0.000556641222
  error estimate for blocks of size 2^( 7) =       0.000559852726

      target function =                  N/A
              le_mean =     -22.824575248079
             les_mean =     521.467511492923
             stat err =       0.000554678543
             autocorr =       1.215416047214
              std dev =       0.711531089152
             le_variance =       0.506276490830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282457524808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824575248079       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824577807002       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824576932925       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824576455534       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824576158711       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824576715509       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824577167219       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824577315788       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824577244612       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824577611007       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824576911093       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824576430883       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824577549562       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824577493990       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.824576826686       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.824576924781       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.824576997481       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 1.545184e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824575248079       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824576653336       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824576255681       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824576057482       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824575701964       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824575893612       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824576340399       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824576564784       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824576511552       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824576604537       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824576391041       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824576280785       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824576408444       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824576496941       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 5.523272e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824575248079       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824575749355       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824575648916       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824575578116       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824575418454       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824575421876       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824575628286       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824575764054       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824575720549       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824575736559       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824575699033       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 1.758734e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3065e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.684253e-01 1 1  ON 0
 uu_1                 9.445397e-02 1 1  ON 1
 uu_2                -1.689891e-02 1 1  ON 2
 uu_3                -8.214345e-02 1 1  ON 3
 uu_4                -1.196202e-01 1 1  ON 4
 uu_5                -1.418560e-01 1 1  ON 5
 uu_6                -1.545486e-01 1 1  ON 6
 uu_7                -1.563830e-01 1 1  ON 7
 uu_8                -1.451521e-01 1 1  ON 8
 uu_9                -1.137384e-01 1 1  ON 9
 ud_0                 4.402390e-01 1 1  ON 10
 ud_1                 1.578969e-01 1 1  ON 11
 ud_2                 1.208584e-02 1 1  ON 12
 ud_3                -6.780348e-02 1 1  ON 13
 ud_4                -1.148909e-01 1 1  ON 14
 ud_5                -1.443341e-01 1 1  ON 15
 ud_6                -1.621153e-01 1 1  ON 16
 ud_7                -1.674809e-01 1 1  ON 17
 ud_8                -1.582215e-01 1 1  ON 18
 ud_9                -1.301491e-01 1 1  ON 19
 eC_0                -5.631597e-01 1 1  ON 20
 eC_1                -4.087916e-01 1 1  ON 21
 eC_2                -1.599375e-01 1 1  ON 22
 eC_3                -1.435904e-02 1 1  ON 23
 eC_4                 3.206223e-02 1 1  ON 24
 eC_5                 1.164775e-01 1 1  ON 25
 eC_6                 2.341775e-01 1 1  ON 26
 eC_7                 3.964891e-01 1 1  ON 27
 eC_8                 2.850043e-01 1 1  ON 28
 eC_9                 7.543232e-02 1 1  ON 29
 eO_0                -1.243064e+00 1 1  ON 30
 eO_1                -8.650757e-01 1 1  ON 31
 eO_2                -3.855329e-01 1 1  ON 32
 eO_3                -4.053288e-02 1 1  ON 33
 eO_4                 1.881795e-01 1 1  ON 34
 eO_5                 3.721727e-01 1 1  ON 35
 eO_6                 4.623521e-01 1 1  ON 36
 eO_7                 5.234175e-01 1 1  ON 37
 eO_8                 4.809463e-01 1 1  ON 38
 eO_9                 3.318883e-01 1 1  ON 39
eH1_0                -1.849317e-01 1 1  ON 40
eH1_1                -9.727537e-02 1 1  ON 41
eH1_2                -6.416525e-02 1 1  ON 42
eH1_3                -4.817449e-02 1 1  ON 43
eH1_4                 1.245233e-02 1 1  ON 44
eH1_5                 6.929842e-02 1 1  ON 45
eH1_6                 1.255936e-01 1 1  ON 46
eH1_7                 1.004935e-01 1 1  ON 47
eH1_8                 1.000676e-02 1 1  ON 48
eH1_9                -1.730124e-02 1 1  ON 49
eH2_0                -1.871378e-01 1 1  ON 50
eH2_1                -9.868593e-02 1 1  ON 51
eH2_2                -6.545854e-02 1 1  ON 52
eH2_3                -4.980511e-02 1 1  ON 53
eH2_4                 1.075167e-02 1 1  ON 54
eH2_5                 6.763012e-02 1 1  ON 55
eH2_6                 1.243122e-01 1 1  ON 56
eH2_7                 9.977904e-02 1 1  ON 57
eH2_8                 7.808621e-03 1 1  ON 58
eH2_9                -1.142444e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.9267
    reference variance = 0.895628
====================================================
  Execution time = 4.3815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0092e-01
  Total weights = 2.0000e+06
  Execution time = 3.5352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500438246113
                                         uncertainty =       0.003327293266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500438246113
                                         uncertainty =       0.003327293266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500191236
  error estimate for blocks of size 2^( 2) =       0.000518360936
  error estimate for blocks of size 2^( 3) =       0.000534474996
  error estimate for blocks of size 2^( 4) =       0.000544855760
  error estimate for blocks of size 2^( 5) =       0.000552648029
  error estimate for blocks of size 2^( 6) =       0.000556072550
  error estimate for blocks of size 2^( 7) =       0.000556390039

      target function =                  N/A
              le_mean =     -22.826411349083
             les_mean =     521.545437372728
             stat err =       0.000552491594
             autocorr =       1.220054394910
              std dev =       0.707377229884
             le_variance =       0.500382545359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501329357077
                                         uncertainty =       0.003333620124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501329357077
                                         uncertainty =       0.003333620124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500636089
  error estimate for blocks of size 2^( 2) =       0.000518782966
  error estimate for blocks of size 2^( 3) =       0.000534871938
  error estimate for blocks of size 2^( 4) =       0.000545239690
  error estimate for blocks of size 2^( 5) =       0.000553024869
  error estimate for blocks of size 2^( 6) =       0.000556441256
  error estimate for blocks of size 2^( 7) =       0.000556734708

      target function =                  N/A
              le_mean =     -22.826417101983
             les_mean =     521.546590450657
             stat err =       0.000552860131
             autocorr =       1.219512447617
              std dev =       0.708006347155
             le_variance =       0.501272987612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501522054367
                                         uncertainty =       0.003334709350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501522054367
                                         uncertainty =       0.003334709350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500732216
  error estimate for blocks of size 2^( 2) =       0.000518875259
  error estimate for blocks of size 2^( 3) =       0.000534960309
  error estimate for blocks of size 2^( 4) =       0.000545326667
  error estimate for blocks of size 2^( 5) =       0.000553112166
  error estimate for blocks of size 2^( 6) =       0.000556530791
  error estimate for blocks of size 2^( 7) =       0.000556822900

      target function =                  N/A
              le_mean =     -22.826417898690
             les_mean =     521.546819339291
             stat err =       0.000552948131
             autocorr =       1.219432375010
              std dev =       0.708142291054
             le_variance =       0.501465504380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500668552881
                                         uncertainty =       0.003328845833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500668552881
                                         uncertainty =       0.003328845833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500306239
  error estimate for blocks of size 2^( 2) =       0.000518470116
  error estimate for blocks of size 2^( 3) =       0.000534577789
  error estimate for blocks of size 2^( 4) =       0.000544955664
  error estimate for blocks of size 2^( 5) =       0.000552746503
  error estimate for blocks of size 2^( 6) =       0.000556170138
  error estimate for blocks of size 2^( 7) =       0.000556482826

      target function =                  N/A
              le_mean =     -22.826411618800
             les_mean =     521.545679805684
             stat err =       0.000552588783
             autocorr =       1.219922643424
              std dev =       0.707539868212
             le_variance =       0.500612665109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826411349083        initial
     6.1035e-02     6.1035e-01             1.5452e-03       -22.826417101983
     2.4414e-01     2.4414e+00             5.5233e-04       -22.826417898690  <--
     9.7656e-01     9.7656e+00             1.7587e-04       -22.826411618800

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 6.1550e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.684253e-01 1 1  ON 0
 uu_1                 9.445397e-02 1 1  ON 1
 uu_2                -1.689891e-02 1 1  ON 2
 uu_3                -8.214345e-02 1 1  ON 3
 uu_4                -1.196202e-01 1 1  ON 4
 uu_5                -1.418560e-01 1 1  ON 5
 uu_6                -1.545486e-01 1 1  ON 6
 uu_7                -1.563830e-01 1 1  ON 7
 uu_8                -1.451521e-01 1 1  ON 8
 uu_9                -1.137384e-01 1 1  ON 9
 ud_0                 4.402390e-01 1 1  ON 10
 ud_1                 1.578969e-01 1 1  ON 11
 ud_2                 1.208584e-02 1 1  ON 12
 ud_3                -6.780348e-02 1 1  ON 13
 ud_4                -1.148909e-01 1 1  ON 14
 ud_5                -1.443341e-01 1 1  ON 15
 ud_6                -1.621153e-01 1 1  ON 16
 ud_7                -1.674809e-01 1 1  ON 17
 ud_8                -1.582215e-01 1 1  ON 18
 ud_9                -1.301491e-01 1 1  ON 19
 eC_0                -5.631597e-01 1 1  ON 20
 eC_1                -4.087916e-01 1 1  ON 21
 eC_2                -1.599375e-01 1 1  ON 22
 eC_3                -1.435904e-02 1 1  ON 23
 eC_4                 3.206223e-02 1 1  ON 24
 eC_5                 1.164775e-01 1 1  ON 25
 eC_6                 2.341775e-01 1 1  ON 26
 eC_7                 3.964891e-01 1 1  ON 27
 eC_8                 2.850043e-01 1 1  ON 28
 eC_9                 7.543232e-02 1 1  ON 29
 eO_0                -1.243064e+00 1 1  ON 30
 eO_1                -8.650757e-01 1 1  ON 31
 eO_2                -3.855329e-01 1 1  ON 32
 eO_3                -4.053288e-02 1 1  ON 33
 eO_4                 1.881795e-01 1 1  ON 34
 eO_5                 3.721727e-01 1 1  ON 35
 eO_6                 4.623521e-01 1 1  ON 36
 eO_7                 5.234175e-01 1 1  ON 37
 eO_8                 4.809463e-01 1 1  ON 38
 eO_9                 3.318883e-01 1 1  ON 39
eH1_0                -1.849317e-01 1 1  ON 40
eH1_1                -9.727537e-02 1 1  ON 41
eH1_2                -6.416525e-02 1 1  ON 42
eH1_3                -4.817449e-02 1 1  ON 43
eH1_4                 1.245233e-02 1 1  ON 44
eH1_5                 6.929842e-02 1 1  ON 45
eH1_6                 1.255936e-01 1 1  ON 46
eH1_7                 1.004935e-01 1 1  ON 47
eH1_8                 1.000676e-02 1 1  ON 48
eH1_9                -1.730124e-02 1 1  ON 49
eH2_0                -1.871378e-01 1 1  ON 50
eH2_1                -9.868593e-02 1 1  ON 51
eH2_2                -6.545854e-02 1 1  ON 52
eH2_3                -4.980511e-02 1 1  ON 53
eH2_4                 1.075167e-02 1 1  ON 54
eH2_5                 6.763012e-02 1 1  ON 55
eH2_6                 1.243122e-01 1 1  ON 56
eH2_7                 9.977904e-02 1 1  ON 57
eH2_8                 7.808621e-03 1 1  ON 58
eH2_9                -1.142444e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2462e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8636
    reference variance = 0.577718
====================================================
  Execution time = 4.4197e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0665e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4943e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506719034074
                                         uncertainty =       0.004018219510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506719034074
                                         uncertainty =       0.004018219510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503316307
  error estimate for blocks of size 2^( 2) =       0.000520861043
  error estimate for blocks of size 2^( 3) =       0.000536419583
  error estimate for blocks of size 2^( 4) =       0.000547198585
  error estimate for blocks of size 2^( 5) =       0.000553955802
  error estimate for blocks of size 2^( 6) =       0.000558486023
  error estimate for blocks of size 2^( 7) =       0.000560750192

      target function =                  N/A
              le_mean =     -22.825619201742
             les_mean =     521.515546300079
             stat err =       0.000555097650
             autocorr =       1.216345001831
              std dev =       0.711796748011
             le_variance =       0.506654610479


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282561920174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825619201742       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825622329443       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825623128591       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825623610013       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825623880637       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825623062693       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825624903024       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825626535112       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825625694675       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825625360531       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825624106049       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825624905969       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825626492228       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825625900386       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825626367774       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825625657372       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825625402532       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-02 is 1.710450e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825619201742       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825621228342       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825621765107       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825621916621       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825621876929       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825621516570       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825622446457       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825623403872       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825622666846       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825622413815       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825622196831       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825622391737       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825622583200       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e-01 is 4.960493e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825619201742       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825620043286       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825620311532       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825620370190       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825620291580       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825620063929       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825620300650       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825620664001       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825620495681       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825620378341       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825620346463       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 1.702910e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9151e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.683351e-01 1 1  ON 0
 uu_1                 9.452409e-02 1 1  ON 1
 uu_2                -1.679956e-02 1 1  ON 2
 uu_3                -8.224610e-02 1 1  ON 3
 uu_4                -1.196438e-01 1 1  ON 4
 uu_5                -1.420388e-01 1 1  ON 5
 uu_6                -1.548478e-01 1 1  ON 6
 uu_7                -1.565638e-01 1 1  ON 7
 uu_8                -1.449077e-01 1 1  ON 8
 uu_9                -1.134299e-01 1 1  ON 9
 ud_0                 4.401149e-01 1 1  ON 10
 ud_1                 1.578116e-01 1 1  ON 11
 ud_2                 1.212716e-02 1 1  ON 12
 ud_3                -6.772519e-02 1 1  ON 13
 ud_4                -1.146195e-01 1 1  ON 14
 ud_5                -1.442528e-01 1 1  ON 15
 ud_6                -1.620101e-01 1 1  ON 16
 ud_7                -1.678570e-01 1 1  ON 17
 ud_8                -1.578748e-01 1 1  ON 18
 ud_9                -1.299004e-01 1 1  ON 19
 eC_0                -5.633703e-01 1 1  ON 20
 eC_1                -4.089003e-01 1 1  ON 21
 eC_2                -1.601147e-01 1 1  ON 22
 eC_3                -1.452919e-02 1 1  ON 23
 eC_4                 3.213516e-02 1 1  ON 24
 eC_5                 1.166435e-01 1 1  ON 25
 eC_6                 2.339910e-01 1 1  ON 26
 eC_7                 3.964199e-01 1 1  ON 27
 eC_8                 2.854341e-01 1 1  ON 28
 eC_9                 7.565776e-02 1 1  ON 29
 eO_0                -1.243465e+00 1 1  ON 30
 eO_1                -8.649224e-01 1 1  ON 31
 eO_2                -3.857902e-01 1 1  ON 32
 eO_3                -4.094658e-02 1 1  ON 33
 eO_4                 1.879485e-01 1 1  ON 34
 eO_5                 3.719734e-01 1 1  ON 35
 eO_6                 4.627379e-01 1 1  ON 36
 eO_7                 5.235367e-01 1 1  ON 37
 eO_8                 4.810760e-01 1 1  ON 38
 eO_9                 3.322486e-01 1 1  ON 39
eH1_0                -1.852064e-01 1 1  ON 40
eH1_1                -9.735445e-02 1 1  ON 41
eH1_2                -6.423469e-02 1 1  ON 42
eH1_3                -4.816835e-02 1 1  ON 43
eH1_4                 1.262416e-02 1 1  ON 44
eH1_5                 6.941748e-02 1 1  ON 45
eH1_6                 1.259630e-01 1 1  ON 46
eH1_7                 1.001526e-01 1 1  ON 47
eH1_8                 1.002676e-02 1 1  ON 48
eH1_9                -1.738528e-02 1 1  ON 49
eH2_0                -1.869423e-01 1 1  ON 50
eH2_1                -9.879945e-02 1 1  ON 51
eH2_2                -6.595459e-02 1 1  ON 52
eH2_3                -4.997604e-02 1 1  ON 53
eH2_4                 1.070967e-02 1 1  ON 54
eH2_5                 6.772553e-02 1 1  ON 55
eH2_6                 1.242882e-01 1 1  ON 56
eH2_7                 1.001682e-01 1 1  ON 57
eH2_8                 8.036697e-03 1 1  ON 58
eH2_9                -1.164230e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8499
    reference variance = 0.324689
====================================================
  Execution time = 4.3192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9545e-01
  Total weights = 2.0000e+06
  Execution time = 3.5277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495608049260
                                         uncertainty =       0.002631487753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495608049260
                                         uncertainty =       0.002631487753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497793927
  error estimate for blocks of size 2^( 2) =       0.000515477733
  error estimate for blocks of size 2^( 3) =       0.000530994482
  error estimate for blocks of size 2^( 4) =       0.000541863836
  error estimate for blocks of size 2^( 5) =       0.000549308308
  error estimate for blocks of size 2^( 6) =       0.000551807225
  error estimate for blocks of size 2^( 7) =       0.000554631096

      target function =                  N/A
              le_mean =     -22.824686036873
             les_mean =     521.461890020795
             stat err =       0.000549402616
             autocorr =       1.218098080617
              std dev =       0.703986922308
             le_variance =       0.495597586780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495400333085
                                         uncertainty =       0.002629954078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495400333085
                                         uncertainty =       0.002629954078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497689603
  error estimate for blocks of size 2^( 2) =       0.000515380327
  error estimate for blocks of size 2^( 3) =       0.000530905629
  error estimate for blocks of size 2^( 4) =       0.000541783234
  error estimate for blocks of size 2^( 5) =       0.000549232257
  error estimate for blocks of size 2^( 6) =       0.000551747657
  error estimate for blocks of size 2^( 7) =       0.000554588746

      target function =                  N/A
              le_mean =     -22.824684388969
             les_mean =     521.461607090622
             stat err =       0.000549337973
             autocorr =       1.218322051956
              std dev =       0.703839386707
             le_variance =       0.495389882280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322126061
                                         uncertainty =       0.002629054664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495322126061
                                         uncertainty =       0.002629054664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497650373
  error estimate for blocks of size 2^( 2) =       0.000515341932
  error estimate for blocks of size 2^( 3) =       0.000530869724
  error estimate for blocks of size 2^( 4) =       0.000541749251
  error estimate for blocks of size 2^( 5) =       0.000549200051
  error estimate for blocks of size 2^( 6) =       0.000551719977
  error estimate for blocks of size 2^( 7) =       0.000554564326

      target function =                  N/A
              le_mean =     -22.824682120393
             les_mean =     521.461425437719
             stat err =       0.000549308401
             autocorr =       1.218382953269
              std dev =       0.703783907462
             le_variance =       0.495311788403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495529954627
                                         uncertainty =       0.002630793814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495529954627
                                         uncertainty =       0.002630793814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497754725
  error estimate for blocks of size 2^( 2) =       0.000515440132
  error estimate for blocks of size 2^( 3) =       0.000530959212
  error estimate for blocks of size 2^( 4) =       0.000541830396
  error estimate for blocks of size 2^( 5) =       0.000549275963
  error estimate for blocks of size 2^( 6) =       0.000551779458
  error estimate for blocks of size 2^( 7) =       0.000554607703

      target function =                  N/A
              le_mean =     -22.824683976384
             les_mean =     521.461717905963
             stat err =       0.000549373380
             autocorr =       1.218160299962
              std dev =       0.703931482401
             le_variance =       0.495519531915


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824686036873        initial  <--
     6.1035e-02     6.1035e-01             1.7104e-03       -22.824684388969
     2.4414e-01     2.4414e+00             4.9605e-04       -22.824682120393
     9.7656e-01     9.7656e+00             1.7029e-04       -22.824683976384

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8849
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.684253e-01 1 1  ON 0
 uu_1                 9.445397e-02 1 1  ON 1
 uu_2                -1.689891e-02 1 1  ON 2
 uu_3                -8.214345e-02 1 1  ON 3
 uu_4                -1.196202e-01 1 1  ON 4
 uu_5                -1.418560e-01 1 1  ON 5
 uu_6                -1.545486e-01 1 1  ON 6
 uu_7                -1.563830e-01 1 1  ON 7
 uu_8                -1.451521e-01 1 1  ON 8
 uu_9                -1.137384e-01 1 1  ON 9
 ud_0                 4.402390e-01 1 1  ON 10
 ud_1                 1.578969e-01 1 1  ON 11
 ud_2                 1.208584e-02 1 1  ON 12
 ud_3                -6.780348e-02 1 1  ON 13
 ud_4                -1.148909e-01 1 1  ON 14
 ud_5                -1.443341e-01 1 1  ON 15
 ud_6                -1.621153e-01 1 1  ON 16
 ud_7                -1.674809e-01 1 1  ON 17
 ud_8                -1.582215e-01 1 1  ON 18
 ud_9                -1.301491e-01 1 1  ON 19
 eC_0                -5.631597e-01 1 1  ON 20
 eC_1                -4.087916e-01 1 1  ON 21
 eC_2                -1.599375e-01 1 1  ON 22
 eC_3                -1.435904e-02 1 1  ON 23
 eC_4                 3.206223e-02 1 1  ON 24
 eC_5                 1.164775e-01 1 1  ON 25
 eC_6                 2.341775e-01 1 1  ON 26
 eC_7                 3.964891e-01 1 1  ON 27
 eC_8                 2.850043e-01 1 1  ON 28
 eC_9                 7.543232e-02 1 1  ON 29
 eO_0                -1.243064e+00 1 1  ON 30
 eO_1                -8.650757e-01 1 1  ON 31
 eO_2                -3.855329e-01 1 1  ON 32
 eO_3                -4.053288e-02 1 1  ON 33
 eO_4                 1.881795e-01 1 1  ON 34
 eO_5                 3.721727e-01 1 1  ON 35
 eO_6                 4.623521e-01 1 1  ON 36
 eO_7                 5.234175e-01 1 1  ON 37
 eO_8                 4.809463e-01 1 1  ON 38
 eO_9                 3.318883e-01 1 1  ON 39
eH1_0                -1.849317e-01 1 1  ON 40
eH1_1                -9.727537e-02 1 1  ON 41
eH1_2                -6.416525e-02 1 1  ON 42
eH1_3                -4.817449e-02 1 1  ON 43
eH1_4                 1.245233e-02 1 1  ON 44
eH1_5                 6.929842e-02 1 1  ON 45
eH1_6                 1.255936e-01 1 1  ON 46
eH1_7                 1.004935e-01 1 1  ON 47
eH1_8                 1.000676e-02 1 1  ON 48
eH1_9                -1.730124e-02 1 1  ON 49
eH2_0                -1.871378e-01 1 1  ON 50
eH2_1                -9.868593e-02 1 1  ON 51
eH2_2                -6.545854e-02 1 1  ON 52
eH2_3                -4.980511e-02 1 1  ON 53
eH2_4                 1.075167e-02 1 1  ON 54
eH2_5                 6.763012e-02 1 1  ON 55
eH2_6                 1.243122e-01 1 1  ON 56
eH2_7                 9.977904e-02 1 1  ON 57
eH2_8                 7.808621e-03 1 1  ON 58
eH2_9                -1.142444e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2004e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8704
    reference variance = 0.292141
====================================================
  Execution time = 4.4105e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9897e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4936e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498952544739
                                         uncertainty =       0.003041757957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498952544739
                                         uncertainty =       0.003041757957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499485388
  error estimate for blocks of size 2^( 2) =       0.000517064255
  error estimate for blocks of size 2^( 3) =       0.000532566160
  error estimate for blocks of size 2^( 4) =       0.000544101449
  error estimate for blocks of size 2^( 5) =       0.000550763487
  error estimate for blocks of size 2^( 6) =       0.000553790796
  error estimate for blocks of size 2^( 7) =       0.000552758041

      target function =                  N/A
              le_mean =     -22.825649247327
             les_mean =     521.509234618771
             stat err =       0.000550353443
             autocorr =       1.214053428871
              std dev =       0.706379010337
             le_variance =       0.498971306244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282564924733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825649247327       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825649747411       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825649398976       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825650066210       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825650280125       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825650250907       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825650063367       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825649948556       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825650029590       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825650100843       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825650059190       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825650141735       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e-01 is 2.947564e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825649247327       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825649407780       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825649267600       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825649467416       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825649550333       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825649547564       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825649532632       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825649462352       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825649489079       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825649466628       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+00 is 7.491169e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825649247327       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825649290499       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825649250313       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825649305616       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825649326903       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825649325203       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825649324536       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825649304249       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825649308768       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825649299471       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 1.948544e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203317 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9049e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.684213e-01 1 1  ON 0
 uu_1                 9.442276e-02 1 1  ON 1
 uu_2                -1.684442e-02 1 1  ON 2
 uu_3                -8.216506e-02 1 1  ON 3
 uu_4                -1.195747e-01 1 1  ON 4
 uu_5                -1.418774e-01 1 1  ON 5
 uu_6                -1.545107e-01 1 1  ON 6
 uu_7                -1.564129e-01 1 1  ON 7
 uu_8                -1.451482e-01 1 1  ON 8
 uu_9                -1.137487e-01 1 1  ON 9
 ud_0                 4.402751e-01 1 1  ON 10
 ud_1                 1.578941e-01 1 1  ON 11
 ud_2                 1.212366e-02 1 1  ON 12
 ud_3                -6.780340e-02 1 1  ON 13
 ud_4                -1.148288e-01 1 1  ON 14
 ud_5                -1.443588e-01 1 1  ON 15
 ud_6                -1.621004e-01 1 1  ON 16
 ud_7                -1.675207e-01 1 1  ON 17
 ud_8                -1.582267e-01 1 1  ON 18
 ud_9                -1.301597e-01 1 1  ON 19
 eC_0                -5.632054e-01 1 1  ON 20
 eC_1                -4.088211e-01 1 1  ON 21
 eC_2                -1.599363e-01 1 1  ON 22
 eC_3                -1.435705e-02 1 1  ON 23
 eC_4                 3.209526e-02 1 1  ON 24
 eC_5                 1.165257e-01 1 1  ON 25
 eC_6                 2.341449e-01 1 1  ON 26
 eC_7                 3.964666e-01 1 1  ON 27
 eC_8                 2.850352e-01 1 1  ON 28
 eC_9                 7.544636e-02 1 1  ON 29
 eO_0                -1.243078e+00 1 1  ON 30
 eO_1                -8.650641e-01 1 1  ON 31
 eO_2                -3.855262e-01 1 1  ON 32
 eO_3                -4.057700e-02 1 1  ON 33
 eO_4                 1.881611e-01 1 1  ON 34
 eO_5                 3.721525e-01 1 1  ON 35
 eO_6                 4.623383e-01 1 1  ON 36
 eO_7                 5.234323e-01 1 1  ON 37
 eO_8                 4.809508e-01 1 1  ON 38
 eO_9                 3.319285e-01 1 1  ON 39
eH1_0                -1.849572e-01 1 1  ON 40
eH1_1                -9.729359e-02 1 1  ON 41
eH1_2                -6.417455e-02 1 1  ON 42
eH1_3                -4.820985e-02 1 1  ON 43
eH1_4                 1.243870e-02 1 1  ON 44
eH1_5                 6.928300e-02 1 1  ON 45
eH1_6                 1.256685e-01 1 1  ON 46
eH1_7                 1.005662e-01 1 1  ON 47
eH1_8                 9.990815e-03 1 1  ON 48
eH1_9                -1.732497e-02 1 1  ON 49
eH2_0                -1.871491e-01 1 1  ON 50
eH2_1                -9.871890e-02 1 1  ON 51
eH2_2                -6.547529e-02 1 1  ON 52
eH2_3                -4.978990e-02 1 1  ON 53
eH2_4                 1.076911e-02 1 1  ON 54
eH2_5                 6.768392e-02 1 1  ON 55
eH2_6                 1.243472e-01 1 1  ON 56
eH2_7                 9.977314e-02 1 1  ON 57
eH2_8                 7.781715e-03 1 1  ON 58
eH2_9                -1.145190e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8729
    reference variance = 0.288974
====================================================
  Execution time = 4.4170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0696e-01
  Total weights = 2.0000e+06
  Execution time = 3.5442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507024073219
                                         uncertainty =       0.005115212645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507024073219
                                         uncertainty =       0.005115212645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503479168
  error estimate for blocks of size 2^( 2) =       0.000521502728
  error estimate for blocks of size 2^( 3) =       0.000537406856
  error estimate for blocks of size 2^( 4) =       0.000547863542
  error estimate for blocks of size 2^( 5) =       0.000553636922
  error estimate for blocks of size 2^( 6) =       0.000557621799
  error estimate for blocks of size 2^( 7) =       0.000560030894

      target function =                  N/A
              le_mean =     -22.826146208595
             les_mean =     521.539933027558
             stat err =       0.000554788289
             autocorr =       1.214203718645
              std dev =       0.712027067537
             le_variance =       0.506982544906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506952102978
                                         uncertainty =       0.005114601874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506952102978
                                         uncertainty =       0.005114601874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503443485
  error estimate for blocks of size 2^( 2) =       0.000521466215
  error estimate for blocks of size 2^( 3) =       0.000537372419
  error estimate for blocks of size 2^( 4) =       0.000547827996
  error estimate for blocks of size 2^( 5) =       0.000553605670
  error estimate for blocks of size 2^( 6) =       0.000557602321
  error estimate for blocks of size 2^( 7) =       0.000560000055

      target function =                  N/A
              le_mean =     -22.826144871390
             les_mean =     521.539800121615
             stat err =       0.000554759010
             autocorr =       1.214247671430
              std dev =       0.711976604519
             le_variance =       0.506910685383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506970988029
                                         uncertainty =       0.005114859195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506970988029
                                         uncertainty =       0.005114859195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503452864
  error estimate for blocks of size 2^( 2) =       0.000521475877
  error estimate for blocks of size 2^( 3) =       0.000537381625
  error estimate for blocks of size 2^( 4) =       0.000547837498
  error estimate for blocks of size 2^( 5) =       0.000553613817
  error estimate for blocks of size 2^( 6) =       0.000557607062
  error estimate for blocks of size 2^( 7) =       0.000560006818

      target function =                  N/A
              le_mean =     -22.826145545971
             les_mean =     521.539849804729
             stat err =       0.000554766299
             autocorr =       1.214234336305
              std dev =       0.711989868156
             le_variance =       0.506929572356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507016057258
                                         uncertainty =       0.005115166203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507016057258
                                         uncertainty =       0.005115166203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503475196
  error estimate for blocks of size 2^( 2) =       0.000521498682
  error estimate for blocks of size 2^( 3) =       0.000537403036
  error estimate for blocks of size 2^( 4) =       0.000547859598
  error estimate for blocks of size 2^( 5) =       0.000553633389
  error estimate for blocks of size 2^( 6) =       0.000557619454
  error estimate for blocks of size 2^( 7) =       0.000560027162

      target function =                  N/A
              le_mean =     -22.826146093395
             les_mean =     521.539919770222
             stat err =       0.000554784900
             autocorr =       1.214208041443
              std dev =       0.712021451006
             le_variance =       0.506974546692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826146208595        initial  <--
     6.1035e-01     6.1035e+00             2.9476e-04       -22.826144871390
     2.4414e+00     2.4414e+01             7.4912e-05       -22.826145545971
     9.7656e+00     9.7656e+01             1.9485e-05       -22.826146093395

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.3509
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.684253e-01 1 1  ON 0
 uu_1                 9.445397e-02 1 1  ON 1
 uu_2                -1.689891e-02 1 1  ON 2
 uu_3                -8.214345e-02 1 1  ON 3
 uu_4                -1.196202e-01 1 1  ON 4
 uu_5                -1.418560e-01 1 1  ON 5
 uu_6                -1.545486e-01 1 1  ON 6
 uu_7                -1.563830e-01 1 1  ON 7
 uu_8                -1.451521e-01 1 1  ON 8
 uu_9                -1.137384e-01 1 1  ON 9
 ud_0                 4.402390e-01 1 1  ON 10
 ud_1                 1.578969e-01 1 1  ON 11
 ud_2                 1.208584e-02 1 1  ON 12
 ud_3                -6.780348e-02 1 1  ON 13
 ud_4                -1.148909e-01 1 1  ON 14
 ud_5                -1.443341e-01 1 1  ON 15
 ud_6                -1.621153e-01 1 1  ON 16
 ud_7                -1.674809e-01 1 1  ON 17
 ud_8                -1.582215e-01 1 1  ON 18
 ud_9                -1.301491e-01 1 1  ON 19
 eC_0                -5.631597e-01 1 1  ON 20
 eC_1                -4.087916e-01 1 1  ON 21
 eC_2                -1.599375e-01 1 1  ON 22
 eC_3                -1.435904e-02 1 1  ON 23
 eC_4                 3.206223e-02 1 1  ON 24
 eC_5                 1.164775e-01 1 1  ON 25
 eC_6                 2.341775e-01 1 1  ON 26
 eC_7                 3.964891e-01 1 1  ON 27
 eC_8                 2.850043e-01 1 1  ON 28
 eC_9                 7.543232e-02 1 1  ON 29
 eO_0                -1.243064e+00 1 1  ON 30
 eO_1                -8.650757e-01 1 1  ON 31
 eO_2                -3.855329e-01 1 1  ON 32
 eO_3                -4.053288e-02 1 1  ON 33
 eO_4                 1.881795e-01 1 1  ON 34
 eO_5                 3.721727e-01 1 1  ON 35
 eO_6                 4.623521e-01 1 1  ON 36
 eO_7                 5.234175e-01 1 1  ON 37
 eO_8                 4.809463e-01 1 1  ON 38
 eO_9                 3.318883e-01 1 1  ON 39
eH1_0                -1.849317e-01 1 1  ON 40
eH1_1                -9.727537e-02 1 1  ON 41
eH1_2                -6.416525e-02 1 1  ON 42
eH1_3                -4.817449e-02 1 1  ON 43
eH1_4                 1.245233e-02 1 1  ON 44
eH1_5                 6.929842e-02 1 1  ON 45
eH1_6                 1.255936e-01 1 1  ON 46
eH1_7                 1.004935e-01 1 1  ON 47
eH1_8                 1.000676e-02 1 1  ON 48
eH1_9                -1.730124e-02 1 1  ON 49
eH2_0                -1.871378e-01 1 1  ON 50
eH2_1                -9.868593e-02 1 1  ON 51
eH2_2                -6.545854e-02 1 1  ON 52
eH2_3                -4.980511e-02 1 1  ON 53
eH2_4                 1.075167e-02 1 1  ON 54
eH2_5                 6.763012e-02 1 1  ON 55
eH2_6                 1.243122e-01 1 1  ON 56
eH2_7                 9.977904e-02 1 1  ON 57
eH2_8                 7.808621e-03 1 1  ON 58
eH2_9                -1.142444e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2241e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2841e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7961
    reference variance = 0.390796
====================================================
  Execution time = 4.3804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0506e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4940e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505116481161
                                         uncertainty =       0.003442182541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505116481161
                                         uncertainty =       0.003442182541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502525590
  error estimate for blocks of size 2^( 2) =       0.000520209391
  error estimate for blocks of size 2^( 3) =       0.000535334360
  error estimate for blocks of size 2^( 4) =       0.000545523785
  error estimate for blocks of size 2^( 5) =       0.000552376890
  error estimate for blocks of size 2^( 6) =       0.000555584867
  error estimate for blocks of size 2^( 7) =       0.000560004242

      target function =                  N/A
              le_mean =     -22.826199846353
             les_mean =     521.540463110021
             stat err =       0.000553372446
             autocorr =       1.212603163759
              std dev =       0.710678504598
             le_variance =       0.505063936898


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282619984635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826199846353       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826199740193       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826199813159       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826199991025       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826200078618       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826200112049       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826200146515       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826200179274       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826200156244       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826200155857       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 3.166534e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826199846353       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826199819268       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826199837549       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826199883290       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826199906557       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826199914999       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826199923982       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826199931892       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826199926560       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 8.144080e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826199846353       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826199839547       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826199844119       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826199855637       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826199861543       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826199863661       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826199865929       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826199867888       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826199866586       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 2.046855e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8752e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.684247e-01 1 1  ON 0
 uu_1                 9.445831e-02 1 1  ON 1
 uu_2                -1.689927e-02 1 1  ON 2
 uu_3                -8.214344e-02 1 1  ON 3
 uu_4                -1.196183e-01 1 1  ON 4
 uu_5                -1.418577e-01 1 1  ON 5
 uu_6                -1.545492e-01 1 1  ON 6
 uu_7                -1.563875e-01 1 1  ON 7
 uu_8                -1.451510e-01 1 1  ON 8
 uu_9                -1.137376e-01 1 1  ON 9
 ud_0                 4.402429e-01 1 1  ON 10
 ud_1                 1.578967e-01 1 1  ON 11
 ud_2                 1.208856e-02 1 1  ON 12
 ud_3                -6.780404e-02 1 1  ON 13
 ud_4                -1.148897e-01 1 1  ON 14
 ud_5                -1.443354e-01 1 1  ON 15
 ud_6                -1.621141e-01 1 1  ON 16
 ud_7                -1.674816e-01 1 1  ON 17
 ud_8                -1.582234e-01 1 1  ON 18
 ud_9                -1.301496e-01 1 1  ON 19
 eC_0                -5.631628e-01 1 1  ON 20
 eC_1                -4.087901e-01 1 1  ON 21
 eC_2                -1.599414e-01 1 1  ON 22
 eC_3                -1.436182e-02 1 1  ON 23
 eC_4                 3.207019e-02 1 1  ON 24
 eC_5                 1.164785e-01 1 1  ON 25
 eC_6                 2.341714e-01 1 1  ON 26
 eC_7                 3.964875e-01 1 1  ON 27
 eC_8                 2.850089e-01 1 1  ON 28
 eC_9                 7.543435e-02 1 1  ON 29
 eO_0                -1.243068e+00 1 1  ON 30
 eO_1                -8.650729e-01 1 1  ON 31
 eO_2                -3.855372e-01 1 1  ON 32
 eO_3                -4.053262e-02 1 1  ON 33
 eO_4                 1.881714e-01 1 1  ON 34
 eO_5                 3.721750e-01 1 1  ON 35
 eO_6                 4.623553e-01 1 1  ON 36
 eO_7                 5.234191e-01 1 1  ON 37
 eO_8                 4.809458e-01 1 1  ON 38
 eO_9                 3.318917e-01 1 1  ON 39
eH1_0                -1.849335e-01 1 1  ON 40
eH1_1                -9.727322e-02 1 1  ON 41
eH1_2                -6.416790e-02 1 1  ON 42
eH1_3                -4.817872e-02 1 1  ON 43
eH1_4                 1.245332e-02 1 1  ON 44
eH1_5                 6.929738e-02 1 1  ON 45
eH1_6                 1.256013e-01 1 1  ON 46
eH1_7                 1.004940e-01 1 1  ON 47
eH1_8                 1.000597e-02 1 1  ON 48
eH1_9                -1.730313e-02 1 1  ON 49
eH2_0                -1.871328e-01 1 1  ON 50
eH2_1                -9.868780e-02 1 1  ON 51
eH2_2                -6.546269e-02 1 1  ON 52
eH2_3                -4.980577e-02 1 1  ON 53
eH2_4                 1.075597e-02 1 1  ON 54
eH2_5                 6.762870e-02 1 1  ON 55
eH2_6                 1.243142e-01 1 1  ON 56
eH2_7                 9.977502e-02 1 1  ON 57
eH2_8                 7.808777e-03 1 1  ON 58
eH2_9                -1.142547e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8514
    reference variance = 0.429819
====================================================
  Execution time = 4.2774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1554e-01
  Total weights = 2.0000e+06
  Execution time = 3.5168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515673884939
                                         uncertainty =       0.007769054479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515673884939
                                         uncertainty =       0.007769054479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507710609
  error estimate for blocks of size 2^( 2) =       0.000525380144
  error estimate for blocks of size 2^( 3) =       0.000540519934
  error estimate for blocks of size 2^( 4) =       0.000551818173
  error estimate for blocks of size 2^( 5) =       0.000559716681
  error estimate for blocks of size 2^( 6) =       0.000563127894
  error estimate for blocks of size 2^( 7) =       0.000569436588

      target function =                  N/A
              le_mean =     -22.825642775516
             les_mean =     521.525507982629
             stat err =       0.000561024834
             autocorr =       1.221045070982
              std dev =       0.718011228977
             le_variance =       0.515540124937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515692459704
                                         uncertainty =       0.007769157674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515692459704
                                         uncertainty =       0.007769157674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507719755
  error estimate for blocks of size 2^( 2) =       0.000525388729
  error estimate for blocks of size 2^( 3) =       0.000540527867
  error estimate for blocks of size 2^( 4) =       0.000551825784
  error estimate for blocks of size 2^( 5) =       0.000559724125
  error estimate for blocks of size 2^( 6) =       0.000563134792
  error estimate for blocks of size 2^( 7) =       0.000569443873

      target function =                  N/A
              le_mean =     -22.825642823414
             les_mean =     521.525528743294
             stat err =       0.000561032143
             autocorr =       1.221032896569
              std dev =       0.718024163238
             le_variance =       0.515558698993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515683357754
                                         uncertainty =       0.007769091135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515683357754
                                         uncertainty =       0.007769091135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507715273
  error estimate for blocks of size 2^( 2) =       0.000525384525
  error estimate for blocks of size 2^( 3) =       0.000540523987
  error estimate for blocks of size 2^( 4) =       0.000551822075
  error estimate for blocks of size 2^( 5) =       0.000559720501
  error estimate for blocks of size 2^( 6) =       0.000563131417
  error estimate for blocks of size 2^( 7) =       0.000569440359

      target function =                  N/A
              le_mean =     -22.825642801987
             les_mean =     521.525518663926
             stat err =       0.000561028588
             autocorr =       1.221038976261
              std dev =       0.718017825539
             le_variance =       0.515549597791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515675083820
                                         uncertainty =       0.007769058962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515675083820
                                         uncertainty =       0.007769058962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507711199
  error estimate for blocks of size 2^( 2) =       0.000525380698
  error estimate for blocks of size 2^( 3) =       0.000540520447
  error estimate for blocks of size 2^( 4) =       0.000551818667
  error estimate for blocks of size 2^( 5) =       0.000559717164
  error estimate for blocks of size 2^( 6) =       0.000563128340
  error estimate for blocks of size 2^( 7) =       0.000569437065

      target function =                  N/A
              le_mean =     -22.825642778770
             les_mean =     521.525509330085
             stat err =       0.000561025309
             autocorr =       1.221044300384
              std dev =       0.718012063844
             le_variance =       0.515541323826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825642775516        initial
     6.1035e+00     6.1035e+01             3.1665e-05       -22.825642823414  <--
     2.4414e+01     2.4414e+02             8.1441e-06       -22.825642801987
     9.7656e+01     9.7656e+02             2.0469e-06       -22.825642778770

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 6.0451e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.684236e-01 1 1  ON 0
 uu_1                 9.447025e-02 1 1  ON 1
 uu_2                -1.690057e-02 1 1  ON 2
 uu_3                -8.214271e-02 1 1  ON 3
 uu_4                -1.196132e-01 1 1  ON 4
 uu_5                -1.418629e-01 1 1  ON 5
 uu_6                -1.545511e-01 1 1  ON 6
 uu_7                -1.564002e-01 1 1  ON 7
 uu_8                -1.451475e-01 1 1  ON 8
 uu_9                -1.137349e-01 1 1  ON 9
 ud_0                 4.402538e-01 1 1  ON 10
 ud_1                 1.578974e-01 1 1  ON 11
 ud_2                 1.209609e-02 1 1  ON 12
 ud_3                -6.780507e-02 1 1  ON 13
 ud_4                -1.148872e-01 1 1  ON 14
 ud_5                -1.443385e-01 1 1  ON 15
 ud_6                -1.621110e-01 1 1  ON 16
 ud_7                -1.674837e-01 1 1  ON 17
 ud_8                -1.582287e-01 1 1  ON 18
 ud_9                -1.301511e-01 1 1  ON 19
 eC_0                -5.631724e-01 1 1  ON 20
 eC_1                -4.087866e-01 1 1  ON 21
 eC_2                -1.599525e-01 1 1  ON 22
 eC_3                -1.436975e-02 1 1  ON 23
 eC_4                 3.209293e-02 1 1  ON 24
 eC_5                 1.164825e-01 1 1  ON 25
 eC_6                 2.341527e-01 1 1  ON 26
 eC_7                 3.964826e-01 1 1  ON 27
 eC_8                 2.850236e-01 1 1  ON 28
 eC_9                 7.544077e-02 1 1  ON 29
 eO_0                -1.243083e+00 1 1  ON 30
 eO_1                -8.650657e-01 1 1  ON 31
 eO_2                -3.855498e-01 1 1  ON 32
 eO_3                -4.053278e-02 1 1  ON 33
 eO_4                 1.881479e-01 1 1  ON 34
 eO_5                 3.721816e-01 1 1  ON 35
 eO_6                 4.623649e-01 1 1  ON 36
 eO_7                 5.234244e-01 1 1  ON 37
 eO_8                 4.809442e-01 1 1  ON 38
 eO_9                 3.319025e-01 1 1  ON 39
eH1_0                -1.849388e-01 1 1  ON 40
eH1_1                -9.726714e-02 1 1  ON 41
eH1_2                -6.417594e-02 1 1  ON 42
eH1_3                -4.819116e-02 1 1  ON 43
eH1_4                 1.245590e-02 1 1  ON 44
eH1_5                 6.929447e-02 1 1  ON 45
eH1_6                 1.256242e-01 1 1  ON 46
eH1_7                 1.004960e-01 1 1  ON 47
eH1_8                 1.000378e-02 1 1  ON 48
eH1_9                -1.730907e-02 1 1  ON 49
eH2_0                -1.871176e-01 1 1  ON 50
eH2_1                -9.869387e-02 1 1  ON 51
eH2_2                -6.547494e-02 1 1  ON 52
eH2_3                -4.980828e-02 1 1  ON 53
eH2_4                 1.076860e-02 1 1  ON 54
eH2_5                 6.762445e-02 1 1  ON 55
eH2_6                 1.243204e-01 1 1  ON 56
eH2_7                 9.976311e-02 1 1  ON 57
eH2_8                 7.809529e-03 1 1  ON 58
eH2_9                -1.142875e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1921e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2840e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.9288
    reference variance = 0.637695
====================================================
  Execution time = 4.3734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0269e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5069e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502646227063
                                         uncertainty =       0.002980536245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502646227063
                                         uncertainty =       0.002980536245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501344176
  error estimate for blocks of size 2^( 2) =       0.000519372115
  error estimate for blocks of size 2^( 3) =       0.000535926467
  error estimate for blocks of size 2^( 4) =       0.000548138393
  error estimate for blocks of size 2^( 5) =       0.000554978706
  error estimate for blocks of size 2^( 6) =       0.000557821284
  error estimate for blocks of size 2^( 7) =       0.000559314905

      target function =                  N/A
              le_mean =     -22.825846335478
             les_mean =     521.521952646077
             stat err =       0.000555063322
             autocorr =       1.225781638960
              std dev =       0.709007733799
             le_variance =       0.502691966587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282584633548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825846335478       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825846529090       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825846252052       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825846767636       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825846888910       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825846650417       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825846741260       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825846762058       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825846866526       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825846851312       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+00 is 1.069554e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825846335478       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825846388775       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825846310816       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825846474217       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825846531115       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825846476393       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825846508232       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825846497852       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825846513655       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825846515587       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 2.780615e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825846335478       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825846349148       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825846329002       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825846372732       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825846389359       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825846376193       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825846385618       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825846381824       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825846384770       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825846385606       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+01 is 7.012914e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210242 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8810e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.684221e-01 1 1  ON 0
 uu_1                 9.445903e-02 1 1  ON 1
 uu_2                -1.687866e-02 1 1  ON 2
 uu_3                -8.214347e-02 1 1  ON 3
 uu_4                -1.196042e-01 1 1  ON 4
 uu_5                -1.418651e-01 1 1  ON 5
 uu_6                -1.545687e-01 1 1  ON 6
 uu_7                -1.563976e-01 1 1  ON 7
 uu_8                -1.451456e-01 1 1  ON 8
 uu_9                -1.137304e-01 1 1  ON 9
 ud_0                 4.402529e-01 1 1  ON 10
 ud_1                 1.578930e-01 1 1  ON 11
 ud_2                 1.209688e-02 1 1  ON 12
 ud_3                -6.782515e-02 1 1  ON 13
 ud_4                -1.148811e-01 1 1  ON 14
 ud_5                -1.443484e-01 1 1  ON 15
 ud_6                -1.620966e-01 1 1  ON 16
 ud_7                -1.674871e-01 1 1  ON 17
 ud_8                -1.582009e-01 1 1  ON 18
 ud_9                -1.301378e-01 1 1  ON 19
 eC_0                -5.631565e-01 1 1  ON 20
 eC_1                -4.088003e-01 1 1  ON 21
 eC_2                -1.599637e-01 1 1  ON 22
 eC_3                -1.438482e-02 1 1  ON 23
 eC_4                 3.209911e-02 1 1  ON 24
 eC_5                 1.164868e-01 1 1  ON 25
 eC_6                 2.341454e-01 1 1  ON 26
 eC_7                 3.964780e-01 1 1  ON 27
 eC_8                 2.850411e-01 1 1  ON 28
 eC_9                 7.544804e-02 1 1  ON 29
 eO_0                -1.243105e+00 1 1  ON 30
 eO_1                -8.650803e-01 1 1  ON 31
 eO_2                -3.855437e-01 1 1  ON 32
 eO_3                -4.053806e-02 1 1  ON 33
 eO_4                 1.881370e-01 1 1  ON 34
 eO_5                 3.721833e-01 1 1  ON 35
 eO_6                 4.623649e-01 1 1  ON 36
 eO_7                 5.234348e-01 1 1  ON 37
 eO_8                 4.809495e-01 1 1  ON 38
 eO_9                 3.319188e-01 1 1  ON 39
eH1_0                -1.849245e-01 1 1  ON 40
eH1_1                -9.727382e-02 1 1  ON 41
eH1_2                -6.419030e-02 1 1  ON 42
eH1_3                -4.821246e-02 1 1  ON 43
eH1_4                 1.246506e-02 1 1  ON 44
eH1_5                 6.928108e-02 1 1  ON 45
eH1_6                 1.256439e-01 1 1  ON 46
eH1_7                 1.005005e-01 1 1  ON 47
eH1_8                 1.001042e-02 1 1  ON 48
eH1_9                -1.731136e-02 1 1  ON 49
eH2_0                -1.871130e-01 1 1  ON 50
eH2_1                -9.868309e-02 1 1  ON 51
eH2_2                -6.547945e-02 1 1  ON 52
eH2_3                -4.981035e-02 1 1  ON 53
eH2_4                 1.076964e-02 1 1  ON 54
eH2_5                 6.763697e-02 1 1  ON 55
eH2_6                 1.243069e-01 1 1  ON 56
eH2_7                 9.975258e-02 1 1  ON 57
eH2_8                 7.814523e-03 1 1  ON 58
eH2_9                -1.143833e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8397
    reference variance = 0.36344
====================================================
  Execution time = 4.3401e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0219e-01
  Total weights = 2.0000e+06
  Execution time = 3.5341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502006755779
                                         uncertainty =       0.005963301881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502006755779
                                         uncertainty =       0.005963301881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501096619
  error estimate for blocks of size 2^( 2) =       0.000518866142
  error estimate for blocks of size 2^( 3) =       0.000534366726
  error estimate for blocks of size 2^( 4) =       0.000545227823
  error estimate for blocks of size 2^( 5) =       0.000551550284
  error estimate for blocks of size 2^( 6) =       0.000554464549
  error estimate for blocks of size 2^( 7) =       0.000554936380

      target function =                  N/A
              le_mean =     -22.825575922611
             les_mean =     521.509111591611
             stat err =       0.000551544759
             autocorr =       1.211486499010
              std dev =       0.708657635146
             le_variance =       0.502195643851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501987001016
                                         uncertainty =       0.005963153962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501987001016
                                         uncertainty =       0.005963153962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501086724
  error estimate for blocks of size 2^( 2) =       0.000518856712
  error estimate for blocks of size 2^( 3) =       0.000534356040
  error estimate for blocks of size 2^( 4) =       0.000545216174
  error estimate for blocks of size 2^( 5) =       0.000551540065
  error estimate for blocks of size 2^( 6) =       0.000554455624
  error estimate for blocks of size 2^( 7) =       0.000554928013

      target function =                  N/A
              le_mean =     -22.825576545325
             les_mean =     521.509120184555
             stat err =       0.000551534969
             autocorr =       1.211491340663
              std dev =       0.708643640437
             le_variance =       0.502175809132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501990820088
                                         uncertainty =       0.005963151116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501990820088
                                         uncertainty =       0.005963151116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501088638
  error estimate for blocks of size 2^( 2) =       0.000518858595
  error estimate for blocks of size 2^( 3) =       0.000534358571
  error estimate for blocks of size 2^( 4) =       0.000545219202
  error estimate for blocks of size 2^( 5) =       0.000551542627
  error estimate for blocks of size 2^( 6) =       0.000554457711
  error estimate for blocks of size 2^( 7) =       0.000554929778

      target function =                  N/A
              le_mean =     -22.825576282796
             les_mean =     521.509112037193
             stat err =       0.000551537330
             autocorr =       1.211492452669
              std dev =       0.708646348008
             le_variance =       0.502179646545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502004452075
                                         uncertainty =       0.005963280053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502004452075
                                         uncertainty =       0.005963280053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501095466
  error estimate for blocks of size 2^( 2) =       0.000518865052
  error estimate for blocks of size 2^( 3) =       0.000534365563
  error estimate for blocks of size 2^( 4) =       0.000545226603
  error estimate for blocks of size 2^( 5) =       0.000551549196
  error estimate for blocks of size 2^( 6) =       0.000554463571
  error estimate for blocks of size 2^( 7) =       0.000554935430

      target function =                  N/A
              le_mean =     -22.825575966708
             les_mean =     521.509111292263
             stat err =       0.000551543700
             autocorr =       1.211487424541
              std dev =       0.708656003560
             le_variance =       0.502193331382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825575922611        initial
     1.5259e+00     1.5259e+01             1.0696e-04       -22.825576545325  <--
     6.1035e+00     6.1035e+01             2.7806e-05       -22.825576282796
     2.4414e+01     2.4414e+02             7.0129e-06       -22.825575966708

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 6.1166e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.684164e-01 1 1  ON 0
 uu_1                 9.444024e-02 1 1  ON 1
 uu_2                -1.682974e-02 1 1  ON 2
 uu_3                -8.213848e-02 1 1  ON 3
 uu_4                -1.195846e-01 1 1  ON 4
 uu_5                -1.418718e-01 1 1  ON 5
 uu_6                -1.546140e-01 1 1  ON 6
 uu_7                -1.563960e-01 1 1  ON 7
 uu_8                -1.451398e-01 1 1  ON 8
 uu_9                -1.137164e-01 1 1  ON 9
 ud_0                 4.402481e-01 1 1  ON 10
 ud_1                 1.578832e-01 1 1  ON 11
 ud_2                 1.209109e-02 1 1  ON 12
 ud_3                -6.787129e-02 1 1  ON 13
 ud_4                -1.148740e-01 1 1  ON 14
 ud_5                -1.443685e-01 1 1  ON 15
 ud_6                -1.620628e-01 1 1  ON 16
 ud_7                -1.674925e-01 1 1  ON 17
 ud_8                -1.581217e-01 1 1  ON 18
 ud_9                -1.300992e-01 1 1  ON 19
 eC_0                -5.631137e-01 1 1  ON 20
 eC_1                -4.088357e-01 1 1  ON 21
 eC_2                -1.599954e-01 1 1  ON 22
 eC_3                -1.442593e-02 1 1  ON 23
 eC_4                 3.211317e-02 1 1  ON 24
 eC_5                 1.164987e-01 1 1  ON 25
 eC_6                 2.341247e-01 1 1  ON 26
 eC_7                 3.964653e-01 1 1  ON 27
 eC_8                 2.850911e-01 1 1  ON 28
 eC_9                 7.546873e-02 1 1  ON 29
 eO_0                -1.243167e+00 1 1  ON 30
 eO_1                -8.651198e-01 1 1  ON 31
 eO_2                -3.855280e-01 1 1  ON 32
 eO_3                -4.055540e-02 1 1  ON 33
 eO_4                 1.881077e-01 1 1  ON 34
 eO_5                 3.721881e-01 1 1  ON 35
 eO_6                 4.623649e-01 1 1  ON 36
 eO_7                 5.234646e-01 1 1  ON 37
 eO_8                 4.809651e-01 1 1  ON 38
 eO_9                 3.319653e-01 1 1  ON 39
eH1_0                -1.848851e-01 1 1  ON 40
eH1_1                -9.729291e-02 1 1  ON 41
eH1_2                -6.423178e-02 1 1  ON 42
eH1_3                -4.827025e-02 1 1  ON 43
eH1_4                 1.248692e-02 1 1  ON 44
eH1_5                 6.924736e-02 1 1  ON 45
eH1_6                 1.256964e-01 1 1  ON 46
eH1_7                 1.005149e-01 1 1  ON 47
eH1_8                 1.002965e-02 1 1  ON 48
eH1_9                -1.731779e-02 1 1  ON 49
eH2_0                -1.870997e-01 1 1  ON 50
eH2_1                -9.865162e-02 1 1  ON 51
eH2_2                -6.549097e-02 1 1  ON 52
eH2_3                -4.981585e-02 1 1  ON 53
eH2_4                 1.077517e-02 1 1  ON 54
eH2_5                 6.767045e-02 1 1  ON 55
eH2_6                 1.242669e-01 1 1  ON 56
eH2_7                 9.972111e-02 1 1  ON 57
eH2_8                 7.828446e-03 1 1  ON 58
eH2_9                -1.146548e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1998e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2843e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.813
    reference variance = 0.275366
====================================================
  Execution time = 4.3959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5563e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507226577552
                                         uncertainty =       0.003886630696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507226577552
                                         uncertainty =       0.003886630696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503503772
  error estimate for blocks of size 2^( 2) =       0.000521311922
  error estimate for blocks of size 2^( 3) =       0.000537805555
  error estimate for blocks of size 2^( 4) =       0.000548431513
  error estimate for blocks of size 2^( 5) =       0.000554803313
  error estimate for blocks of size 2^( 6) =       0.000560431519
  error estimate for blocks of size 2^( 7) =       0.000562584485

      target function =                  N/A
              le_mean =     -22.826048965935
             les_mean =     521.535543239366
             stat err =       0.000556562708
             autocorr =       1.221863660569
              std dev =       0.712061863623
             le_variance =       0.507032097626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282604896593e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826048965935       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826050407244       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826052054989       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826051958002       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826052005401       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826052232752       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826052455852       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826052579519       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826052288169       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826052355725       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826052579198       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826052636008       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826052590031       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e-01 is 3.503059e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826048965935       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826049418302       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826050056847       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826050083438       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826050104109       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826050313279       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826050242536       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826050203301       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826050138566       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826050166807       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+00 is 1.090510e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826048965935       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826049086741       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826049270026       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826049291003       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826049301151       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826049322632       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826049359075       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826049320238       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826049307700       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826049311356       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+00 is 2.999211e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9530e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.683982e-01 1 1  ON 0
 uu_1                 9.443159e-02 1 1  ON 1
 uu_2                -1.677252e-02 1 1  ON 2
 uu_3                -8.213516e-02 1 1  ON 3
 uu_4                -1.195599e-01 1 1  ON 4
 uu_5                -1.418645e-01 1 1  ON 5
 uu_6                -1.546416e-01 1 1  ON 6
 uu_7                -1.564876e-01 1 1  ON 7
 uu_8                -1.450806e-01 1 1  ON 8
 uu_9                -1.137051e-01 1 1  ON 9
 ud_0                 4.402614e-01 1 1  ON 10
 ud_1                 1.578446e-01 1 1  ON 11
 ud_2                 1.205569e-02 1 1  ON 12
 ud_3                -6.787042e-02 1 1  ON 13
 ud_4                -1.148802e-01 1 1  ON 14
 ud_5                -1.443205e-01 1 1  ON 15
 ud_6                -1.620039e-01 1 1  ON 16
 ud_7                -1.675102e-01 1 1  ON 17
 ud_8                -1.581087e-01 1 1  ON 18
 ud_9                -1.300858e-01 1 1  ON 19
 eC_0                -5.631689e-01 1 1  ON 20
 eC_1                -4.088536e-01 1 1  ON 21
 eC_2                -1.600247e-01 1 1  ON 22
 eC_3                -1.447740e-02 1 1  ON 23
 eC_4                 3.214022e-02 1 1  ON 24
 eC_5                 1.165157e-01 1 1  ON 25
 eC_6                 2.341304e-01 1 1  ON 26
 eC_7                 3.964472e-01 1 1  ON 27
 eC_8                 2.851643e-01 1 1  ON 28
 eC_9                 7.551134e-02 1 1  ON 29
 eO_0                -1.243276e+00 1 1  ON 30
 eO_1                -8.650835e-01 1 1  ON 31
 eO_2                -3.855592e-01 1 1  ON 32
 eO_3                -4.054872e-02 1 1  ON 33
 eO_4                 1.880797e-01 1 1  ON 34
 eO_5                 3.721649e-01 1 1  ON 35
 eO_6                 4.623832e-01 1 1  ON 36
 eO_7                 5.235070e-01 1 1  ON 37
 eO_8                 4.809509e-01 1 1  ON 38
 eO_9                 3.320055e-01 1 1  ON 39
eH1_0                -1.848955e-01 1 1  ON 40
eH1_1                -9.734252e-02 1 1  ON 41
eH1_2                -6.424446e-02 1 1  ON 42
eH1_3                -4.835896e-02 1 1  ON 43
eH1_4                 1.252064e-02 1 1  ON 44
eH1_5                 6.927630e-02 1 1  ON 45
eH1_6                 1.256683e-01 1 1  ON 46
eH1_7                 1.005909e-01 1 1  ON 47
eH1_8                 1.006041e-02 1 1  ON 48
eH1_9                -1.733788e-02 1 1  ON 49
eH2_0                -1.871350e-01 1 1  ON 50
eH2_1                -9.875793e-02 1 1  ON 51
eH2_2                -6.547793e-02 1 1  ON 52
eH2_3                -4.985920e-02 1 1  ON 53
eH2_4                 1.085149e-02 1 1  ON 54
eH2_5                 6.776236e-02 1 1  ON 55
eH2_6                 1.241850e-01 1 1  ON 56
eH2_7                 9.972422e-02 1 1  ON 57
eH2_8                 7.891919e-03 1 1  ON 58
eH2_9                -1.147851e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8836
    reference variance = 0.52077
====================================================
  Execution time = 4.3734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2828e+01
  VMC Evar = 2.2222e+00
  Total weights = 2.0000e+06
  Execution time = 3.5313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.226042543921
                                         uncertainty =       1.709782092875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.226042543921
                                         uncertainty =       1.709782092875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001054339810
  error estimate for blocks of size 2^( 2) =       0.001062890545
  error estimate for blocks of size 2^( 3) =       0.001069922409
  error estimate for blocks of size 2^( 4) =       0.001076860871
  error estimate for blocks of size 2^( 5) =       0.001079628612
  error estimate for blocks of size 2^( 6) =       0.001080104087
  error estimate for blocks of size 2^( 7) =       0.001083156789

      target function =                  N/A
              le_mean =     -22.827697275192
             les_mean =     523.327026645660
             stat err =       0.001079937590
             autocorr =       1.049146427456
              std dev =       1.491061658511
             le_variance =       2.223264869483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.223211597219
                                         uncertainty =       1.706943240970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.223211597219
                                         uncertainty =       1.706943240970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001053669423
  error estimate for blocks of size 2^( 2) =       0.001062223614
  error estimate for blocks of size 2^( 3) =       0.001069261857
  error estimate for blocks of size 2^( 4) =       0.001076203545
  error estimate for blocks of size 2^( 5) =       0.001078973994
  error estimate for blocks of size 2^( 6) =       0.001079446414
  error estimate for blocks of size 2^( 7) =       0.001082517839

      target function =                  N/A
              le_mean =     -22.827695259404
             les_mean =     523.324108252855
             stat err =       0.001079285448
             autocorr =       1.049213544543
              std dev =       1.490113588570
             le_variance =       2.220438506842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.223978721819
                                         uncertainty =       1.707706195986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.223978721819
                                         uncertainty =       1.707706195986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001053851133
  error estimate for blocks of size 2^( 2) =       0.001062404271
  error estimate for blocks of size 2^( 3) =       0.001069441295
  error estimate for blocks of size 2^( 4) =       0.001076381988
  error estimate for blocks of size 2^( 5) =       0.001079151277
  error estimate for blocks of size 2^( 6) =       0.001079624995
  error estimate for blocks of size 2^( 7) =       0.001082690015

      target function =                  N/A
              le_mean =     -22.827695729095
             les_mean =     523.324895610694
             stat err =       0.001079462069
             autocorr =       1.049195064399
              std dev =       1.490370565049
             le_variance =       2.221204421163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.225739548407
                                         uncertainty =       1.709476689169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       2.225739548407
                                         uncertainty =       1.709476689169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.001054268081
  error estimate for blocks of size 2^( 2) =       0.001062819170
  error estimate for blocks of size 2^( 3) =       0.001069851832
  error estimate for blocks of size 2^( 4) =       0.001076790624
  error estimate for blocks of size 2^( 5) =       0.001079558526
  error estimate for blocks of size 2^( 6) =       0.001080033765
  error estimate for blocks of size 2^( 7) =       0.001083088133

      target function =                  N/A
              le_mean =     -22.827697014588
             les_mean =     523.326712249999
             stat err =       0.001079867762
             autocorr =       1.049153506563
              std dev =       1.490960217994
             le_variance =       2.222962371642


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.827697275192        initial  <--
     3.8147e-01     3.8147e+00             3.5031e-04       -22.827695259404
     1.5259e+00     1.5259e+01             1.0905e-04       -22.827695729095
     6.1035e+00     6.1035e+01             2.9992e-05       -22.827697014588

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.4544
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.684164e-01 1 1  ON 0
 uu_1                 9.444024e-02 1 1  ON 1
 uu_2                -1.682974e-02 1 1  ON 2
 uu_3                -8.213848e-02 1 1  ON 3
 uu_4                -1.195846e-01 1 1  ON 4
 uu_5                -1.418718e-01 1 1  ON 5
 uu_6                -1.546140e-01 1 1  ON 6
 uu_7                -1.563960e-01 1 1  ON 7
 uu_8                -1.451398e-01 1 1  ON 8
 uu_9                -1.137164e-01 1 1  ON 9
 ud_0                 4.402481e-01 1 1  ON 10
 ud_1                 1.578832e-01 1 1  ON 11
 ud_2                 1.209109e-02 1 1  ON 12
 ud_3                -6.787129e-02 1 1  ON 13
 ud_4                -1.148740e-01 1 1  ON 14
 ud_5                -1.443685e-01 1 1  ON 15
 ud_6                -1.620628e-01 1 1  ON 16
 ud_7                -1.674925e-01 1 1  ON 17
 ud_8                -1.581217e-01 1 1  ON 18
 ud_9                -1.300992e-01 1 1  ON 19
 eC_0                -5.631137e-01 1 1  ON 20
 eC_1                -4.088357e-01 1 1  ON 21
 eC_2                -1.599954e-01 1 1  ON 22
 eC_3                -1.442593e-02 1 1  ON 23
 eC_4                 3.211317e-02 1 1  ON 24
 eC_5                 1.164987e-01 1 1  ON 25
 eC_6                 2.341247e-01 1 1  ON 26
 eC_7                 3.964653e-01 1 1  ON 27
 eC_8                 2.850911e-01 1 1  ON 28
 eC_9                 7.546873e-02 1 1  ON 29
 eO_0                -1.243167e+00 1 1  ON 30
 eO_1                -8.651198e-01 1 1  ON 31
 eO_2                -3.855280e-01 1 1  ON 32
 eO_3                -4.055540e-02 1 1  ON 33
 eO_4                 1.881077e-01 1 1  ON 34
 eO_5                 3.721881e-01 1 1  ON 35
 eO_6                 4.623649e-01 1 1  ON 36
 eO_7                 5.234646e-01 1 1  ON 37
 eO_8                 4.809651e-01 1 1  ON 38
 eO_9                 3.319653e-01 1 1  ON 39
eH1_0                -1.848851e-01 1 1  ON 40
eH1_1                -9.729291e-02 1 1  ON 41
eH1_2                -6.423178e-02 1 1  ON 42
eH1_3                -4.827025e-02 1 1  ON 43
eH1_4                 1.248692e-02 1 1  ON 44
eH1_5                 6.924736e-02 1 1  ON 45
eH1_6                 1.256964e-01 1 1  ON 46
eH1_7                 1.005149e-01 1 1  ON 47
eH1_8                 1.002965e-02 1 1  ON 48
eH1_9                -1.731779e-02 1 1  ON 49
eH2_0                -1.870997e-01 1 1  ON 50
eH2_1                -9.865162e-02 1 1  ON 51
eH2_2                -6.549097e-02 1 1  ON 52
eH2_3                -4.981585e-02 1 1  ON 53
eH2_4                 1.077517e-02 1 1  ON 54
eH2_5                 6.767045e-02 1 1  ON 55
eH2_6                 1.242669e-01 1 1  ON 56
eH2_7                 9.972111e-02 1 1  ON 57
eH2_8                 7.828446e-03 1 1  ON 58
eH2_9                -1.146548e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2099e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2843e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.792
    reference variance = 0.368519
====================================================
  Execution time = 4.4075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0995e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5143e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510003206405
                                         uncertainty =       0.005638365984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510003206405
                                         uncertainty =       0.005638365984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504948208
  error estimate for blocks of size 2^( 2) =       0.000523001454
  error estimate for blocks of size 2^( 3) =       0.000538431957
  error estimate for blocks of size 2^( 4) =       0.000549401615
  error estimate for blocks of size 2^( 5) =       0.000555705972
  error estimate for blocks of size 2^( 6) =       0.000559303577
  error estimate for blocks of size 2^( 7) =       0.000563551605

      target function =                  N/A
              le_mean =     -22.824878224792
             les_mean =     521.485011106726
             stat err =       0.000556990692
             autocorr =       1.216752382096
              std dev =       0.714104603749
             le_variance =       0.509945385095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282487822479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824878224792       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824878302722       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824878355655       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824878241941       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824878155062       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824878161605       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824878178344       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824878226527       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824878227185       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824878229886       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 6.044604e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824878224792       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824878244899       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824878259437       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824878230160       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824878204060       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824878204419       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824878207945       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824878221224       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824878222124       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824878223635       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 1.562820e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824878224792       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824878229860       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824878233584       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824878226217       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824878219368       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824878219356       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824878220203       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824878223573       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824878223862       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824878224304       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+01 is 3.941019e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9226e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.684112e-01 1 1  ON 0
 uu_1                 9.444031e-02 1 1  ON 1
 uu_2                -1.682565e-02 1 1  ON 2
 uu_3                -8.213899e-02 1 1  ON 3
 uu_4                -1.195830e-01 1 1  ON 4
 uu_5                -1.418723e-01 1 1  ON 5
 uu_6                -1.546087e-01 1 1  ON 6
 uu_7                -1.563979e-01 1 1  ON 7
 uu_8                -1.451391e-01 1 1  ON 8
 uu_9                -1.137168e-01 1 1  ON 9
 ud_0                 4.402594e-01 1 1  ON 10
 ud_1                 1.578822e-01 1 1  ON 11
 ud_2                 1.209444e-02 1 1  ON 12
 ud_3                -6.787242e-02 1 1  ON 13
 ud_4                -1.148693e-01 1 1  ON 14
 ud_5                -1.443762e-01 1 1  ON 15
 ud_6                -1.620595e-01 1 1  ON 16
 ud_7                -1.674989e-01 1 1  ON 17
 ud_8                -1.581219e-01 1 1  ON 18
 ud_9                -1.300979e-01 1 1  ON 19
 eC_0                -5.631162e-01 1 1  ON 20
 eC_1                -4.088357e-01 1 1  ON 21
 eC_2                -1.599986e-01 1 1  ON 22
 eC_3                -1.443405e-02 1 1  ON 23
 eC_4                 3.211775e-02 1 1  ON 24
 eC_5                 1.164991e-01 1 1  ON 25
 eC_6                 2.341256e-01 1 1  ON 26
 eC_7                 3.964629e-01 1 1  ON 27
 eC_8                 2.850976e-01 1 1  ON 28
 eC_9                 7.547197e-02 1 1  ON 29
 eO_0                -1.243183e+00 1 1  ON 30
 eO_1                -8.651160e-01 1 1  ON 31
 eO_2                -3.855371e-01 1 1  ON 32
 eO_3                -4.055116e-02 1 1  ON 33
 eO_4                 1.881049e-01 1 1  ON 34
 eO_5                 3.721919e-01 1 1  ON 35
 eO_6                 4.623644e-01 1 1  ON 36
 eO_7                 5.234675e-01 1 1  ON 37
 eO_8                 4.809678e-01 1 1  ON 38
 eO_9                 3.319703e-01 1 1  ON 39
eH1_0                -1.848847e-01 1 1  ON 40
eH1_1                -9.730104e-02 1 1  ON 41
eH1_2                -6.423199e-02 1 1  ON 42
eH1_3                -4.827475e-02 1 1  ON 43
eH1_4                 1.248904e-02 1 1  ON 44
eH1_5                 6.925304e-02 1 1  ON 45
eH1_6                 1.256994e-01 1 1  ON 46
eH1_7                 1.005184e-01 1 1  ON 47
eH1_8                 1.002733e-02 1 1  ON 48
eH1_9                -1.732016e-02 1 1  ON 49
eH2_0                -1.870893e-01 1 1  ON 50
eH2_1                -9.865435e-02 1 1  ON 51
eH2_2                -6.549700e-02 1 1  ON 52
eH2_3                -4.982612e-02 1 1  ON 53
eH2_4                 1.077871e-02 1 1  ON 54
eH2_5                 6.766877e-02 1 1  ON 55
eH2_6                 1.242694e-01 1 1  ON 56
eH2_7                 9.972506e-02 1 1  ON 57
eH2_8                 7.829429e-03 1 1  ON 58
eH2_9                -1.146829e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6309
    reference variance = 3.91237
====================================================
  Execution time = 4.3273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0908e-01
  Total weights = 2.0000e+06
  Execution time = 3.5424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508972843625
                                         uncertainty =       0.005838675526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508972843625
                                         uncertainty =       0.005838675526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504512524
  error estimate for blocks of size 2^( 2) =       0.000522707578
  error estimate for blocks of size 2^( 3) =       0.000538202890
  error estimate for blocks of size 2^( 4) =       0.000549056537
  error estimate for blocks of size 2^( 5) =       0.000555678005
  error estimate for blocks of size 2^( 6) =       0.000559345666
  error estimate for blocks of size 2^( 7) =       0.000558983583

      target function =                  N/A
              le_mean =     -22.825094502127
             les_mean =     521.494004549439
             stat err =       0.000555765948
             autocorr =       1.213500513968
              std dev =       0.713488453261
             le_variance =       0.509065772937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509008327461
                                         uncertainty =       0.005839667463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509008327461
                                         uncertainty =       0.005839667463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504530144
  error estimate for blocks of size 2^( 2) =       0.000522723904
  error estimate for blocks of size 2^( 3) =       0.000538218095
  error estimate for blocks of size 2^( 4) =       0.000549071306
  error estimate for blocks of size 2^( 5) =       0.000555692343
  error estimate for blocks of size 2^( 6) =       0.000559361010
  error estimate for blocks of size 2^( 7) =       0.000558998007

      target function =                  N/A
              le_mean =     -22.825094680682
             les_mean =     521.494048259269
             stat err =       0.000555780666
             autocorr =       1.213480028165
              std dev =       0.713513371803
             le_variance =       0.509101331742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508991854628
                                         uncertainty =       0.005839221480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508991854628
                                         uncertainty =       0.005839221480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504521965
  error estimate for blocks of size 2^( 2) =       0.000522716330
  error estimate for blocks of size 2^( 3) =       0.000538211058
  error estimate for blocks of size 2^( 4) =       0.000549064480
  error estimate for blocks of size 2^( 5) =       0.000555685709
  error estimate for blocks of size 2^( 6) =       0.000559353888
  error estimate for blocks of size 2^( 7) =       0.000558991292

      target function =                  N/A
              le_mean =     -22.825094600863
             les_mean =     521.494028109738
             stat err =       0.000555773842
             autocorr =       1.213489571927
              std dev =       0.713501805131
             le_variance =       0.509084825925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508975259516
                                         uncertainty =       0.005838745557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508975259516
                                         uncertainty =       0.005838745557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504513723
  error estimate for blocks of size 2^( 2) =       0.000522708690
  error estimate for blocks of size 2^( 3) =       0.000538203929
  error estimate for blocks of size 2^( 4) =       0.000549057548
  error estimate for blocks of size 2^( 5) =       0.000555678984
  error estimate for blocks of size 2^( 6) =       0.000559346711
  error estimate for blocks of size 2^( 7) =       0.000558984561

      target function =                  N/A
              le_mean =     -22.825094514501
             les_mean =     521.494007535610
             stat err =       0.000555766951
             autocorr =       1.213499123129
              std dev =       0.713490150066
             le_variance =       0.509068194241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825094502127        initial
     3.8147e+00     3.8147e+01             6.0446e-05       -22.825094680682  <--
     1.5259e+01     1.5259e+02             1.5628e-05       -22.825094600863
     6.1035e+01     6.1035e+02             3.9410e-06       -22.825094514501

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 6.1059e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.683970e-01 1 1  ON 0
 uu_1                 9.444098e-02 1 1  ON 1
 uu_2                -1.681518e-02 1 1  ON 2
 uu_3                -8.213985e-02 1 1  ON 3
 uu_4                -1.195794e-01 1 1  ON 4
 uu_5                -1.418731e-01 1 1  ON 5
 uu_6                -1.545940e-01 1 1  ON 6
 uu_7                -1.564025e-01 1 1  ON 7
 uu_8                -1.451370e-01 1 1  ON 8
 uu_9                -1.137180e-01 1 1  ON 9
 ud_0                 4.402900e-01 1 1  ON 10
 ud_1                 1.578814e-01 1 1  ON 11
 ud_2                 1.210365e-02 1 1  ON 12
 ud_3                -6.787428e-02 1 1  ON 13
 ud_4                -1.148569e-01 1 1  ON 14
 ud_5                -1.443964e-01 1 1  ON 15
 ud_6                -1.620520e-01 1 1  ON 16
 ud_7                -1.675165e-01 1 1  ON 17
 ud_8                -1.581226e-01 1 1  ON 18
 ud_9                -1.300941e-01 1 1  ON 19
 eC_0                -5.631236e-01 1 1  ON 20
 eC_1                -4.088361e-01 1 1  ON 21
 eC_2                -1.600081e-01 1 1  ON 22
 eC_3                -1.445730e-02 1 1  ON 23
 eC_4                 3.213043e-02 1 1  ON 24
 eC_5                 1.165008e-01 1 1  ON 25
 eC_6                 2.341284e-01 1 1  ON 26
 eC_7                 3.964559e-01 1 1  ON 27
 eC_8                 2.851169e-01 1 1  ON 28
 eC_9                 7.548154e-02 1 1  ON 29
 eO_0                -1.243227e+00 1 1  ON 30
 eO_1                -8.651067e-01 1 1  ON 31
 eO_2                -3.855625e-01 1 1  ON 32
 eO_3                -4.053968e-02 1 1  ON 33
 eO_4                 1.880973e-01 1 1  ON 34
 eO_5                 3.722027e-01 1 1  ON 35
 eO_6                 4.623630e-01 1 1  ON 36
 eO_7                 5.234763e-01 1 1  ON 37
 eO_8                 4.809758e-01 1 1  ON 38
 eO_9                 3.319851e-01 1 1  ON 39
eH1_0                -1.848839e-01 1 1  ON 40
eH1_1                -9.732500e-02 1 1  ON 41
eH1_2                -6.423269e-02 1 1  ON 42
eH1_3                -4.828782e-02 1 1  ON 43
eH1_4                 1.249572e-02 1 1  ON 44
eH1_5                 6.926943e-02 1 1  ON 45
eH1_6                 1.257082e-01 1 1  ON 46
eH1_7                 1.005288e-01 1 1  ON 47
eH1_8                 1.002049e-02 1 1  ON 48
eH1_9                -1.732717e-02 1 1  ON 49
eH2_0                -1.870591e-01 1 1  ON 50
eH2_1                -9.866274e-02 1 1  ON 51
eH2_2                -6.551473e-02 1 1  ON 52
eH2_3                -4.985560e-02 1 1  ON 53
eH2_4                 1.078869e-02 1 1  ON 54
eH2_5                 6.766407e-02 1 1  ON 55
eH2_6                 1.242765e-01 1 1  ON 56
eH2_7                 9.973701e-02 1 1  ON 57
eH2_8                 7.832436e-03 1 1  ON 58
eH2_9                -1.147661e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2029e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8771
    reference variance = 0.620041
====================================================
  Execution time = 4.3694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0751e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4998e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507455112638
                                         uncertainty =       0.004035201542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507455112638
                                         uncertainty =       0.004035201542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503739374
  error estimate for blocks of size 2^( 2) =       0.000521159018
  error estimate for blocks of size 2^( 3) =       0.000536020285
  error estimate for blocks of size 2^( 4) =       0.000547300034
  error estimate for blocks of size 2^( 5) =       0.000553616813
  error estimate for blocks of size 2^( 6) =       0.000559564912
  error estimate for blocks of size 2^( 7) =       0.000560215509

      target function =                  N/A
              le_mean =     -22.824666454654
             les_mean =     521.472905227306
             stat err =       0.000555174317
             autocorr =       1.214638203629
              std dev =       0.712395055313
             le_variance =       0.507506714834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282466645465e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824666454654       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824666812330       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824666659880       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824666967929       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824667236171       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824667292218       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824667289258       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824667047041       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824667203273       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824667197823       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 1.826460e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824666454654       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824666553597       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824666507828       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824666604093       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824666677609       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824666720997       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824666721189       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824666642897       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824666675650       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824666673589       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 4.832701e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824666454654       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824666480067       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824666468015       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824666493882       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824666512969       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824666526731       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824666527483       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824666506654       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824666514201       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824666513525       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+01 is 1.224573e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8699e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.684145e-01 1 1  ON 0
 uu_1                 9.443473e-02 1 1  ON 1
 uu_2                -1.678848e-02 1 1  ON 2
 uu_3                -8.216356e-02 1 1  ON 3
 uu_4                -1.195822e-01 1 1  ON 4
 uu_5                -1.418971e-01 1 1  ON 5
 uu_6                -1.545883e-01 1 1  ON 6
 uu_7                -1.564020e-01 1 1  ON 7
 uu_8                -1.451268e-01 1 1  ON 8
 uu_9                -1.137242e-01 1 1  ON 9
 ud_0                 4.402930e-01 1 1  ON 10
 ud_1                 1.578711e-01 1 1  ON 11
 ud_2                 1.209496e-02 1 1  ON 12
 ud_3                -6.786651e-02 1 1  ON 13
 ud_4                -1.148709e-01 1 1  ON 14
 ud_5                -1.443818e-01 1 1  ON 15
 ud_6                -1.620355e-01 1 1  ON 16
 ud_7                -1.675154e-01 1 1  ON 17
 ud_8                -1.581067e-01 1 1  ON 18
 ud_9                -1.300931e-01 1 1  ON 19
 eC_0                -5.631572e-01 1 1  ON 20
 eC_1                -4.088492e-01 1 1  ON 21
 eC_2                -1.599819e-01 1 1  ON 22
 eC_3                -1.445322e-02 1 1  ON 23
 eC_4                 3.212591e-02 1 1  ON 24
 eC_5                 1.165003e-01 1 1  ON 25
 eC_6                 2.341007e-01 1 1  ON 26
 eC_7                 3.964578e-01 1 1  ON 27
 eC_8                 2.851521e-01 1 1  ON 28
 eC_9                 7.549349e-02 1 1  ON 29
 eO_0                -1.243276e+00 1 1  ON 30
 eO_1                -8.651318e-01 1 1  ON 31
 eO_2                -3.855783e-01 1 1  ON 32
 eO_3                -4.052775e-02 1 1  ON 33
 eO_4                 1.880978e-01 1 1  ON 34
 eO_5                 3.722207e-01 1 1  ON 35
 eO_6                 4.623628e-01 1 1  ON 36
 eO_7                 5.234862e-01 1 1  ON 37
 eO_8                 4.809779e-01 1 1  ON 38
 eO_9                 3.320062e-01 1 1  ON 39
eH1_0                -1.849091e-01 1 1  ON 40
eH1_1                -9.732591e-02 1 1  ON 41
eH1_2                -6.422706e-02 1 1  ON 42
eH1_3                -4.827876e-02 1 1  ON 43
eH1_4                 1.249459e-02 1 1  ON 44
eH1_5                 6.926220e-02 1 1  ON 45
eH1_6                 1.257325e-01 1 1  ON 46
eH1_7                 1.005240e-01 1 1  ON 47
eH1_8                 1.001335e-02 1 1  ON 48
eH1_9                -1.733037e-02 1 1  ON 49
eH2_0                -1.870603e-01 1 1  ON 50
eH2_1                -9.864295e-02 1 1  ON 51
eH2_2                -6.553812e-02 1 1  ON 52
eH2_3                -4.984481e-02 1 1  ON 53
eH2_4                 1.076934e-02 1 1  ON 54
eH2_5                 6.767517e-02 1 1  ON 55
eH2_6                 1.242509e-01 1 1  ON 56
eH2_7                 9.975137e-02 1 1  ON 57
eH2_8                 7.846149e-03 1 1  ON 58
eH2_9                -1.148205e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8429
    reference variance = 0.285031
====================================================
  Execution time = 4.3528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0457e-01
  Total weights = 2.0000e+06
  Execution time = 3.5212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504581623610
                                         uncertainty =       0.003809356936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504581623610
                                         uncertainty =       0.003809356936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502273286
  error estimate for blocks of size 2^( 2) =       0.000520112846
  error estimate for blocks of size 2^( 3) =       0.000535782043
  error estimate for blocks of size 2^( 4) =       0.000546190107
  error estimate for blocks of size 2^( 5) =       0.000552994520
  error estimate for blocks of size 2^( 6) =       0.000556786964
  error estimate for blocks of size 2^( 7) =       0.000558356011

      target function =                  N/A
              le_mean =     -22.825296821754
             les_mean =     521.498731657300
             stat err =       0.000553581900
             autocorr =       1.214740757363
              std dev =       0.710321693612
             le_variance =       0.504556908416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504635563385
                                         uncertainty =       0.003809560732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504635563385
                                         uncertainty =       0.003809560732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502300129
  error estimate for blocks of size 2^( 2) =       0.000520139567
  error estimate for blocks of size 2^( 3) =       0.000535808164
  error estimate for blocks of size 2^( 4) =       0.000546217063
  error estimate for blocks of size 2^( 5) =       0.000553021931
  error estimate for blocks of size 2^( 6) =       0.000556816067
  error estimate for blocks of size 2^( 7) =       0.000558383093

      target function =                  N/A
              le_mean =     -22.825296881481
             les_mean =     521.498788315470
             stat err =       0.000553609538
             autocorr =       1.214732212531
              std dev =       0.710359655414
             le_variance =       0.504610840039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504611064124
                                         uncertainty =       0.003809440523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504611064124
                                         uncertainty =       0.003809440523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502287939
  error estimate for blocks of size 2^( 2) =       0.000520127562
  error estimate for blocks of size 2^( 3) =       0.000535796541
  error estimate for blocks of size 2^( 4) =       0.000546205364
  error estimate for blocks of size 2^( 5) =       0.000553010198
  error estimate for blocks of size 2^( 6) =       0.000556803872
  error estimate for blocks of size 2^( 7) =       0.000558371105

      target function =                  N/A
              le_mean =     -22.825296850507
             les_mean =     521.498762409597
             stat err =       0.000553597635
             autocorr =       1.214738932582
              std dev =       0.710342416099
             le_variance =       0.504586348109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504585320879
                                         uncertainty =       0.003809366935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504585320879
                                         uncertainty =       0.003809366935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502275127
  error estimate for blocks of size 2^( 2) =       0.000520114702
  error estimate for blocks of size 2^( 3) =       0.000535783877
  error estimate for blocks of size 2^( 4) =       0.000546192054
  error estimate for blocks of size 2^( 5) =       0.000552996531
  error estimate for blocks of size 2^( 6) =       0.000556789150
  error estimate for blocks of size 2^( 7) =       0.000558357925

      target function =                  N/A
              le_mean =     -22.825296819058
             les_mean =     521.498735231686
             stat err =       0.000553583915
             autocorr =       1.214740696752
              std dev =       0.710324296252
             le_variance =       0.504560605847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825296821754        initial
     9.5367e-01     9.5367e+00             1.8265e-04       -22.825296881481  <--
     3.8147e+00     3.8147e+01             4.8327e-05       -22.825296850507
     1.5259e+01     1.5259e+02             1.2246e-05       -22.825296819058

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 6.4475e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.684616e-01 1 1  ON 0
 uu_1                 9.443448e-02 1 1  ON 1
 uu_2                -1.674057e-02 1 1  ON 2
 uu_3                -8.221140e-02 1 1  ON 3
 uu_4                -1.196030e-01 1 1  ON 4
 uu_5                -1.419528e-01 1 1  ON 5
 uu_6                -1.545842e-01 1 1  ON 6
 uu_7                -1.563971e-01 1 1  ON 7
 uu_8                -1.450966e-01 1 1  ON 8
 uu_9                -1.137408e-01 1 1  ON 9
 ud_0                 4.402953e-01 1 1  ON 10
 ud_1                 1.578488e-01 1 1  ON 11
 ud_2                 1.207688e-02 1 1  ON 12
 ud_3                -6.785830e-02 1 1  ON 13
 ud_4                -1.148943e-01 1 1  ON 14
 ud_5                -1.443535e-01 1 1  ON 15
 ud_6                -1.619932e-01 1 1  ON 16
 ud_7                -1.675057e-01 1 1  ON 17
 ud_8                -1.580604e-01 1 1  ON 18
 ud_9                -1.300896e-01 1 1  ON 19
 eC_0                -5.632482e-01 1 1  ON 20
 eC_1                -4.088836e-01 1 1  ON 21
 eC_2                -1.599185e-01 1 1  ON 22
 eC_3                -1.443854e-02 1 1  ON 23
 eC_4                 3.211299e-02 1 1  ON 24
 eC_5                 1.164981e-01 1 1  ON 25
 eC_6                 2.340214e-01 1 1  ON 26
 eC_7                 3.964634e-01 1 1  ON 27
 eC_8                 2.852533e-01 1 1  ON 28
 eC_9                 7.552784e-02 1 1  ON 29
 eO_0                -1.243410e+00 1 1  ON 30
 eO_1                -8.652119e-01 1 1  ON 31
 eO_2                -3.856145e-01 1 1  ON 32
 eO_3                -4.049924e-02 1 1  ON 33
 eO_4                 1.880979e-01 1 1  ON 34
 eO_5                 3.722683e-01 1 1  ON 35
 eO_6                 4.623661e-01 1 1  ON 36
 eO_7                 5.235158e-01 1 1  ON 37
 eO_8                 4.809845e-01 1 1  ON 38
 eO_9                 3.320670e-01 1 1  ON 39
eH1_0                -1.849776e-01 1 1  ON 40
eH1_1                -9.732967e-02 1 1  ON 41
eH1_2                -6.421164e-02 1 1  ON 42
eH1_3                -4.825795e-02 1 1  ON 43
eH1_4                 1.249023e-02 1 1  ON 44
eH1_5                 6.924988e-02 1 1  ON 45
eH1_6                 1.257977e-01 1 1  ON 46
eH1_7                 1.005106e-01 1 1  ON 47
eH1_8                 9.992899e-03 1 1  ON 48
eH1_9                -1.733961e-02 1 1  ON 49
eH2_0                -1.870614e-01 1 1  ON 50
eH2_1                -9.859218e-02 1 1  ON 51
eH2_2                -6.559288e-02 1 1  ON 52
eH2_3                -4.982241e-02 1 1  ON 53
eH2_4                 1.072184e-02 1 1  ON 54
eH2_5                 6.769630e-02 1 1  ON 55
eH2_6                 1.241825e-01 1 1  ON 56
eH2_7                 9.979020e-02 1 1  ON 57
eH2_8                 7.885397e-03 1 1  ON 58
eH2_9                -1.149751e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2318e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8648
    reference variance = 0.492597
====================================================
  Execution time = 4.3787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0432e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5303e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504433016819
                                         uncertainty =       0.003119237675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504433016819
                                         uncertainty =       0.003119237675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502157497
  error estimate for blocks of size 2^( 2) =       0.000519807320
  error estimate for blocks of size 2^( 3) =       0.000535749947
  error estimate for blocks of size 2^( 4) =       0.000547115009
  error estimate for blocks of size 2^( 5) =       0.000552655691
  error estimate for blocks of size 2^( 6) =       0.000555783033
  error estimate for blocks of size 2^( 7) =       0.000557746861

      target function =                  N/A
              le_mean =     -22.825056486697
             les_mean =     521.487527672496
             stat err =       0.000553325148
             autocorr =       1.214173965728
              std dev =       0.710157942816
             le_variance =       0.504324303745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282505648670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825056486697       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825057340337       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825056935802       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825056364522       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825056269929       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825056812241       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825056630521       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825056436858       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825056262802       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825056504453       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825056579798       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825056195735       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825056396457       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e-01 is 5.114124e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825056486697       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825056824189       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825056712494       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825056401934       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825056233921       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825056489472       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825056419152       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825056277341       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825056263633       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825056246009       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825056297927       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 1.704896e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825056486697       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825056585420       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825056558151       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825056461248       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825056388961       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825056453407       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825056426956       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825056386697       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825056389661       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825056366655       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 4.919103e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9099e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.683524e-01 1 1  ON 0
 uu_1                 9.451579e-02 1 1  ON 1
 uu_2                -1.671724e-02 1 1  ON 2
 uu_3                -8.218305e-02 1 1  ON 3
 uu_4                -1.195508e-01 1 1  ON 4
 uu_5                -1.418618e-01 1 1  ON 5
 uu_6                -1.546155e-01 1 1  ON 6
 uu_7                -1.564001e-01 1 1  ON 7
 uu_8                -1.451586e-01 1 1  ON 8
 uu_9                -1.137730e-01 1 1  ON 9
 ud_0                 4.402891e-01 1 1  ON 10
 ud_1                 1.579735e-01 1 1  ON 11
 ud_2                 1.206336e-02 1 1  ON 12
 ud_3                -6.782145e-02 1 1  ON 13
 ud_4                -1.148401e-01 1 1  ON 14
 ud_5                -1.443451e-01 1 1  ON 15
 ud_6                -1.619836e-01 1 1  ON 16
 ud_7                -1.675135e-01 1 1  ON 17
 ud_8                -1.580923e-01 1 1  ON 18
 ud_9                -1.300785e-01 1 1  ON 19
 eC_0                -5.633255e-01 1 1  ON 20
 eC_1                -4.089487e-01 1 1  ON 21
 eC_2                -1.598496e-01 1 1  ON 22
 eC_3                -1.455280e-02 1 1  ON 23
 eC_4                 3.211236e-02 1 1  ON 24
 eC_5                 1.165852e-01 1 1  ON 25
 eC_6                 2.339719e-01 1 1  ON 26
 eC_7                 3.964443e-01 1 1  ON 27
 eC_8                 2.853761e-01 1 1  ON 28
 eC_9                 7.557316e-02 1 1  ON 29
 eO_0                -1.243581e+00 1 1  ON 30
 eO_1                -8.652665e-01 1 1  ON 31
 eO_2                -3.856574e-01 1 1  ON 32
 eO_3                -4.045912e-02 1 1  ON 33
 eO_4                 1.880721e-01 1 1  ON 34
 eO_5                 3.723232e-01 1 1  ON 35
 eO_6                 4.624014e-01 1 1  ON 36
 eO_7                 5.235245e-01 1 1  ON 37
 eO_8                 4.809696e-01 1 1  ON 38
 eO_9                 3.321518e-01 1 1  ON 39
eH1_0                -1.850146e-01 1 1  ON 40
eH1_1                -9.734068e-02 1 1  ON 41
eH1_2                -6.421294e-02 1 1  ON 42
eH1_3                -4.836071e-02 1 1  ON 43
eH1_4                 1.239947e-02 1 1  ON 44
eH1_5                 6.931746e-02 1 1  ON 45
eH1_6                 1.257737e-01 1 1  ON 46
eH1_7                 1.006059e-01 1 1  ON 47
eH1_8                 1.006478e-02 1 1  ON 48
eH1_9                -1.735072e-02 1 1  ON 49
eH2_0                -1.869176e-01 1 1  ON 50
eH2_1                -9.875407e-02 1 1  ON 51
eH2_2                -6.562506e-02 1 1  ON 52
eH2_3                -4.984377e-02 1 1  ON 53
eH2_4                 1.072096e-02 1 1  ON 54
eH2_5                 6.773413e-02 1 1  ON 55
eH2_6                 1.242143e-01 1 1  ON 56
eH2_7                 9.979530e-02 1 1  ON 57
eH2_8                 7.898035e-03 1 1  ON 58
eH2_9                -1.154541e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7983
    reference variance = 0.392052
====================================================
  Execution time = 4.3169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0438e-01
  Total weights = 2.0000e+06
  Execution time = 3.5446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504495150075
                                         uncertainty =       0.003875289291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504495150075
                                         uncertainty =       0.003875289291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502184555
  error estimate for blocks of size 2^( 2) =       0.000519823300
  error estimate for blocks of size 2^( 3) =       0.000535806285
  error estimate for blocks of size 2^( 4) =       0.000546145227
  error estimate for blocks of size 2^( 5) =       0.000553233760
  error estimate for blocks of size 2^( 6) =       0.000554928764
  error estimate for blocks of size 2^( 7) =       0.000557199421

      target function =                  N/A
              le_mean =     -22.825412013146
             les_mean =     521.503811971759
             stat err =       0.000552876793
             autocorr =       1.212076465920
              std dev =       0.710196208145
             le_variance =       0.504378654063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504557192245
                                         uncertainty =       0.003876215629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504557192245
                                         uncertainty =       0.003876215629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502215463
  error estimate for blocks of size 2^( 2) =       0.000519847464
  error estimate for blocks of size 2^( 3) =       0.000535821368
  error estimate for blocks of size 2^( 4) =       0.000546153275
  error estimate for blocks of size 2^( 5) =       0.000553233540
  error estimate for blocks of size 2^( 6) =       0.000554926811
  error estimate for blocks of size 2^( 7) =       0.000557198646

      target function =                  N/A
              le_mean =     -22.825413662873
             les_mean =     521.503949370985
             stat err =       0.000552878068
             autocorr =       1.211932869202
              std dev =       0.710239918559
             le_variance =       0.504440741915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504510498755
                                         uncertainty =       0.003876110299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504510498755
                                         uncertainty =       0.003876110299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502192219
  error estimate for blocks of size 2^( 2) =       0.000519825356
  error estimate for blocks of size 2^( 3) =       0.000535801390
  error estimate for blocks of size 2^( 4) =       0.000546135265
  error estimate for blocks of size 2^( 5) =       0.000553215947
  error estimate for blocks of size 2^( 6) =       0.000554909361
  error estimate for blocks of size 2^( 7) =       0.000557179204

      target function =                  N/A
              le_mean =     -22.825413740224
             les_mean =     521.503906208925
             stat err =       0.000552859944
             autocorr =       1.211965599136
              std dev =       0.710207046380
             le_variance =       0.504394048728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504491756443
                                         uncertainty =       0.003875434902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504491756443
                                         uncertainty =       0.003875434902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502182870
  error estimate for blocks of size 2^( 2) =       0.000519820734
  error estimate for blocks of size 2^( 3) =       0.000535802703
  error estimate for blocks of size 2^( 4) =       0.000546140904
  error estimate for blocks of size 2^( 5) =       0.000553228204
  error estimate for blocks of size 2^( 6) =       0.000554922898
  error estimate for blocks of size 2^( 7) =       0.000557193316

      target function =                  N/A
              le_mean =     -22.825412303610
             les_mean =     521.503821847890
             stat err =       0.000552871331
             autocorr =       1.212060647026
              std dev =       0.710193825844
             le_variance =       0.504375270267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825412013146        initial
     2.3842e-01     2.3842e+00             5.1141e-04       -22.825413662873
     9.5367e-01     9.5367e+00             1.7049e-04       -22.825413740224  <--
     3.8147e+00     3.8147e+01             4.9191e-05       -22.825412303610

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 6.0931e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.683524e-01 1 1  ON 0
 uu_1                 9.451579e-02 1 1  ON 1
 uu_2                -1.671724e-02 1 1  ON 2
 uu_3                -8.218305e-02 1 1  ON 3
 uu_4                -1.195508e-01 1 1  ON 4
 uu_5                -1.418618e-01 1 1  ON 5
 uu_6                -1.546155e-01 1 1  ON 6
 uu_7                -1.564001e-01 1 1  ON 7
 uu_8                -1.451586e-01 1 1  ON 8
 uu_9                -1.137730e-01 1 1  ON 9
 ud_0                 4.402891e-01 1 1  ON 10
 ud_1                 1.579735e-01 1 1  ON 11
 ud_2                 1.206336e-02 1 1  ON 12
 ud_3                -6.782145e-02 1 1  ON 13
 ud_4                -1.148401e-01 1 1  ON 14
 ud_5                -1.443451e-01 1 1  ON 15
 ud_6                -1.619836e-01 1 1  ON 16
 ud_7                -1.675135e-01 1 1  ON 17
 ud_8                -1.580923e-01 1 1  ON 18
 ud_9                -1.300785e-01 1 1  ON 19
 eC_0                -5.633255e-01 1 1  ON 20
 eC_1                -4.089487e-01 1 1  ON 21
 eC_2                -1.598496e-01 1 1  ON 22
 eC_3                -1.455280e-02 1 1  ON 23
 eC_4                 3.211236e-02 1 1  ON 24
 eC_5                 1.165852e-01 1 1  ON 25
 eC_6                 2.339719e-01 1 1  ON 26
 eC_7                 3.964443e-01 1 1  ON 27
 eC_8                 2.853761e-01 1 1  ON 28
 eC_9                 7.557316e-02 1 1  ON 29
 eO_0                -1.243581e+00 1 1  ON 30
 eO_1                -8.652665e-01 1 1  ON 31
 eO_2                -3.856574e-01 1 1  ON 32
 eO_3                -4.045912e-02 1 1  ON 33
 eO_4                 1.880721e-01 1 1  ON 34
 eO_5                 3.723232e-01 1 1  ON 35
 eO_6                 4.624014e-01 1 1  ON 36
 eO_7                 5.235245e-01 1 1  ON 37
 eO_8                 4.809696e-01 1 1  ON 38
 eO_9                 3.321518e-01 1 1  ON 39
eH1_0                -1.850146e-01 1 1  ON 40
eH1_1                -9.734068e-02 1 1  ON 41
eH1_2                -6.421294e-02 1 1  ON 42
eH1_3                -4.836071e-02 1 1  ON 43
eH1_4                 1.239947e-02 1 1  ON 44
eH1_5                 6.931746e-02 1 1  ON 45
eH1_6                 1.257737e-01 1 1  ON 46
eH1_7                 1.006059e-01 1 1  ON 47
eH1_8                 1.006478e-02 1 1  ON 48
eH1_9                -1.735072e-02 1 1  ON 49
eH2_0                -1.869176e-01 1 1  ON 50
eH2_1                -9.875407e-02 1 1  ON 51
eH2_2                -6.562506e-02 1 1  ON 52
eH2_3                -4.984377e-02 1 1  ON 53
eH2_4                 1.072096e-02 1 1  ON 54
eH2_5                 6.773413e-02 1 1  ON 55
eH2_6                 1.242143e-01 1 1  ON 56
eH2_7                 9.979530e-02 1 1  ON 57
eH2_8                 7.898035e-03 1 1  ON 58
eH2_9                -1.154541e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2004e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8711
    reference variance = 0.961686
====================================================
  Execution time = 4.3657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0215e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4828e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502037342989
                                         uncertainty =       0.004187962567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502037342989
                                         uncertainty =       0.004187962567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501073316
  error estimate for blocks of size 2^( 2) =       0.000518976848
  error estimate for blocks of size 2^( 3) =       0.000534731794
  error estimate for blocks of size 2^( 4) =       0.000545966618
  error estimate for blocks of size 2^( 5) =       0.000552749427
  error estimate for blocks of size 2^( 6) =       0.000554493555
  error estimate for blocks of size 2^( 7) =       0.000554694721

      target function =                  N/A
              le_mean =     -22.825587769548
             les_mean =     521.509605710499
             stat err =       0.000551976080
             autocorr =       1.213494925612
              std dev =       0.708624679391
             le_variance =       0.502148936243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282558776955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825587769548       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825588816931       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825588136637       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825587049440       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825586295978       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825586526697       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825586460509       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825587817785       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825587100530       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825587409019       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825587321738       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825587033461       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825587166361       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e-01 is 5.817402e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825587769548       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825588232784       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825588138940       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825587682884       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825587291438       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825587353311       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825587220078       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825587561766       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825587415758       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825587453926       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825587440269       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 1.611362e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825587769548       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825587912925       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825587901003       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825587772856       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825587661707       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825587679276       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825587622707       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825587674650       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825587652916       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825587664143       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+00 is 4.096907e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8493e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.684772e-01 1 1  ON 0
 uu_1                 9.450871e-02 1 1  ON 1
 uu_2                -1.669241e-02 1 1  ON 2
 uu_3                -8.220587e-02 1 1  ON 3
 uu_4                -1.196012e-01 1 1  ON 4
 uu_5                -1.419420e-01 1 1  ON 5
 uu_6                -1.546730e-01 1 1  ON 6
 uu_7                -1.565337e-01 1 1  ON 7
 uu_8                -1.450317e-01 1 1  ON 8
 uu_9                -1.137385e-01 1 1  ON 9
 ud_0                 4.403497e-01 1 1  ON 10
 ud_1                 1.579063e-01 1 1  ON 11
 ud_2                 1.206541e-02 1 1  ON 12
 ud_3                -6.780078e-02 1 1  ON 13
 ud_4                -1.148790e-01 1 1  ON 14
 ud_5                -1.444004e-01 1 1  ON 15
 ud_6                -1.619013e-01 1 1  ON 16
 ud_7                -1.674833e-01 1 1  ON 17
 ud_8                -1.581184e-01 1 1  ON 18
 ud_9                -1.300096e-01 1 1  ON 19
 eC_0                -5.634342e-01 1 1  ON 20
 eC_1                -4.089747e-01 1 1  ON 21
 eC_2                -1.598987e-01 1 1  ON 22
 eC_3                -1.445402e-02 1 1  ON 23
 eC_4                 3.213213e-02 1 1  ON 24
 eC_5                 1.165216e-01 1 1  ON 25
 eC_6                 2.339308e-01 1 1  ON 26
 eC_7                 3.964332e-01 1 1  ON 27
 eC_8                 2.854869e-01 1 1  ON 28
 eC_9                 7.563492e-02 1 1  ON 29
 eO_0                -1.243742e+00 1 1  ON 30
 eO_1                -8.653267e-01 1 1  ON 31
 eO_2                -3.856897e-01 1 1  ON 32
 eO_3                -4.053000e-02 1 1  ON 33
 eO_4                 1.881594e-01 1 1  ON 34
 eO_5                 3.724006e-01 1 1  ON 35
 eO_6                 4.623440e-01 1 1  ON 36
 eO_7                 5.235169e-01 1 1  ON 37
 eO_8                 4.809891e-01 1 1  ON 38
 eO_9                 3.322508e-01 1 1  ON 39
eH1_0                -1.849616e-01 1 1  ON 40
eH1_1                -9.727375e-02 1 1  ON 41
eH1_2                -6.431540e-02 1 1  ON 42
eH1_3                -4.843221e-02 1 1  ON 43
eH1_4                 1.236061e-02 1 1  ON 44
eH1_5                 6.927554e-02 1 1  ON 45
eH1_6                 1.258838e-01 1 1  ON 46
eH1_7                 1.006330e-01 1 1  ON 47
eH1_8                 1.006788e-02 1 1  ON 48
eH1_9                -1.739990e-02 1 1  ON 49
eH2_0                -1.868795e-01 1 1  ON 50
eH2_1                -9.883302e-02 1 1  ON 51
eH2_2                -6.566729e-02 1 1  ON 52
eH2_3                -4.992831e-02 1 1  ON 53
eH2_4                 1.081849e-02 1 1  ON 54
eH2_5                 6.770132e-02 1 1  ON 55
eH2_6                 1.242359e-01 1 1  ON 56
eH2_7                 9.980389e-02 1 1  ON 57
eH2_8                 7.956237e-03 1 1  ON 58
eH2_9                -1.157113e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8741
    reference variance = 0.395758
====================================================
  Execution time = 4.3723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1196e-01
  Total weights = 2.0000e+06
  Execution time = 3.5294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511851075442
                                         uncertainty =       0.005330631072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511851075442
                                         uncertainty =       0.005330631072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505895000
  error estimate for blocks of size 2^( 2) =       0.000523084701
  error estimate for blocks of size 2^( 3) =       0.000538756664
  error estimate for blocks of size 2^( 4) =       0.000548767219
  error estimate for blocks of size 2^( 5) =       0.000555096372
  error estimate for blocks of size 2^( 6) =       0.000558772262
  error estimate for blocks of size 2^( 7) =       0.000561529727

      target function =                  N/A
              le_mean =     -22.825606173967
             les_mean =     521.520156454192
             stat err =       0.000556041395
             autocorr =       1.208073826802
              std dev =       0.715443569447
             le_variance =       0.511859501064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512128181389
                                         uncertainty =       0.005337181870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512128181389
                                         uncertainty =       0.005337181870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506031953
  error estimate for blocks of size 2^( 2) =       0.000523218995
  error estimate for blocks of size 2^( 3) =       0.000538888593
  error estimate for blocks of size 2^( 4) =       0.000548899676
  error estimate for blocks of size 2^( 5) =       0.000555220803
  error estimate for blocks of size 2^( 6) =       0.000558894279
  error estimate for blocks of size 2^( 7) =       0.000561644656

      target function =                  N/A
              le_mean =     -22.825607647407
             les_mean =     521.520500891551
             stat err =       0.000556164854
             autocorr =       1.207956234940
              std dev =       0.715637250480
             le_variance =       0.512136674275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512051661426
                                         uncertainty =       0.005335775665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512051661426
                                         uncertainty =       0.005335775665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505994155
  error estimate for blocks of size 2^( 2) =       0.000523182068
  error estimate for blocks of size 2^( 3) =       0.000538853575
  error estimate for blocks of size 2^( 4) =       0.000548865744
  error estimate for blocks of size 2^( 5) =       0.000555188608
  error estimate for blocks of size 2^( 6) =       0.000558863874
  error estimate for blocks of size 2^( 7) =       0.000561615280

      target function =                  N/A
              le_mean =     -22.825607323231
             les_mean =     521.520409587345
             stat err =       0.000556133377
             autocorr =       1.207999963569
              std dev =       0.715583795944
             le_variance =       0.512060169017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511885437248
                                         uncertainty =       0.005331438073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511885437248
                                         uncertainty =       0.005331438073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505911987
  error estimate for blocks of size 2^( 2) =       0.000523101272
  error estimate for blocks of size 2^( 3) =       0.000538773120
  error estimate for blocks of size 2^( 4) =       0.000548783884
  error estimate for blocks of size 2^( 5) =       0.000555112008
  error estimate for blocks of size 2^( 6) =       0.000558787923
  error estimate for blocks of size 2^( 7) =       0.000561544444

      target function =                  N/A
              le_mean =     -22.825606282399
             les_mean =     521.520195780978
             stat err =       0.000556057065
             autocorr =       1.208060782806
              std dev =       0.715467593839
             le_variance =       0.511893877834


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825606173967        initial
     2.3842e-01     2.3842e+00             5.8174e-04       -22.825607647407  <--
     9.5367e-01     9.5367e+00             1.6114e-04       -22.825607323231
     3.8147e+00     3.8147e+01             4.0969e-05       -22.825606282399

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 6.1441e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.686843e-01 1 1  ON 0
 uu_1                 9.455557e-02 1 1  ON 1
 uu_2                -1.667221e-02 1 1  ON 2
 uu_3                -8.225108e-02 1 1  ON 3
 uu_4                -1.197215e-01 1 1  ON 4
 uu_5                -1.421182e-01 1 1  ON 5
 uu_6                -1.548343e-01 1 1  ON 6
 uu_7                -1.567780e-01 1 1  ON 7
 uu_8                -1.447696e-01 1 1  ON 8
 uu_9                -1.136530e-01 1 1  ON 9
 ud_0                 4.404139e-01 1 1  ON 10
 ud_1                 1.578513e-01 1 1  ON 11
 ud_2                 1.206972e-02 1 1  ON 12
 ud_3                -6.778829e-02 1 1  ON 13
 ud_4                -1.149355e-01 1 1  ON 14
 ud_5                -1.444735e-01 1 1  ON 15
 ud_6                -1.618059e-01 1 1  ON 16
 ud_7                -1.673768e-01 1 1  ON 17
 ud_8                -1.581731e-01 1 1  ON 18
 ud_9                -1.298223e-01 1 1  ON 19
 eC_0                -5.637202e-01 1 1  ON 20
 eC_1                -4.090743e-01 1 1  ON 21
 eC_2                -1.599764e-01 1 1  ON 22
 eC_3                -1.427369e-02 1 1  ON 23
 eC_4                 3.221635e-02 1 1  ON 24
 eC_5                 1.163535e-01 1 1  ON 25
 eC_6                 2.337987e-01 1 1  ON 26
 eC_7                 3.963942e-01 1 1  ON 27
 eC_8                 2.858155e-01 1 1  ON 28
 eC_9                 7.581869e-02 1 1  ON 29
 eO_0                -1.244162e+00 1 1  ON 30
 eO_1                -8.655489e-01 1 1  ON 31
 eO_2                -3.858125e-01 1 1  ON 32
 eO_3                -4.062703e-02 1 1  ON 33
 eO_4                 1.882873e-01 1 1  ON 34
 eO_5                 3.725804e-01 1 1  ON 35
 eO_6                 4.622566e-01 1 1  ON 36
 eO_7                 5.234988e-01 1 1  ON 37
 eO_8                 4.810396e-01 1 1  ON 38
 eO_9                 3.325442e-01 1 1  ON 39
eH1_0                -1.848388e-01 1 1  ON 40
eH1_1                -9.718740e-02 1 1  ON 41
eH1_2                -6.450694e-02 1 1  ON 42
eH1_3                -4.858544e-02 1 1  ON 43
eH1_4                 1.227330e-02 1 1  ON 44
eH1_5                 6.918245e-02 1 1  ON 45
eH1_6                 1.261079e-01 1 1  ON 46
eH1_7                 1.007370e-01 1 1  ON 47
eH1_8                 1.007478e-02 1 1  ON 48
eH1_9                -1.754829e-02 1 1  ON 49
eH2_0                -1.868246e-01 1 1  ON 50
eH2_1                -9.900995e-02 1 1  ON 51
eH2_2                -6.577938e-02 1 1  ON 52
eH2_3                -5.006704e-02 1 1  ON 53
eH2_4                 1.093810e-02 1 1  ON 54
eH2_5                 6.765561e-02 1 1  ON 55
eH2_6                 1.243024e-01 1 1  ON 56
eH2_7                 9.983250e-02 1 1  ON 57
eH2_8                 8.119102e-03 1 1  ON 58
eH2_9                -1.164964e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1996e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8589
    reference variance = 0.490458
====================================================
  Execution time = 4.4191e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0190e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5079e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502003816865
                                         uncertainty =       0.003600267790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502003816865
                                         uncertainty =       0.003600267790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500948052
  error estimate for blocks of size 2^( 2) =       0.000518501938
  error estimate for blocks of size 2^( 3) =       0.000534066515
  error estimate for blocks of size 2^( 4) =       0.000544538992
  error estimate for blocks of size 2^( 5) =       0.000551673642
  error estimate for blocks of size 2^( 6) =       0.000555811427
  error estimate for blocks of size 2^( 7) =       0.000560233256

      target function =                  N/A
              le_mean =     -22.824929259599
             les_mean =     521.479293355431
             stat err =       0.000553064329
             autocorr =       1.218893930077
              std dev =       0.708447528532
             le_variance =       0.501897900683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282492925960e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824929259599       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824928270194       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824928860643       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824928417350       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824929804411       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824929878526       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824930287775       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824930664151       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824930277500       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824928939833       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824928333168       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824929157006       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824930204772       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824930073880       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.824930218500       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.824930183352       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.824930458503       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e-02 is 1.817031e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824929259599       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824928637459       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824928894062       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824928552869       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824929268288       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824929363542       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824929658858       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824929768328       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824929591296       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824929173268       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824929044615       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824929271597       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824929392146       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e-01 is 5.295952e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824929259599       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824929009219       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824929069143       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824928890733       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824929114576       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824929137221       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824929339808       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824929432608       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824929383344       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824929261517       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 1.639111e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237324 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9281e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.690636e-01 1 1  ON 0
 uu_1                 9.454841e-02 1 1  ON 1
 uu_2                -1.679671e-02 1 1  ON 2
 uu_3                -8.240981e-02 1 1  ON 3
 uu_4                -1.197939e-01 1 1  ON 4
 uu_5                -1.421558e-01 1 1  ON 5
 uu_6                -1.547791e-01 1 1  ON 6
 uu_7                -1.566866e-01 1 1  ON 7
 uu_8                -1.448510e-01 1 1  ON 8
 uu_9                -1.137119e-01 1 1  ON 9
 ud_0                 4.406124e-01 1 1  ON 10
 ud_1                 1.580854e-01 1 1  ON 11
 ud_2                 1.213819e-02 1 1  ON 12
 ud_3                -6.780105e-02 1 1  ON 13
 ud_4                -1.149032e-01 1 1  ON 14
 ud_5                -1.443813e-01 1 1  ON 15
 ud_6                -1.620921e-01 1 1  ON 16
 ud_7                -1.675838e-01 1 1  ON 17
 ud_8                -1.580805e-01 1 1  ON 18
 ud_9                -1.296868e-01 1 1  ON 19
 eC_0                -5.642081e-01 1 1  ON 20
 eC_1                -4.090329e-01 1 1  ON 21
 eC_2                -1.601103e-01 1 1  ON 22
 eC_3                -1.428710e-02 1 1  ON 23
 eC_4                 3.233767e-02 1 1  ON 24
 eC_5                 1.163035e-01 1 1  ON 25
 eC_6                 2.336810e-01 1 1  ON 26
 eC_7                 3.963533e-01 1 1  ON 27
 eC_8                 2.862741e-01 1 1  ON 28
 eC_9                 7.600660e-02 1 1  ON 29
 eO_0                -1.244692e+00 1 1  ON 30
 eO_1                -8.660317e-01 1 1  ON 31
 eO_2                -3.860218e-01 1 1  ON 32
 eO_3                -4.046709e-02 1 1  ON 33
 eO_4                 1.882294e-01 1 1  ON 34
 eO_5                 3.726123e-01 1 1  ON 35
 eO_6                 4.623963e-01 1 1  ON 36
 eO_7                 5.236302e-01 1 1  ON 37
 eO_8                 4.810748e-01 1 1  ON 38
 eO_9                 3.329162e-01 1 1  ON 39
eH1_0                -1.851648e-01 1 1  ON 40
eH1_1                -9.743309e-02 1 1  ON 41
eH1_2                -6.442823e-02 1 1  ON 42
eH1_3                -4.850496e-02 1 1  ON 43
eH1_4                 1.228219e-02 1 1  ON 44
eH1_5                 6.929537e-02 1 1  ON 45
eH1_6                 1.260556e-01 1 1  ON 46
eH1_7                 1.010808e-01 1 1  ON 47
eH1_8                 1.004100e-02 1 1  ON 48
eH1_9                -1.769406e-02 1 1  ON 49
eH2_0                -1.868828e-01 1 1  ON 50
eH2_1                -9.909583e-02 1 1  ON 51
eH2_2                -6.590325e-02 1 1  ON 52
eH2_3                -4.999667e-02 1 1  ON 53
eH2_4                 1.089979e-02 1 1  ON 54
eH2_5                 6.762715e-02 1 1  ON 55
eH2_6                 1.243135e-01 1 1  ON 56
eH2_7                 9.993611e-02 1 1  ON 57
eH2_8                 8.350704e-03 1 1  ON 58
eH2_9                -1.184263e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8693
    reference variance = 0.586324
====================================================
  Execution time = 4.3207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0297e-01
  Total weights = 2.0000e+06
  Execution time = 3.5259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502601789452
                                         uncertainty =       0.002801031736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502601789452
                                         uncertainty =       0.002801031736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501283382
  error estimate for blocks of size 2^( 2) =       0.000518986306
  error estimate for blocks of size 2^( 3) =       0.000534315038
  error estimate for blocks of size 2^( 4) =       0.000546201052
  error estimate for blocks of size 2^( 5) =       0.000553434821
  error estimate for blocks of size 2^( 6) =       0.000555746017
  error estimate for blocks of size 2^( 7) =       0.000556398718

      target function =                  N/A
              le_mean =     -22.825104701015
             les_mean =     521.487974418699
             stat err =       0.000552945152
             autocorr =       1.216739184430
              std dev =       0.708921757109
             le_variance =       0.502570057702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503337161625
                                         uncertainty =       0.002806318072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503337161625
                                         uncertainty =       0.002806318072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501650032
  error estimate for blocks of size 2^( 2) =       0.000519331547
  error estimate for blocks of size 2^( 3) =       0.000534633624
  error estimate for blocks of size 2^( 4) =       0.000546497387
  error estimate for blocks of size 2^( 5) =       0.000553733795
  error estimate for blocks of size 2^( 6) =       0.000556044610
  error estimate for blocks of size 2^( 7) =       0.000556707402

      target function =                  N/A
              le_mean =     -22.825107752599
             les_mean =     521.488849175567
             stat err =       0.000553245799
             autocorr =       1.216282786066
              std dev =       0.709440278994
             le_variance =       0.503305509459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503409438456
                                         uncertainty =       0.002807039521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503409438456
                                         uncertainty =       0.002807039521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501686083
  error estimate for blocks of size 2^( 2) =       0.000519363700
  error estimate for blocks of size 2^( 3) =       0.000534662554
  error estimate for blocks of size 2^( 4) =       0.000546523267
  error estimate for blocks of size 2^( 5) =       0.000553762857
  error estimate for blocks of size 2^( 6) =       0.000556074730
  error estimate for blocks of size 2^( 7) =       0.000556736868

      target function =                  N/A
              le_mean =     -22.825108505714
             les_mean =     521.488955897956
             stat err =       0.000553274430
             autocorr =       1.216233865591
              std dev =       0.709491262827
             le_variance =       0.503377852028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502757862982
                                         uncertainty =       0.002802260330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502757862982
                                         uncertainty =       0.002802260330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501361227
  error estimate for blocks of size 2^( 2) =       0.000519058931
  error estimate for blocks of size 2^( 3) =       0.000534381642
  error estimate for blocks of size 2^( 4) =       0.000546262621
  error estimate for blocks of size 2^( 5) =       0.000553497563
  error estimate for blocks of size 2^( 6) =       0.000555808974
  error estimate for blocks of size 2^( 7) =       0.000556463692

      target function =                  N/A
              le_mean =     -22.825105155281
             les_mean =     521.488151258915
             stat err =       0.000553008213
             autocorr =       1.216638826911
              std dev =       0.709031847426
             le_variance =       0.502726160664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825104701015        initial
     5.9605e-02     5.9605e-01             1.8170e-03       -22.825107752599
     2.3842e-01     2.3842e+00             5.2960e-04       -22.825108505714  <--
     9.5367e-01     9.5367e+00             1.6391e-04       -22.825105155281

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 6.0941e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.690636e-01 1 1  ON 0
 uu_1                 9.454841e-02 1 1  ON 1
 uu_2                -1.679671e-02 1 1  ON 2
 uu_3                -8.240981e-02 1 1  ON 3
 uu_4                -1.197939e-01 1 1  ON 4
 uu_5                -1.421558e-01 1 1  ON 5
 uu_6                -1.547791e-01 1 1  ON 6
 uu_7                -1.566866e-01 1 1  ON 7
 uu_8                -1.448510e-01 1 1  ON 8
 uu_9                -1.137119e-01 1 1  ON 9
 ud_0                 4.406124e-01 1 1  ON 10
 ud_1                 1.580854e-01 1 1  ON 11
 ud_2                 1.213819e-02 1 1  ON 12
 ud_3                -6.780105e-02 1 1  ON 13
 ud_4                -1.149032e-01 1 1  ON 14
 ud_5                -1.443813e-01 1 1  ON 15
 ud_6                -1.620921e-01 1 1  ON 16
 ud_7                -1.675838e-01 1 1  ON 17
 ud_8                -1.580805e-01 1 1  ON 18
 ud_9                -1.296868e-01 1 1  ON 19
 eC_0                -5.642081e-01 1 1  ON 20
 eC_1                -4.090329e-01 1 1  ON 21
 eC_2                -1.601103e-01 1 1  ON 22
 eC_3                -1.428710e-02 1 1  ON 23
 eC_4                 3.233767e-02 1 1  ON 24
 eC_5                 1.163035e-01 1 1  ON 25
 eC_6                 2.336810e-01 1 1  ON 26
 eC_7                 3.963533e-01 1 1  ON 27
 eC_8                 2.862741e-01 1 1  ON 28
 eC_9                 7.600660e-02 1 1  ON 29
 eO_0                -1.244692e+00 1 1  ON 30
 eO_1                -8.660317e-01 1 1  ON 31
 eO_2                -3.860218e-01 1 1  ON 32
 eO_3                -4.046709e-02 1 1  ON 33
 eO_4                 1.882294e-01 1 1  ON 34
 eO_5                 3.726123e-01 1 1  ON 35
 eO_6                 4.623963e-01 1 1  ON 36
 eO_7                 5.236302e-01 1 1  ON 37
 eO_8                 4.810748e-01 1 1  ON 38
 eO_9                 3.329162e-01 1 1  ON 39
eH1_0                -1.851648e-01 1 1  ON 40
eH1_1                -9.743309e-02 1 1  ON 41
eH1_2                -6.442823e-02 1 1  ON 42
eH1_3                -4.850496e-02 1 1  ON 43
eH1_4                 1.228219e-02 1 1  ON 44
eH1_5                 6.929537e-02 1 1  ON 45
eH1_6                 1.260556e-01 1 1  ON 46
eH1_7                 1.010808e-01 1 1  ON 47
eH1_8                 1.004100e-02 1 1  ON 48
eH1_9                -1.769406e-02 1 1  ON 49
eH2_0                -1.868828e-01 1 1  ON 50
eH2_1                -9.909583e-02 1 1  ON 51
eH2_2                -6.590325e-02 1 1  ON 52
eH2_3                -4.999667e-02 1 1  ON 53
eH2_4                 1.089979e-02 1 1  ON 54
eH2_5                 6.762715e-02 1 1  ON 55
eH2_6                 1.243135e-01 1 1  ON 56
eH2_7                 9.993611e-02 1 1  ON 57
eH2_8                 8.350704e-03 1 1  ON 58
eH2_9                -1.184263e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2023e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2839e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7761
    reference variance = 0.481843
====================================================
  Execution time = 4.3849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1234e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5010e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512412634903
                                         uncertainty =       0.011901736816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512412634903
                                         uncertainty =       0.011901736816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506132281
  error estimate for blocks of size 2^( 2) =       0.000524251416
  error estimate for blocks of size 2^( 3) =       0.000540063864
  error estimate for blocks of size 2^( 4) =       0.000551311565
  error estimate for blocks of size 2^( 5) =       0.000558813060
  error estimate for blocks of size 2^( 6) =       0.000559762695
  error estimate for blocks of size 2^( 7) =       0.000559246434

      target function =                  N/A
              le_mean =     -22.825962213758
             les_mean =     521.536890500172
             stat err =       0.000557283439
             autocorr =       1.212339340319
              std dev =       0.715779136643
             le_variance =       0.512339772453


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282596221376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825962213758       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825966636634       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825965366721       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825965567701       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825964829218       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825964199533       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825965200281       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825968236921       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825968523682       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825969152491       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825969809240       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825969503915       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825969681714       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825969538372       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825969246774       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825969138682       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825968811081       residual = 6.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e-02 is 2.027721e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825962213758       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825965020564       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825964951353       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825964558837       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825963713001       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825963758523       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825964112937       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825965396774       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825965472312       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825965570333       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825965739093       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825965641545       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e-01 is 4.884096e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825962213758       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825963354014       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825963610640       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825963448438       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825963427126       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825963015530       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825963114220       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825963471571       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825963483633       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825963483645       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e-01 is 1.638611e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8870e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.686883e-01 1 1  ON 0
 uu_1                 9.456047e-02 1 1  ON 1
 uu_2                -1.677092e-02 1 1  ON 2
 uu_3                -8.227040e-02 1 1  ON 3
 uu_4                -1.196706e-01 1 1  ON 4
 uu_5                -1.420269e-01 1 1  ON 5
 uu_6                -1.546542e-01 1 1  ON 6
 uu_7                -1.568379e-01 1 1  ON 7
 uu_8                -1.450928e-01 1 1  ON 8
 uu_9                -1.136623e-01 1 1  ON 9
 ud_0                 4.404147e-01 1 1  ON 10
 ud_1                 1.580402e-01 1 1  ON 11
 ud_2                 1.207919e-02 1 1  ON 12
 ud_3                -6.768509e-02 1 1  ON 13
 ud_4                -1.148917e-01 1 1  ON 14
 ud_5                -1.443228e-01 1 1  ON 15
 ud_6                -1.622172e-01 1 1  ON 16
 ud_7                -1.674968e-01 1 1  ON 17
 ud_8                -1.577336e-01 1 1  ON 18
 ud_9                -1.294370e-01 1 1  ON 19
 eC_0                -5.638027e-01 1 1  ON 20
 eC_1                -4.091596e-01 1 1  ON 21
 eC_2                -1.602096e-01 1 1  ON 22
 eC_3                -1.468607e-02 1 1  ON 23
 eC_4                 3.184926e-02 1 1  ON 24
 eC_5                 1.163412e-01 1 1  ON 25
 eC_6                 2.336362e-01 1 1  ON 26
 eC_7                 3.963431e-01 1 1  ON 27
 eC_8                 2.867507e-01 1 1  ON 28
 eC_9                 7.622466e-02 1 1  ON 29
 eO_0                -1.244732e+00 1 1  ON 30
 eO_1                -8.661428e-01 1 1  ON 31
 eO_2                -3.861716e-01 1 1  ON 32
 eO_3                -4.082188e-02 1 1  ON 33
 eO_4                 1.877902e-01 1 1  ON 34
 eO_5                 3.724051e-01 1 1  ON 35
 eO_6                 4.627114e-01 1 1  ON 36
 eO_7                 5.236442e-01 1 1  ON 37
 eO_8                 4.811523e-01 1 1  ON 38
 eO_9                 3.333935e-01 1 1  ON 39
eH1_0                -1.849362e-01 1 1  ON 40
eH1_1                -9.765099e-02 1 1  ON 41
eH1_2                -6.457858e-02 1 1  ON 42
eH1_3                -4.865585e-02 1 1  ON 43
eH1_4                 1.220786e-02 1 1  ON 44
eH1_5                 6.899894e-02 1 1  ON 45
eH1_6                 1.261108e-01 1 1  ON 46
eH1_7                 1.015066e-01 1 1  ON 47
eH1_8                 1.020225e-02 1 1  ON 48
eH1_9                -1.781658e-02 1 1  ON 49
eH2_0                -1.871267e-01 1 1  ON 50
eH2_1                -9.904574e-02 1 1  ON 51
eH2_2                -6.598128e-02 1 1  ON 52
eH2_3                -4.991086e-02 1 1  ON 53
eH2_4                 1.098115e-02 1 1  ON 54
eH2_5                 6.792982e-02 1 1  ON 55
eH2_6                 1.243162e-01 1 1  ON 56
eH2_7                 9.972590e-02 1 1  ON 57
eH2_8                 8.361095e-03 1 1  ON 58
eH2_9                -1.202179e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8572
    reference variance = 0.409858
====================================================
  Execution time = 4.3605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0754e-01
  Total weights = 2.0000e+06
  Execution time = 3.5337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507920580564
                                         uncertainty =       0.003385408759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507920580564
                                         uncertainty =       0.003385408759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503945904
  error estimate for blocks of size 2^( 2) =       0.000521690378
  error estimate for blocks of size 2^( 3) =       0.000537721124
  error estimate for blocks of size 2^( 4) =       0.000549598321
  error estimate for blocks of size 2^( 5) =       0.000554611257
  error estimate for blocks of size 2^( 6) =       0.000559555819
  error estimate for blocks of size 2^( 7) =       0.000560559102

      target function =                  N/A
              le_mean =     -22.825400249987
             les_mean =     521.506819266286
             stat err =       0.000556081125
             autocorr =       1.217610736095
              std dev =       0.712687132003
             le_variance =       0.507922948123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507251919861
                                         uncertainty =       0.003382086173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507251919861
                                         uncertainty =       0.003382086173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503614181
  error estimate for blocks of size 2^( 2) =       0.000521373378
  error estimate for blocks of size 2^( 3) =       0.000537422571
  error estimate for blocks of size 2^( 4) =       0.000549318948
  error estimate for blocks of size 2^( 5) =       0.000554342263
  error estimate for blocks of size 2^( 6) =       0.000559294939
  error estimate for blocks of size 2^( 7) =       0.000560316119

      target function =                  N/A
              le_mean =     -22.825401091852
             les_mean =     521.506189236142
             stat err =       0.000555818067
             autocorr =       1.218062066797
              std dev =       0.712218004438
             le_variance =       0.507254485846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507165727802
                                         uncertainty =       0.003381549665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507165727802
                                         uncertainty =       0.003381549665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503571458
  error estimate for blocks of size 2^( 2) =       0.000521332611
  error estimate for blocks of size 2^( 3) =       0.000537383434
  error estimate for blocks of size 2^( 4) =       0.000549283392
  error estimate for blocks of size 2^( 5) =       0.000554310455
  error estimate for blocks of size 2^( 6) =       0.000559261800
  error estimate for blocks of size 2^( 7) =       0.000560279198

      target function =                  N/A
              le_mean =     -22.825400687896
             les_mean =     521.506084735207
             stat err =       0.000555783711
             autocorr =       1.218118154771
              std dev =       0.712157584944
             le_variance =       0.507168425793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507783802287
                                         uncertainty =       0.003384752235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507783802287
                                         uncertainty =       0.003384752235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503878091
  error estimate for blocks of size 2^( 2) =       0.000521624994
  error estimate for blocks of size 2^( 3) =       0.000537658650
  error estimate for blocks of size 2^( 4) =       0.000549539766
  error estimate for blocks of size 2^( 5) =       0.000554554974
  error estimate for blocks of size 2^( 6) =       0.000559499756
  error estimate for blocks of size 2^( 7) =       0.000560505282

      target function =                  N/A
              le_mean =     -22.825399691998
             les_mean =     521.506657106621
             stat err =       0.000556024944
             autocorr =       1.217692413097
              std dev =       0.712591229999
             le_variance =       0.507786261072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825400249987        initial
     5.9605e-02     5.9605e-01             2.0277e-03       -22.825401091852  <--
     2.3842e-01     2.3842e+00             4.8841e-04       -22.825400687896
     9.5367e-01     9.5367e+00             1.6386e-04       -22.825399691998

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 6.1384e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.684833e-01 1 1  ON 0
 uu_1                 9.458011e-02 1 1  ON 1
 uu_2                -1.671333e-02 1 1  ON 2
 uu_3                -8.213078e-02 1 1  ON 3
 uu_4                -1.194953e-01 1 1  ON 4
 uu_5                -1.418795e-01 1 1  ON 5
 uu_6                -1.546092e-01 1 1  ON 6
 uu_7                -1.570337e-01 1 1  ON 7
 uu_8                -1.456900e-01 1 1  ON 8
 uu_9                -1.137181e-01 1 1  ON 9
 ud_0                 4.403095e-01 1 1  ON 10
 ud_1                 1.580060e-01 1 1  ON 11
 ud_2                 1.208094e-02 1 1  ON 12
 ud_3                -6.758924e-02 1 1  ON 13
 ud_4                -1.147764e-01 1 1  ON 14
 ud_5                -1.441983e-01 1 1  ON 15
 ud_6                -1.621563e-01 1 1  ON 16
 ud_7                -1.673360e-01 1 1  ON 17
 ud_8                -1.573373e-01 1 1  ON 18
 ud_9                -1.288021e-01 1 1  ON 19
 eC_0                -5.633922e-01 1 1  ON 20
 eC_1                -4.091615e-01 1 1  ON 21
 eC_2                -1.604341e-01 1 1  ON 22
 eC_3                -1.540402e-02 1 1  ON 23
 eC_4                 3.072380e-02 1 1  ON 24
 eC_5                 1.158622e-01 1 1  ON 25
 eC_6                 2.334397e-01 1 1  ON 26
 eC_7                 3.963102e-01 1 1  ON 27
 eC_8                 2.883019e-01 1 1  ON 28
 eC_9                 7.693912e-02 1 1  ON 29
 eO_0                -1.245177e+00 1 1  ON 30
 eO_1                -8.666707e-01 1 1  ON 31
 eO_2                -3.867578e-01 1 1  ON 32
 eO_3                -4.157936e-02 1 1  ON 33
 eO_4                 1.869612e-01 1 1  ON 34
 eO_5                 3.719007e-01 1 1  ON 35
 eO_6                 4.631806e-01 1 1  ON 36
 eO_7                 5.236671e-01 1 1  ON 37
 eO_8                 4.813934e-01 1 1  ON 38
 eO_9                 3.349379e-01 1 1  ON 39
eH1_0                -1.850384e-01 1 1  ON 40
eH1_1                -9.799677e-02 1 1  ON 41
eH1_2                -6.497136e-02 1 1  ON 42
eH1_3                -4.899662e-02 1 1  ON 43
eH1_4                 1.197818e-02 1 1  ON 44
eH1_5                 6.883763e-02 1 1  ON 45
eH1_6                 1.263018e-01 1 1  ON 46
eH1_7                 1.022795e-01 1 1  ON 47
eH1_8                 1.073688e-02 1 1  ON 48
eH1_9                -1.820331e-02 1 1  ON 49
eH2_0                -1.874244e-01 1 1  ON 50
eH2_1                -9.914068e-02 1 1  ON 51
eH2_2                -6.607842e-02 1 1  ON 52
eH2_3                -4.986252e-02 1 1  ON 53
eH2_4                 1.113778e-02 1 1  ON 54
eH2_5                 6.837327e-02 1 1  ON 55
eH2_6                 1.246534e-01 1 1  ON 56
eH2_7                 9.925002e-02 1 1  ON 57
eH2_8                 8.366665e-03 1 1  ON 58
eH2_9                -1.262621e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2026e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.789
    reference variance = 0.288405
====================================================
  Execution time = 4.4423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0833e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4834e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508443970732
                                         uncertainty =       0.004575010888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508443970732
                                         uncertainty =       0.004575010888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504145588
  error estimate for blocks of size 2^( 2) =       0.000521683978
  error estimate for blocks of size 2^( 3) =       0.000537400789
  error estimate for blocks of size 2^( 4) =       0.000549482619
  error estimate for blocks of size 2^( 5) =       0.000555554476
  error estimate for blocks of size 2^( 6) =       0.000561698679
  error estimate for blocks of size 2^( 7) =       0.000563195052

      target function =                  N/A
              le_mean =     -22.825146187434
             les_mean =     521.495623772232
             stat err =       0.000557482707
             autocorr =       1.222787125891
              std dev =       0.712969528562
             le_variance =       0.508325548658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282514618743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825146187434       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825148111243       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825148689998       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825148312431       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825147373068       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825147006348       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825148791468       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825149109475       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825147638459       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825147231480       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825147417968       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825148666743       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825149020889       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825150954980       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825152970416       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825151930953       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825152951300       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825152157947       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.825153175652       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.825153277999       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.825153211709       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.825152731835       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.825152403513       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e-02 is 6.712795e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825146187434       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825147873765       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825148332246       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825148023980       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825147254808       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825146818482       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825148141821       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825148319721       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825147238354       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825146755851       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825147195544       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825147857695       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825147801972       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825148592081       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825148883281       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825148547715       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825148744275       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825148512250       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e-02 is 1.757855e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825146187434       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825147316346       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825147590058       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825147420281       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825147061136       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825146638954       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825147141067       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825147045485       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825146704971       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825146388280       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825146819531       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825146791486       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825146915480       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e-01 is 6.586544e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9273e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.688850e-01 1 1  ON 0
 uu_1                 9.473720e-02 1 1  ON 1
 uu_2                -1.650508e-02 1 1  ON 2
 uu_3                -8.191229e-02 1 1  ON 3
 uu_4                -1.195410e-01 1 1  ON 4
 uu_5                -1.421520e-01 1 1  ON 5
 uu_6                -1.548551e-01 1 1  ON 6
 uu_7                -1.570406e-01 1 1  ON 7
 uu_8                -1.454803e-01 1 1  ON 8
 uu_9                -1.143542e-01 1 1  ON 9
 ud_0                 4.405688e-01 1 1  ON 10
 ud_1                 1.584514e-01 1 1  ON 11
 ud_2                 1.263718e-02 1 1  ON 12
 ud_3                -6.721154e-02 1 1  ON 13
 ud_4                -1.142963e-01 1 1  ON 14
 ud_5                -1.439499e-01 1 1  ON 15
 ud_6                -1.614721e-01 1 1  ON 16
 ud_7                -1.670477e-01 1 1  ON 17
 ud_8                -1.583888e-01 1 1  ON 18
 ud_9                -1.286808e-01 1 1  ON 19
 eC_0                -5.638324e-01 1 1  ON 20
 eC_1                -4.095242e-01 1 1  ON 21
 eC_2                -1.609979e-01 1 1  ON 22
 eC_3                -1.570276e-02 1 1  ON 23
 eC_4                 3.042618e-02 1 1  ON 24
 eC_5                 1.161388e-01 1 1  ON 25
 eC_6                 2.323918e-01 1 1  ON 26
 eC_7                 3.963685e-01 1 1  ON 27
 eC_8                 2.900597e-01 1 1  ON 28
 eC_9                 7.779389e-02 1 1  ON 29
 eO_0                -1.245955e+00 1 1  ON 30
 eO_1                -8.680083e-01 1 1  ON 31
 eO_2                -3.884876e-01 1 1  ON 32
 eO_3                -4.272234e-02 1 1  ON 33
 eO_4                 1.875256e-01 1 1  ON 34
 eO_5                 3.723271e-01 1 1  ON 35
 eO_6                 4.634747e-01 1 1  ON 36
 eO_7                 5.248136e-01 1 1  ON 37
 eO_8                 4.811114e-01 1 1  ON 38
 eO_9                 3.361270e-01 1 1  ON 39
eH1_0                -1.858445e-01 1 1  ON 40
eH1_1                -9.791486e-02 1 1  ON 41
eH1_2                -6.515124e-02 1 1  ON 42
eH1_3                -4.863464e-02 1 1  ON 43
eH1_4                 1.240658e-02 1 1  ON 44
eH1_5                 6.942538e-02 1 1  ON 45
eH1_6                 1.262244e-01 1 1  ON 46
eH1_7                 1.015711e-01 1 1  ON 47
eH1_8                 1.093152e-02 1 1  ON 48
eH1_9                -1.861312e-02 1 1  ON 49
eH2_0                -1.886964e-01 1 1  ON 50
eH2_1                -9.987718e-02 1 1  ON 51
eH2_2                -6.603425e-02 1 1  ON 52
eH2_3                -4.999436e-02 1 1  ON 53
eH2_4                 1.120686e-02 1 1  ON 54
eH2_5                 6.819363e-02 1 1  ON 55
eH2_6                 1.254549e-01 1 1  ON 56
eH2_7                 9.951285e-02 1 1  ON 57
eH2_8                 9.865804e-03 1 1  ON 58
eH2_9                -1.320094e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7866
    reference variance = 0.591313
====================================================
  Execution time = 4.3680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0009e-01
  Total weights = 2.0000e+06
  Execution time = 3.5284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500410073778
                                         uncertainty =       0.003081732569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500410073778
                                         uncertainty =       0.003081732569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500207143
  error estimate for blocks of size 2^( 2) =       0.000518101452
  error estimate for blocks of size 2^( 3) =       0.000533978096
  error estimate for blocks of size 2^( 4) =       0.000545151923
  error estimate for blocks of size 2^( 5) =       0.000551152031
  error estimate for blocks of size 2^( 6) =       0.000554450644
  error estimate for blocks of size 2^( 7) =       0.000555410238

      target function =                  N/A
              le_mean =     -22.825237771966
             les_mean =     521.491893468023
             stat err =       0.000551541209
             autocorr =       1.215783248842
              std dev =       0.707399725373
             le_variance =       0.500414371457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247281222
                                         uncertainty =       0.003084165846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500247281222
                                         uncertainty =       0.003084165846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500125621
  error estimate for blocks of size 2^( 2) =       0.000518031964
  error estimate for blocks of size 2^( 3) =       0.000533916291
  error estimate for blocks of size 2^( 4) =       0.000545089551
  error estimate for blocks of size 2^( 5) =       0.000551091714
  error estimate for blocks of size 2^( 6) =       0.000554389618
  error estimate for blocks of size 2^( 7) =       0.000555333254

      target function =                  N/A
              le_mean =     -22.825232569479
             les_mean =     521.491492874541
             stat err =       0.000551476034
             autocorr =       1.215892222215
              std dev =       0.707284436336
             le_variance =       0.500251273883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499796163059
                                         uncertainty =       0.003081654879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499796163059
                                         uncertainty =       0.003081654879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499900027
  error estimate for blocks of size 2^( 2) =       0.000517826005
  error estimate for blocks of size 2^( 3) =       0.000533729829
  error estimate for blocks of size 2^( 4) =       0.000544916857
  error estimate for blocks of size 2^( 5) =       0.000550928254
  error estimate for blocks of size 2^( 6) =       0.000554229864
  error estimate for blocks of size 2^( 7) =       0.000555173469

      target function =                  N/A
              le_mean =     -22.825234524891
             les_mean =     521.491130940864
             stat err =       0.000551312111
             autocorr =       1.216266500378
              std dev =       0.706965398355
             le_variance =       0.499800074471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500162370465
                                         uncertainty =       0.003081305934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500162370465
                                         uncertainty =       0.003081305934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500083260
  error estimate for blocks of size 2^( 2) =       0.000517988052
  error estimate for blocks of size 2^( 3) =       0.000533873759
  error estimate for blocks of size 2^( 4) =       0.000545053400
  error estimate for blocks of size 2^( 5) =       0.000551056931
  error estimate for blocks of size 2^( 6) =       0.000554356915
  error estimate for blocks of size 2^( 7) =       0.000555313035

      target function =                  N/A
              le_mean =     -22.825235211687
             les_mean =     521.491528751880
             stat err =       0.000551445070
             autocorr =       1.215961666299
              std dev =       0.707224528080
             le_variance =       0.500166533118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825237771966        initial  <--
     1.4901e-02     1.4901e-01             6.7128e-03       -22.825232569479
     5.9605e-02     5.9605e-01             1.7579e-03       -22.825234524891
     2.3842e-01     2.3842e+00             6.5865e-04       -22.825235211687

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9392
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.684833e-01 1 1  ON 0
 uu_1                 9.458011e-02 1 1  ON 1
 uu_2                -1.671333e-02 1 1  ON 2
 uu_3                -8.213078e-02 1 1  ON 3
 uu_4                -1.194953e-01 1 1  ON 4
 uu_5                -1.418795e-01 1 1  ON 5
 uu_6                -1.546092e-01 1 1  ON 6
 uu_7                -1.570337e-01 1 1  ON 7
 uu_8                -1.456900e-01 1 1  ON 8
 uu_9                -1.137181e-01 1 1  ON 9
 ud_0                 4.403095e-01 1 1  ON 10
 ud_1                 1.580060e-01 1 1  ON 11
 ud_2                 1.208094e-02 1 1  ON 12
 ud_3                -6.758924e-02 1 1  ON 13
 ud_4                -1.147764e-01 1 1  ON 14
 ud_5                -1.441983e-01 1 1  ON 15
 ud_6                -1.621563e-01 1 1  ON 16
 ud_7                -1.673360e-01 1 1  ON 17
 ud_8                -1.573373e-01 1 1  ON 18
 ud_9                -1.288021e-01 1 1  ON 19
 eC_0                -5.633922e-01 1 1  ON 20
 eC_1                -4.091615e-01 1 1  ON 21
 eC_2                -1.604341e-01 1 1  ON 22
 eC_3                -1.540402e-02 1 1  ON 23
 eC_4                 3.072380e-02 1 1  ON 24
 eC_5                 1.158622e-01 1 1  ON 25
 eC_6                 2.334397e-01 1 1  ON 26
 eC_7                 3.963102e-01 1 1  ON 27
 eC_8                 2.883019e-01 1 1  ON 28
 eC_9                 7.693912e-02 1 1  ON 29
 eO_0                -1.245177e+00 1 1  ON 30
 eO_1                -8.666707e-01 1 1  ON 31
 eO_2                -3.867578e-01 1 1  ON 32
 eO_3                -4.157936e-02 1 1  ON 33
 eO_4                 1.869612e-01 1 1  ON 34
 eO_5                 3.719007e-01 1 1  ON 35
 eO_6                 4.631806e-01 1 1  ON 36
 eO_7                 5.236671e-01 1 1  ON 37
 eO_8                 4.813934e-01 1 1  ON 38
 eO_9                 3.349379e-01 1 1  ON 39
eH1_0                -1.850384e-01 1 1  ON 40
eH1_1                -9.799677e-02 1 1  ON 41
eH1_2                -6.497136e-02 1 1  ON 42
eH1_3                -4.899662e-02 1 1  ON 43
eH1_4                 1.197818e-02 1 1  ON 44
eH1_5                 6.883763e-02 1 1  ON 45
eH1_6                 1.263018e-01 1 1  ON 46
eH1_7                 1.022795e-01 1 1  ON 47
eH1_8                 1.073688e-02 1 1  ON 48
eH1_9                -1.820331e-02 1 1  ON 49
eH2_0                -1.874244e-01 1 1  ON 50
eH2_1                -9.914068e-02 1 1  ON 51
eH2_2                -6.607842e-02 1 1  ON 52
eH2_3                -4.986252e-02 1 1  ON 53
eH2_4                 1.113778e-02 1 1  ON 54
eH2_5                 6.837327e-02 1 1  ON 55
eH2_6                 1.246534e-01 1 1  ON 56
eH2_7                 9.925002e-02 1 1  ON 57
eH2_8                 8.366665e-03 1 1  ON 58
eH2_9                -1.262621e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2322e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7584
    reference variance = 0.473954
====================================================
  Execution time = 4.4585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0391e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4885e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503985305145
                                         uncertainty =       0.004523676714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503985305145
                                         uncertainty =       0.004523676714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501952670
  error estimate for blocks of size 2^( 2) =       0.000519605634
  error estimate for blocks of size 2^( 3) =       0.000534707479
  error estimate for blocks of size 2^( 4) =       0.000545750904
  error estimate for blocks of size 2^( 5) =       0.000550950151
  error estimate for blocks of size 2^( 6) =       0.000555696722
  error estimate for blocks of size 2^( 7) =       0.000556093048

      target function =                  N/A
              le_mean =     -22.826032111611
             les_mean =     521.531654673495
             stat err =       0.000552122706
             autocorr =       1.209889421438
              std dev =       0.709868273103
             le_variance =       0.503912965158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282603211161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826032111611       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826034617636       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826032901407       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826033169172       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826032444267       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826031978596       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826031920445       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826030763364       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826031298647       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826032220153       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826032339459       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826032269345       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826032206399       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e-01 is 7.902102e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826032111611       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826033149582       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826032395581       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826032469921       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826032196749       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826031936951       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826032006845       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826031518557       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826031728414       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826031953775       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826031848736       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826031837960       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e-01 is 2.904290e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826032111611       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826032422079       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826032188873       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826032207589       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826032142975       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826032055759       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826032084093       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826031944229       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826032008883       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826032020817       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+00 is 8.704713e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9479e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.685500e-01 1 1  ON 0
 uu_1                 9.447772e-02 1 1  ON 1
 uu_2                -1.673757e-02 1 1  ON 2
 uu_3                -8.207453e-02 1 1  ON 3
 uu_4                -1.195841e-01 1 1  ON 4
 uu_5                -1.420011e-01 1 1  ON 5
 uu_6                -1.546419e-01 1 1  ON 6
 uu_7                -1.568642e-01 1 1  ON 7
 uu_8                -1.456694e-01 1 1  ON 8
 uu_9                -1.136925e-01 1 1  ON 9
 ud_0                 4.404050e-01 1 1  ON 10
 ud_1                 1.578955e-01 1 1  ON 11
 ud_2                 1.218071e-02 1 1  ON 12
 ud_3                -6.757616e-02 1 1  ON 13
 ud_4                -1.147067e-01 1 1  ON 14
 ud_5                -1.442663e-01 1 1  ON 15
 ud_6                -1.619434e-01 1 1  ON 16
 ud_7                -1.674995e-01 1 1  ON 17
 ud_8                -1.574333e-01 1 1  ON 18
 ud_9                -1.286384e-01 1 1  ON 19
 eC_0                -5.634010e-01 1 1  ON 20
 eC_1                -4.092362e-01 1 1  ON 21
 eC_2                -1.604472e-01 1 1  ON 22
 eC_3                -1.550219e-02 1 1  ON 23
 eC_4                 3.079530e-02 1 1  ON 24
 eC_5                 1.158322e-01 1 1  ON 25
 eC_6                 2.333295e-01 1 1  ON 26
 eC_7                 3.962770e-01 1 1  ON 27
 eC_8                 2.885102e-01 1 1  ON 28
 eC_9                 7.701951e-02 1 1  ON 29
 eO_0                -1.245184e+00 1 1  ON 30
 eO_1                -8.667559e-01 1 1  ON 31
 eO_2                -3.869702e-01 1 1  ON 32
 eO_3                -4.178301e-02 1 1  ON 33
 eO_4                 1.870336e-01 1 1  ON 34
 eO_5                 3.719178e-01 1 1  ON 35
 eO_6                 4.631174e-01 1 1  ON 36
 eO_7                 5.237824e-01 1 1  ON 37
 eO_8                 4.814426e-01 1 1  ON 38
 eO_9                 3.350873e-01 1 1  ON 39
eH1_0                -1.849796e-01 1 1  ON 40
eH1_1                -9.802844e-02 1 1  ON 41
eH1_2                -6.495859e-02 1 1  ON 42
eH1_3                -4.915138e-02 1 1  ON 43
eH1_4                 1.206080e-02 1 1  ON 44
eH1_5                 6.912806e-02 1 1  ON 45
eH1_6                 1.262000e-01 1 1  ON 46
eH1_7                 1.021208e-01 1 1  ON 47
eH1_8                 1.071857e-02 1 1  ON 48
eH1_9                -1.823876e-02 1 1  ON 49
eH2_0                -1.874785e-01 1 1  ON 50
eH2_1                -9.926996e-02 1 1  ON 51
eH2_2                -6.613644e-02 1 1  ON 52
eH2_3                -4.987534e-02 1 1  ON 53
eH2_4                 1.121494e-02 1 1  ON 54
eH2_5                 6.837074e-02 1 1  ON 55
eH2_6                 1.246956e-01 1 1  ON 56
eH2_7                 9.938956e-02 1 1  ON 57
eH2_8                 8.349028e-03 1 1  ON 58
eH2_9                -1.268383e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.811
    reference variance = 0.740336
====================================================
  Execution time = 4.3549e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0039e-01
  Total weights = 2.0000e+06
  Execution time = 3.5406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500448730181
                                         uncertainty =       0.003686791419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500448730181
                                         uncertainty =       0.003686791419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500221361
  error estimate for blocks of size 2^( 2) =       0.000518498071
  error estimate for blocks of size 2^( 3) =       0.000534026680
  error estimate for blocks of size 2^( 4) =       0.000544610639
  error estimate for blocks of size 2^( 5) =       0.000550871686
  error estimate for blocks of size 2^( 6) =       0.000553825028
  error estimate for blocks of size 2^( 7) =       0.000554023919

      target function =                  N/A
              le_mean =     -22.825647697840
             les_mean =     521.510635394935
             stat err =       0.000550832818
             autocorr =       1.212593255509
              std dev =       0.707419832391
             le_variance =       0.500442819261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500301809411
                                         uncertainty =       0.003686691654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500301809411
                                         uncertainty =       0.003686691654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500147930
  error estimate for blocks of size 2^( 2) =       0.000518431561
  error estimate for blocks of size 2^( 3) =       0.000533970343
  error estimate for blocks of size 2^( 4) =       0.000544565388
  error estimate for blocks of size 2^( 5) =       0.000550822007
  error estimate for blocks of size 2^( 6) =       0.000553767041
  error estimate for blocks of size 2^( 7) =       0.000553967646

      target function =                  N/A
              le_mean =     -22.825649670183
             les_mean =     521.510578519328
             stat err =       0.000550780520
             autocorr =       1.212719030597
              std dev =       0.707315985633
             le_variance =       0.500295903532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500344515790
                                         uncertainty =       0.003687065373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500344515790
                                         uncertainty =       0.003687065373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500169285
  error estimate for blocks of size 2^( 2) =       0.000518452783
  error estimate for blocks of size 2^( 3) =       0.000533991828
  error estimate for blocks of size 2^( 4) =       0.000544587948
  error estimate for blocks of size 2^( 5) =       0.000550842460
  error estimate for blocks of size 2^( 6) =       0.000553785927
  error estimate for blocks of size 2^( 7) =       0.000553990227

      target function =                  N/A
              le_mean =     -22.825649670798
             les_mean =     521.510621271150
             stat err =       0.000550801641
             autocorr =       1.212708477038
              std dev =       0.707346186341
             le_variance =       0.500338627330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500442301732
                                         uncertainty =       0.003686971169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500442301732
                                         uncertainty =       0.003686971169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500218154
  error estimate for blocks of size 2^( 2) =       0.000518495789
  error estimate for blocks of size 2^( 3) =       0.000534026114
  error estimate for blocks of size 2^( 4) =       0.000544612282
  error estimate for blocks of size 2^( 5) =       0.000550871620
  error estimate for blocks of size 2^( 6) =       0.000553822997
  error estimate for blocks of size 2^( 7) =       0.000554023097

      target function =                  N/A
              le_mean =     -22.825647721608
             les_mean =     521.510630063909
             stat err =       0.000550832499
             autocorr =       1.212607394980
              std dev =       0.707415297535
             le_variance =       0.500436403186


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825647697840        initial
     1.4901e-01     1.4901e+00             7.9021e-04       -22.825649670183
     5.9605e-01     5.9605e+00             2.9043e-04       -22.825649670798  <--
     2.3842e+00     2.3842e+01             8.7047e-05       -22.825647721608

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 6.1346e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.685500e-01 1 1  ON 0
 uu_1                 9.447772e-02 1 1  ON 1
 uu_2                -1.673757e-02 1 1  ON 2
 uu_3                -8.207453e-02 1 1  ON 3
 uu_4                -1.195841e-01 1 1  ON 4
 uu_5                -1.420011e-01 1 1  ON 5
 uu_6                -1.546419e-01 1 1  ON 6
 uu_7                -1.568642e-01 1 1  ON 7
 uu_8                -1.456694e-01 1 1  ON 8
 uu_9                -1.136925e-01 1 1  ON 9
 ud_0                 4.404050e-01 1 1  ON 10
 ud_1                 1.578955e-01 1 1  ON 11
 ud_2                 1.218071e-02 1 1  ON 12
 ud_3                -6.757616e-02 1 1  ON 13
 ud_4                -1.147067e-01 1 1  ON 14
 ud_5                -1.442663e-01 1 1  ON 15
 ud_6                -1.619434e-01 1 1  ON 16
 ud_7                -1.674995e-01 1 1  ON 17
 ud_8                -1.574333e-01 1 1  ON 18
 ud_9                -1.286384e-01 1 1  ON 19
 eC_0                -5.634010e-01 1 1  ON 20
 eC_1                -4.092362e-01 1 1  ON 21
 eC_2                -1.604472e-01 1 1  ON 22
 eC_3                -1.550219e-02 1 1  ON 23
 eC_4                 3.079530e-02 1 1  ON 24
 eC_5                 1.158322e-01 1 1  ON 25
 eC_6                 2.333295e-01 1 1  ON 26
 eC_7                 3.962770e-01 1 1  ON 27
 eC_8                 2.885102e-01 1 1  ON 28
 eC_9                 7.701951e-02 1 1  ON 29
 eO_0                -1.245184e+00 1 1  ON 30
 eO_1                -8.667559e-01 1 1  ON 31
 eO_2                -3.869702e-01 1 1  ON 32
 eO_3                -4.178301e-02 1 1  ON 33
 eO_4                 1.870336e-01 1 1  ON 34
 eO_5                 3.719178e-01 1 1  ON 35
 eO_6                 4.631174e-01 1 1  ON 36
 eO_7                 5.237824e-01 1 1  ON 37
 eO_8                 4.814426e-01 1 1  ON 38
 eO_9                 3.350873e-01 1 1  ON 39
eH1_0                -1.849796e-01 1 1  ON 40
eH1_1                -9.802844e-02 1 1  ON 41
eH1_2                -6.495859e-02 1 1  ON 42
eH1_3                -4.915138e-02 1 1  ON 43
eH1_4                 1.206080e-02 1 1  ON 44
eH1_5                 6.912806e-02 1 1  ON 45
eH1_6                 1.262000e-01 1 1  ON 46
eH1_7                 1.021208e-01 1 1  ON 47
eH1_8                 1.071857e-02 1 1  ON 48
eH1_9                -1.823876e-02 1 1  ON 49
eH2_0                -1.874785e-01 1 1  ON 50
eH2_1                -9.926996e-02 1 1  ON 51
eH2_2                -6.613644e-02 1 1  ON 52
eH2_3                -4.987534e-02 1 1  ON 53
eH2_4                 1.121494e-02 1 1  ON 54
eH2_5                 6.837074e-02 1 1  ON 55
eH2_6                 1.246956e-01 1 1  ON 56
eH2_7                 9.938956e-02 1 1  ON 57
eH2_8                 8.349028e-03 1 1  ON 58
eH2_9                -1.268383e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2083e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7904
    reference variance = 0.402834
====================================================
  Execution time = 4.4109e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0404e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5047e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503920038420
                                         uncertainty =       0.004624240738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503920038420
                                         uncertainty =       0.004624240738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502015836
  error estimate for blocks of size 2^( 2) =       0.000519564532
  error estimate for blocks of size 2^( 3) =       0.000535072356
  error estimate for blocks of size 2^( 4) =       0.000546177133
  error estimate for blocks of size 2^( 5) =       0.000552179222
  error estimate for blocks of size 2^( 6) =       0.000556810531
  error estimate for blocks of size 2^( 7) =       0.000559068210

      target function =                  N/A
              le_mean =     -22.825863990494
             les_mean =     521.524106458804
             stat err =       0.000553558774
             autocorr =       1.215885401048
              std dev =       0.709957603156
             le_variance =       0.504039798280


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282586399049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825863990494       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825865224136       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825865242719       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825865388409       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825864797462       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825865718713       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825865622195       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825866173689       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825866579181       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825866143519       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825866704554       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825866999642       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825866810741       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825866731698       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e-01 is 6.888007e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825863990494       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825864543266       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825864519606       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825864317701       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825864315726       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825864575151       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825864379491       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825864528334       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825864525965       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825864539931       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825864686045       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e-01 is 2.673376e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825863990494       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825864162822       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825864156706       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825864042618       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825864048690       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825864144925       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825864045421       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825864067060       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825864061303       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825864079075       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+00 is 8.104520e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265052 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9164e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.686727e-01 1 1  ON 0
 uu_1                 9.452211e-02 1 1  ON 1
 uu_2                -1.666334e-02 1 1  ON 2
 uu_3                -8.203480e-02 1 1  ON 3
 uu_4                -1.195535e-01 1 1  ON 4
 uu_5                -1.418952e-01 1 1  ON 5
 uu_6                -1.546887e-01 1 1  ON 6
 uu_7                -1.568963e-01 1 1  ON 7
 uu_8                -1.457900e-01 1 1  ON 8
 uu_9                -1.137825e-01 1 1  ON 9
 ud_0                 4.404052e-01 1 1  ON 10
 ud_1                 1.579366e-01 1 1  ON 11
 ud_2                 1.225824e-02 1 1  ON 12
 ud_3                -6.754400e-02 1 1  ON 13
 ud_4                -1.146431e-01 1 1  ON 14
 ud_5                -1.441874e-01 1 1  ON 15
 ud_6                -1.619363e-01 1 1  ON 16
 ud_7                -1.672321e-01 1 1  ON 17
 ud_8                -1.575402e-01 1 1  ON 18
 ud_9                -1.287490e-01 1 1  ON 19
 eC_0                -5.634204e-01 1 1  ON 20
 eC_1                -4.091657e-01 1 1  ON 21
 eC_2                -1.606046e-01 1 1  ON 22
 eC_3                -1.565086e-02 1 1  ON 23
 eC_4                 3.087553e-02 1 1  ON 24
 eC_5                 1.159801e-01 1 1  ON 25
 eC_6                 2.331845e-01 1 1  ON 26
 eC_7                 3.962142e-01 1 1  ON 27
 eC_8                 2.886733e-01 1 1  ON 28
 eC_9                 7.708561e-02 1 1  ON 29
 eO_0                -1.245250e+00 1 1  ON 30
 eO_1                -8.668713e-01 1 1  ON 31
 eO_2                -3.870165e-01 1 1  ON 32
 eO_3                -4.192638e-02 1 1  ON 33
 eO_4                 1.870541e-01 1 1  ON 34
 eO_5                 3.718631e-01 1 1  ON 35
 eO_6                 4.631299e-01 1 1  ON 36
 eO_7                 5.239222e-01 1 1  ON 37
 eO_8                 4.814730e-01 1 1  ON 38
 eO_9                 3.351868e-01 1 1  ON 39
eH1_0                -1.852028e-01 1 1  ON 40
eH1_1                -9.807194e-02 1 1  ON 41
eH1_2                -6.484144e-02 1 1  ON 42
eH1_3                -4.907735e-02 1 1  ON 43
eH1_4                 1.215670e-02 1 1  ON 44
eH1_5                 6.913724e-02 1 1  ON 45
eH1_6                 1.262867e-01 1 1  ON 46
eH1_7                 1.020732e-01 1 1  ON 47
eH1_8                 1.068204e-02 1 1  ON 48
eH1_9                -1.831787e-02 1 1  ON 49
eH2_0                -1.873644e-01 1 1  ON 50
eH2_1                -9.930334e-02 1 1  ON 51
eH2_2                -6.633673e-02 1 1  ON 52
eH2_3                -4.989546e-02 1 1  ON 53
eH2_4                 1.118910e-02 1 1  ON 54
eH2_5                 6.840375e-02 1 1  ON 55
eH2_6                 1.247825e-01 1 1  ON 56
eH2_7                 9.942162e-02 1 1  ON 57
eH2_8                 8.352259e-03 1 1  ON 58
eH2_9                -1.272702e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8493
    reference variance = 1.16272
====================================================
  Execution time = 4.3554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0306e-01
  Total weights = 2.0000e+06
  Execution time = 3.5360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503047312866
                                         uncertainty =       0.003768804210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503047312866
                                         uncertainty =       0.003768804210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501549454
  error estimate for blocks of size 2^( 2) =       0.000519335436
  error estimate for blocks of size 2^( 3) =       0.000535444951
  error estimate for blocks of size 2^( 4) =       0.000545868552
  error estimate for blocks of size 2^( 5) =       0.000552376427
  error estimate for blocks of size 2^( 6) =       0.000555094126
  error estimate for blocks of size 2^( 7) =       0.000556131741

      target function =                  N/A
              le_mean =     -22.825367537703
             les_mean =     521.500506688381
             stat err =       0.000552367711
             autocorr =       1.212911307614
              std dev =       0.709298039402
             le_variance =       0.503103708700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503017749546
                                         uncertainty =       0.003771020272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503017749546
                                         uncertainty =       0.003771020272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501534715
  error estimate for blocks of size 2^( 2) =       0.000519322259
  error estimate for blocks of size 2^( 3) =       0.000535429779
  error estimate for blocks of size 2^( 4) =       0.000545850599
  error estimate for blocks of size 2^( 5) =       0.000552355012
  error estimate for blocks of size 2^( 6) =       0.000555083718
  error estimate for blocks of size 2^( 7) =       0.000556136812

      target function =                  N/A
              le_mean =     -22.825364062954
             les_mean =     521.500318494764
             stat err =       0.000552356535
             autocorr =       1.212933513490
              std dev =       0.709277195386
             le_variance =       0.503074139894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502966851252
                                         uncertainty =       0.003770373155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502966851252
                                         uncertainty =       0.003770373155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501509332
  error estimate for blocks of size 2^( 2) =       0.000519298551
  error estimate for blocks of size 2^( 3) =       0.000535407870
  error estimate for blocks of size 2^( 4) =       0.000545828629
  error estimate for blocks of size 2^( 5) =       0.000552334134
  error estimate for blocks of size 2^( 6) =       0.000555062673
  error estimate for blocks of size 2^( 7) =       0.000556117654

      target function =                  N/A
              le_mean =     -22.825363765118
             les_mean =     521.500253978337
             stat err =       0.000552335773
             autocorr =       1.212965102214
              std dev =       0.709241298766
             le_variance =       0.503023219875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503028360982
                                         uncertainty =       0.003768993624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503028360982
                                         uncertainty =       0.003768993624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501540006
  error estimate for blocks of size 2^( 2) =       0.000519326673
  error estimate for blocks of size 2^( 3) =       0.000535436338
  error estimate for blocks of size 2^( 4) =       0.000545859426
  error estimate for blocks of size 2^( 5) =       0.000552366954
  error estimate for blocks of size 2^( 6) =       0.000555086468
  error estimate for blocks of size 2^( 7) =       0.000556127310

      target function =                  N/A
              le_mean =     -22.825366743184
             les_mean =     521.500451464514
             stat err =       0.000552360040
             autocorr =       1.212923310898
              std dev =       0.709284678520
             le_variance =       0.503084755184


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825367537703        initial  <--
     1.4901e-01     1.4901e+00             6.8880e-04       -22.825364062954
     5.9605e-01     5.9605e+00             2.6734e-04       -22.825363765118
     2.3842e+00     2.3842e+01             8.1045e-05       -22.825366743184

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3332
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.685500e-01 1 1  ON 0
 uu_1                 9.447772e-02 1 1  ON 1
 uu_2                -1.673757e-02 1 1  ON 2
 uu_3                -8.207453e-02 1 1  ON 3
 uu_4                -1.195841e-01 1 1  ON 4
 uu_5                -1.420011e-01 1 1  ON 5
 uu_6                -1.546419e-01 1 1  ON 6
 uu_7                -1.568642e-01 1 1  ON 7
 uu_8                -1.456694e-01 1 1  ON 8
 uu_9                -1.136925e-01 1 1  ON 9
 ud_0                 4.404050e-01 1 1  ON 10
 ud_1                 1.578955e-01 1 1  ON 11
 ud_2                 1.218071e-02 1 1  ON 12
 ud_3                -6.757616e-02 1 1  ON 13
 ud_4                -1.147067e-01 1 1  ON 14
 ud_5                -1.442663e-01 1 1  ON 15
 ud_6                -1.619434e-01 1 1  ON 16
 ud_7                -1.674995e-01 1 1  ON 17
 ud_8                -1.574333e-01 1 1  ON 18
 ud_9                -1.286384e-01 1 1  ON 19
 eC_0                -5.634010e-01 1 1  ON 20
 eC_1                -4.092362e-01 1 1  ON 21
 eC_2                -1.604472e-01 1 1  ON 22
 eC_3                -1.550219e-02 1 1  ON 23
 eC_4                 3.079530e-02 1 1  ON 24
 eC_5                 1.158322e-01 1 1  ON 25
 eC_6                 2.333295e-01 1 1  ON 26
 eC_7                 3.962770e-01 1 1  ON 27
 eC_8                 2.885102e-01 1 1  ON 28
 eC_9                 7.701951e-02 1 1  ON 29
 eO_0                -1.245184e+00 1 1  ON 30
 eO_1                -8.667559e-01 1 1  ON 31
 eO_2                -3.869702e-01 1 1  ON 32
 eO_3                -4.178301e-02 1 1  ON 33
 eO_4                 1.870336e-01 1 1  ON 34
 eO_5                 3.719178e-01 1 1  ON 35
 eO_6                 4.631174e-01 1 1  ON 36
 eO_7                 5.237824e-01 1 1  ON 37
 eO_8                 4.814426e-01 1 1  ON 38
 eO_9                 3.350873e-01 1 1  ON 39
eH1_0                -1.849796e-01 1 1  ON 40
eH1_1                -9.802844e-02 1 1  ON 41
eH1_2                -6.495859e-02 1 1  ON 42
eH1_3                -4.915138e-02 1 1  ON 43
eH1_4                 1.206080e-02 1 1  ON 44
eH1_5                 6.912806e-02 1 1  ON 45
eH1_6                 1.262000e-01 1 1  ON 46
eH1_7                 1.021208e-01 1 1  ON 47
eH1_8                 1.071857e-02 1 1  ON 48
eH1_9                -1.823876e-02 1 1  ON 49
eH2_0                -1.874785e-01 1 1  ON 50
eH2_1                -9.926996e-02 1 1  ON 51
eH2_2                -6.613644e-02 1 1  ON 52
eH2_3                -4.987534e-02 1 1  ON 53
eH2_4                 1.121494e-02 1 1  ON 54
eH2_5                 6.837074e-02 1 1  ON 55
eH2_6                 1.246956e-01 1 1  ON 56
eH2_7                 9.938956e-02 1 1  ON 57
eH2_8                 8.349028e-03 1 1  ON 58
eH2_9                -1.268383e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2050e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8969
    reference variance = 0.35011
====================================================
  Execution time = 4.4425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0492e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4996e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504963710603
                                         uncertainty =       0.004792714482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504963710603
                                         uncertainty =       0.004792714482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502453567
  error estimate for blocks of size 2^( 2) =       0.000520251888
  error estimate for blocks of size 2^( 3) =       0.000536078687
  error estimate for blocks of size 2^( 4) =       0.000547461418
  error estimate for blocks of size 2^( 5) =       0.000553474054
  error estimate for blocks of size 2^( 6) =       0.000556254552
  error estimate for blocks of size 2^( 7) =       0.000559643528

      target function =                  N/A
              le_mean =     -22.825104003320
             les_mean =     521.490291683286
             stat err =       0.000554208388
             autocorr =       1.216618235926
              std dev =       0.710576648484
             le_variance =       0.504919173370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282510400332e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825104003320       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825104758124       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825104902570       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825104810642       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825104815517       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825104582809       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825104809664       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825104737782       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825104809595       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825104832063       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+00 is 9.773828e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825104003320       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825104214062       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825104257693       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825104230737       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825104228495       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825104160857       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825104222069       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825104202135       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825104215395       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825104218498       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+00 is 2.711091e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825104003320       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825104057590       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825104069102       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825104062108       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825104061313       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825104043934       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825104059450       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825104054186       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825104057076       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825104057687       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+01 is 7.027589e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9428e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.685430e-01 1 1  ON 0
 uu_1                 9.449185e-02 1 1  ON 1
 uu_2                -1.672926e-02 1 1  ON 2
 uu_3                -8.207425e-02 1 1  ON 3
 uu_4                -1.195730e-01 1 1  ON 4
 uu_5                -1.420040e-01 1 1  ON 5
 uu_6                -1.546674e-01 1 1  ON 6
 uu_7                -1.568371e-01 1 1  ON 7
 uu_8                -1.456759e-01 1 1  ON 8
 uu_9                -1.137012e-01 1 1  ON 9
 ud_0                 4.403988e-01 1 1  ON 10
 ud_1                 1.579134e-01 1 1  ON 11
 ud_2                 1.218834e-02 1 1  ON 12
 ud_3                -6.758272e-02 1 1  ON 13
 ud_4                -1.146948e-01 1 1  ON 14
 ud_5                -1.442712e-01 1 1  ON 15
 ud_6                -1.619371e-01 1 1  ON 16
 ud_7                -1.675008e-01 1 1  ON 17
 ud_8                -1.574298e-01 1 1  ON 18
 ud_9                -1.286408e-01 1 1  ON 19
 eC_0                -5.634159e-01 1 1  ON 20
 eC_1                -4.092487e-01 1 1  ON 21
 eC_2                -1.604485e-01 1 1  ON 22
 eC_3                -1.550070e-02 1 1  ON 23
 eC_4                 3.081470e-02 1 1  ON 24
 eC_5                 1.158342e-01 1 1  ON 25
 eC_6                 2.333115e-01 1 1  ON 26
 eC_7                 3.962765e-01 1 1  ON 27
 eC_8                 2.885256e-01 1 1  ON 28
 eC_9                 7.702723e-02 1 1  ON 29
 eO_0                -1.245201e+00 1 1  ON 30
 eO_1                -8.667538e-01 1 1  ON 31
 eO_2                -3.869962e-01 1 1  ON 32
 eO_3                -4.178738e-02 1 1  ON 33
 eO_4                 1.870295e-01 1 1  ON 34
 eO_5                 3.719313e-01 1 1  ON 35
 eO_6                 4.631345e-01 1 1  ON 36
 eO_7                 5.237764e-01 1 1  ON 37
 eO_8                 4.814416e-01 1 1  ON 38
 eO_9                 3.350994e-01 1 1  ON 39
eH1_0                -1.849893e-01 1 1  ON 40
eH1_1                -9.801070e-02 1 1  ON 41
eH1_2                -6.495389e-02 1 1  ON 42
eH1_3                -4.914794e-02 1 1  ON 43
eH1_4                 1.205082e-02 1 1  ON 44
eH1_5                 6.913945e-02 1 1  ON 45
eH1_6                 1.262055e-01 1 1  ON 46
eH1_7                 1.021008e-01 1 1  ON 47
eH1_8                 1.071208e-02 1 1  ON 48
eH1_9                -1.824194e-02 1 1  ON 49
eH2_0                -1.874926e-01 1 1  ON 50
eH2_1                -9.928050e-02 1 1  ON 51
eH2_2                -6.614051e-02 1 1  ON 52
eH2_3                -4.988610e-02 1 1  ON 53
eH2_4                 1.120449e-02 1 1  ON 54
eH2_5                 6.837015e-02 1 1  ON 55
eH2_6                 1.247209e-01 1 1  ON 56
eH2_7                 9.940817e-02 1 1  ON 57
eH2_8                 8.355846e-03 1 1  ON 58
eH2_9                -1.268897e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.9293
    reference variance = 0.716499
====================================================
  Execution time = 4.3483e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0277e-01
  Total weights = 2.0000e+06
  Execution time = 3.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502792545899
                                         uncertainty =       0.003157877748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502792545899
                                         uncertainty =       0.003157877748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501388091
  error estimate for blocks of size 2^( 2) =       0.000518996139
  error estimate for blocks of size 2^( 3) =       0.000535132353
  error estimate for blocks of size 2^( 4) =       0.000546452218
  error estimate for blocks of size 2^( 5) =       0.000552825043
  error estimate for blocks of size 2^( 6) =       0.000556571659
  error estimate for blocks of size 2^( 7) =       0.000559114981

      target function =                  N/A
              le_mean =     -22.825281004276
             les_mean =     521.496232708967
             stat err =       0.000553740975
             autocorr =       1.219734458195
              std dev =       0.709069838743
             le_variance =       0.502780036215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502769791846
                                         uncertainty =       0.003157219197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502769791846
                                         uncertainty =       0.003157219197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501376776
  error estimate for blocks of size 2^( 2) =       0.000518984644
  error estimate for blocks of size 2^( 3) =       0.000535119457
  error estimate for blocks of size 2^( 4) =       0.000546438876
  error estimate for blocks of size 2^( 5) =       0.000552809931
  error estimate for blocks of size 2^( 6) =       0.000556556627
  error estimate for blocks of size 2^( 7) =       0.000559102192

      target function =                  N/A
              le_mean =     -22.825281911852
             les_mean =     521.496251446903
             stat err =       0.000553726907
             autocorr =       1.219727534330
              std dev =       0.709053836306
             le_variance =       0.502757342780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502773750931
                                         uncertainty =       0.003157460576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502773750931
                                         uncertainty =       0.003157460576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501378738
  error estimate for blocks of size 2^( 2) =       0.000518986795
  error estimate for blocks of size 2^( 3) =       0.000535122298
  error estimate for blocks of size 2^( 4) =       0.000546441987
  error estimate for blocks of size 2^( 5) =       0.000552813943
  error estimate for blocks of size 2^( 6) =       0.000556560690
  error estimate for blocks of size 2^( 7) =       0.000559105404

      target function =                  N/A
              le_mean =     -22.825281559484
             les_mean =     521.496239296419
             stat err =       0.000553730506
             autocorr =       1.219733843778
              std dev =       0.709056611326
             le_variance =       0.502761278065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502789822688
                                         uncertainty =       0.003157821876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502789822688
                                         uncertainty =       0.003157821876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501386736
  error estimate for blocks of size 2^( 2) =       0.000518994790
  error estimate for blocks of size 2^( 3) =       0.000535130916
  error estimate for blocks of size 2^( 4) =       0.000546450762
  error estimate for blocks of size 2^( 5) =       0.000552823481
  error estimate for blocks of size 2^( 6) =       0.000556570118
  error estimate for blocks of size 2^( 7) =       0.000559113625

      target function =                  N/A
              le_mean =     -22.825281075456
             les_mean =     521.496233240094
             stat err =       0.000553739496
             autocorr =       1.219734537750
              std dev =       0.709067921923
             le_variance =       0.502777317900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825281004276        initial
     1.4901e+00     1.4901e+01             9.7738e-05       -22.825281911852  <--
     5.9605e+00     5.9605e+01             2.7111e-05       -22.825281559484
     2.3842e+01     2.3842e+02             7.0276e-06       -22.825281075456

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 6.1315e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.685309e-01 1 1  ON 0
 uu_1                 9.452827e-02 1 1  ON 1
 uu_2                -1.670680e-02 1 1  ON 2
 uu_3                -8.206860e-02 1 1  ON 3
 uu_4                -1.195479e-01 1 1  ON 4
 uu_5                -1.420113e-01 1 1  ON 5
 uu_6                -1.547322e-01 1 1  ON 6
 uu_7                -1.567694e-01 1 1  ON 7
 uu_8                -1.456938e-01 1 1  ON 8
 uu_9                -1.137260e-01 1 1  ON 9
 ud_0                 4.403940e-01 1 1  ON 10
 ud_1                 1.579577e-01 1 1  ON 11
 ud_2                 1.220770e-02 1 1  ON 12
 ud_3                -6.759366e-02 1 1  ON 13
 ud_4                -1.146704e-01 1 1  ON 14
 ud_5                -1.442802e-01 1 1  ON 15
 ud_6                -1.619256e-01 1 1  ON 16
 ud_7                -1.675023e-01 1 1  ON 17
 ud_8                -1.574209e-01 1 1  ON 18
 ud_9                -1.286485e-01 1 1  ON 19
 eC_0                -5.634580e-01 1 1  ON 20
 eC_1                -4.092843e-01 1 1  ON 21
 eC_2                -1.604527e-01 1 1  ON 22
 eC_3                -1.549355e-02 1 1  ON 23
 eC_4                 3.086689e-02 1 1  ON 24
 eC_5                 1.158412e-01 1 1  ON 25
 eC_6                 2.332592e-01 1 1  ON 26
 eC_7                 3.962747e-01 1 1  ON 27
 eC_8                 2.885695e-01 1 1  ON 28
 eC_9                 7.704934e-02 1 1  ON 29
 eO_0                -1.245243e+00 1 1  ON 30
 eO_1                -8.667523e-01 1 1  ON 31
 eO_2                -3.870677e-01 1 1  ON 32
 eO_3                -4.180604e-02 1 1  ON 33
 eO_4                 1.870205e-01 1 1  ON 34
 eO_5                 3.719695e-01 1 1  ON 35
 eO_6                 4.631830e-01 1 1  ON 36
 eO_7                 5.237596e-01 1 1  ON 37
 eO_8                 4.814387e-01 1 1  ON 38
 eO_9                 3.351338e-01 1 1  ON 39
eH1_0                -1.850158e-01 1 1  ON 40
eH1_1                -9.796038e-02 1 1  ON 41
eH1_2                -6.493925e-02 1 1  ON 42
eH1_3                -4.913994e-02 1 1  ON 43
eH1_4                 1.202774e-02 1 1  ON 44
eH1_5                 6.916825e-02 1 1  ON 45
eH1_6                 1.262215e-01 1 1  ON 46
eH1_7                 1.020423e-01 1 1  ON 47
eH1_8                 1.069269e-02 1 1  ON 48
eH1_9                -1.825124e-02 1 1  ON 49
eH2_0                -1.875335e-01 1 1  ON 50
eH2_1                -9.931121e-02 1 1  ON 51
eH2_2                -6.615264e-02 1 1  ON 52
eH2_3                -4.991831e-02 1 1  ON 53
eH2_4                 1.117696e-02 1 1  ON 54
eH2_5                 6.836775e-02 1 1  ON 55
eH2_6                 1.247934e-01 1 1  ON 56
eH2_7                 9.946284e-02 1 1  ON 57
eH2_8                 8.375359e-03 1 1  ON 58
eH2_9                -1.270385e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2075e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8319
    reference variance = 0.409149
====================================================
  Execution time = 4.3787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0868e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4810e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508690993375
                                         uncertainty =       0.004211642870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508690993375
                                         uncertainty =       0.004211642870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504321270
  error estimate for blocks of size 2^( 2) =       0.000522281345
  error estimate for blocks of size 2^( 3) =       0.000537543589
  error estimate for blocks of size 2^( 4) =       0.000548466894
  error estimate for blocks of size 2^( 5) =       0.000554807408
  error estimate for blocks of size 2^( 6) =       0.000556894741
  error estimate for blocks of size 2^( 7) =       0.000557345119

      target function =                  N/A
              le_mean =     -22.825234500214
             les_mean =     521.500009622745
             stat err =       0.000554378540
             autocorr =       1.208365314457
              std dev =       0.713217980245
             le_variance =       0.508679887345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282523450021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825234500214       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825233019144       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825233443318       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825234080457       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825233741354       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825233989649       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825234028812       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825234133715       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825234114206       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825234107775       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825234403600       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825234381775       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e-01 is 3.113429e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825234500214       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825234030284       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825234127084       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825234339925       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825234215673       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825234310944       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825234302518       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825234370077       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825234416235       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825234406311       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+00 is 9.364797e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825234500214       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825234374255       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825234396515       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825234451411       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825234416333       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825234444726       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825234442660       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825234463452       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825234483755       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825234479327       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+00 is 2.570453e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272811 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8605e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.684383e-01 1 1  ON 0
 uu_1                 9.453502e-02 1 1  ON 1
 uu_2                -1.672288e-02 1 1  ON 2
 uu_3                -8.208815e-02 1 1  ON 3
 uu_4                -1.195640e-01 1 1  ON 4
 uu_5                -1.420151e-01 1 1  ON 5
 uu_6                -1.546515e-01 1 1  ON 6
 uu_7                -1.567440e-01 1 1  ON 7
 uu_8                -1.456426e-01 1 1  ON 8
 uu_9                -1.137173e-01 1 1  ON 9
 ud_0                 4.403451e-01 1 1  ON 10
 ud_1                 1.580209e-01 1 1  ON 11
 ud_2                 1.224023e-02 1 1  ON 12
 ud_3                -6.755464e-02 1 1  ON 13
 ud_4                -1.146470e-01 1 1  ON 14
 ud_5                -1.442295e-01 1 1  ON 15
 ud_6                -1.619598e-01 1 1  ON 16
 ud_7                -1.675398e-01 1 1  ON 17
 ud_8                -1.573561e-01 1 1  ON 18
 ud_9                -1.286877e-01 1 1  ON 19
 eC_0                -5.634413e-01 1 1  ON 20
 eC_1                -4.092922e-01 1 1  ON 21
 eC_2                -1.605171e-01 1 1  ON 22
 eC_3                -1.553141e-02 1 1  ON 23
 eC_4                 3.087418e-02 1 1  ON 24
 eC_5                 1.158195e-01 1 1  ON 25
 eC_6                 2.332891e-01 1 1  ON 26
 eC_7                 3.962657e-01 1 1  ON 27
 eC_8                 2.886257e-01 1 1  ON 28
 eC_9                 7.707718e-02 1 1  ON 29
 eO_0                -1.245288e+00 1 1  ON 30
 eO_1                -8.667771e-01 1 1  ON 31
 eO_2                -3.871303e-01 1 1  ON 32
 eO_3                -4.181303e-02 1 1  ON 33
 eO_4                 1.870202e-01 1 1  ON 34
 eO_5                 3.719617e-01 1 1  ON 35
 eO_6                 4.631876e-01 1 1  ON 36
 eO_7                 5.237698e-01 1 1  ON 37
 eO_8                 4.814712e-01 1 1  ON 38
 eO_9                 3.351780e-01 1 1  ON 39
eH1_0                -1.850717e-01 1 1  ON 40
eH1_1                -9.798918e-02 1 1  ON 41
eH1_2                -6.498363e-02 1 1  ON 42
eH1_3                -4.906502e-02 1 1  ON 43
eH1_4                 1.207305e-02 1 1  ON 44
eH1_5                 6.918503e-02 1 1  ON 45
eH1_6                 1.261985e-01 1 1  ON 46
eH1_7                 1.020331e-01 1 1  ON 47
eH1_8                 1.070895e-02 1 1  ON 48
eH1_9                -1.826355e-02 1 1  ON 49
eH2_0                -1.875488e-01 1 1  ON 50
eH2_1                -9.940486e-02 1 1  ON 51
eH2_2                -6.614698e-02 1 1  ON 52
eH2_3                -4.994908e-02 1 1  ON 53
eH2_4                 1.124380e-02 1 1  ON 54
eH2_5                 6.841508e-02 1 1  ON 55
eH2_6                 1.247753e-01 1 1  ON 56
eH2_7                 9.950469e-02 1 1  ON 57
eH2_8                 8.391288e-03 1 1  ON 58
eH2_9                -1.274205e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.9072
    reference variance = 0.658037
====================================================
  Execution time = 4.3794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0262e-01
  Total weights = 2.0000e+06
  Execution time = 3.5435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502823380834
                                         uncertainty =       0.004199080473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502823380834
                                         uncertainty =       0.004199080473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501360257
  error estimate for blocks of size 2^( 2) =       0.000519009376
  error estimate for blocks of size 2^( 3) =       0.000534442810
  error estimate for blocks of size 2^( 4) =       0.000544738597
  error estimate for blocks of size 2^( 5) =       0.000551003356
  error estimate for blocks of size 2^( 6) =       0.000555025532
  error estimate for blocks of size 2^( 7) =       0.000556998750

      target function =                  N/A
              le_mean =     -22.825810992971
             les_mean =     521.520371449127
             stat err =       0.000551941559
             autocorr =       1.211954690704
              std dev =       0.709030474406
             le_variance =       0.502724213636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502603521023
                                         uncertainty =       0.004196751560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502603521023
                                         uncertainty =       0.004196751560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501250640
  error estimate for blocks of size 2^( 2) =       0.000518904270
  error estimate for blocks of size 2^( 3) =       0.000534343146
  error estimate for blocks of size 2^( 4) =       0.000544643812
  error estimate for blocks of size 2^( 5) =       0.000550910357
  error estimate for blocks of size 2^( 6) =       0.000554933348
  error estimate for blocks of size 2^( 7) =       0.000556908604

      target function =                  N/A
              le_mean =     -22.825811759778
             les_mean =     521.520186650131
             stat err =       0.000551849030
             autocorr =       1.212078329915
              std dev =       0.708875453505
             le_variance =       0.502504408582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617704816
                                         uncertainty =       0.004196728837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502617704816
                                         uncertainty =       0.004196728837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501257717
  error estimate for blocks of size 2^( 2) =       0.000518911172
  error estimate for blocks of size 2^( 3) =       0.000534349082
  error estimate for blocks of size 2^( 4) =       0.000544648747
  error estimate for blocks of size 2^( 5) =       0.000550915099
  error estimate for blocks of size 2^( 6) =       0.000554938452
  error estimate for blocks of size 2^( 7) =       0.000556912121

      target function =                  N/A
              le_mean =     -22.825811604126
             les_mean =     521.520193733879
             stat err =       0.000551853605
             autocorr =       1.212064199861
              std dev =       0.708885461886
             le_variance =       0.502518598074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502790668335
                                         uncertainty =       0.004198701580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502790668335
                                         uncertainty =       0.004198701580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501343950
  error estimate for blocks of size 2^( 2) =       0.000518993764
  error estimate for blocks of size 2^( 3) =       0.000534427872
  error estimate for blocks of size 2^( 4) =       0.000544724222
  error estimate for blocks of size 2^( 5) =       0.000550989218
  error estimate for blocks of size 2^( 6) =       0.000555011612
  error estimate for blocks of size 2^( 7) =       0.000556984843

      target function =                  N/A
              le_mean =     -22.825811066329
             les_mean =     521.520342096029
             stat err =       0.000551927474
             autocorr =       1.211971674018
              std dev =       0.709007412947
             le_variance =       0.502691511614


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825810992971        initial
     3.7253e-01     3.7253e+00             3.1134e-04       -22.825811759778  <--
     1.4901e+00     1.4901e+01             9.3648e-05       -22.825811604126
     5.9605e+00     5.9605e+01             2.5705e-05       -22.825811066329

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 6.1592e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.682631e-01 1 1  ON 0
 uu_1                 9.451354e-02 1 1  ON 1
 uu_2                -1.677043e-02 1 1  ON 2
 uu_3                -8.213455e-02 1 1  ON 3
 uu_4                -1.196014e-01 1 1  ON 4
 uu_5                -1.420032e-01 1 1  ON 5
 uu_6                -1.545037e-01 1 1  ON 6
 uu_7                -1.566603e-01 1 1  ON 7
 uu_8                -1.455070e-01 1 1  ON 8
 uu_9                -1.136945e-01 1 1  ON 9
 ud_0                 4.403572e-01 1 1  ON 10
 ud_1                 1.581403e-01 1 1  ON 11
 ud_2                 1.233374e-02 1 1  ON 12
 ud_3                -6.746193e-02 1 1  ON 13
 ud_4                -1.145793e-01 1 1  ON 14
 ud_5                -1.441543e-01 1 1  ON 15
 ud_6                -1.620011e-01 1 1  ON 16
 ud_7                -1.676499e-01 1 1  ON 17
 ud_8                -1.572108e-01 1 1  ON 18
 ud_9                -1.288053e-01 1 1  ON 19
 eC_0                -5.633930e-01 1 1  ON 20
 eC_1                -4.093161e-01 1 1  ON 21
 eC_2                -1.606627e-01 1 1  ON 22
 eC_3                -1.566210e-02 1 1  ON 23
 eC_4                 3.088229e-02 1 1  ON 24
 eC_5                 1.157585e-01 1 1  ON 25
 eC_6                 2.333640e-01 1 1  ON 26
 eC_7                 3.962372e-01 1 1  ON 27
 eC_8                 2.887927e-01 1 1  ON 28
 eC_9                 7.715999e-02 1 1  ON 29
 eO_0                -1.245396e+00 1 1  ON 30
 eO_1                -8.668764e-01 1 1  ON 31
 eO_2                -3.872689e-01 1 1  ON 32
 eO_3                -4.188418e-02 1 1  ON 33
 eO_4                 1.870185e-01 1 1  ON 34
 eO_5                 3.719542e-01 1 1  ON 35
 eO_6                 4.631942e-01 1 1  ON 36
 eO_7                 5.237975e-01 1 1  ON 37
 eO_8                 4.815663e-01 1 1  ON 38
 eO_9                 3.353098e-01 1 1  ON 39
eH1_0                -1.852239e-01 1 1  ON 40
eH1_1                -9.806741e-02 1 1  ON 41
eH1_2                -6.506774e-02 1 1  ON 42
eH1_3                -4.890536e-02 1 1  ON 43
eH1_4                 1.219902e-02 1 1  ON 44
eH1_5                 6.924062e-02 1 1  ON 45
eH1_6                 1.261426e-01 1 1  ON 46
eH1_7                 1.019980e-01 1 1  ON 47
eH1_8                 1.075013e-02 1 1  ON 48
eH1_9                -1.830076e-02 1 1  ON 49
eH2_0                -1.876082e-01 1 1  ON 50
eH2_1                -9.962256e-02 1 1  ON 51
eH2_2                -6.616787e-02 1 1  ON 52
eH2_3                -5.000144e-02 1 1  ON 53
eH2_4                 1.140041e-02 1 1  ON 54
eH2_5                 6.854502e-02 1 1  ON 55
eH2_6                 1.247503e-01 1 1  ON 56
eH2_7                 9.961065e-02 1 1  ON 57
eH2_8                 8.432810e-03 1 1  ON 58
eH2_9                -1.285566e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2020e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.9221
    reference variance = 0.772345
====================================================
  Execution time = 4.3747e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.7081e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4839e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570943159799
                                         uncertainty =       0.054829327533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.570943159799
                                         uncertainty =       0.054829327533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000534231833
  error estimate for blocks of size 2^( 2) =       0.000551097972
  error estimate for blocks of size 2^( 3) =       0.000566173921
  error estimate for blocks of size 2^( 4) =       0.000576882993
  error estimate for blocks of size 2^( 5) =       0.000583345037
  error estimate for blocks of size 2^( 6) =       0.000584495636
  error estimate for blocks of size 2^( 7) =       0.000586487758

      target function =                  N/A
              le_mean =     -22.826205227640
             les_mean =     521.606452112118
             stat err =       0.000582802856
             autocorr =       1.190100992653
              std dev =       0.755517903949
             le_variance =       0.570807303188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282620522764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826205227640       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826205428555       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826206174582       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826205898803       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826206732097       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826207140825       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826206844862       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826205176672       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826205779390       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826206252629       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826206100573       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826206090401       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826206371065       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.826206523360       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.826206502607       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e-02 is 9.512561e-04

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826205227640       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826205327171       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826205692047       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826205603142       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826205976237       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826206375029       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826206473262       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826205787689       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826205990861       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826206107665       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826206077361       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826206107910       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826206155099       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e-01 is 3.821239e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826205227640       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826205260614       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826205384814       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826205362933       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826205470072       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826205629478       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826205754574       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826205695881       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826205621957       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826205632775       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+00 is 1.222363e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8595e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.683055e-01 1 1  ON 0
 uu_1                 9.464009e-02 1 1  ON 1
 uu_2                -1.661029e-02 1 1  ON 2
 uu_3                -8.192710e-02 1 1  ON 3
 uu_4                -1.193934e-01 1 1  ON 4
 uu_5                -1.420087e-01 1 1  ON 5
 uu_6                -1.546937e-01 1 1  ON 6
 uu_7                -1.566992e-01 1 1  ON 7
 uu_8                -1.454362e-01 1 1  ON 8
 uu_9                -1.139527e-01 1 1  ON 9
 ud_0                 4.404990e-01 1 1  ON 10
 ud_1                 1.580977e-01 1 1  ON 11
 ud_2                 1.230627e-02 1 1  ON 12
 ud_3                -6.743000e-02 1 1  ON 13
 ud_4                -1.144752e-01 1 1  ON 14
 ud_5                -1.441473e-01 1 1  ON 15
 ud_6                -1.617676e-01 1 1  ON 16
 ud_7                -1.674193e-01 1 1  ON 17
 ud_8                -1.573937e-01 1 1  ON 18
 ud_9                -1.288861e-01 1 1  ON 19
 eC_0                -5.633386e-01 1 1  ON 20
 eC_1                -4.093806e-01 1 1  ON 21
 eC_2                -1.609548e-01 1 1  ON 22
 eC_3                -1.569482e-02 1 1  ON 23
 eC_4                 3.096385e-02 1 1  ON 24
 eC_5                 1.155851e-01 1 1  ON 25
 eC_6                 2.334247e-01 1 1  ON 26
 eC_7                 3.962472e-01 1 1  ON 27
 eC_8                 2.890226e-01 1 1  ON 28
 eC_9                 7.727157e-02 1 1  ON 29
 eO_0                -1.245477e+00 1 1  ON 30
 eO_1                -8.668259e-01 1 1  ON 31
 eO_2                -3.873898e-01 1 1  ON 32
 eO_3                -4.226630e-02 1 1  ON 33
 eO_4                 1.869956e-01 1 1  ON 34
 eO_5                 3.720775e-01 1 1  ON 35
 eO_6                 4.632604e-01 1 1  ON 36
 eO_7                 5.237978e-01 1 1  ON 37
 eO_8                 4.815594e-01 1 1  ON 38
 eO_9                 3.354867e-01 1 1  ON 39
eH1_0                -1.854769e-01 1 1  ON 40
eH1_1                -9.774000e-02 1 1  ON 41
eH1_2                -6.525160e-02 1 1  ON 42
eH1_3                -4.896460e-02 1 1  ON 43
eH1_4                 1.232240e-02 1 1  ON 44
eH1_5                 6.927641e-02 1 1  ON 45
eH1_6                 1.262274e-01 1 1  ON 46
eH1_7                 1.020238e-01 1 1  ON 47
eH1_8                 1.074369e-02 1 1  ON 48
eH1_9                -1.842659e-02 1 1  ON 49
eH2_0                -1.876226e-01 1 1  ON 50
eH2_1                -9.991230e-02 1 1  ON 51
eH2_2                -6.617660e-02 1 1  ON 52
eH2_3                -5.022773e-02 1 1  ON 53
eH2_4                 1.142836e-02 1 1  ON 54
eH2_5                 6.841912e-02 1 1  ON 55
eH2_6                 1.249321e-01 1 1  ON 56
eH2_7                 9.966118e-02 1 1  ON 57
eH2_8                 8.684503e-03 1 1  ON 58
eH2_9                -1.279806e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.856
    reference variance = 0.36981
====================================================
  Execution time = 4.3470e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0277e-01
  Total weights = 2.0000e+06
  Execution time = 4.1125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502773488728
                                         uncertainty =       0.003769797153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502773488728
                                         uncertainty =       0.003769797153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501332246
  error estimate for blocks of size 2^( 2) =       0.000519408101
  error estimate for blocks of size 2^( 3) =       0.000535340055
  error estimate for blocks of size 2^( 4) =       0.000546854679
  error estimate for blocks of size 2^( 5) =       0.000553190007
  error estimate for blocks of size 2^( 6) =       0.000557081591
  error estimate for blocks of size 2^( 7) =       0.000557169169

      target function =                  N/A
              le_mean =     -22.824856339553
             les_mean =     521.476734712492
             stat err =       0.000553573861
             autocorr =       1.219269951185
              std dev =       0.708990862144
             le_variance =       0.502668042604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502855270888
                                         uncertainty =       0.003776607297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502855270888
                                         uncertainty =       0.003776607297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501372961
  error estimate for blocks of size 2^( 2) =       0.000519447941
  error estimate for blocks of size 2^( 3) =       0.000535379365
  error estimate for blocks of size 2^( 4) =       0.000546894771
  error estimate for blocks of size 2^( 5) =       0.000553237042
  error estimate for blocks of size 2^( 6) =       0.000557135308
  error estimate for blocks of size 2^( 7) =       0.000557213955

      target function =                  N/A
              le_mean =     -22.824853958433
             les_mean =     521.476707663973
             stat err =       0.000553620269
             autocorr =       1.219276341041
              std dev =       0.709048440924
             le_variance =       0.502749691576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502988081233
                                         uncertainty =       0.003780188542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502988081233
                                         uncertainty =       0.003780188542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501439172
  error estimate for blocks of size 2^( 2) =       0.000519510581
  error estimate for blocks of size 2^( 3) =       0.000535439153
  error estimate for blocks of size 2^( 4) =       0.000546952850
  error estimate for blocks of size 2^( 5) =       0.000553297305
  error estimate for blocks of size 2^( 6) =       0.000557193919
  error estimate for blocks of size 2^( 7) =       0.000557273840

      target function =                  N/A
              le_mean =     -22.824852371066
             les_mean =     521.476767995774
             stat err =       0.000553679478
             autocorr =       1.219215117274
              std dev =       0.709142077617
             le_variance =       0.502882486247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502830249951
                                         uncertainty =       0.003771954106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502830249951
                                         uncertainty =       0.003771954106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501360534
  error estimate for blocks of size 2^( 2) =       0.000519434903
  error estimate for blocks of size 2^( 3) =       0.000535365709
  error estimate for blocks of size 2^( 4) =       0.000546879758
  error estimate for blocks of size 2^( 5) =       0.000553217020
  error estimate for blocks of size 2^( 6) =       0.000557109105
  error estimate for blocks of size 2^( 7) =       0.000557195800

      target function =                  N/A
              le_mean =     -22.824855081269
             les_mean =     521.476733999226
             stat err =       0.000553600421
             autocorr =       1.219249356004
              std dev =       0.709030866506
             le_variance =       0.502724769658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824856339553        initial  <--
     9.3132e-02     9.3132e-01             9.5126e-04       -22.824853958433
     3.7253e-01     3.7253e+00             3.8212e-04       -22.824852371066
     1.4901e+00     1.4901e+01             1.2224e-04       -22.824855081269

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8916
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.682631e-01 1 1  ON 0
 uu_1                 9.451354e-02 1 1  ON 1
 uu_2                -1.677043e-02 1 1  ON 2
 uu_3                -8.213455e-02 1 1  ON 3
 uu_4                -1.196014e-01 1 1  ON 4
 uu_5                -1.420032e-01 1 1  ON 5
 uu_6                -1.545037e-01 1 1  ON 6
 uu_7                -1.566603e-01 1 1  ON 7
 uu_8                -1.455070e-01 1 1  ON 8
 uu_9                -1.136945e-01 1 1  ON 9
 ud_0                 4.403572e-01 1 1  ON 10
 ud_1                 1.581403e-01 1 1  ON 11
 ud_2                 1.233374e-02 1 1  ON 12
 ud_3                -6.746193e-02 1 1  ON 13
 ud_4                -1.145793e-01 1 1  ON 14
 ud_5                -1.441543e-01 1 1  ON 15
 ud_6                -1.620011e-01 1 1  ON 16
 ud_7                -1.676499e-01 1 1  ON 17
 ud_8                -1.572108e-01 1 1  ON 18
 ud_9                -1.288053e-01 1 1  ON 19
 eC_0                -5.633930e-01 1 1  ON 20
 eC_1                -4.093161e-01 1 1  ON 21
 eC_2                -1.606627e-01 1 1  ON 22
 eC_3                -1.566210e-02 1 1  ON 23
 eC_4                 3.088229e-02 1 1  ON 24
 eC_5                 1.157585e-01 1 1  ON 25
 eC_6                 2.333640e-01 1 1  ON 26
 eC_7                 3.962372e-01 1 1  ON 27
 eC_8                 2.887927e-01 1 1  ON 28
 eC_9                 7.715999e-02 1 1  ON 29
 eO_0                -1.245396e+00 1 1  ON 30
 eO_1                -8.668764e-01 1 1  ON 31
 eO_2                -3.872689e-01 1 1  ON 32
 eO_3                -4.188418e-02 1 1  ON 33
 eO_4                 1.870185e-01 1 1  ON 34
 eO_5                 3.719542e-01 1 1  ON 35
 eO_6                 4.631942e-01 1 1  ON 36
 eO_7                 5.237975e-01 1 1  ON 37
 eO_8                 4.815663e-01 1 1  ON 38
 eO_9                 3.353098e-01 1 1  ON 39
eH1_0                -1.852239e-01 1 1  ON 40
eH1_1                -9.806741e-02 1 1  ON 41
eH1_2                -6.506774e-02 1 1  ON 42
eH1_3                -4.890536e-02 1 1  ON 43
eH1_4                 1.219902e-02 1 1  ON 44
eH1_5                 6.924062e-02 1 1  ON 45
eH1_6                 1.261426e-01 1 1  ON 46
eH1_7                 1.019980e-01 1 1  ON 47
eH1_8                 1.075013e-02 1 1  ON 48
eH1_9                -1.830076e-02 1 1  ON 49
eH2_0                -1.876082e-01 1 1  ON 50
eH2_1                -9.962256e-02 1 1  ON 51
eH2_2                -6.616787e-02 1 1  ON 52
eH2_3                -5.000144e-02 1 1  ON 53
eH2_4                 1.140041e-02 1 1  ON 54
eH2_5                 6.854502e-02 1 1  ON 55
eH2_6                 1.247503e-01 1 1  ON 56
eH2_7                 9.961065e-02 1 1  ON 57
eH2_8                 8.432810e-03 1 1  ON 58
eH2_9                -1.285566e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2049e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2840e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8485
    reference variance = 0.417665
====================================================
  Execution time = 4.4539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4792e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502386216767
                                         uncertainty =       0.003387132169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502386216767
                                         uncertainty =       0.003387132169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501231671
  error estimate for blocks of size 2^( 2) =       0.000519298786
  error estimate for blocks of size 2^( 3) =       0.000534971665
  error estimate for blocks of size 2^( 4) =       0.000546401255
  error estimate for blocks of size 2^( 5) =       0.000552092130
  error estimate for blocks of size 2^( 6) =       0.000555411263
  error estimate for blocks of size 2^( 7) =       0.000554585224

      target function =                  N/A
              le_mean =     -22.826169283247
             les_mean =     521.536470271527
             stat err =       0.000552122468
             autocorr =       1.213371618348
              std dev =       0.708848626514
             le_variance =       0.502466375311


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282616928325e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826169283247       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826169464817       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826169817264       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826169900905       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826170186717       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826170344932       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826170151074       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826170146986       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826170187191       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826170162656       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826170218166       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e-01 is 1.627685e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826169283247       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826169336314       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826169440005       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826169458090       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826169514709       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826169564182       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826169513193       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826169509768       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826169519026       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826169508789       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826169518608       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+00 is 4.501296e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826169283247       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826169297099       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826169324320       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826169328589       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826169340659       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826169353199       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826169340361       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826169339801       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826169342162       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826169339101       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+01 is 1.161628e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9340e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.682598e-01 1 1  ON 0
 uu_1                 9.452948e-02 1 1  ON 1
 uu_2                -1.676355e-02 1 1  ON 2
 uu_3                -8.212214e-02 1 1  ON 3
 uu_4                -1.195854e-01 1 1  ON 4
 uu_5                -1.419972e-01 1 1  ON 5
 uu_6                -1.545208e-01 1 1  ON 6
 uu_7                -1.566392e-01 1 1  ON 7
 uu_8                -1.455262e-01 1 1  ON 8
 uu_9                -1.137231e-01 1 1  ON 9
 ud_0                 4.403631e-01 1 1  ON 10
 ud_1                 1.581551e-01 1 1  ON 11
 ud_2                 1.237231e-02 1 1  ON 12
 ud_3                -6.746101e-02 1 1  ON 13
 ud_4                -1.145632e-01 1 1  ON 14
 ud_5                -1.441400e-01 1 1  ON 15
 ud_6                -1.619971e-01 1 1  ON 16
 ud_7                -1.676339e-01 1 1  ON 17
 ud_8                -1.572401e-01 1 1  ON 18
 ud_9                -1.288412e-01 1 1  ON 19
 eC_0                -5.633943e-01 1 1  ON 20
 eC_1                -4.093410e-01 1 1  ON 21
 eC_2                -1.606869e-01 1 1  ON 22
 eC_3                -1.565646e-02 1 1  ON 23
 eC_4                 3.092730e-02 1 1  ON 24
 eC_5                 1.157692e-01 1 1  ON 25
 eC_6                 2.333499e-01 1 1  ON 26
 eC_7                 3.962134e-01 1 1  ON 27
 eC_8                 2.888099e-01 1 1  ON 28
 eC_9                 7.716798e-02 1 1  ON 29
 eO_0                -1.245416e+00 1 1  ON 30
 eO_1                -8.669013e-01 1 1  ON 31
 eO_2                -3.872803e-01 1 1  ON 32
 eO_3                -4.186557e-02 1 1  ON 33
 eO_4                 1.870168e-01 1 1  ON 34
 eO_5                 3.719398e-01 1 1  ON 35
 eO_6                 4.631981e-01 1 1  ON 36
 eO_7                 5.238041e-01 1 1  ON 37
 eO_8                 4.815629e-01 1 1  ON 38
 eO_9                 3.353313e-01 1 1  ON 39
eH1_0                -1.852306e-01 1 1  ON 40
eH1_1                -9.807605e-02 1 1  ON 41
eH1_2                -6.507547e-02 1 1  ON 42
eH1_3                -4.889300e-02 1 1  ON 43
eH1_4                 1.220177e-02 1 1  ON 44
eH1_5                 6.928200e-02 1 1  ON 45
eH1_6                 1.261539e-01 1 1  ON 46
eH1_7                 1.019825e-01 1 1  ON 47
eH1_8                 1.074546e-02 1 1  ON 48
eH1_9                -1.832431e-02 1 1  ON 49
eH2_0                -1.876229e-01 1 1  ON 50
eH2_1                -9.961733e-02 1 1  ON 51
eH2_2                -6.617449e-02 1 1  ON 52
eH2_3                -5.000132e-02 1 1  ON 53
eH2_4                 1.136898e-02 1 1  ON 54
eH2_5                 6.855905e-02 1 1  ON 55
eH2_6                 1.247722e-01 1 1  ON 56
eH2_7                 9.964003e-02 1 1  ON 57
eH2_8                 8.433065e-03 1 1  ON 58
eH2_9                -1.287848e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7711
    reference variance = 0.362312
====================================================
  Execution time = 4.3544e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2827e+01
  VMC Evar = 5.1324e-01
  Total weights = 2.0000e+06
  Execution time = 3.5462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513315748238
                                         uncertainty =       0.003972607474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513315748238
                                         uncertainty =       0.003972607474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506592402
  error estimate for blocks of size 2^( 2) =       0.000524534398
  error estimate for blocks of size 2^( 3) =       0.000539722051
  error estimate for blocks of size 2^( 4) =       0.000550428990
  error estimate for blocks of size 2^( 5) =       0.000557793568
  error estimate for blocks of size 2^( 6) =       0.000561407859
  error estimate for blocks of size 2^( 7) =       0.000564711263

      target function =                  N/A
              le_mean =     -22.826784335922
             les_mean =     521.575354585504
             stat err =       0.000558585420
             autocorr =       1.215799184419
              std dev =       0.716429845462
             le_variance =       0.513271723468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513212882178
                                         uncertainty =       0.003972019801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513212882178
                                         uncertainty =       0.003972019801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506541594
  error estimate for blocks of size 2^( 2) =       0.000524485456
  error estimate for blocks of size 2^( 3) =       0.000539673685
  error estimate for blocks of size 2^( 4) =       0.000550381011
  error estimate for blocks of size 2^( 5) =       0.000557747395
  error estimate for blocks of size 2^( 6) =       0.000561359234
  error estimate for blocks of size 2^( 7) =       0.000564665110

      target function =                  N/A
              le_mean =     -22.826784478156
             les_mean =     521.575258129340
             stat err =       0.000558538187
             autocorr =       1.215837451013
              std dev =       0.716357992711
             le_variance =       0.513168773721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513244380776
                                         uncertainty =       0.003972178384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513244380776
                                         uncertainty =       0.003972178384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506557157
  error estimate for blocks of size 2^( 2) =       0.000524500598
  error estimate for blocks of size 2^( 3) =       0.000539688768
  error estimate for blocks of size 2^( 4) =       0.000550396039
  error estimate for blocks of size 2^( 5) =       0.000557761628
  error estimate for blocks of size 2^( 6) =       0.000561374571
  error estimate for blocks of size 2^( 7) =       0.000564679141

      target function =                  N/A
              le_mean =     -22.826784397172
             les_mean =     521.575285965539
             stat err =       0.000558552845
             autocorr =       1.215826553012
              std dev =       0.716380001934
             le_variance =       0.513200307171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513305842191
                                         uncertainty =       0.003972548184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513305842191
                                         uncertainty =       0.003972548184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506587510
  error estimate for blocks of size 2^( 2) =       0.000524529710
  error estimate for blocks of size 2^( 3) =       0.000539717439
  error estimate for blocks of size 2^( 4) =       0.000550424435
  error estimate for blocks of size 2^( 5) =       0.000557789148
  error estimate for blocks of size 2^( 6) =       0.000561403267
  error estimate for blocks of size 2^( 7) =       0.000564706801

      target function =                  N/A
              le_mean =     -22.826784336467
             les_mean =     521.575344697983
             stat err =       0.000558580913
             autocorr =       1.215803043271
              std dev =       0.716422927509
             le_variance =       0.513261811061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826784335922        initial
     9.3132e-01     9.3132e+00             1.6277e-04       -22.826784478156  <--
     3.7253e+00     3.7253e+01             4.5013e-05       -22.826784397172
     1.4901e+01     1.4901e+02             1.1616e-05       -22.826784336467

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 6.1406e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.682605e-01 1 1  ON 0
 uu_1                 9.457010e-02 1 1  ON 1
 uu_2                -1.674013e-02 1 1  ON 2
 uu_3                -8.208632e-02 1 1  ON 3
 uu_4                -1.195471e-01 1 1  ON 4
 uu_5                -1.419791e-01 1 1  ON 5
 uu_6                -1.545570e-01 1 1  ON 6
 uu_7                -1.565918e-01 1 1  ON 7
 uu_8                -1.455803e-01 1 1  ON 8
 uu_9                -1.138060e-01 1 1  ON 9
 ud_0                 4.403920e-01 1 1  ON 10
 ud_1                 1.582080e-01 1 1  ON 11
 ud_2                 1.245841e-02 1 1  ON 12
 ud_3                -6.744066e-02 1 1  ON 13
 ud_4                -1.145262e-01 1 1  ON 14
 ud_5                -1.441009e-01 1 1  ON 15
 ud_6                -1.619843e-01 1 1  ON 16
 ud_7                -1.675921e-01 1 1  ON 17
 ud_8                -1.573224e-01 1 1  ON 18
 ud_9                -1.289458e-01 1 1  ON 19
 eC_0                -5.634016e-01 1 1  ON 20
 eC_1                -4.094112e-01 1 1  ON 21
 eC_2                -1.607466e-01 1 1  ON 22
 eC_3                -1.564184e-02 1 1  ON 23
 eC_4                 3.104506e-02 1 1  ON 24
 eC_5                 1.158076e-01 1 1  ON 25
 eC_6                 2.333097e-01 1 1  ON 26
 eC_7                 3.961438e-01 1 1  ON 27
 eC_8                 2.888585e-01 1 1  ON 28
 eC_9                 7.719067e-02 1 1  ON 29
 eO_0                -1.245467e+00 1 1  ON 30
 eO_1                -8.669747e-01 1 1  ON 31
 eO_2                -3.873104e-01 1 1  ON 32
 eO_3                -4.182381e-02 1 1  ON 33
 eO_4                 1.870183e-01 1 1  ON 34
 eO_5                 3.719031e-01 1 1  ON 35
 eO_6                 4.632048e-01 1 1  ON 36
 eO_7                 5.238224e-01 1 1  ON 37
 eO_8                 4.815528e-01 1 1  ON 38
 eO_9                 3.353924e-01 1 1  ON 39
eH1_0                -1.852530e-01 1 1  ON 40
eH1_1                -9.810064e-02 1 1  ON 41
eH1_2                -6.509291e-02 1 1  ON 42
eH1_3                -4.886006e-02 1 1  ON 43
eH1_4                 1.222201e-02 1 1  ON 44
eH1_5                 6.938319e-02 1 1  ON 45
eH1_6                 1.261914e-01 1 1  ON 46
eH1_7                 1.019407e-01 1 1  ON 47
eH1_8                 1.073102e-02 1 1  ON 48
eH1_9                -1.839228e-02 1 1  ON 49
eH2_0                -1.876647e-01 1 1  ON 50
eH2_1                -9.960852e-02 1 1  ON 51
eH2_2                -6.619245e-02 1 1  ON 52
eH2_3                -5.000398e-02 1 1  ON 53
eH2_4                 1.129736e-02 1 1  ON 54
eH2_5                 6.858758e-02 1 1  ON 55
eH2_6                 1.248327e-01 1 1  ON 56
eH2_7                 9.972784e-02 1 1  ON 57
eH2_8                 8.433985e-03 1 1  ON 58
eH2_9                -1.294423e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2075e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2839e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7791
    reference variance = 0.347556
====================================================
  Execution time = 4.3924e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9909e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5752e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499190487628
                                         uncertainty =       0.002784697727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499190487628
                                         uncertainty =       0.002784697727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499544435
  error estimate for blocks of size 2^( 2) =       0.000517117010
  error estimate for blocks of size 2^( 3) =       0.000532635309
  error estimate for blocks of size 2^( 4) =       0.000543775675
  error estimate for blocks of size 2^( 5) =       0.000550116171
  error estimate for blocks of size 2^( 6) =       0.000553273761
  error estimate for blocks of size 2^( 7) =       0.000555197163

      target function =                  N/A
              le_mean =     -22.825728967110
             les_mean =     521.512991914621
             stat err =       0.000550590692
             autocorr =       1.214813141102
              std dev =       0.706462514349
             le_variance =       0.499089284180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282572896711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825728967110       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825730292564       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825729584501       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825729068434       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825728388160       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825729295442       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825728976117       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825729650326       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825729822915       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825729749643       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825729859991       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825729734636       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825729757740       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825729595357       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e-01 is 5.285745e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825728967110       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825729414563       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825729055008       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825728760768       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825728396924       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825728701484       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825728779259       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825728769539       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825728863272       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825728866686       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e-01 is 1.683241e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825728967110       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825729089711       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825728972099       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825728873223       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825728735875       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825728813669       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825728867203       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825728849237       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825728871866       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825728865967       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+00 is 4.547701e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9684e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.683376e-01 1 1  ON 0
 uu_1                 9.463086e-02 1 1  ON 1
 uu_2                -1.671355e-02 1 1  ON 2
 uu_3                -8.205660e-02 1 1  ON 3
 uu_4                -1.195823e-01 1 1  ON 4
 uu_5                -1.418749e-01 1 1  ON 5
 uu_6                -1.546442e-01 1 1  ON 6
 uu_7                -1.566165e-01 1 1  ON 7
 uu_8                -1.455453e-01 1 1  ON 8
 uu_9                -1.138592e-01 1 1  ON 9
 ud_0                 4.404616e-01 1 1  ON 10
 ud_1                 1.582729e-01 1 1  ON 11
 ud_2                 1.245935e-02 1 1  ON 12
 ud_3                -6.737661e-02 1 1  ON 13
 ud_4                -1.145007e-01 1 1  ON 14
 ud_5                -1.441065e-01 1 1  ON 15
 ud_6                -1.619626e-01 1 1  ON 16
 ud_7                -1.675888e-01 1 1  ON 17
 ud_8                -1.573956e-01 1 1  ON 18
 ud_9                -1.289765e-01 1 1  ON 19
 eC_0                -5.635082e-01 1 1  ON 20
 eC_1                -4.093561e-01 1 1  ON 21
 eC_2                -1.608420e-01 1 1  ON 22
 eC_3                -1.554819e-02 1 1  ON 23
 eC_4                 3.094835e-02 1 1  ON 24
 eC_5                 1.159030e-01 1 1  ON 25
 eC_6                 2.332479e-01 1 1  ON 26
 eC_7                 3.961335e-01 1 1  ON 27
 eC_8                 2.889515e-01 1 1  ON 28
 eC_9                 7.722274e-02 1 1  ON 29
 eO_0                -1.245482e+00 1 1  ON 30
 eO_1                -8.669776e-01 1 1  ON 31
 eO_2                -3.873479e-01 1 1  ON 32
 eO_3                -4.180062e-02 1 1  ON 33
 eO_4                 1.870414e-01 1 1  ON 34
 eO_5                 3.717851e-01 1 1  ON 35
 eO_6                 4.631041e-01 1 1  ON 36
 eO_7                 5.238873e-01 1 1  ON 37
 eO_8                 4.815622e-01 1 1  ON 38
 eO_9                 3.354730e-01 1 1  ON 39
eH1_0                -1.853444e-01 1 1  ON 40
eH1_1                -9.809358e-02 1 1  ON 41
eH1_2                -6.519364e-02 1 1  ON 42
eH1_3                -4.884686e-02 1 1  ON 43
eH1_4                 1.217270e-02 1 1  ON 44
eH1_5                 6.943255e-02 1 1  ON 45
eH1_6                 1.262288e-01 1 1  ON 46
eH1_7                 1.020654e-01 1 1  ON 47
eH1_8                 1.076492e-02 1 1  ON 48
eH1_9                -1.843517e-02 1 1  ON 49
eH2_0                -1.878330e-01 1 1  ON 50
eH2_1                -9.954477e-02 1 1  ON 51
eH2_2                -6.615263e-02 1 1  ON 52
eH2_3                -5.001833e-02 1 1  ON 53
eH2_4                 1.135243e-02 1 1  ON 54
eH2_5                 6.856686e-02 1 1  ON 55
eH2_6                 1.249018e-01 1 1  ON 56
eH2_7                 9.970911e-02 1 1  ON 57
eH2_8                 8.442533e-03 1 1  ON 58
eH2_9                -1.297654e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7376
    reference variance = 0.328572
====================================================
  Execution time = 4.3269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1582e-01
  Total weights = 2.0000e+06
  Execution time = 3.5409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515736341795
                                         uncertainty =       0.013528004271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515736341795
                                         uncertainty =       0.013528004271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507805857
  error estimate for blocks of size 2^( 2) =       0.000525601394
  error estimate for blocks of size 2^( 3) =       0.000541069612
  error estimate for blocks of size 2^( 4) =       0.000551173344
  error estimate for blocks of size 2^( 5) =       0.000555910531
  error estimate for blocks of size 2^( 6) =       0.000559441145
  error estimate for blocks of size 2^( 7) =       0.000561534401

      target function =                  N/A
              le_mean =     -22.825832452790
             les_mean =     521.534360481401
             stat err =       0.000557014855
             autocorr =       1.203200889708
              std dev =       0.718145929742
             le_variance =       0.515733576404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515925474784
                                         uncertainty =       0.013528864414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515925474784
                                         uncertainty =       0.013528864414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507898956
  error estimate for blocks of size 2^( 2) =       0.000525688566
  error estimate for blocks of size 2^( 3) =       0.000541149788
  error estimate for blocks of size 2^( 4) =       0.000551250633
  error estimate for blocks of size 2^( 5) =       0.000555985685
  error estimate for blocks of size 2^( 6) =       0.000559518628
  error estimate for blocks of size 2^( 7) =       0.000561613583

      target function =                  N/A
              le_mean =     -22.825830456240
             les_mean =     521.534458458450
             stat err =       0.000557092132
             autocorr =       1.203093581148
              std dev =       0.718277592164
             le_variance =       0.515922699406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515909447795
                                         uncertainty =       0.013534351263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515909447795
                                         uncertainty =       0.013534351263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507891060
  error estimate for blocks of size 2^( 2) =       0.000525681139
  error estimate for blocks of size 2^( 3) =       0.000541143114
  error estimate for blocks of size 2^( 4) =       0.000551244499
  error estimate for blocks of size 2^( 5) =       0.000555978690
  error estimate for blocks of size 2^( 6) =       0.000559509455
  error estimate for blocks of size 2^( 7) =       0.000561604216

      target function =                  N/A
              le_mean =     -22.825830672651
             les_mean =     521.534452295960
             stat err =       0.000557084215
             autocorr =       1.203096793123
              std dev =       0.718266425065
             le_variance =       0.515906657375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515764682488
                                         uncertainty =       0.013529596415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515764682488
                                         uncertainty =       0.013529596415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507819805
  error estimate for blocks of size 2^( 2) =       0.000525614405
  error estimate for blocks of size 2^( 3) =       0.000541081549
  error estimate for blocks of size 2^( 4) =       0.000551184872
  error estimate for blocks of size 2^( 5) =       0.000555921457
  error estimate for blocks of size 2^( 6) =       0.000559451947
  error estimate for blocks of size 2^( 7) =       0.000561545420

      target function =                  N/A
              le_mean =     -22.825832094247
             les_mean =     521.534372445590
             stat err =       0.000557025924
             autocorr =       1.203182610708
              std dev =       0.718165655483
             le_variance =       0.515761908715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825832452790        initial  <--
     2.3283e-01     2.3283e+00             5.2857e-04       -22.825830456240
     9.3132e-01     9.3132e+00             1.6832e-04       -22.825830672651
     3.7253e+00     3.7253e+01             4.5477e-05       -22.825832094247

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0737
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.682605e-01 1 1  ON 0
 uu_1                 9.457010e-02 1 1  ON 1
 uu_2                -1.674013e-02 1 1  ON 2
 uu_3                -8.208632e-02 1 1  ON 3
 uu_4                -1.195471e-01 1 1  ON 4
 uu_5                -1.419791e-01 1 1  ON 5
 uu_6                -1.545570e-01 1 1  ON 6
 uu_7                -1.565918e-01 1 1  ON 7
 uu_8                -1.455803e-01 1 1  ON 8
 uu_9                -1.138060e-01 1 1  ON 9
 ud_0                 4.403920e-01 1 1  ON 10
 ud_1                 1.582080e-01 1 1  ON 11
 ud_2                 1.245841e-02 1 1  ON 12
 ud_3                -6.744066e-02 1 1  ON 13
 ud_4                -1.145262e-01 1 1  ON 14
 ud_5                -1.441009e-01 1 1  ON 15
 ud_6                -1.619843e-01 1 1  ON 16
 ud_7                -1.675921e-01 1 1  ON 17
 ud_8                -1.573224e-01 1 1  ON 18
 ud_9                -1.289458e-01 1 1  ON 19
 eC_0                -5.634016e-01 1 1  ON 20
 eC_1                -4.094112e-01 1 1  ON 21
 eC_2                -1.607466e-01 1 1  ON 22
 eC_3                -1.564184e-02 1 1  ON 23
 eC_4                 3.104506e-02 1 1  ON 24
 eC_5                 1.158076e-01 1 1  ON 25
 eC_6                 2.333097e-01 1 1  ON 26
 eC_7                 3.961438e-01 1 1  ON 27
 eC_8                 2.888585e-01 1 1  ON 28
 eC_9                 7.719067e-02 1 1  ON 29
 eO_0                -1.245467e+00 1 1  ON 30
 eO_1                -8.669747e-01 1 1  ON 31
 eO_2                -3.873104e-01 1 1  ON 32
 eO_3                -4.182381e-02 1 1  ON 33
 eO_4                 1.870183e-01 1 1  ON 34
 eO_5                 3.719031e-01 1 1  ON 35
 eO_6                 4.632048e-01 1 1  ON 36
 eO_7                 5.238224e-01 1 1  ON 37
 eO_8                 4.815528e-01 1 1  ON 38
 eO_9                 3.353924e-01 1 1  ON 39
eH1_0                -1.852530e-01 1 1  ON 40
eH1_1                -9.810064e-02 1 1  ON 41
eH1_2                -6.509291e-02 1 1  ON 42
eH1_3                -4.886006e-02 1 1  ON 43
eH1_4                 1.222201e-02 1 1  ON 44
eH1_5                 6.938319e-02 1 1  ON 45
eH1_6                 1.261914e-01 1 1  ON 46
eH1_7                 1.019407e-01 1 1  ON 47
eH1_8                 1.073102e-02 1 1  ON 48
eH1_9                -1.839228e-02 1 1  ON 49
eH2_0                -1.876647e-01 1 1  ON 50
eH2_1                -9.960852e-02 1 1  ON 51
eH2_2                -6.619245e-02 1 1  ON 52
eH2_3                -5.000398e-02 1 1  ON 53
eH2_4                 1.129736e-02 1 1  ON 54
eH2_5                 6.858758e-02 1 1  ON 55
eH2_6                 1.248327e-01 1 1  ON 56
eH2_7                 9.972784e-02 1 1  ON 57
eH2_8                 8.433985e-03 1 1  ON 58
eH2_9                -1.294423e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2076e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.878
    reference variance = 0.454244
====================================================
  Execution time = 4.6447e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1486e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4858e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514939655519
                                         uncertainty =       0.011377633137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514939655519
                                         uncertainty =       0.011377633137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507377455
  error estimate for blocks of size 2^( 2) =       0.000525330806
  error estimate for blocks of size 2^( 3) =       0.000541041804
  error estimate for blocks of size 2^( 4) =       0.000552422247
  error estimate for blocks of size 2^( 5) =       0.000559072210
  error estimate for blocks of size 2^( 6) =       0.000563045536
  error estimate for blocks of size 2^( 7) =       0.000563991709

      target function =                  N/A
              le_mean =     -22.825509815349
             les_mean =     521.518761836810
             stat err =       0.000559632926
             autocorr =       1.216589837675
              std dev =       0.717540078093
             le_variance =       0.514863763670


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282550981535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825509815349       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825510005026       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825509949439       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825510050166       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825509878216       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825509902795       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825509947862       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825510004495       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825509966546       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825509958114       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+00 is 7.915879e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825509815349       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825509866366       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825509852272       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825509880763       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825509831570       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825509835518       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825509846633       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825509865560       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825509859543       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825509857724       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+00 is 2.285704e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825509815349       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825509828350       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825509824820       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825509832190       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825509819437       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825509820254       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825509822979       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825509828059       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825509826817       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825509826401       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+01 is 5.952321e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.290931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1313e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.682527e-01 1 1  ON 0
 uu_1                 9.457008e-02 1 1  ON 1
 uu_2                -1.673570e-02 1 1  ON 2
 uu_3                -8.208263e-02 1 1  ON 3
 uu_4                -1.195471e-01 1 1  ON 4
 uu_5                -1.419863e-01 1 1  ON 5
 uu_6                -1.545541e-01 1 1  ON 6
 uu_7                -1.565908e-01 1 1  ON 7
 uu_8                -1.455798e-01 1 1  ON 8
 uu_9                -1.138039e-01 1 1  ON 9
 ud_0                 4.404140e-01 1 1  ON 10
 ud_1                 1.582072e-01 1 1  ON 11
 ud_2                 1.246358e-02 1 1  ON 12
 ud_3                -6.744487e-02 1 1  ON 13
 ud_4                -1.145197e-01 1 1  ON 14
 ud_5                -1.441169e-01 1 1  ON 15
 ud_6                -1.619614e-01 1 1  ON 16
 ud_7                -1.675960e-01 1 1  ON 17
 ud_8                -1.573368e-01 1 1  ON 18
 ud_9                -1.289463e-01 1 1  ON 19
 eC_0                -5.634036e-01 1 1  ON 20
 eC_1                -4.094139e-01 1 1  ON 21
 eC_2                -1.607529e-01 1 1  ON 22
 eC_3                -1.563236e-02 1 1  ON 23
 eC_4                 3.104761e-02 1 1  ON 24
 eC_5                 1.158016e-01 1 1  ON 25
 eC_6                 2.332961e-01 1 1  ON 26
 eC_7                 3.961460e-01 1 1  ON 27
 eC_8                 2.888695e-01 1 1  ON 28
 eC_9                 7.719582e-02 1 1  ON 29
 eO_0                -1.245468e+00 1 1  ON 30
 eO_1                -8.669913e-01 1 1  ON 31
 eO_2                -3.873212e-01 1 1  ON 32
 eO_3                -4.183554e-02 1 1  ON 33
 eO_4                 1.870346e-01 1 1  ON 34
 eO_5                 3.719142e-01 1 1  ON 35
 eO_6                 4.632004e-01 1 1  ON 36
 eO_7                 5.238188e-01 1 1  ON 37
 eO_8                 4.815555e-01 1 1  ON 38
 eO_9                 3.354027e-01 1 1  ON 39
eH1_0                -1.852572e-01 1 1  ON 40
eH1_1                -9.810607e-02 1 1  ON 41
eH1_2                -6.509206e-02 1 1  ON 42
eH1_3                -4.886835e-02 1 1  ON 43
eH1_4                 1.222181e-02 1 1  ON 44
eH1_5                 6.938423e-02 1 1  ON 45
eH1_6                 1.262044e-01 1 1  ON 46
eH1_7                 1.019364e-01 1 1  ON 47
eH1_8                 1.073546e-02 1 1  ON 48
eH1_9                -1.839315e-02 1 1  ON 49
eH2_0                -1.876524e-01 1 1  ON 50
eH2_1                -9.960916e-02 1 1  ON 51
eH2_2                -6.619689e-02 1 1  ON 52
eH2_3                -4.999608e-02 1 1  ON 53
eH2_4                 1.129748e-02 1 1  ON 54
eH2_5                 6.857950e-02 1 1  ON 55
eH2_6                 1.248371e-01 1 1  ON 56
eH2_7                 9.972369e-02 1 1  ON 57
eH2_8                 8.428714e-03 1 1  ON 58
eH2_9                -1.294939e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6868
    reference variance = 0.258697
====================================================
  Execution time = 4.3343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.3251e-01
  Total weights = 2.0000e+06
  Execution time = 3.5469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532342608902
                                         uncertainty =       0.016716151740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532342608902
                                         uncertainty =       0.016716151740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515993093
  error estimate for blocks of size 2^( 2) =       0.000533536218
  error estimate for blocks of size 2^( 3) =       0.000548894270
  error estimate for blocks of size 2^( 4) =       0.000559007971
  error estimate for blocks of size 2^( 5) =       0.000565808092
  error estimate for blocks of size 2^( 6) =       0.000567567014
  error estimate for blocks of size 2^( 7) =       0.000569685941

      target function =                  N/A
              le_mean =     -22.826066453588
             les_mean =     521.561807221839
             stat err =       0.000565517255
             autocorr =       1.201168524971
              std dev =       0.729724430510
             le_variance =       0.532497744483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532396518577
                                         uncertainty =       0.016717459512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532396518577
                                         uncertainty =       0.016717459512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516019242
  error estimate for blocks of size 2^( 2) =       0.000533561150
  error estimate for blocks of size 2^( 3) =       0.000548918115
  error estimate for blocks of size 2^( 4) =       0.000559030449
  error estimate for blocks of size 2^( 5) =       0.000565829940
  error estimate for blocks of size 2^( 6) =       0.000567588888
  error estimate for blocks of size 2^( 7) =       0.000569711870

      target function =                  N/A
              le_mean =     -22.826065545789
             les_mean =     521.561819750201
             stat err =       0.000565540287
             autocorr =       1.201144625811
              std dev =       0.729761410190
             le_variance =       0.532551715803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532374351872
                                         uncertainty =       0.016717034087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532374351872
                                         uncertainty =       0.016717034087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516008491
  error estimate for blocks of size 2^( 2) =       0.000533550915
  error estimate for blocks of size 2^( 3) =       0.000548908362
  error estimate for blocks of size 2^( 4) =       0.000559021267
  error estimate for blocks of size 2^( 5) =       0.000565821040
  error estimate for blocks of size 2^( 6) =       0.000567579965
  error estimate for blocks of size 2^( 7) =       0.000569701258

      target function =                  N/A
              le_mean =     -22.826065901251
             les_mean =     521.561813788484
             stat err =       0.000565530882
             autocorr =       1.201154726428
              std dev =       0.729746206912
             le_variance =       0.532529526502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532346736917
                                         uncertainty =       0.016716270788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.532346736917
                                         uncertainty =       0.016716270788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000515995096
  error estimate for blocks of size 2^( 2) =       0.000533538129
  error estimate for blocks of size 2^( 3) =       0.000548896104
  error estimate for blocks of size 2^( 4) =       0.000559009702
  error estimate for blocks of size 2^( 5) =       0.000565809778
  error estimate for blocks of size 2^( 6) =       0.000567568700
  error estimate for blocks of size 2^( 7) =       0.000569687936

      target function =                  N/A
              le_mean =     -22.826066379527
             les_mean =     521.561807974024
             stat err =       0.000565519029
             autocorr =       1.201166739401
              std dev =       0.729727262550
             le_variance =       0.532501877709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826066453588        initial  <--
     2.3283e+00     2.3283e+01             7.9159e-05       -22.826065545789
     9.3132e+00     9.3132e+01             2.2857e-05       -22.826065901251
     3.7253e+01     3.7253e+02             5.9523e-06       -22.826066379527

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1642
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.682605e-01 1 1  ON 0
 uu_1                 9.457010e-02 1 1  ON 1
 uu_2                -1.674013e-02 1 1  ON 2
 uu_3                -8.208632e-02 1 1  ON 3
 uu_4                -1.195471e-01 1 1  ON 4
 uu_5                -1.419791e-01 1 1  ON 5
 uu_6                -1.545570e-01 1 1  ON 6
 uu_7                -1.565918e-01 1 1  ON 7
 uu_8                -1.455803e-01 1 1  ON 8
 uu_9                -1.138060e-01 1 1  ON 9
 ud_0                 4.403920e-01 1 1  ON 10
 ud_1                 1.582080e-01 1 1  ON 11
 ud_2                 1.245841e-02 1 1  ON 12
 ud_3                -6.744066e-02 1 1  ON 13
 ud_4                -1.145262e-01 1 1  ON 14
 ud_5                -1.441009e-01 1 1  ON 15
 ud_6                -1.619843e-01 1 1  ON 16
 ud_7                -1.675921e-01 1 1  ON 17
 ud_8                -1.573224e-01 1 1  ON 18
 ud_9                -1.289458e-01 1 1  ON 19
 eC_0                -5.634016e-01 1 1  ON 20
 eC_1                -4.094112e-01 1 1  ON 21
 eC_2                -1.607466e-01 1 1  ON 22
 eC_3                -1.564184e-02 1 1  ON 23
 eC_4                 3.104506e-02 1 1  ON 24
 eC_5                 1.158076e-01 1 1  ON 25
 eC_6                 2.333097e-01 1 1  ON 26
 eC_7                 3.961438e-01 1 1  ON 27
 eC_8                 2.888585e-01 1 1  ON 28
 eC_9                 7.719067e-02 1 1  ON 29
 eO_0                -1.245467e+00 1 1  ON 30
 eO_1                -8.669747e-01 1 1  ON 31
 eO_2                -3.873104e-01 1 1  ON 32
 eO_3                -4.182381e-02 1 1  ON 33
 eO_4                 1.870183e-01 1 1  ON 34
 eO_5                 3.719031e-01 1 1  ON 35
 eO_6                 4.632048e-01 1 1  ON 36
 eO_7                 5.238224e-01 1 1  ON 37
 eO_8                 4.815528e-01 1 1  ON 38
 eO_9                 3.353924e-01 1 1  ON 39
eH1_0                -1.852530e-01 1 1  ON 40
eH1_1                -9.810064e-02 1 1  ON 41
eH1_2                -6.509291e-02 1 1  ON 42
eH1_3                -4.886006e-02 1 1  ON 43
eH1_4                 1.222201e-02 1 1  ON 44
eH1_5                 6.938319e-02 1 1  ON 45
eH1_6                 1.261914e-01 1 1  ON 46
eH1_7                 1.019407e-01 1 1  ON 47
eH1_8                 1.073102e-02 1 1  ON 48
eH1_9                -1.839228e-02 1 1  ON 49
eH2_0                -1.876647e-01 1 1  ON 50
eH2_1                -9.960852e-02 1 1  ON 51
eH2_2                -6.619245e-02 1 1  ON 52
eH2_3                -5.000398e-02 1 1  ON 53
eH2_4                 1.129736e-02 1 1  ON 54
eH2_5                 6.858758e-02 1 1  ON 55
eH2_6                 1.248327e-01 1 1  ON 56
eH2_7                 9.972784e-02 1 1  ON 57
eH2_8                 8.433985e-03 1 1  ON 58
eH2_9                -1.294423e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2249e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.902
    reference variance = 0.418594
====================================================
  Execution time = 4.3752e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0362e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4864e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503641452281
                                         uncertainty =       0.005431478098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503641452281
                                         uncertainty =       0.005431478098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501808313
  error estimate for blocks of size 2^( 2) =       0.000519968999
  error estimate for blocks of size 2^( 3) =       0.000535547482
  error estimate for blocks of size 2^( 4) =       0.000546849121
  error estimate for blocks of size 2^( 5) =       0.000552757232
  error estimate for blocks of size 2^( 6) =       0.000556594707
  error estimate for blocks of size 2^( 7) =       0.000557687937

      target function =                  N/A
              le_mean =     -22.825531643901
             les_mean =     521.508517740541
             stat err =       0.000553472249
             autocorr =       1.216510882720
              std dev =       0.709664121709
             le_variance =       0.503623165642


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282553164390e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825531643901       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825531670878       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825531650352       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825531631337       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825531662212       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825531647437       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825531666380       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825531668867       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825531665573       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+01 is 1.288122e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825531643901       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825531650680       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825531645517       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825531640692       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825531648485       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825531644719       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825531649548       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825531650184       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825531649375       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+01 is 3.278703e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825531643901       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825531645598       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825531644305       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825531643094       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825531645047       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825531644101       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825531645314       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825531645473       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825531645273       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+02 is 8.234037e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8623e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.682632e-01 1 1  ON 0
 uu_1                 9.457027e-02 1 1  ON 1
 uu_2                -1.673996e-02 1 1  ON 2
 uu_3                -8.208645e-02 1 1  ON 3
 uu_4                -1.195467e-01 1 1  ON 4
 uu_5                -1.419807e-01 1 1  ON 5
 uu_6                -1.545576e-01 1 1  ON 6
 uu_7                -1.565927e-01 1 1  ON 7
 uu_8                -1.455802e-01 1 1  ON 8
 uu_9                -1.138060e-01 1 1  ON 9
 ud_0                 4.403952e-01 1 1  ON 10
 ud_1                 1.582069e-01 1 1  ON 11
 ud_2                 1.245813e-02 1 1  ON 12
 ud_3                -6.744122e-02 1 1  ON 13
 ud_4                -1.145253e-01 1 1  ON 14
 ud_5                -1.441019e-01 1 1  ON 15
 ud_6                -1.619826e-01 1 1  ON 16
 ud_7                -1.675935e-01 1 1  ON 17
 ud_8                -1.573237e-01 1 1  ON 18
 ud_9                -1.289452e-01 1 1  ON 19
 eC_0                -5.634026e-01 1 1  ON 20
 eC_1                -4.094107e-01 1 1  ON 21
 eC_2                -1.607466e-01 1 1  ON 22
 eC_3                -1.564184e-02 1 1  ON 23
 eC_4                 3.104541e-02 1 1  ON 24
 eC_5                 1.158074e-01 1 1  ON 25
 eC_6                 2.333085e-01 1 1  ON 26
 eC_7                 3.961438e-01 1 1  ON 27
 eC_8                 2.888596e-01 1 1  ON 28
 eC_9                 7.719109e-02 1 1  ON 29
 eO_0                -1.245467e+00 1 1  ON 30
 eO_1                -8.669773e-01 1 1  ON 31
 eO_2                -3.873105e-01 1 1  ON 32
 eO_3                -4.182441e-02 1 1  ON 33
 eO_4                 1.870181e-01 1 1  ON 34
 eO_5                 3.719039e-01 1 1  ON 35
 eO_6                 4.632051e-01 1 1  ON 36
 eO_7                 5.238222e-01 1 1  ON 37
 eO_8                 4.815529e-01 1 1  ON 38
 eO_9                 3.353936e-01 1 1  ON 39
eH1_0                -1.852533e-01 1 1  ON 40
eH1_1                -9.810064e-02 1 1  ON 41
eH1_2                -6.509302e-02 1 1  ON 42
eH1_3                -4.885941e-02 1 1  ON 43
eH1_4                 1.222179e-02 1 1  ON 44
eH1_5                 6.938402e-02 1 1  ON 45
eH1_6                 1.261916e-01 1 1  ON 46
eH1_7                 1.019400e-01 1 1  ON 47
eH1_8                 1.073083e-02 1 1  ON 48
eH1_9                -1.839267e-02 1 1  ON 49
eH2_0                -1.876654e-01 1 1  ON 50
eH2_1                -9.960803e-02 1 1  ON 51
eH2_2                -6.619202e-02 1 1  ON 52
eH2_3                -5.000407e-02 1 1  ON 53
eH2_4                 1.129829e-02 1 1  ON 54
eH2_5                 6.858627e-02 1 1  ON 55
eH2_6                 1.248331e-01 1 1  ON 56
eH2_7                 9.972775e-02 1 1  ON 57
eH2_8                 8.434020e-03 1 1  ON 58
eH2_9                -1.294453e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.82
    reference variance = 0.316278
====================================================
  Execution time = 4.2996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1537e-01
  Total weights = 2.0000e+06
  Execution time = 3.5699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508341233870
                                         uncertainty =       0.003390831461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508341233870
                                         uncertainty =       0.003390831461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507623932
  error estimate for blocks of size 2^( 2) =       0.000524832875
  error estimate for blocks of size 2^( 3) =       0.000540290416
  error estimate for blocks of size 2^( 4) =       0.000550606971
  error estimate for blocks of size 2^( 5) =       0.000553747264
  error estimate for blocks of size 2^( 6) =       0.000556196665
  error estimate for blocks of size 2^( 7) =       0.000558497318

      target function =                  N/A
              le_mean =     -22.825477611818
             les_mean =     521.517792063018
             stat err =       0.000554762054
             autocorr =       1.194343685210
              std dev =       0.717888649518
             le_variance =       0.515364113106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508358822824
                                         uncertainty =       0.003390964154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508358822824
                                         uncertainty =       0.003390964154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507632842
  error estimate for blocks of size 2^( 2) =       0.000524841317
  error estimate for blocks of size 2^( 3) =       0.000540298453
  error estimate for blocks of size 2^( 4) =       0.000550614757
  error estimate for blocks of size 2^( 5) =       0.000553754775
  error estimate for blocks of size 2^( 6) =       0.000556203843
  error estimate for blocks of size 2^( 7) =       0.000558504465

      target function =                  N/A
              le_mean =     -22.825477617163
             les_mean =     521.517810398029
             stat err =       0.000554769460
             autocorr =       1.194333647716
              std dev =       0.717901249570
             le_variance =       0.515382204134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508350167872
                                         uncertainty =       0.003390898868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508350167872
                                         uncertainty =       0.003390898868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507628458
  error estimate for blocks of size 2^( 2) =       0.000524837163
  error estimate for blocks of size 2^( 3) =       0.000540294499
  error estimate for blocks of size 2^( 4) =       0.000550610926
  error estimate for blocks of size 2^( 5) =       0.000553751081
  error estimate for blocks of size 2^( 6) =       0.000556200312
  error estimate for blocks of size 2^( 7) =       0.000558500948

      target function =                  N/A
              le_mean =     -22.825477613880
             les_mean =     521.517801347219
             stat err =       0.000554765817
             autocorr =       1.194338587844
              std dev =       0.717895050240
             le_variance =       0.515373303159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508342354864
                                         uncertainty =       0.003390839920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508342354864
                                         uncertainty =       0.003390839920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507624500
  error estimate for blocks of size 2^( 2) =       0.000524833413
  error estimate for blocks of size 2^( 3) =       0.000540290928
  error estimate for blocks of size 2^( 4) =       0.000550607467
  error estimate for blocks of size 2^( 5) =       0.000553747743
  error estimate for blocks of size 2^( 6) =       0.000556197123
  error estimate for blocks of size 2^( 7) =       0.000558497773

      target function =                  N/A
              le_mean =     -22.825477612038
             les_mean =     521.517793226241
             stat err =       0.000554762527
             autocorr =       1.194343045554
              std dev =       0.717889452679
             le_variance =       0.515365266268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825477611818        initial
     2.3283e+01     2.3283e+02             1.2881e-05       -22.825477617163  <--
     9.3132e+01     9.3132e+02             3.2787e-06       -22.825477613880
     3.7253e+02     3.7253e+03             8.2340e-07       -22.825477612038

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 6.0866e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.682712e-01 1 1  ON 0
 uu_1                 9.457078e-02 1 1  ON 1
 uu_2                -1.673945e-02 1 1  ON 2
 uu_3                -8.208683e-02 1 1  ON 3
 uu_4                -1.195457e-01 1 1  ON 4
 uu_5                -1.419854e-01 1 1  ON 5
 uu_6                -1.545594e-01 1 1  ON 6
 uu_7                -1.565956e-01 1 1  ON 7
 uu_8                -1.455800e-01 1 1  ON 8
 uu_9                -1.138059e-01 1 1  ON 9
 ud_0                 4.404048e-01 1 1  ON 10
 ud_1                 1.582037e-01 1 1  ON 11
 ud_2                 1.245728e-02 1 1  ON 12
 ud_3                -6.744283e-02 1 1  ON 13
 ud_4                -1.145225e-01 1 1  ON 14
 ud_5                -1.441047e-01 1 1  ON 15
 ud_6                -1.619777e-01 1 1  ON 16
 ud_7                -1.675974e-01 1 1  ON 17
 ud_8                -1.573277e-01 1 1  ON 18
 ud_9                -1.289432e-01 1 1  ON 19
 eC_0                -5.634053e-01 1 1  ON 20
 eC_1                -4.094093e-01 1 1  ON 21
 eC_2                -1.607465e-01 1 1  ON 22
 eC_3                -1.564184e-02 1 1  ON 23
 eC_4                 3.104646e-02 1 1  ON 24
 eC_5                 1.158070e-01 1 1  ON 25
 eC_6                 2.333048e-01 1 1  ON 26
 eC_7                 3.961438e-01 1 1  ON 27
 eC_8                 2.888627e-01 1 1  ON 28
 eC_9                 7.719234e-02 1 1  ON 29
 eO_0                -1.245465e+00 1 1  ON 30
 eO_1                -8.669851e-01 1 1  ON 31
 eO_2                -3.873108e-01 1 1  ON 32
 eO_3                -4.182619e-02 1 1  ON 33
 eO_4                 1.870173e-01 1 1  ON 34
 eO_5                 3.719063e-01 1 1  ON 35
 eO_6                 4.632060e-01 1 1  ON 36
 eO_7                 5.238215e-01 1 1  ON 37
 eO_8                 4.815534e-01 1 1  ON 38
 eO_9                 3.353969e-01 1 1  ON 39
eH1_0                -1.852543e-01 1 1  ON 40
eH1_1                -9.810065e-02 1 1  ON 41
eH1_2                -6.509334e-02 1 1  ON 42
eH1_3                -4.885747e-02 1 1  ON 43
eH1_4                 1.222115e-02 1 1  ON 44
eH1_5                 6.938647e-02 1 1  ON 45
eH1_6                 1.261923e-01 1 1  ON 46
eH1_7                 1.019379e-01 1 1  ON 47
eH1_8                 1.073026e-02 1 1  ON 48
eH1_9                -1.839385e-02 1 1  ON 49
eH2_0                -1.876677e-01 1 1  ON 50
eH2_1                -9.960658e-02 1 1  ON 51
eH2_2                -6.619077e-02 1 1  ON 52
eH2_3                -5.000435e-02 1 1  ON 53
eH2_4                 1.130101e-02 1 1  ON 54
eH2_5                 6.858240e-02 1 1  ON 55
eH2_6                 1.248342e-01 1 1  ON 56
eH2_7                 9.972750e-02 1 1  ON 57
eH2_8                 8.434124e-03 1 1  ON 58
eH2_9                -1.294545e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1949e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8915
    reference variance = 0.451297
====================================================
  Execution time = 4.3568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0706e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4796e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506865153464
                                         uncertainty =       0.003531678235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506865153464
                                         uncertainty =       0.003531678235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503519617
  error estimate for blocks of size 2^( 2) =       0.000521227873
  error estimate for blocks of size 2^( 3) =       0.000536329720
  error estimate for blocks of size 2^( 4) =       0.000547590425
  error estimate for blocks of size 2^( 5) =       0.000553498889
  error estimate for blocks of size 2^( 6) =       0.000556032724
  error estimate for blocks of size 2^( 7) =       0.000557282701

      target function =                  N/A
              le_mean =     -22.824939909057
             les_mean =     521.484945608918
             stat err =       0.000553601185
             autocorr =       1.208818869045
              std dev =       0.712084271976
             le_variance =       0.507064010396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282493990906e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824939909057       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824939961314       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824939844393       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824939786617       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824939848838       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824939910228       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824939898240       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824939946259       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824939918578       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824939919136       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+00 is 2.882418e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824939909057       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824939922402       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824939891897       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824939876092       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824939891537       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824939907752       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824939904090       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824939916231       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824939909758       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824939909893       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+01 is 7.466709e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824939909057       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824939912411       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824939904701       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824939900657       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824939904509       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824939908617       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824939907654       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824939910699       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824939909111       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824939909145       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+01 is 1.884160e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8372e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.682703e-01 1 1  ON 0
 uu_1                 9.457012e-02 1 1  ON 1
 uu_2                -1.673982e-02 1 1  ON 2
 uu_3                -8.208766e-02 1 1  ON 3
 uu_4                -1.195444e-01 1 1  ON 4
 uu_5                -1.419884e-01 1 1  ON 5
 uu_6                -1.545585e-01 1 1  ON 6
 uu_7                -1.565982e-01 1 1  ON 7
 uu_8                -1.455789e-01 1 1  ON 8
 uu_9                -1.138044e-01 1 1  ON 9
 ud_0                 4.404119e-01 1 1  ON 10
 ud_1                 1.582025e-01 1 1  ON 11
 ud_2                 1.245217e-02 1 1  ON 12
 ud_3                -6.744111e-02 1 1  ON 13
 ud_4                -1.145221e-01 1 1  ON 14
 ud_5                -1.441062e-01 1 1  ON 15
 ud_6                -1.619774e-01 1 1  ON 16
 ud_7                -1.676017e-01 1 1  ON 17
 ud_8                -1.573267e-01 1 1  ON 18
 ud_9                -1.289409e-01 1 1  ON 19
 eC_0                -5.634110e-01 1 1  ON 20
 eC_1                -4.094088e-01 1 1  ON 21
 eC_2                -1.607452e-01 1 1  ON 22
 eC_3                -1.564482e-02 1 1  ON 23
 eC_4                 3.105014e-02 1 1  ON 24
 eC_5                 1.158050e-01 1 1  ON 25
 eC_6                 2.333043e-01 1 1  ON 26
 eC_7                 3.961418e-01 1 1  ON 27
 eC_8                 2.888670e-01 1 1  ON 28
 eC_9                 7.719512e-02 1 1  ON 29
 eO_0                -1.245467e+00 1 1  ON 30
 eO_1                -8.669880e-01 1 1  ON 31
 eO_2                -3.873097e-01 1 1  ON 32
 eO_3                -4.183366e-02 1 1  ON 33
 eO_4                 1.870189e-01 1 1  ON 34
 eO_5                 3.719059e-01 1 1  ON 35
 eO_6                 4.632042e-01 1 1  ON 36
 eO_7                 5.238223e-01 1 1  ON 37
 eO_8                 4.815555e-01 1 1  ON 38
 eO_9                 3.354009e-01 1 1  ON 39
eH1_0                -1.852545e-01 1 1  ON 40
eH1_1                -9.810222e-02 1 1  ON 41
eH1_2                -6.509304e-02 1 1  ON 42
eH1_3                -4.886221e-02 1 1  ON 43
eH1_4                 1.222400e-02 1 1  ON 44
eH1_5                 6.938857e-02 1 1  ON 45
eH1_6                 1.261942e-01 1 1  ON 46
eH1_7                 1.019378e-01 1 1  ON 47
eH1_8                 1.073182e-02 1 1  ON 48
eH1_9                -1.839708e-02 1 1  ON 49
eH2_0                -1.876637e-01 1 1  ON 50
eH2_1                -9.961128e-02 1 1  ON 51
eH2_2                -6.619388e-02 1 1  ON 52
eH2_3                -5.000511e-02 1 1  ON 53
eH2_4                 1.130107e-02 1 1  ON 54
eH2_5                 6.858255e-02 1 1  ON 55
eH2_6                 1.248353e-01 1 1  ON 56
eH2_7                 9.972943e-02 1 1  ON 57
eH2_8                 8.435333e-03 1 1  ON 58
eH2_9                -1.294719e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7948
    reference variance = 0.311936
====================================================
  Execution time = 4.5312e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0157e-01
  Total weights = 2.0000e+06
  Execution time = 3.5372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501274219870
                                         uncertainty =       0.002799988744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501274219870
                                         uncertainty =       0.002799988744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500776463
  error estimate for blocks of size 2^( 2) =       0.000518516414
  error estimate for blocks of size 2^( 3) =       0.000534885620
  error estimate for blocks of size 2^( 4) =       0.000545840314
  error estimate for blocks of size 2^( 5) =       0.000551256887
  error estimate for blocks of size 2^( 6) =       0.000554993221
  error estimate for blocks of size 2^( 7) =       0.000555757653

      target function =                  N/A
              le_mean =     -22.825948201264
             les_mean =     521.525465167763
             stat err =       0.000551962019
             autocorr =       1.214872137596
              std dev =       0.708204865655
             le_variance =       0.501554131738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501320349540
                                         uncertainty =       0.002800306616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501320349540
                                         uncertainty =       0.002800306616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500799440
  error estimate for blocks of size 2^( 2) =       0.000518537833
  error estimate for blocks of size 2^( 3) =       0.000534906129
  error estimate for blocks of size 2^( 4) =       0.000545860393
  error estimate for blocks of size 2^( 5) =       0.000551276594
  error estimate for blocks of size 2^( 6) =       0.000555014299
  error estimate for blocks of size 2^( 7) =       0.000555777410

      target function =                  N/A
              le_mean =     -22.825947989273
             les_mean =     521.525501516875
             stat err =       0.000551982174
             autocorr =       1.214849377799
              std dev =       0.708237360421
             le_variance =       0.501600158696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501298833110
                                         uncertainty =       0.002800157479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501298833110
                                         uncertainty =       0.002800157479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500788723
  error estimate for blocks of size 2^( 2) =       0.000518527839
  error estimate for blocks of size 2^( 3) =       0.000534896554
  error estimate for blocks of size 2^( 4) =       0.000545851013
  error estimate for blocks of size 2^( 5) =       0.000551267379
  error estimate for blocks of size 2^( 6) =       0.000555004444
  error estimate for blocks of size 2^( 7) =       0.000555768166

      target function =                  N/A
              le_mean =     -22.825948088481
             les_mean =     521.525484576531
             stat err =       0.000551972751
             autocorr =       1.214859896779
              std dev =       0.708222203333
             le_variance =       0.501578689294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501277346994
                                         uncertainty =       0.002800010160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501277346994
                                         uncertainty =       0.002800010160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500778021
  error estimate for blocks of size 2^( 2) =       0.000518517865
  error estimate for blocks of size 2^( 3) =       0.000534887009
  error estimate for blocks of size 2^( 4) =       0.000545841673
  error estimate for blocks of size 2^( 5) =       0.000551258219
  error estimate for blocks of size 2^( 6) =       0.000554994646
  error estimate for blocks of size 2^( 7) =       0.000555758988

      target function =                  N/A
              le_mean =     -22.825948186766
             les_mean =     521.525467625887
             stat err =       0.000551963381
             autocorr =       1.214870578255
              std dev =       0.708207068413
             le_variance =       0.501557251750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825948201264        initial  <--
     5.8208e+00     5.8208e+01             2.8824e-05       -22.825947989273
     2.3283e+01     2.3283e+02             7.4667e-06       -22.825948088481
     9.3132e+01     9.3132e+02             1.8842e-06       -22.825948186766

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.1054
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.682712e-01 1 1  ON 0
 uu_1                 9.457078e-02 1 1  ON 1
 uu_2                -1.673945e-02 1 1  ON 2
 uu_3                -8.208683e-02 1 1  ON 3
 uu_4                -1.195457e-01 1 1  ON 4
 uu_5                -1.419854e-01 1 1  ON 5
 uu_6                -1.545594e-01 1 1  ON 6
 uu_7                -1.565956e-01 1 1  ON 7
 uu_8                -1.455800e-01 1 1  ON 8
 uu_9                -1.138059e-01 1 1  ON 9
 ud_0                 4.404048e-01 1 1  ON 10
 ud_1                 1.582037e-01 1 1  ON 11
 ud_2                 1.245728e-02 1 1  ON 12
 ud_3                -6.744283e-02 1 1  ON 13
 ud_4                -1.145225e-01 1 1  ON 14
 ud_5                -1.441047e-01 1 1  ON 15
 ud_6                -1.619777e-01 1 1  ON 16
 ud_7                -1.675974e-01 1 1  ON 17
 ud_8                -1.573277e-01 1 1  ON 18
 ud_9                -1.289432e-01 1 1  ON 19
 eC_0                -5.634053e-01 1 1  ON 20
 eC_1                -4.094093e-01 1 1  ON 21
 eC_2                -1.607465e-01 1 1  ON 22
 eC_3                -1.564184e-02 1 1  ON 23
 eC_4                 3.104646e-02 1 1  ON 24
 eC_5                 1.158070e-01 1 1  ON 25
 eC_6                 2.333048e-01 1 1  ON 26
 eC_7                 3.961438e-01 1 1  ON 27
 eC_8                 2.888627e-01 1 1  ON 28
 eC_9                 7.719234e-02 1 1  ON 29
 eO_0                -1.245465e+00 1 1  ON 30
 eO_1                -8.669851e-01 1 1  ON 31
 eO_2                -3.873108e-01 1 1  ON 32
 eO_3                -4.182619e-02 1 1  ON 33
 eO_4                 1.870173e-01 1 1  ON 34
 eO_5                 3.719063e-01 1 1  ON 35
 eO_6                 4.632060e-01 1 1  ON 36
 eO_7                 5.238215e-01 1 1  ON 37
 eO_8                 4.815534e-01 1 1  ON 38
 eO_9                 3.353969e-01 1 1  ON 39
eH1_0                -1.852543e-01 1 1  ON 40
eH1_1                -9.810065e-02 1 1  ON 41
eH1_2                -6.509334e-02 1 1  ON 42
eH1_3                -4.885747e-02 1 1  ON 43
eH1_4                 1.222115e-02 1 1  ON 44
eH1_5                 6.938647e-02 1 1  ON 45
eH1_6                 1.261923e-01 1 1  ON 46
eH1_7                 1.019379e-01 1 1  ON 47
eH1_8                 1.073026e-02 1 1  ON 48
eH1_9                -1.839385e-02 1 1  ON 49
eH2_0                -1.876677e-01 1 1  ON 50
eH2_1                -9.960658e-02 1 1  ON 51
eH2_2                -6.619077e-02 1 1  ON 52
eH2_3                -5.000435e-02 1 1  ON 53
eH2_4                 1.130101e-02 1 1  ON 54
eH2_5                 6.858240e-02 1 1  ON 55
eH2_6                 1.248342e-01 1 1  ON 56
eH2_7                 9.972750e-02 1 1  ON 57
eH2_8                 8.434124e-03 1 1  ON 58
eH2_9                -1.294545e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2149e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8362
    reference variance = 0.414236
====================================================
  Execution time = 4.3742e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0373e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4792e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503652656376
                                         uncertainty =       0.009084200413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503652656376
                                         uncertainty =       0.009084200413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501859301
  error estimate for blocks of size 2^( 2) =       0.000519314681
  error estimate for blocks of size 2^( 3) =       0.000535418595
  error estimate for blocks of size 2^( 4) =       0.000546026260
  error estimate for blocks of size 2^( 5) =       0.000552642320
  error estimate for blocks of size 2^( 6) =       0.000555670465
  error estimate for blocks of size 2^( 7) =       0.000557587123

      target function =                  N/A
              le_mean =     -22.825223121815
             les_mean =     521.494535824698
             stat err =       0.000552981542
             autocorr =       1.214107985127
              std dev =       0.709736229814
             le_variance =       0.503725515911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282522312182e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825223121815       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825223106423       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825223104188       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825223101079       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825223097301       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825223096261       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825223104359       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825223104059       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825223104945       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825223105551       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+01 is 3.351610e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825223121815       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825223117955       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825223117390       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825223116605       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825223115641       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825223115386       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825223117420       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825223117343       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825223117563       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825223117719       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+02 is 8.419497e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825223121815       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825223120849       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825223120708       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825223120511       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825223120269       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825223120205       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825223120713       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825223120698       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825223120750       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825223120786       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+02 is 2.107418e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8542e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.682718e-01 1 1  ON 0
 uu_1                 9.457060e-02 1 1  ON 1
 uu_2                -1.673982e-02 1 1  ON 2
 uu_3                -8.208689e-02 1 1  ON 3
 uu_4                -1.195457e-01 1 1  ON 4
 uu_5                -1.419851e-01 1 1  ON 5
 uu_6                -1.545596e-01 1 1  ON 6
 uu_7                -1.565952e-01 1 1  ON 7
 uu_8                -1.455800e-01 1 1  ON 8
 uu_9                -1.138060e-01 1 1  ON 9
 ud_0                 4.404057e-01 1 1  ON 10
 ud_1                 1.582039e-01 1 1  ON 11
 ud_2                 1.245742e-02 1 1  ON 12
 ud_3                -6.744279e-02 1 1  ON 13
 ud_4                -1.145225e-01 1 1  ON 14
 ud_5                -1.441049e-01 1 1  ON 15
 ud_6                -1.619776e-01 1 1  ON 16
 ud_7                -1.675979e-01 1 1  ON 17
 ud_8                -1.573279e-01 1 1  ON 18
 ud_9                -1.289430e-01 1 1  ON 19
 eC_0                -5.634053e-01 1 1  ON 20
 eC_1                -4.094091e-01 1 1  ON 21
 eC_2                -1.607468e-01 1 1  ON 22
 eC_3                -1.564215e-02 1 1  ON 23
 eC_4                 3.104630e-02 1 1  ON 24
 eC_5                 1.158072e-01 1 1  ON 25
 eC_6                 2.333045e-01 1 1  ON 26
 eC_7                 3.961437e-01 1 1  ON 27
 eC_8                 2.888631e-01 1 1  ON 28
 eC_9                 7.719250e-02 1 1  ON 29
 eO_0                -1.245465e+00 1 1  ON 30
 eO_1                -8.669850e-01 1 1  ON 31
 eO_2                -3.873110e-01 1 1  ON 32
 eO_3                -4.182660e-02 1 1  ON 33
 eO_4                 1.870173e-01 1 1  ON 34
 eO_5                 3.719060e-01 1 1  ON 35
 eO_6                 4.632062e-01 1 1  ON 36
 eO_7                 5.238217e-01 1 1  ON 37
 eO_8                 4.815534e-01 1 1  ON 38
 eO_9                 3.353973e-01 1 1  ON 39
eH1_0                -1.852550e-01 1 1  ON 40
eH1_1                -9.810072e-02 1 1  ON 41
eH1_2                -6.509321e-02 1 1  ON 42
eH1_3                -4.885778e-02 1 1  ON 43
eH1_4                 1.222170e-02 1 1  ON 44
eH1_5                 6.938684e-02 1 1  ON 45
eH1_6                 1.261921e-01 1 1  ON 46
eH1_7                 1.019380e-01 1 1  ON 47
eH1_8                 1.073040e-02 1 1  ON 48
eH1_9                -1.839400e-02 1 1  ON 49
eH2_0                -1.876675e-01 1 1  ON 50
eH2_1                -9.960676e-02 1 1  ON 51
eH2_2                -6.619074e-02 1 1  ON 52
eH2_3                -5.000435e-02 1 1  ON 53
eH2_4                 1.130140e-02 1 1  ON 54
eH2_5                 6.858234e-02 1 1  ON 55
eH2_6                 1.248337e-01 1 1  ON 56
eH2_7                 9.972735e-02 1 1  ON 57
eH2_8                 8.434376e-03 1 1  ON 58
eH2_9                -1.294554e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8053
    reference variance = 0.263177
====================================================
  Execution time = 4.3032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1163e-01
  Total weights = 2.0000e+06
  Execution time = 3.5574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511661715901
                                         uncertainty =       0.004322065235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511661715901
                                         uncertainty =       0.004322065235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505779714
  error estimate for blocks of size 2^( 2) =       0.000523794115
  error estimate for blocks of size 2^( 3) =       0.000539563456
  error estimate for blocks of size 2^( 4) =       0.000550403126
  error estimate for blocks of size 2^( 5) =       0.000556570472
  error estimate for blocks of size 2^( 6) =       0.000558682338
  error estimate for blocks of size 2^( 7) =       0.000558609369

      target function =                  N/A
              le_mean =     -22.825659776199
             les_mean =     521.522370201764
             stat err =       0.000556066326
             autocorr =       1.208732999936
              std dev =       0.715280531530
             le_variance =       0.511626238785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511665962527
                                         uncertainty =       0.004322068935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511665962527
                                         uncertainty =       0.004322068935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505781813
  error estimate for blocks of size 2^( 2) =       0.000523796102
  error estimate for blocks of size 2^( 3) =       0.000539565343
  error estimate for blocks of size 2^( 4) =       0.000550404915
  error estimate for blocks of size 2^( 5) =       0.000556572202
  error estimate for blocks of size 2^( 6) =       0.000558684014
  error estimate for blocks of size 2^( 7) =       0.000558611081

      target function =                  N/A
              le_mean =     -22.825659784514
             les_mean =     521.522374827047
             stat err =       0.000556068053
             autocorr =       1.208730476670
              std dev =       0.715283499393
             le_variance =       0.511630484504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511663851320
                                         uncertainty =       0.004322067077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511663851320
                                         uncertainty =       0.004322067077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505780770
  error estimate for blocks of size 2^( 2) =       0.000523795114
  error estimate for blocks of size 2^( 3) =       0.000539564405
  error estimate for blocks of size 2^( 4) =       0.000550404026
  error estimate for blocks of size 2^( 5) =       0.000556571342
  error estimate for blocks of size 2^( 6) =       0.000558683181
  error estimate for blocks of size 2^( 7) =       0.000558610230

      target function =                  N/A
              le_mean =     -22.825659780323
             les_mean =     521.522372524979
             stat err =       0.000556067195
             autocorr =       1.208731731577
              std dev =       0.715282023923
             le_variance =       0.511628373747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511661983202
                                         uncertainty =       0.004322065465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511661983202
                                         uncertainty =       0.004322065465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505779846
  error estimate for blocks of size 2^( 2) =       0.000523794240
  error estimate for blocks of size 2^( 3) =       0.000539563575
  error estimate for blocks of size 2^( 4) =       0.000550403238
  error estimate for blocks of size 2^( 5) =       0.000556570581
  error estimate for blocks of size 2^( 6) =       0.000558682444
  error estimate for blocks of size 2^( 7) =       0.000558609477

      target function =                  N/A
              le_mean =     -22.825659776712
             les_mean =     521.522370492442
             stat err =       0.000556066435
             autocorr =       1.208732841179
              std dev =       0.715280718340
             le_variance =       0.511626506029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825659776199        initial
     5.8208e+01     5.8208e+02             3.3516e-06       -22.825659784514  <--
     2.3283e+02     2.3283e+03             8.4195e-07       -22.825659780323
     9.3132e+02     9.3132e+03             2.1074e-07       -22.825659776712

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 6.0922e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.682735e-01 1 1  ON 0
 uu_1                 9.457006e-02 1 1  ON 1
 uu_2                -1.674093e-02 1 1  ON 2
 uu_3                -8.208707e-02 1 1  ON 3
 uu_4                -1.195458e-01 1 1  ON 4
 uu_5                -1.419841e-01 1 1  ON 5
 uu_6                -1.545603e-01 1 1  ON 6
 uu_7                -1.565943e-01 1 1  ON 7
 uu_8                -1.455800e-01 1 1  ON 8
 uu_9                -1.138062e-01 1 1  ON 9
 ud_0                 4.404082e-01 1 1  ON 10
 ud_1                 1.582044e-01 1 1  ON 11
 ud_2                 1.245784e-02 1 1  ON 12
 ud_3                -6.744268e-02 1 1  ON 13
 ud_4                -1.145225e-01 1 1  ON 14
 ud_5                -1.441052e-01 1 1  ON 15
 ud_6                -1.619776e-01 1 1  ON 16
 ud_7                -1.675994e-01 1 1  ON 17
 ud_8                -1.573282e-01 1 1  ON 18
 ud_9                -1.289425e-01 1 1  ON 19
 eC_0                -5.634052e-01 1 1  ON 20
 eC_1                -4.094086e-01 1 1  ON 21
 eC_2                -1.607477e-01 1 1  ON 22
 eC_3                -1.564308e-02 1 1  ON 23
 eC_4                 3.104585e-02 1 1  ON 24
 eC_5                 1.158080e-01 1 1  ON 25
 eC_6                 2.333037e-01 1 1  ON 26
 eC_7                 3.961437e-01 1 1  ON 27
 eC_8                 2.888643e-01 1 1  ON 28
 eC_9                 7.719300e-02 1 1  ON 29
 eO_0                -1.245466e+00 1 1  ON 30
 eO_1                -8.669848e-01 1 1  ON 31
 eO_2                -3.873116e-01 1 1  ON 32
 eO_3                -4.182782e-02 1 1  ON 33
 eO_4                 1.870175e-01 1 1  ON 34
 eO_5                 3.719050e-01 1 1  ON 35
 eO_6                 4.632066e-01 1 1  ON 36
 eO_7                 5.238224e-01 1 1  ON 37
 eO_8                 4.815533e-01 1 1  ON 38
 eO_9                 3.353984e-01 1 1  ON 39
eH1_0                -1.852570e-01 1 1  ON 40
eH1_1                -9.810092e-02 1 1  ON 41
eH1_2                -6.509282e-02 1 1  ON 42
eH1_3                -4.885871e-02 1 1  ON 43
eH1_4                 1.222331e-02 1 1  ON 44
eH1_5                 6.938793e-02 1 1  ON 45
eH1_6                 1.261916e-01 1 1  ON 46
eH1_7                 1.019386e-01 1 1  ON 47
eH1_8                 1.073083e-02 1 1  ON 48
eH1_9                -1.839445e-02 1 1  ON 49
eH2_0                -1.876671e-01 1 1  ON 50
eH2_1                -9.960730e-02 1 1  ON 51
eH2_2                -6.619066e-02 1 1  ON 52
eH2_3                -5.000434e-02 1 1  ON 53
eH2_4                 1.130259e-02 1 1  ON 54
eH2_5                 6.858218e-02 1 1  ON 55
eH2_6                 1.248324e-01 1 1  ON 56
eH2_7                 9.972692e-02 1 1  ON 57
eH2_8                 8.435130e-03 1 1  ON 58
eH2_9                -1.294581e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1947e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8912
    reference variance = 0.77824
====================================================
  Execution time = 4.4389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0330e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5104e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503343559523
                                         uncertainty =       0.003708564069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503343559523
                                         uncertainty =       0.003708564069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501646081
  error estimate for blocks of size 2^( 2) =       0.000520314334
  error estimate for blocks of size 2^( 3) =       0.000536231427
  error estimate for blocks of size 2^( 4) =       0.000547209325
  error estimate for blocks of size 2^( 5) =       0.000553197083
  error estimate for blocks of size 2^( 6) =       0.000556677904
  error estimate for blocks of size 2^( 7) =       0.000557726679

      target function =                  N/A
              le_mean =     -22.824647735891
             les_mean =     521.467841597370
             stat err =       0.000553702748
             autocorr =       1.218311964634
              std dev =       0.709434691504
             le_variance =       0.503297581509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282464773589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824647735891       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824647729600       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824647711562       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824647702247       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824647722051       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824647698686       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824647671520       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824647661764       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824647673416       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824647679037       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+01 is 1.718198e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824647735891       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824647734290       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824647729719       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824647727395       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824647732775       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824647726842       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824647720104       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824647717456       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824647720152       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824647721520       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+01 is 4.350781e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824647735891       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824647735489       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824647734342       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824647733762       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824647735134       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824647733645       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824647731966       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824647731290       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824647731950       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824647732289       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+02 is 1.091203e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9500e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.682779e-01 1 1  ON 0
 uu_1                 9.457019e-02 1 1  ON 1
 uu_2                -1.674236e-02 1 1  ON 2
 uu_3                -8.208641e-02 1 1  ON 3
 uu_4                -1.195469e-01 1 1  ON 4
 uu_5                -1.419830e-01 1 1  ON 5
 uu_6                -1.545618e-01 1 1  ON 6
 uu_7                -1.565933e-01 1 1  ON 7
 uu_8                -1.455803e-01 1 1  ON 8
 uu_9                -1.138080e-01 1 1  ON 9
 ud_0                 4.404125e-01 1 1  ON 10
 ud_1                 1.582044e-01 1 1  ON 11
 ud_2                 1.245766e-02 1 1  ON 12
 ud_3                -6.744202e-02 1 1  ON 13
 ud_4                -1.145225e-01 1 1  ON 14
 ud_5                -1.441056e-01 1 1  ON 15
 ud_6                -1.619788e-01 1 1  ON 16
 ud_7                -1.675998e-01 1 1  ON 17
 ud_8                -1.573280e-01 1 1  ON 18
 ud_9                -1.289426e-01 1 1  ON 19
 eC_0                -5.634044e-01 1 1  ON 20
 eC_1                -4.094099e-01 1 1  ON 21
 eC_2                -1.607494e-01 1 1  ON 22
 eC_3                -1.564390e-02 1 1  ON 23
 eC_4                 3.104706e-02 1 1  ON 24
 eC_5                 1.158083e-01 1 1  ON 25
 eC_6                 2.333034e-01 1 1  ON 26
 eC_7                 3.961431e-01 1 1  ON 27
 eC_8                 2.888658e-01 1 1  ON 28
 eC_9                 7.719375e-02 1 1  ON 29
 eO_0                -1.245468e+00 1 1  ON 30
 eO_1                -8.669865e-01 1 1  ON 31
 eO_2                -3.873134e-01 1 1  ON 32
 eO_3                -4.182724e-02 1 1  ON 33
 eO_4                 1.870170e-01 1 1  ON 34
 eO_5                 3.719055e-01 1 1  ON 35
 eO_6                 4.632081e-01 1 1  ON 36
 eO_7                 5.238230e-01 1 1  ON 37
 eO_8                 4.815531e-01 1 1  ON 38
 eO_9                 3.353996e-01 1 1  ON 39
eH1_0                -1.852565e-01 1 1  ON 40
eH1_1                -9.810260e-02 1 1  ON 41
eH1_2                -6.509204e-02 1 1  ON 42
eH1_3                -4.885888e-02 1 1  ON 43
eH1_4                 1.222309e-02 1 1  ON 44
eH1_5                 6.938688e-02 1 1  ON 45
eH1_6                 1.261934e-01 1 1  ON 46
eH1_7                 1.019383e-01 1 1  ON 47
eH1_8                 1.073151e-02 1 1  ON 48
eH1_9                -1.839519e-02 1 1  ON 49
eH2_0                -1.876672e-01 1 1  ON 50
eH2_1                -9.960899e-02 1 1  ON 51
eH2_2                -6.618991e-02 1 1  ON 52
eH2_3                -5.000448e-02 1 1  ON 53
eH2_4                 1.130390e-02 1 1  ON 54
eH2_5                 6.858145e-02 1 1  ON 55
eH2_6                 1.248314e-01 1 1  ON 56
eH2_7                 9.972752e-02 1 1  ON 57
eH2_8                 8.435943e-03 1 1  ON 58
eH2_9                -1.294621e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7555
    reference variance = 0.979926
====================================================
  Execution time = 4.4059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0559e-01
  Total weights = 2.0000e+06
  Execution time = 3.5397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505494232142
                                         uncertainty =       0.005069105735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505494232142
                                         uncertainty =       0.005069105735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502783044
  error estimate for blocks of size 2^( 2) =       0.000520437270
  error estimate for blocks of size 2^( 3) =       0.000535653897
  error estimate for blocks of size 2^( 4) =       0.000546699695
  error estimate for blocks of size 2^( 5) =       0.000551463500
  error estimate for blocks of size 2^( 6) =       0.000555474169
  error estimate for blocks of size 2^( 7) =       0.000556716448

      target function =                  N/A
              le_mean =     -22.824148009775
             les_mean =     521.447313697575
             stat err =       0.000552588453
             autocorr =       1.207931662638
              std dev =       0.711042599464
             le_variance =       0.505581578252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505520137787
                                         uncertainty =       0.005069500520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505520137787
                                         uncertainty =       0.005069500520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502795930
  error estimate for blocks of size 2^( 2) =       0.000520449500
  error estimate for blocks of size 2^( 3) =       0.000535665552
  error estimate for blocks of size 2^( 4) =       0.000546711132
  error estimate for blocks of size 2^( 5) =       0.000551474607
  error estimate for blocks of size 2^( 6) =       0.000555485043
  error estimate for blocks of size 2^( 7) =       0.000556726873

      target function =                  N/A
              le_mean =     -22.824148048034
             les_mean =     521.447341360174
             stat err =       0.000552599414
             autocorr =       1.207917665812
              std dev =       0.711060823265
             le_variance =       0.505607494382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505507511251
                                         uncertainty =       0.005069308171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505507511251
                                         uncertainty =       0.005069308171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502789649
  error estimate for blocks of size 2^( 2) =       0.000520443540
  error estimate for blocks of size 2^( 3) =       0.000535659872
  error estimate for blocks of size 2^( 4) =       0.000546705558
  error estimate for blocks of size 2^( 5) =       0.000551469194
  error estimate for blocks of size 2^( 6) =       0.000555479742
  error estimate for blocks of size 2^( 7) =       0.000556721789

      target function =                  N/A
              le_mean =     -22.824148028973
             les_mean =     521.447327858499
             stat err =       0.000552594071
             autocorr =       1.207924484344
              std dev =       0.711051941016
             le_variance =       0.505594862822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505495902284
                                         uncertainty =       0.005069131203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505495902284
                                         uncertainty =       0.005069131203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502783875
  error estimate for blocks of size 2^( 2) =       0.000520438059
  error estimate for blocks of size 2^( 3) =       0.000535654649
  error estimate for blocks of size 2^( 4) =       0.000546700432
  error estimate for blocks of size 2^( 5) =       0.000551464216
  error estimate for blocks of size 2^( 6) =       0.000555474870
  error estimate for blocks of size 2^( 7) =       0.000556717119

      target function =                  N/A
              le_mean =     -22.824148012148
             les_mean =     521.447315476735
             stat err =       0.000552589159
             autocorr =       1.207930759564
              std dev =       0.711043774380
             le_variance =       0.505583249085


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824148009775        initial
     1.4552e+01     1.4552e+02             1.7182e-05       -22.824148048034  <--
     5.8208e+01     5.8208e+02             4.3508e-06       -22.824148028973
     2.3283e+02     2.3283e+03             1.0912e-06       -22.824148012148

*****************************************************************************
Applying the update for shift_i =   1.4552e+01     and shift_s =   1.4552e+02
*****************************************************************************

  Execution time = 6.1852e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.682907e-01 1 1  ON 0
 uu_1                 9.457048e-02 1 1  ON 1
 uu_2                -1.674644e-02 1 1  ON 2
 uu_3                -8.208456e-02 1 1  ON 3
 uu_4                -1.195502e-01 1 1  ON 4
 uu_5                -1.419798e-01 1 1  ON 5
 uu_6                -1.545663e-01 1 1  ON 6
 uu_7                -1.565903e-01 1 1  ON 7
 uu_8                -1.455813e-01 1 1  ON 8
 uu_9                -1.138133e-01 1 1  ON 9
 ud_0                 4.404250e-01 1 1  ON 10
 ud_1                 1.582047e-01 1 1  ON 11
 ud_2                 1.245722e-02 1 1  ON 12
 ud_3                -6.744007e-02 1 1  ON 13
 ud_4                -1.145226e-01 1 1  ON 14
 ud_5                -1.441067e-01 1 1  ON 15
 ud_6                -1.619823e-01 1 1  ON 16
 ud_7                -1.676010e-01 1 1  ON 17
 ud_8                -1.573272e-01 1 1  ON 18
 ud_9                -1.289430e-01 1 1  ON 19
 eC_0                -5.634020e-01 1 1  ON 20
 eC_1                -4.094141e-01 1 1  ON 21
 eC_2                -1.607546e-01 1 1  ON 22
 eC_3                -1.564632e-02 1 1  ON 23
 eC_4                 3.105064e-02 1 1  ON 24
 eC_5                 1.158095e-01 1 1  ON 25
 eC_6                 2.333027e-01 1 1  ON 26
 eC_7                 3.961414e-01 1 1  ON 27
 eC_8                 2.888704e-01 1 1  ON 28
 eC_9                 7.719601e-02 1 1  ON 29
 eO_0                -1.245472e+00 1 1  ON 30
 eO_1                -8.669915e-01 1 1  ON 31
 eO_2                -3.873192e-01 1 1  ON 32
 eO_3                -4.182552e-02 1 1  ON 33
 eO_4                 1.870157e-01 1 1  ON 34
 eO_5                 3.719073e-01 1 1  ON 35
 eO_6                 4.632123e-01 1 1  ON 36
 eO_7                 5.238249e-01 1 1  ON 37
 eO_8                 4.815523e-01 1 1  ON 38
 eO_9                 3.354032e-01 1 1  ON 39
eH1_0                -1.852553e-01 1 1  ON 40
eH1_1                -9.810761e-02 1 1  ON 41
eH1_2                -6.508978e-02 1 1  ON 42
eH1_3                -4.885937e-02 1 1  ON 43
eH1_4                 1.222245e-02 1 1  ON 44
eH1_5                 6.938378e-02 1 1  ON 45
eH1_6                 1.261989e-01 1 1  ON 46
eH1_7                 1.019374e-01 1 1  ON 47
eH1_8                 1.073356e-02 1 1  ON 48
eH1_9                -1.839740e-02 1 1  ON 49
eH2_0                -1.876676e-01 1 1  ON 50
eH2_1                -9.961402e-02 1 1  ON 51
eH2_2                -6.618772e-02 1 1  ON 52
eH2_3                -5.000483e-02 1 1  ON 53
eH2_4                 1.130773e-02 1 1  ON 54
eH2_5                 6.857929e-02 1 1  ON 55
eH2_6                 1.248286e-01 1 1  ON 56
eH2_7                 9.972932e-02 1 1  ON 57
eH2_8                 8.438378e-03 1 1  ON 58
eH2_9                -1.294742e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2136e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8089
    reference variance = 0.544872
====================================================
  Execution time = 4.5935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0126e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5033e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501012277463
                                         uncertainty =       0.002945493950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501012277463
                                         uncertainty =       0.002945493950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500629401
  error estimate for blocks of size 2^( 2) =       0.000518643457
  error estimate for blocks of size 2^( 3) =       0.000534783391
  error estimate for blocks of size 2^( 4) =       0.000545577834
  error estimate for blocks of size 2^( 5) =       0.000552204990
  error estimate for blocks of size 2^( 6) =       0.000557051800
  error estimate for blocks of size 2^( 7) =       0.000559426547

      target function =                  N/A
              le_mean =     -22.825406809318
             les_mean =     521.500455354338
             stat err =       0.000553565293
             autocorr =       1.222658027616
              std dev =       0.707996888499
             le_variance =       0.501259594124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282540680932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825406809318       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825406803756       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825406754616       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825406852207       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825406908903       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825406958471       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825406847676       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825406863503       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825406905787       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+00 is 4.958679e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825406809318       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825406807848       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825406795106       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825406820471       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825406837273       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825406853161       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825406820355       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825406823039       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825406832845       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+01 is 1.281526e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825406809318       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825406808945       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825406805729       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825406812134       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825406816530       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825406820745       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825406812203       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825406812793       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825406815183       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+01 is 3.232258e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0975e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.683022e-01 1 1  ON 0
 uu_1                 9.456935e-02 1 1  ON 1
 uu_2                -1.674455e-02 1 1  ON 2
 uu_3                -8.208693e-02 1 1  ON 3
 uu_4                -1.195478e-01 1 1  ON 4
 uu_5                -1.419839e-01 1 1  ON 5
 uu_6                -1.545694e-01 1 1  ON 6
 uu_7                -1.565964e-01 1 1  ON 7
 uu_8                -1.455737e-01 1 1  ON 8
 uu_9                -1.138120e-01 1 1  ON 9
 ud_0                 4.404346e-01 1 1  ON 10
 ud_1                 1.582077e-01 1 1  ON 11
 ud_2                 1.245666e-02 1 1  ON 12
 ud_3                -6.744116e-02 1 1  ON 13
 ud_4                -1.145233e-01 1 1  ON 14
 ud_5                -1.441083e-01 1 1  ON 15
 ud_6                -1.619769e-01 1 1  ON 16
 ud_7                -1.676021e-01 1 1  ON 17
 ud_8                -1.573302e-01 1 1  ON 18
 ud_9                -1.289420e-01 1 1  ON 19
 eC_0                -5.633995e-01 1 1  ON 20
 eC_1                -4.094269e-01 1 1  ON 21
 eC_2                -1.607513e-01 1 1  ON 22
 eC_3                -1.564789e-02 1 1  ON 23
 eC_4                 3.105230e-02 1 1  ON 24
 eC_5                 1.157981e-01 1 1  ON 25
 eC_6                 2.333082e-01 1 1  ON 26
 eC_7                 3.961451e-01 1 1  ON 27
 eC_8                 2.888768e-01 1 1  ON 28
 eC_9                 7.719837e-02 1 1  ON 29
 eO_0                -1.245476e+00 1 1  ON 30
 eO_1                -8.670026e-01 1 1  ON 31
 eO_2                -3.873216e-01 1 1  ON 32
 eO_3                -4.182469e-02 1 1  ON 33
 eO_4                 1.870221e-01 1 1  ON 34
 eO_5                 3.719123e-01 1 1  ON 35
 eO_6                 4.632052e-01 1 1  ON 36
 eO_7                 5.238258e-01 1 1  ON 37
 eO_8                 4.815543e-01 1 1  ON 38
 eO_9                 3.354086e-01 1 1  ON 39
eH1_0                -1.852575e-01 1 1  ON 40
eH1_1                -9.811377e-02 1 1  ON 41
eH1_2                -6.509243e-02 1 1  ON 42
eH1_3                -4.885862e-02 1 1  ON 43
eH1_4                 1.221916e-02 1 1  ON 44
eH1_5                 6.938229e-02 1 1  ON 45
eH1_6                 1.262022e-01 1 1  ON 46
eH1_7                 1.019428e-01 1 1  ON 47
eH1_8                 1.073828e-02 1 1  ON 48
eH1_9                -1.839736e-02 1 1  ON 49
eH2_0                -1.876614e-01 1 1  ON 50
eH2_1                -9.962111e-02 1 1  ON 51
eH2_2                -6.619152e-02 1 1  ON 52
eH2_3                -5.000146e-02 1 1  ON 53
eH2_4                 1.130081e-02 1 1  ON 54
eH2_5                 6.858438e-02 1 1  ON 55
eH2_6                 1.248227e-01 1 1  ON 56
eH2_7                 9.973182e-02 1 1  ON 57
eH2_8                 8.443915e-03 1 1  ON 58
eH2_9                -1.294868e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8494
    reference variance = 0.480894
====================================================
  Execution time = 4.3628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1338e-01
  Total weights = 2.0000e+06
  Execution time = 3.5504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513341499847
                                         uncertainty =       0.008489555585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513341499847
                                         uncertainty =       0.008489555585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506636178
  error estimate for blocks of size 2^( 2) =       0.000524675810
  error estimate for blocks of size 2^( 3) =       0.000540741357
  error estimate for blocks of size 2^( 4) =       0.000551410337
  error estimate for blocks of size 2^( 5) =       0.000556795710
  error estimate for blocks of size 2^( 6) =       0.000560229688
  error estimate for blocks of size 2^( 7) =       0.000560085855

      target function =                  N/A
              le_mean =     -22.825470120723
             les_mean =     521.515446408597
             stat err =       0.000557130398
             autocorr =       1.209264523562
              std dev =       0.716491753808
             le_variance =       0.513360433275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513398349946
                                         uncertainty =       0.008490400587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513398349946
                                         uncertainty =       0.008490400587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506664239
  error estimate for blocks of size 2^( 2) =       0.000524702607
  error estimate for blocks of size 2^( 3) =       0.000540766363
  error estimate for blocks of size 2^( 4) =       0.000551434536
  error estimate for blocks of size 2^( 5) =       0.000556818380
  error estimate for blocks of size 2^( 6) =       0.000560251615
  error estimate for blocks of size 2^( 7) =       0.000560107317

      target function =                  N/A
              le_mean =     -22.825470189350
             les_mean =     521.515506409753
             stat err =       0.000557152962
             autocorr =       1.209228524046
              std dev =       0.716531437938
             le_variance =       0.513417301554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513371956681
                                         uncertainty =       0.008489997751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513371956681
                                         uncertainty =       0.008489997751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506651211
  error estimate for blocks of size 2^( 2) =       0.000524690157
  error estimate for blocks of size 2^( 3) =       0.000540754747
  error estimate for blocks of size 2^( 4) =       0.000551423292
  error estimate for blocks of size 2^( 5) =       0.000556807833
  error estimate for blocks of size 2^( 6) =       0.000560241408
  error estimate for blocks of size 2^( 7) =       0.000560097347

      target function =                  N/A
              le_mean =     -22.825470156749
             les_mean =     521.515478520153
             stat err =       0.000557142470
             autocorr =       1.209245165722
              std dev =       0.716513014696
             le_variance =       0.513390900229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513345373358
                                         uncertainty =       0.008489611423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513345373358
                                         uncertainty =       0.008489611423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506638090
  error estimate for blocks of size 2^( 2) =       0.000524677634
  error estimate for blocks of size 2^( 3) =       0.000540743059
  error estimate for blocks of size 2^( 4) =       0.000551411984
  error estimate for blocks of size 2^( 5) =       0.000556797251
  error estimate for blocks of size 2^( 6) =       0.000560231177
  error estimate for blocks of size 2^( 7) =       0.000560087316

      target function =                  N/A
              le_mean =     -22.825470125075
             les_mean =     521.515450482112
             stat err =       0.000557131932
             autocorr =       1.209262057244
              std dev =       0.716494457820
             le_variance =       0.513364308087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825470120723        initial
     3.6380e+00     3.6380e+01             4.9587e-05       -22.825470189350  <--
     1.4552e+01     1.4552e+02             1.2815e-05       -22.825470156749
     5.8208e+01     5.8208e+02             3.2323e-06       -22.825470125075

*****************************************************************************
Applying the update for shift_i =   3.6380e+00     and shift_s =   3.6380e+01
*****************************************************************************

  Execution time = 6.1505e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.683343e-01 1 1  ON 0
 uu_1                 9.456679e-02 1 1  ON 1
 uu_2                -1.673946e-02 1 1  ON 2
 uu_3                -8.209292e-02 1 1  ON 3
 uu_4                -1.195417e-01 1 1  ON 4
 uu_5                -1.419952e-01 1 1  ON 5
 uu_6                -1.545783e-01 1 1  ON 6
 uu_7                -1.566142e-01 1 1  ON 7
 uu_8                -1.455517e-01 1 1  ON 8
 uu_9                -1.138077e-01 1 1  ON 9
 ud_0                 4.404608e-01 1 1  ON 10
 ud_1                 1.582163e-01 1 1  ON 11
 ud_2                 1.245578e-02 1 1  ON 12
 ud_3                -6.744408e-02 1 1  ON 13
 ud_4                -1.145256e-01 1 1  ON 14
 ud_5                -1.441123e-01 1 1  ON 15
 ud_6                -1.619623e-01 1 1  ON 16
 ud_7                -1.676047e-01 1 1  ON 17
 ud_8                -1.573388e-01 1 1  ON 18
 ud_9                -1.289390e-01 1 1  ON 19
 eC_0                -5.633927e-01 1 1  ON 20
 eC_1                -4.094637e-01 1 1  ON 21
 eC_2                -1.607424e-01 1 1  ON 22
 eC_3                -1.565209e-02 1 1  ON 23
 eC_4                 3.105703e-02 1 1  ON 24
 eC_5                 1.157647e-01 1 1  ON 25
 eC_6                 2.333245e-01 1 1  ON 26
 eC_7                 3.961558e-01 1 1  ON 27
 eC_8                 2.888957e-01 1 1  ON 28
 eC_9                 7.720529e-02 1 1  ON 29
 eO_0                -1.245489e+00 1 1  ON 30
 eO_1                -8.670343e-01 1 1  ON 31
 eO_2                -3.873294e-01 1 1  ON 32
 eO_3                -4.182170e-02 1 1  ON 33
 eO_4                 1.870406e-01 1 1  ON 34
 eO_5                 3.719270e-01 1 1  ON 35
 eO_6                 4.631840e-01 1 1  ON 36
 eO_7                 5.238283e-01 1 1  ON 37
 eO_8                 4.815603e-01 1 1  ON 38
 eO_9                 3.354242e-01 1 1  ON 39
eH1_0                -1.852643e-01 1 1  ON 40
eH1_1                -9.813173e-02 1 1  ON 41
eH1_2                -6.510060e-02 1 1  ON 42
eH1_3                -4.885661e-02 1 1  ON 43
eH1_4                 1.220928e-02 1 1  ON 44
eH1_5                 6.937838e-02 1 1  ON 45
eH1_6                 1.262117e-01 1 1  ON 46
eH1_7                 1.019591e-01 1 1  ON 47
eH1_8                 1.075227e-02 1 1  ON 48
eH1_9                -1.839718e-02 1 1  ON 49
eH2_0                -1.876437e-01 1 1  ON 50
eH2_1                -9.964149e-02 1 1  ON 51
eH2_2                -6.620272e-02 1 1  ON 52
eH2_3                -4.999206e-02 1 1  ON 53
eH2_4                 1.128153e-02 1 1  ON 54
eH2_5                 6.859825e-02 1 1  ON 55
eH2_6                 1.248058e-01 1 1  ON 56
eH2_7                 9.973915e-02 1 1  ON 57
eH2_8                 8.460229e-03 1 1  ON 58
eH2_9                -1.295234e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2249e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8199
    reference variance = 0.391019
====================================================
  Execution time = 4.3800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0344e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5012e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503588264705
                                         uncertainty =       0.004076242029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503588264705
                                         uncertainty =       0.004076242029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501717832
  error estimate for blocks of size 2^( 2) =       0.000519416806
  error estimate for blocks of size 2^( 3) =       0.000534999601
  error estimate for blocks of size 2^( 4) =       0.000546111110
  error estimate for blocks of size 2^( 5) =       0.000553724373
  error estimate for blocks of size 2^( 6) =       0.000557450786
  error estimate for blocks of size 2^( 7) =       0.000564364801

      target function =                  N/A
              le_mean =     -22.826267062639
             les_mean =     521.541909328965
             stat err =       0.000555412768
             autocorr =       1.225498104928
              std dev =       0.709536162415
             le_variance =       0.503441565774


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282626706264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826267062639       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826267841738       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826268631465       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826268173819       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826268390886       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826268430487       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826268464925       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826268554207       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826268502334       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826268532660       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826268495159       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e-01 is 1.704778e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826267062639       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826267286398       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826267544769       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826267448862       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826267571359       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826267578587       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826267570215       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826267571499       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826267570883       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826267571396       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+00 is 5.037357e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826267062639       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826267120740       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826267190430       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826267168982       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826267207557       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826267208907       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826267207296       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826267206303       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826267205874       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826267204947       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+01 is 1.313386e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8820e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.683269e-01 1 1  ON 0
 uu_1                 9.455465e-02 1 1  ON 1
 uu_2                -1.674069e-02 1 1  ON 2
 uu_3                -8.210530e-02 1 1  ON 3
 uu_4                -1.195066e-01 1 1  ON 4
 uu_5                -1.419751e-01 1 1  ON 5
 uu_6                -1.545737e-01 1 1  ON 6
 uu_7                -1.566066e-01 1 1  ON 7
 uu_8                -1.455358e-01 1 1  ON 8
 uu_9                -1.138250e-01 1 1  ON 9
 ud_0                 4.404622e-01 1 1  ON 10
 ud_1                 1.582231e-01 1 1  ON 11
 ud_2                 1.247588e-02 1 1  ON 12
 ud_3                -6.742472e-02 1 1  ON 13
 ud_4                -1.145035e-01 1 1  ON 14
 ud_5                -1.441209e-01 1 1  ON 15
 ud_6                -1.619637e-01 1 1  ON 16
 ud_7                -1.676055e-01 1 1  ON 17
 ud_8                -1.573601e-01 1 1  ON 18
 ud_9                -1.289355e-01 1 1  ON 19
 eC_0                -5.633962e-01 1 1  ON 20
 eC_1                -4.094477e-01 1 1  ON 21
 eC_2                -1.607676e-01 1 1  ON 22
 eC_3                -1.565349e-02 1 1  ON 23
 eC_4                 3.104153e-02 1 1  ON 24
 eC_5                 1.157666e-01 1 1  ON 25
 eC_6                 2.333179e-01 1 1  ON 26
 eC_7                 3.961525e-01 1 1  ON 27
 eC_8                 2.889212e-01 1 1  ON 28
 eC_9                 7.721727e-02 1 1  ON 29
 eO_0                -1.245486e+00 1 1  ON 30
 eO_1                -8.670215e-01 1 1  ON 31
 eO_2                -3.873657e-01 1 1  ON 32
 eO_3                -4.185927e-02 1 1  ON 33
 eO_4                 1.870248e-01 1 1  ON 34
 eO_5                 3.719267e-01 1 1  ON 35
 eO_6                 4.632058e-01 1 1  ON 36
 eO_7                 5.238360e-01 1 1  ON 37
 eO_8                 4.815660e-01 1 1  ON 38
 eO_9                 3.354432e-01 1 1  ON 39
eH1_0                -1.852755e-01 1 1  ON 40
eH1_1                -9.816893e-02 1 1  ON 41
eH1_2                -6.511876e-02 1 1  ON 42
eH1_3                -4.886840e-02 1 1  ON 43
eH1_4                 1.221270e-02 1 1  ON 44
eH1_5                 6.942876e-02 1 1  ON 45
eH1_6                 1.261921e-01 1 1  ON 46
eH1_7                 1.019781e-01 1 1  ON 47
eH1_8                 1.077594e-02 1 1  ON 48
eH1_9                -1.840061e-02 1 1  ON 49
eH2_0                -1.876387e-01 1 1  ON 50
eH2_1                -9.962916e-02 1 1  ON 51
eH2_2                -6.619251e-02 1 1  ON 52
eH2_3                -4.998373e-02 1 1  ON 53
eH2_4                 1.128212e-02 1 1  ON 54
eH2_5                 6.860293e-02 1 1  ON 55
eH2_6                 1.247967e-01 1 1  ON 56
eH2_7                 9.971929e-02 1 1  ON 57
eH2_8                 8.449806e-03 1 1  ON 58
eH2_9                -1.296404e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.807
    reference variance = 0.3515
====================================================
  Execution time = 4.3473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0661e-01
  Total weights = 2.0000e+06
  Execution time = 3.5510e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506645594970
                                         uncertainty =       0.005275398068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506645594970
                                         uncertainty =       0.005275398068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503309695
  error estimate for blocks of size 2^( 2) =       0.000520491881
  error estimate for blocks of size 2^( 3) =       0.000536072174
  error estimate for blocks of size 2^( 4) =       0.000547287192
  error estimate for blocks of size 2^( 5) =       0.000553906251
  error estimate for blocks of size 2^( 6) =       0.000557386812
  error estimate for blocks of size 2^( 7) =       0.000559449883

      target function =                  N/A
              le_mean =     -22.825130626126
             les_mean =     521.493229143714
             stat err =       0.000554507535
             autocorr =       1.213792115102
              std dev =       0.711787396143
             le_variance =       0.506641297307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506529696047
                                         uncertainty =       0.005275438771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506529696047
                                         uncertainty =       0.005275438771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503252164
  error estimate for blocks of size 2^( 2) =       0.000520436732
  error estimate for blocks of size 2^( 3) =       0.000536021775
  error estimate for blocks of size 2^( 4) =       0.000547241258
  error estimate for blocks of size 2^( 5) =       0.000553863645
  error estimate for blocks of size 2^( 6) =       0.000557345994
  error estimate for blocks of size 2^( 7) =       0.000559418974

      target function =                  N/A
              le_mean =     -22.825130616482
             les_mean =     521.493112886719
             stat err =       0.000554467468
             autocorr =       1.213894205693
              std dev =       0.711706035168
             le_variance =       0.506525480495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506577915973
                                         uncertainty =       0.005275257462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506577915973
                                         uncertainty =       0.005275257462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503276107
  error estimate for blocks of size 2^( 2) =       0.000520459593
  error estimate for blocks of size 2^( 3) =       0.000536042588
  error estimate for blocks of size 2^( 4) =       0.000547260246
  error estimate for blocks of size 2^( 5) =       0.000553881571
  error estimate for blocks of size 2^( 6) =       0.000557363297
  error estimate for blocks of size 2^( 7) =       0.000559432821

      target function =                  N/A
              le_mean =     -22.825130522448
             les_mean =     521.493156792278
             stat err =       0.000554484484
             autocorr =       1.213853209476
              std dev =       0.711739895450
             le_variance =       0.506573678775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506636676526
                                         uncertainty =       0.005275374386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506636676526
                                         uncertainty =       0.005275374386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503305269
  error estimate for blocks of size 2^( 2) =       0.000520487619
  error estimate for blocks of size 2^( 3) =       0.000536068260
  error estimate for blocks of size 2^( 4) =       0.000547283628
  error estimate for blocks of size 2^( 5) =       0.000553903006
  error estimate for blocks of size 2^( 6) =       0.000557383712
  error estimate for blocks of size 2^( 7) =       0.000559447658

      target function =                  N/A
              le_mean =     -22.825130601610
             les_mean =     521.493219114385
             stat err =       0.000554504501
             autocorr =       1.213800182187
              std dev =       0.711781137127
             le_variance =       0.506632387169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825130626126        initial  <--
     9.0949e-01     9.0949e+00             1.7048e-04       -22.825130616482
     3.6380e+00     3.6380e+01             5.0374e-05       -22.825130522448
     1.4552e+01     1.4552e+02             1.3134e-05       -22.825130601610

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.3167
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.683343e-01 1 1  ON 0
 uu_1                 9.456679e-02 1 1  ON 1
 uu_2                -1.673946e-02 1 1  ON 2
 uu_3                -8.209292e-02 1 1  ON 3
 uu_4                -1.195417e-01 1 1  ON 4
 uu_5                -1.419952e-01 1 1  ON 5
 uu_6                -1.545783e-01 1 1  ON 6
 uu_7                -1.566142e-01 1 1  ON 7
 uu_8                -1.455517e-01 1 1  ON 8
 uu_9                -1.138077e-01 1 1  ON 9
 ud_0                 4.404608e-01 1 1  ON 10
 ud_1                 1.582163e-01 1 1  ON 11
 ud_2                 1.245578e-02 1 1  ON 12
 ud_3                -6.744408e-02 1 1  ON 13
 ud_4                -1.145256e-01 1 1  ON 14
 ud_5                -1.441123e-01 1 1  ON 15
 ud_6                -1.619623e-01 1 1  ON 16
 ud_7                -1.676047e-01 1 1  ON 17
 ud_8                -1.573388e-01 1 1  ON 18
 ud_9                -1.289390e-01 1 1  ON 19
 eC_0                -5.633927e-01 1 1  ON 20
 eC_1                -4.094637e-01 1 1  ON 21
 eC_2                -1.607424e-01 1 1  ON 22
 eC_3                -1.565209e-02 1 1  ON 23
 eC_4                 3.105703e-02 1 1  ON 24
 eC_5                 1.157647e-01 1 1  ON 25
 eC_6                 2.333245e-01 1 1  ON 26
 eC_7                 3.961558e-01 1 1  ON 27
 eC_8                 2.888957e-01 1 1  ON 28
 eC_9                 7.720529e-02 1 1  ON 29
 eO_0                -1.245489e+00 1 1  ON 30
 eO_1                -8.670343e-01 1 1  ON 31
 eO_2                -3.873294e-01 1 1  ON 32
 eO_3                -4.182170e-02 1 1  ON 33
 eO_4                 1.870406e-01 1 1  ON 34
 eO_5                 3.719270e-01 1 1  ON 35
 eO_6                 4.631840e-01 1 1  ON 36
 eO_7                 5.238283e-01 1 1  ON 37
 eO_8                 4.815603e-01 1 1  ON 38
 eO_9                 3.354242e-01 1 1  ON 39
eH1_0                -1.852643e-01 1 1  ON 40
eH1_1                -9.813173e-02 1 1  ON 41
eH1_2                -6.510060e-02 1 1  ON 42
eH1_3                -4.885661e-02 1 1  ON 43
eH1_4                 1.220928e-02 1 1  ON 44
eH1_5                 6.937838e-02 1 1  ON 45
eH1_6                 1.262117e-01 1 1  ON 46
eH1_7                 1.019591e-01 1 1  ON 47
eH1_8                 1.075227e-02 1 1  ON 48
eH1_9                -1.839718e-02 1 1  ON 49
eH2_0                -1.876437e-01 1 1  ON 50
eH2_1                -9.964149e-02 1 1  ON 51
eH2_2                -6.620272e-02 1 1  ON 52
eH2_3                -4.999206e-02 1 1  ON 53
eH2_4                 1.128153e-02 1 1  ON 54
eH2_5                 6.859825e-02 1 1  ON 55
eH2_6                 1.248058e-01 1 1  ON 56
eH2_7                 9.973915e-02 1 1  ON 57
eH2_8                 8.460229e-03 1 1  ON 58
eH2_9                -1.295234e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2014e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8389
    reference variance = 0.35051
====================================================
  Execution time = 4.3878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1375e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5009e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513872313339
                                         uncertainty =       0.009328715067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513872313339
                                         uncertainty =       0.009328715067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506829105
  error estimate for blocks of size 2^( 2) =       0.000524002145
  error estimate for blocks of size 2^( 3) =       0.000539345492
  error estimate for blocks of size 2^( 4) =       0.000550032618
  error estimate for blocks of size 2^( 5) =       0.000555875628
  error estimate for blocks of size 2^( 6) =       0.000559640581
  error estimate for blocks of size 2^( 7) =       0.000562944196

      target function =                  N/A
              le_mean =     -22.826248260712
             les_mean =     521.551360886538
             stat err =       0.000557123256
             autocorr =       1.208313092032
              std dev =       0.716764594372
             le_variance =       0.513751483745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282624826071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826248260712       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826248298540       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826248364765       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826248447090       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826248497759       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826248493431       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826248493678       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826248503618       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826248525842       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+00 is 1.869279e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826248260712       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826248270327       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826248287179       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826248308657       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826248321857       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826248320972       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826248321234       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826248323226       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826248328974       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+01 is 4.798240e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826248260712       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826248263126       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826248267358       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826248272787       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826248276123       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826248275915       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826248275994       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826248276459       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826248277906       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+02 is 1.207636e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8900e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.683363e-01 1 1  ON 0
 uu_1                 9.456311e-02 1 1  ON 1
 uu_2                -1.673679e-02 1 1  ON 2
 uu_3                -8.209379e-02 1 1  ON 3
 uu_4                -1.195405e-01 1 1  ON 4
 uu_5                -1.419945e-01 1 1  ON 5
 uu_6                -1.545831e-01 1 1  ON 6
 uu_7                -1.566125e-01 1 1  ON 7
 uu_8                -1.455494e-01 1 1  ON 8
 uu_9                -1.138068e-01 1 1  ON 9
 ud_0                 4.404652e-01 1 1  ON 10
 ud_1                 1.582186e-01 1 1  ON 11
 ud_2                 1.245482e-02 1 1  ON 12
 ud_3                -6.744372e-02 1 1  ON 13
 ud_4                -1.145265e-01 1 1  ON 14
 ud_5                -1.441121e-01 1 1  ON 15
 ud_6                -1.619577e-01 1 1  ON 16
 ud_7                -1.676074e-01 1 1  ON 17
 ud_8                -1.573406e-01 1 1  ON 18
 ud_9                -1.289391e-01 1 1  ON 19
 eC_0                -5.633968e-01 1 1  ON 20
 eC_1                -4.094619e-01 1 1  ON 21
 eC_2                -1.607435e-01 1 1  ON 22
 eC_3                -1.565308e-02 1 1  ON 23
 eC_4                 3.105797e-02 1 1  ON 24
 eC_5                 1.157636e-01 1 1  ON 25
 eC_6                 2.333253e-01 1 1  ON 26
 eC_7                 3.961559e-01 1 1  ON 27
 eC_8                 2.888986e-01 1 1  ON 28
 eC_9                 7.720616e-02 1 1  ON 29
 eO_0                -1.245491e+00 1 1  ON 30
 eO_1                -8.670363e-01 1 1  ON 31
 eO_2                -3.873299e-01 1 1  ON 32
 eO_3                -4.182336e-02 1 1  ON 33
 eO_4                 1.870415e-01 1 1  ON 34
 eO_5                 3.719261e-01 1 1  ON 35
 eO_6                 4.631854e-01 1 1  ON 36
 eO_7                 5.238274e-01 1 1  ON 37
 eO_8                 4.815611e-01 1 1  ON 38
 eO_9                 3.354267e-01 1 1  ON 39
eH1_0                -1.852669e-01 1 1  ON 40
eH1_1                -9.813320e-02 1 1  ON 41
eH1_2                -6.510068e-02 1 1  ON 42
eH1_3                -4.885999e-02 1 1  ON 43
eH1_4                 1.221189e-02 1 1  ON 44
eH1_5                 6.937952e-02 1 1  ON 45
eH1_6                 1.262108e-01 1 1  ON 46
eH1_7                 1.019618e-01 1 1  ON 47
eH1_8                 1.075418e-02 1 1  ON 48
eH1_9                -1.839757e-02 1 1  ON 49
eH2_0                -1.876435e-01 1 1  ON 50
eH2_1                -9.964184e-02 1 1  ON 51
eH2_2                -6.620492e-02 1 1  ON 52
eH2_3                -4.999267e-02 1 1  ON 53
eH2_4                 1.128220e-02 1 1  ON 54
eH2_5                 6.859682e-02 1 1  ON 55
eH2_6                 1.248100e-01 1 1  ON 56
eH2_7                 9.973859e-02 1 1  ON 57
eH2_8                 8.460397e-03 1 1  ON 58
eH2_9                -1.295328e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8773
    reference variance = 0.63909
====================================================
  Execution time = 4.5175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0244e-01
  Total weights = 2.0000e+06
  Execution time = 3.5533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502513766294
                                         uncertainty =       0.002977966280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502513766294
                                         uncertainty =       0.002977966280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501214519
  error estimate for blocks of size 2^( 2) =       0.000518939970
  error estimate for blocks of size 2^( 3) =       0.000535002044
  error estimate for blocks of size 2^( 4) =       0.000546278936
  error estimate for blocks of size 2^( 5) =       0.000552079252
  error estimate for blocks of size 2^( 6) =       0.000554971820
  error estimate for blocks of size 2^( 7) =       0.000557241443

      target function =                  N/A
              le_mean =     -22.824805868179
             les_mean =     521.474194657966
             stat err =       0.000552642863
             autocorr =       1.215743187570
              std dev =       0.708824371129
             le_variance =       0.502431989107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502532343488
                                         uncertainty =       0.002978086913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502532343488
                                         uncertainty =       0.002978086913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501223787
  error estimate for blocks of size 2^( 2) =       0.000518948663
  error estimate for blocks of size 2^( 3) =       0.000535009978
  error estimate for blocks of size 2^( 4) =       0.000546286478
  error estimate for blocks of size 2^( 5) =       0.000552086127
  error estimate for blocks of size 2^( 6) =       0.000554978383
  error estimate for blocks of size 2^( 7) =       0.000557247890

      target function =                  N/A
              le_mean =     -22.824805740331
             les_mean =     521.474207402224
             stat err =       0.000552649719
             autocorr =       1.215728395226
              std dev =       0.708837477562
             le_variance =       0.502450569596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502523232768
                                         uncertainty =       0.002978028050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502523232768
                                         uncertainty =       0.002978028050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501219242
  error estimate for blocks of size 2^( 2) =       0.000518944397
  error estimate for blocks of size 2^( 3) =       0.000535006082
  error estimate for blocks of size 2^( 4) =       0.000546282775
  error estimate for blocks of size 2^( 5) =       0.000552082744
  error estimate for blocks of size 2^( 6) =       0.000554975153
  error estimate for blocks of size 2^( 7) =       0.000557244715

      target function =                  N/A
              le_mean =     -22.824805801199
             les_mean =     521.474201068203
             stat err =       0.000552646347
             autocorr =       1.215735605139
              std dev =       0.708831049659
             le_variance =       0.502441456960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502514954303
                                         uncertainty =       0.002977974045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502514954303
                                         uncertainty =       0.002977974045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501215112
  error estimate for blocks of size 2^( 2) =       0.000518940525
  error estimate for blocks of size 2^( 3) =       0.000535002551
  error estimate for blocks of size 2^( 4) =       0.000546279418
  error estimate for blocks of size 2^( 5) =       0.000552079690
  error estimate for blocks of size 2^( 6) =       0.000554972238
  error estimate for blocks of size 2^( 7) =       0.000557241853

      target function =                  N/A
              le_mean =     -22.824805859623
             les_mean =     521.474195455544
             stat err =       0.000552643300
             autocorr =       1.215742233895
              std dev =       0.708825209258
             le_variance =       0.502433177279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824805868179        initial  <--
     9.0949e+00     9.0949e+01             1.8693e-05       -22.824805740331
     3.6380e+01     3.6380e+02             4.7982e-06       -22.824805801199
     1.4552e+02     1.4552e+03             1.2076e-06       -22.824805859623

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.0401
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.683343e-01 1 1  ON 0
 uu_1                 9.456679e-02 1 1  ON 1
 uu_2                -1.673946e-02 1 1  ON 2
 uu_3                -8.209292e-02 1 1  ON 3
 uu_4                -1.195417e-01 1 1  ON 4
 uu_5                -1.419952e-01 1 1  ON 5
 uu_6                -1.545783e-01 1 1  ON 6
 uu_7                -1.566142e-01 1 1  ON 7
 uu_8                -1.455517e-01 1 1  ON 8
 uu_9                -1.138077e-01 1 1  ON 9
 ud_0                 4.404608e-01 1 1  ON 10
 ud_1                 1.582163e-01 1 1  ON 11
 ud_2                 1.245578e-02 1 1  ON 12
 ud_3                -6.744408e-02 1 1  ON 13
 ud_4                -1.145256e-01 1 1  ON 14
 ud_5                -1.441123e-01 1 1  ON 15
 ud_6                -1.619623e-01 1 1  ON 16
 ud_7                -1.676047e-01 1 1  ON 17
 ud_8                -1.573388e-01 1 1  ON 18
 ud_9                -1.289390e-01 1 1  ON 19
 eC_0                -5.633927e-01 1 1  ON 20
 eC_1                -4.094637e-01 1 1  ON 21
 eC_2                -1.607424e-01 1 1  ON 22
 eC_3                -1.565209e-02 1 1  ON 23
 eC_4                 3.105703e-02 1 1  ON 24
 eC_5                 1.157647e-01 1 1  ON 25
 eC_6                 2.333245e-01 1 1  ON 26
 eC_7                 3.961558e-01 1 1  ON 27
 eC_8                 2.888957e-01 1 1  ON 28
 eC_9                 7.720529e-02 1 1  ON 29
 eO_0                -1.245489e+00 1 1  ON 30
 eO_1                -8.670343e-01 1 1  ON 31
 eO_2                -3.873294e-01 1 1  ON 32
 eO_3                -4.182170e-02 1 1  ON 33
 eO_4                 1.870406e-01 1 1  ON 34
 eO_5                 3.719270e-01 1 1  ON 35
 eO_6                 4.631840e-01 1 1  ON 36
 eO_7                 5.238283e-01 1 1  ON 37
 eO_8                 4.815603e-01 1 1  ON 38
 eO_9                 3.354242e-01 1 1  ON 39
eH1_0                -1.852643e-01 1 1  ON 40
eH1_1                -9.813173e-02 1 1  ON 41
eH1_2                -6.510060e-02 1 1  ON 42
eH1_3                -4.885661e-02 1 1  ON 43
eH1_4                 1.220928e-02 1 1  ON 44
eH1_5                 6.937838e-02 1 1  ON 45
eH1_6                 1.262117e-01 1 1  ON 46
eH1_7                 1.019591e-01 1 1  ON 47
eH1_8                 1.075227e-02 1 1  ON 48
eH1_9                -1.839718e-02 1 1  ON 49
eH2_0                -1.876437e-01 1 1  ON 50
eH2_1                -9.964149e-02 1 1  ON 51
eH2_2                -6.620272e-02 1 1  ON 52
eH2_3                -4.999206e-02 1 1  ON 53
eH2_4                 1.128153e-02 1 1  ON 54
eH2_5                 6.859825e-02 1 1  ON 55
eH2_6                 1.248058e-01 1 1  ON 56
eH2_7                 9.973915e-02 1 1  ON 57
eH2_8                 8.460229e-03 1 1  ON 58
eH2_9                -1.295234e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2195e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7448
    reference variance = 0.433732
====================================================
  Execution time = 4.3685e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0114e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5080e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501261187523
                                         uncertainty =       0.004361504996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501261187523
                                         uncertainty =       0.004361504996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500569811
  error estimate for blocks of size 2^( 2) =       0.000518396626
  error estimate for blocks of size 2^( 3) =       0.000533961378
  error estimate for blocks of size 2^( 4) =       0.000544161476
  error estimate for blocks of size 2^( 5) =       0.000550144245
  error estimate for blocks of size 2^( 6) =       0.000554689072
  error estimate for blocks of size 2^( 7) =       0.000558579671

      target function =                  N/A
              le_mean =     -22.824849885048
             les_mean =     521.474912295184
             stat err =       0.000551893616
             autocorr =       1.215574085788
              std dev =       0.707912615213
             le_variance =       0.501140270777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282484988505e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824849885048       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824849897109       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824849901658       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824849905406       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824849908593       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824849906090       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824849906905       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824849905319       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824849906686       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824849906199       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+01 is 2.192909e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824849885048       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824849888067       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824849889210       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824849890154       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824849890957       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824849890338       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824849890548       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824849890146       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824849890482       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824849890361       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+02 is 5.486814e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824849885048       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824849885803       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824849886089       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824849886326       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824849886525       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824849886372       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824849886426       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824849886329       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824849886406       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824849886376       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+03 is 1.371987e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8773e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.683345e-01 1 1  ON 0
 uu_1                 9.456664e-02 1 1  ON 1
 uu_2                -1.673942e-02 1 1  ON 2
 uu_3                -8.209304e-02 1 1  ON 3
 uu_4                -1.195414e-01 1 1  ON 4
 uu_5                -1.419952e-01 1 1  ON 5
 uu_6                -1.545781e-01 1 1  ON 6
 uu_7                -1.566146e-01 1 1  ON 7
 uu_8                -1.455515e-01 1 1  ON 8
 uu_9                -1.138078e-01 1 1  ON 9
 ud_0                 4.404607e-01 1 1  ON 10
 ud_1                 1.582167e-01 1 1  ON 11
 ud_2                 1.245586e-02 1 1  ON 12
 ud_3                -6.744378e-02 1 1  ON 13
 ud_4                -1.145255e-01 1 1  ON 14
 ud_5                -1.441122e-01 1 1  ON 15
 ud_6                -1.619620e-01 1 1  ON 16
 ud_7                -1.676051e-01 1 1  ON 17
 ud_8                -1.573389e-01 1 1  ON 18
 ud_9                -1.289391e-01 1 1  ON 19
 eC_0                -5.633928e-01 1 1  ON 20
 eC_1                -4.094636e-01 1 1  ON 21
 eC_2                -1.607424e-01 1 1  ON 22
 eC_3                -1.565230e-02 1 1  ON 23
 eC_4                 3.105672e-02 1 1  ON 24
 eC_5                 1.157650e-01 1 1  ON 25
 eC_6                 2.333244e-01 1 1  ON 26
 eC_7                 3.961559e-01 1 1  ON 27
 eC_8                 2.888960e-01 1 1  ON 28
 eC_9                 7.720539e-02 1 1  ON 29
 eO_0                -1.245489e+00 1 1  ON 30
 eO_1                -8.670345e-01 1 1  ON 31
 eO_2                -3.873296e-01 1 1  ON 32
 eO_3                -4.182195e-02 1 1  ON 33
 eO_4                 1.870404e-01 1 1  ON 34
 eO_5                 3.719268e-01 1 1  ON 35
 eO_6                 4.631842e-01 1 1  ON 36
 eO_7                 5.238285e-01 1 1  ON 37
 eO_8                 4.815604e-01 1 1  ON 38
 eO_9                 3.354244e-01 1 1  ON 39
eH1_0                -1.852649e-01 1 1  ON 40
eH1_1                -9.813157e-02 1 1  ON 41
eH1_2                -6.510052e-02 1 1  ON 42
eH1_3                -4.885665e-02 1 1  ON 43
eH1_4                 1.220921e-02 1 1  ON 44
eH1_5                 6.937868e-02 1 1  ON 45
eH1_6                 1.262117e-01 1 1  ON 46
eH1_7                 1.019592e-01 1 1  ON 47
eH1_8                 1.075228e-02 1 1  ON 48
eH1_9                -1.839722e-02 1 1  ON 49
eH2_0                -1.876437e-01 1 1  ON 50
eH2_1                -9.964173e-02 1 1  ON 51
eH2_2                -6.620283e-02 1 1  ON 52
eH2_3                -4.999193e-02 1 1  ON 53
eH2_4                 1.128167e-02 1 1  ON 54
eH2_5                 6.859814e-02 1 1  ON 55
eH2_6                 1.248059e-01 1 1  ON 56
eH2_7                 9.973919e-02 1 1  ON 57
eH2_8                 8.460325e-03 1 1  ON 58
eH2_9                -1.295246e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8136
    reference variance = 0.520676
====================================================
  Execution time = 4.3409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1164e-01
  Total weights = 2.0000e+06
  Execution time = 3.5473e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511730727662
                                         uncertainty =       0.005298777063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511730727662
                                         uncertainty =       0.005298777063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505786228
  error estimate for blocks of size 2^( 2) =       0.000524087772
  error estimate for blocks of size 2^( 3) =       0.000540604778
  error estimate for blocks of size 2^( 4) =       0.000552118228
  error estimate for blocks of size 2^( 5) =       0.000559046520
  error estimate for blocks of size 2^( 6) =       0.000562319369
  error estimate for blocks of size 2^( 7) =       0.000564163397

      target function =                  N/A
              le_mean =     -22.826155421711
             les_mean =     521.545010498119
             stat err =       0.000559411878
             autocorr =       1.223289835445
              std dev =       0.715289743986
             le_variance =       0.511639417852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511729871429
                                         uncertainty =       0.005298778502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511729871429
                                         uncertainty =       0.005298778502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505785806
  error estimate for blocks of size 2^( 2) =       0.000524087356
  error estimate for blocks of size 2^( 3) =       0.000540604378
  error estimate for blocks of size 2^( 4) =       0.000552117809
  error estimate for blocks of size 2^( 5) =       0.000559046095
  error estimate for blocks of size 2^( 6) =       0.000562318971
  error estimate for blocks of size 2^( 7) =       0.000564163037

      target function =                  N/A
              le_mean =     -22.826155422555
             les_mean =     521.545009680930
             stat err =       0.000559411478
             autocorr =       1.223290130849
              std dev =       0.715289145816
             le_variance =       0.511638562122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511730297139
                                         uncertainty =       0.005298777801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511730297139
                                         uncertainty =       0.005298777801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505786016
  error estimate for blocks of size 2^( 2) =       0.000524087563
  error estimate for blocks of size 2^( 3) =       0.000540604577
  error estimate for blocks of size 2^( 4) =       0.000552118017
  error estimate for blocks of size 2^( 5) =       0.000559046306
  error estimate for blocks of size 2^( 6) =       0.000562319169
  error estimate for blocks of size 2^( 7) =       0.000564163216

      target function =                  N/A
              le_mean =     -22.826155422124
             les_mean =     521.545010086707
             stat err =       0.000559411677
             autocorr =       1.223289983561
              std dev =       0.715289443220
             le_variance =       0.511638987582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511730673765
                                         uncertainty =       0.005298777156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511730673765
                                         uncertainty =       0.005298777156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505786202
  error estimate for blocks of size 2^( 2) =       0.000524087746
  error estimate for blocks of size 2^( 3) =       0.000540604753
  error estimate for blocks of size 2^( 4) =       0.000552118201
  error estimate for blocks of size 2^( 5) =       0.000559046493
  error estimate for blocks of size 2^( 6) =       0.000562319344
  error estimate for blocks of size 2^( 7) =       0.000564163374

      target function =                  N/A
              le_mean =     -22.826155421761
             les_mean =     521.545010446571
             stat err =       0.000559411853
             autocorr =       1.223289853971
              std dev =       0.715289706334
             le_variance =       0.511639363987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826155421711        initial
     9.0949e+01     9.0949e+02             2.1929e-06       -22.826155422555  <--
     3.6380e+02     3.6380e+03             5.4868e-07       -22.826155422124
     1.4552e+03     1.4552e+04             1.3720e-07       -22.826155421761

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 6.1259e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.683352e-01 1 1  ON 0
 uu_1                 9.456619e-02 1 1  ON 1
 uu_2                -1.673931e-02 1 1  ON 2
 uu_3                -8.209340e-02 1 1  ON 3
 uu_4                -1.195404e-01 1 1  ON 4
 uu_5                -1.419951e-01 1 1  ON 5
 uu_6                -1.545777e-01 1 1  ON 6
 uu_7                -1.566158e-01 1 1  ON 7
 uu_8                -1.455508e-01 1 1  ON 8
 uu_9                -1.138081e-01 1 1  ON 9
 ud_0                 4.404605e-01 1 1  ON 10
 ud_1                 1.582181e-01 1 1  ON 11
 ud_2                 1.245609e-02 1 1  ON 12
 ud_3                -6.744290e-02 1 1  ON 13
 ud_4                -1.145253e-01 1 1  ON 14
 ud_5                -1.441120e-01 1 1  ON 15
 ud_6                -1.619612e-01 1 1  ON 16
 ud_7                -1.676061e-01 1 1  ON 17
 ud_8                -1.573391e-01 1 1  ON 18
 ud_9                -1.289395e-01 1 1  ON 19
 eC_0                -5.633933e-01 1 1  ON 20
 eC_1                -4.094634e-01 1 1  ON 21
 eC_2                -1.607424e-01 1 1  ON 22
 eC_3                -1.565290e-02 1 1  ON 23
 eC_4                 3.105577e-02 1 1  ON 24
 eC_5                 1.157656e-01 1 1  ON 25
 eC_6                 2.333244e-01 1 1  ON 26
 eC_7                 3.961561e-01 1 1  ON 27
 eC_8                 2.888966e-01 1 1  ON 28
 eC_9                 7.720568e-02 1 1  ON 29
 eO_0                -1.245489e+00 1 1  ON 30
 eO_1                -8.670350e-01 1 1  ON 31
 eO_2                -3.873303e-01 1 1  ON 32
 eO_3                -4.182270e-02 1 1  ON 33
 eO_4                 1.870398e-01 1 1  ON 34
 eO_5                 3.719260e-01 1 1  ON 35
 eO_6                 4.631848e-01 1 1  ON 36
 eO_7                 5.238293e-01 1 1  ON 37
 eO_8                 4.815607e-01 1 1  ON 38
 eO_9                 3.354251e-01 1 1  ON 39
eH1_0                -1.852665e-01 1 1  ON 40
eH1_1                -9.813110e-02 1 1  ON 41
eH1_2                -6.510030e-02 1 1  ON 42
eH1_3                -4.885678e-02 1 1  ON 43
eH1_4                 1.220900e-02 1 1  ON 44
eH1_5                 6.937957e-02 1 1  ON 45
eH1_6                 1.262118e-01 1 1  ON 46
eH1_7                 1.019594e-01 1 1  ON 47
eH1_8                 1.075230e-02 1 1  ON 48
eH1_9                -1.839732e-02 1 1  ON 49
eH2_0                -1.876438e-01 1 1  ON 50
eH2_1                -9.964242e-02 1 1  ON 51
eH2_2                -6.620316e-02 1 1  ON 52
eH2_3                -4.999152e-02 1 1  ON 53
eH2_4                 1.128209e-02 1 1  ON 54
eH2_5                 6.859782e-02 1 1  ON 55
eH2_6                 1.248062e-01 1 1  ON 56
eH2_7                 9.973931e-02 1 1  ON 57
eH2_8                 8.460612e-03 1 1  ON 58
eH2_9                -1.295281e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2004e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.667
    reference variance = 0.818139
====================================================
  Execution time = 4.3564e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1522e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5086e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515310434508
                                         uncertainty =       0.005066448636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.515310434508
                                         uncertainty =       0.005066448636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507552838
  error estimate for blocks of size 2^( 2) =       0.000525194967
  error estimate for blocks of size 2^( 3) =       0.000540166534
  error estimate for blocks of size 2^( 4) =       0.000550716705
  error estimate for blocks of size 2^( 5) =       0.000557716302
  error estimate for blocks of size 2^( 6) =       0.000559945218
  error estimate for blocks of size 2^( 7) =       0.000563739789

      target function =                  N/A
              le_mean =     -22.825280798596
             les_mean =     521.508663044799
             stat err =       0.000558029503
             autocorr =       1.208792621217
              std dev =       0.717788107753
             le_variance =       0.515219767632


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282528079860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825280798596       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825280831993       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825280854373       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825280886462       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825280892929       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825280922573       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825280926368       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825280914059       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825280909630       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825280907765       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.2737e+01 is 8.949850e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825280798596       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825280806992       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825280812655       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825280820747       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825280822333       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825280829797       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825280830770       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825280827681       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825280826490       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825280826063       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.0949e+01 is 2.253858e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825280798596       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825280800698       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825280802118       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825280804146       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825280804540       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825280806409       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825280806654       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825280805882       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825280805579       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825280805475       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+02 is 5.644987e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.322143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8658e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.683352e-01 1 1  ON 0
 uu_1                 9.456583e-02 1 1  ON 1
 uu_2                -1.673885e-02 1 1  ON 2
 uu_3                -8.209343e-02 1 1  ON 3
 uu_4                -1.195401e-01 1 1  ON 4
 uu_5                -1.419936e-01 1 1  ON 5
 uu_6                -1.545765e-01 1 1  ON 6
 uu_7                -1.566165e-01 1 1  ON 7
 uu_8                -1.455509e-01 1 1  ON 8
 uu_9                -1.138091e-01 1 1  ON 9
 ud_0                 4.404628e-01 1 1  ON 10
 ud_1                 1.582190e-01 1 1  ON 11
 ud_2                 1.245611e-02 1 1  ON 12
 ud_3                -6.744359e-02 1 1  ON 13
 ud_4                -1.145244e-01 1 1  ON 14
 ud_5                -1.441120e-01 1 1  ON 15
 ud_6                -1.619611e-01 1 1  ON 16
 ud_7                -1.676071e-01 1 1  ON 17
 ud_8                -1.573398e-01 1 1  ON 18
 ud_9                -1.289399e-01 1 1  ON 19
 eC_0                -5.633942e-01 1 1  ON 20
 eC_1                -4.094637e-01 1 1  ON 21
 eC_2                -1.607416e-01 1 1  ON 22
 eC_3                -1.565319e-02 1 1  ON 23
 eC_4                 3.105577e-02 1 1  ON 24
 eC_5                 1.157657e-01 1 1  ON 25
 eC_6                 2.333242e-01 1 1  ON 26
 eC_7                 3.961557e-01 1 1  ON 27
 eC_8                 2.888973e-01 1 1  ON 28
 eC_9                 7.720605e-02 1 1  ON 29
 eO_0                -1.245490e+00 1 1  ON 30
 eO_1                -8.670358e-01 1 1  ON 31
 eO_2                -3.873295e-01 1 1  ON 32
 eO_3                -4.182161e-02 1 1  ON 33
 eO_4                 1.870376e-01 1 1  ON 34
 eO_5                 3.719254e-01 1 1  ON 35
 eO_6                 4.631852e-01 1 1  ON 36
 eO_7                 5.238300e-01 1 1  ON 37
 eO_8                 4.815607e-01 1 1  ON 38
 eO_9                 3.354259e-01 1 1  ON 39
eH1_0                -1.852667e-01 1 1  ON 40
eH1_1                -9.813102e-02 1 1  ON 41
eH1_2                -6.510029e-02 1 1  ON 42
eH1_3                -4.885745e-02 1 1  ON 43
eH1_4                 1.221042e-02 1 1  ON 44
eH1_5                 6.938050e-02 1 1  ON 45
eH1_6                 1.262118e-01 1 1  ON 46
eH1_7                 1.019588e-01 1 1  ON 47
eH1_8                 1.075204e-02 1 1  ON 48
eH1_9                -1.839812e-02 1 1  ON 49
eH2_0                -1.876442e-01 1 1  ON 50
eH2_1                -9.964320e-02 1 1  ON 51
eH2_2                -6.620275e-02 1 1  ON 52
eH2_3                -4.999201e-02 1 1  ON 53
eH2_4                 1.128276e-02 1 1  ON 54
eH2_5                 6.859657e-02 1 1  ON 55
eH2_6                 1.248070e-01 1 1  ON 56
eH2_7                 9.974057e-02 1 1  ON 57
eH2_8                 8.460999e-03 1 1  ON 58
eH2_9                -1.295341e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7527
    reference variance = 0.404639
====================================================
  Execution time = 4.4131e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0485e-01
  Total weights = 2.0000e+06
  Execution time = 3.5569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504858350747
                                         uncertainty =       0.004022493870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504858350747
                                         uncertainty =       0.004022493870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502418360
  error estimate for blocks of size 2^( 2) =       0.000520141282
  error estimate for blocks of size 2^( 3) =       0.000535112311
  error estimate for blocks of size 2^( 4) =       0.000546750328
  error estimate for blocks of size 2^( 5) =       0.000553947629
  error estimate for blocks of size 2^( 6) =       0.000556566211
  error estimate for blocks of size 2^( 7) =       0.000558799643

      target function =                  N/A
              le_mean =     -22.825501861860
             les_mean =     521.508383409873
             stat err =       0.000554015953
             autocorr =       1.215943898926
              std dev =       0.710526858399
             le_variance =       0.504848416506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504868023861
                                         uncertainty =       0.004022593017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504868023861
                                         uncertainty =       0.004022593017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502423169
  error estimate for blocks of size 2^( 2) =       0.000520145736
  error estimate for blocks of size 2^( 3) =       0.000535116393
  error estimate for blocks of size 2^( 4) =       0.000546754185
  error estimate for blocks of size 2^( 5) =       0.000553951461
  error estimate for blocks of size 2^( 6) =       0.000556569960
  error estimate for blocks of size 2^( 7) =       0.000558803270

      target function =                  N/A
              le_mean =     -22.825501820608
             les_mean =     521.508391192060
             stat err =       0.000554019719
             autocorr =       1.215937152584
              std dev =       0.710533659939
             le_variance =       0.504858081906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504863222362
                                         uncertainty =       0.004022544046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504863222362
                                         uncertainty =       0.004022544046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502420782
  error estimate for blocks of size 2^( 2) =       0.000520143525
  error estimate for blocks of size 2^( 3) =       0.000535114366
  error estimate for blocks of size 2^( 4) =       0.000546752270
  error estimate for blocks of size 2^( 5) =       0.000553949558
  error estimate for blocks of size 2^( 6) =       0.000556568098
  error estimate for blocks of size 2^( 7) =       0.000558801468

      target function =                  N/A
              le_mean =     -22.825501840669
             les_mean =     521.508387310185
             stat err =       0.000554017849
             autocorr =       1.215940496998
              std dev =       0.710530283806
             le_variance =       0.504853284206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504858960729
                                         uncertainty =       0.004022500161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504858960729
                                         uncertainty =       0.004022500161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502418663
  error estimate for blocks of size 2^( 2) =       0.000520141563
  error estimate for blocks of size 2^( 3) =       0.000535112569
  error estimate for blocks of size 2^( 4) =       0.000546750571
  error estimate for blocks of size 2^( 5) =       0.000553947870
  error estimate for blocks of size 2^( 6) =       0.000556566447
  error estimate for blocks of size 2^( 7) =       0.000558799872

      target function =                  N/A
              le_mean =     -22.825501859183
             les_mean =     521.508383897127
             stat err =       0.000554016190
             autocorr =       1.215943472764
              std dev =       0.710527287299
             le_variance =       0.504849025996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825501861860        initial  <--
     2.2737e+01     2.2737e+02             8.9499e-06       -22.825501820608
     9.0949e+01     9.0949e+02             2.2539e-06       -22.825501840669
     3.6380e+02     3.6380e+03             5.6450e-07       -22.825501859183

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.0195
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.683352e-01 1 1  ON 0
 uu_1                 9.456619e-02 1 1  ON 1
 uu_2                -1.673931e-02 1 1  ON 2
 uu_3                -8.209340e-02 1 1  ON 3
 uu_4                -1.195404e-01 1 1  ON 4
 uu_5                -1.419951e-01 1 1  ON 5
 uu_6                -1.545777e-01 1 1  ON 6
 uu_7                -1.566158e-01 1 1  ON 7
 uu_8                -1.455508e-01 1 1  ON 8
 uu_9                -1.138081e-01 1 1  ON 9
 ud_0                 4.404605e-01 1 1  ON 10
 ud_1                 1.582181e-01 1 1  ON 11
 ud_2                 1.245609e-02 1 1  ON 12
 ud_3                -6.744290e-02 1 1  ON 13
 ud_4                -1.145253e-01 1 1  ON 14
 ud_5                -1.441120e-01 1 1  ON 15
 ud_6                -1.619612e-01 1 1  ON 16
 ud_7                -1.676061e-01 1 1  ON 17
 ud_8                -1.573391e-01 1 1  ON 18
 ud_9                -1.289395e-01 1 1  ON 19
 eC_0                -5.633933e-01 1 1  ON 20
 eC_1                -4.094634e-01 1 1  ON 21
 eC_2                -1.607424e-01 1 1  ON 22
 eC_3                -1.565290e-02 1 1  ON 23
 eC_4                 3.105577e-02 1 1  ON 24
 eC_5                 1.157656e-01 1 1  ON 25
 eC_6                 2.333244e-01 1 1  ON 26
 eC_7                 3.961561e-01 1 1  ON 27
 eC_8                 2.888966e-01 1 1  ON 28
 eC_9                 7.720568e-02 1 1  ON 29
 eO_0                -1.245489e+00 1 1  ON 30
 eO_1                -8.670350e-01 1 1  ON 31
 eO_2                -3.873303e-01 1 1  ON 32
 eO_3                -4.182270e-02 1 1  ON 33
 eO_4                 1.870398e-01 1 1  ON 34
 eO_5                 3.719260e-01 1 1  ON 35
 eO_6                 4.631848e-01 1 1  ON 36
 eO_7                 5.238293e-01 1 1  ON 37
 eO_8                 4.815607e-01 1 1  ON 38
 eO_9                 3.354251e-01 1 1  ON 39
eH1_0                -1.852665e-01 1 1  ON 40
eH1_1                -9.813110e-02 1 1  ON 41
eH1_2                -6.510030e-02 1 1  ON 42
eH1_3                -4.885678e-02 1 1  ON 43
eH1_4                 1.220900e-02 1 1  ON 44
eH1_5                 6.937957e-02 1 1  ON 45
eH1_6                 1.262118e-01 1 1  ON 46
eH1_7                 1.019594e-01 1 1  ON 47
eH1_8                 1.075230e-02 1 1  ON 48
eH1_9                -1.839732e-02 1 1  ON 49
eH2_0                -1.876438e-01 1 1  ON 50
eH2_1                -9.964242e-02 1 1  ON 51
eH2_2                -6.620316e-02 1 1  ON 52
eH2_3                -4.999152e-02 1 1  ON 53
eH2_4                 1.128209e-02 1 1  ON 54
eH2_5                 6.859782e-02 1 1  ON 55
eH2_6                 1.248062e-01 1 1  ON 56
eH2_7                 9.973931e-02 1 1  ON 57
eH2_8                 8.460612e-03 1 1  ON 58
eH2_9                -1.295281e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2068e+02 secs
  Total Execution time = 4.8423e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
