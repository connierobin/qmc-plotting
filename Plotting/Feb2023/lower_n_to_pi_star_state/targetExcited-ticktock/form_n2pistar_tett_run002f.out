--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0236.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 80942 MB
Rank =    1  Free Memory = 80939 MB
Rank =    2  Free Memory = 80939 MB
Rank =    3  Free Memory = 80939 MB
Rank =    4  Free Memory = 80939 MB
Rank =    5  Free Memory = 80939 MB
Rank =    6  Free Memory = 80938 MB
Rank =    7  Free Memory = 80938 MB
Rank =    8  Free Memory = 80938 MB
Rank =    9  Free Memory = 80938 MB
Rank =   10  Free Memory = 80938 MB
Rank =   11  Free Memory = 80938 MB
Rank =   12  Free Memory = 80938 MB
Rank =   13  Free Memory = 80938 MB
Rank =   14  Free Memory = 80938 MB
Rank =   15  Free Memory = 80938 MB
Rank =   16  Free Memory = 80938 MB
Rank =   17  Free Memory = 80938 MB
Rank =   18  Free Memory = 80938 MB
Rank =   19  Free Memory = 80938 MB
Rank =   20  Free Memory = 80938 MB
Rank =   21  Free Memory = 80938 MB
Rank =   22  Free Memory = 80937 MB
Rank =   23  Free Memory = 80937 MB
Rank =   24  Free Memory = 80937 MB
Rank =   25  Free Memory = 80937 MB
Rank =   26  Free Memory = 80937 MB
Rank =   27  Free Memory = 80937 MB
Rank =   28  Free Memory = 80937 MB
Rank =   29  Free Memory = 80937 MB
Rank =   30  Free Memory = 80937 MB
Rank =   31  Free Memory = 80937 MB
Rank =   32  Free Memory = 80937 MB
Rank =   33  Free Memory = 80937 MB
Rank =   34  Free Memory = 80937 MB
Rank =   35  Free Memory = 80937 MB
Rank =   36  Free Memory = 80937 MB
Rank =   37  Free Memory = 80937 MB
Rank =   38  Free Memory = 80937 MB
Rank =   39  Free Memory = 80937 MB
Rank =   40  Free Memory = 83151 MB
Rank =   41  Free Memory = 83151 MB
Rank =   42  Free Memory = 83151 MB
Rank =   43  Free Memory = 83151 MB
Rank =   44  Free Memory = 83150 MB
Rank =   45  Free Memory = 83150 MB
Rank =   46  Free Memory = 83150 MB
Rank =   47  Free Memory = 83150 MB
Rank =   48  Free Memory = 83150 MB
Rank =   49  Free Memory = 83150 MB
Rank =   50  Free Memory = 83150 MB
Rank =   51  Free Memory = 83150 MB
Rank =   52  Free Memory = 83150 MB
Rank =   53  Free Memory = 83150 MB
Rank =   54  Free Memory = 83150 MB
Rank =   55  Free Memory = 83150 MB
Rank =   56  Free Memory = 83150 MB
Rank =   57  Free Memory = 83150 MB
Rank =   58  Free Memory = 83150 MB
Rank =   59  Free Memory = 83150 MB
Rank =   60  Free Memory = 83150 MB
Rank =   61  Free Memory = 83150 MB
Rank =   62  Free Memory = 83150 MB
Rank =   63  Free Memory = 83150 MB
Rank =   64  Free Memory = 83150 MB
Rank =   65  Free Memory = 83150 MB
Rank =   66  Free Memory = 83150 MB
Rank =   67  Free Memory = 83150 MB
Rank =   68  Free Memory = 83150 MB
Rank =   69  Free Memory = 83150 MB
Rank =   70  Free Memory = 83150 MB
Rank =   71  Free Memory = 83150 MB
Rank =   72  Free Memory = 83150 MB
Rank =   73  Free Memory = 83150 MB
Rank =   74  Free Memory = 83150 MB
Rank =   75  Free Memory = 83150 MB
Rank =   76  Free Memory = 83150 MB
Rank =   77  Free Memory = 83149 MB
Rank =   78  Free Memory = 83149 MB
Rank =   79  Free Memory = 83149 MB
Rank =   80  Free Memory = 83999 MB
Rank =   81  Free Memory = 83999 MB
Rank =   82  Free Memory = 83999 MB
Rank =   83  Free Memory = 83999 MB
Rank =   84  Free Memory = 83999 MB
Rank =   85  Free Memory = 83999 MB
Rank =   86  Free Memory = 83999 MB
Rank =   87  Free Memory = 83999 MB
Rank =   88  Free Memory = 83999 MB
Rank =   89  Free Memory = 83999 MB
Rank =   90  Free Memory = 83999 MB
Rank =   91  Free Memory = 83999 MB
Rank =   92  Free Memory = 83999 MB
Rank =   93  Free Memory = 83999 MB
Rank =   94  Free Memory = 83999 MB
Rank =   95  Free Memory = 83999 MB
Rank =   96  Free Memory = 83999 MB
Rank =   97  Free Memory = 83999 MB
Rank =   98  Free Memory = 83999 MB
Rank =   99  Free Memory = 83999 MB
Rank =  100  Free Memory = 83999 MB
Rank =  101  Free Memory = 83999 MB
Rank =  102  Free Memory = 83999 MB
Rank =  103  Free Memory = 83999 MB
Rank =  104  Free Memory = 83999 MB
Rank =  105  Free Memory = 83999 MB
Rank =  106  Free Memory = 83999 MB
Rank =  107  Free Memory = 83998 MB
Rank =  108  Free Memory = 83998 MB
Rank =  109  Free Memory = 83998 MB
Rank =  110  Free Memory = 83998 MB
Rank =  111  Free Memory = 83998 MB
Rank =  112  Free Memory = 83998 MB
Rank =  113  Free Memory = 83998 MB
Rank =  114  Free Memory = 83998 MB
Rank =  115  Free Memory = 83998 MB
Rank =  116  Free Memory = 83998 MB
Rank =  117  Free Memory = 83998 MB
Rank =  118  Free Memory = 83998 MB
Rank =  119  Free Memory = 83998 MB
  Input file(s): opt_form_n2pistar_tett_run002f.xml 
Rank =  120  Free Memory = 78771 MB
Rank =  121  Free Memory = 78771 MB
Rank =  122  Free Memory = 78771 MB
Rank =  123  Free Memory = 78771 MB
Rank =  124  Free Memory = 78771 MB
Rank =  127  Free Memory = 78771 MB
Rank =  125  Free Memory = 78771 MB
Rank =  126  Free Memory = 78771 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_tett_run002f.xml

  Project = FORM2
  date    = 2023-03-13 15:13:56 PDT
  host    = n0234.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 36

  Range of prime numbers to use as seeds over processors and threads = 163-983


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.833579e-01    1         1  ON     0
     uu_1                 1.228244e-01    1         1  ON     1
     uu_2                 2.219413e-02    1         1  ON     2
     uu_3                -3.896382e-02    1         1  ON     3
     uu_4                -7.713109e-02    1         1  ON     4
     uu_5                -1.034439e-01    1         1  ON     5
     uu_6                -1.222077e-01    1         1  ON     6
     uu_7                -1.322284e-01    1         1  ON     7
     uu_8                -1.319272e-01    1         1  ON     8
     uu_9                -1.067384e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.458110e-01    1         1  ON     0
     ud_1                 1.052929e-01    1         1  ON     1
     ud_2                -1.436508e-02    1         1  ON     2
     ud_3                -7.758601e-02    1         1  ON     3
     ud_4                -1.132437e-01    1         1  ON     4
     ud_5                -1.345247e-01    1         1  ON     5
     ud_6                -1.462770e-01    1         1  ON     6
     ud_7                -1.471093e-01    1         1  ON     7
     ud_8                -1.359779e-01    1         1  ON     8
     ud_9                -1.006530e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.040900e-01    1         1  ON     0
     eC_1                -3.826772e-01    1         1  ON     1
     eC_2                -1.705972e-01    1         1  ON     2
     eC_3                -4.731043e-02    1         1  ON     3
     eC_4                 9.363800e-04    1         1  ON     4
     eC_5                 1.123156e-01    1         1  ON     5
     eC_6                 2.480182e-01    1         1  ON     6
     eC_7                 3.629280e-01    1         1  ON     7
     eC_8                 2.917384e-01    1         1  ON     8
     eC_9                 8.322409e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.036146e+00    1         1  ON     0
     eO_1                -7.318125e-01    1         1  ON     1
     eO_2                -3.266696e-01    1         1  ON     2
     eO_3                -2.665472e-02    1         1  ON     3
     eO_4                 1.670258e-01    1         1  ON     4
     eO_5                 3.252036e-01    1         1  ON     5
     eO_6                 3.821360e-01    1         1  ON     6
     eO_7                 4.026774e-01    1         1  ON     7
     eO_8                 3.889800e-01    1         1  ON     8
     eO_9                 3.144324e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.168100e-01    1         1  ON     0
     eH1_1                -1.160357e-01    1         1  ON     1
     eH1_2                -7.327931e-02    1         1  ON     2
     eH1_3                -5.245108e-02    1         1  ON     3
     eH1_4                 1.475920e-02    1         1  ON     4
     eH1_5                 6.681762e-02    1         1  ON     5
     eH1_6                 9.461657e-02    1         1  ON     6
     eH1_7                 5.347127e-02    1         1  ON     7
     eH1_8                 7.422875e-03    1         1  ON     8
     eH1_9                 4.301386e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.152090e-01    1         1  ON     0
     eH2_1                -1.128185e-01    1         1  ON     1
     eH2_2                -7.197254e-02    1         1  ON     2
     eH2_3                -5.233494e-02    1         1  ON     3
     eH2_4                 1.367858e-02    1         1  ON     4
     eH2_5                 6.592106e-02    1         1  ON     5
     eH2_6                 9.573015e-02    1         1  ON     6
     eH2_7                 6.194381e-02    1         1  ON     7
     eH2_8                 2.583937e-02    1         1  ON     8
     eH2_9                 5.355459e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.000196e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.1491e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM2.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0234.savio3:32212] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0234.savio3:32212] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6388
    reference variance = 0.399408
====================================================
  Execution time = 4.5440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5442e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5034e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454476630911
                                         uncertainty =       0.003539758437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454476630911
                                         uncertainty =       0.003539758437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476667297
  error estimate for blocks of size 2^( 2) =       0.000500400287
  error estimate for blocks of size 2^( 3) =       0.000522071285
  error estimate for blocks of size 2^( 4) =       0.000537319385
  error estimate for blocks of size 2^( 5) =       0.000546548855
  error estimate for blocks of size 2^( 6) =       0.000551224390
  error estimate for blocks of size 2^( 7) =       0.000553175848

      target function =      -0.741617700147
              le_mean =     -22.661678969524
             les_mean =     514.006116915540
             stat err =       0.000547067120
             autocorr =       1.317196327811
   target nu stat err =       0.000547067120
   target dn stat err =       0.003267227005
      target stat err =       0.002776324782
              std dev =       0.674109356840
             le_variance =       0.454423424980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266167896952e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741627095903       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741632725453       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741637537491       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741640346042       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741640984170       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741642408052       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741642883747       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741643387627       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741644046602       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741644482676       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741645397527       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741645259733       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741645574121       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741646393032       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741646580681       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741647160305       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741646913183       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741646863038       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741646965784       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741646927808       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741646950973       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741647187345       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741647273897       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741647464251       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741647717670       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741647489387       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741647575877       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741647546180       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741647522327       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741647626072       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741647634958       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741647650161       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 1.308011e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741627095903       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741628751674       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741630136470       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741630948104       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741631118396       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741631492848       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741631640565       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741631762056       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741631954604       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741632071375       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741632333298       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741632293558       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741632323792       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741632577143       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741632641788       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741632790173       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741632716519       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741632702845       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741632729516       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741632713935       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741632720432       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741632783560       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741632803946       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741632844132       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741632905857       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741632854709       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741632870094       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741632862993       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741632859193       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741632883219       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 3.408281e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741627095903       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741627528953       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741627888736       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741628099914       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741628143133       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741628237797       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741628276976       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741628307353       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741628357138       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741628386916       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741628454809       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741628444398       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741628449605       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741628515113       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741628532964       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741628569860       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741628550604       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741628547084       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741628553793       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741628549461       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741628551133       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741628567150       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741628572169       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741628581700       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741628596970       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741628584689       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741628588103       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741628586148       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741628585656       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741628591381       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 8.598998e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038774 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0520e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
uu_0  2.834877e-01                 1 1 ON  0
uu_1  1.228590e-01                 1 1 ON  1
uu_2  2.224558e-02                 1 1 ON  2
uu_3  -3.891374e-02                1 1 ON  3
uu_4  -7.704592e-02                1 1 ON  4
uu_5  -1.033193e-01                1 1 ON  5
uu_6  -1.220840e-01                1 1 ON  6
uu_7  -1.321621e-01                1 1 ON  7
uu_8  -1.319044e-01                1 1 ON  8
uu_9  -1.066413e-01                1 1 ON  9
ud_0  3.457781e-01                 1 1 ON  10
ud_1  1.052738e-01                 1 1 ON  11
ud_2  -1.435526e-02                1 1 ON  12
ud_3  -7.752081e-02                1 1 ON  13
ud_4  -1.131746e-01                1 1 ON  14
ud_5  -1.344392e-01                1 1 ON  15
ud_6  -1.461994e-01                1 1 ON  16
ud_7  -1.470240e-01                1 1 ON  17
ud_8  -1.358128e-01                1 1 ON  18
ud_9  -1.004248e-01                1 1 ON  19
eC_0  -5.039367e-01                1 1 ON  20
eC_1  -3.825575e-01                1 1 ON  21
eC_2  -1.705609e-01                1 1 ON  22
eC_3  -4.731226e-02                1 1 ON  23
eC_4  9.208214e-04                 1 1 ON  24
eC_5  1.121305e-01                 1 1 ON  25
eC_6  2.476773e-01                 1 1 ON  26
eC_7  3.629354e-01                 1 1 ON  27
eC_8  2.919374e-01                 1 1 ON  28
eC_9  8.326917e-02                 1 1 ON  29
eO_0  -1.035870e+00                1 1 ON  30
eO_1  -7.315786e-01                1 1 ON  31
eO_2  -3.266012e-01                1 1 ON  32
eO_3  -2.661710e-02                1 1 ON  33
eO_4  1.669082e-01                 1 1 ON  34
eO_5  3.250515e-01                 1 1 ON  35
eO_6  3.821741e-01                 1 1 ON  36
eO_7  4.024352e-01                 1 1 ON  37
eO_8  3.887401e-01                 1 1 ON  38
eO_9  3.144770e-01                 1 1 ON  39
eH1_0 -2.167284e-01                1 1 ON  40
eH1_1 -1.159332e-01                1 1 ON  41
eH1_2 -7.321248e-02                1 1 ON  42
eH1_3 -5.241175e-02                1 1 ON  43
eH1_4 1.469719e-02                 1 1 ON  44
eH1_5 6.662775e-02                 1 1 ON  45
eH1_6 9.448340e-02                 1 1 ON  46
eH1_7 5.344538e-02                 1 1 ON  47
eH1_8 7.560997e-03                 1 1 ON  48
eH1_9 4.292043e-02                 1 1 ON  49
eH2_0 -2.153061e-01                1 1 ON  50
eH2_1 -1.129551e-01                1 1 ON  51
eH2_2 -7.200526e-02                1 1 ON  52
eH2_3 -5.232418e-02                1 1 ON  53
eH2_4 1.371168e-02                 1 1 ON  54
eH2_5 6.590941e-02                 1 1 ON  55
eH2_6 9.573752e-02                 1 1 ON  56
eH2_7 6.204215e-02                 1 1 ON  57
eH2_8 2.581757e-02                 1 1 ON  58
eH2_9 5.360273e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6967
    reference variance = 0.321497
====================================================
  Execution time = 4.4752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5053e-01
  Total weights = 2.0000e+06
  Execution time = 3.6794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450483720674
                                         uncertainty =       0.004008221514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450483720674
                                         uncertainty =       0.004008221514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474621347
  error estimate for blocks of size 2^( 2) =       0.000498506402
  error estimate for blocks of size 2^( 3) =       0.000520463794
  error estimate for blocks of size 2^( 4) =       0.000535915532
  error estimate for blocks of size 2^( 5) =       0.000544960211
  error estimate for blocks of size 2^( 6) =       0.000548345395
  error estimate for blocks of size 2^( 7) =       0.000550387307

      target function =      -0.744853576822
              le_mean =     -22.661570494021
             les_mean =     513.997307876227
             stat err =       0.000544902111
             autocorr =       1.318082051886
   target nu stat err =       0.000544902111
   target dn stat err =       0.004148804184
      target stat err =       0.003521928259
              std dev =       0.671215945869
             le_variance =       0.450530845989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450466395136
                                         uncertainty =       0.004006702501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450466395136
                                         uncertainty =       0.004006702501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474612165
  error estimate for blocks of size 2^( 2) =       0.000498523841
  error estimate for blocks of size 2^( 3) =       0.000520511788
  error estimate for blocks of size 2^( 4) =       0.000535983156
  error estimate for blocks of size 2^( 5) =       0.000545041190
  error estimate for blocks of size 2^( 6) =       0.000548428722
  error estimate for blocks of size 2^( 7) =       0.000550456133

      target function =      -0.744868172066
              le_mean =     -22.661569390128
             les_mean =     513.997240413513
             stat err =       0.000544977300
             autocorr =       1.318496843659
   target nu stat err =       0.000544977300
   target dn stat err =       0.004147660872
      target stat err =       0.003521131637
              std dev =       0.671202961234
             le_variance =       0.450513415170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450474865792
                                         uncertainty =       0.004007337111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450474865792
                                         uncertainty =       0.004007337111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474616650
  error estimate for blocks of size 2^( 2) =       0.000498516926
  error estimate for blocks of size 2^( 3) =       0.000520491800
  error estimate for blocks of size 2^( 4) =       0.000535954767
  error estimate for blocks of size 2^( 5) =       0.000545006935
  error estimate for blocks of size 2^( 6) =       0.000548393472
  error estimate for blocks of size 2^( 7) =       0.000550427000

      target function =      -0.744861048613
              le_mean =     -22.661569613735
             les_mean =     513.997259061178
             stat err =       0.000544945543
             autocorr =       1.318318273716
   target nu stat err =       0.000544945543
   target dn stat err =       0.004148116250
      target stat err =       0.003521435235
              std dev =       0.671209302878
             le_variance =       0.450521928270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450482508015
                                         uncertainty =       0.004008106961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450482508015
                                         uncertainty =       0.004008106961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474620704
  error estimate for blocks of size 2^( 2) =       0.000498507724
  error estimate for blocks of size 2^( 3) =       0.000520467375
  error estimate for blocks of size 2^( 4) =       0.000535920561
  error estimate for blocks of size 2^( 5) =       0.000544966203
  error estimate for blocks of size 2^( 6) =       0.000548351559
  error estimate for blocks of size 2^( 7) =       0.000550392378

      target function =      -0.744854600133
              le_mean =     -22.661570343177
             les_mean =     513.997299818559
             stat err =       0.000544907675
             autocorr =       1.318112541497
   target nu stat err =       0.000544907675
   target dn stat err =       0.004148714268
      target stat err =       0.003521864043
              std dev =       0.671215036377
             le_variance =       0.450529625059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744853576822        initial
     2.5000e-01     2.5000e+00             1.3080e-03        -0.744868172066  <--
     1.0000e+00     1.0000e+01             3.4083e-04        -0.744861048613
     4.0000e+00     4.0000e+01             8.5990e-05        -0.744854600133

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.3134e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
 uu_0                 2.838285e-01 1 1  ON 0
 uu_1                 1.229802e-01 1 1  ON 1
 uu_2                 2.240670e-02 1 1  ON 2
 uu_3                -3.875278e-02 1 1  ON 3
 uu_4                -7.679767e-02 1 1  ON 4
 uu_5                -1.029714e-01 1 1  ON 5
 uu_6                -1.217339e-01 1 1  ON 6
 uu_7                -1.319488e-01 1 1  ON 7
 uu_8                -1.317943e-01 1 1  ON 8
 uu_9                -1.063525e-01 1 1  ON 9
 ud_0                 3.457192e-01 1 1  ON 10
 ud_1                 1.052485e-01 1 1  ON 11
 ud_2                -1.430795e-02 1 1  ON 12
 ud_3                -7.733787e-02 1 1  ON 13
 ud_4                -1.129768e-01 1 1  ON 14
 ud_5                -1.341980e-01 1 1  ON 15
 ud_6                -1.459706e-01 1 1  ON 16
 ud_7                -1.467668e-01 1 1  ON 17
 ud_8                -1.353446e-01 1 1  ON 18
 ud_9                -9.979960e-02 1 1  ON 19
 eC_0                -5.035346e-01 1 1  ON 20
 eC_1                -3.822443e-01 1 1  ON 21
 eC_2                -1.704507e-01 1 1  ON 22
 eC_3                -4.729236e-02 1 1  ON 23
 eC_4                 8.813391e-04 1 1  ON 24
 eC_5                 1.116244e-01 1 1  ON 25
 eC_6                 2.467101e-01 1 1  ON 26
 eC_7                 3.629271e-01 1 1  ON 27
 eC_8                 2.925289e-01 1 1  ON 28
 eC_9                 8.340562e-02 1 1  ON 29
 eO_0                -1.035141e+00 1 1  ON 30
 eO_1                -7.309603e-01 1 1  ON 31
 eO_2                -3.263967e-01 1 1  ON 32
 eO_3                -2.650518e-02 1 1  ON 33
 eO_4                 1.666288e-01 1 1  ON 34
 eO_5                 3.246626e-01 1 1  ON 35
 eO_6                 3.822653e-01 1 1  ON 36
 eO_7                 4.017781e-01 1 1  ON 37
 eO_8                 3.880267e-01 1 1  ON 38
 eO_9                 3.146025e-01 1 1  ON 39
eH1_0                -2.165007e-01 1 1  ON 40
eH1_1                -1.156702e-01 1 1  ON 41
eH1_2                -7.304446e-02 1 1  ON 42
eH1_3                -5.232404e-02 1 1  ON 43
eH1_4                 1.451939e-02 1 1  ON 44
eH1_5                 6.613054e-02 1 1  ON 45
eH1_6                 9.413167e-02 1 1  ON 46
eH1_7                 5.338010e-02 1 1  ON 47
eH1_8                 7.960651e-03 1 1  ON 48
eH1_9                 4.263916e-02 1 1  ON 49
eH2_0                -2.155786e-01 1 1  ON 50
eH2_1                -1.133050e-01 1 1  ON 51
eH2_2                -7.209675e-02 1 1  ON 52
eH2_3                -5.230570e-02 1 1  ON 53
eH2_4                 1.377868e-02 1 1  ON 54
eH2_5                 6.586834e-02 1 1  ON 55
eH2_6                 9.574905e-02 1 1  ON 56
eH2_7                 6.230382e-02 1 1  ON 57
eH2_8                 2.577671e-02 1 1  ON 58
eH2_9                 5.373355e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2366e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.682
    reference variance = 0.386314
====================================================
  Execution time = 4.4389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5294e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5558e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452910702892
                                         uncertainty =       0.003170810130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452910702892
                                         uncertainty =       0.003170810130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475889681
  error estimate for blocks of size 2^( 2) =       0.000499645639
  error estimate for blocks of size 2^( 3) =       0.000521380999
  error estimate for blocks of size 2^( 4) =       0.000537626352
  error estimate for blocks of size 2^( 5) =       0.000546633130
  error estimate for blocks of size 2^( 6) =       0.000550286216
  error estimate for blocks of size 2^( 7) =       0.000552982903

      target function =      -0.742848505912
              le_mean =     -22.661732091641
             les_mean =     514.007043143662
             stat err =       0.000546882150
             autocorr =       1.320611034834
   target nu stat err =       0.000546882150
   target dn stat err =       0.002987223499
      target stat err =       0.002558823360
              std dev =       0.673009640970
             le_variance =       0.452941976839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266173209164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742856254785       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742865338236       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742874482878       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742879850269       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742887054822       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742890310868       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742893433394       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742896195447       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742897822132       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742901208831       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742904346972       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742906454889       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742908556240       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742911072809       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742912648764       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742916075387       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742917229955       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742917973196       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742919120380       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742920238455       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742922223451       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742923262888       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742923194594       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742923913169       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742923960083       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742924629283       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742924873741       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742925218018       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742924934064       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742924641777       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742924642357       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.742924561298       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.742924638528       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742924548438       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 3.273341e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742856254785       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742859857016       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742863394715       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742865279309       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742868003310       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742869098947       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742870240608       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742870979640       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742871624662       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742872102791       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742873854385       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742874683581       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742875024013       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742876079836       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742876442281       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742877494565       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742877812277       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742878063327       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742878345611       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742878616381       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742879126936       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742879401641       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742879361368       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742879516131       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742879481729       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742879602423       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742879667767       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742879654100       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742879664241       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742879564123       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742879559532       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 1.072292e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742856254785       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742857310005       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742858335460       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742858855692       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742859638164       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742859935281       residual = 7.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742860251993       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742860433709       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742860633242       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742860777775       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742861242593       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742861456245       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742861557387       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742861839673       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742861928540       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742862205686       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742862285571       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742862354789       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742862419941       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742862484339       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742862610048       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742862678534       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742862665677       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742862700035       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742862687598       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742862714884       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742862729273       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742862723270       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742862724528       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742862701126       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742862702263       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.933070e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9993e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
 uu_0                 2.843760e-01 1 1  ON 0
 uu_1                 1.233436e-01 1 1  ON 1
 uu_2                 2.270078e-02 1 1  ON 2
 uu_3                -3.859167e-02 1 1  ON 3
 uu_4                -7.670117e-02 1 1  ON 4
 uu_5                -1.028243e-01 1 1  ON 5
 uu_6                -1.215150e-01 1 1  ON 6
 uu_7                -1.318159e-01 1 1  ON 7
 uu_8                -1.316404e-01 1 1  ON 8
 uu_9                -1.058176e-01 1 1  ON 9
 ud_0                 3.454160e-01 1 1  ON 10
 ud_1                 1.048516e-01 1 1  ON 11
 ud_2                -1.459306e-02 1 1  ON 12
 ud_3                -7.732936e-02 1 1  ON 13
 ud_4                -1.127192e-01 1 1  ON 14
 ud_5                -1.336934e-01 1 1  ON 15
 ud_6                -1.453049e-01 1 1  ON 16
 ud_7                -1.459211e-01 1 1  ON 17
 ud_8                -1.345699e-01 1 1  ON 18
 ud_9                -9.904710e-02 1 1  ON 19
 eC_0                -5.027837e-01 1 1  ON 20
 eC_1                -3.811737e-01 1 1  ON 21
 eC_2                -1.696636e-01 1 1  ON 22
 eC_3                -4.743348e-02 1 1  ON 23
 eC_4                -1.909531e-04 1 1  ON 24
 eC_5                 1.106378e-01 1 1  ON 25
 eC_6                 2.463031e-01 1 1  ON 26
 eC_7                 3.624488e-01 1 1  ON 27
 eC_8                 2.928584e-01 1 1  ON 28
 eC_9                 8.357156e-02 1 1  ON 29
 eO_0                -1.034115e+00 1 1  ON 30
 eO_1                -7.299388e-01 1 1  ON 31
 eO_2                -3.255288e-01 1 1  ON 32
 eO_3                -2.634016e-02 1 1  ON 33
 eO_4                 1.662666e-01 1 1  ON 34
 eO_5                 3.236183e-01 1 1  ON 35
 eO_6                 3.813259e-01 1 1  ON 36
 eO_7                 4.010840e-01 1 1  ON 37
 eO_8                 3.875544e-01 1 1  ON 38
 eO_9                 3.146228e-01 1 1  ON 39
eH1_0                -2.166616e-01 1 1  ON 40
eH1_1                -1.157876e-01 1 1  ON 41
eH1_2                -7.308111e-02 1 1  ON 42
eH1_3                -5.250784e-02 1 1  ON 43
eH1_4                 1.447848e-02 1 1  ON 44
eH1_5                 6.641022e-02 1 1  ON 45
eH1_6                 9.482472e-02 1 1  ON 46
eH1_7                 5.301887e-02 1 1  ON 47
eH1_8                 7.997708e-03 1 1  ON 48
eH1_9                 4.224317e-02 1 1  ON 49
eH2_0                -2.150089e-01 1 1  ON 50
eH2_1                -1.132410e-01 1 1  ON 51
eH2_2                -7.184548e-02 1 1  ON 52
eH2_3                -5.236719e-02 1 1  ON 53
eH2_4                 1.379301e-02 1 1  ON 54
eH2_5                 6.614890e-02 1 1  ON 55
eH2_6                 9.589212e-02 1 1  ON 56
eH2_7                 6.207103e-02 1 1  ON 57
eH2_8                 2.497534e-02 1 1  ON 58
eH2_9                 5.334229e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.649
    reference variance = 0.234837
====================================================
  Execution time = 4.5888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5492e-01
  Total weights = 2.0000e+06
  Execution time = 3.6701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454852160494
                                         uncertainty =       0.002838009115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454852160494
                                         uncertainty =       0.002838009115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476904836
  error estimate for blocks of size 2^( 2) =       0.000500621135
  error estimate for blocks of size 2^( 3) =       0.000523393192
  error estimate for blocks of size 2^( 4) =       0.000538505034
  error estimate for blocks of size 2^( 5) =       0.000547523868
  error estimate for blocks of size 2^( 6) =       0.000551256816
  error estimate for blocks of size 2^( 7) =       0.000555877344

      target function =      -0.741251592937
              le_mean =     -22.661150112328
             les_mean =     513.982600632054
             stat err =       0.000548290765
             autocorr =       1.321777665716
   target nu stat err =       0.000548290765
   target dn stat err =       0.003318463593
      target stat err =       0.002813106641
              std dev =       0.674445287649
             le_variance =       0.454876446032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454938979427
                                         uncertainty =       0.002836141453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454938979427
                                         uncertainty =       0.002836141453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476950309
  error estimate for blocks of size 2^( 2) =       0.000500697494
  error estimate for blocks of size 2^( 3) =       0.000523522768
  error estimate for blocks of size 2^( 4) =       0.000538684096
  error estimate for blocks of size 2^( 5) =       0.000547738755
  error estimate for blocks of size 2^( 6) =       0.000551472765
  error estimate for blocks of size 2^( 7) =       0.000556097590

      target function =      -0.741179795287
              le_mean =     -22.661152520076
             les_mean =     513.982796506014
             stat err =       0.000548498302
             autocorr =       1.322526261048
   target nu stat err =       0.000548498302
   target dn stat err =       0.003316233392
      target stat err =       0.002810834484
              std dev =       0.674509596189
             le_variance =       0.454963195351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454938036398
                                         uncertainty =       0.002836926873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454938036398
                                         uncertainty =       0.002836926873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476949822
  error estimate for blocks of size 2^( 2) =       0.000500685401
  error estimate for blocks of size 2^( 3) =       0.000523494080
  error estimate for blocks of size 2^( 4) =       0.000538640660
  error estimate for blocks of size 2^( 5) =       0.000547683368
  error estimate for blocks of size 2^( 6) =       0.000551417337
  error estimate for blocks of size 2^( 7) =       0.000556040769

      target function =      -0.741180592919
              le_mean =     -22.661150557966
             les_mean =     513.982706649515
             stat err =       0.000548445533
             autocorr =       1.322274507335
   target nu stat err =       0.000548445533
   target dn stat err =       0.003317105496
      target stat err =       0.002811523415
              std dev =       0.674508907424
             le_variance =       0.454962266194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454863889977
                                         uncertainty =       0.002837872373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454863889977
                                         uncertainty =       0.002837872373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476910981
  error estimate for blocks of size 2^( 2) =       0.000500629615
  error estimate for blocks of size 2^( 3) =       0.000523406528
  error estimate for blocks of size 2^( 4) =       0.000538523051
  error estimate for blocks of size 2^( 5) =       0.000547545033
  error estimate for blocks of size 2^( 6) =       0.000551278101
  error estimate for blocks of size 2^( 7) =       0.000555898983

      target function =      -0.741241903294
              le_mean =     -22.661149673237
             les_mean =     513.982592453073
             stat err =       0.000548311292
             autocorr =       1.321842573769
   target nu stat err =       0.000548311292
   target dn stat err =       0.003318289196
      target stat err =       0.002812897119
              std dev =       0.674453977417
             le_variance =       0.454888167653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741251592937        initial  <--
     6.2500e-02     6.2500e-01             3.2733e-03        -0.741179795287
     2.5000e-01     2.5000e+00             1.0723e-03        -0.741180592919
     1.0000e+00     1.0000e+01             2.9331e-04        -0.741241903294

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.6933
  </log>
  <optVariables href="FORM2.s001.opt.xml">
 uu_0                 2.838285e-01 1 1  ON 0
 uu_1                 1.229802e-01 1 1  ON 1
 uu_2                 2.240670e-02 1 1  ON 2
 uu_3                -3.875278e-02 1 1  ON 3
 uu_4                -7.679767e-02 1 1  ON 4
 uu_5                -1.029714e-01 1 1  ON 5
 uu_6                -1.217339e-01 1 1  ON 6
 uu_7                -1.319488e-01 1 1  ON 7
 uu_8                -1.317943e-01 1 1  ON 8
 uu_9                -1.063525e-01 1 1  ON 9
 ud_0                 3.457192e-01 1 1  ON 10
 ud_1                 1.052485e-01 1 1  ON 11
 ud_2                -1.430795e-02 1 1  ON 12
 ud_3                -7.733787e-02 1 1  ON 13
 ud_4                -1.129768e-01 1 1  ON 14
 ud_5                -1.341980e-01 1 1  ON 15
 ud_6                -1.459706e-01 1 1  ON 16
 ud_7                -1.467668e-01 1 1  ON 17
 ud_8                -1.353446e-01 1 1  ON 18
 ud_9                -9.979960e-02 1 1  ON 19
 eC_0                -5.035346e-01 1 1  ON 20
 eC_1                -3.822443e-01 1 1  ON 21
 eC_2                -1.704507e-01 1 1  ON 22
 eC_3                -4.729236e-02 1 1  ON 23
 eC_4                 8.813391e-04 1 1  ON 24
 eC_5                 1.116244e-01 1 1  ON 25
 eC_6                 2.467101e-01 1 1  ON 26
 eC_7                 3.629271e-01 1 1  ON 27
 eC_8                 2.925289e-01 1 1  ON 28
 eC_9                 8.340562e-02 1 1  ON 29
 eO_0                -1.035141e+00 1 1  ON 30
 eO_1                -7.309603e-01 1 1  ON 31
 eO_2                -3.263967e-01 1 1  ON 32
 eO_3                -2.650518e-02 1 1  ON 33
 eO_4                 1.666288e-01 1 1  ON 34
 eO_5                 3.246626e-01 1 1  ON 35
 eO_6                 3.822653e-01 1 1  ON 36
 eO_7                 4.017781e-01 1 1  ON 37
 eO_8                 3.880267e-01 1 1  ON 38
 eO_9                 3.146025e-01 1 1  ON 39
eH1_0                -2.165007e-01 1 1  ON 40
eH1_1                -1.156702e-01 1 1  ON 41
eH1_2                -7.304446e-02 1 1  ON 42
eH1_3                -5.232404e-02 1 1  ON 43
eH1_4                 1.451939e-02 1 1  ON 44
eH1_5                 6.613054e-02 1 1  ON 45
eH1_6                 9.413167e-02 1 1  ON 46
eH1_7                 5.338010e-02 1 1  ON 47
eH1_8                 7.960651e-03 1 1  ON 48
eH1_9                 4.263916e-02 1 1  ON 49
eH2_0                -2.155786e-01 1 1  ON 50
eH2_1                -1.133050e-01 1 1  ON 51
eH2_2                -7.209675e-02 1 1  ON 52
eH2_3                -5.230570e-02 1 1  ON 53
eH2_4                 1.377868e-02 1 1  ON 54
eH2_5                 6.586834e-02 1 1  ON 55
eH2_6                 9.574905e-02 1 1  ON 56
eH2_7                 6.230382e-02 1 1  ON 57
eH2_8                 2.577671e-02 1 1  ON 58
eH2_9                 5.373355e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2669e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7643
    reference variance = 0.300539
====================================================
  Execution time = 4.4780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2664e+01
  VMC Evar = 6.9933e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5357e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.699489841591
                                         uncertainty =       0.230500633450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.699489841591
                                         uncertainty =       0.230500633450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000591322862
  error estimate for blocks of size 2^( 2) =       0.000610473518
  error estimate for blocks of size 2^( 3) =       0.000629229780
  error estimate for blocks of size 2^( 4) =       0.000642611731
  error estimate for blocks of size 2^( 5) =       0.000650748515
  error estimate for blocks of size 2^( 6) =       0.000656592541
  error estimate for blocks of size 2^( 7) =       0.000660491423

      target function =      -0.558745841000
              le_mean =     -22.663553841589
             les_mean =     514.335997836097
             stat err =       0.000652611053
             autocorr =       1.218034272223
   target nu stat err =       0.000652611053
   target dn stat err =       0.231176508807
      target stat err =       0.113593049484
              std dev =       0.836256811726
             le_variance =       0.699325455159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266355384159e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.581876153268       residual = 1.59e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.587392159907       residual = 3.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.588696681517       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.589192393963       residual = 6.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.589645617184       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.589841427580       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.589998626548       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.590111937627       residual = 9.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.590211033649       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.590336368966       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.590397672456       residual = 5.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.590454122442       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.590493059511       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.590547775872       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.590631381476       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.590683032805       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.590716497041       residual = 6.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.590729690395       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.590737549748       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.590743474870       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.590747573209       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.590751914931       residual = 8.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.590754961697       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.590757732581       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.590760319805       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.590761514606       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.590762914890       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.590763539653       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.590763881489       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.590764066462       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.590764160333       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.590764251823       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.590764292829       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.590764264124       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.590764248220       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.590764263768       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.590764261447       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 1.024772e-02

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.581876153268       residual = 1.59e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.583319301505       residual = 3.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.583663664809       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.583793154985       residual = 6.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.583913572408       residual = 4.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.583963787195       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.584004129516       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.584033314725       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.584058733338       residual = 9.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.584088075211       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.584106929202       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.584121127655       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.584131735143       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.584146422542       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.584167892975       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.584180645180       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.584189256394       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.584192440691       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.584194342950       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.584195849620       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.584196888696       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.584197994883       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.584198764127       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.584199434123       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.584200057324       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.584200344146       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.584200685698       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.584200826477       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.584200900725       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.584200942679       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.584200963505       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.584200984504       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.584200994158       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.584200985535       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.584200982360       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.584200985365       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.584200985148       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 2.615850e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.581876153268       residual = 1.59e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.582241130155       residual = 3.77e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.582328416360       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.582361146811       residual = 6.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.582391705838       residual = 4.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.582404348112       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.582414493448       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.582421841897       residual = 9.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.582428235678       residual = 9.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.582435471267       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.582440385025       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.582443941504       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.582446644189       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.582450380554       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.582455786467       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.582458957106       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.582461125395       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.582461913140       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.582462384396       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.582462762686       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.582463023459       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.582463301155       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.582463493722       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.582463659584       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.582463813784       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.582463884763       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.582463969545       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.582464003740       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.582464021625       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.582464031845       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.582464036891       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.582464042031       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.582464044408       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.582464042144       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.582464041441       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.582464042112       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.582464042080       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         36 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 6.572362e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136372 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0200e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
 uu_0                 2.834102e-01 1 1  ON 0
 uu_1                 1.230720e-01 1 1  ON 1
 uu_2                 2.251243e-02 1 1  ON 2
 uu_3                -3.854333e-02 1 1  ON 3
 uu_4                -7.649180e-02 1 1  ON 4
 uu_5                -1.027821e-01 1 1  ON 5
 uu_6                -1.216193e-01 1 1  ON 6
 uu_7                -1.320769e-01 1 1  ON 7
 uu_8                -1.320081e-01 1 1  ON 8
 uu_9                -1.064400e-01 1 1  ON 9
 ud_0                 3.471834e-01 1 1  ON 10
 ud_1                 1.064827e-01 1 1  ON 11
 ud_2                -1.362445e-02 1 1  ON 12
 ud_3                -7.722701e-02 1 1  ON 13
 ud_4                -1.132599e-01 1 1  ON 14
 ud_5                -1.348344e-01 1 1  ON 15
 ud_6                -1.467592e-01 1 1  ON 16
 ud_7                -1.474458e-01 1 1  ON 17
 ud_8                -1.359600e-01 1 1  ON 18
 ud_9                -1.001136e-01 1 1  ON 19
 eC_0                -5.052944e-01 1 1  ON 20
 eC_1                -3.838578e-01 1 1  ON 21
 eC_2                -1.711991e-01 1 1  ON 22
 eC_3                -4.685978e-02 1 1  ON 23
 eC_4                 1.607283e-03 1 1  ON 24
 eC_5                 1.126557e-01 1 1  ON 25
 eC_6                 2.481148e-01 1 1  ON 26
 eC_7                 3.633270e-01 1 1  ON 27
 eC_8                 2.925873e-01 1 1  ON 28
 eC_9                 8.344085e-02 1 1  ON 29
 eO_0                -1.036039e+00 1 1  ON 30
 eO_1                -7.320665e-01 1 1  ON 31
 eO_2                -3.266723e-01 1 1  ON 32
 eO_3                -2.632522e-02 1 1  ON 33
 eO_4                 1.668360e-01 1 1  ON 34
 eO_5                 3.252645e-01 1 1  ON 35
 eO_6                 3.831163e-01 1 1  ON 36
 eO_7                 4.021755e-01 1 1  ON 37
 eO_8                 3.879734e-01 1 1  ON 38
 eO_9                 3.146145e-01 1 1  ON 39
eH1_0                -2.169182e-01 1 1  ON 40
eH1_1                -1.160051e-01 1 1  ON 41
eH1_2                -7.324666e-02 1 1  ON 42
eH1_3                -5.247267e-02 1 1  ON 43
eH1_4                 1.377219e-02 1 1  ON 44
eH1_5                 6.596247e-02 1 1  ON 45
eH1_6                 9.427175e-02 1 1  ON 46
eH1_7                 5.488402e-02 1 1  ON 47
eH1_8                 8.209491e-03 1 1  ON 48
eH1_9                 4.269774e-02 1 1  ON 49
eH2_0                -2.161470e-01 1 1  ON 50
eH2_1                -1.138247e-01 1 1  ON 51
eH2_2                -7.283479e-02 1 1  ON 52
eH2_3                -5.314915e-02 1 1  ON 53
eH2_4                 1.259118e-02 1 1  ON 54
eH2_5                 6.549081e-02 1 1  ON 55
eH2_6                 9.613313e-02 1 1  ON 56
eH2_7                 6.491967e-02 1 1  ON 57
eH2_8                 2.683972e-02 1 1  ON 58
eH2_9                 5.387188e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6378
    reference variance = 0.30871
====================================================
  Execution time = 4.4042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4879e-01
  Total weights = 2.0000e+06
  Execution time = 3.6857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448496560165
                                         uncertainty =       0.002786454404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448496560165
                                         uncertainty =       0.002786454404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473585944
  error estimate for blocks of size 2^( 2) =       0.000497804395
  error estimate for blocks of size 2^( 3) =       0.000519559606
  error estimate for blocks of size 2^( 4) =       0.000534584725
  error estimate for blocks of size 2^( 5) =       0.000543068956
  error estimate for blocks of size 2^( 6) =       0.000547130521
  error estimate for blocks of size 2^( 7) =       0.000546495575

      target function =      -0.746498039286
              le_mean =     -22.662416014132
             les_mean =     514.033666666773
             stat err =       0.000542819944
             autocorr =       1.313753794695
   target nu stat err =       0.000542819944
   target dn stat err =       0.002794409906
      target stat err =       0.002427674664
              std dev =       0.669751665534
             le_variance =       0.448567293485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449554783367
                                         uncertainty =       0.002794706118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449554783367
                                         uncertainty =       0.002794706118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474143916
  error estimate for blocks of size 2^( 2) =       0.000498051032
  error estimate for blocks of size 2^( 3) =       0.000519472866
  error estimate for blocks of size 2^( 4) =       0.000534267825
  error estimate for blocks of size 2^( 5) =       0.000542670678
  error estimate for blocks of size 2^( 6) =       0.000546685044
  error estimate for blocks of size 2^( 7) =       0.000546053511

      target function =      -0.745609078488
              le_mean =     -22.662474928422
             les_mean =     514.037394561778
             stat err =       0.000542419265
             autocorr =       1.308729365658
   target nu stat err =       0.000542419265
   target dn stat err =       0.002805575348
      target stat err =       0.002431246233
              std dev =       0.670540755845
             le_variance =       0.449624905249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448976134081
                                         uncertainty =       0.002790696591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448976134081
                                         uncertainty =       0.002790696591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473838866
  error estimate for blocks of size 2^( 2) =       0.000497887160
  error estimate for blocks of size 2^( 3) =       0.000519460617
  error estimate for blocks of size 2^( 4) =       0.000534358673
  error estimate for blocks of size 2^( 5) =       0.000542795326
  error estimate for blocks of size 2^( 6) =       0.000546829599
  error estimate for blocks of size 2^( 7) =       0.000546194799

      target function =      -0.746095178151
              le_mean =     -22.662425723183
             les_mean =     514.034585976172
             stat err =       0.000542544599
             autocorr =       1.311020639835
   target nu stat err =       0.000542544599
   target dn stat err =       0.002800106409
      target stat err =       0.002429726089
              std dev =       0.670109350725
             le_variance =       0.449046541930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448548649580
                                         uncertainty =       0.002786979697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448548649580
                                         uncertainty =       0.002786979697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473613419
  error estimate for blocks of size 2^( 2) =       0.000497809513
  error estimate for blocks of size 2^( 3) =       0.000519540890
  error estimate for blocks of size 2^( 4) =       0.000534549189
  error estimate for blocks of size 2^( 5) =       0.000543026853
  error estimate for blocks of size 2^( 6) =       0.000547084660
  error estimate for blocks of size 2^( 7) =       0.000546449521

      target function =      -0.746454293780
              le_mean =     -22.662414753932
             les_mean =     514.033661596185
             stat err =       0.000542777556
             autocorr =       1.313396225658
   target nu stat err =       0.000542777556
   target dn stat err =       0.002795112911
      target stat err =       0.002427954487
              std dev =       0.669790520437
             le_variance =       0.448619341267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746498039286        initial  <--
     6.2500e-01     6.2500e+00             1.0248e-02        -0.745609078488
     2.5000e+00     2.5000e+01             2.6159e-03        -0.746095178151
     1.0000e+01     1.0000e+02             6.5724e-04        -0.746454293780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4401
  </log>
  <optVariables href="FORM2.s002.opt.xml">
 uu_0                 2.838285e-01 1 1  ON 0
 uu_1                 1.229802e-01 1 1  ON 1
 uu_2                 2.240670e-02 1 1  ON 2
 uu_3                -3.875278e-02 1 1  ON 3
 uu_4                -7.679767e-02 1 1  ON 4
 uu_5                -1.029714e-01 1 1  ON 5
 uu_6                -1.217339e-01 1 1  ON 6
 uu_7                -1.319488e-01 1 1  ON 7
 uu_8                -1.317943e-01 1 1  ON 8
 uu_9                -1.063525e-01 1 1  ON 9
 ud_0                 3.457192e-01 1 1  ON 10
 ud_1                 1.052485e-01 1 1  ON 11
 ud_2                -1.430795e-02 1 1  ON 12
 ud_3                -7.733787e-02 1 1  ON 13
 ud_4                -1.129768e-01 1 1  ON 14
 ud_5                -1.341980e-01 1 1  ON 15
 ud_6                -1.459706e-01 1 1  ON 16
 ud_7                -1.467668e-01 1 1  ON 17
 ud_8                -1.353446e-01 1 1  ON 18
 ud_9                -9.979960e-02 1 1  ON 19
 eC_0                -5.035346e-01 1 1  ON 20
 eC_1                -3.822443e-01 1 1  ON 21
 eC_2                -1.704507e-01 1 1  ON 22
 eC_3                -4.729236e-02 1 1  ON 23
 eC_4                 8.813391e-04 1 1  ON 24
 eC_5                 1.116244e-01 1 1  ON 25
 eC_6                 2.467101e-01 1 1  ON 26
 eC_7                 3.629271e-01 1 1  ON 27
 eC_8                 2.925289e-01 1 1  ON 28
 eC_9                 8.340562e-02 1 1  ON 29
 eO_0                -1.035141e+00 1 1  ON 30
 eO_1                -7.309603e-01 1 1  ON 31
 eO_2                -3.263967e-01 1 1  ON 32
 eO_3                -2.650518e-02 1 1  ON 33
 eO_4                 1.666288e-01 1 1  ON 34
 eO_5                 3.246626e-01 1 1  ON 35
 eO_6                 3.822653e-01 1 1  ON 36
 eO_7                 4.017781e-01 1 1  ON 37
 eO_8                 3.880267e-01 1 1  ON 38
 eO_9                 3.146025e-01 1 1  ON 39
eH1_0                -2.165007e-01 1 1  ON 40
eH1_1                -1.156702e-01 1 1  ON 41
eH1_2                -7.304446e-02 1 1  ON 42
eH1_3                -5.232404e-02 1 1  ON 43
eH1_4                 1.451939e-02 1 1  ON 44
eH1_5                 6.613054e-02 1 1  ON 45
eH1_6                 9.413167e-02 1 1  ON 46
eH1_7                 5.338010e-02 1 1  ON 47
eH1_8                 7.960651e-03 1 1  ON 48
eH1_9                 4.263916e-02 1 1  ON 49
eH2_0                -2.155786e-01 1 1  ON 50
eH2_1                -1.133050e-01 1 1  ON 51
eH2_2                -7.209675e-02 1 1  ON 52
eH2_3                -5.230570e-02 1 1  ON 53
eH2_4                 1.377868e-02 1 1  ON 54
eH2_5                 6.586834e-02 1 1  ON 55
eH2_6                 9.574905e-02 1 1  ON 56
eH2_7                 6.230382e-02 1 1  ON 57
eH2_8                 2.577671e-02 1 1  ON 58
eH2_9                 5.373355e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2265e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2678e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6029
    reference variance = 0.386231
====================================================
  Execution time = 4.5087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4709e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5373e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447157075124
                                         uncertainty =       0.002651257108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447157075124
                                         uncertainty =       0.002651257108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472803846
  error estimate for blocks of size 2^( 2) =       0.000496679313
  error estimate for blocks of size 2^( 3) =       0.000518664260
  error estimate for blocks of size 2^( 4) =       0.000533927778
  error estimate for blocks of size 2^( 5) =       0.000542890446
  error estimate for blocks of size 2^( 6) =       0.000547657261
  error estimate for blocks of size 2^( 7) =       0.000550858555

      target function =      -0.747758215120
              le_mean =     -22.660925786475
             les_mean =     513.964644230587
             stat err =       0.000543833510
             autocorr =       1.323030716088
   target nu stat err =       0.000543833510
   target dn stat err =       0.002675913318
      target stat err =       0.002334050090
              std dev =       0.668645611669
             le_variance =       0.447086954005


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266092578647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747764559518       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747764798341       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747764890245       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747765000170       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747765028678       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747765089206       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747765119817       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747765146015       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747765164330       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747765147596       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747765171001       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747765197989       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747765238541       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747765264403       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747765296143       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747765293318       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747765347810       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747765370452       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747765378293       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747765383017       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747765387115       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747765403563       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747765407808       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747765413623       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747765417480       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747765419276       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747765417873       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747765418686       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747765416260       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747765415659       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 8.530691e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747764559518       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747764619644       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747764642833       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747764670485       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747764677632       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747764692800       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747764700535       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747764707089       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747764711672       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747764707577       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747764713338       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747764720386       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747764730417       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747764736881       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747764744596       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747764744229       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747764757914       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747764763272       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747764765268       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747764766424       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747764767464       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747764771565       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747764772611       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747764774049       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747764774991       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747764775434       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747764775082       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747764775281       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747764774678       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747764774534       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 2.139410e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747764559518       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747764574576       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747764580387       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747764587311       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747764589099       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747764592893       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747764594832       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747764596470       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747764597617       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747764596599       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747764598033       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747764599817       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747764602316       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747764603931       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747764605846       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747764605778       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747764609202       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747764610521       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747764611022       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747764611310       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747764611571       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747764612595       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747764612856       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747764613214       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747764613448       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747764613558       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747764613470       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747764613520       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747764613369       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747764613334       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+02 is 5.352756e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167749 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0506e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
 uu_0                 2.838315e-01 1 1  ON 0
 uu_1                 1.229797e-01 1 1  ON 1
 uu_2                 2.240673e-02 1 1  ON 2
 uu_3                -3.875324e-02 1 1  ON 3
 uu_4                -7.679797e-02 1 1  ON 4
 uu_5                -1.029694e-01 1 1  ON 5
 uu_6                -1.217285e-01 1 1  ON 6
 uu_7                -1.319382e-01 1 1  ON 7
 uu_8                -1.317813e-01 1 1  ON 8
 uu_9                -1.063460e-01 1 1  ON 9
 ud_0                 3.457206e-01 1 1  ON 10
 ud_1                 1.052484e-01 1 1  ON 11
 ud_2                -1.430709e-02 1 1  ON 12
 ud_3                -7.733557e-02 1 1  ON 13
 ud_4                -1.129748e-01 1 1  ON 14
 ud_5                -1.341958e-01 1 1  ON 15
 ud_6                -1.459661e-01 1 1  ON 16
 ud_7                -1.467615e-01 1 1  ON 17
 ud_8                -1.353434e-01 1 1  ON 18
 ud_9                -9.979992e-02 1 1  ON 19
 eC_0                -5.035302e-01 1 1  ON 20
 eC_1                -3.822414e-01 1 1  ON 21
 eC_2                -1.704435e-01 1 1  ON 22
 eC_3                -4.728926e-02 1 1  ON 23
 eC_4                 8.789210e-04 1 1  ON 24
 eC_5                 1.116171e-01 1 1  ON 25
 eC_6                 2.467020e-01 1 1  ON 26
 eC_7                 3.629186e-01 1 1  ON 27
 eC_8                 2.925352e-01 1 1  ON 28
 eC_9                 8.340754e-02 1 1  ON 29
 eO_0                -1.035131e+00 1 1  ON 30
 eO_1                -7.309484e-01 1 1  ON 31
 eO_2                -3.263847e-01 1 1  ON 32
 eO_3                -2.649696e-02 1 1  ON 33
 eO_4                 1.666303e-01 1 1  ON 34
 eO_5                 3.246560e-01 1 1  ON 35
 eO_6                 3.822439e-01 1 1  ON 36
 eO_7                 4.017617e-01 1 1  ON 37
 eO_8                 3.880216e-01 1 1  ON 38
 eO_9                 3.146048e-01 1 1  ON 39
eH1_0                -2.165009e-01 1 1  ON 40
eH1_1                -1.156713e-01 1 1  ON 41
eH1_2                -7.304854e-02 1 1  ON 42
eH1_3                -5.232778e-02 1 1  ON 43
eH1_4                 1.451488e-02 1 1  ON 44
eH1_5                 6.612696e-02 1 1  ON 45
eH1_6                 9.412881e-02 1 1  ON 46
eH1_7                 5.339128e-02 1 1  ON 47
eH1_8                 7.972681e-03 1 1  ON 48
eH1_9                 4.263499e-02 1 1  ON 49
eH2_0                -2.155751e-01 1 1  ON 50
eH2_1                -1.132995e-01 1 1  ON 51
eH2_2                -7.209545e-02 1 1  ON 52
eH2_3                -5.230471e-02 1 1  ON 53
eH2_4                 1.377800e-02 1 1  ON 54
eH2_5                 6.586421e-02 1 1  ON 55
eH2_6                 9.574487e-02 1 1  ON 56
eH2_7                 6.230235e-02 1 1  ON 57
eH2_8                 2.577661e-02 1 1  ON 58
eH2_9                 5.372796e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.725
    reference variance = 0.449336
====================================================
  Execution time = 4.3841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.7275e-01
  Total weights = 2.0000e+06
  Execution time = 3.6643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472811701413
                                         uncertainty =       0.012429941084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472811701413
                                         uncertainty =       0.012429941084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486183225
  error estimate for blocks of size 2^( 2) =       0.000509400558
  error estimate for blocks of size 2^( 3) =       0.000530585821
  error estimate for blocks of size 2^( 4) =       0.000546323805
  error estimate for blocks of size 2^( 5) =       0.000556181058
  error estimate for blocks of size 2^( 6) =       0.000560486795
  error estimate for blocks of size 2^( 7) =       0.000563560348

      target function =      -0.726567190748
              le_mean =     -22.662407189838
             les_mean =     514.057447658833
             stat err =       0.000556638001
             autocorr =       1.310828161944
   target nu stat err =       0.000556638001
   target dn stat err =       0.013026315869
      target stat err =       0.010394806388
              std dev =       0.687566911052
             le_variance =       0.472748257174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472810464856
                                         uncertainty =       0.012429391404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472810464856
                                         uncertainty =       0.012429391404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486182590
  error estimate for blocks of size 2^( 2) =       0.000509399823
  error estimate for blocks of size 2^( 3) =       0.000530585036
  error estimate for blocks of size 2^( 4) =       0.000546323305
  error estimate for blocks of size 2^( 5) =       0.000556180599
  error estimate for blocks of size 2^( 6) =       0.000560486496
  error estimate for blocks of size 2^( 7) =       0.000563560036

      target function =      -0.726568181423
              le_mean =     -22.662407314221
             les_mean =     514.057452061034
             stat err =       0.000556637609
             autocorr =       1.310829739183
   target nu stat err =       0.000556637609
   target dn stat err =       0.013025785847
      target stat err =       0.010394414953
              std dev =       0.687566012649
             le_variance =       0.472747021750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472811084654
                                         uncertainty =       0.012429665156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472811084654
                                         uncertainty =       0.012429665156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486182908
  error estimate for blocks of size 2^( 2) =       0.000509400191
  error estimate for blocks of size 2^( 3) =       0.000530585428
  error estimate for blocks of size 2^( 4) =       0.000546323555
  error estimate for blocks of size 2^( 5) =       0.000556180828
  error estimate for blocks of size 2^( 6) =       0.000560486645
  error estimate for blocks of size 2^( 7) =       0.000563560192

      target function =      -0.726567684912
              le_mean =     -22.662407251737
             les_mean =     514.057449848189
             stat err =       0.000556637805
             autocorr =       1.310828946618
   target nu stat err =       0.000556637805
   target dn stat err =       0.013026049839
      target stat err =       0.010394609822
              std dev =       0.687566462954
             le_variance =       0.472747640979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472811624193
                                         uncertainty =       0.012429906558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472811624193
                                         uncertainty =       0.012429906558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486183186
  error estimate for blocks of size 2^( 2) =       0.000509400512
  error estimate for blocks of size 2^( 3) =       0.000530585772
  error estimate for blocks of size 2^( 4) =       0.000546323773
  error estimate for blocks of size 2^( 5) =       0.000556181029
  error estimate for blocks of size 2^( 6) =       0.000560486776
  error estimate for blocks of size 2^( 7) =       0.000563560328

      target function =      -0.726567252621
              le_mean =     -22.662407197519
             les_mean =     514.057447929811
             stat err =       0.000556637977
             autocorr =       1.310828259702
   target nu stat err =       0.000556637977
   target dn stat err =       0.013026282583
      target stat err =       0.010394781794
              std dev =       0.687566854949
             le_variance =       0.472748180024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.726567190748        initial
     6.2500e+00     6.2500e+01             8.5307e-05        -0.726568181423  <--
     2.5000e+01     2.5000e+02             2.1394e-05        -0.726567684912
     1.0000e+02     1.0000e+03             5.3528e-06        -0.726567252621

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 6.6037e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2655e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2675e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6622
    reference variance = 0.330107
====================================================
  Execution time = 4.6318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4670e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5560e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446728656049
                                         uncertainty =       0.002781683822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446728656049
                                         uncertainty =       0.002781683822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472601409
  error estimate for blocks of size 2^( 2) =       0.000496635203
  error estimate for blocks of size 2^( 3) =       0.000517969959
  error estimate for blocks of size 2^( 4) =       0.000534260469
  error estimate for blocks of size 2^( 5) =       0.000542149262
  error estimate for blocks of size 2^( 6) =       0.000547204216
  error estimate for blocks of size 2^( 7) =       0.000549261381

      target function =      -0.748071052587
              le_mean =     -22.661844907714
             les_mean =     514.005918581081
             stat err =       0.000543218832
             autocorr =       1.321172758976
   target nu stat err =       0.000543218832
   target dn stat err =       0.003131222704
      target stat err =       0.002711550665
              std dev =       0.668359321886
             le_variance =       0.446704183151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266184490771e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748079854597       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748080638572       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748081225121       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748081395309       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748081644728       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748081813562       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748081932787       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748082039317       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748082065574       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748082045010       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748082037454       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748082175384       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748082235356       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748082420657       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748082585477       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748082740699       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748082815659       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748082892411       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748082920975       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748082954035       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748083022378       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748083068077       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748083050267       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748083059223       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748083050217       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748083058355       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748083049287       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748083047462       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748083048366       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748083048169       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748083051967       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 2.207906e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748079854597       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748080055926       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748080206783       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748080250473       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748080315399       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748080358116       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748080388108       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748080415327       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748080422447       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748080416658       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748080414926       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748080449810       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748080465037       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748080511787       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748080552802       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748080591538       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748080611166       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748080630755       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748080637793       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748080645500       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748080662594       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748080673756       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748080669000       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748080671236       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748080669089       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748080670936       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748080668701       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748080668201       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748080668404       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748080668418       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 5.575058e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748079854597       residual = 5.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748079905274       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748079943261       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748079954259       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748079970657       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748079981368       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748079988878       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748079995720       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748079997536       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748079996046       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748079995625       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748080004373       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748080008193       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748080019906       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748080030146       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748080039829       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748080044794       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748080049712       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748080051465       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748080053356       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748080057630       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748080060403       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748080059195       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748080059754       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748080059224       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748080059674       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748080059117       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748080058990       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748080059039       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748080059046       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+01 is 1.398698e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1927e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
 uu_0                 2.838445e-01 1 1  ON 0
 uu_1                 1.229735e-01 1 1  ON 1
 uu_2                 2.240192e-02 1 1  ON 2
 uu_3                -3.876042e-02 1 1  ON 3
 uu_4                -7.680555e-02 1 1  ON 4
 uu_5                -1.029682e-01 1 1  ON 5
 uu_6                -1.217098e-01 1 1  ON 6
 uu_7                -1.318821e-01 1 1  ON 7
 uu_8                -1.316986e-01 1 1  ON 8
 uu_9                -1.062810e-01 1 1  ON 9
 ud_0                 3.457451e-01 1 1  ON 10
 ud_1                 1.052600e-01 1 1  ON 11
 ud_2                -1.429394e-02 1 1  ON 12
 ud_3                -7.731889e-02 1 1  ON 13
 ud_4                -1.129554e-01 1 1  ON 14
 ud_5                -1.341706e-01 1 1  ON 15
 ud_6                -1.459298e-01 1 1  ON 16
 ud_7                -1.467289e-01 1 1  ON 17
 ud_8                -1.353489e-01 1 1  ON 18
 ud_9                -9.981015e-02 1 1  ON 19
 eC_0                -5.035212e-01 1 1  ON 20
 eC_1                -3.822210e-01 1 1  ON 21
 eC_2                -1.704068e-01 1 1  ON 22
 eC_3                -4.726720e-02 1 1  ON 23
 eC_4                 8.819224e-04 1 1  ON 24
 eC_5                 1.115598e-01 1 1  ON 25
 eC_6                 2.466366e-01 1 1  ON 26
 eC_7                 3.628896e-01 1 1  ON 27
 eC_8                 2.925774e-01 1 1  ON 28
 eC_9                 8.342425e-02 1 1  ON 29
 eO_0                -1.035091e+00 1 1  ON 30
 eO_1                -7.308839e-01 1 1  ON 31
 eO_2                -3.263115e-01 1 1  ON 32
 eO_3                -2.644181e-02 1 1  ON 33
 eO_4                 1.666555e-01 1 1  ON 34
 eO_5                 3.246263e-01 1 1  ON 35
 eO_6                 3.821243e-01 1 1  ON 36
 eO_7                 4.016781e-01 1 1  ON 37
 eO_8                 3.879585e-01 1 1  ON 38
 eO_9                 3.146122e-01 1 1  ON 39
eH1_0                -2.165240e-01 1 1  ON 40
eH1_1                -1.156994e-01 1 1  ON 41
eH1_2                -7.305377e-02 1 1  ON 42
eH1_3                -5.233562e-02 1 1  ON 43
eH1_4                 1.451110e-02 1 1  ON 44
eH1_5                 6.610683e-02 1 1  ON 45
eH1_6                 9.412493e-02 1 1  ON 46
eH1_7                 5.344565e-02 1 1  ON 47
eH1_8                 8.019159e-03 1 1  ON 48
eH1_9                 4.260957e-02 1 1  ON 49
eH2_0                -2.155381e-01 1 1  ON 50
eH2_1                -1.133004e-01 1 1  ON 51
eH2_2                -7.210666e-02 1 1  ON 52
eH2_3                -5.230670e-02 1 1  ON 53
eH2_4                 1.377482e-02 1 1  ON 54
eH2_5                 6.582827e-02 1 1  ON 55
eH2_6                 9.572163e-02 1 1  ON 56
eH2_7                 6.229615e-02 1 1  ON 57
eH2_8                 2.581427e-02 1 1  ON 58
eH2_9                 5.370631e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7319
    reference variance = 0.271044
====================================================
  Execution time = 4.4154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5069e-01
  Total weights = 2.0000e+06
  Execution time = 3.6727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450741625516
                                         uncertainty =       0.003461051258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450741625516
                                         uncertainty =       0.003461051258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474707009
  error estimate for blocks of size 2^( 2) =       0.000498262164
  error estimate for blocks of size 2^( 3) =       0.000519801423
  error estimate for blocks of size 2^( 4) =       0.000534615336
  error estimate for blocks of size 2^( 5) =       0.000542107003
  error estimate for blocks of size 2^( 6) =       0.000546059288
  error estimate for blocks of size 2^( 7) =       0.000548394008

      target function =      -0.744702549123
              le_mean =     -22.662876064027
             les_mean =     514.056644756513
             stat err =       0.000542793909
             autocorr =       1.307430592368
   target nu stat err =       0.000542793909
   target dn stat err =       0.003657084637
      target stat err =       0.003122336588
              std dev =       0.671337090007
             le_variance =       0.450693488419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450747779431
                                         uncertainty =       0.003461982279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450747779431
                                         uncertainty =       0.003461982279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474710234
  error estimate for blocks of size 2^( 2) =       0.000498260567
  error estimate for blocks of size 2^( 3) =       0.000519796486
  error estimate for blocks of size 2^( 4) =       0.000534608426
  error estimate for blocks of size 2^( 5) =       0.000542098428
  error estimate for blocks of size 2^( 6) =       0.000546049463
  error estimate for blocks of size 2^( 7) =       0.000548385722

      target function =      -0.744697418171
              le_mean =     -22.662875896167
             les_mean =     514.056643271965
             stat err =       0.000542785510
             autocorr =       1.307372367723
   target nu stat err =       0.000542785510
   target dn stat err =       0.003657962917
      target stat err =       0.003123012973
              std dev =       0.671341650920
             le_variance =       0.450699612260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450744816209
                                         uncertainty =       0.003461533529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450744816209
                                         uncertainty =       0.003461533529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474708681
  error estimate for blocks of size 2^( 2) =       0.000498261342
  error estimate for blocks of size 2^( 3) =       0.000519798871
  error estimate for blocks of size 2^( 4) =       0.000534611756
  error estimate for blocks of size 2^( 5) =       0.000542102562
  error estimate for blocks of size 2^( 6) =       0.000546054191
  error estimate for blocks of size 2^( 7) =       0.000548389706

      target function =      -0.744699888700
              le_mean =     -22.662875972301
             les_mean =     514.056643774277
             stat err =       0.000542789554
             autocorr =       1.307400401089
   target nu stat err =       0.000542789554
   target dn stat err =       0.003657539855
      target stat err =       0.003122687133
              std dev =       0.671339454922
             le_variance =       0.450696663735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450742025123
                                         uncertainty =       0.003461111999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450742025123
                                         uncertainty =       0.003461111999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474707218
  error estimate for blocks of size 2^( 2) =       0.000498262059
  error estimate for blocks of size 2^( 3) =       0.000519801100
  error estimate for blocks of size 2^( 4) =       0.000534614883
  error estimate for blocks of size 2^( 5) =       0.000542106442
  error estimate for blocks of size 2^( 6) =       0.000546058643
  error estimate for blocks of size 2^( 7) =       0.000548393463

      target function =      -0.744702215944
              le_mean =     -22.662876051590
             les_mean =     514.056644590491
             stat err =       0.000542793358
             autocorr =       1.307426785606
   target nu stat err =       0.000542793358
   target dn stat err =       0.003657141973
      target stat err =       0.003122380752
              std dev =       0.671337386188
             le_variance =       0.450693886094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744702549123        initial  <--
     1.5625e+00     1.5625e+01             2.2079e-04        -0.744697418171
     6.2500e+00     6.2500e+01             5.5751e-05        -0.744699888700
     2.5000e+01     2.5000e+02             1.3987e-05        -0.744702215944

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.5267
  </log>
  <optVariables href="FORM2.s004.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2446e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2679e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6795
    reference variance = 0.327497
====================================================
  Execution time = 4.4599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5492e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5628e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454901979829
                                         uncertainty =       0.003857790166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454901979829
                                         uncertainty =       0.003857790166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476927623
  error estimate for blocks of size 2^( 2) =       0.000500699364
  error estimate for blocks of size 2^( 3) =       0.000522751232
  error estimate for blocks of size 2^( 4) =       0.000539271982
  error estimate for blocks of size 2^( 5) =       0.000546633025
  error estimate for blocks of size 2^( 6) =       0.000551896806
  error estimate for blocks of size 2^( 7) =       0.000552927631

      target function =      -0.741192255205
              le_mean =     -22.662117129307
             les_mean =     514.026472469316
             stat err =       0.000547682361
             autocorr =       1.318719883913
   target nu stat err =       0.000547682361
   target dn stat err =       0.004127083092
      target stat err =       0.003473612916
              std dev =       0.674477512124
             le_variance =       0.454919914361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266211712931e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741207624562       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741207766141       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741207827678       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741207882528       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741207911338       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741207948539       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741207962182       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741207994025       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741208001680       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741208015451       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741208003787       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741208020342       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741208019021       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741208039795       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741208052086       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741208052521       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741208068536       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741208069593       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741208075476       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741208075470       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741208077905       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741208085942       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741208090678       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741208093064       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741208092187       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741208092545       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741208093219       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741208093468       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741208092161       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741208092233       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741208092496       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 2.274586e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741207624562       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741207660056       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741207675471       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741207689238       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741207696445       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741207705746       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741207709165       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741207717150       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741207719063       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741207722500       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741207719586       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741207723733       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741207723396       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741207728595       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741207731667       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741207731782       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741207735800       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741207736039       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741207737518       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741207737511       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741207738139       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741207740134       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741207741314       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741207741906       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741207741686       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741207741774       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741207741943       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741207742005       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741207741679       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741207741697       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741207741762       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+01 is 5.692512e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741207624562       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741207633442       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741207637298       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741207640743       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741207642545       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741207644870       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741207645726       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741207647723       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741207648201       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741207649060       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741207648332       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741207649369       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741207649284       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741207650585       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741207651353       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741207651382       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741207652388       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741207652445       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741207652815       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741207652814       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741207652972       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741207653468       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741207653764       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741207653912       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741207653857       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741207653879       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741207653921       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741207653936       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741207653854       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741207653859       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741207653876       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+02 is 1.423506e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0267e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
 uu_0                 2.838428e-01 1 1  ON 0
 uu_1                 1.229795e-01 1 1  ON 1
 uu_2                 2.240747e-02 1 1  ON 2
 uu_3                -3.875418e-02 1 1  ON 3
 uu_4                -7.679841e-02 1 1  ON 4
 uu_5                -1.029619e-01 1 1  ON 5
 uu_6                -1.217109e-01 1 1  ON 6
 uu_7                -1.319038e-01 1 1  ON 7
 uu_8                -1.317386e-01 1 1  ON 8
 uu_9                -1.063250e-01 1 1  ON 9
 ud_0                 3.457265e-01 1 1  ON 10
 ud_1                 1.052491e-01 1 1  ON 11
 ud_2                -1.430301e-02 1 1  ON 12
 ud_3                -7.732636e-02 1 1  ON 13
 ud_4                -1.129662e-01 1 1  ON 14
 ud_5                -1.341861e-01 1 1  ON 15
 ud_6                -1.459497e-01 1 1  ON 16
 ud_7                -1.467440e-01 1 1  ON 17
 ud_8                -1.353384e-01 1 1  ON 18
 ud_9                -9.980342e-02 1 1  ON 19
 eC_0                -5.035158e-01 1 1  ON 20
 eC_1                -3.822299e-01 1 1  ON 21
 eC_2                -1.704181e-01 1 1  ON 22
 eC_3                -4.727739e-02 1 1  ON 23
 eC_4                 8.699187e-04 1 1  ON 24
 eC_5                 1.115916e-01 1 1  ON 25
 eC_6                 2.466740e-01 1 1  ON 26
 eC_7                 3.628894e-01 1 1  ON 27
 eC_8                 2.925557e-01 1 1  ON 28
 eC_9                 8.341412e-02 1 1  ON 29
 eO_0                -1.035095e+00 1 1  ON 30
 eO_1                -7.309076e-01 1 1  ON 31
 eO_2                -3.263441e-01 1 1  ON 32
 eO_3                -2.647097e-02 1 1  ON 33
 eO_4                 1.666306e-01 1 1  ON 34
 eO_5                 3.246309e-01 1 1  ON 35
 eO_6                 3.821777e-01 1 1  ON 36
 eO_7                 4.017106e-01 1 1  ON 37
 eO_8                 3.880016e-01 1 1  ON 38
 eO_9                 3.146115e-01 1 1  ON 39
eH1_0                -2.165011e-01 1 1  ON 40
eH1_1                -1.156724e-01 1 1  ON 41
eH1_2                -7.305977e-02 1 1  ON 42
eH1_3                -5.234020e-02 1 1  ON 43
eH1_4                 1.449966e-02 1 1  ON 44
eH1_5                 6.611477e-02 1 1  ON 45
eH1_6                 9.411982e-02 1 1  ON 46
eH1_7                 5.342739e-02 1 1  ON 47
eH1_8                 8.008224e-03 1 1  ON 48
eH1_9                 4.262046e-02 1 1  ON 49
eH2_0                -2.155591e-01 1 1  ON 50
eH2_1                -1.132818e-01 1 1  ON 51
eH2_2                -7.209134e-02 1 1  ON 52
eH2_3                -5.230395e-02 1 1  ON 53
eH2_4                 1.377401e-02 1 1  ON 54
eH2_5                 6.585051e-02 1 1  ON 55
eH2_6                 9.573238e-02 1 1  ON 56
eH2_7                 6.229755e-02 1 1  ON 57
eH2_8                 2.577600e-02 1 1  ON 58
eH2_9                 5.370927e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6127
    reference variance = 0.667245
====================================================
  Execution time = 4.4018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5572e-01
  Total weights = 2.0000e+06
  Execution time = 3.6701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455800941303
                                         uncertainty =       0.003036141418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455800941303
                                         uncertainty =       0.003036141418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477348682
  error estimate for blocks of size 2^( 2) =       0.000500432464
  error estimate for blocks of size 2^( 3) =       0.000521853110
  error estimate for blocks of size 2^( 4) =       0.000536816840
  error estimate for blocks of size 2^( 5) =       0.000546121239
  error estimate for blocks of size 2^( 6) =       0.000550848702
  error estimate for blocks of size 2^( 7) =       0.000551468235

      target function =      -0.740529180445
              le_mean =     -22.662371727764
             les_mean =     514.038815628197
             stat err =       0.000546313754
             autocorr =       1.309823605477
   target nu stat err =       0.000546313754
   target dn stat err =       0.003069325175
      target stat err =       0.002611623538
              std dev =       0.675072980263
             le_variance =       0.455723528681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455802715264
                                         uncertainty =       0.003036166576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455802715264
                                         uncertainty =       0.003036166576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477349610
  error estimate for blocks of size 2^( 2) =       0.000500433656
  error estimate for blocks of size 2^( 3) =       0.000521854651
  error estimate for blocks of size 2^( 4) =       0.000536818749
  error estimate for blocks of size 2^( 5) =       0.000546123290
  error estimate for blocks of size 2^( 6) =       0.000550850823
  error estimate for blocks of size 2^( 7) =       0.000551470574

      target function =      -0.740527713371
              le_mean =     -22.662371768563
             les_mean =     514.038819249654
             stat err =       0.000546315859
             autocorr =       1.309828606668
   target nu stat err =       0.000546315859
   target dn stat err =       0.003069332118
      target stat err =       0.002611619768
              std dev =       0.675074292914
             le_variance =       0.455725300954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455801831311
                                         uncertainty =       0.003036154054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455801831311
                                         uncertainty =       0.003036154054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477349148
  error estimate for blocks of size 2^( 2) =       0.000500433062
  error estimate for blocks of size 2^( 3) =       0.000521853883
  error estimate for blocks of size 2^( 4) =       0.000536817797
  error estimate for blocks of size 2^( 5) =       0.000546122268
  error estimate for blocks of size 2^( 6) =       0.000550849765
  error estimate for blocks of size 2^( 7) =       0.000551469408

      target function =      -0.740528444407
              le_mean =     -22.662371748107
             les_mean =     514.038817439370
             stat err =       0.000546314809
             autocorr =       1.309826110762
   target nu stat err =       0.000546314809
   target dn stat err =       0.003069328674
      target stat err =       0.002611621658
              std dev =       0.675073638828
             le_variance =       0.455724417840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455801052616
                                         uncertainty =       0.003036142999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455801052616
                                         uncertainty =       0.003036142999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477348740
  error estimate for blocks of size 2^( 2) =       0.000500432539
  error estimate for blocks of size 2^( 3) =       0.000521853207
  error estimate for blocks of size 2^( 4) =       0.000536816960
  error estimate for blocks of size 2^( 5) =       0.000546121368
  error estimate for blocks of size 2^( 6) =       0.000550848835
  error estimate for blocks of size 2^( 7) =       0.000551468381

      target function =      -0.740529088389
              le_mean =     -22.662371730297
             les_mean =     514.038815854180
             stat err =       0.000546313886
             autocorr =       1.309823918759
   target nu stat err =       0.000546313886
   target dn stat err =       0.003069325613
      target stat err =       0.002611623303
              std dev =       0.675073062629
             le_variance =       0.455723639887


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740529180445        initial  <--
     1.5625e+01     1.5625e+02             2.2746e-05        -0.740527713371
     6.2500e+01     6.2500e+02             5.6925e-06        -0.740528444407
     2.5000e+02     2.5000e+03             1.4235e-06        -0.740529088389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4227
  </log>
  <optVariables href="FORM2.s005.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2270e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2674e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6129
    reference variance = 0.367334
====================================================
  Execution time = 4.6601e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5019e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5353e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450197284830
                                         uncertainty =       0.003002025528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450197284830
                                         uncertainty =       0.003002025528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474440009
  error estimate for blocks of size 2^( 2) =       0.000498041783
  error estimate for blocks of size 2^( 3) =       0.000519641020
  error estimate for blocks of size 2^( 4) =       0.000534658517
  error estimate for blocks of size 2^( 5) =       0.000543838694
  error estimate for blocks of size 2^( 6) =       0.000548372681
  error estimate for blocks of size 2^( 7) =       0.000551228368

      target function =      -0.745136648012
              le_mean =     -22.662424163732
             les_mean =     514.035655396904
             stat err =       0.000544524565
             autocorr =       1.317262539694
   target nu stat err =       0.000544524565
   target dn stat err =       0.003202181363
      target stat err =       0.002751468333
              std dev =       0.670959495858
             le_variance =       0.450186645083


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266242416373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745145882605       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745145891427       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745145896159       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745145900954       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745145906181       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745145908488       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745145910256       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745145912506       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745145912760       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745145913289       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745145914699       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745145915107       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745145916557       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745145916252       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745145917936       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745145918858       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745145919353       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745145919792       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745145920291       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745145920675       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745145920626       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745145920590       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745145920249       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745145920070       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745145920398       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745145920727       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745145920632       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745145920798       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745145920849       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745145920821       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 2.417411e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745145882605       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745145884811       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745145885994       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745145887194       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745145888500       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745145889077       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745145889519       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745145890082       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745145890145       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745145890277       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745145890631       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745145890733       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745145891093       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745145891018       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745145891440       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745145891670       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745145891793       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745145891903       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745145892028       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745145892124       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745145892111       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745145892105       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745145892018       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745145891972       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745145892055       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745145892138       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745145892114       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745145892155       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745145892167       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745145892160       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+02 is 6.044272e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745145882605       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745145883156       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745145883452       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745145883752       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745145884079       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745145884224       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745145884342       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745145884474       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745145884490       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745145884520       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745145884609       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745145884637       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745145884719       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745145884711       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745145884815       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745145884871       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745145884902       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745145884922       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745145884967       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745145884989       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745145884980       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745145884974       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745145884964       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745145884941       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745145884966       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745145884972       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745145884986       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745145884995       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745145884995       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745145884992       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+03 is 1.511114e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1992e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
 uu_0                 2.838406e-01 1 1  ON 0
 uu_1                 1.229784e-01 1 1  ON 1
 uu_2                 2.240687e-02 1 1  ON 2
 uu_3                -3.875456e-02 1 1  ON 3
 uu_4                -7.679885e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217121e-01 1 1  ON 6
 uu_7                -1.319061e-01 1 1  ON 7
 uu_8                -1.317417e-01 1 1  ON 8
 uu_9                -1.063262e-01 1 1  ON 9
 ud_0                 3.457252e-01 1 1  ON 10
 ud_1                 1.052483e-01 1 1  ON 11
 ud_2                -1.430435e-02 1 1  ON 12
 ud_3                -7.732853e-02 1 1  ON 13
 ud_4                -1.129685e-01 1 1  ON 14
 ud_5                -1.341888e-01 1 1  ON 15
 ud_6                -1.459522e-01 1 1  ON 16
 ud_7                -1.467457e-01 1 1  ON 17
 ud_8                -1.353397e-01 1 1  ON 18
 ud_9                -9.980108e-02 1 1  ON 19
 eC_0                -5.035172e-01 1 1  ON 20
 eC_1                -3.822329e-01 1 1  ON 21
 eC_2                -1.704216e-01 1 1  ON 22
 eC_3                -4.727980e-02 1 1  ON 23
 eC_4                 8.716118e-04 1 1  ON 24
 eC_5                 1.115948e-01 1 1  ON 25
 eC_6                 2.466775e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925544e-01 1 1  ON 28
 eC_9                 8.341338e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309127e-01 1 1  ON 31
 eO_2                -3.263484e-01 1 1  ON 32
 eO_3                -2.647205e-02 1 1  ON 33
 eO_4                 1.666345e-01 1 1  ON 34
 eO_5                 3.246360e-01 1 1  ON 35
 eO_6                 3.821794e-01 1 1  ON 36
 eO_7                 4.017123e-01 1 1  ON 37
 eO_8                 3.880060e-01 1 1  ON 38
 eO_9                 3.146118e-01 1 1  ON 39
eH1_0                -2.165014e-01 1 1  ON 40
eH1_1                -1.156745e-01 1 1  ON 41
eH1_2                -7.306072e-02 1 1  ON 42
eH1_3                -5.233923e-02 1 1  ON 43
eH1_4                 1.450119e-02 1 1  ON 44
eH1_5                 6.611602e-02 1 1  ON 45
eH1_6                 9.412031e-02 1 1  ON 46
eH1_7                 5.342488e-02 1 1  ON 47
eH1_8                 8.008733e-03 1 1  ON 48
eH1_9                 4.262249e-02 1 1  ON 49
eH2_0                -2.155648e-01 1 1  ON 50
eH2_1                -1.132832e-01 1 1  ON 51
eH2_2                -7.209154e-02 1 1  ON 52
eH2_3                -5.230181e-02 1 1  ON 53
eH2_4                 1.377591e-02 1 1  ON 54
eH2_5                 6.585184e-02 1 1  ON 55
eH2_6                 9.573240e-02 1 1  ON 56
eH2_7                 6.229806e-02 1 1  ON 57
eH2_8                 2.577663e-02 1 1  ON 58
eH2_9                 5.371109e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.684
    reference variance = 0.265689
====================================================
  Execution time = 4.5648e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5655e-01
  Total weights = 2.0000e+06
  Execution time = 3.6649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456617668327
                                         uncertainty =       0.004332490913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456617668327
                                         uncertainty =       0.004332490913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477782116
  error estimate for blocks of size 2^( 2) =       0.000500867201
  error estimate for blocks of size 2^( 3) =       0.000522384841
  error estimate for blocks of size 2^( 4) =       0.000536908164
  error estimate for blocks of size 2^( 5) =       0.000545933456
  error estimate for blocks of size 2^( 6) =       0.000552399671
  error estimate for blocks of size 2^( 7) =       0.000555994437

      target function =      -0.739851238172
              le_mean =     -22.661617246103
             les_mean =     514.005447481312
             stat err =       0.000547808932
             autocorr =       1.314614564835
   target nu stat err =       0.000547808932
   target dn stat err =       0.004408976831
      target stat err =       0.003687778013
              std dev =       0.675685948292
             le_variance =       0.456551500720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456617767304
                                         uncertainty =       0.004332491575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456617767304
                                         uncertainty =       0.004332491575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477782168
  error estimate for blocks of size 2^( 2) =       0.000500867222
  error estimate for blocks of size 2^( 3) =       0.000522384846
  error estimate for blocks of size 2^( 4) =       0.000536908169
  error estimate for blocks of size 2^( 5) =       0.000545933461
  error estimate for blocks of size 2^( 6) =       0.000552399663
  error estimate for blocks of size 2^( 7) =       0.000555994444

      target function =      -0.739851156704
              le_mean =     -22.661617246903
             les_mean =     514.005447616317
             stat err =       0.000547808934
             autocorr =       1.314614289664
   target nu stat err =       0.000547808934
   target dn stat err =       0.004408978977
      target stat err =       0.003687778962
              std dev =       0.675686021349
             le_variance =       0.456551599446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456617717831
                                         uncertainty =       0.004332491244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456617717831
                                         uncertainty =       0.004332491244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477782142
  error estimate for blocks of size 2^( 2) =       0.000500867211
  error estimate for blocks of size 2^( 3) =       0.000522384843
  error estimate for blocks of size 2^( 4) =       0.000536908167
  error estimate for blocks of size 2^( 5) =       0.000545933459
  error estimate for blocks of size 2^( 6) =       0.000552399667
  error estimate for blocks of size 2^( 7) =       0.000555994441

      target function =      -0.739851197425
              le_mean =     -22.661617246502
             les_mean =     514.005447548785
             stat err =       0.000547808933
             autocorr =       1.314614427188
   target nu stat err =       0.000547808933
   target dn stat err =       0.004408977904
      target stat err =       0.003687778487
              std dev =       0.675685984832
             le_variance =       0.456551550099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456617674515
                                         uncertainty =       0.004332490954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456617674515
                                         uncertainty =       0.004332490954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477782119
  error estimate for blocks of size 2^( 2) =       0.000500867202
  error estimate for blocks of size 2^( 3) =       0.000522384841
  error estimate for blocks of size 2^( 4) =       0.000536908165
  error estimate for blocks of size 2^( 5) =       0.000545933456
  error estimate for blocks of size 2^( 6) =       0.000552399670
  error estimate for blocks of size 2^( 7) =       0.000555994438

      target function =      -0.739851233079
              le_mean =     -22.661617246153
             les_mean =     514.005447489741
             stat err =       0.000547808932
             autocorr =       1.314614547616
   target nu stat err =       0.000547808932
   target dn stat err =       0.004408976965
      target stat err =       0.003687778072
              std dev =       0.675685952860
             le_variance =       0.456551506892


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739851238172        initial  <--
     1.5625e+02     1.5625e+03             2.4174e-06        -0.739851156704
     6.2500e+02     6.2500e+03             6.0443e-07        -0.739851197425
     2.5000e+03     2.5000e+04             1.5111e-07        -0.739851233079

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0193
  </log>
  <optVariables href="FORM2.s006.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2602e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6505
    reference variance = 0.393489
====================================================
  Execution time = 4.4449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.7462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5531e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474735977567
                                         uncertainty =       0.022755605151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474735977567
                                         uncertainty =       0.022755605151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487142351
  error estimate for blocks of size 2^( 2) =       0.000510554041
  error estimate for blocks of size 2^( 3) =       0.000531688159
  error estimate for blocks of size 2^( 4) =       0.000547163453
  error estimate for blocks of size 2^( 5) =       0.000556936084
  error estimate for blocks of size 2^( 6) =       0.000561921276
  error estimate for blocks of size 2^( 7) =       0.000562458138

      target function =      -0.724790587749
              le_mean =     -22.662303978750
             les_mean =     514.054636727571
             stat err =       0.000557119738
             autocorr =       1.307932451576
   target nu stat err =       0.000557119738
   target dn stat err =       0.022546113644
      target stat err =       0.017887619256
              std dev =       0.688923319108
             le_variance =       0.474615339610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266230397875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.725233515670       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.725233553545       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.725233571715       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.725233579424       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.725233587070       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.725233591704       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.725233595639       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.725233597873       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.725233599790       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.725233601364       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.725233605216       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.725233605756       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.725233606914       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.725233607737       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.725233608413       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.725233608825       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.725233609240       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.725233609462       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.725233609720       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.725233609981       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.725233610080       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.725233610258       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.725233610321       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.725233610413       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.725233610388       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.725233610393       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.725233610445       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.725233610448       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.725233610466       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.725233610490       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.725233610483       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.725233610480       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.725233610470       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 6.517448e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.725233515670       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.725233525139       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.725233529681       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.725233531610       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.725233533520       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.725233534680       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.725233535679       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.725233536219       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.725233536702       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.725233537088       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.725233538059       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.725233538188       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.725233538486       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.725233538696       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.725233538861       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.725233538959       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.725233539074       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.725233539136       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.725233539167       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.725233539248       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.725233539268       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.725233539319       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.725233539344       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.725233539365       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.725233539346       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.725233539340       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.725233539364       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.725233539364       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.725233539363       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.725233539368       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.725233539370       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.725233539379       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.725233539374       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+03 is 1.629389e-07

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.725233515670       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.725233518037       residual = 9.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.725233519173       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.725233519651       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.725233520140       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.725233520381       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.725233520668       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.725233520818       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.725233520943       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.725233521026       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.725233521246       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.725233521287       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.725233521357       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.725233521441       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.725233521530       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.725233521503       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.725233521489       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.725233521629       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.725233521562       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.725233521535       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.725233521675       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.725233521578       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.725233521630       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.725233521501       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.725233521583       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.725233521561       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.725233521639       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.725233521607       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.725233521624       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.725233521669       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.725233521636       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.725233521626       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.725233521577       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+04 is 4.073489e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304445 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0039e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240678e-02 1 1  ON 2
 uu_3                -3.875463e-02 1 1  ON 3
 uu_4                -7.679890e-02 1 1  ON 4
 uu_5                -1.029634e-01 1 1  ON 5
 uu_6                -1.217122e-01 1 1  ON 6
 uu_7                -1.319063e-01 1 1  ON 7
 uu_8                -1.317420e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052483e-01 1 1  ON 11
 ud_2                -1.430443e-02 1 1  ON 12
 ud_3                -7.732864e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341890e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353399e-01 1 1  ON 18
 ud_9                -9.980095e-02 1 1  ON 19
 eC_0                -5.035172e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727984e-02 1 1  ON 23
 eC_4                 8.718648e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466776e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647233e-02 1 1  ON 33
 eO_4                 1.666347e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017124e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165015e-01 1 1  ON 40
eH1_1                -1.156746e-01 1 1  ON 41
eH1_2                -7.306069e-02 1 1  ON 42
eH1_3                -5.233898e-02 1 1  ON 43
eH1_4                 1.450139e-02 1 1  ON 44
eH1_5                 6.611615e-02 1 1  ON 45
eH1_6                 9.412023e-02 1 1  ON 46
eH1_7                 5.342465e-02 1 1  ON 47
eH1_8                 8.008713e-03 1 1  ON 48
eH1_9                 4.262251e-02 1 1  ON 49
eH2_0                -2.155648e-01 1 1  ON 50
eH2_1                -1.132832e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230174e-02 1 1  ON 53
eH2_4                 1.377602e-02 1 1  ON 54
eH2_5                 6.585195e-02 1 1  ON 55
eH2_6                 9.573240e-02 1 1  ON 56
eH2_7                 6.229800e-02 1 1  ON 57
eH2_8                 2.577627e-02 1 1  ON 58
eH2_9                 5.371121e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6009
    reference variance = 0.344364
====================================================
  Execution time = 4.4330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5096e-01
  Total weights = 2.0000e+06
  Execution time = 3.6726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450969391722
                                         uncertainty =       0.003383590655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450969391722
                                         uncertainty =       0.003383590655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474850019
  error estimate for blocks of size 2^( 2) =       0.000499141647
  error estimate for blocks of size 2^( 3) =       0.000521501855
  error estimate for blocks of size 2^( 4) =       0.000537642046
  error estimate for blocks of size 2^( 5) =       0.000546021102
  error estimate for blocks of size 2^( 6) =       0.000551547792
  error estimate for blocks of size 2^( 7) =       0.000553689534

      target function =      -0.744488738404
              le_mean =     -22.662123377351
             les_mean =     514.022800826204
             stat err =       0.000547225118
             autocorr =       1.328064378603
   target nu stat err =       0.000547225118
   target dn stat err =       0.003328407565
      target stat err =       0.002849170200
              std dev =       0.671539337195
             le_variance =       0.450965081400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450969401285
                                         uncertainty =       0.003383589952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450969401285
                                         uncertainty =       0.003383589952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474850024
  error estimate for blocks of size 2^( 2) =       0.000499141645
  error estimate for blocks of size 2^( 3) =       0.000521501844
  error estimate for blocks of size 2^( 4) =       0.000537642029
  error estimate for blocks of size 2^( 5) =       0.000546021078
  error estimate for blocks of size 2^( 6) =       0.000551547757
  error estimate for blocks of size 2^( 7) =       0.000553689491

      target function =      -0.744488730650
              le_mean =     -22.662123376647
             les_mean =     514.022800803573
             stat err =       0.000547225089
             autocorr =       1.328064207288
   target nu stat err =       0.000547225089
   target dn stat err =       0.003328406976
      target stat err =       0.002849169651
              std dev =       0.671539344113
             le_variance =       0.450965090692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450969396503
                                         uncertainty =       0.003383590303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450969396503
                                         uncertainty =       0.003383590303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474850022
  error estimate for blocks of size 2^( 2) =       0.000499141646
  error estimate for blocks of size 2^( 3) =       0.000521501850
  error estimate for blocks of size 2^( 4) =       0.000537642038
  error estimate for blocks of size 2^( 5) =       0.000546021090
  error estimate for blocks of size 2^( 6) =       0.000551547774
  error estimate for blocks of size 2^( 7) =       0.000553689513

      target function =      -0.744488734527
              le_mean =     -22.662123376999
             les_mean =     514.022800814877
             stat err =       0.000547225104
             autocorr =       1.328064292939
   target nu stat err =       0.000547225104
   target dn stat err =       0.003328407270
      target stat err =       0.002849169926
              std dev =       0.671539340654
             le_variance =       0.450965086046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450969392320
                                         uncertainty =       0.003383590611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450969392320
                                         uncertainty =       0.003383590611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474850019
  error estimate for blocks of size 2^( 2) =       0.000499141647
  error estimate for blocks of size 2^( 3) =       0.000521501854
  error estimate for blocks of size 2^( 4) =       0.000537642045
  error estimate for blocks of size 2^( 5) =       0.000546021100
  error estimate for blocks of size 2^( 6) =       0.000551547789
  error estimate for blocks of size 2^( 7) =       0.000553689532

      target function =      -0.744488737919
              le_mean =     -22.662123377307
             les_mean =     514.022800824787
             stat err =       0.000547225117
             autocorr =       1.328064367897
   target nu stat err =       0.000547225117
   target dn stat err =       0.003328407528
      target stat err =       0.002849170166
              std dev =       0.671539337628
             le_variance =       0.450965081981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744488738404        initial  <--
     1.5625e+03     1.5625e+04             6.5174e-07        -0.744488730650
     6.2500e+03     6.2500e+04             1.6294e-07        -0.744488734527
     2.5000e+04     2.5000e+05             4.0735e-08        -0.744488737919

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6890
  </log>
  <optVariables href="FORM2.s007.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2273e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5766
    reference variance = 0.431339
====================================================
  Execution time = 4.4715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4808e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5184e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448077067226
                                         uncertainty =       0.003106123097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448077067226
                                         uncertainty =       0.003106123097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473330659
  error estimate for blocks of size 2^( 2) =       0.000497288846
  error estimate for blocks of size 2^( 3) =       0.000518738596
  error estimate for blocks of size 2^( 4) =       0.000534579431
  error estimate for blocks of size 2^( 5) =       0.000542768765
  error estimate for blocks of size 2^( 6) =       0.000545525508
  error estimate for blocks of size 2^( 7) =       0.000548424507

      target function =      -0.746908727814
              le_mean =     -22.661864067619
             les_mean =     514.008166620394
             stat err =       0.000542824553
             autocorr =       1.315193625242
   target nu stat err =       0.000542824553
   target dn stat err =       0.003157071883
      target stat err =       0.002724504274
              std dev =       0.669390637221
             le_variance =       0.448083825199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266186406762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746917609660       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746917609748       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746917609805       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746917609832       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746917609853       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746917609873       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746917609898       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746917609895       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746917609926       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746917609932       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746917609905       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746917609945       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746917609909       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746917609923       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746917609950       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746917609973       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746917609940       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746917609956       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746917609964       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746917609969       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746917609940       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746917609969       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746917609988       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746917609984       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746917610013       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746917609982       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746917609926       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746917609988       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746917610014       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746917609976       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+04 is 2.055488e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746917609660       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746917609682       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746917609696       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746917609699       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746917609721       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746917609690       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746917609720       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746917609852       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746917609780       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746917609725       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746917609878       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746917609873       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746917609749       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746917609714       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746917609683       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746917609527       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746917609890       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746917609769       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746917609619       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746917609800       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746917609745       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746917609672       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746917609851       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746917609659       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746917609569       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746917609527       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746917609677       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746917609628       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746917609840       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746917609612       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+04 is 5.138725e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746917609660       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746917609665       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746917609669       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746917609670       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746917609652       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746917609682       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746917609437       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746917609870       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746917609899       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746917609772       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746917609804       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746917609657       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746917609625       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746917609073       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746917609864       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746917609745       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746917609621       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746917610469       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746917609801       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746917609616       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746917609744       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746917609672       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746917609437       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746917609286       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746917609790       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746917609918       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746917610093       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746917609019       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746917610319       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746917609499       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+05 is 1.284681e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335455 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9935e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717416e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611620e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008757e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585189e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.5236
    reference variance = 0.468283
====================================================
  Execution time = 4.5925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.8394e-01
  Total weights = 2.0000e+06
  Execution time = 3.6668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484039812409
                                         uncertainty =       0.030520075770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484039812409
                                         uncertainty =       0.030520075770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491903083
  error estimate for blocks of size 2^( 2) =       0.000514935958
  error estimate for blocks of size 2^( 3) =       0.000535511614
  error estimate for blocks of size 2^( 4) =       0.000550642153
  error estimate for blocks of size 2^( 5) =       0.000560317557
  error estimate for blocks of size 2^( 6) =       0.000562412857
  error estimate for blocks of size 2^( 7) =       0.000566562990

      target function =      -0.717189463724
              le_mean =     -22.661712769884
             les_mean =     514.037162709017
             stat err =       0.000559983889
             autocorr =       1.295961130458
   target nu stat err =       0.000559983889
   target dn stat err =       0.029882974734
      target stat err =       0.023197796176
              std dev =       0.695656011439
             le_variance =       0.483937286252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484039813899
                                         uncertainty =       0.030520076353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484039813899
                                         uncertainty =       0.030520076353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491903084
  error estimate for blocks of size 2^( 2) =       0.000514935959
  error estimate for blocks of size 2^( 3) =       0.000535511614
  error estimate for blocks of size 2^( 4) =       0.000550642153
  error estimate for blocks of size 2^( 5) =       0.000560317557
  error estimate for blocks of size 2^( 6) =       0.000562412857
  error estimate for blocks of size 2^( 7) =       0.000566562990

      target function =      -0.717189462534
              le_mean =     -22.661712769963
             les_mean =     514.037162714072
             stat err =       0.000559983889
             autocorr =       1.295961126809
   target nu stat err =       0.000559983889
   target dn stat err =       0.029882975333
      target stat err =       0.023197796567
              std dev =       0.695656012512
             le_variance =       0.483937287744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484039813154
                                         uncertainty =       0.030520076062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484039813154
                                         uncertainty =       0.030520076062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491903083
  error estimate for blocks of size 2^( 2) =       0.000514935959
  error estimate for blocks of size 2^( 3) =       0.000535511614
  error estimate for blocks of size 2^( 4) =       0.000550642153
  error estimate for blocks of size 2^( 5) =       0.000560317557
  error estimate for blocks of size 2^( 6) =       0.000562412857
  error estimate for blocks of size 2^( 7) =       0.000566562990

      target function =      -0.717189463129
              le_mean =     -22.661712769924
             les_mean =     514.037162711544
             stat err =       0.000559983889
             autocorr =       1.295961128634
   target nu stat err =       0.000559983889
   target dn stat err =       0.029882975034
      target stat err =       0.023197796371
              std dev =       0.695656011976
             le_variance =       0.483937286998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484039812502
                                         uncertainty =       0.030520075807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484039812502
                                         uncertainty =       0.030520075807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491903083
  error estimate for blocks of size 2^( 2) =       0.000514935958
  error estimate for blocks of size 2^( 3) =       0.000535511614
  error estimate for blocks of size 2^( 4) =       0.000550642153
  error estimate for blocks of size 2^( 5) =       0.000560317557
  error estimate for blocks of size 2^( 6) =       0.000562412857
  error estimate for blocks of size 2^( 7) =       0.000566562990

      target function =      -0.717189463650
              le_mean =     -22.661712769889
             les_mean =     514.037162709333
             stat err =       0.000559983889
             autocorr =       1.295961130237
   target nu stat err =       0.000559983889
   target dn stat err =       0.029882974772
      target stat err =       0.023197796200
              std dev =       0.695656011506
             le_variance =       0.483937286345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.717189463724        initial  <--
     1.5625e+04     1.5625e+05             2.0555e-08        -0.717189462534
     6.2500e+04     6.2500e+05             5.1387e-09        -0.717189463129
     2.5000e+05     2.5000e+06             1.2847e-09        -0.717189463650

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2429
  </log>
  <optVariables href="FORM2.s008.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2419e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6923
    reference variance = 0.288253
====================================================
  Execution time = 4.8004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5146e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454634900051
                                         uncertainty =       0.004968606197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454634900051
                                         uncertainty =       0.004968606197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476813545
  error estimate for blocks of size 2^( 2) =       0.000500337764
  error estimate for blocks of size 2^( 3) =       0.000522124825
  error estimate for blocks of size 2^( 4) =       0.000537389296
  error estimate for blocks of size 2^( 5) =       0.000546299844
  error estimate for blocks of size 2^( 6) =       0.000552144831
  error estimate for blocks of size 2^( 7) =       0.000553303160

      target function =      -0.741365021626
              le_mean =     -22.662008583450
             les_mean =     514.021335121458
             stat err =       0.000547284283
             autocorr =       1.317433749868
   target nu stat err =       0.000547284283
   target dn stat err =       0.005211818242
      target stat err =       0.004362406883
              std dev =       0.674316181370
             le_variance =       0.454702312458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266200858345e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741389976833       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741389976845       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741389976858       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741389976864       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741389976919       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741389976942       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741389976813       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741389976934       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741389976339       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741389976786       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741389976893       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741389976960       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741389977187       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741389976679       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741389976842       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741389976550       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741389977103       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741389976826       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741389976896       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741389976938       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741389977171       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741389976917       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741389976808       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741389977002       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741389976899       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741389977161       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741389976702       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741389976703       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741389976841       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+05 is 3.507794e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741389976833       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741389976836       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741389976839       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741389976840       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741389977140       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741389976823       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741389976843       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741389976859       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741389976630       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741389978188       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741389977189       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741389974076       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741389977882       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741389974262       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741389978479       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741389976631       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741389976384       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741389976484       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741389976308       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741389978616       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741389977093       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741389976971       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741389976400       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741389975820       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741389978307       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741389975924       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741389975614       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741389978864       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741389977404       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+05 is 8.769480e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741389976833       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741389976833       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741389976834       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741389976716       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741389973128       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741389977020       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741389978289       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741389976813       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741389980366       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741389974712       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741389976630       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741389975359       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741389974479       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741389974506       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741389973765       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741389977182       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741389971740       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741389976650       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741389978422       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741389982280       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741389981591       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741389974890       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741389970802       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741389983447       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741389968818       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741389983334       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741389974834       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741389982358       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741389971558       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+06 is 2.192363e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.3185e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717433e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229799e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7395
    reference variance = 0.41049
====================================================
  Execution time = 4.4467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4422e-01
  Total weights = 2.0000e+06
  Execution time = 3.7000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444311287949
                                         uncertainty =       0.002133832179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444311287949
                                         uncertainty =       0.002133832179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471286705
  error estimate for blocks of size 2^( 2) =       0.000495345293
  error estimate for blocks of size 2^( 3) =       0.000517323639
  error estimate for blocks of size 2^( 4) =       0.000533308165
  error estimate for blocks of size 2^( 5) =       0.000543249522
  error estimate for blocks of size 2^( 6) =       0.000546546243
  error estimate for blocks of size 2^( 7) =       0.000547455198

      target function =      -0.750169511469
              le_mean =     -22.662746676202
             les_mean =     514.044309004944
             stat err =       0.000542639782
             autocorr =       1.325723275801
   target nu stat err =       0.000542639782
   target dn stat err =       0.002244963852
      target stat err =       0.002003588169
              std dev =       0.666500050531
             le_variance =       0.444222317358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444311287991
                                         uncertainty =       0.002133832181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444311287991
                                         uncertainty =       0.002133832181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471286705
  error estimate for blocks of size 2^( 2) =       0.000495345293
  error estimate for blocks of size 2^( 3) =       0.000517323639
  error estimate for blocks of size 2^( 4) =       0.000533308165
  error estimate for blocks of size 2^( 5) =       0.000543249522
  error estimate for blocks of size 2^( 6) =       0.000546546243
  error estimate for blocks of size 2^( 7) =       0.000547455198

      target function =      -0.750169511433
              le_mean =     -22.662746676201
             les_mean =     514.044309004953
             stat err =       0.000542639782
             autocorr =       1.325723275550
   target nu stat err =       0.000542639782
   target dn stat err =       0.002244963853
      target stat err =       0.002003588169
              std dev =       0.666500050563
             le_variance =       0.444222317400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444311287970
                                         uncertainty =       0.002133832180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444311287970
                                         uncertainty =       0.002133832180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471286705
  error estimate for blocks of size 2^( 2) =       0.000495345293
  error estimate for blocks of size 2^( 3) =       0.000517323639
  error estimate for blocks of size 2^( 4) =       0.000533308165
  error estimate for blocks of size 2^( 5) =       0.000543249522
  error estimate for blocks of size 2^( 6) =       0.000546546243
  error estimate for blocks of size 2^( 7) =       0.000547455198

      target function =      -0.750169511451
              le_mean =     -22.662746676201
             les_mean =     514.044309004949
             stat err =       0.000542639782
             autocorr =       1.325723275667
   target nu stat err =       0.000542639782
   target dn stat err =       0.002244963853
      target stat err =       0.002003588169
              std dev =       0.666500050547
             le_variance =       0.444222317379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444311287951
                                         uncertainty =       0.002133832179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444311287951
                                         uncertainty =       0.002133832179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471286705
  error estimate for blocks of size 2^( 2) =       0.000495345293
  error estimate for blocks of size 2^( 3) =       0.000517323639
  error estimate for blocks of size 2^( 4) =       0.000533308165
  error estimate for blocks of size 2^( 5) =       0.000543249522
  error estimate for blocks of size 2^( 6) =       0.000546546243
  error estimate for blocks of size 2^( 7) =       0.000547455198

      target function =      -0.750169511467
              le_mean =     -22.662746676202
             les_mean =     514.044309004945
             stat err =       0.000542639782
             autocorr =       1.325723275778
   target nu stat err =       0.000542639782
   target dn stat err =       0.002244963852
      target stat err =       0.002003588169
              std dev =       0.666500050533
             le_variance =       0.444222317361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750169511469        initial  <--
     1.5625e+05     1.5625e+06             3.5078e-09        -0.750169511433
     6.2500e+05     6.2500e+06             8.7695e-10        -0.750169511451
     2.5000e+06     2.5000e+07             2.1924e-10        -0.750169511467

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8090
  </log>
  <optVariables href="FORM2.s009.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2601e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7333
    reference variance = 0.658666
====================================================
  Execution time = 4.5471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5660e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5144e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456564113205
                                         uncertainty =       0.007276064906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456564113205
                                         uncertainty =       0.007276064906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477809882
  error estimate for blocks of size 2^( 2) =       0.000501282930
  error estimate for blocks of size 2^( 3) =       0.000522390984
  error estimate for blocks of size 2^( 4) =       0.000538576740
  error estimate for blocks of size 2^( 5) =       0.000549350982
  error estimate for blocks of size 2^( 6) =       0.000553815047
  error estimate for blocks of size 2^( 7) =       0.000555548554

      target function =      -0.739762084462
              le_mean =     -22.662043289108
             les_mean =     514.024810375127
             stat err =       0.000549322831
             autocorr =       1.321736991168
   target nu stat err =       0.000549322831
   target dn stat err =       0.007645156726
      target stat err =       0.006338823198
              std dev =       0.675725214879
             le_variance =       0.456604566023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266204328911e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739816051918       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739816051921       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739816051924       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739816051926       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739816051255       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739816050771       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739816050356       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739816049977       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739816049710       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739816054614       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739816053463       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739816052041       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739816054129       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739816051536       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739816051998       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739816052349       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739816053354       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739816052199       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739816055024       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739816046333       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739816053528       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739816058359       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739816050199       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.739816056254       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739816049399       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.739816059855       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739816054194       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739816051765       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739816051305       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.739816036897       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.739816049885       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+06 is 9.323132e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739816051918       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739816051919       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739816051920       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739816051920       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739816053300       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739816060566       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739816051922       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739816051922       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739816038568       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739816040826       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739816041482       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739816035221       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739816042434       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739816057943       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739816048567       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739816056460       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739816041157       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739816040819       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739816053678       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739816035261       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739816060234       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739816057942       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739816029771       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.739816039863       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739816049673       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.739816047280       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739816047755       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739816056868       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739816051715       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.739816060999       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.739816051065       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+06 is 2.330775e-10

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739816051918       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739816051918       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739816051918       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739816041557       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739816048242       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739816052905       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739816051919       residual = 6.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739816051919       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739815967331       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739816096160       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739816129817       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739816070413       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739816007661       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739816078005       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739816072686       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739815993061       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739816025165       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739816072463       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739816068485       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739816077455       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739815980080       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739816023175       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739815971027       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.739815989399       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739816048316       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.739816090726       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739816074621       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739816054146       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739816016771       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.739815945298       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.739815975629       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+07 is 5.826873e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0654e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6282
    reference variance = 0.556509
====================================================
  Execution time = 4.4386e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5057e-01
  Total weights = 2.0000e+06
  Execution time = 3.6231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450610674332
                                         uncertainty =       0.003300865692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450610674332
                                         uncertainty =       0.003300865692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474641591
  error estimate for blocks of size 2^( 2) =       0.000498452863
  error estimate for blocks of size 2^( 3) =       0.000520047121
  error estimate for blocks of size 2^( 4) =       0.000535295804
  error estimate for blocks of size 2^( 5) =       0.000546034860
  error estimate for blocks of size 2^( 6) =       0.000552838671
  error estimate for blocks of size 2^( 7) =       0.000555336674

      target function =      -0.744818512365
              le_mean =     -22.662116345696
             les_mean =     514.022086321289
             stat err =       0.000547376502
             autocorr =       1.329966547061
   target nu stat err =       0.000547376502
   target dn stat err =       0.003517284999
      target stat err =       0.003006140775
              std dev =       0.671244575924
             le_variance =       0.450569280707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450610674367
                                         uncertainty =       0.003300865693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450610674367
                                         uncertainty =       0.003300865693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474641591
  error estimate for blocks of size 2^( 2) =       0.000498452863
  error estimate for blocks of size 2^( 3) =       0.000520047121
  error estimate for blocks of size 2^( 4) =       0.000535295804
  error estimate for blocks of size 2^( 5) =       0.000546034860
  error estimate for blocks of size 2^( 6) =       0.000552838671
  error estimate for blocks of size 2^( 7) =       0.000555336674

      target function =      -0.744818512335
              le_mean =     -22.662116345696
             les_mean =     514.022086321338
             stat err =       0.000547376502
             autocorr =       1.329966547080
   target nu stat err =       0.000547376502
   target dn stat err =       0.003517284999
      target stat err =       0.003006140775
              std dev =       0.671244575950
             le_variance =       0.450569280743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450610674349
                                         uncertainty =       0.003300865692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450610674349
                                         uncertainty =       0.003300865692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474641591
  error estimate for blocks of size 2^( 2) =       0.000498452863
  error estimate for blocks of size 2^( 3) =       0.000520047121
  error estimate for blocks of size 2^( 4) =       0.000535295804
  error estimate for blocks of size 2^( 5) =       0.000546034860
  error estimate for blocks of size 2^( 6) =       0.000552838671
  error estimate for blocks of size 2^( 7) =       0.000555336674

      target function =      -0.744818512350
              le_mean =     -22.662116345696
             les_mean =     514.022086321314
             stat err =       0.000547376502
             autocorr =       1.329966547077
   target nu stat err =       0.000547376502
   target dn stat err =       0.003517284999
      target stat err =       0.003006140775
              std dev =       0.671244575937
             le_variance =       0.450569280725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450610674334
                                         uncertainty =       0.003300865692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450610674334
                                         uncertainty =       0.003300865692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474641591
  error estimate for blocks of size 2^( 2) =       0.000498452863
  error estimate for blocks of size 2^( 3) =       0.000520047121
  error estimate for blocks of size 2^( 4) =       0.000535295804
  error estimate for blocks of size 2^( 5) =       0.000546034860
  error estimate for blocks of size 2^( 6) =       0.000552838671
  error estimate for blocks of size 2^( 7) =       0.000555336674

      target function =      -0.744818512363
              le_mean =     -22.662116345696
             les_mean =     514.022086321292
             stat err =       0.000547376502
             autocorr =       1.329966547063
   target nu stat err =       0.000547376502
   target dn stat err =       0.003517284999
      target stat err =       0.003006140775
              std dev =       0.671244575925
             le_variance =       0.450569280709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744818512365        initial  <--
     1.5625e+06     1.5625e+07             9.3231e-10        -0.744818512335
     6.2500e+06     6.2500e+07             2.3308e-10        -0.744818512350
     2.5000e+07     2.5000e+08             5.8269e-11        -0.744818512363

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.5395
  </log>
  <optVariables href="FORM2.s010.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2320e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7403
    reference variance = 0.249083
====================================================
  Execution time = 4.6279e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5138e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455893987027
                                         uncertainty =       0.003970789644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455893987027
                                         uncertainty =       0.003970789644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477421738
  error estimate for blocks of size 2^( 2) =       0.000501058680
  error estimate for blocks of size 2^( 3) =       0.000522527068
  error estimate for blocks of size 2^( 4) =       0.000538242336
  error estimate for blocks of size 2^( 5) =       0.000546801441
  error estimate for blocks of size 2^( 6) =       0.000549975897
  error estimate for blocks of size 2^( 7) =       0.000549042484

      target function =      -0.740407427419
              le_mean =     -22.662456039414
             les_mean =     514.042776542705
             stat err =       0.000546015540
             autocorr =       1.307993622451
   target nu stat err =       0.000546015540
   target dn stat err =       0.003774010544
      target stat err =       0.003180729734
              std dev =       0.675176297184
             le_variance =       0.455863032279


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266245603941e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740420145358       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740420145358       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740420145358       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740420141448       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740420141621       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740420151986       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740420150984       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740420189618       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740420163163       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740420127202       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740420155556       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740420130984       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740420134225       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740420124984       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740420125939       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740420152605       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740420141971       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740420100523       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740420150881       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740420173411       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740420138888       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740420084596       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740420136358       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740420153305       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740420154628       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740420156920       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740420148839       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740420096761       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740420132907       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+07 is 2.048827e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740420145358       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740420145358       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740420145358       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740420141303       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740420178598       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740420144433       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740420162353       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740420041733       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740420068600       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740420019400       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740420261597       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740420228173       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740420217951       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740420053721       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740420210121       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740420038394       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740420053649       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740419993862       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740420145026       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740420113720       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740420043851       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740420171813       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740420126772       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740420388632       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740420144926       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740420268210       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740420417280       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740420237606       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740420269493       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+07 is 5.121976e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740420145358       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740420145358       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740420145358       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740420145358       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740420158397       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740420189972       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740420341656       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740420049477       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740420119268       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740420252882       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740419943930       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740419659760       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740420266415       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740420312710       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740419747212       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740419923637       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740420492942       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740420131627       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740420517007       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740419776454       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740419633177       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740419968083       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740419761550       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740419476244       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740419320884       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740419696636       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740420150803       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740420057500       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740419658009       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+08 is 1.280517e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425172 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1451e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6012
    reference variance = 0.431837
====================================================
  Execution time = 4.5404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2664e+01
  VMC Evar = 4.5504e-01
  Total weights = 2.0000e+06
  Execution time = 3.6477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455020431600
                                         uncertainty =       0.003892132850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455020431600
                                         uncertainty =       0.003892132850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476989171
  error estimate for blocks of size 2^( 2) =       0.000500594125
  error estimate for blocks of size 2^( 3) =       0.000522806484
  error estimate for blocks of size 2^( 4) =       0.000538040601
  error estimate for blocks of size 2^( 5) =       0.000547005554
  error estimate for blocks of size 2^( 6) =       0.000551051763
  error estimate for blocks of size 2^( 7) =       0.000555003956

      target function =      -0.741064392010
              le_mean =     -22.663518939523
             les_mean =     514.090127832525
             stat err =       0.000547775469
             autocorr =       1.318827880484
   target nu stat err =       0.000547775469
   target dn stat err =       0.004398403604
      target stat err =       0.003701688415
              std dev =       0.674564554322
             le_variance =       0.455037337947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455020431598
                                         uncertainty =       0.003892132850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455020431598
                                         uncertainty =       0.003892132850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476989171
  error estimate for blocks of size 2^( 2) =       0.000500594125
  error estimate for blocks of size 2^( 3) =       0.000522806484
  error estimate for blocks of size 2^( 4) =       0.000538040601
  error estimate for blocks of size 2^( 5) =       0.000547005554
  error estimate for blocks of size 2^( 6) =       0.000551051763
  error estimate for blocks of size 2^( 7) =       0.000555003956

      target function =      -0.741064392011
              le_mean =     -22.663518939523
             les_mean =     514.090127832523
             stat err =       0.000547775469
             autocorr =       1.318827880493
   target nu stat err =       0.000547775469
   target dn stat err =       0.004398403604
      target stat err =       0.003701688415
              std dev =       0.674564554321
             le_variance =       0.455037337946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455020431599
                                         uncertainty =       0.003892132850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455020431599
                                         uncertainty =       0.003892132850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476989171
  error estimate for blocks of size 2^( 2) =       0.000500594125
  error estimate for blocks of size 2^( 3) =       0.000522806484
  error estimate for blocks of size 2^( 4) =       0.000538040601
  error estimate for blocks of size 2^( 5) =       0.000547005554
  error estimate for blocks of size 2^( 6) =       0.000551051763
  error estimate for blocks of size 2^( 7) =       0.000555003956

      target function =      -0.741064392011
              le_mean =     -22.663518939523
             les_mean =     514.090127832524
             stat err =       0.000547775469
             autocorr =       1.318827880496
   target nu stat err =       0.000547775469
   target dn stat err =       0.004398403604
      target stat err =       0.003701688415
              std dev =       0.674564554321
             le_variance =       0.455037337946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455020431600
                                         uncertainty =       0.003892132850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455020431600
                                         uncertainty =       0.003892132850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476989171
  error estimate for blocks of size 2^( 2) =       0.000500594125
  error estimate for blocks of size 2^( 3) =       0.000522806484
  error estimate for blocks of size 2^( 4) =       0.000538040601
  error estimate for blocks of size 2^( 5) =       0.000547005554
  error estimate for blocks of size 2^( 6) =       0.000551051763
  error estimate for blocks of size 2^( 7) =       0.000555003956

      target function =      -0.741064392010
              le_mean =     -22.663518939523
             les_mean =     514.090127832525
             stat err =       0.000547775469
             autocorr =       1.318827880480
   target nu stat err =       0.000547775469
   target dn stat err =       0.004398403604
      target stat err =       0.003701688415
              std dev =       0.674564554321
             le_variance =       0.455037337947


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741064392010        initial
     1.5625e+07     1.5625e+08             2.0488e-11        -0.741064392011  <--
     6.2500e+07     6.2500e+08             5.1220e-12        -0.741064392011
     2.5000e+08     2.5000e+09             1.2805e-12        -0.741064392010

*****************************************************************************
Applying the update for shift_i =   1.5625e+07     and shift_s =   1.5625e+08
*****************************************************************************

  Execution time = 6.3609e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2507e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.5583
    reference variance = 0.344936
====================================================
  Execution time = 4.4647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5228e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5290e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452365987602
                                         uncertainty =       0.003364626409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452365987602
                                         uncertainty =       0.003364626409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475542071
  error estimate for blocks of size 2^( 2) =       0.000499153856
  error estimate for blocks of size 2^( 3) =       0.000520765094
  error estimate for blocks of size 2^( 4) =       0.000536116303
  error estimate for blocks of size 2^( 5) =       0.000544862623
  error estimate for blocks of size 2^( 6) =       0.000549782009
  error estimate for blocks of size 2^( 7) =       0.000551897236

      target function =      -0.743387421274
              le_mean =     -22.662159736528
             les_mean =     514.025764220692
             stat err =       0.000545664543
             autocorr =       1.316659809036
   target nu stat err =       0.000545664543
   target dn stat err =       0.003739816717
      target stat err =       0.003176435087
              std dev =       0.672518046537
             le_variance =       0.452280522918


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266215973653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743400172087       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743400172087       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743400172087       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743400171112       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743400172484       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743400172528       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743400171870       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743400176459       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743400172246       residual = 7.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743400166097       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743400175542       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743400175673       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743400171382       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743400167889       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743400165772       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743400169277       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743400168787       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743400170478       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743400177288       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743400162692       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743400169101       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743400165915       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743400173591       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743400166618       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743400176621       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743400164264       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743400192577       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743400167296       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743400169248       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743400173819       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743400179738       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743400169477       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+06 is 1.424850e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743400172087       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743400172087       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743400172087       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743400172087       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743400170981       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743400158682       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743400147056       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743400166278       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743400170073       residual = 7.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743400157620       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743400179410       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743400154469       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743400155440       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743400144665       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743400185013       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743400109619       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743400188124       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743400181617       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743400199391       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743400106506       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743400162512       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743400155016       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743400163239       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743400147010       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743400165800       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743400169700       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743400187239       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743400194903       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743400159927       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743400226527       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743400182440       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743400118639       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+07 is 3.562122e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743400172087       residual = 8.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743400172087       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743400172087       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743400229320       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743400228243       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743400199641       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743400023865       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743400187421       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743400146701       residual = 7.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743400096527       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743400187067       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743400051002       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743400309224       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743400202458       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743400116706       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743400037007       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743400267616       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743400042207       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743400056387       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743400380296       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743400122757       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743400104524       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743400139101       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743400075153       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743400253250       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743400063529       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743400017291       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743400114677       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743400200553       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743400343515       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743400102432       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743400328416       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+07 is 8.905630e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.460249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9979e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6836
    reference variance = 0.420842
====================================================
  Execution time = 4.3528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4723e-01
  Total weights = 2.0000e+06
  Execution time = 3.6472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447288945624
                                         uncertainty =       0.002925264085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447288945624
                                         uncertainty =       0.002925264085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472879304
  error estimate for blocks of size 2^( 2) =       0.000496984772
  error estimate for blocks of size 2^( 3) =       0.000519057949
  error estimate for blocks of size 2^( 4) =       0.000534667077
  error estimate for blocks of size 2^( 5) =       0.000544650991
  error estimate for blocks of size 2^( 6) =       0.000547959845
  error estimate for blocks of size 2^( 7) =       0.000550177113

      target function =      -0.747627606423
              le_mean =     -22.661863820297
             les_mean =     514.007301258720
             stat err =       0.000544363757
             autocorr =       1.325188902695
   target nu stat err =       0.000544363757
   target dn stat err =       0.003171337485
      target stat err =       0.002741722293
              std dev =       0.668752325355
             le_variance =       0.447229672667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447288945625
                                         uncertainty =       0.002925264085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447288945625
                                         uncertainty =       0.002925264085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472879304
  error estimate for blocks of size 2^( 2) =       0.000496984772
  error estimate for blocks of size 2^( 3) =       0.000519057949
  error estimate for blocks of size 2^( 4) =       0.000534667077
  error estimate for blocks of size 2^( 5) =       0.000544650991
  error estimate for blocks of size 2^( 6) =       0.000547959845
  error estimate for blocks of size 2^( 7) =       0.000550177113

      target function =      -0.747627606423
              le_mean =     -22.661863820297
             les_mean =     514.007301258727
             stat err =       0.000544363757
             autocorr =       1.325188902689
   target nu stat err =       0.000544363757
   target dn stat err =       0.003171337485
      target stat err =       0.002741722293
              std dev =       0.668752325355
             le_variance =       0.447229672667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447288945624
                                         uncertainty =       0.002925264085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447288945624
                                         uncertainty =       0.002925264085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472879304
  error estimate for blocks of size 2^( 2) =       0.000496984772
  error estimate for blocks of size 2^( 3) =       0.000519057949
  error estimate for blocks of size 2^( 4) =       0.000534667077
  error estimate for blocks of size 2^( 5) =       0.000544650991
  error estimate for blocks of size 2^( 6) =       0.000547959845
  error estimate for blocks of size 2^( 7) =       0.000550177113

      target function =      -0.747627606423
              le_mean =     -22.661863820297
             les_mean =     514.007301258723
             stat err =       0.000544363757
             autocorr =       1.325188902685
   target nu stat err =       0.000544363757
   target dn stat err =       0.003171337485
      target stat err =       0.002741722293
              std dev =       0.668752325355
             le_variance =       0.447229672667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447288945624
                                         uncertainty =       0.002925264085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447288945624
                                         uncertainty =       0.002925264085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472879304
  error estimate for blocks of size 2^( 2) =       0.000496984772
  error estimate for blocks of size 2^( 3) =       0.000519057949
  error estimate for blocks of size 2^( 4) =       0.000534667077
  error estimate for blocks of size 2^( 5) =       0.000544650991
  error estimate for blocks of size 2^( 6) =       0.000547959845
  error estimate for blocks of size 2^( 7) =       0.000550177113

      target function =      -0.747627606423
              le_mean =     -22.661863820297
             les_mean =     514.007301258720
             stat err =       0.000544363757
             autocorr =       1.325188902687
   target nu stat err =       0.000544363757
   target dn stat err =       0.003171337485
      target stat err =       0.002741722293
              std dev =       0.668752325355
             le_variance =       0.447229672667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747627606423        initial  <--
     3.9062e+06     3.9062e+07             1.4249e-10        -0.747627606423
     1.5625e+07     1.5625e+08             3.5621e-11        -0.747627606423
     6.2500e+07     6.2500e+08             8.9056e-12        -0.747627606423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.7414
  </log>
  <optVariables href="FORM2.s012.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2173e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7161
    reference variance = 0.486047
====================================================
  Execution time = 4.4607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5751e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5711e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457617045155
                                         uncertainty =       0.004214708105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457617045155
                                         uncertainty =       0.004214708105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478284335
  error estimate for blocks of size 2^( 2) =       0.000501635705
  error estimate for blocks of size 2^( 3) =       0.000522659521
  error estimate for blocks of size 2^( 4) =       0.000537942204
  error estimate for blocks of size 2^( 5) =       0.000547848109
  error estimate for blocks of size 2^( 6) =       0.000549716724
  error estimate for blocks of size 2^( 7) =       0.000549775197

      target function =      -0.739064342384
              le_mean =     -22.661478658823
             les_mean =     514.000126586067
             stat err =       0.000546320558
             autocorr =       1.304736382649
   target nu stat err =       0.000546320558
   target dn stat err =       0.004214526312
      target stat err =       0.003521274885
              std dev =       0.676396193476
             le_variance =       0.457511810549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266147865882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739080195367       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739080195367       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739080195367       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739080195368       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739080178951       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739080177390       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739080180689       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739080098180       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739080198695       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739080124069       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739080283576       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739080250100       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739080173838       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739080151248       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739080166009       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739080197994       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739080137136       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739080152620       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739080014978       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739080231040       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739080190897       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739080125962       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739080280016       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.739080214444       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739080247912       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.739080245436       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739080047854       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739080289894       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739080095284       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.739080076152       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+07 is 6.211631e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739080195367       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739080195367       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739080195367       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739080195367       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739080239022       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739079820044       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739080378004       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739080092511       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739080565672       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739080359521       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739079932683       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739080622903       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739080561437       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739080347178       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739080047087       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739079961054       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739080024556       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739080182975       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739080311150       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739080527081       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739080084258       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739080005478       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739079998544       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.739080272063       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739080532198       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.739079681632       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739079598841       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739079846318       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739079822290       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.739080671361       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+08 is 1.552148e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739080195367       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739080195367       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739080195367       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739080090129       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739079960550       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739079416086       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739080606091       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739080248011       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739079529790       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739080435808       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739080471963       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739079730989       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739082494440       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739078860362       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739079029405       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739080607115       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739079270308       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739079329208       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739081693631       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739079801016       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739080312616       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739080575760       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739080658724       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.739079424707       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739080759144       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.739079297669       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739081026444       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739077391793       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739078247804       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.739080386522       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+08 is 3.881903e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.490355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0354e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6168
    reference variance = 0.2917
====================================================
  Execution time = 4.5230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4856e-01
  Total weights = 2.0000e+06
  Execution time = 3.6468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448487777181
                                         uncertainty =       0.004555683949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448487777181
                                         uncertainty =       0.004555683949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473583815
  error estimate for blocks of size 2^( 2) =       0.000497294929
  error estimate for blocks of size 2^( 3) =       0.000518909055
  error estimate for blocks of size 2^( 4) =       0.000534231006
  error estimate for blocks of size 2^( 5) =       0.000543024794
  error estimate for blocks of size 2^( 6) =       0.000545821494
  error estimate for blocks of size 2^( 7) =       0.000547752419

      target function =      -0.746493553598
              le_mean =     -22.661780167182
             les_mean =     514.004843380855
             stat err =       0.000542707428
             autocorr =       1.313221029581
   target nu stat err =       0.000542707428
   target dn stat err =       0.004899003355
      target stat err =       0.004160045083
              std dev =       0.669748653944
             le_variance =       0.448563259460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448487777182
                                         uncertainty =       0.004555683949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448487777182
                                         uncertainty =       0.004555683949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473583815
  error estimate for blocks of size 2^( 2) =       0.000497294929
  error estimate for blocks of size 2^( 3) =       0.000518909055
  error estimate for blocks of size 2^( 4) =       0.000534231006
  error estimate for blocks of size 2^( 5) =       0.000543024794
  error estimate for blocks of size 2^( 6) =       0.000545821494
  error estimate for blocks of size 2^( 7) =       0.000547752419

      target function =      -0.746493553597
              le_mean =     -22.661780167182
             les_mean =     514.004843380856
             stat err =       0.000542707428
             autocorr =       1.313221029579
   target nu stat err =       0.000542707428
   target dn stat err =       0.004899003355
      target stat err =       0.004160045083
              std dev =       0.669748653944
             le_variance =       0.448563259460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448487777182
                                         uncertainty =       0.004555683949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448487777182
                                         uncertainty =       0.004555683949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473583815
  error estimate for blocks of size 2^( 2) =       0.000497294929
  error estimate for blocks of size 2^( 3) =       0.000518909055
  error estimate for blocks of size 2^( 4) =       0.000534231006
  error estimate for blocks of size 2^( 5) =       0.000543024794
  error estimate for blocks of size 2^( 6) =       0.000545821494
  error estimate for blocks of size 2^( 7) =       0.000547752419

      target function =      -0.746493553598
              le_mean =     -22.661780167182
             les_mean =     514.004843380855
             stat err =       0.000542707428
             autocorr =       1.313221029577
   target nu stat err =       0.000542707428
   target dn stat err =       0.004899003355
      target stat err =       0.004160045083
              std dev =       0.669748653944
             le_variance =       0.448563259460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448487777181
                                         uncertainty =       0.004555683949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448487777181
                                         uncertainty =       0.004555683949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473583815
  error estimate for blocks of size 2^( 2) =       0.000497294929
  error estimate for blocks of size 2^( 3) =       0.000518909055
  error estimate for blocks of size 2^( 4) =       0.000534231006
  error estimate for blocks of size 2^( 5) =       0.000543024794
  error estimate for blocks of size 2^( 6) =       0.000545821494
  error estimate for blocks of size 2^( 7) =       0.000547752419

      target function =      -0.746493553598
              le_mean =     -22.661780167182
             les_mean =     514.004843380855
             stat err =       0.000542707428
             autocorr =       1.313221029575
   target nu stat err =       0.000542707428
   target dn stat err =       0.004899003355
      target stat err =       0.004160045083
              std dev =       0.669748653944
             le_variance =       0.448563259460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746493553598        initial  <--
     3.9062e+07     3.9062e+08             6.2116e-12        -0.746493553597
     1.5625e+08     1.5625e+09             1.5521e-12        -0.746493553598
     6.2500e+08     6.2500e+09             3.8819e-13        -0.746493553598

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.4447
  </log>
  <optVariables href="FORM2.s013.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2381e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8053
    reference variance = 0.473806
====================================================
  Execution time = 4.6721e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.6009e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5198e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460216935773
                                         uncertainty =       0.009886789310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460216935773
                                         uncertainty =       0.009886789310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479630976
  error estimate for blocks of size 2^( 2) =       0.000502851932
  error estimate for blocks of size 2^( 3) =       0.000524077188
  error estimate for blocks of size 2^( 4) =       0.000539921757
  error estimate for blocks of size 2^( 5) =       0.000550048384
  error estimate for blocks of size 2^( 6) =       0.000555324983
  error estimate for blocks of size 2^( 7) =       0.000559485299

      target function =      -0.736838865890
              le_mean =     -22.662953479965
             les_mean =     514.069551951597
             stat err =       0.000551195106
             autocorr =       1.320675917010
   target nu stat err =       0.000551195106
   target dn stat err =       0.009739979624
      target stat err =       0.008009313507
              std dev =       0.678300631417
             le_variance =       0.460091746580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266295347997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736925707285       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736925707285       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736925707285       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736925612173       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736925707285       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736925889984       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736925164163       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736924840732       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736926152785       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736925346603       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736924997681       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736927632056       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736925845700       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736925706162       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736925582752       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736926172377       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736925460845       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736926244828       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736924862194       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736925701314       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736925327660       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736925145484       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736923771608       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736925372685       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736925269010       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736926208116       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736924836294       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736925048454       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736924878295       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736925893717       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736925952839       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+08 is 1.692215e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736925707285       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736925707285       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736925707285       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736925707285       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736926641455       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736924216057       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736925707285       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736927564058       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736927387733       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736925707285       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736924290937       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736925707285       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736926155419       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736924646889       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736924191824       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736926585344       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736929910326       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736925147732       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736926504542       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736924158948       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736926336098       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736923619303       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736920612683       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736924230041       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736925697596       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736926816964       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736919931379       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736924075265       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736928469278       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736926648499       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736920165402       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.736928454426       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.736927417686       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+09 is 4.233645e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736925707285       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736925707285       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736925707285       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736925707285       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736930744700       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736923790431       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736939456372       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736925707285       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736925707285       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736925026708       residual = 7.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736932302402       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736923643871       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736920797583       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736911782772       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736917076287       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736939449668       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736921168010       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736937753892       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736919868645       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736922005408       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736936336848       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736934410997       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736939289406       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736918287289       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736928846116       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736923741263       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736918877464       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736917784805       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736915240921       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736922983446       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736929942907       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.736920538866       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.736893495388       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.736922372804       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.736943984673       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.736939008814       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.736897679689       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.736895566567       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.736930571075       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.736851100025       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.736864497298       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.736846621977       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.736997334629       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.736932760832       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.736796126387       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.736982461295       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.737029423288       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.736651202122       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.737048815102       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.736706359961       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.733436207939       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.735599359098       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.734862186984       residual = 3.22e-03           smallest_sin_value = 9.99e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+09 is 1.056941e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.571496 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2006e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.708
    reference variance = 0.355913
====================================================
  Execution time = 4.3704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6464e-01
  Total weights = 2.0000e+06
  Execution time = 3.6246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464646445643
                                         uncertainty =       0.008583955673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464646445643
                                         uncertainty =       0.008583955673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481996691
  error estimate for blocks of size 2^( 2) =       0.000505725437
  error estimate for blocks of size 2^( 3) =       0.000527343492
  error estimate for blocks of size 2^( 4) =       0.000543293220
  error estimate for blocks of size 2^( 5) =       0.000552435578
  error estimate for blocks of size 2^( 6) =       0.000556618532
  error estimate for blocks of size 2^( 7) =       0.000560418683

      target function =      -0.733180745572
              le_mean =     -22.661926866101
             les_mean =     514.027570672720
             stat err =       0.000553191503
             autocorr =       1.317233866926
   target nu stat err =       0.000553191503
   target dn stat err =       0.008497957355
      target stat err =       0.006914667511
              std dev =       0.681646257633
             le_variance =       0.464641620545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464646445643
                                         uncertainty =       0.008583955673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464646445643
                                         uncertainty =       0.008583955673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481996691
  error estimate for blocks of size 2^( 2) =       0.000505725437
  error estimate for blocks of size 2^( 3) =       0.000527343492
  error estimate for blocks of size 2^( 4) =       0.000543293220
  error estimate for blocks of size 2^( 5) =       0.000552435578
  error estimate for blocks of size 2^( 6) =       0.000556618532
  error estimate for blocks of size 2^( 7) =       0.000560418683

      target function =      -0.733180745573
              le_mean =     -22.661926866101
             les_mean =     514.027570672720
             stat err =       0.000553191503
             autocorr =       1.317233866920
   target nu stat err =       0.000553191503
   target dn stat err =       0.008497957355
      target stat err =       0.006914667511
              std dev =       0.681646257632
             le_variance =       0.464641620544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464646445643
                                         uncertainty =       0.008583955673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464646445643
                                         uncertainty =       0.008583955673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481996691
  error estimate for blocks of size 2^( 2) =       0.000505725437
  error estimate for blocks of size 2^( 3) =       0.000527343492
  error estimate for blocks of size 2^( 4) =       0.000543293220
  error estimate for blocks of size 2^( 5) =       0.000552435578
  error estimate for blocks of size 2^( 6) =       0.000556618532
  error estimate for blocks of size 2^( 7) =       0.000560418683

      target function =      -0.733180745573
              le_mean =     -22.661926866101
             les_mean =     514.027570672720
             stat err =       0.000553191503
             autocorr =       1.317233866932
   target nu stat err =       0.000553191503
   target dn stat err =       0.008497957355
      target stat err =       0.006914667511
              std dev =       0.681646257632
             le_variance =       0.464641620544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464646445643
                                         uncertainty =       0.008583955673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464646445643
                                         uncertainty =       0.008583955673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481996691
  error estimate for blocks of size 2^( 2) =       0.000505725437
  error estimate for blocks of size 2^( 3) =       0.000527343492
  error estimate for blocks of size 2^( 4) =       0.000543293220
  error estimate for blocks of size 2^( 5) =       0.000552435578
  error estimate for blocks of size 2^( 6) =       0.000556618532
  error estimate for blocks of size 2^( 7) =       0.000560418683

      target function =      -0.733180745572
              le_mean =     -22.661926866101
             les_mean =     514.027570672720
             stat err =       0.000553191503
             autocorr =       1.317233866921
   target nu stat err =       0.000553191503
   target dn stat err =       0.008497957355
      target stat err =       0.006914667511
              std dev =       0.681646257633
             le_variance =       0.464641620545


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.733180745572        initial
     3.9062e+08     3.9062e+09             1.6922e-12        -0.733180745573  <--
     1.5625e+09     1.5625e+10             4.2336e-13        -0.733180745573
     6.2500e+09     6.2500e+10             1.0569e-13        -0.733180745572

*****************************************************************************
Applying the update for shift_i =   3.9062e+08     and shift_s =   3.9062e+09
*****************************************************************************

  Execution time = 6.1871e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2388e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6986
    reference variance = 0.516341
====================================================
  Execution time = 4.4504e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.7598e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5217e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476079785964
                                         uncertainty =       0.028862472225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476079785964
                                         uncertainty =       0.028862472225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487843527
  error estimate for blocks of size 2^( 2) =       0.000511159944
  error estimate for blocks of size 2^( 3) =       0.000532409032
  error estimate for blocks of size 2^( 4) =       0.000547511740
  error estimate for blocks of size 2^( 5) =       0.000556711440
  error estimate for blocks of size 2^( 6) =       0.000561025602
  error estimate for blocks of size 2^( 7) =       0.000564299384

      target function =      -0.723406987883
              le_mean =     -22.662759218928
             les_mean =     514.076637790360
             stat err =       0.000557387042
             autocorr =       1.305427154065
   target nu stat err =       0.000557387042
   target dn stat err =       0.028865541780
      target stat err =       0.022833387092
              std dev =       0.689914931898
             le_variance =       0.475982613256


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266275921893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724130321660       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724130321661       residual = 8.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.724130321661       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.724130321661       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724130321662       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.724130321662       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724130321662       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724130405760       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.724130321662       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724130321662       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.724130472071       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.724130404260       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.724130321662       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.724130321662       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.724130321662       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.724130194274       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.724130369813       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.724130146402       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.724130424530       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.724130396340       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.724130284866       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.724130305180       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.724130277766       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.724130577290       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.724130240920       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.724130085127       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.724130167384       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.724130550363       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.724130321727       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.724129970127       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.724130281448       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.724130208463       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+07 is 1.395628e-11

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724130321660       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724130321660       residual = 8.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.724130321661       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.724130321661       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724130321661       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.724130691552       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724130321661       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724130882615       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.724130321661       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724130321661       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.724130946369       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.724130703122       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.724130376161       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.724130260768       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.724129913813       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.724130745184       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.724130555875       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.724130916289       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.724130013431       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.724130360320       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.724130558171       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.724129167021       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.724131414996       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.724129461937       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.724130041036       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.724129260620       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.724129353355       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.724129914473       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.724130634093       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.724131037517       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.724129276512       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.724132566682       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+08 is 3.488777e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.724130321660       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.724130321660       residual = 8.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.724130321660       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.724130321660       residual = 5.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724130321660       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.724130321660       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724130321660       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724130231457       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.724130321660       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724125531326       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.724128259105       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.724130334383       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.724130321660       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.724127298775       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.724133282838       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.724127615803       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.724130675972       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.724129181832       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.724129756629       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.724132324311       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.724132804093       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.724131861390       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.724131215859       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.724133811743       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.724132901972       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.724133717408       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.724128473815       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.724131812756       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.724130283804       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.724125917927       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.724132711085       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.724127334204       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         31 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+09 is 8.725135e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.606498 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9763e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6955
    reference variance = 0.311018
====================================================
  Execution time = 4.7087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5128e-01
  Total weights = 2.0000e+06
  Execution time = 3.6370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451290691383
                                         uncertainty =       0.002816667071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451290691383
                                         uncertainty =       0.002816667071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475017998
  error estimate for blocks of size 2^( 2) =       0.000498558716
  error estimate for blocks of size 2^( 3) =       0.000519578540
  error estimate for blocks of size 2^( 4) =       0.000535418237
  error estimate for blocks of size 2^( 5) =       0.000544225740
  error estimate for blocks of size 2^( 6) =       0.000548784649
  error estimate for blocks of size 2^( 7) =       0.000548572506

      target function =      -0.744216167496
              le_mean =     -22.662669850027
             les_mean =     514.047888702491
             stat err =       0.000544250283
             autocorr =       1.312735399940
   target nu stat err =       0.000544250283
   target dn stat err =       0.002948563851
      target stat err =       0.002539534840
              std dev =       0.671776895100
             le_variance =       0.451284196791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451290691382
                                         uncertainty =       0.002816667071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451290691382
                                         uncertainty =       0.002816667071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475017998
  error estimate for blocks of size 2^( 2) =       0.000498558716
  error estimate for blocks of size 2^( 3) =       0.000519578540
  error estimate for blocks of size 2^( 4) =       0.000535418237
  error estimate for blocks of size 2^( 5) =       0.000544225740
  error estimate for blocks of size 2^( 6) =       0.000548784649
  error estimate for blocks of size 2^( 7) =       0.000548572506

      target function =      -0.744216167497
              le_mean =     -22.662669850027
             les_mean =     514.047888702492
             stat err =       0.000544250283
             autocorr =       1.312735399940
   target nu stat err =       0.000544250283
   target dn stat err =       0.002948563851
      target stat err =       0.002539534840
              std dev =       0.671776895100
             le_variance =       0.451284196790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451290691383
                                         uncertainty =       0.002816667071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451290691383
                                         uncertainty =       0.002816667071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475017998
  error estimate for blocks of size 2^( 2) =       0.000498558716
  error estimate for blocks of size 2^( 3) =       0.000519578540
  error estimate for blocks of size 2^( 4) =       0.000535418237
  error estimate for blocks of size 2^( 5) =       0.000544225740
  error estimate for blocks of size 2^( 6) =       0.000548784649
  error estimate for blocks of size 2^( 7) =       0.000548572506

      target function =      -0.744216167497
              le_mean =     -22.662669850027
             les_mean =     514.047888702492
             stat err =       0.000544250283
             autocorr =       1.312735399942
   target nu stat err =       0.000544250283
   target dn stat err =       0.002948563851
      target stat err =       0.002539534840
              std dev =       0.671776895100
             le_variance =       0.451284196791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451290691383
                                         uncertainty =       0.002816667071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451290691383
                                         uncertainty =       0.002816667071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475017998
  error estimate for blocks of size 2^( 2) =       0.000498558716
  error estimate for blocks of size 2^( 3) =       0.000519578540
  error estimate for blocks of size 2^( 4) =       0.000535418237
  error estimate for blocks of size 2^( 5) =       0.000544225740
  error estimate for blocks of size 2^( 6) =       0.000548784649
  error estimate for blocks of size 2^( 7) =       0.000548572506

      target function =      -0.744216167497
              le_mean =     -22.662669850027
             les_mean =     514.047888702492
             stat err =       0.000544250283
             autocorr =       1.312735399931
   target nu stat err =       0.000544250283
   target dn stat err =       0.002948563851
      target stat err =       0.002539534840
              std dev =       0.671776895100
             le_variance =       0.451284196791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744216167496        initial
     9.7656e+07     9.7656e+08             1.3956e-11        -0.744216167497  <--
     3.9062e+08     3.9062e+09             3.4888e-12        -0.744216167497
     1.5625e+09     1.5625e+10             8.7251e-13        -0.744216167497

*****************************************************************************
Applying the update for shift_i =   9.7656e+07     and shift_s =   9.7656e+08
*****************************************************************************

  Execution time = 6.9218e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2900e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6599
    reference variance = 0.276653
====================================================
  Execution time = 4.4583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4758e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5304e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447691021094
                                         uncertainty =       0.002458906911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447691021094
                                         uncertainty =       0.002458906911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473063858
  error estimate for blocks of size 2^( 2) =       0.000497037004
  error estimate for blocks of size 2^( 3) =       0.000518822569
  error estimate for blocks of size 2^( 4) =       0.000534718478
  error estimate for blocks of size 2^( 5) =       0.000543105925
  error estimate for blocks of size 2^( 6) =       0.000547719347
  error estimate for blocks of size 2^( 7) =       0.000549205378

      target function =      -0.747333209891
              le_mean =     -22.662166246778
             les_mean =     514.021357599577
             stat err =       0.000543687282
             autocorr =       1.320866149061
   target nu stat err =       0.000543687282
   target dn stat err =       0.002680325660
      target stat err =       0.002339394159
              std dev =       0.669013323316
             le_variance =       0.447578826775


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266216624678e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747339587756       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747339587756       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747339587756       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747339568322       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747339577267       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747339553555       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747339558827       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747339597267       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747339644719       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747339577955       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747339611020       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747339560237       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747339551850       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747339590515       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747339581128       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747339528850       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747339534827       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747339624111       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747339638598       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747339588748       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747339647823       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747339586845       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747339595555       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747339556353       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747339591983       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747339614658       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747339519551       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747339595379       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747339658234       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747339570315       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747339643575       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+07 is 2.073691e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747339587756       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747339587756       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747339587756       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747339587756       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747339557965       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747339744065       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747339587756       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747339683559       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747339625183       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747339600349       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747339632281       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747339520464       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747339318589       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747339550271       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747339430019       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747339726978       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747339786205       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747339716942       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747339879801       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747339361430       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747339366083       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747339522824       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747339449654       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747339709631       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747339511823       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747339629899       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747339535396       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747339740149       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747339592170       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747339396277       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747339286671       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+07 is 5.184085e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747339587756       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747339587756       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747339587756       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747339574169       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747339587756       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747339696762       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747339639040       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747338512275       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747338974969       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747339587756       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747339587756       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747338711978       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747338754912       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747339407084       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747340505120       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747340003166       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747339732972       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747339531994       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747340011155       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747339398450       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747340685691       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747338519170       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747338899887       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747340006563       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747339982581       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747339637942       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747339111823       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747338904368       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747338648219       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747339191284       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747342750087       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+08 is 1.297075e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.639081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9926e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6675
    reference variance = 0.271834
====================================================
  Execution time = 4.3692e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5769e-01
  Total weights = 2.0000e+06
  Execution time = 3.6371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457767364986
                                         uncertainty =       0.004742281861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457767364986
                                         uncertainty =       0.004742281861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478377662
  error estimate for blocks of size 2^( 2) =       0.000501877362
  error estimate for blocks of size 2^( 3) =       0.000523484140
  error estimate for blocks of size 2^( 4) =       0.000539092146
  error estimate for blocks of size 2^( 5) =       0.000547539203
  error estimate for blocks of size 2^( 6) =       0.000550156138
  error estimate for blocks of size 2^( 7) =       0.000553287431

      target function =      -0.738902781579
              le_mean =     -22.661964543022
             les_mean =     514.022327094603
             stat err =       0.000547518730
             autocorr =       1.309954398347
   target nu stat err =       0.000547518730
   target dn stat err =       0.004693850660
      target stat err =       0.003911800473
              std dev =       0.676528176992
             le_variance =       0.457690374265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457767364986
                                         uncertainty =       0.004742281861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457767364986
                                         uncertainty =       0.004742281861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478377662
  error estimate for blocks of size 2^( 2) =       0.000501877362
  error estimate for blocks of size 2^( 3) =       0.000523484140
  error estimate for blocks of size 2^( 4) =       0.000539092146
  error estimate for blocks of size 2^( 5) =       0.000547539203
  error estimate for blocks of size 2^( 6) =       0.000550156138
  error estimate for blocks of size 2^( 7) =       0.000553287431

      target function =      -0.738902781579
              le_mean =     -22.661964543022
             les_mean =     514.022327094602
             stat err =       0.000547518730
             autocorr =       1.309954398350
   target nu stat err =       0.000547518730
   target dn stat err =       0.004693850660
      target stat err =       0.003911800473
              std dev =       0.676528176993
             le_variance =       0.457690374265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457767364986
                                         uncertainty =       0.004742281861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457767364986
                                         uncertainty =       0.004742281861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478377662
  error estimate for blocks of size 2^( 2) =       0.000501877362
  error estimate for blocks of size 2^( 3) =       0.000523484140
  error estimate for blocks of size 2^( 4) =       0.000539092146
  error estimate for blocks of size 2^( 5) =       0.000547539203
  error estimate for blocks of size 2^( 6) =       0.000550156138
  error estimate for blocks of size 2^( 7) =       0.000553287431

      target function =      -0.738902781579
              le_mean =     -22.661964543022
             les_mean =     514.022327094602
             stat err =       0.000547518730
             autocorr =       1.309954398353
   target nu stat err =       0.000547518730
   target dn stat err =       0.004693850660
      target stat err =       0.003911800473
              std dev =       0.676528176993
             le_variance =       0.457690374265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457767364986
                                         uncertainty =       0.004742281861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457767364986
                                         uncertainty =       0.004742281861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478377662
  error estimate for blocks of size 2^( 2) =       0.000501877362
  error estimate for blocks of size 2^( 3) =       0.000523484140
  error estimate for blocks of size 2^( 4) =       0.000539092146
  error estimate for blocks of size 2^( 5) =       0.000547539203
  error estimate for blocks of size 2^( 6) =       0.000550156138
  error estimate for blocks of size 2^( 7) =       0.000553287431

      target function =      -0.738902781579
              le_mean =     -22.661964543022
             les_mean =     514.022327094603
             stat err =       0.000547518730
             autocorr =       1.309954398350
   target nu stat err =       0.000547518730
   target dn stat err =       0.004693850660
      target stat err =       0.003911800473
              std dev =       0.676528176993
             le_variance =       0.457690374265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738902781579        initial  <--
     2.4414e+07     2.4414e+08             2.0737e-11        -0.738902781579
     9.7656e+07     9.7656e+08             5.1841e-12        -0.738902781579
     3.9062e+08     3.9062e+09             1.2971e-12        -0.738902781579

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9003
  </log>
  <optVariables href="FORM2.s016.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2183e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6225
    reference variance = 0.493875
====================================================
  Execution time = 4.4563e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5007e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5469e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450112112712
                                         uncertainty =       0.002641469985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450112112712
                                         uncertainty =       0.002641469985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474381240
  error estimate for blocks of size 2^( 2) =       0.000498136016
  error estimate for blocks of size 2^( 3) =       0.000519898348
  error estimate for blocks of size 2^( 4) =       0.000534939944
  error estimate for blocks of size 2^( 5) =       0.000543203815
  error estimate for blocks of size 2^( 6) =       0.000548215435
  error estimate for blocks of size 2^( 7) =       0.000548965448

      target function =      -0.745236322447
              le_mean =     -22.662032893767
             les_mean =     514.017809775098
             stat err =       0.000543831161
             autocorr =       1.314235409970
   target nu stat err =       0.000543831161
   target dn stat err =       0.003044613232
      target stat err =       0.002621894125
              std dev =       0.670876383510
             le_variance =       0.450075121952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266203289377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745244516025       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745244516025       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745244516025       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745244516025       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745244493506       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745244537830       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745244271317       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745244413582       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745244142223       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745244601018       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745244281857       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745244745892       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745243948663       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745244952507       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745245050902       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745244279016       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745244991880       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745244745517       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745244337732       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745244748004       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745244309927       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745244937216       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745244672300       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745244303214       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745244546474       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745244485811       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745243649356       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745245140890       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745243440677       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745245081850       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745242873819       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+08 is 1.723164e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745244516025       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745244516025       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745244516025       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745244516025       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745243806283       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745243916661       residual = 6.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745244753511       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745243675045       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745243675277       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745245356416       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745248383463       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745242087290       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745243564299       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745245030036       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745243379173       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745242492334       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745244488884       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745242745874       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745244391547       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745244066607       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745240937090       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745245700698       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745245969671       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745242166370       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745243914737       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745243799572       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745242963420       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745240801023       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745246279856       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745244123060       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745243477473       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+08 is 4.328428e-13

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745244516025       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745244516025       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745244516025       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745244516025       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745244515944       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745244882514       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745237342216       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745240393382       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745247795076       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745244636408       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745245066694       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745240662749       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745239496095       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745254392865       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745236716422       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745240136758       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745240961227       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745218063990       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745204972967       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745225043941       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745236781510       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745241739630       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745233768792       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745249957911       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745252069313       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745231429144       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745246599955       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745242125147       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745261716744       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745246605922       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745240890034       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745261707998       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745257139109       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745261584132       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745230814272       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745242163815       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+09 is 1.057692e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.677739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0077e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6259
    reference variance = 0.438331
====================================================
  Execution time = 4.4144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.6572e-01
  Total weights = 2.0000e+06
  Execution time = 3.6415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465702738149
                                         uncertainty =       0.010527921393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465702738149
                                         uncertainty =       0.010527921393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482555095
  error estimate for blocks of size 2^( 2) =       0.000505857243
  error estimate for blocks of size 2^( 3) =       0.000527585013
  error estimate for blocks of size 2^( 4) =       0.000543177019
  error estimate for blocks of size 2^( 5) =       0.000552059376
  error estimate for blocks of size 2^( 6) =       0.000556670261
  error estimate for blocks of size 2^( 7) =       0.000558850604

      target function =      -0.732242891417
              le_mean =     -22.662609248299
             les_mean =     514.059576547439
             stat err =       0.000552689315
             autocorr =       1.311802114353
   target nu stat err =       0.000552689315
   target dn stat err =       0.011055414776
      target stat err =       0.008968046739
              std dev =       0.682435959781
             le_variance =       0.465718839203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465702738149
                                         uncertainty =       0.010527921393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465702738149
                                         uncertainty =       0.010527921393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482555095
  error estimate for blocks of size 2^( 2) =       0.000505857243
  error estimate for blocks of size 2^( 3) =       0.000527585013
  error estimate for blocks of size 2^( 4) =       0.000543177019
  error estimate for blocks of size 2^( 5) =       0.000552059376
  error estimate for blocks of size 2^( 6) =       0.000556670261
  error estimate for blocks of size 2^( 7) =       0.000558850604

      target function =      -0.732242891417
              le_mean =     -22.662609248299
             les_mean =     514.059576547439
             stat err =       0.000552689315
             autocorr =       1.311802114352
   target nu stat err =       0.000552689315
   target dn stat err =       0.011055414776
      target stat err =       0.008968046739
              std dev =       0.682435959782
             le_variance =       0.465718839203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465702738149
                                         uncertainty =       0.010527921393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465702738149
                                         uncertainty =       0.010527921393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482555095
  error estimate for blocks of size 2^( 2) =       0.000505857243
  error estimate for blocks of size 2^( 3) =       0.000527585013
  error estimate for blocks of size 2^( 4) =       0.000543177019
  error estimate for blocks of size 2^( 5) =       0.000552059376
  error estimate for blocks of size 2^( 6) =       0.000556670261
  error estimate for blocks of size 2^( 7) =       0.000558850604

      target function =      -0.732242891417
              le_mean =     -22.662609248299
             les_mean =     514.059576547439
             stat err =       0.000552689315
             autocorr =       1.311802114358
   target nu stat err =       0.000552689315
   target dn stat err =       0.011055414776
      target stat err =       0.008968046739
              std dev =       0.682435959782
             le_variance =       0.465718839203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465702738149
                                         uncertainty =       0.010527921393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465702738149
                                         uncertainty =       0.010527921393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482555095
  error estimate for blocks of size 2^( 2) =       0.000505857243
  error estimate for blocks of size 2^( 3) =       0.000527585013
  error estimate for blocks of size 2^( 4) =       0.000543177019
  error estimate for blocks of size 2^( 5) =       0.000552059376
  error estimate for blocks of size 2^( 6) =       0.000556670261
  error estimate for blocks of size 2^( 7) =       0.000558850604

      target function =      -0.732242891417
              le_mean =     -22.662609248299
             les_mean =     514.059576547439
             stat err =       0.000552689315
             autocorr =       1.311802114354
   target nu stat err =       0.000552689315
   target dn stat err =       0.011055414776
      target stat err =       0.008968046739
              std dev =       0.682435959781
             le_variance =       0.465718839203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.732242891417        initial
     2.4414e+08     2.4414e+09             1.7232e-12        -0.732242891417
     9.7656e+08     9.7656e+09             4.3284e-13        -0.732242891417
     3.9062e+09     3.9062e+10             1.0577e-13        -0.732242891417  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+09     and shift_s =   3.9062e+10
*****************************************************************************

  Execution time = 6.2382e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2247e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7041
    reference variance = 0.290739
====================================================
  Execution time = 4.4910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5564e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5263e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455793931942
                                         uncertainty =       0.006466718358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455793931942
                                         uncertainty =       0.006466718358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477302881
  error estimate for blocks of size 2^( 2) =       0.000500911157
  error estimate for blocks of size 2^( 3) =       0.000522389726
  error estimate for blocks of size 2^( 4) =       0.000537523728
  error estimate for blocks of size 2^( 5) =       0.000545934721
  error estimate for blocks of size 2^( 6) =       0.000550811715
  error estimate for blocks of size 2^( 7) =       0.000555621733

      target function =      -0.740568836783
              le_mean =     -22.662291821624
             les_mean =     514.035106461061
             stat err =       0.000547472974
             autocorr =       1.315640576043
   target nu stat err =       0.000547472974
   target dn stat err =       0.006846123393
      target stat err =       0.005697023835
              std dev =       0.675008207688
             le_variance =       0.455636080446


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266229182162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740611254946       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740611254946       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740611254946       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740611639856       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740610925517       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740612213649       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740612208100       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740609566933       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740610121690       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740607417067       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740609187173       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740611165218       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740613408201       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740611479070       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740612643373       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740610491826       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740611317375       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740609772189       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740609844052       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740612289690       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740609876708       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740612395544       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740609420159       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740610344935       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740610746618       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740612995731       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740613973574       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740607774444       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740612928292       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740608064271       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740611374401       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740605654184       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740602728399       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.740613126299       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         33 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+08 is 6.523143e-13

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740611254946       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740611254946       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740611254946       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740613850487       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740609808046       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740611254945       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740610332812       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740604885407       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740620429388       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740608952273       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740615454559       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740618582433       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740619671920       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740612486140       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740609842078       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740612352074       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740619530608       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740615094234       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740612019137       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740613238193       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740603157067       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740605987399       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740616511268       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740616399596       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740602726799       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740602968326       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740609929072       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740626008157       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740608060525       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740606864507       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740591951591       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740606541332       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740585693905       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.740631850112       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.740601896980       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.740600464196       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.740637998006       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.740608926458       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.740598834970       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.740618648641       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.740613041685       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.740630017961       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.740603679171       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.740585926718       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.740559636390       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.740627364166       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.740576240409       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.740620422226       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.740473292651       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.740773913092       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.740266257798       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.740470625340       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.740982837558       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.742673073644       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.737988872209       residual = 3.59e-03           smallest_sin_value = 9.99e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+09 is 1.616651e-13

solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740611254946       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740611254946       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740611254946       residual = 7.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740611254946       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740611254946       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740606862944       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740605152796       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740611254946       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740634413095       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740614148103       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740604804981       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740660010623       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740601435226       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740628749010       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740628493252       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740612897793       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740657634819       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740596181168       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740621176904       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740610904779       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740549465053       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740629988854       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740600140733       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740612034312       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740656941215       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740599563141       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740603631102       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740609003037       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740524618592       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740606743046       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740583244553       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740692414212       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.740541699180       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.740484209416       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.740611080944       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.740514487507       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.740341926579       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.740394334482       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.740727448245       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.740564986825       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.740470884124       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.740842808957       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.740257747374       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.741017963820       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.740499189287       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.740528386084       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.739971188172       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.741288424104       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745007190448       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.741272619529       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.742914749886       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.740403103332       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   52 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+10 is 4.094912e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.802963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0304e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6407
    reference variance = 0.473737
====================================================
  Execution time = 4.3862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5967e-01
  Total weights = 2.0000e+06
  Execution time = 4.1653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459711651812
                                         uncertainty =       0.005460912172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459711651812
                                         uncertainty =       0.005460912172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479409907
  error estimate for blocks of size 2^( 2) =       0.000503327252
  error estimate for blocks of size 2^( 3) =       0.000525008914
  error estimate for blocks of size 2^( 4) =       0.000540656884
  error estimate for blocks of size 2^( 5) =       0.000549316641
  error estimate for blocks of size 2^( 6) =       0.000555049315
  error estimate for blocks of size 2^( 7) =       0.000558906789

      target function =      -0.737264393024
              le_mean =     -22.662246582438
             les_mean =     514.037087650907
             stat err =       0.000550982407
             autocorr =       1.320874194096
   target nu stat err =       0.000550982407
   target dn stat err =       0.005478014773
      target stat err =       0.004533051434
              std dev =       0.677987992166
             le_variance =       0.459667717522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459711651812
                                         uncertainty =       0.005460912172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459711651812
                                         uncertainty =       0.005460912172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479409907
  error estimate for blocks of size 2^( 2) =       0.000503327252
  error estimate for blocks of size 2^( 3) =       0.000525008914
  error estimate for blocks of size 2^( 4) =       0.000540656884
  error estimate for blocks of size 2^( 5) =       0.000549316641
  error estimate for blocks of size 2^( 6) =       0.000555049315
  error estimate for blocks of size 2^( 7) =       0.000558906789

      target function =      -0.737264393024
              le_mean =     -22.662246582438
             les_mean =     514.037087650907
             stat err =       0.000550982407
             autocorr =       1.320874194095
   target nu stat err =       0.000550982407
   target dn stat err =       0.005478014773
      target stat err =       0.004533051434
              std dev =       0.677987992166
             le_variance =       0.459667717522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459711651812
                                         uncertainty =       0.005460912172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459711651812
                                         uncertainty =       0.005460912172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479409907
  error estimate for blocks of size 2^( 2) =       0.000503327252
  error estimate for blocks of size 2^( 3) =       0.000525008914
  error estimate for blocks of size 2^( 4) =       0.000540656884
  error estimate for blocks of size 2^( 5) =       0.000549316641
  error estimate for blocks of size 2^( 6) =       0.000555049315
  error estimate for blocks of size 2^( 7) =       0.000558906789

      target function =      -0.737264393024
              le_mean =     -22.662246582438
             les_mean =     514.037087650907
             stat err =       0.000550982407
             autocorr =       1.320874194095
   target nu stat err =       0.000550982407
   target dn stat err =       0.005478014773
      target stat err =       0.004533051434
              std dev =       0.677987992166
             le_variance =       0.459667717522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459711651812
                                         uncertainty =       0.005460912172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459711651812
                                         uncertainty =       0.005460912172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479409907
  error estimate for blocks of size 2^( 2) =       0.000503327252
  error estimate for blocks of size 2^( 3) =       0.000525008914
  error estimate for blocks of size 2^( 4) =       0.000540656884
  error estimate for blocks of size 2^( 5) =       0.000549316641
  error estimate for blocks of size 2^( 6) =       0.000555049315
  error estimate for blocks of size 2^( 7) =       0.000558906789

      target function =      -0.737264393024
              le_mean =     -22.662246582438
             les_mean =     514.037087650907
             stat err =       0.000550982407
             autocorr =       1.320874194095
   target nu stat err =       0.000550982407
   target dn stat err =       0.005478014773
      target stat err =       0.004533051434
              std dev =       0.677987992167
             le_variance =       0.459667717522


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737264393024        initial  <--
     9.7656e+08     9.7656e+09             6.5231e-13        -0.737264393024
     3.9062e+09     3.9062e+10             1.6167e-13        -0.737264393024
     1.5625e+10     1.5625e+11             4.0949e-14        -0.737264393024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.8302
  </log>
  <optVariables href="FORM2.s018.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2314e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6526
    reference variance = 0.500498
====================================================
  Execution time = 4.5412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5036e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5102e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450379852516
                                         uncertainty =       0.003413238047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450379852516
                                         uncertainty =       0.003413238047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474529144
  error estimate for blocks of size 2^( 2) =       0.000498683544
  error estimate for blocks of size 2^( 3) =       0.000521945182
  error estimate for blocks of size 2^( 4) =       0.000538918685
  error estimate for blocks of size 2^( 5) =       0.000549733433
  error estimate for blocks of size 2^( 6) =       0.000556794005
  error estimate for blocks of size 2^( 7) =       0.000563696102

      target function =      -0.745000884227
              le_mean =     -22.661970187213
             les_mean =     514.015248357786
             stat err =       0.000552285557
             autocorr =       1.354570428736
   target nu stat err =       0.000552285557
   target dn stat err =       0.003978321064
      target stat err =       0.003386496393
              std dev =       0.671085551044
             le_variance =       0.450355816820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266197018721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745010352642       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745010352642       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745010352642       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745014694044       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745015675823       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745010352642       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745017407970       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745020571832       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744981516437       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744983885806       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744996549922       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745004757506       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745013999619       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745024169107       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745029805141       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745018825090       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745016713584       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745004746682       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745018560153       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745014869655       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745015728574       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744964464222       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745018912700       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745008661118       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745016753563       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745025134497       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745002174442       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745015941525       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745008906276       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744963438201       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745003174554       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744898921349       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745040897460       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745016269642       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744952792091       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744999919671       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744976787625       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745075485968       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745000902856       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744952104823       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744990782723       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.744988781540       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.745023788972       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744934492943       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.744884378720       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745211885052       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745092176350       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745251610090       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.744995941554       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.745444805305       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.744216915906       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.744469936862       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.744331841181       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.739053166334       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.744736347360       residual = 5.41e-03           smallest_sin_value = 9.93e-01
davidson iteration   55 stopping due to small subspace S singular value of 6.37e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+09 is 3.300603e-14

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745010352642       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745010352642       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745010352642       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745010352642       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745010352652       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744996366644       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745040604945       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745010352642       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745001149185       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745001557526       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745033295236       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744949399763       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744970036213       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744925854772       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744868429419       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745169351689       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745005479185       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744993070795       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744973650479       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745015218588       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745076132670       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745080496410       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745039328384       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745018281448       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745066997032       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745221766957       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745018305945       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744921097900       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744964786986       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745054213473       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744994376883       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745119839620       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745020532423       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744820988775       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745180805773       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744903490551       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744156812701       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.744567179074       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745153427067       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745532568064       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744822987504       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745013342817       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744573009088       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.745080560682       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.744379017434       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744897350654       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746086417669       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.749472888350       residual = 9.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.739084138147       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.762686669072       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.725815042830       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.740577477255       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.731536145710       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   53 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+10 is 8.562596e-15

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745010352642       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745010352642       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745010352642       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745010352642       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745008520509       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744936544292       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745039758236       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745062087989       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744885650699       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744555383354       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744844878561       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745186441956       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744275079560       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744755594341       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745314575000       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745101115269       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744944699359       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745562057439       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744937268063       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745141551037       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744714149955       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745373047427       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744818753087       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745533143781       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743553153875       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746144738495       residual = 6.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745705606660       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743549275005       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746323219393       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745087121536       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743495428915       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745548611654       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747459056927       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.748373980049       residual = 5.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.743389121136       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746200941559       residual = 7.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.745019042525       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749033705822       residual = 7.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746355328331       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744803984132       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.745164301571       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.745304529538       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.740622257977       residual = 9.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.742465768985       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.740492454661       residual = 9.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.758592819357       residual = 8.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.735915034179       residual = 4.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744394990488       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.738520462569       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.749180815415       residual = 4.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.717585803041       residual = 3.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.759649140573       residual = 2.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.790854051861       residual = 3.76e+00           smallest_sin_value = 9.99e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.56e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+11 is 1.335660e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.973239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0691e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6636
    reference variance = 0.663595
====================================================
  Execution time = 4.4036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.6147e-01
  Total weights = 2.0000e+06
  Execution time = 3.6395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461353129741
                                         uncertainty =       0.004442884824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461353129741
                                         uncertainty =       0.004442884824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480347829
  error estimate for blocks of size 2^( 2) =       0.000503589546
  error estimate for blocks of size 2^( 3) =       0.000524918153
  error estimate for blocks of size 2^( 4) =       0.000540206670
  error estimate for blocks of size 2^( 5) =       0.000548324607
  error estimate for blocks of size 2^( 6) =       0.000553652318
  error estimate for blocks of size 2^( 7) =       0.000556319416

      target function =      -0.735786366332
              le_mean =     -22.662619479444
             les_mean =     514.055789513517
             stat err =       0.000549625753
             autocorr =       1.309249695720
   target nu stat err =       0.000549625753
   target dn stat err =       0.004972486581
      target stat err =       0.004108477526
              std dev =       0.679314414830
             le_variance =       0.461468074195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461353129741
                                         uncertainty =       0.004442884824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461353129741
                                         uncertainty =       0.004442884824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480347829
  error estimate for blocks of size 2^( 2) =       0.000503589546
  error estimate for blocks of size 2^( 3) =       0.000524918153
  error estimate for blocks of size 2^( 4) =       0.000540206670
  error estimate for blocks of size 2^( 5) =       0.000548324607
  error estimate for blocks of size 2^( 6) =       0.000553652318
  error estimate for blocks of size 2^( 7) =       0.000556319416

      target function =      -0.735786366332
              le_mean =     -22.662619479444
             les_mean =     514.055789513517
             stat err =       0.000549625753
             autocorr =       1.309249695722
   target nu stat err =       0.000549625753
   target dn stat err =       0.004972486581
      target stat err =       0.004108477526
              std dev =       0.679314414830
             le_variance =       0.461468074195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461353129741
                                         uncertainty =       0.004442884824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461353129741
                                         uncertainty =       0.004442884824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480347829
  error estimate for blocks of size 2^( 2) =       0.000503589546
  error estimate for blocks of size 2^( 3) =       0.000524918153
  error estimate for blocks of size 2^( 4) =       0.000540206670
  error estimate for blocks of size 2^( 5) =       0.000548324607
  error estimate for blocks of size 2^( 6) =       0.000553652318
  error estimate for blocks of size 2^( 7) =       0.000556319416

      target function =      -0.735786366332
              le_mean =     -22.662619479444
             les_mean =     514.055789513517
             stat err =       0.000549625753
             autocorr =       1.309249695720
   target nu stat err =       0.000549625753
   target dn stat err =       0.004972486581
      target stat err =       0.004108477526
              std dev =       0.679314414830
             le_variance =       0.461468074195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461353129741
                                         uncertainty =       0.004442884824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.461353129741
                                         uncertainty =       0.004442884824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480347829
  error estimate for blocks of size 2^( 2) =       0.000503589546
  error estimate for blocks of size 2^( 3) =       0.000524918153
  error estimate for blocks of size 2^( 4) =       0.000540206670
  error estimate for blocks of size 2^( 5) =       0.000548324607
  error estimate for blocks of size 2^( 6) =       0.000553652318
  error estimate for blocks of size 2^( 7) =       0.000556319416

      target function =      -0.735786366332
              le_mean =     -22.662619479444
             les_mean =     514.055789513517
             stat err =       0.000549625753
             autocorr =       1.309249695720
   target nu stat err =       0.000549625753
   target dn stat err =       0.004972486581
      target stat err =       0.004108477526
              std dev =       0.679314414830
             le_variance =       0.461468074195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.735786366332        initial  <--
     9.7656e+09     9.7656e+10             3.3006e-14        -0.735786366332
     3.9062e+10     3.9062e+11             8.5626e-15        -0.735786366332
     1.5625e+11     1.5625e+12             1.3357e-15        -0.735786366332

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.2705
  </log>
  <optVariables href="FORM2.s019.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2297e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7059
    reference variance = 0.707962
====================================================
  Execution time = 4.4484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.6037e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5197e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460289651558
                                         uncertainty =       0.006913017964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460289651558
                                         uncertainty =       0.006913017964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479777099
  error estimate for blocks of size 2^( 2) =       0.000503550591
  error estimate for blocks of size 2^( 3) =       0.000524633204
  error estimate for blocks of size 2^( 4) =       0.000540029189
  error estimate for blocks of size 2^( 5) =       0.000548212689
  error estimate for blocks of size 2^( 6) =       0.000551809838
  error estimate for blocks of size 2^( 7) =       0.000555366815

      target function =      -0.736657314551
              le_mean =     -22.662797711380
             les_mean =     514.062772006350
             stat err =       0.000548854633
             autocorr =       1.308686553129
   target nu stat err =       0.000548854633
   target dn stat err =       0.006844372645
      target stat err =       0.005640397112
              std dev =       0.678507280443
             le_variance =       0.460372129614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266279771138e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736700041224       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736700041224       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736700041224       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736700041224       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736725920940       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736658416108       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736648722151       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736719927825       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736461971649       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736349785382       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736624582168       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736501001504       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736728379828       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736651186922       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736554464499       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736518857037       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736594378554       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736593661517       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736267290820       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736443422332       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736638183447       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.737071639800       residual = 8.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736554056555       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736602332148       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.735977655642       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.737351126378       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736895441193       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736568181944       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736809000422       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.736640727329       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736991968207       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.736786224375       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.736618157045       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.736610548850       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.737286366726       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.736753564107       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.735527313081       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.737364827121       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.735845643096       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.736720749646       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.739728450057       residual = 4.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.737708531640       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.736327606273       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.736187294260       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.737697592824       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.737665221746       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.737412903286       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.735388594295       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.739105056595       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.731445889903       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.708933561430       residual = 4.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.732978189022       residual = 3.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.824788969318       residual = 3.82e+00           smallest_sin_value = 9.99e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+10 is 3.101691e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736700041224       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736700041224       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736700041224       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736700041224       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736630136653       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737265229699       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736441278327       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736671701086       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737092417255       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736551659852       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736022245216       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736155239993       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.735612138191       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736943655976       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736094909976       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.735707786508       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736953799398       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.734075807006       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.733936675182       residual = 3.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737169514171       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736902334598       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736355079529       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.738798069717       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.734849630244       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734421136296       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.730798961141       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739567580176       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.735643503166       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.738211918500       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.733617677802       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.739291317732       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.733397146587       residual = 5.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.730565385659       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.737854591102       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.736596622217       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.732643410572       residual = 7.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.739701368027       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.736940809794       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.737765557706       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.739729621837       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.734377299641       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.736886083078       residual = 8.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.735290956965       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.736160225962       residual = 8.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.737119864551       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.725712300847       residual = 5.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.751919514504       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.737698965416       residual = 9.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.698108976489       residual = 7.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.649387089510       residual = 3.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.739415372607       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.562615182803       residual = 1.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.785788943866       residual = 3.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.992361215564       residual = 3.69e+01           smallest_sin_value = 9.96e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.00e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+11 is 9.923875e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736700041224       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736700041224       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736700041224       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737163703212       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736719191244       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735110053682       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736218254959       residual = 9.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736462805306       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737544612679       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738752304090       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.733668803332       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736043260411       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736491030730       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.738124181602       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.735575227315       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736700254158       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.730390884000       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.737246014705       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.737510779969       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.735894867488       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738940802543       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.731226978591       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.737426272531       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743523065123       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.737427244990       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.739634077452       residual = 7.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736111646345       residual = 9.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742087123548       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.724662382766       residual = 6.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.731360435257       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.718879188255       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.736537111637       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.727171222539       residual = 4.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.730362647077       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.713372702164       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.728253784279       residual = 6.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741130901580       residual = 5.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746248641401       residual = 6.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.729299227279       residual = 6.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.749197044789       residual = 8.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.736403614856       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.740877270220       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.768656478479       residual = 5.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.739620381916       residual = 4.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.793094710760       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.755138706438       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.693868859261       residual = 9.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.781624031827       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.727609245549       residual = 4.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.643143048643       residual = 4.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.009126522816       residual = 3.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.649471307054       residual = 4.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -1.384223996763       residual = 2.26e+02           smallest_sin_value = 9.95e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.44e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+12 is 8.763462e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.143600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9857e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7677
    reference variance = 0.307602
====================================================
  Execution time = 4.4214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4685e-01
  Total weights = 2.0000e+06
  Execution time = 4.2492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446827145230
                                         uncertainty =       0.002485125302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446827145230
                                         uncertainty =       0.002485125302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472680405
  error estimate for blocks of size 2^( 2) =       0.000496732816
  error estimate for blocks of size 2^( 3) =       0.000518744901
  error estimate for blocks of size 2^( 4) =       0.000534589496
  error estimate for blocks of size 2^( 5) =       0.000543422848
  error estimate for blocks of size 2^( 6) =       0.000547280889
  error estimate for blocks of size 2^( 7) =       0.000549740056

      target function =      -0.747945118576
              le_mean =     -22.662165867807
             les_mean =     514.020615127941
             stat err =       0.000543758322
             autocorr =       1.323355828942
   target nu stat err =       0.000543758322
   target dn stat err =       0.002573650334
      target stat err =       0.002256372409
              std dev =       0.668471040054
             le_variance =       0.446853531391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446827145230
                                         uncertainty =       0.002485125302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446827145230
                                         uncertainty =       0.002485125302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472680405
  error estimate for blocks of size 2^( 2) =       0.000496732816
  error estimate for blocks of size 2^( 3) =       0.000518744901
  error estimate for blocks of size 2^( 4) =       0.000534589496
  error estimate for blocks of size 2^( 5) =       0.000543422848
  error estimate for blocks of size 2^( 6) =       0.000547280889
  error estimate for blocks of size 2^( 7) =       0.000549740056

      target function =      -0.747945118576
              le_mean =     -22.662165867807
             les_mean =     514.020615127941
             stat err =       0.000543758322
             autocorr =       1.323355828936
   target nu stat err =       0.000543758322
   target dn stat err =       0.002573650334
      target stat err =       0.002256372409
              std dev =       0.668471040054
             le_variance =       0.446853531391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446827145230
                                         uncertainty =       0.002485125302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446827145230
                                         uncertainty =       0.002485125302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472680405
  error estimate for blocks of size 2^( 2) =       0.000496732816
  error estimate for blocks of size 2^( 3) =       0.000518744901
  error estimate for blocks of size 2^( 4) =       0.000534589496
  error estimate for blocks of size 2^( 5) =       0.000543422848
  error estimate for blocks of size 2^( 6) =       0.000547280889
  error estimate for blocks of size 2^( 7) =       0.000549740056

      target function =      -0.747945118576
              le_mean =     -22.662165867807
             les_mean =     514.020615127941
             stat err =       0.000543758322
             autocorr =       1.323355828940
   target nu stat err =       0.000543758322
   target dn stat err =       0.002573650334
      target stat err =       0.002256372409
              std dev =       0.668471040054
             le_variance =       0.446853531391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446827145230
                                         uncertainty =       0.002485125302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446827145230
                                         uncertainty =       0.002485125302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472680405
  error estimate for blocks of size 2^( 2) =       0.000496732816
  error estimate for blocks of size 2^( 3) =       0.000518744901
  error estimate for blocks of size 2^( 4) =       0.000534589496
  error estimate for blocks of size 2^( 5) =       0.000543422848
  error estimate for blocks of size 2^( 6) =       0.000547280889
  error estimate for blocks of size 2^( 7) =       0.000549740056

      target function =      -0.747945118576
              le_mean =     -22.662165867807
             les_mean =     514.020615127941
             stat err =       0.000543758322
             autocorr =       1.323355828940
   target nu stat err =       0.000543758322
   target dn stat err =       0.002573650334
      target stat err =       0.002256372409
              std dev =       0.668471040054
             le_variance =       0.446853531391


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747945118576        initial
     9.7656e+10     9.7656e+11             3.1017e-15        -0.747945118576
     3.9062e+11     3.9062e+12             9.9239e-16        -0.747945118576
     1.5625e+12     1.5625e+13             8.7635e-17        -0.747945118576  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+12     and shift_s =   1.5625e+13
*****************************************************************************

  Execution time = 6.3078e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2294e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.5991
    reference variance = 0.31286
====================================================
  Execution time = 4.6935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.7432e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5135e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474486612792
                                         uncertainty =       0.014557461951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474486612792
                                         uncertainty =       0.014557461951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486990658
  error estimate for blocks of size 2^( 2) =       0.000510227434
  error estimate for blocks of size 2^( 3) =       0.000531472611
  error estimate for blocks of size 2^( 4) =       0.000546453856
  error estimate for blocks of size 2^( 5) =       0.000555550333
  error estimate for blocks of size 2^( 6) =       0.000557268863
  error estimate for blocks of size 2^( 7) =       0.000561677313

      target function =      -0.725287103678
              le_mean =     -22.661879761837
             les_mean =     514.035113905242
             stat err =       0.000555237592
             autocorr =       1.299919511926
   target nu stat err =       0.000555237592
   target dn stat err =       0.015175840021
      target stat err =       0.012053238367
              std dev =       0.688708793646
             le_variance =       0.474319802446


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266187976184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.725485626316       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.725485626316       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.725485626316       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.725485626316       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.725485626124       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.725510058949       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.725641158777       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.726052076608       residual = 4.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.725682298319       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.725439824905       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.725779480519       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.725359685386       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.726784977001       residual = 8.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.726532927831       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.725885937125       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.725169917366       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.724617164477       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.725648733033       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.726289131457       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.724797804014       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.725176222552       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.725109470950       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.726999563075       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.724961472469       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.726049292928       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.727725613354       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.723451116807       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.722889749727       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.721553521838       residual = 7.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.724833526351       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.721058441776       residual = 9.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.727885234970       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.731728786268       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.726671118820       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.722929499661       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.722762789222       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.729845473973       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.726926457036       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.733091487826       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.735231865389       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.731630727397       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.722527055617       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.728818139313       residual = 6.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.727042621936       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.734534862727       residual = 3.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.719023428362       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.723604161079       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.770172057435       residual = 9.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747492201576       residual = 2.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.741296562371       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.722358969165       residual = 3.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.775859771898       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.506631299205       residual = 2.82e+01           smallest_sin_value = 9.99e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+11 is 1.818834e-15

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.725485626316       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.725485626316       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.725485626316       residual = 4.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.725485626316       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.724564606071       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.725797308530       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724862167135       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.724086665783       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.727824365947       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.725524928375       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.727833275161       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.723518716480       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.726028815016       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.729431662232       residual = 9.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.726849018037       residual = 8.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.730493834690       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.719493045218       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.738283589572       residual = 8.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.720781958861       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.728756340711       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.725963193412       residual = 7.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.729606405234       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.725065632699       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.727964188432       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.723641950576       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.722230500947       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.726443746527       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.712564953109       residual = 7.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.720725586932       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.724404726289       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.713754882756       residual = 6.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.732736404285       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.724005417297       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.724230051743       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.737355918640       residual = 8.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.709785550991       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.677856834550       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.709591523135       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.725880454721       residual = 8.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.735652426970       residual = 7.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.774805059548       residual = 1.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.706963757756       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.781104795419       residual = 1.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.697279849369       residual = 4.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.727555862306       residual = 3.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.681942159282       residual = 9.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.671188566041       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.753014992556       residual = 7.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.752370455883       residual = 3.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.021307116933       residual = 4.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =       1.537969061760       residual = 2.47e+03           smallest_sin_value = 9.97e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.134714073739       residual = 1.66e+02           smallest_sin_value = 9.97e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+12 is 7.967664e-17

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.725485626316       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.725485626316       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.254161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.2186e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6248
    reference variance = 0.476337
====================================================
  Execution time = 4.4193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6498e-01
  Total weights = 2.0000e+06
  Execution time = 3.6407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464794637402
                                         uncertainty =       0.007145865896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464794637402
                                         uncertainty =       0.007145865896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482171187
  error estimate for blocks of size 2^( 2) =       0.000505797445
  error estimate for blocks of size 2^( 3) =       0.000527313564
  error estimate for blocks of size 2^( 4) =       0.000543427423
  error estimate for blocks of size 2^( 5) =       0.000552085824
  error estimate for blocks of size 2^( 6) =       0.000555932532
  error estimate for blocks of size 2^( 7) =       0.000559375021

      target function =      -0.732924971158
              le_mean =     -22.662052389422
             les_mean =     514.033596375520
             stat err =       0.000552705200
             autocorr =       1.313967402342
   target nu stat err =       0.000552705200
   target dn stat err =       0.007103440361
      target stat err =       0.005786565539
              std dev =       0.681893031999
             le_variance =       0.464978107088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464794637402
                                         uncertainty =       0.007145865896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464794637402
                                         uncertainty =       0.007145865896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482171187
  error estimate for blocks of size 2^( 2) =       0.000505797445
  error estimate for blocks of size 2^( 3) =       0.000527313564
  error estimate for blocks of size 2^( 4) =       0.000543427423
  error estimate for blocks of size 2^( 5) =       0.000552085824
  error estimate for blocks of size 2^( 6) =       0.000555932532
  error estimate for blocks of size 2^( 7) =       0.000559375021

      target function =      -0.732924971158
              le_mean =     -22.662052389422
             les_mean =     514.033596375520
             stat err =       0.000552705200
             autocorr =       1.313967402343
   target nu stat err =       0.000552705200
   target dn stat err =       0.007103440361
      target stat err =       0.005786565539
              std dev =       0.681893031998
             le_variance =       0.464978107088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464794637402
                                         uncertainty =       0.007145865896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464794637402
                                         uncertainty =       0.007145865896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482171187
  error estimate for blocks of size 2^( 2) =       0.000505797445
  error estimate for blocks of size 2^( 3) =       0.000527313564
  error estimate for blocks of size 2^( 4) =       0.000543427423
  error estimate for blocks of size 2^( 5) =       0.000552085824
  error estimate for blocks of size 2^( 6) =       0.000555932532
  error estimate for blocks of size 2^( 7) =       0.000559375021

      target function =      -0.732924971158
              le_mean =     -22.662052389422
             les_mean =     514.033596375520
             stat err =       0.000552705200
             autocorr =       1.313967402343
   target nu stat err =       0.000552705200
   target dn stat err =       0.007103440361
      target stat err =       0.005786565539
              std dev =       0.681893031998
             le_variance =       0.464978107088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464794637402
                                         uncertainty =       0.007145865896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464794637402
                                         uncertainty =       0.007145865896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482171187
  error estimate for blocks of size 2^( 2) =       0.000505797445
  error estimate for blocks of size 2^( 3) =       0.000527313564
  error estimate for blocks of size 2^( 4) =       0.000543427423
  error estimate for blocks of size 2^( 5) =       0.000552085824
  error estimate for blocks of size 2^( 6) =       0.000555932532
  error estimate for blocks of size 2^( 7) =       0.000559375021

      target function =      -0.732924971158
              le_mean =     -22.662052389422
             les_mean =     514.033596375520
             stat err =       0.000552705200
             autocorr =       1.313967402342
   target nu stat err =       0.000552705200
   target dn stat err =       0.007103440361
      target stat err =       0.005786565539
              std dev =       0.681893031999
             le_variance =       0.464978107088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.732924971158        initial
     3.9062e+11     3.9062e+12             1.8188e-15        -0.732924971158
     1.5625e+12     1.5625e+13             7.9677e-17        -0.732924971158  <--
     6.2500e+12     6.2500e+13             0.0000e+00        -0.732924971158

*****************************************************************************
Applying the update for shift_i =   1.5625e+12     and shift_s =   1.5625e+13
*****************************************************************************

  Execution time = 6.2439e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2463e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.5568
    reference variance = 0.418819
====================================================
  Execution time = 4.4631e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5460e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5099e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454644773679
                                         uncertainty =       0.006032850563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454644773679
                                         uncertainty =       0.006032850563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476762339
  error estimate for blocks of size 2^( 2) =       0.000500595179
  error estimate for blocks of size 2^( 3) =       0.000522260675
  error estimate for blocks of size 2^( 4) =       0.000537014287
  error estimate for blocks of size 2^( 5) =       0.000546076789
  error estimate for blocks of size 2^( 6) =       0.000549223991
  error estimate for blocks of size 2^( 7) =       0.000549672820

      target function =      -0.741437814060
              le_mean =     -22.661872661669
             les_mean =     514.015076961705
             stat err =       0.000545496972
             autocorr =       1.309124060217
   target nu stat err =       0.000545496972
   target dn stat err =       0.006271142698
      target stat err =       0.005232884525
              std dev =       0.674243765486
             le_variance =       0.454604655297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266187266167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741473411665       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741473411665       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741473411665       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741594642183       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741308541974       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741738177712       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741637406349       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741114474258       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741186483519       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742348264900       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741641890069       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740587019579       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741659015077       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740376643994       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740202508615       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740536644280       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741378192215       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742427124871       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748253513139       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741226881423       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740600641005       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740743989795       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741875794063       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740717699861       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740275545751       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743746234832       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744851273418       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747216870740       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742512356289       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740049001703       residual = 9.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.737009534377       residual = 9.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.739365706539       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744325672467       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742599455258       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.734746009896       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.739964819156       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.749160894241       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.742348665625       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741205269235       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743779102599       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.738492354981       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.734030663140       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.740411841457       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743740343395       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742993570641       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.752728100766       residual = 5.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.725880686923       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742385241623       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.740233781204       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.708044694128       residual = 5.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.959532291393       residual = 2.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.026161533418       residual = 3.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.523948149472       residual = 2.30e+01           smallest_sin_value = 9.99e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+11 is 5.079445e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741473411665       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741473411665       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741473411665       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741473411665       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741399395425       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741840069879       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741440536037       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742291749307       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745183624847       residual = 7.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739382784183       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744067406293       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740771261859       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740874867426       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740128431145       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744283963457       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.737634044303       residual = 8.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746674408171       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750607736441       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.733889571292       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743716687012       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742445958279       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.733522475958       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743445966336       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742650917691       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746196865251       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.734442483968       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745773845920       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748255571638       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.730062256907       residual = 6.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.738105921805       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.732947060118       residual = 3.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.739698035576       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746410110175       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.740713140645       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745486721027       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749820331911       residual = 4.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741291440661       residual = 4.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.754649143813       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.741709328285       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.723522199421       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.735445296247       residual = 4.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.723897916557       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.718551191301       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.717405829399       residual = 2.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.726967933176       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.734314149687       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.696207144166       residual = 9.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.725482029657       residual = 2.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.677649790974       residual = 5.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.626956143203       residual = 8.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.930301820214       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.840365371887       residual = 6.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =       0.183628437226       residual = 4.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -1.606730312463       residual = 5.10e+02           smallest_sin_value = 9.96e-01
davidson iteration   54 stopping due to small subspace S singular value of 7.91e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+12 is 4.598260e-17

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741473411665       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741473411665       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.370467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9852e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6324
    reference variance = 0.276095
====================================================
  Execution time = 4.3714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4888e-01
  Total weights = 2.0000e+06
  Execution time = 3.6412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448860293963
                                         uncertainty =       0.002855103900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448860293963
                                         uncertainty =       0.002855103900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473753508
  error estimate for blocks of size 2^( 2) =       0.000497324788
  error estimate for blocks of size 2^( 3) =       0.000519003440
  error estimate for blocks of size 2^( 4) =       0.000534141596
  error estimate for blocks of size 2^( 5) =       0.000543702555
  error estimate for blocks of size 2^( 6) =       0.000549247991
  error estimate for blocks of size 2^( 7) =       0.000553772287

      target function =      -0.746225044922
              le_mean =     -22.662913180223
             les_mean =     514.056518362934
             stat err =       0.000545216107
             autocorr =       1.324440575610
   target nu stat err =       0.000545216107
   target dn stat err =       0.002785431794
      target stat err =       0.002421155657
              std dev =       0.669988636498
             le_variance =       0.448884773036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448860293963
                                         uncertainty =       0.002855103900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448860293963
                                         uncertainty =       0.002855103900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473753508
  error estimate for blocks of size 2^( 2) =       0.000497324788
  error estimate for blocks of size 2^( 3) =       0.000519003440
  error estimate for blocks of size 2^( 4) =       0.000534141596
  error estimate for blocks of size 2^( 5) =       0.000543702555
  error estimate for blocks of size 2^( 6) =       0.000549247991
  error estimate for blocks of size 2^( 7) =       0.000553772287

      target function =      -0.746225044922
              le_mean =     -22.662913180223
             les_mean =     514.056518362934
             stat err =       0.000545216107
             autocorr =       1.324440575606
   target nu stat err =       0.000545216107
   target dn stat err =       0.002785431794
      target stat err =       0.002421155657
              std dev =       0.669988636498
             le_variance =       0.448884773036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448860293963
                                         uncertainty =       0.002855103900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448860293963
                                         uncertainty =       0.002855103900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473753508
  error estimate for blocks of size 2^( 2) =       0.000497324788
  error estimate for blocks of size 2^( 3) =       0.000519003440
  error estimate for blocks of size 2^( 4) =       0.000534141596
  error estimate for blocks of size 2^( 5) =       0.000543702555
  error estimate for blocks of size 2^( 6) =       0.000549247991
  error estimate for blocks of size 2^( 7) =       0.000553772287

      target function =      -0.746225044922
              le_mean =     -22.662913180223
             les_mean =     514.056518362934
             stat err =       0.000545216107
             autocorr =       1.324440575606
   target nu stat err =       0.000545216107
   target dn stat err =       0.002785431794
      target stat err =       0.002421155657
              std dev =       0.669988636498
             le_variance =       0.448884773036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448860293963
                                         uncertainty =       0.002855103900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448860293963
                                         uncertainty =       0.002855103900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473753508
  error estimate for blocks of size 2^( 2) =       0.000497324788
  error estimate for blocks of size 2^( 3) =       0.000519003440
  error estimate for blocks of size 2^( 4) =       0.000534141596
  error estimate for blocks of size 2^( 5) =       0.000543702555
  error estimate for blocks of size 2^( 6) =       0.000549247991
  error estimate for blocks of size 2^( 7) =       0.000553772287

      target function =      -0.746225044922
              le_mean =     -22.662913180223
             les_mean =     514.056518362934
             stat err =       0.000545216107
             autocorr =       1.324440575610
   target nu stat err =       0.000545216107
   target dn stat err =       0.002785431794
      target stat err =       0.002421155657
              std dev =       0.669988636498
             le_variance =       0.448884773036


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746225044922        initial
     3.9062e+11     3.9062e+12             5.0794e-16        -0.746225044922  <--
     1.5625e+12     1.5625e+13             4.5983e-17        -0.746225044922
     6.2500e+12     6.2500e+13             0.0000e+00        -0.746225044922

*****************************************************************************
Applying the update for shift_i =   3.9062e+11     and shift_s =   3.9062e+12
*****************************************************************************

  Execution time = 6.1945e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2180e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7628
    reference variance = 0.655312
====================================================
  Execution time = 4.6303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5507e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5247e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455014350136
                                         uncertainty =       0.007662219905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455014350136
                                         uncertainty =       0.007662219905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477007599
  error estimate for blocks of size 2^( 2) =       0.000500588404
  error estimate for blocks of size 2^( 3) =       0.000521965308
  error estimate for blocks of size 2^( 4) =       0.000537893885
  error estimate for blocks of size 2^( 5) =       0.000547050552
  error estimate for blocks of size 2^( 6) =       0.000552257073
  error estimate for blocks of size 2^( 7) =       0.000553808746

      target function =      -0.741022432712
              le_mean =     -22.662294229182
             les_mean =     514.034652001389
             stat err =       0.000547752564
             autocorr =       1.318615703678
   target nu stat err =       0.000547752564
   target dn stat err =       0.007732529276
      target stat err =       0.006434634523
              std dev =       0.674590615778
             le_variance =       0.455072498896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266229422918e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741077804258       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741077804258       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741077804258       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741077804258       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741056390546       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741037599389       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741086301553       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741160514320       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740992160465       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741023055621       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741267037375       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741173251107       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741063844731       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740921307984       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740763780064       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741103845751       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741155174855       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741210156918       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740987547950       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741230170500       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741016261588       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741499469534       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740911008280       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741086726411       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741257397012       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741047683456       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740559436587       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741156804914       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.741334903309       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741173346005       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.741093890648       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740844674344       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741027972783       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.741969182666       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741580457533       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742420161306       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.739992035143       residual = 6.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741158643894       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742664582033       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.738908316199       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.740623167394       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.740624606277       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741903636800       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.740765594954       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.744591524504       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.741121866819       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.741455280677       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.742391720903       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.742699561290       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.745720509236       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.740580572319       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.723128112903       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.716095374818       residual = 3.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.588999529124       residual = 1.14e+01           smallest_sin_value = 9.91e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.13e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+10 is 5.452749e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741077804258       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741077804258       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741077804258       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741077804258       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741060075383       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741077804258       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741214277530       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741732349060       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741068385519       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741931864741       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741763157226       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741537262072       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740220037127       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741276455024       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741388931209       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741373237724       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740803750932       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739774695229       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741193524163       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740807671708       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739099607680       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739322840361       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740682117334       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742419602322       residual = 9.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740456959906       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741870373276       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739018858880       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.738431878950       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.738387549694       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741838007185       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740596039950       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.739645851649       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741396048692       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745820192789       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741941482614       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741972781245       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.741927309837       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.733094244565       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745638235372       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.752884586242       residual = 6.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.737254167072       residual = 8.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.739152853872       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.740020064058       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.736717374728       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.741945617355       residual = 8.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.742877820998       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.732572427404       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744180746645       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.747143446033       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.762741891361       residual = 2.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.706767511657       residual = 5.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.719182298848       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.733266608940       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.552453018153       residual = 2.00e+01           smallest_sin_value = 9.97e-01
davidson iteration   54 stopping due to small subspace S singular value of 8.58e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+11 is 1.079516e-15

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741077804258       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741077804258       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741077804258       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741910284144       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741077804485       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739366384783       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740456343334       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742980718117       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740377606974       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738059784990       residual = 6.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739562093401       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735694751610       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.738738249465       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739281058161       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744155161549       residual = 4.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742895781903       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.738432679971       residual = 3.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.734954462700       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743351664828       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740997504614       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740765067698       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739484571669       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744823886227       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742172257663       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734566827809       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748891137864       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741513757155       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.726983684411       residual = 9.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.756733140853       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.726778851759       residual = 8.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.723948483150       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.758429149970       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.712721130512       residual = 3.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.752505673129       residual = 6.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.752523457411       residual = 8.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.725372946438       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.739864501679       residual = 5.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.724035403818       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.742683462298       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.740538214946       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.780682117488       residual = 8.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.753278836018       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.726042437674       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.689906107185       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.676897267145       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.819711902345       residual = 3.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.429833097439       residual = 4.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.716660544701       residual = 5.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.607692836868       residual = 8.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.599178031272       residual = 1.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.031154723047       residual = 3.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.062666801624       residual = 2.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =       1.943379727017       residual = 3.37e+03           smallest_sin_value = 9.93e-01
davidson iteration   53 stopping due to small subspace S singular value of 7.60e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+12 is 9.010476e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.541856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1730e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.741
    reference variance = 0.467857
====================================================
  Execution time = 4.5814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5336e-01
  Total weights = 2.0000e+06
  Execution time = 3.6457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453366293697
                                         uncertainty =       0.006120818265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453366293697
                                         uncertainty =       0.006120818265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476107969
  error estimate for blocks of size 2^( 2) =       0.000499515362
  error estimate for blocks of size 2^( 3) =       0.000521088616
  error estimate for blocks of size 2^( 4) =       0.000536454408
  error estimate for blocks of size 2^( 5) =       0.000545541438
  error estimate for blocks of size 2^( 6) =       0.000549525006
  error estimate for blocks of size 2^( 7) =       0.000552493046

      target function =      -0.742464997148
              le_mean =     -22.662217105025
             les_mean =     514.029441484976
             stat err =       0.000546003475
             autocorr =       1.315163997999
   target nu stat err =       0.000546003475
   target dn stat err =       0.006433777660
      target stat err =       0.005384432426
              std dev =       0.673318346981
             le_variance =       0.453357596381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453366293697
                                         uncertainty =       0.006120818265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453366293697
                                         uncertainty =       0.006120818265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476107969
  error estimate for blocks of size 2^( 2) =       0.000499515362
  error estimate for blocks of size 2^( 3) =       0.000521088616
  error estimate for blocks of size 2^( 4) =       0.000536454408
  error estimate for blocks of size 2^( 5) =       0.000545541438
  error estimate for blocks of size 2^( 6) =       0.000549525006
  error estimate for blocks of size 2^( 7) =       0.000552493046

      target function =      -0.742464997148
              le_mean =     -22.662217105025
             les_mean =     514.029441484976
             stat err =       0.000546003475
             autocorr =       1.315163998000
   target nu stat err =       0.000546003475
   target dn stat err =       0.006433777660
      target stat err =       0.005384432426
              std dev =       0.673318346981
             le_variance =       0.453357596381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453366293697
                                         uncertainty =       0.006120818265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453366293697
                                         uncertainty =       0.006120818265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476107969
  error estimate for blocks of size 2^( 2) =       0.000499515362
  error estimate for blocks of size 2^( 3) =       0.000521088616
  error estimate for blocks of size 2^( 4) =       0.000536454408
  error estimate for blocks of size 2^( 5) =       0.000545541438
  error estimate for blocks of size 2^( 6) =       0.000549525006
  error estimate for blocks of size 2^( 7) =       0.000552493046

      target function =      -0.742464997148
              le_mean =     -22.662217105025
             les_mean =     514.029441484976
             stat err =       0.000546003475
             autocorr =       1.315163997996
   target nu stat err =       0.000546003475
   target dn stat err =       0.006433777660
      target stat err =       0.005384432426
              std dev =       0.673318346981
             le_variance =       0.453357596381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453366293697
                                         uncertainty =       0.006120818265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453366293697
                                         uncertainty =       0.006120818265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476107969
  error estimate for blocks of size 2^( 2) =       0.000499515362
  error estimate for blocks of size 2^( 3) =       0.000521088616
  error estimate for blocks of size 2^( 4) =       0.000536454408
  error estimate for blocks of size 2^( 5) =       0.000545541438
  error estimate for blocks of size 2^( 6) =       0.000549525006
  error estimate for blocks of size 2^( 7) =       0.000552493046

      target function =      -0.742464997148
              le_mean =     -22.662217105025
             les_mean =     514.029441484976
             stat err =       0.000546003475
             autocorr =       1.315163998001
   target nu stat err =       0.000546003475
   target dn stat err =       0.006433777660
      target stat err =       0.005384432426
              std dev =       0.673318346981
             le_variance =       0.453357596381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742464997148        initial  <--
     9.7656e+10     9.7656e+11             5.4527e-15        -0.742464997148
     3.9062e+11     3.9062e+12             1.0795e-15        -0.742464997148
     1.5625e+12     1.5625e+13             9.0105e-17        -0.742464997148

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0857
  </log>
  <optVariables href="FORM2.s023.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2582e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.5938
    reference variance = 0.286811
====================================================
  Execution time = 4.4452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.6330e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5014e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463434748298
                                         uncertainty =       0.008262916670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463434748298
                                         uncertainty =       0.008262916670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481301883
  error estimate for blocks of size 2^( 2) =       0.000504954370
  error estimate for blocks of size 2^( 3) =       0.000526595871
  error estimate for blocks of size 2^( 4) =       0.000542379509
  error estimate for blocks of size 2^( 5) =       0.000551724706
  error estimate for blocks of size 2^( 6) =       0.000557455643
  error estimate for blocks of size 2^( 7) =       0.000560868160

      target function =      -0.734246302376
              le_mean =     -22.662625282002
             les_mean =     514.057887445100
             stat err =       0.000553107004
             autocorr =       1.320636194991
   target nu stat err =       0.000553107004
   target dn stat err =       0.008521237913
      target stat err =       0.006960878971
              std dev =       0.680663649908
             le_variance =       0.463303004305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266262528200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734311739632       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734311739632       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734311739632       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734311739632       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734311739632       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734311739632       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734311739632       residual = 9.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.732038682449       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735579465163       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.732383687641       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.733241810566       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736109848311       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.735166059340       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.735522889581       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.731770069870       residual = 3.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.737011819314       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.732760154832       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.733848945030       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.735396452442       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737211152391       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.734741200054       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.730059336193       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.731853095140       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.734478657506       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.735492026776       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.739916274974       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.738390569131       residual = 9.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739165205826       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.729818496035       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.727896433553       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742749490642       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.728973365078       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.727262615624       residual = 2.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.732169411990       residual = 3.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.737278839238       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.704549119616       residual = 4.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.731705161920       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.754378818885       residual = 1.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.718496503628       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.731121667477       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.737459147254       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.754218406326       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.719599300950       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743509301711       residual = 4.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.715244365699       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745359329589       residual = 7.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.765416328636       residual = 5.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.714061928193       residual = 3.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.752431382813       residual = 1.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.833709920628       residual = 4.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.289492275480       residual = 9.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.802117772265       residual = 4.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.454535105166       residual = 4.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.922634713459       residual = 1.96e+01           smallest_sin_value = 9.93e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.26e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+11 is 1.580437e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734311739632       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734311739632       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.47e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734311739632       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734311739632       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.47e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.600235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9531e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6405
    reference variance = 0.41404
====================================================
  Execution time = 4.4139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5174e-01
  Total weights = 2.0000e+06
  Execution time = 3.6390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451634942393
                                         uncertainty =       0.002768456662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451634942393
                                         uncertainty =       0.002768456662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475259947
  error estimate for blocks of size 2^( 2) =       0.000498926896
  error estimate for blocks of size 2^( 3) =       0.000520734064
  error estimate for blocks of size 2^( 4) =       0.000535371902
  error estimate for blocks of size 2^( 5) =       0.000543650630
  error estimate for blocks of size 2^( 6) =       0.000548952875
  error estimate for blocks of size 2^( 7) =       0.000551960860

      target function =      -0.743830682577
              le_mean =     -22.662616483278
             les_mean =     514.045929677082
             stat err =       0.000544984067
             autocorr =       1.314937708463
   target nu stat err =       0.000544984067
   target dn stat err =       0.003319050912
      target stat err =       0.002838197045
              std dev =       0.672119062971
             le_variance =       0.451744034810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451634942393
                                         uncertainty =       0.002768456662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451634942393
                                         uncertainty =       0.002768456662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475259947
  error estimate for blocks of size 2^( 2) =       0.000498926896
  error estimate for blocks of size 2^( 3) =       0.000520734064
  error estimate for blocks of size 2^( 4) =       0.000535371902
  error estimate for blocks of size 2^( 5) =       0.000543650630
  error estimate for blocks of size 2^( 6) =       0.000548952875
  error estimate for blocks of size 2^( 7) =       0.000551960860

      target function =      -0.743830682577
              le_mean =     -22.662616483278
             les_mean =     514.045929677082
             stat err =       0.000544984067
             autocorr =       1.314937708459
   target nu stat err =       0.000544984067
   target dn stat err =       0.003319050912
      target stat err =       0.002838197045
              std dev =       0.672119062971
             le_variance =       0.451744034810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451634942393
                                         uncertainty =       0.002768456662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451634942393
                                         uncertainty =       0.002768456662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475259947
  error estimate for blocks of size 2^( 2) =       0.000498926896
  error estimate for blocks of size 2^( 3) =       0.000520734064
  error estimate for blocks of size 2^( 4) =       0.000535371902
  error estimate for blocks of size 2^( 5) =       0.000543650630
  error estimate for blocks of size 2^( 6) =       0.000548952875
  error estimate for blocks of size 2^( 7) =       0.000551960860

      target function =      -0.743830682577
              le_mean =     -22.662616483278
             les_mean =     514.045929677082
             stat err =       0.000544984067
             autocorr =       1.314937708463
   target nu stat err =       0.000544984067
   target dn stat err =       0.003319050912
      target stat err =       0.002838197045
              std dev =       0.672119062971
             le_variance =       0.451744034810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451634942393
                                         uncertainty =       0.002768456662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451634942393
                                         uncertainty =       0.002768456662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475259947
  error estimate for blocks of size 2^( 2) =       0.000498926896
  error estimate for blocks of size 2^( 3) =       0.000520734064
  error estimate for blocks of size 2^( 4) =       0.000535371902
  error estimate for blocks of size 2^( 5) =       0.000543650630
  error estimate for blocks of size 2^( 6) =       0.000548952875
  error estimate for blocks of size 2^( 7) =       0.000551960860

      target function =      -0.743830682577
              le_mean =     -22.662616483278
             les_mean =     514.045929677082
             stat err =       0.000544984067
             autocorr =       1.314937708463
   target nu stat err =       0.000544984067
   target dn stat err =       0.003319050912
      target stat err =       0.002838197045
              std dev =       0.672119062971
             le_variance =       0.451744034810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743830682577        initial
     9.7656e+11     9.7656e+12             1.5804e-16        -0.743830682577  <--
     3.9062e+12     3.9062e+13             0.0000e+00        -0.743830682577
     1.5625e+13     1.5625e+14             0.0000e+00        -0.743830682577

*****************************************************************************
Applying the update for shift_i =   9.7656e+11     and shift_s =   9.7656e+12
*****************************************************************************

  Execution time = 6.2354e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2189e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7435
    reference variance = 1.17053
====================================================
  Execution time = 4.4637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5909e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5090e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458931710723
                                         uncertainty =       0.007645809728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458931710723
                                         uncertainty =       0.007645809728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479109365
  error estimate for blocks of size 2^( 2) =       0.000502546027
  error estimate for blocks of size 2^( 3) =       0.000524408606
  error estimate for blocks of size 2^( 4) =       0.000539455427
  error estimate for blocks of size 2^( 5) =       0.000548737393
  error estimate for blocks of size 2^( 6) =       0.000555582932
  error estimate for blocks of size 2^( 7) =       0.000556386025

      target function =      -0.737737478117
              le_mean =     -22.661058695262
             les_mean =     513.982672527806
             stat err =       0.000550040444
             autocorr =       1.318013711329
   target nu stat err =       0.000550040444
   target dn stat err =       0.007810736847
      target stat err =       0.006430141100
              std dev =       0.677562961818
             le_variance =       0.459091567228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266105869526e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737791860426       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737791860426       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737791860426       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737791860426       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737791860426       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737791860426       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737791860426       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737702501770       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737791860426       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737143936848       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738478052812       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738515788147       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.738006926393       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.737664453160       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.737602434561       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738189812785       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.737514887624       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.737464867753       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.737807935933       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737840118662       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.737703663790       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.737475187694       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.738234489892       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.737478433690       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.737850592245       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.738552029691       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.737923930383       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740063758394       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.737324039983       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.738442580216       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.737918269253       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.738533065119       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.736202588739       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.738897190321       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.739719535041       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.738805131904       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.737769116970       residual = 7.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.734163526494       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.735729589345       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.737393669377       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.739832590966       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.731833565621       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.738689646493       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.733599707237       residual = 8.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.733529312035       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744779075605       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.754094846261       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746146236715       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.751761896295       residual = 3.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.725370710497       residual = 2.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.745920293452       residual = 6.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.803638289775       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.827211871989       residual = 4.28e+00           smallest_sin_value = 9.99e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+11 is 2.741757e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737791860426       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737791860426       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737791860426       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737791860426       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738058542579       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737791860426       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738218176224       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737791860426       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737948474985       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736663204330       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739341147743       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735599463760       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736793371027       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.738365318977       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.738549748295       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736859082379       residual = 7.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.737180144820       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.737164769797       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.732431064382       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743725287273       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.735009248698       residual = 4.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.734382208897       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739550931828       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.733145173875       residual = 9.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734700021470       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.736892381224       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746203655646       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736945392720       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.740258115221       residual = 4.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744649410841       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.729049463566       residual = 4.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.735462958018       residual = 4.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746688184517       residual = 4.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.740342516849       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.739998856304       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.730230357664       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742736566766       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.739122967113       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.722282797072       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.719064077307       residual = 1.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.739494708851       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.737979369867       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.738502612758       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.736303659653       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.745957288941       residual = 5.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.756075174687       residual = 1.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.766615945202       residual = 4.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.717068396414       residual = 2.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.452584207149       residual = 4.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.387923806906       residual = 6.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.772546928319       residual = 2.87e+00           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -1.042579109930       residual = 5.35e+01           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =       0.289737859654       residual = 5.80e+02           smallest_sin_value = 9.93e-01
davidson iteration   53 stopping due to small subspace S singular value of 8.03e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+11 is 2.975074e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737791860426       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737791860426       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737791860426       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736763427898       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739694414675       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737461024545       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.733794057501       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741200969907       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.733672472712       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741704692823       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737821868450       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.730714652707       residual = 5.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736998710891       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739946684880       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739967618108       residual = 3.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.725521754139       residual = 8.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.727313708264       residual = 5.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.734447411945       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744567138584       residual = 3.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744348347888       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.792956250519       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.758301086124       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.770229350228       residual = 5.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.735193562097       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.731329165014       residual = 2.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.738403396298       residual = 9.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.755220409156       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.730880279908       residual = 4.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.729013369493       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741564866928       residual = 3.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.737077836012       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743756760919       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.727713753959       residual = 4.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744781627005       residual = 4.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.714132315310       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.722630662011       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.759102466421       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.734438680310       residual = 6.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.690995722371       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.705054979173       residual = 5.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.741543434396       residual = 7.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.694197450208       residual = 9.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.755276973781       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.706905864050       residual = 6.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.810930256180       residual = 2.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.404245309656       residual = 5.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.643018043138       residual = 6.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.752150294881       residual = 1.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.452585378719       residual = 3.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.710793880117       residual = 3.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.164402637375       residual = 1.20e+02           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =       1.310172884901       residual = 2.03e+03           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -2.110713802951       residual = 1.74e+03           smallest_sin_value = 9.95e-01
davidson iteration   53 stopping due to small subspace S singular value of 8.46e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+12 is 4.376763e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.765751 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9906e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7658
    reference variance = 0.451776
====================================================
  Execution time = 4.5329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5307e-01
  Total weights = 2.0000e+06
  Execution time = 3.6393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453042534400
                                         uncertainty =       0.005048161053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453042534400
                                         uncertainty =       0.005048161053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475956167
  error estimate for blocks of size 2^( 2) =       0.000500078025
  error estimate for blocks of size 2^( 3) =       0.000521484450
  error estimate for blocks of size 2^( 4) =       0.000536566016
  error estimate for blocks of size 2^( 5) =       0.000546237639
  error estimate for blocks of size 2^( 6) =       0.000551081204
  error estimate for blocks of size 2^( 7) =       0.000553188460

      target function =      -0.742732918492
              le_mean =     -22.661661733154
             les_mean =     514.003980827201
             stat err =       0.000546768330
             autocorr =       1.319692612341
   target nu stat err =       0.000546768330
   target dn stat err =       0.004641559789
      target stat err =       0.003907084794
              std dev =       0.673103666487
             le_variance =       0.453068545839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453042534400
                                         uncertainty =       0.005048161053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453042534400
                                         uncertainty =       0.005048161053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475956167
  error estimate for blocks of size 2^( 2) =       0.000500078025
  error estimate for blocks of size 2^( 3) =       0.000521484450
  error estimate for blocks of size 2^( 4) =       0.000536566016
  error estimate for blocks of size 2^( 5) =       0.000546237639
  error estimate for blocks of size 2^( 6) =       0.000551081204
  error estimate for blocks of size 2^( 7) =       0.000553188460

      target function =      -0.742732918492
              le_mean =     -22.661661733154
             les_mean =     514.003980827201
             stat err =       0.000546768330
             autocorr =       1.319692612349
   target nu stat err =       0.000546768330
   target dn stat err =       0.004641559789
      target stat err =       0.003907084794
              std dev =       0.673103666487
             le_variance =       0.453068545839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453042534400
                                         uncertainty =       0.005048161053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453042534400
                                         uncertainty =       0.005048161053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475956167
  error estimate for blocks of size 2^( 2) =       0.000500078025
  error estimate for blocks of size 2^( 3) =       0.000521484450
  error estimate for blocks of size 2^( 4) =       0.000536566016
  error estimate for blocks of size 2^( 5) =       0.000546237639
  error estimate for blocks of size 2^( 6) =       0.000551081204
  error estimate for blocks of size 2^( 7) =       0.000553188460

      target function =      -0.742732918492
              le_mean =     -22.661661733154
             les_mean =     514.003980827201
             stat err =       0.000546768330
             autocorr =       1.319692612346
   target nu stat err =       0.000546768330
   target dn stat err =       0.004641559789
      target stat err =       0.003907084794
              std dev =       0.673103666487
             le_variance =       0.453068545838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453042534400
                                         uncertainty =       0.005048161053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453042534400
                                         uncertainty =       0.005048161053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475956167
  error estimate for blocks of size 2^( 2) =       0.000500078025
  error estimate for blocks of size 2^( 3) =       0.000521484450
  error estimate for blocks of size 2^( 4) =       0.000536566016
  error estimate for blocks of size 2^( 5) =       0.000546237639
  error estimate for blocks of size 2^( 6) =       0.000551081204
  error estimate for blocks of size 2^( 7) =       0.000553188460

      target function =      -0.742732918492
              le_mean =     -22.661661733154
             les_mean =     514.003980827201
             stat err =       0.000546768330
             autocorr =       1.319692612346
   target nu stat err =       0.000546768330
   target dn stat err =       0.004641559789
      target stat err =       0.003907084794
              std dev =       0.673103666487
             le_variance =       0.453068545838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742732918492        initial  <--
     2.4414e+11     2.4414e+12             2.7418e-15        -0.742732918492
     9.7656e+11     9.7656e+12             2.9751e-16        -0.742732918492
     3.9062e+12     3.9062e+13             4.3768e-17        -0.742732918492

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.5383
  </log>
  <optVariables href="FORM2.s025.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2345e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7185
    reference variance = 0.437405
====================================================
  Execution time = 4.6250e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.7894e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5345e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479008925494
                                         uncertainty =       0.026123551049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479008925494
                                         uncertainty =       0.026123551049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489355369
  error estimate for blocks of size 2^( 2) =       0.000512622965
  error estimate for blocks of size 2^( 3) =       0.000533664614
  error estimate for blocks of size 2^( 4) =       0.000548919220
  error estimate for blocks of size 2^( 5) =       0.000558502983
  error estimate for blocks of size 2^( 6) =       0.000562462168
  error estimate for blocks of size 2^( 7) =       0.000566893264

      target function =      -0.721276163286
              le_mean =     -22.662492047435
             les_mean =     514.067482915770
             stat err =       0.000559194409
             autocorr =       1.305800782909
   target nu stat err =       0.000559194409
   target dn stat err =       0.024961791611
      target stat err =       0.019618782200
              std dev =       0.692053000263
             le_variance =       0.478937355173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266249204744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.721811719905       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.721811719905       residual = 8.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.721811719905       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.721038917054       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.722342405100       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.720803428653       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.722453737875       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.719491339418       residual = 6.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.723223775423       residual = 8.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.722906846070       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.719291334541       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.723228540347       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.727801504512       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.725004304578       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.721187492815       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.719826276254       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.714155045534       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.722878339791       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.732132418945       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.722092518723       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.727095580644       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.722336926178       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748983864495       residual = 3.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.714626875781       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.712069452692       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.700829057375       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.729650316005       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.716885583233       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.757452745976       residual = 6.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.703572075346       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.677640010793       residual = 9.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.654070728512       residual = 2.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.701237847830       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.676863797096       residual = 9.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.675910713610       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.683465129454       residual = 8.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.765748008673       residual = 9.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.738974163505       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.703214930976       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.738536740072       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.739581449671       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.755950973526       residual = 5.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.665462818792       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.764874017872       residual = 9.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.687828361423       residual = 5.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.745230978506       residual = 2.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.783852988195       residual = 1.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.643366345499       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.724368448032       residual = 2.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.599034839122       residual = 8.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.778709741292       residual = 3.55e+00           smallest_sin_value = 9.98e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+12 is 1.934509e-16

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.721811719905       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.721811719905       residual = 8.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.721811719905       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.721811719905       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.721811719537       residual = 6.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.720144942978       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.724926418764       residual = 4.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.718629108425       residual = 3.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.723305641135       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714710496236       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743367391856       residual = 5.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.710783676083       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.721304556503       residual = 7.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.699242053746       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.733845937630       residual = 8.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.724980674105       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.725733982764       residual = 6.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.738495998013       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.637383596838       residual = 3.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.729031004501       residual = 7.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.724706601005       residual = 3.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.779149878182       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.769601094515       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.719349188765       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.784933332205       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.715941608623       residual = 1.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743034473387       residual = 2.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743680445990       residual = 3.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.797561136575       residual = 2.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.665206820012       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.707886674931       residual = 2.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.656619545106       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.658260460217       residual = 1.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.887707320259       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.673264387857       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.649692328649       residual = 3.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.664093607639       residual = 3.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.775565591870       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745032826555       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.745451960813       residual = 5.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.708643267579       residual = 1.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.772655101717       residual = 2.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.686647615548       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.637650939756       residual = 4.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.086142294434       residual = 6.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.785980400954       residual = 1.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -1.429202092935       residual = 2.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.443621392167       residual = 4.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.639161189967       residual = 9.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.919424907264       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.799966134933       residual = 7.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =       7.222719796086       residual = 2.91e+04           smallest_sin_value = 9.98e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+12 is 4.954557e-17

solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.721811719905       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.721811719905       residual = 3.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.868787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1705e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6867
    reference variance = 0.42703
====================================================
  Execution time = 4.4394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5070e-01
  Total weights = 2.0000e+06
  Execution time = 3.6354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450684286600
                                         uncertainty =       0.003454201636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450684286600
                                         uncertainty =       0.003454201636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474708143
  error estimate for blocks of size 2^( 2) =       0.000498378765
  error estimate for blocks of size 2^( 3) =       0.000520407409
  error estimate for blocks of size 2^( 4) =       0.000535681335
  error estimate for blocks of size 2^( 5) =       0.000545614010
  error estimate for blocks of size 2^( 6) =       0.000548591003
  error estimate for blocks of size 2^( 7) =       0.000550226957

      target function =      -0.744724755736
              le_mean =     -22.661127338296
             les_mean =     513.977387658842
             stat err =       0.000545028326
             autocorr =       1.318210555850
   target nu stat err =       0.000545028326
   target dn stat err =       0.003697065731
      target stat err =       0.003147535190
              std dev =       0.671338693742
             le_variance =       0.450695641715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450684286600
                                         uncertainty =       0.003454201636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450684286600
                                         uncertainty =       0.003454201636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474708143
  error estimate for blocks of size 2^( 2) =       0.000498378765
  error estimate for blocks of size 2^( 3) =       0.000520407409
  error estimate for blocks of size 2^( 4) =       0.000535681335
  error estimate for blocks of size 2^( 5) =       0.000545614010
  error estimate for blocks of size 2^( 6) =       0.000548591003
  error estimate for blocks of size 2^( 7) =       0.000550226957

      target function =      -0.744724755736
              le_mean =     -22.661127338296
             les_mean =     513.977387658842
             stat err =       0.000545028326
             autocorr =       1.318210555854
   target nu stat err =       0.000545028326
   target dn stat err =       0.003697065731
      target stat err =       0.003147535190
              std dev =       0.671338693742
             le_variance =       0.450695641715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450684286600
                                         uncertainty =       0.003454201636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450684286600
                                         uncertainty =       0.003454201636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474708143
  error estimate for blocks of size 2^( 2) =       0.000498378765
  error estimate for blocks of size 2^( 3) =       0.000520407409
  error estimate for blocks of size 2^( 4) =       0.000535681335
  error estimate for blocks of size 2^( 5) =       0.000545614010
  error estimate for blocks of size 2^( 6) =       0.000548591003
  error estimate for blocks of size 2^( 7) =       0.000550226957

      target function =      -0.744724755736
              le_mean =     -22.661127338296
             les_mean =     513.977387658842
             stat err =       0.000545028326
             autocorr =       1.318210555853
   target nu stat err =       0.000545028326
   target dn stat err =       0.003697065731
      target stat err =       0.003147535190
              std dev =       0.671338693742
             le_variance =       0.450695641715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450684286600
                                         uncertainty =       0.003454201636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450684286600
                                         uncertainty =       0.003454201636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474708143
  error estimate for blocks of size 2^( 2) =       0.000498378765
  error estimate for blocks of size 2^( 3) =       0.000520407409
  error estimate for blocks of size 2^( 4) =       0.000535681335
  error estimate for blocks of size 2^( 5) =       0.000545614010
  error estimate for blocks of size 2^( 6) =       0.000548591003
  error estimate for blocks of size 2^( 7) =       0.000550226957

      target function =      -0.744724755736
              le_mean =     -22.661127338296
             les_mean =     513.977387658842
             stat err =       0.000545028326
             autocorr =       1.318210555846
   target nu stat err =       0.000545028326
   target dn stat err =       0.003697065731
      target stat err =       0.003147535190
              std dev =       0.671338693742
             le_variance =       0.450695641715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744724755736        initial  <--
     2.4414e+12     2.4414e+13             1.9345e-16        -0.744724755736
     9.7656e+12     9.7656e+13             4.9546e-17        -0.744724755736
     3.9062e+13     3.9062e+14             0.0000e+00        -0.744724755736

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6332
  </log>
  <optVariables href="FORM2.s026.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2434e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6446
    reference variance = 0.405632
====================================================
  Execution time = 4.4633e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5722e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5733e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457287744376
                                         uncertainty =       0.005686349278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457287744376
                                         uncertainty =       0.005686349278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478129937
  error estimate for blocks of size 2^( 2) =       0.000501658136
  error estimate for blocks of size 2^( 3) =       0.000522738252
  error estimate for blocks of size 2^( 4) =       0.000537696684
  error estimate for blocks of size 2^( 5) =       0.000547810137
  error estimate for blocks of size 2^( 6) =       0.000553179211
  error estimate for blocks of size 2^( 7) =       0.000557838816

      target function =      -0.739274272276
              le_mean =     -22.662542568941
             les_mean =     514.048051934145
             stat err =       0.000549131212
             autocorr =       1.319047345299
   target nu stat err =       0.000549131212
   target dn stat err =       0.005613311256
      target stat err =       0.004669922736
              std dev =       0.676177841755
             le_variance =       0.457216473681


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266254256894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739300370975       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739300370975       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739300370975       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739300370975       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+14, overlap shift 3.9062e+15 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739300370975       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739300370975       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.869817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0374e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6272
    reference variance = 0.532295
====================================================
  Execution time = 4.3973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5576e-01
  Total weights = 2.0000e+06
  Execution time = 3.6393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455864623986
                                         uncertainty =       0.005359933055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455864623986
                                         uncertainty =       0.005359933055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477366541
  error estimate for blocks of size 2^( 2) =       0.000500830800
  error estimate for blocks of size 2^( 3) =       0.000522430871
  error estimate for blocks of size 2^( 4) =       0.000537425974
  error estimate for blocks of size 2^( 5) =       0.000546957240
  error estimate for blocks of size 2^( 6) =       0.000551663245
  error estimate for blocks of size 2^( 7) =       0.000555227631

      target function =      -0.740497332792
              le_mean =     -22.661560708051
             les_mean =     514.002091125939
             stat err =       0.000547818522
             autocorr =       1.316950564796
   target nu stat err =       0.000547818522
   target dn stat err =       0.005564230573
      target stat err =       0.004637938602
              std dev =       0.675098236651
             le_variance =       0.455757629130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455864623986
                                         uncertainty =       0.005359933055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455864623986
                                         uncertainty =       0.005359933055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477366541
  error estimate for blocks of size 2^( 2) =       0.000500830800
  error estimate for blocks of size 2^( 3) =       0.000522430871
  error estimate for blocks of size 2^( 4) =       0.000537425974
  error estimate for blocks of size 2^( 5) =       0.000546957240
  error estimate for blocks of size 2^( 6) =       0.000551663245
  error estimate for blocks of size 2^( 7) =       0.000555227631

      target function =      -0.740497332792
              le_mean =     -22.661560708051
             les_mean =     514.002091125939
             stat err =       0.000547818522
             autocorr =       1.316950564796
   target nu stat err =       0.000547818522
   target dn stat err =       0.005564230573
      target stat err =       0.004637938602
              std dev =       0.675098236651
             le_variance =       0.455757629130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455864623986
                                         uncertainty =       0.005359933055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455864623986
                                         uncertainty =       0.005359933055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477366541
  error estimate for blocks of size 2^( 2) =       0.000500830800
  error estimate for blocks of size 2^( 3) =       0.000522430871
  error estimate for blocks of size 2^( 4) =       0.000537425974
  error estimate for blocks of size 2^( 5) =       0.000546957240
  error estimate for blocks of size 2^( 6) =       0.000551663245
  error estimate for blocks of size 2^( 7) =       0.000555227631

      target function =      -0.740497332792
              le_mean =     -22.661560708051
             les_mean =     514.002091125939
             stat err =       0.000547818522
             autocorr =       1.316950564796
   target nu stat err =       0.000547818522
   target dn stat err =       0.005564230573
      target stat err =       0.004637938602
              std dev =       0.675098236651
             le_variance =       0.455757629130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455864623986
                                         uncertainty =       0.005359933055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455864623986
                                         uncertainty =       0.005359933055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477366541
  error estimate for blocks of size 2^( 2) =       0.000500830800
  error estimate for blocks of size 2^( 3) =       0.000522430871
  error estimate for blocks of size 2^( 4) =       0.000537425974
  error estimate for blocks of size 2^( 5) =       0.000546957240
  error estimate for blocks of size 2^( 6) =       0.000551663245
  error estimate for blocks of size 2^( 7) =       0.000555227631

      target function =      -0.740497332792
              le_mean =     -22.661560708051
             les_mean =     514.002091125939
             stat err =       0.000547818522
             autocorr =       1.316950564796
   target nu stat err =       0.000547818522
   target dn stat err =       0.005564230573
      target stat err =       0.004637938602
              std dev =       0.675098236651
             le_variance =       0.455757629130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740497332792        initial  <--
     2.4414e+13     2.4414e+14             0.0000e+00        -0.740497332792
     9.7656e+13     9.7656e+14             0.0000e+00        -0.740497332792
     3.9062e+14     3.9062e+15             0.0000e+00        -0.740497332792

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.1882
  </log>
  <optVariables href="FORM2.s027.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2257e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6305
    reference variance = 0.228603
====================================================
  Execution time = 4.6313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4876e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5126e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448752342378
                                         uncertainty =       0.003832188906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448752342378
                                         uncertainty =       0.003832188906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473689582
  error estimate for blocks of size 2^( 2) =       0.000497371029
  error estimate for blocks of size 2^( 3) =       0.000519170602
  error estimate for blocks of size 2^( 4) =       0.000534565814
  error estimate for blocks of size 2^( 5) =       0.000543145284
  error estimate for blocks of size 2^( 6) =       0.000548673165
  error estimate for blocks of size 2^( 7) =       0.000551830306

      target function =      -0.746320641471
              le_mean =     -22.662817089009
             les_mean =     514.052041825130
             stat err =       0.000544553642
             autocorr =       1.321580640604
   target nu stat err =       0.000544553642
   target dn stat err =       0.003937759313
      target stat err =       0.003367545519
              std dev =       0.669898230789
             le_variance =       0.448763639615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266281708901e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746335029711       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746335029711       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746335029711       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+14 is 1.188350e-19

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746335029711       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746335029711       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746335029711       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+14 is 2.970875e-20

solving harmonic davidson linear method for identity shift 3.9062e+15, overlap shift 3.9062e+16 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746335029711       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746335029711       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746335029711       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+15 is 7.427186e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.871086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1446e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6188
    reference variance = 0.271746
====================================================
  Execution time = 4.6227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4945e-01
  Total weights = 2.0000e+06
  Execution time = 3.6494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449143733140
                                         uncertainty =       0.004373337220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449143733140
                                         uncertainty =       0.004373337220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474053629
  error estimate for blocks of size 2^( 2) =       0.000497883020
  error estimate for blocks of size 2^( 3) =       0.000519749492
  error estimate for blocks of size 2^( 4) =       0.000535847000
  error estimate for blocks of size 2^( 5) =       0.000544883255
  error estimate for blocks of size 2^( 6) =       0.000547999647
  error estimate for blocks of size 2^( 7) =       0.000553867069

      target function =      -0.745744140961
              le_mean =     -22.662637592409
             les_mean =     514.044596106552
             stat err =       0.000545649243
             autocorr =       1.324866633212
   target nu stat err =       0.000545649243
   target dn stat err =       0.003823569732
      target stat err =       0.003267555952
              std dev =       0.670413071482
             le_variance =       0.449453686414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449143733140
                                         uncertainty =       0.004373337220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449143733140
                                         uncertainty =       0.004373337220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474053629
  error estimate for blocks of size 2^( 2) =       0.000497883020
  error estimate for blocks of size 2^( 3) =       0.000519749492
  error estimate for blocks of size 2^( 4) =       0.000535847000
  error estimate for blocks of size 2^( 5) =       0.000544883255
  error estimate for blocks of size 2^( 6) =       0.000547999647
  error estimate for blocks of size 2^( 7) =       0.000553867069

      target function =      -0.745744140961
              le_mean =     -22.662637592409
             les_mean =     514.044596106552
             stat err =       0.000545649243
             autocorr =       1.324866633212
   target nu stat err =       0.000545649243
   target dn stat err =       0.003823569732
      target stat err =       0.003267555952
              std dev =       0.670413071482
             le_variance =       0.449453686414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449143733140
                                         uncertainty =       0.004373337220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449143733140
                                         uncertainty =       0.004373337220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474053629
  error estimate for blocks of size 2^( 2) =       0.000497883020
  error estimate for blocks of size 2^( 3) =       0.000519749492
  error estimate for blocks of size 2^( 4) =       0.000535847000
  error estimate for blocks of size 2^( 5) =       0.000544883255
  error estimate for blocks of size 2^( 6) =       0.000547999647
  error estimate for blocks of size 2^( 7) =       0.000553867069

      target function =      -0.745744140961
              le_mean =     -22.662637592409
             les_mean =     514.044596106552
             stat err =       0.000545649243
             autocorr =       1.324866633212
   target nu stat err =       0.000545649243
   target dn stat err =       0.003823569732
      target stat err =       0.003267555952
              std dev =       0.670413071482
             le_variance =       0.449453686414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449143733140
                                         uncertainty =       0.004373337220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449143733140
                                         uncertainty =       0.004373337220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474053629
  error estimate for blocks of size 2^( 2) =       0.000497883020
  error estimate for blocks of size 2^( 3) =       0.000519749492
  error estimate for blocks of size 2^( 4) =       0.000535847000
  error estimate for blocks of size 2^( 5) =       0.000544883255
  error estimate for blocks of size 2^( 6) =       0.000547999647
  error estimate for blocks of size 2^( 7) =       0.000553867069

      target function =      -0.745744140961
              le_mean =     -22.662637592409
             les_mean =     514.044596106552
             stat err =       0.000545649243
             autocorr =       1.324866633212
   target nu stat err =       0.000545649243
   target dn stat err =       0.003823569732
      target stat err =       0.003267555952
              std dev =       0.670413071482
             le_variance =       0.449453686414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745744140961        initial  <--
     2.4414e+14     2.4414e+15             1.1883e-19        -0.745744140961
     9.7656e+14     9.7656e+15             2.9709e-20        -0.745744140961
     3.9062e+15     3.9062e+16             7.4272e-21        -0.745744140961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4963
  </log>
  <optVariables href="FORM2.s028.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2595e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6326
    reference variance = 0.594552
====================================================
  Execution time = 4.5176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5789e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5265e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457836389164
                                         uncertainty =       0.008134181657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457836389164
                                         uncertainty =       0.008134181657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478480528
  error estimate for blocks of size 2^( 2) =       0.000501861530
  error estimate for blocks of size 2^( 3) =       0.000523420338
  error estimate for blocks of size 2^( 4) =       0.000538270600
  error estimate for blocks of size 2^( 5) =       0.000546272832
  error estimate for blocks of size 2^( 6) =       0.000550392626
  error estimate for blocks of size 2^( 7) =       0.000553435458

      target function =      -0.738705163377
              le_mean =     -22.662000558635
             les_mean =     514.024156322101
             stat err =       0.000547092879
             autocorr =       1.307355163827
   target nu stat err =       0.000547092879
   target dn stat err =       0.007724129069
      target stat err =       0.006384849760
              std dev =       0.676673652125
             le_variance =       0.457887231480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266200055863e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738759929909       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738759929909       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738759929909       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.401541856527       residual = 6.24e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.685656940566       residual = 4.25e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.764910118757       residual = 1.29e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.934170531541       residual = 8.78e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -2.226470078189       residual = 5.21e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.994329532705       residual = 4.02e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.268747946197       residual = 6.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       1.092690800071       residual = 3.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -4.271286224527       residual = 6.88e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.286474955034       residual = 1.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       4.247678294052       residual = 1.22e+04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       6.333314306518       residual = 2.78e+04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       6.291813221804       residual = 3.00e+04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       6.354450340536       residual = 2.65e+04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -2.430594845878       residual = 5.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   18 stopping due to too large eigenvalue change
davidson solver did not converge after         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+15 is 2.340276e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738759929909       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738759929909       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738759929909       residual = 4.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738759929909       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.655798382944       residual = 4.00e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.038398891598       residual = 2.88e+02           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+15 is 8.058545e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+16, overlap shift 3.9062e+17 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738759929909       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738759929909       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738759929909       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+16 is 1.462672e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.876223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0452e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7212
    reference variance = 0.403641
====================================================
  Execution time = 4.4124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5184e-01
  Total weights = 2.0000e+06
  Execution time = 3.6436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451906213086
                                         uncertainty =       0.003423987960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451906213086
                                         uncertainty =       0.003423987960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475310698
  error estimate for blocks of size 2^( 2) =       0.000499091396
  error estimate for blocks of size 2^( 3) =       0.000521193434
  error estimate for blocks of size 2^( 4) =       0.000537399837
  error estimate for blocks of size 2^( 5) =       0.000545954356
  error estimate for blocks of size 2^( 6) =       0.000551119060
  error estimate for blocks of size 2^( 7) =       0.000550424394

      target function =      -0.743759290930
              le_mean =     -22.661925755342
             les_mean =     514.014719233862
             stat err =       0.000546224412
             autocorr =       1.320647862674
   target nu stat err =       0.000546224412
   target dn stat err =       0.003547492915
      target stat err =       0.003021315741
              std dev =       0.672190835372
             le_variance =       0.451840519158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451906213086
                                         uncertainty =       0.003423987960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451906213086
                                         uncertainty =       0.003423987960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475310698
  error estimate for blocks of size 2^( 2) =       0.000499091396
  error estimate for blocks of size 2^( 3) =       0.000521193434
  error estimate for blocks of size 2^( 4) =       0.000537399837
  error estimate for blocks of size 2^( 5) =       0.000545954356
  error estimate for blocks of size 2^( 6) =       0.000551119060
  error estimate for blocks of size 2^( 7) =       0.000550424394

      target function =      -0.743759290930
              le_mean =     -22.661925755342
             les_mean =     514.014719233862
             stat err =       0.000546224412
             autocorr =       1.320647862670
   target nu stat err =       0.000546224412
   target dn stat err =       0.003547492915
      target stat err =       0.003021315741
              std dev =       0.672190835372
             le_variance =       0.451840519158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451906213086
                                         uncertainty =       0.003423987960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451906213086
                                         uncertainty =       0.003423987960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475310698
  error estimate for blocks of size 2^( 2) =       0.000499091396
  error estimate for blocks of size 2^( 3) =       0.000521193434
  error estimate for blocks of size 2^( 4) =       0.000537399837
  error estimate for blocks of size 2^( 5) =       0.000545954356
  error estimate for blocks of size 2^( 6) =       0.000551119060
  error estimate for blocks of size 2^( 7) =       0.000550424394

      target function =      -0.743759290930
              le_mean =     -22.661925755342
             les_mean =     514.014719233862
             stat err =       0.000546224412
             autocorr =       1.320647862670
   target nu stat err =       0.000546224412
   target dn stat err =       0.003547492915
      target stat err =       0.003021315741
              std dev =       0.672190835372
             le_variance =       0.451840519158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451906213086
                                         uncertainty =       0.003423987960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451906213086
                                         uncertainty =       0.003423987960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475310698
  error estimate for blocks of size 2^( 2) =       0.000499091396
  error estimate for blocks of size 2^( 3) =       0.000521193434
  error estimate for blocks of size 2^( 4) =       0.000537399837
  error estimate for blocks of size 2^( 5) =       0.000545954356
  error estimate for blocks of size 2^( 6) =       0.000551119060
  error estimate for blocks of size 2^( 7) =       0.000550424394

      target function =      -0.743759290930
              le_mean =     -22.661925755342
             les_mean =     514.014719233862
             stat err =       0.000546224412
             autocorr =       1.320647862670
   target nu stat err =       0.000546224412
   target dn stat err =       0.003547492915
      target stat err =       0.003021315741
              std dev =       0.672190835372
             le_variance =       0.451840519158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743759290930        initial  <--
     2.4414e+15     2.4414e+16             2.3403e-20        -0.743759290930
     9.7656e+15     9.7656e+16             8.0585e-21        -0.743759290930
     3.9062e+16     3.9062e+17             1.4627e-21        -0.743759290930

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.3530
  </log>
  <optVariables href="FORM2.s029.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2281e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.5869
    reference variance = 0.784284
====================================================
  Execution time = 4.5041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5966e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5150e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458707115518
                                         uncertainty =       0.006833544358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458707115518
                                         uncertainty =       0.006833544358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479408162
  error estimate for blocks of size 2^( 2) =       0.000503082087
  error estimate for blocks of size 2^( 3) =       0.000524654577
  error estimate for blocks of size 2^( 4) =       0.000539728839
  error estimate for blocks of size 2^( 5) =       0.000548340167
  error estimate for blocks of size 2^( 6) =       0.000551704188
  error estimate for blocks of size 2^( 7) =       0.000553369539

      target function =      -0.737232709539
              le_mean =     -22.662930130046
             les_mean =     514.068066220216
             stat err =       0.000548285683
             autocorr =       1.307985606782
   target nu stat err =       0.000548285683
   target dn stat err =       0.006913567063
      target stat err =       0.005706691199
              std dev =       0.677985523949
             le_variance =       0.459664370684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266293013005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737276929288       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737276929288       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737276929288       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737276929288       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+17, overlap shift 3.9062e+18 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737276929288       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737276929288       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.877243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0199e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6973
    reference variance = 1.57039
====================================================
  Execution time = 4.5909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5037e-01
  Total weights = 2.0000e+06
  Execution time = 3.6392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450299121062
                                         uncertainty =       0.002925679614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450299121062
                                         uncertainty =       0.002925679614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474535315
  error estimate for blocks of size 2^( 2) =       0.000497894557
  error estimate for blocks of size 2^( 3) =       0.000519717982
  error estimate for blocks of size 2^( 4) =       0.000536591430
  error estimate for blocks of size 2^( 5) =       0.000546168280
  error estimate for blocks of size 2^( 6) =       0.000551965565
  error estimate for blocks of size 2^( 7) =       0.000555917402

      target function =      -0.744990079089
              le_mean =     -22.662148760606
             les_mean =     514.023353753948
             stat err =       0.000547660669
             autocorr =       1.331944190829
   target nu stat err =       0.000547660669
   target dn stat err =       0.003020176516
      target stat err =       0.002601794255
              std dev =       0.671094279001
             le_variance =       0.450367531308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450299121062
                                         uncertainty =       0.002925679614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450299121062
                                         uncertainty =       0.002925679614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474535315
  error estimate for blocks of size 2^( 2) =       0.000497894557
  error estimate for blocks of size 2^( 3) =       0.000519717982
  error estimate for blocks of size 2^( 4) =       0.000536591430
  error estimate for blocks of size 2^( 5) =       0.000546168280
  error estimate for blocks of size 2^( 6) =       0.000551965565
  error estimate for blocks of size 2^( 7) =       0.000555917402

      target function =      -0.744990079089
              le_mean =     -22.662148760606
             les_mean =     514.023353753948
             stat err =       0.000547660669
             autocorr =       1.331944190829
   target nu stat err =       0.000547660669
   target dn stat err =       0.003020176516
      target stat err =       0.002601794255
              std dev =       0.671094279001
             le_variance =       0.450367531308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450299121062
                                         uncertainty =       0.002925679614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450299121062
                                         uncertainty =       0.002925679614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474535315
  error estimate for blocks of size 2^( 2) =       0.000497894557
  error estimate for blocks of size 2^( 3) =       0.000519717982
  error estimate for blocks of size 2^( 4) =       0.000536591430
  error estimate for blocks of size 2^( 5) =       0.000546168280
  error estimate for blocks of size 2^( 6) =       0.000551965565
  error estimate for blocks of size 2^( 7) =       0.000555917402

      target function =      -0.744990079089
              le_mean =     -22.662148760606
             les_mean =     514.023353753948
             stat err =       0.000547660669
             autocorr =       1.331944190829
   target nu stat err =       0.000547660669
   target dn stat err =       0.003020176516
      target stat err =       0.002601794255
              std dev =       0.671094279001
             le_variance =       0.450367531308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450299121062
                                         uncertainty =       0.002925679614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450299121062
                                         uncertainty =       0.002925679614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474535315
  error estimate for blocks of size 2^( 2) =       0.000497894557
  error estimate for blocks of size 2^( 3) =       0.000519717982
  error estimate for blocks of size 2^( 4) =       0.000536591430
  error estimate for blocks of size 2^( 5) =       0.000546168280
  error estimate for blocks of size 2^( 6) =       0.000551965565
  error estimate for blocks of size 2^( 7) =       0.000555917402

      target function =      -0.744990079089
              le_mean =     -22.662148760606
             les_mean =     514.023353753948
             stat err =       0.000547660669
             autocorr =       1.331944190829
   target nu stat err =       0.000547660669
   target dn stat err =       0.003020176516
      target stat err =       0.002601794255
              std dev =       0.671094279001
             le_variance =       0.450367531308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744990079089        initial  <--
     2.4414e+16     2.4414e+17             0.0000e+00        -0.744990079089
     9.7656e+16     9.7656e+17             0.0000e+00        -0.744990079089
     3.9062e+17     3.9062e+18             0.0000e+00        -0.744990079089

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 67.8152
  </log>
  <optVariables href="FORM2.s030.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2802e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6646
    reference variance = 0.28586
====================================================
  Execution time = 4.4418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5106e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5122e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451108413482
                                         uncertainty =       0.003264292669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451108413482
                                         uncertainty =       0.003264292669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474897497
  error estimate for blocks of size 2^( 2) =       0.000498998400
  error estimate for blocks of size 2^( 3) =       0.000521383812
  error estimate for blocks of size 2^( 4) =       0.000537930320
  error estimate for blocks of size 2^( 5) =       0.000546570240
  error estimate for blocks of size 2^( 6) =       0.000551154074
  error estimate for blocks of size 2^( 7) =       0.000555502401

      target function =      -0.744407930971
              le_mean =     -22.662460943803
             les_mean =     514.038191069506
             stat err =       0.000547789259
             autocorr =       1.330537939700
   target nu stat err =       0.000547789259
   target dn stat err =       0.003412059189
      target stat err =       0.002918488375
              std dev =       0.671606481232
             le_variance =       0.451055265633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266246094380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744418384086       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744418384086       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744418384086       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744418384086       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744418384086       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744188675543       residual = 7.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743823020031       residual = 7.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+17 is 3.202809e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744418384086       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744418384086       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744418384086       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744418384086       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744418384086       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744568132007       residual = 3.26e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.710016668149       residual = 2.47e+02           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+17 is 8.007023e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+18, overlap shift 3.9062e+19 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744418384086       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744418384086       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744418384086       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744418384086       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744418384086       residual = 7.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744418384086       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747954537329       residual = 2.46e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       1.317695038600       residual = 2.30e+03           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+18 is 2.001756e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.880146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9550e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6337
    reference variance = 0.321419
====================================================
  Execution time = 4.4212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4773e-01
  Total weights = 2.0000e+06
  Execution time = 3.6477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447792449739
                                         uncertainty =       0.002110976467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447792449739
                                         uncertainty =       0.002110976467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473143128
  error estimate for blocks of size 2^( 2) =       0.000497303189
  error estimate for blocks of size 2^( 3) =       0.000518952955
  error estimate for blocks of size 2^( 4) =       0.000534942684
  error estimate for blocks of size 2^( 5) =       0.000544439065
  error estimate for blocks of size 2^( 6) =       0.000547552038
  error estimate for blocks of size 2^( 7) =       0.000549750121

      target function =      -0.747211120850
              le_mean =     -22.661898041812
             les_mean =     514.009351473457
             stat err =       0.000544170977
             autocorr =       1.322774081092
   target nu stat err =       0.000544170977
   target dn stat err =       0.002357424637
      target stat err =       0.002076792034
              std dev =       0.669125429083
             le_variance =       0.447728839846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447792449739
                                         uncertainty =       0.002110976467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447792449739
                                         uncertainty =       0.002110976467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473143128
  error estimate for blocks of size 2^( 2) =       0.000497303189
  error estimate for blocks of size 2^( 3) =       0.000518952955
  error estimate for blocks of size 2^( 4) =       0.000534942684
  error estimate for blocks of size 2^( 5) =       0.000544439065
  error estimate for blocks of size 2^( 6) =       0.000547552038
  error estimate for blocks of size 2^( 7) =       0.000549750121

      target function =      -0.747211120850
              le_mean =     -22.661898041812
             les_mean =     514.009351473457
             stat err =       0.000544170977
             autocorr =       1.322774081092
   target nu stat err =       0.000544170977
   target dn stat err =       0.002357424637
      target stat err =       0.002076792034
              std dev =       0.669125429083
             le_variance =       0.447728839846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447792449739
                                         uncertainty =       0.002110976467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447792449739
                                         uncertainty =       0.002110976467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473143128
  error estimate for blocks of size 2^( 2) =       0.000497303189
  error estimate for blocks of size 2^( 3) =       0.000518952955
  error estimate for blocks of size 2^( 4) =       0.000534942684
  error estimate for blocks of size 2^( 5) =       0.000544439065
  error estimate for blocks of size 2^( 6) =       0.000547552038
  error estimate for blocks of size 2^( 7) =       0.000549750121

      target function =      -0.747211120850
              le_mean =     -22.661898041812
             les_mean =     514.009351473457
             stat err =       0.000544170977
             autocorr =       1.322774081092
   target nu stat err =       0.000544170977
   target dn stat err =       0.002357424637
      target stat err =       0.002076792034
              std dev =       0.669125429083
             le_variance =       0.447728839846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447792449739
                                         uncertainty =       0.002110976467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447792449739
                                         uncertainty =       0.002110976467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473143128
  error estimate for blocks of size 2^( 2) =       0.000497303189
  error estimate for blocks of size 2^( 3) =       0.000518952955
  error estimate for blocks of size 2^( 4) =       0.000534942684
  error estimate for blocks of size 2^( 5) =       0.000544439065
  error estimate for blocks of size 2^( 6) =       0.000547552038
  error estimate for blocks of size 2^( 7) =       0.000549750121

      target function =      -0.747211120850
              le_mean =     -22.661898041812
             les_mean =     514.009351473457
             stat err =       0.000544170977
             autocorr =       1.322774081092
   target nu stat err =       0.000544170977
   target dn stat err =       0.002357424637
      target stat err =       0.002076792034
              std dev =       0.669125429083
             le_variance =       0.447728839846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747211120850        initial  <--
     2.4414e+17     2.4414e+18             3.2028e-22        -0.747211120850
     9.7656e+17     9.7656e+18             8.0070e-23        -0.747211120850
     3.9062e+18     3.9062e+19             2.0018e-23        -0.747211120850

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.5074
  </log>
  <optVariables href="FORM2.s031.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2206e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7171
    reference variance = 0.410883
====================================================
  Execution time = 4.4793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4488e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5054e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444723879089
                                         uncertainty =       0.002633740872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444723879089
                                         uncertainty =       0.002633740872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471635678
  error estimate for blocks of size 2^( 2) =       0.000495863513
  error estimate for blocks of size 2^( 3) =       0.000517007156
  error estimate for blocks of size 2^( 4) =       0.000532178146
  error estimate for blocks of size 2^( 5) =       0.000541764259
  error estimate for blocks of size 2^( 6) =       0.000545161477
  error estimate for blocks of size 2^( 7) =       0.000546598776

      target function =      -0.749611849621
              le_mean =     -22.662122533909
             les_mean =     514.016677945244
             stat err =       0.000541425665
             autocorr =       1.317845125276
   target nu stat err =       0.000541425665
   target dn stat err =       0.002962879370
      target stat err =       0.002584319198
              std dev =       0.666993572519
             le_variance =       0.444880425782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266212253391e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749619765924       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749619765924       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749619765924       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749619765924       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+19, overlap shift 3.9062e+20 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749619765924       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749619765924       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.881248 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9854e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7448
    reference variance = 0.368709
====================================================
  Execution time = 4.4065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5514e-01
  Total weights = 2.0000e+06
  Execution time = 3.6385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455227676028
                                         uncertainty =       0.003416476691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455227676028
                                         uncertainty =       0.003416476691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477044019
  error estimate for blocks of size 2^( 2) =       0.000500951899
  error estimate for blocks of size 2^( 3) =       0.000522948427
  error estimate for blocks of size 2^( 4) =       0.000538630736
  error estimate for blocks of size 2^( 5) =       0.000546802355
  error estimate for blocks of size 2^( 6) =       0.000550460622
  error estimate for blocks of size 2^( 7) =       0.000554764754

      target function =      -0.741028386062
              le_mean =     -22.661302197546
             les_mean =     513.989759053934
             stat err =       0.000547664617
             autocorr =       1.317991030446
   target nu stat err =       0.000547664617
   target dn stat err =       0.003445025754
      target stat err =       0.002914213187
              std dev =       0.674642122157
             le_variance =       0.455141992988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455227676028
                                         uncertainty =       0.003416476691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455227676028
                                         uncertainty =       0.003416476691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477044019
  error estimate for blocks of size 2^( 2) =       0.000500951899
  error estimate for blocks of size 2^( 3) =       0.000522948427
  error estimate for blocks of size 2^( 4) =       0.000538630736
  error estimate for blocks of size 2^( 5) =       0.000546802355
  error estimate for blocks of size 2^( 6) =       0.000550460622
  error estimate for blocks of size 2^( 7) =       0.000554764754

      target function =      -0.741028386062
              le_mean =     -22.661302197546
             les_mean =     513.989759053934
             stat err =       0.000547664617
             autocorr =       1.317991030446
   target nu stat err =       0.000547664617
   target dn stat err =       0.003445025754
      target stat err =       0.002914213187
              std dev =       0.674642122157
             le_variance =       0.455141992988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455227676028
                                         uncertainty =       0.003416476691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455227676028
                                         uncertainty =       0.003416476691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477044019
  error estimate for blocks of size 2^( 2) =       0.000500951899
  error estimate for blocks of size 2^( 3) =       0.000522948427
  error estimate for blocks of size 2^( 4) =       0.000538630736
  error estimate for blocks of size 2^( 5) =       0.000546802355
  error estimate for blocks of size 2^( 6) =       0.000550460622
  error estimate for blocks of size 2^( 7) =       0.000554764754

      target function =      -0.741028386062
              le_mean =     -22.661302197546
             les_mean =     513.989759053934
             stat err =       0.000547664617
             autocorr =       1.317991030446
   target nu stat err =       0.000547664617
   target dn stat err =       0.003445025754
      target stat err =       0.002914213187
              std dev =       0.674642122157
             le_variance =       0.455141992988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455227676028
                                         uncertainty =       0.003416476691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455227676028
                                         uncertainty =       0.003416476691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477044019
  error estimate for blocks of size 2^( 2) =       0.000500951899
  error estimate for blocks of size 2^( 3) =       0.000522948427
  error estimate for blocks of size 2^( 4) =       0.000538630736
  error estimate for blocks of size 2^( 5) =       0.000546802355
  error estimate for blocks of size 2^( 6) =       0.000550460622
  error estimate for blocks of size 2^( 7) =       0.000554764754

      target function =      -0.741028386062
              le_mean =     -22.661302197546
             les_mean =     513.989759053934
             stat err =       0.000547664617
             autocorr =       1.317991030446
   target nu stat err =       0.000547664617
   target dn stat err =       0.003445025754
      target stat err =       0.002914213187
              std dev =       0.674642122157
             le_variance =       0.455141992988


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741028386062        initial  <--
     2.4414e+18     2.4414e+19             0.0000e+00        -0.741028386062
     9.7656e+18     9.7656e+19             0.0000e+00        -0.741028386062
     3.9062e+19     3.9062e+20             0.0000e+00        -0.741028386062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.5021
  </log>
  <optVariables href="FORM2.s032.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2436e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7071
    reference variance = 0.409815
====================================================
  Execution time = 4.4255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5279e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5498e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452838427954
                                         uncertainty =       0.005338354694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452838427954
                                         uncertainty =       0.005338354694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475811493
  error estimate for blocks of size 2^( 2) =       0.000499618330
  error estimate for blocks of size 2^( 3) =       0.000521362391
  error estimate for blocks of size 2^( 4) =       0.000536533661
  error estimate for blocks of size 2^( 5) =       0.000546749081
  error estimate for blocks of size 2^( 6) =       0.000550399836
  error estimate for blocks of size 2^( 7) =       0.000554193939

      target function =      -0.742962778591
              le_mean =     -22.661041102781
             les_mean =     513.975576789764
             stat err =       0.000546969129
             autocorr =       1.321465332904
   target nu stat err =       0.000546969129
   target dn stat err =       0.005532185743
      target stat err =       0.004638425630
              std dev =       0.672899066904
             le_variance =       0.452793154240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266104110278e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742990537153       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742990537153       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742990537153       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742990537153       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+20, overlap shift 3.9062e+21 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742990537153       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742990537153       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.882340 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9761e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7507
    reference variance = 0.466924
====================================================
  Execution time = 4.4263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5127e-01
  Total weights = 2.0000e+06
  Execution time = 3.6364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451327058446
                                         uncertainty =       0.003894021418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451327058446
                                         uncertainty =       0.003894021418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475012251
  error estimate for blocks of size 2^( 2) =       0.000499047596
  error estimate for blocks of size 2^( 3) =       0.000521073832
  error estimate for blocks of size 2^( 4) =       0.000536979098
  error estimate for blocks of size 2^( 5) =       0.000546114287
  error estimate for blocks of size 2^( 6) =       0.000550200783
  error estimate for blocks of size 2^( 7) =       0.000554896404

      target function =      -0.744211474222
              le_mean =     -22.663142412086
             les_mean =     514.069297042723
             stat err =       0.000547047643
             autocorr =       1.326296673358
   target nu stat err =       0.000547047643
   target dn stat err =       0.003937624985
      target stat err =       0.003350900460
              std dev =       0.671768768167
             le_variance =       0.451273277885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451327058446
                                         uncertainty =       0.003894021418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451327058446
                                         uncertainty =       0.003894021418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475012251
  error estimate for blocks of size 2^( 2) =       0.000499047596
  error estimate for blocks of size 2^( 3) =       0.000521073832
  error estimate for blocks of size 2^( 4) =       0.000536979098
  error estimate for blocks of size 2^( 5) =       0.000546114287
  error estimate for blocks of size 2^( 6) =       0.000550200783
  error estimate for blocks of size 2^( 7) =       0.000554896404

      target function =      -0.744211474222
              le_mean =     -22.663142412086
             les_mean =     514.069297042723
             stat err =       0.000547047643
             autocorr =       1.326296673358
   target nu stat err =       0.000547047643
   target dn stat err =       0.003937624985
      target stat err =       0.003350900460
              std dev =       0.671768768167
             le_variance =       0.451273277885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451327058446
                                         uncertainty =       0.003894021418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451327058446
                                         uncertainty =       0.003894021418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475012251
  error estimate for blocks of size 2^( 2) =       0.000499047596
  error estimate for blocks of size 2^( 3) =       0.000521073832
  error estimate for blocks of size 2^( 4) =       0.000536979098
  error estimate for blocks of size 2^( 5) =       0.000546114287
  error estimate for blocks of size 2^( 6) =       0.000550200783
  error estimate for blocks of size 2^( 7) =       0.000554896404

      target function =      -0.744211474222
              le_mean =     -22.663142412086
             les_mean =     514.069297042723
             stat err =       0.000547047643
             autocorr =       1.326296673358
   target nu stat err =       0.000547047643
   target dn stat err =       0.003937624985
      target stat err =       0.003350900460
              std dev =       0.671768768167
             le_variance =       0.451273277885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451327058446
                                         uncertainty =       0.003894021418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451327058446
                                         uncertainty =       0.003894021418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475012251
  error estimate for blocks of size 2^( 2) =       0.000499047596
  error estimate for blocks of size 2^( 3) =       0.000521073832
  error estimate for blocks of size 2^( 4) =       0.000536979098
  error estimate for blocks of size 2^( 5) =       0.000546114287
  error estimate for blocks of size 2^( 6) =       0.000550200783
  error estimate for blocks of size 2^( 7) =       0.000554896404

      target function =      -0.744211474222
              le_mean =     -22.663142412086
             les_mean =     514.069297042723
             stat err =       0.000547047643
             autocorr =       1.326296673358
   target nu stat err =       0.000547047643
   target dn stat err =       0.003937624985
      target stat err =       0.003350900460
              std dev =       0.671768768167
             le_variance =       0.451273277885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744211474222        initial  <--
     2.4414e+19     2.4414e+20             0.0000e+00        -0.744211474222
     9.7656e+19     9.7656e+20             0.0000e+00        -0.744211474222
     3.9062e+20     3.9062e+21             0.0000e+00        -0.744211474222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4806
  </log>
  <optVariables href="FORM2.s033.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2225e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7249
    reference variance = 0.630325
====================================================
  Execution time = 4.4169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5473e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5306e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454835495306
                                         uncertainty =       0.003914285461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454835495306
                                         uncertainty =       0.003914285461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476825850
  error estimate for blocks of size 2^( 2) =       0.000500411601
  error estimate for blocks of size 2^( 3) =       0.000522499651
  error estimate for blocks of size 2^( 4) =       0.000537090261
  error estimate for blocks of size 2^( 5) =       0.000545897349
  error estimate for blocks of size 2^( 6) =       0.000551956475
  error estimate for blocks of size 2^( 7) =       0.000553198411

      target function =      -0.741352288259
              le_mean =     -22.662125393433
             les_mean =     514.026652902666
             stat err =       0.000547035624
             autocorr =       1.316168933612
   target nu stat err =       0.000547035624
   target dn stat err =       0.004242543344
      target stat err =       0.003569254949
              std dev =       0.674333583881
             le_variance =       0.454725782350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266212539343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741368343849       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741368343849       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741368343849       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741368343849       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+21, overlap shift 3.9062e+22 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741368343849       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741368343849       residual = 8.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.883402 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9482e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6436
    reference variance = 0.401541
====================================================
  Execution time = 4.3688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5656e-01
  Total weights = 2.0000e+06
  Execution time = 3.6391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456581641085
                                         uncertainty =       0.004452476179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456581641085
                                         uncertainty =       0.004452476179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477786849
  error estimate for blocks of size 2^( 2) =       0.000501280955
  error estimate for blocks of size 2^( 3) =       0.000522822968
  error estimate for blocks of size 2^( 4) =       0.000537563716
  error estimate for blocks of size 2^( 5) =       0.000546301195
  error estimate for blocks of size 2^( 6) =       0.000549399805
  error estimate for blocks of size 2^( 7) =       0.000553384628

      target function =      -0.739814787009
              le_mean =     -22.663057746713
             les_mean =     514.070746747799
             stat err =       0.000546662336
             autocorr =       1.309091259236
   target nu stat err =       0.000546662336
   target dn stat err =       0.004186792177
      target stat err =       0.003514223358
              std dev =       0.675692641103
             le_variance =       0.456560545240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456581641085
                                         uncertainty =       0.004452476179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456581641085
                                         uncertainty =       0.004452476179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477786849
  error estimate for blocks of size 2^( 2) =       0.000501280955
  error estimate for blocks of size 2^( 3) =       0.000522822968
  error estimate for blocks of size 2^( 4) =       0.000537563716
  error estimate for blocks of size 2^( 5) =       0.000546301195
  error estimate for blocks of size 2^( 6) =       0.000549399805
  error estimate for blocks of size 2^( 7) =       0.000553384628

      target function =      -0.739814787009
              le_mean =     -22.663057746713
             les_mean =     514.070746747799
             stat err =       0.000546662336
             autocorr =       1.309091259236
   target nu stat err =       0.000546662336
   target dn stat err =       0.004186792177
      target stat err =       0.003514223358
              std dev =       0.675692641103
             le_variance =       0.456560545240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456581641085
                                         uncertainty =       0.004452476179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456581641085
                                         uncertainty =       0.004452476179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477786849
  error estimate for blocks of size 2^( 2) =       0.000501280955
  error estimate for blocks of size 2^( 3) =       0.000522822968
  error estimate for blocks of size 2^( 4) =       0.000537563716
  error estimate for blocks of size 2^( 5) =       0.000546301195
  error estimate for blocks of size 2^( 6) =       0.000549399805
  error estimate for blocks of size 2^( 7) =       0.000553384628

      target function =      -0.739814787009
              le_mean =     -22.663057746713
             les_mean =     514.070746747799
             stat err =       0.000546662336
             autocorr =       1.309091259236
   target nu stat err =       0.000546662336
   target dn stat err =       0.004186792177
      target stat err =       0.003514223358
              std dev =       0.675692641103
             le_variance =       0.456560545240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456581641085
                                         uncertainty =       0.004452476179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456581641085
                                         uncertainty =       0.004452476179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477786849
  error estimate for blocks of size 2^( 2) =       0.000501280955
  error estimate for blocks of size 2^( 3) =       0.000522822968
  error estimate for blocks of size 2^( 4) =       0.000537563716
  error estimate for blocks of size 2^( 5) =       0.000546301195
  error estimate for blocks of size 2^( 6) =       0.000549399805
  error estimate for blocks of size 2^( 7) =       0.000553384628

      target function =      -0.739814787009
              le_mean =     -22.663057746713
             les_mean =     514.070746747799
             stat err =       0.000546662336
             autocorr =       1.309091259236
   target nu stat err =       0.000546662336
   target dn stat err =       0.004186792177
      target stat err =       0.003514223358
              std dev =       0.675692641103
             le_variance =       0.456560545240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739814787009        initial  <--
     2.4414e+20     2.4414e+21             0.0000e+00        -0.739814787009
     9.7656e+20     9.7656e+21             0.0000e+00        -0.739814787009
     3.9062e+21     3.9062e+22             0.0000e+00        -0.739814787009

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9089
  </log>
  <optVariables href="FORM2.s034.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2140e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.68
    reference variance = 0.331433
====================================================
  Execution time = 4.4419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5488e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5457e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454870816276
                                         uncertainty =       0.005055239767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454870816276
                                         uncertainty =       0.005055239767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476904342
  error estimate for blocks of size 2^( 2) =       0.000500194468
  error estimate for blocks of size 2^( 3) =       0.000521948319
  error estimate for blocks of size 2^( 4) =       0.000537482425
  error estimate for blocks of size 2^( 5) =       0.000545490647
  error estimate for blocks of size 2^( 6) =       0.000549436106
  error estimate for blocks of size 2^( 7) =       0.000551719986

      target function =      -0.741218343175
              le_mean =     -22.662286669678
             les_mean =     514.034112373259
             stat err =       0.000546032291
             autocorr =       1.310913697034
   target nu stat err =       0.000546032291
   target dn stat err =       0.005003554515
      target stat err =       0.004191484747
              std dev =       0.674444587812
             le_variance =       0.454875502029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266228666968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741241185190       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741241185190       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741241185190       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+21 is 1.939264e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741241185190       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741241185190       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741241185190       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741241185190       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741241186857       residual = 1.21e+05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+21 is 5.598545e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+22, overlap shift 3.9062e+23 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741241185190       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741241185190       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741241185190       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741241185190       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741241185189       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741241185190       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+22 is 2.614332e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.885262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9884e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.6848
    reference variance = 0.387275
====================================================
  Execution time = 4.4529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4685e-01
  Total weights = 2.0000e+06
  Execution time = 4.2656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446865258759
                                         uncertainty =       0.003134698728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446865258759
                                         uncertainty =       0.003134698728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472679876
  error estimate for blocks of size 2^( 2) =       0.000496981818
  error estimate for blocks of size 2^( 3) =       0.000519084706
  error estimate for blocks of size 2^( 4) =       0.000534830308
  error estimate for blocks of size 2^( 5) =       0.000544428263
  error estimate for blocks of size 2^( 6) =       0.000548241304
  error estimate for blocks of size 2^( 7) =       0.000549067957

      target function =      -0.747946274016
              le_mean =     -22.661917966798
             les_mean =     514.009378241585
             stat err =       0.000544141958
             autocorr =       1.325226780013
   target nu stat err =       0.000544141958
   target dn stat err =       0.002981161063
      target stat err =       0.002588080717
              std dev =       0.668470291880
             le_variance =       0.446852531126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446865258759
                                         uncertainty =       0.003134698728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446865258759
                                         uncertainty =       0.003134698728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472679876
  error estimate for blocks of size 2^( 2) =       0.000496981818
  error estimate for blocks of size 2^( 3) =       0.000519084706
  error estimate for blocks of size 2^( 4) =       0.000534830308
  error estimate for blocks of size 2^( 5) =       0.000544428263
  error estimate for blocks of size 2^( 6) =       0.000548241304
  error estimate for blocks of size 2^( 7) =       0.000549067957

      target function =      -0.747946274016
              le_mean =     -22.661917966798
             les_mean =     514.009378241585
             stat err =       0.000544141958
             autocorr =       1.325226780013
   target nu stat err =       0.000544141958
   target dn stat err =       0.002981161063
      target stat err =       0.002588080717
              std dev =       0.668470291880
             le_variance =       0.446852531126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446865258759
                                         uncertainty =       0.003134698728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446865258759
                                         uncertainty =       0.003134698728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472679876
  error estimate for blocks of size 2^( 2) =       0.000496981818
  error estimate for blocks of size 2^( 3) =       0.000519084706
  error estimate for blocks of size 2^( 4) =       0.000534830308
  error estimate for blocks of size 2^( 5) =       0.000544428263
  error estimate for blocks of size 2^( 6) =       0.000548241304
  error estimate for blocks of size 2^( 7) =       0.000549067957

      target function =      -0.747946274016
              le_mean =     -22.661917966798
             les_mean =     514.009378241585
             stat err =       0.000544141958
             autocorr =       1.325226780013
   target nu stat err =       0.000544141958
   target dn stat err =       0.002981161063
      target stat err =       0.002588080717
              std dev =       0.668470291880
             le_variance =       0.446852531126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446865258759
                                         uncertainty =       0.003134698728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446865258759
                                         uncertainty =       0.003134698728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472679876
  error estimate for blocks of size 2^( 2) =       0.000496981818
  error estimate for blocks of size 2^( 3) =       0.000519084706
  error estimate for blocks of size 2^( 4) =       0.000534830308
  error estimate for blocks of size 2^( 5) =       0.000544428263
  error estimate for blocks of size 2^( 6) =       0.000548241304
  error estimate for blocks of size 2^( 7) =       0.000549067957

      target function =      -0.747946274016
              le_mean =     -22.661917966798
             les_mean =     514.009378241585
             stat err =       0.000544141958
             autocorr =       1.325226780013
   target nu stat err =       0.000544141958
   target dn stat err =       0.002981161063
      target stat err =       0.002588080717
              std dev =       0.668470291880
             le_variance =       0.446852531126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747946274016        initial  <--
     2.4414e+21     2.4414e+22             1.9393e-26        -0.747946274016
     9.7656e+21     9.7656e+22             5.5985e-27        -0.747946274016
     3.9062e+22     3.9062e+23             2.6143e-27        -0.747946274016

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6441
  </log>
  <optVariables href="FORM2.s035.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2353e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7384
    reference variance = 0.339447
====================================================
  Execution time = 4.4612e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6072e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5382e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460704246021
                                         uncertainty =       0.012838155262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.460704246021
                                         uncertainty =       0.012838155262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479961031
  error estimate for blocks of size 2^( 2) =       0.000503876369
  error estimate for blocks of size 2^( 3) =       0.000524917644
  error estimate for blocks of size 2^( 4) =       0.000540708048
  error estimate for blocks of size 2^( 5) =       0.000549263608
  error estimate for blocks of size 2^( 6) =       0.000554668189
  error estimate for blocks of size 2^( 7) =       0.000554672548

      target function =      -0.736304315686
              le_mean =     -22.661530126555
             les_mean =     514.005672628637
             stat err =       0.000549828098
             autocorr =       1.312326520796
   target nu stat err =       0.000549828098
   target dn stat err =       0.012387825970
      target stat err =       0.010139375988
              std dev =       0.678767399206
             le_variance =       0.460725182225


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266153012656e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736443853283       residual = 7.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736443853283       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736443853283       residual = 7.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+22 is 3.519158e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736443853283       residual = 7.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736443853283       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736443853283       residual = 7.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+22 is 8.797894e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+23, overlap shift 3.9062e+24 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736443853283       residual = 7.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736443853283       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736443853283       residual = 7.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+23 is 2.199474e-28

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.886586 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0002e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6933
    reference variance = 0.260611
====================================================
  Execution time = 4.3907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5438e-01
  Total weights = 2.0000e+06
  Execution time = 3.6480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454400484334
                                         uncertainty =       0.003736270618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454400484334
                                         uncertainty =       0.003736270618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476642054
  error estimate for blocks of size 2^( 2) =       0.000500112133
  error estimate for blocks of size 2^( 3) =       0.000522039919
  error estimate for blocks of size 2^( 4) =       0.000537252454
  error estimate for blocks of size 2^( 5) =       0.000544700798
  error estimate for blocks of size 2^( 6) =       0.000550341651
  error estimate for blocks of size 2^( 7) =       0.000551673258

      target function =      -0.741644834470
              le_mean =     -22.662224902210
             les_mean =     514.030812585811
             stat err =       0.000545992040
             autocorr =       1.312163365603
   target nu stat err =       0.000545992040
   target dn stat err =       0.003697161258
      target stat err =       0.003127501748
              std dev =       0.674073656710
             le_variance =       0.454375294670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454400484334
                                         uncertainty =       0.003736270618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454400484334
                                         uncertainty =       0.003736270618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476642054
  error estimate for blocks of size 2^( 2) =       0.000500112133
  error estimate for blocks of size 2^( 3) =       0.000522039919
  error estimate for blocks of size 2^( 4) =       0.000537252454
  error estimate for blocks of size 2^( 5) =       0.000544700798
  error estimate for blocks of size 2^( 6) =       0.000550341651
  error estimate for blocks of size 2^( 7) =       0.000551673258

      target function =      -0.741644834470
              le_mean =     -22.662224902210
             les_mean =     514.030812585811
             stat err =       0.000545992040
             autocorr =       1.312163365603
   target nu stat err =       0.000545992040
   target dn stat err =       0.003697161258
      target stat err =       0.003127501748
              std dev =       0.674073656710
             le_variance =       0.454375294670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454400484334
                                         uncertainty =       0.003736270618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454400484334
                                         uncertainty =       0.003736270618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476642054
  error estimate for blocks of size 2^( 2) =       0.000500112133
  error estimate for blocks of size 2^( 3) =       0.000522039919
  error estimate for blocks of size 2^( 4) =       0.000537252454
  error estimate for blocks of size 2^( 5) =       0.000544700798
  error estimate for blocks of size 2^( 6) =       0.000550341651
  error estimate for blocks of size 2^( 7) =       0.000551673258

      target function =      -0.741644834470
              le_mean =     -22.662224902210
             les_mean =     514.030812585811
             stat err =       0.000545992040
             autocorr =       1.312163365603
   target nu stat err =       0.000545992040
   target dn stat err =       0.003697161258
      target stat err =       0.003127501748
              std dev =       0.674073656710
             le_variance =       0.454375294670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454400484334
                                         uncertainty =       0.003736270618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454400484334
                                         uncertainty =       0.003736270618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476642054
  error estimate for blocks of size 2^( 2) =       0.000500112133
  error estimate for blocks of size 2^( 3) =       0.000522039919
  error estimate for blocks of size 2^( 4) =       0.000537252454
  error estimate for blocks of size 2^( 5) =       0.000544700798
  error estimate for blocks of size 2^( 6) =       0.000550341651
  error estimate for blocks of size 2^( 7) =       0.000551673258

      target function =      -0.741644834470
              le_mean =     -22.662224902210
             les_mean =     514.030812585811
             stat err =       0.000545992040
             autocorr =       1.312163365603
   target nu stat err =       0.000545992040
   target dn stat err =       0.003697161258
      target stat err =       0.003127501748
              std dev =       0.674073656710
             le_variance =       0.454375294670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741644834470        initial  <--
     2.4414e+22     2.4414e+23             3.5192e-27        -0.741644834470
     9.7656e+22     9.7656e+23             8.7979e-28        -0.741644834470
     3.9062e+23     3.9062e+24             2.1995e-28        -0.741644834470

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.1374
  </log>
  <optVariables href="FORM2.s036.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2215e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.648
    reference variance = 0.329739
====================================================
  Execution time = 4.4449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4638e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5170e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446470541491
                                         uncertainty =       0.002472383917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446470541491
                                         uncertainty =       0.002472383917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472431198
  error estimate for blocks of size 2^( 2) =       0.000496117325
  error estimate for blocks of size 2^( 3) =       0.000518160308
  error estimate for blocks of size 2^( 4) =       0.000533434198
  error estimate for blocks of size 2^( 5) =       0.000544010991
  error estimate for blocks of size 2^( 6) =       0.000547336907
  error estimate for blocks of size 2^( 7) =       0.000549865242

      target function =      -0.748344324528
              le_mean =     -22.661983826674
             les_mean =     514.011893211659
             stat err =       0.000543661834
             autocorr =       1.324282233302
   target nu stat err =       0.000543661834
   target dn stat err =       0.002577638706
      target stat err =       0.002261284263
              std dev =       0.668118608039
             le_variance =       0.446382474409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266198382667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748350212708       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748350212708       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748350212708       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748350212708       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748350212708       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+23 is 2.740788e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+24, overlap shift 3.9062e+25 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748350212708       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748350212708       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.887773 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9627e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.5826
    reference variance = 0.329533
====================================================
  Execution time = 4.4507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.9401e-01
  Total weights = 2.0000e+06
  Execution time = 4.3731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494064447980
                                         uncertainty =       0.043803072242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494064447980
                                         uncertainty =       0.043803072242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496998057
  error estimate for blocks of size 2^( 2) =       0.000519975019
  error estimate for blocks of size 2^( 3) =       0.000541212178
  error estimate for blocks of size 2^( 4) =       0.000556106299
  error estimate for blocks of size 2^( 5) =       0.000564015847
  error estimate for blocks of size 2^( 6) =       0.000569213615
  error estimate for blocks of size 2^( 7) =       0.000571045165

      target function =      -0.708566651113
              le_mean =     -22.662718812300
             les_mean =     514.092837854722
             stat err =       0.000565095231
             autocorr =       1.292807622237
   target nu stat err =       0.000565095231
   target dn stat err =       0.043840208789
      target stat err =       0.033302500222
              std dev =       0.702861392003
             le_variance =       0.494014136368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494064447980
                                         uncertainty =       0.043803072242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494064447980
                                         uncertainty =       0.043803072242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496998057
  error estimate for blocks of size 2^( 2) =       0.000519975019
  error estimate for blocks of size 2^( 3) =       0.000541212178
  error estimate for blocks of size 2^( 4) =       0.000556106299
  error estimate for blocks of size 2^( 5) =       0.000564015847
  error estimate for blocks of size 2^( 6) =       0.000569213615
  error estimate for blocks of size 2^( 7) =       0.000571045165

      target function =      -0.708566651113
              le_mean =     -22.662718812300
             les_mean =     514.092837854722
             stat err =       0.000565095231
             autocorr =       1.292807622237
   target nu stat err =       0.000565095231
   target dn stat err =       0.043840208789
      target stat err =       0.033302500222
              std dev =       0.702861392003
             le_variance =       0.494014136368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494064447980
                                         uncertainty =       0.043803072242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494064447980
                                         uncertainty =       0.043803072242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496998057
  error estimate for blocks of size 2^( 2) =       0.000519975019
  error estimate for blocks of size 2^( 3) =       0.000541212178
  error estimate for blocks of size 2^( 4) =       0.000556106299
  error estimate for blocks of size 2^( 5) =       0.000564015847
  error estimate for blocks of size 2^( 6) =       0.000569213615
  error estimate for blocks of size 2^( 7) =       0.000571045165

      target function =      -0.708566651113
              le_mean =     -22.662718812300
             les_mean =     514.092837854722
             stat err =       0.000565095231
             autocorr =       1.292807622237
   target nu stat err =       0.000565095231
   target dn stat err =       0.043840208789
      target stat err =       0.033302500222
              std dev =       0.702861392003
             le_variance =       0.494014136368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494064447980
                                         uncertainty =       0.043803072242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494064447980
                                         uncertainty =       0.043803072242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496998057
  error estimate for blocks of size 2^( 2) =       0.000519975019
  error estimate for blocks of size 2^( 3) =       0.000541212178
  error estimate for blocks of size 2^( 4) =       0.000556106299
  error estimate for blocks of size 2^( 5) =       0.000564015847
  error estimate for blocks of size 2^( 6) =       0.000569213615
  error estimate for blocks of size 2^( 7) =       0.000571045165

      target function =      -0.708566651113
              le_mean =     -22.662718812300
             les_mean =     514.092837854722
             stat err =       0.000565095231
             autocorr =       1.292807622237
   target nu stat err =       0.000565095231
   target dn stat err =       0.043840208789
      target stat err =       0.033302500222
              std dev =       0.702861392003
             le_variance =       0.494014136368


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.708566651113        initial  <--
     2.4414e+23     2.4414e+24             0.0000e+00        -0.708566651113
     9.7656e+23     9.7656e+24             2.7408e-29        -0.708566651113
     3.9062e+24     3.9062e+25             0.0000e+00        -0.708566651113

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.0046
  </log>
  <optVariables href="FORM2.s037.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2364e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6531
    reference variance = 0.366273
====================================================
  Execution time = 4.6428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4701e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5186e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447043657801
                                         uncertainty =       0.002438302113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447043657801
                                         uncertainty =       0.002438302113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472763723
  error estimate for blocks of size 2^( 2) =       0.000496997238
  error estimate for blocks of size 2^( 3) =       0.000519274266
  error estimate for blocks of size 2^( 4) =       0.000535076743
  error estimate for blocks of size 2^( 5) =       0.000544349504
  error estimate for blocks of size 2^( 6) =       0.000547969769
  error estimate for blocks of size 2^( 7) =       0.000550596821

      target function =      -0.747814895524
              le_mean =     -22.661959646228
             les_mean =     514.011425859349
             stat err =       0.000544498209
             autocorr =       1.326491964298
   target nu stat err =       0.000544498209
   target dn stat err =       0.002432128277
      target stat err =       0.002140568089
              std dev =       0.668588868875
             le_variance =       0.447011075584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266195964623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747820028575       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747820028575       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747820028575       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+24 is 6.968833e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747820028575       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747820028575       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747820028575       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747820028575       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+24 is 1.742208e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+25, overlap shift 3.9062e+26 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747820028575       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747820028575       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747820028577       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+25 is 4.355520e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.889222 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1622e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6356
    reference variance = 0.426771
====================================================
  Execution time = 4.4183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.6412e-01
  Total weights = 2.0000e+06
  Execution time = 3.6539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464210913493
                                         uncertainty =       0.007646397679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464210913493
                                         uncertainty =       0.007646397679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481725274
  error estimate for blocks of size 2^( 2) =       0.000504695898
  error estimate for blocks of size 2^( 3) =       0.000525691837
  error estimate for blocks of size 2^( 4) =       0.000541261876
  error estimate for blocks of size 2^( 5) =       0.000550764458
  error estimate for blocks of size 2^( 6) =       0.000556554295
  error estimate for blocks of size 2^( 7) =       0.000560295459

      target function =      -0.733602889270
              le_mean =     -22.662673949279
             les_mean =     514.060908779098
             stat err =       0.000552219022
             autocorr =       1.314086215141
   target nu stat err =       0.000552219022
   target dn stat err =       0.007062536199
      target stat err =       0.005769557869
              std dev =       0.681262416287
             le_variance =       0.464118479845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464210913493
                                         uncertainty =       0.007646397679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464210913493
                                         uncertainty =       0.007646397679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481725274
  error estimate for blocks of size 2^( 2) =       0.000504695898
  error estimate for blocks of size 2^( 3) =       0.000525691837
  error estimate for blocks of size 2^( 4) =       0.000541261876
  error estimate for blocks of size 2^( 5) =       0.000550764458
  error estimate for blocks of size 2^( 6) =       0.000556554295
  error estimate for blocks of size 2^( 7) =       0.000560295459

      target function =      -0.733602889270
              le_mean =     -22.662673949279
             les_mean =     514.060908779098
             stat err =       0.000552219022
             autocorr =       1.314086215141
   target nu stat err =       0.000552219022
   target dn stat err =       0.007062536199
      target stat err =       0.005769557869
              std dev =       0.681262416287
             le_variance =       0.464118479845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464210913493
                                         uncertainty =       0.007646397679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464210913493
                                         uncertainty =       0.007646397679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481725274
  error estimate for blocks of size 2^( 2) =       0.000504695898
  error estimate for blocks of size 2^( 3) =       0.000525691837
  error estimate for blocks of size 2^( 4) =       0.000541261876
  error estimate for blocks of size 2^( 5) =       0.000550764458
  error estimate for blocks of size 2^( 6) =       0.000556554295
  error estimate for blocks of size 2^( 7) =       0.000560295459

      target function =      -0.733602889270
              le_mean =     -22.662673949279
             les_mean =     514.060908779098
             stat err =       0.000552219022
             autocorr =       1.314086215141
   target nu stat err =       0.000552219022
   target dn stat err =       0.007062536199
      target stat err =       0.005769557869
              std dev =       0.681262416287
             le_variance =       0.464118479845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464210913493
                                         uncertainty =       0.007646397679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464210913493
                                         uncertainty =       0.007646397679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481725274
  error estimate for blocks of size 2^( 2) =       0.000504695898
  error estimate for blocks of size 2^( 3) =       0.000525691837
  error estimate for blocks of size 2^( 4) =       0.000541261876
  error estimate for blocks of size 2^( 5) =       0.000550764458
  error estimate for blocks of size 2^( 6) =       0.000556554295
  error estimate for blocks of size 2^( 7) =       0.000560295459

      target function =      -0.733602889270
              le_mean =     -22.662673949279
             les_mean =     514.060908779098
             stat err =       0.000552219022
             autocorr =       1.314086215141
   target nu stat err =       0.000552219022
   target dn stat err =       0.007062536199
      target stat err =       0.005769557869
              std dev =       0.681262416287
             le_variance =       0.464118479845


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.733602889270        initial  <--
     2.4414e+24     2.4414e+25             6.9688e-30        -0.733602889270
     9.7656e+24     9.7656e+25             1.7422e-30        -0.733602889270
     3.9062e+25     3.9062e+26             4.3555e-31        -0.733602889270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4645
  </log>
  <optVariables href="FORM2.s038.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2409e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6562
    reference variance = 0.394008
====================================================
  Execution time = 4.4750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4940e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5163e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449443132780
                                         uncertainty =       0.002999618801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449443132780
                                         uncertainty =       0.002999618801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474027087
  error estimate for blocks of size 2^( 2) =       0.000497574981
  error estimate for blocks of size 2^( 3) =       0.000519046142
  error estimate for blocks of size 2^( 4) =       0.000534717730
  error estimate for blocks of size 2^( 5) =       0.000543948983
  error estimate for blocks of size 2^( 6) =       0.000549286300
  error estimate for blocks of size 2^( 7) =       0.000552197380

      target function =      -0.745794967289
              le_mean =     -22.662288490789
             les_mean =     514.028722773458
             stat err =       0.000545037598
             autocorr =       1.322046121589
   target nu stat err =       0.000545037598
   target dn stat err =       0.003228167260
      target stat err =       0.002777037082
              std dev =       0.670375535363
             le_variance =       0.449403358414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266228849079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745804355970       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745804355970       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745804355971       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+25 is 1.169637e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745804355970       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745804355970       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745804355967       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+25 is 2.924092e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+26, overlap shift 3.9062e+27 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745804355970       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745804355970       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745804355975       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+26 is 7.310229e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.890548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9921e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6275
    reference variance = 0.303777
====================================================
  Execution time = 4.3708e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5432e-01
  Total weights = 2.0000e+06
  Execution time = 3.6531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454361755843
                                         uncertainty =       0.003851637647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454361755843
                                         uncertainty =       0.003851637647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476615625
  error estimate for blocks of size 2^( 2) =       0.000500224508
  error estimate for blocks of size 2^( 3) =       0.000522038337
  error estimate for blocks of size 2^( 4) =       0.000537625088
  error estimate for blocks of size 2^( 5) =       0.000547525066
  error estimate for blocks of size 2^( 6) =       0.000551248356
  error estimate for blocks of size 2^( 7) =       0.000552886840

      target function =      -0.741685641358
              le_mean =     -22.662263610753
             les_mean =     514.032516643689
             stat err =       0.000547321337
             autocorr =       1.318706685281
   target nu stat err =       0.000547321337
   target dn stat err =       0.003751438643
      target stat err =       0.003172492857
              std dev =       0.674036280629
             le_variance =       0.454324907605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454361755843
                                         uncertainty =       0.003851637647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454361755843
                                         uncertainty =       0.003851637647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476615625
  error estimate for blocks of size 2^( 2) =       0.000500224508
  error estimate for blocks of size 2^( 3) =       0.000522038337
  error estimate for blocks of size 2^( 4) =       0.000537625088
  error estimate for blocks of size 2^( 5) =       0.000547525066
  error estimate for blocks of size 2^( 6) =       0.000551248356
  error estimate for blocks of size 2^( 7) =       0.000552886840

      target function =      -0.741685641358
              le_mean =     -22.662263610753
             les_mean =     514.032516643689
             stat err =       0.000547321337
             autocorr =       1.318706685280
   target nu stat err =       0.000547321337
   target dn stat err =       0.003751438643
      target stat err =       0.003172492857
              std dev =       0.674036280629
             le_variance =       0.454324907605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454361755843
                                         uncertainty =       0.003851637647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454361755843
                                         uncertainty =       0.003851637647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476615625
  error estimate for blocks of size 2^( 2) =       0.000500224508
  error estimate for blocks of size 2^( 3) =       0.000522038337
  error estimate for blocks of size 2^( 4) =       0.000537625088
  error estimate for blocks of size 2^( 5) =       0.000547525066
  error estimate for blocks of size 2^( 6) =       0.000551248356
  error estimate for blocks of size 2^( 7) =       0.000552886840

      target function =      -0.741685641358
              le_mean =     -22.662263610753
             les_mean =     514.032516643689
             stat err =       0.000547321337
             autocorr =       1.318706685280
   target nu stat err =       0.000547321337
   target dn stat err =       0.003751438643
      target stat err =       0.003172492857
              std dev =       0.674036280629
             le_variance =       0.454324907605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454361755843
                                         uncertainty =       0.003851637647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454361755843
                                         uncertainty =       0.003851637647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476615625
  error estimate for blocks of size 2^( 2) =       0.000500224508
  error estimate for blocks of size 2^( 3) =       0.000522038337
  error estimate for blocks of size 2^( 4) =       0.000537625088
  error estimate for blocks of size 2^( 5) =       0.000547525066
  error estimate for blocks of size 2^( 6) =       0.000551248356
  error estimate for blocks of size 2^( 7) =       0.000552886840

      target function =      -0.741685641358
              le_mean =     -22.662263610753
             les_mean =     514.032516643689
             stat err =       0.000547321337
             autocorr =       1.318706685280
   target nu stat err =       0.000547321337
   target dn stat err =       0.003751438643
      target stat err =       0.003172492857
              std dev =       0.674036280629
             le_variance =       0.454324907605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741685641358        initial  <--
     2.4414e+25     2.4414e+26             1.1696e-30        -0.741685641358
     9.7656e+25     9.7656e+26             2.9241e-31        -0.741685641358
     3.9062e+26     3.9062e+27             7.3102e-32        -0.741685641358

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9835
  </log>
  <optVariables href="FORM2.s039.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2191e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.694
    reference variance = 0.536496
====================================================
  Execution time = 4.5944e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6207e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5369e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462066905047
                                         uncertainty =       0.011967220696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.462066905047
                                         uncertainty =       0.011967220696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000480663606
  error estimate for blocks of size 2^( 2) =       0.000503985314
  error estimate for blocks of size 2^( 3) =       0.000525446513
  error estimate for blocks of size 2^( 4) =       0.000540410844
  error estimate for blocks of size 2^( 5) =       0.000547966678
  error estimate for blocks of size 2^( 6) =       0.000552360458
  error estimate for blocks of size 2^( 7) =       0.000554891476

      target function =      -0.735203944107
              le_mean =     -22.661912734592
             les_mean =     514.024363562947
             stat err =       0.000548907364
             autocorr =       1.304114231251
   target nu stat err =       0.000548907364
   target dn stat err =       0.011976752368
      target stat err =       0.009780355866
              std dev =       0.679760990142
             le_variance =       0.462075003719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266191273459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735332210428       residual = 8.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735332210428       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735332210428       residual = 8.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+26 is 5.264913e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735332210428       residual = 8.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735332210428       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735332210428       residual = 8.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+26 is 1.316228e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+27, overlap shift 3.9062e+28 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735332210428       residual = 8.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735332210428       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735332210428       residual = 8.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+27 is 3.290571e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.891928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1320e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.5775
    reference variance = 0.31332
====================================================
  Execution time = 4.5780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5099e-01
  Total weights = 2.0000e+06
  Execution time = 3.6338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450920277011
                                         uncertainty =       0.003528375021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450920277011
                                         uncertainty =       0.003528375021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474863790
  error estimate for blocks of size 2^( 2) =       0.000498515211
  error estimate for blocks of size 2^( 3) =       0.000520713864
  error estimate for blocks of size 2^( 4) =       0.000536359963
  error estimate for blocks of size 2^( 5) =       0.000544752295
  error estimate for blocks of size 2^( 6) =       0.000549882313
  error estimate for blocks of size 2^( 7) =       0.000552592133

      target function =      -0.744447401823
              le_mean =     -22.663146726405
             les_mean =     514.069210554522
             stat err =       0.000545896676
             autocorr =       1.321547542015
   target nu stat err =       0.000545896676
   target dn stat err =       0.003906333806
      target stat err =       0.003327027280
              std dev =       0.671558811623
             le_variance =       0.450991237469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450920277011
                                         uncertainty =       0.003528375021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450920277011
                                         uncertainty =       0.003528375021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474863790
  error estimate for blocks of size 2^( 2) =       0.000498515211
  error estimate for blocks of size 2^( 3) =       0.000520713864
  error estimate for blocks of size 2^( 4) =       0.000536359963
  error estimate for blocks of size 2^( 5) =       0.000544752295
  error estimate for blocks of size 2^( 6) =       0.000549882313
  error estimate for blocks of size 2^( 7) =       0.000552592133

      target function =      -0.744447401823
              le_mean =     -22.663146726405
             les_mean =     514.069210554522
             stat err =       0.000545896676
             autocorr =       1.321547542015
   target nu stat err =       0.000545896676
   target dn stat err =       0.003906333806
      target stat err =       0.003327027280
              std dev =       0.671558811623
             le_variance =       0.450991237469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450920277011
                                         uncertainty =       0.003528375021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450920277011
                                         uncertainty =       0.003528375021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474863790
  error estimate for blocks of size 2^( 2) =       0.000498515211
  error estimate for blocks of size 2^( 3) =       0.000520713864
  error estimate for blocks of size 2^( 4) =       0.000536359963
  error estimate for blocks of size 2^( 5) =       0.000544752295
  error estimate for blocks of size 2^( 6) =       0.000549882313
  error estimate for blocks of size 2^( 7) =       0.000552592133

      target function =      -0.744447401823
              le_mean =     -22.663146726405
             les_mean =     514.069210554522
             stat err =       0.000545896676
             autocorr =       1.321547542015
   target nu stat err =       0.000545896676
   target dn stat err =       0.003906333806
      target stat err =       0.003327027280
              std dev =       0.671558811623
             le_variance =       0.450991237469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450920277011
                                         uncertainty =       0.003528375021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450920277011
                                         uncertainty =       0.003528375021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474863790
  error estimate for blocks of size 2^( 2) =       0.000498515211
  error estimate for blocks of size 2^( 3) =       0.000520713864
  error estimate for blocks of size 2^( 4) =       0.000536359963
  error estimate for blocks of size 2^( 5) =       0.000544752295
  error estimate for blocks of size 2^( 6) =       0.000549882313
  error estimate for blocks of size 2^( 7) =       0.000552592133

      target function =      -0.744447401823
              le_mean =     -22.663146726405
             les_mean =     514.069210554522
             stat err =       0.000545896676
             autocorr =       1.321547542015
   target nu stat err =       0.000545896676
   target dn stat err =       0.003906333806
      target stat err =       0.003327027280
              std dev =       0.671558811623
             le_variance =       0.450991237469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744447401823        initial  <--
     2.4414e+26     2.4414e+27             5.2649e-31        -0.744447401823
     9.7656e+26     9.7656e+27             1.3162e-31        -0.744447401823
     3.9062e+27     3.9062e+28             3.2906e-32        -0.744447401823

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.9636
  </log>
  <optVariables href="FORM2.s040.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2529e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7612
    reference variance = 0.504078
====================================================
  Execution time = 4.4905e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5066e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446271704215
                                         uncertainty =       0.002716072642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446271704215
                                         uncertainty =       0.002716072642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472340126
  error estimate for blocks of size 2^( 2) =       0.000496313405
  error estimate for blocks of size 2^( 3) =       0.000517839521
  error estimate for blocks of size 2^( 4) =       0.000533617138
  error estimate for blocks of size 2^( 5) =       0.000543601528
  error estimate for blocks of size 2^( 6) =       0.000548453212
  error estimate for blocks of size 2^( 7) =       0.000551615217

      target function =      -0.748488951130
              le_mean =     -22.662063160622
             les_mean =     514.015316862119
             stat err =       0.000544321774
             autocorr =       1.328011183631
   target nu stat err =       0.000544321774
   target dn stat err =       0.002597513404
      target stat err =       0.002278763102
              std dev =       0.667989812194
             le_variance =       0.446210389195


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266206316062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748494902222       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748494902222       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748494902222       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748494902222       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+27 is 1.480675e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748494902222       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748494902222       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748494902222       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748494902222       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+27 is 3.701688e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+28, overlap shift 3.9062e+29 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748494902222       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748494902222       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748494902160       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+28 is 7.792871e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.893470 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0013e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6499
    reference variance = 0.371844
====================================================
  Execution time = 4.3737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4988e-01
  Total weights = 2.0000e+06
  Execution time = 3.6366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449877928427
                                         uncertainty =       0.003117834731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449877928427
                                         uncertainty =       0.003117834731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474277288
  error estimate for blocks of size 2^( 2) =       0.000497788595
  error estimate for blocks of size 2^( 3) =       0.000519808520
  error estimate for blocks of size 2^( 4) =       0.000534213488
  error estimate for blocks of size 2^( 5) =       0.000543709876
  error estimate for blocks of size 2^( 6) =       0.000549374582
  error estimate for blocks of size 2^( 7) =       0.000553057256

      target function =      -0.745387103201
              le_mean =     -22.663073155156
             les_mean =     514.064762502938
             stat err =       0.000545088800
             autocorr =       1.320899762456
   target nu stat err =       0.000545088800
   target dn stat err =       0.003062395331
      target stat err =       0.002641888842
              std dev =       0.670729373090
             le_variance =       0.449877891926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449877928427
                                         uncertainty =       0.003117834731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449877928427
                                         uncertainty =       0.003117834731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474277288
  error estimate for blocks of size 2^( 2) =       0.000497788595
  error estimate for blocks of size 2^( 3) =       0.000519808520
  error estimate for blocks of size 2^( 4) =       0.000534213488
  error estimate for blocks of size 2^( 5) =       0.000543709876
  error estimate for blocks of size 2^( 6) =       0.000549374582
  error estimate for blocks of size 2^( 7) =       0.000553057256

      target function =      -0.745387103201
              le_mean =     -22.663073155156
             les_mean =     514.064762502938
             stat err =       0.000545088800
             autocorr =       1.320899762458
   target nu stat err =       0.000545088800
   target dn stat err =       0.003062395331
      target stat err =       0.002641888842
              std dev =       0.670729373090
             le_variance =       0.449877891926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449877928427
                                         uncertainty =       0.003117834731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449877928427
                                         uncertainty =       0.003117834731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474277288
  error estimate for blocks of size 2^( 2) =       0.000497788595
  error estimate for blocks of size 2^( 3) =       0.000519808520
  error estimate for blocks of size 2^( 4) =       0.000534213488
  error estimate for blocks of size 2^( 5) =       0.000543709876
  error estimate for blocks of size 2^( 6) =       0.000549374582
  error estimate for blocks of size 2^( 7) =       0.000553057256

      target function =      -0.745387103201
              le_mean =     -22.663073155156
             les_mean =     514.064762502938
             stat err =       0.000545088800
             autocorr =       1.320899762458
   target nu stat err =       0.000545088800
   target dn stat err =       0.003062395331
      target stat err =       0.002641888842
              std dev =       0.670729373090
             le_variance =       0.449877891926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449877928427
                                         uncertainty =       0.003117834731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449877928427
                                         uncertainty =       0.003117834731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474277288
  error estimate for blocks of size 2^( 2) =       0.000497788595
  error estimate for blocks of size 2^( 3) =       0.000519808520
  error estimate for blocks of size 2^( 4) =       0.000534213488
  error estimate for blocks of size 2^( 5) =       0.000543709876
  error estimate for blocks of size 2^( 6) =       0.000549374582
  error estimate for blocks of size 2^( 7) =       0.000553057256

      target function =      -0.745387103201
              le_mean =     -22.663073155156
             les_mean =     514.064762502938
             stat err =       0.000545088800
             autocorr =       1.320899762458
   target nu stat err =       0.000545088800
   target dn stat err =       0.003062395331
      target stat err =       0.002641888842
              std dev =       0.670729373090
             le_variance =       0.449877891926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745387103201        initial  <--
     2.4414e+27     2.4414e+28             1.4807e-32        -0.745387103201
     9.7656e+27     9.7656e+28             3.7017e-33        -0.745387103201
     3.9062e+28     3.9062e+29             7.7929e-34        -0.745387103201

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9496
  </log>
  <optVariables href="FORM2.s041.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2197e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6097
    reference variance = 0.320785
====================================================
  Execution time = 4.4368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5747e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5199e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457573790851
                                         uncertainty =       0.012475108728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457573790851
                                         uncertainty =       0.012475108728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478260677
  error estimate for blocks of size 2^( 2) =       0.000501859320
  error estimate for blocks of size 2^( 3) =       0.000523703401
  error estimate for blocks of size 2^( 4) =       0.000539536645
  error estimate for blocks of size 2^( 5) =       0.000547575225
  error estimate for blocks of size 2^( 6) =       0.000551268221
  error estimate for blocks of size 2^( 7) =       0.000554620356

      target function =      -0.739014277764
              le_mean =     -22.661954552586
             les_mean =     514.021650464169
             stat err =       0.000548250112
             autocorr =       1.314099076041
   target nu stat err =       0.000548250112
   target dn stat err =       0.010043741356
      target stat err =       0.008293668424
              std dev =       0.676362735113
             le_variance =       0.457466549449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266195455259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739107274559       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739107274559       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739107274559       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739107274559       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+29, overlap shift 3.9062e+30 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739107274559       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739107274559       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.894561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9590e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7082
    reference variance = 0.287113
====================================================
  Execution time = 4.6018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4651e-01
  Total weights = 2.0000e+06
  Execution time = 3.6274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446117243141
                                         uncertainty =       0.002749211735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446117243141
                                         uncertainty =       0.002749211735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472499897
  error estimate for blocks of size 2^( 2) =       0.000496142011
  error estimate for blocks of size 2^( 3) =       0.000517591410
  error estimate for blocks of size 2^( 4) =       0.000533065129
  error estimate for blocks of size 2^( 5) =       0.000542261769
  error estimate for blocks of size 2^( 6) =       0.000545858591
  error estimate for blocks of size 2^( 7) =       0.000549114195

      target function =      -0.748236978990
              le_mean =     -22.661620518323
             les_mean =     513.995556597621
             stat err =       0.000542574921
             autocorr =       1.318608880526
   target nu stat err =       0.000542574921
   target dn stat err =       0.002728531051
      target stat err =       0.002381887728
              std dev =       0.668215761862
             le_variance =       0.446512304401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446117243141
                                         uncertainty =       0.002749211735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446117243141
                                         uncertainty =       0.002749211735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472499897
  error estimate for blocks of size 2^( 2) =       0.000496142011
  error estimate for blocks of size 2^( 3) =       0.000517591410
  error estimate for blocks of size 2^( 4) =       0.000533065129
  error estimate for blocks of size 2^( 5) =       0.000542261769
  error estimate for blocks of size 2^( 6) =       0.000545858591
  error estimate for blocks of size 2^( 7) =       0.000549114195

      target function =      -0.748236978990
              le_mean =     -22.661620518323
             les_mean =     513.995556597621
             stat err =       0.000542574921
             autocorr =       1.318608880526
   target nu stat err =       0.000542574921
   target dn stat err =       0.002728531051
      target stat err =       0.002381887728
              std dev =       0.668215761862
             le_variance =       0.446512304401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446117243141
                                         uncertainty =       0.002749211735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446117243141
                                         uncertainty =       0.002749211735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472499897
  error estimate for blocks of size 2^( 2) =       0.000496142011
  error estimate for blocks of size 2^( 3) =       0.000517591410
  error estimate for blocks of size 2^( 4) =       0.000533065129
  error estimate for blocks of size 2^( 5) =       0.000542261769
  error estimate for blocks of size 2^( 6) =       0.000545858591
  error estimate for blocks of size 2^( 7) =       0.000549114195

      target function =      -0.748236978990
              le_mean =     -22.661620518323
             les_mean =     513.995556597621
             stat err =       0.000542574921
             autocorr =       1.318608880526
   target nu stat err =       0.000542574921
   target dn stat err =       0.002728531051
      target stat err =       0.002381887728
              std dev =       0.668215761862
             le_variance =       0.446512304401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446117243141
                                         uncertainty =       0.002749211735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446117243141
                                         uncertainty =       0.002749211735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472499897
  error estimate for blocks of size 2^( 2) =       0.000496142011
  error estimate for blocks of size 2^( 3) =       0.000517591410
  error estimate for blocks of size 2^( 4) =       0.000533065129
  error estimate for blocks of size 2^( 5) =       0.000542261769
  error estimate for blocks of size 2^( 6) =       0.000545858591
  error estimate for blocks of size 2^( 7) =       0.000549114195

      target function =      -0.748236978990
              le_mean =     -22.661620518323
             les_mean =     513.995556597621
             stat err =       0.000542574921
             autocorr =       1.318608880526
   target nu stat err =       0.000542574921
   target dn stat err =       0.002728531051
      target stat err =       0.002381887728
              std dev =       0.668215761862
             le_variance =       0.446512304401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748236978990        initial  <--
     2.4414e+28     2.4414e+29             0.0000e+00        -0.748236978990
     9.7656e+28     9.7656e+29             0.0000e+00        -0.748236978990
     3.9062e+29     3.9062e+30             0.0000e+00        -0.748236978990

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.1912
  </log>
  <optVariables href="FORM2.s042.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2379e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6635
    reference variance = 0.343251
====================================================
  Execution time = 4.6055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5075e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5516e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450722799916
                                         uncertainty =       0.003322370481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450722799916
                                         uncertainty =       0.003322370481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474738872
  error estimate for blocks of size 2^( 2) =       0.000499072500
  error estimate for blocks of size 2^( 3) =       0.000520640386
  error estimate for blocks of size 2^( 4) =       0.000535955442
  error estimate for blocks of size 2^( 5) =       0.000544104990
  error estimate for blocks of size 2^( 6) =       0.000550646829
  error estimate for blocks of size 2^( 7) =       0.000554039121

      target function =      -0.744672860772
              le_mean =     -22.661522083107
             les_mean =     513.995336891839
             stat err =       0.000546186595
             autocorr =       1.323647936617
   target nu stat err =       0.000546186595
   target dn stat err =       0.003406444719
      target stat err =       0.002911423754
              std dev =       0.671382152033
             le_variance =       0.450753994069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266152208311e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+29, overlap shift 2.4414e+30 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744683245144       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744683245144       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+29, overlap shift 9.7656e+30 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744683245144       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744683245144       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+30, overlap shift 3.9062e+31 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744683245144       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744683245144       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.895616 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1578e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6679
    reference variance = 0.293401
====================================================
  Execution time = 4.4134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5053e-01
  Total weights = 2.0000e+06
  Execution time = 3.6441e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450502562075
                                         uncertainty =       0.002752198143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450502562075
                                         uncertainty =       0.002752198143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474621137
  error estimate for blocks of size 2^( 2) =       0.000498551074
  error estimate for blocks of size 2^( 3) =       0.000520707408
  error estimate for blocks of size 2^( 4) =       0.000536918520
  error estimate for blocks of size 2^( 5) =       0.000546724666
  error estimate for blocks of size 2^( 6) =       0.000551875645
  error estimate for blocks of size 2^( 7) =       0.000551658791

      target function =      -0.744848184673
              le_mean =     -22.662543607302
             les_mean =     514.041412975113
             stat err =       0.000546794405
             autocorr =       1.327253788377
   target nu stat err =       0.000546794405
   target dn stat err =       0.002992844385
      target stat err =       0.002579920770
              std dev =       0.671215649024
             le_variance =       0.450530447495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450502562075
                                         uncertainty =       0.002752198143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450502562075
                                         uncertainty =       0.002752198143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474621137
  error estimate for blocks of size 2^( 2) =       0.000498551074
  error estimate for blocks of size 2^( 3) =       0.000520707408
  error estimate for blocks of size 2^( 4) =       0.000536918520
  error estimate for blocks of size 2^( 5) =       0.000546724666
  error estimate for blocks of size 2^( 6) =       0.000551875645
  error estimate for blocks of size 2^( 7) =       0.000551658791

      target function =      -0.744848184673
              le_mean =     -22.662543607302
             les_mean =     514.041412975113
             stat err =       0.000546794405
             autocorr =       1.327253788377
   target nu stat err =       0.000546794405
   target dn stat err =       0.002992844385
      target stat err =       0.002579920770
              std dev =       0.671215649024
             le_variance =       0.450530447495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450502562075
                                         uncertainty =       0.002752198143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450502562075
                                         uncertainty =       0.002752198143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474621137
  error estimate for blocks of size 2^( 2) =       0.000498551074
  error estimate for blocks of size 2^( 3) =       0.000520707408
  error estimate for blocks of size 2^( 4) =       0.000536918520
  error estimate for blocks of size 2^( 5) =       0.000546724666
  error estimate for blocks of size 2^( 6) =       0.000551875645
  error estimate for blocks of size 2^( 7) =       0.000551658791

      target function =      -0.744848184673
              le_mean =     -22.662543607302
             les_mean =     514.041412975113
             stat err =       0.000546794405
             autocorr =       1.327253788377
   target nu stat err =       0.000546794405
   target dn stat err =       0.002992844385
      target stat err =       0.002579920770
              std dev =       0.671215649024
             le_variance =       0.450530447495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450502562075
                                         uncertainty =       0.002752198143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450502562075
                                         uncertainty =       0.002752198143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474621137
  error estimate for blocks of size 2^( 2) =       0.000498551074
  error estimate for blocks of size 2^( 3) =       0.000520707408
  error estimate for blocks of size 2^( 4) =       0.000536918520
  error estimate for blocks of size 2^( 5) =       0.000546724666
  error estimate for blocks of size 2^( 6) =       0.000551875645
  error estimate for blocks of size 2^( 7) =       0.000551658791

      target function =      -0.744848184673
              le_mean =     -22.662543607302
             les_mean =     514.041412975113
             stat err =       0.000546794405
             autocorr =       1.327253788377
   target nu stat err =       0.000546794405
   target dn stat err =       0.002992844385
      target stat err =       0.002579920770
              std dev =       0.671215649024
             le_variance =       0.450530447495


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744848184673        initial  <--
     2.4414e+29     2.4414e+30             0.0000e+00        -0.744848184673
     9.7656e+29     9.7656e+30             0.0000e+00        -0.744848184673
     3.9062e+30     3.9062e+31             0.0000e+00        -0.744848184673

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.4021
  </log>
  <optVariables href="FORM2.s043.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2399e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.6992
    reference variance = 0.481331
====================================================
  Execution time = 4.4357e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5224e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457113007461
                                         uncertainty =       0.005594983966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457113007461
                                         uncertainty =       0.005594983966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478051687
  error estimate for blocks of size 2^( 2) =       0.000501448606
  error estimate for blocks of size 2^( 3) =       0.000522784268
  error estimate for blocks of size 2^( 4) =       0.000538219708
  error estimate for blocks of size 2^( 5) =       0.000547122425
  error estimate for blocks of size 2^( 6) =       0.000552713302
  error estimate for blocks of size 2^( 7) =       0.000555701637

      target function =      -0.739381029267
              le_mean =     -22.663106664942
             les_mean =     514.073470309381
             stat err =       0.000548439268
             autocorr =       1.316156018952
   target nu stat err =       0.000548439268
   target dn stat err =       0.005721512403
      target stat err =       0.004763747637
              std dev =       0.676067179632
             le_variance =       0.457066831376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266310666494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+30, overlap shift 2.4414e+31 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739410954995       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739410954995       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+30, overlap shift 9.7656e+31 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739410954995       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739410954995       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+31, overlap shift 3.9062e+32 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739410954995       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739410954995       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.896703 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9588e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.6465
    reference variance = 0.386145
====================================================
  Execution time = 4.4114e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4816e-01
  Total weights = 2.0000e+06
  Execution time = 3.6341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448126033331
                                         uncertainty =       0.003276461747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448126033331
                                         uncertainty =       0.003276461747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473372880
  error estimate for blocks of size 2^( 2) =       0.000497089272
  error estimate for blocks of size 2^( 3) =       0.000518562129
  error estimate for blocks of size 2^( 4) =       0.000534762674
  error estimate for blocks of size 2^( 5) =       0.000544133638
  error estimate for blocks of size 2^( 6) =       0.000549639046
  error estimate for blocks of size 2^( 7) =       0.000549226313

      target function =      -0.746835330236
              le_mean =     -22.662426412400
             les_mean =     514.033734440296
             stat err =       0.000544440418
             autocorr =       1.322799343760
   target nu stat err =       0.000544440418
   target dn stat err =       0.003152624559
      target stat err =       0.002723056406
              std dev =       0.669450346876
             le_variance =       0.448163766933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448126033331
                                         uncertainty =       0.003276461747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448126033331
                                         uncertainty =       0.003276461747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473372880
  error estimate for blocks of size 2^( 2) =       0.000497089272
  error estimate for blocks of size 2^( 3) =       0.000518562129
  error estimate for blocks of size 2^( 4) =       0.000534762674
  error estimate for blocks of size 2^( 5) =       0.000544133638
  error estimate for blocks of size 2^( 6) =       0.000549639046
  error estimate for blocks of size 2^( 7) =       0.000549226313

      target function =      -0.746835330236
              le_mean =     -22.662426412400
             les_mean =     514.033734440296
             stat err =       0.000544440418
             autocorr =       1.322799343765
   target nu stat err =       0.000544440418
   target dn stat err =       0.003152624559
      target stat err =       0.002723056406
              std dev =       0.669450346876
             le_variance =       0.448163766933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448126033331
                                         uncertainty =       0.003276461747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448126033331
                                         uncertainty =       0.003276461747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473372880
  error estimate for blocks of size 2^( 2) =       0.000497089272
  error estimate for blocks of size 2^( 3) =       0.000518562129
  error estimate for blocks of size 2^( 4) =       0.000534762674
  error estimate for blocks of size 2^( 5) =       0.000544133638
  error estimate for blocks of size 2^( 6) =       0.000549639046
  error estimate for blocks of size 2^( 7) =       0.000549226313

      target function =      -0.746835330236
              le_mean =     -22.662426412400
             les_mean =     514.033734440296
             stat err =       0.000544440418
             autocorr =       1.322799343765
   target nu stat err =       0.000544440418
   target dn stat err =       0.003152624559
      target stat err =       0.002723056406
              std dev =       0.669450346876
             le_variance =       0.448163766933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448126033331
                                         uncertainty =       0.003276461747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448126033331
                                         uncertainty =       0.003276461747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473372880
  error estimate for blocks of size 2^( 2) =       0.000497089272
  error estimate for blocks of size 2^( 3) =       0.000518562129
  error estimate for blocks of size 2^( 4) =       0.000534762674
  error estimate for blocks of size 2^( 5) =       0.000544133638
  error estimate for blocks of size 2^( 6) =       0.000549639046
  error estimate for blocks of size 2^( 7) =       0.000549226313

      target function =      -0.746835330236
              le_mean =     -22.662426412400
             les_mean =     514.033734440296
             stat err =       0.000544440418
             autocorr =       1.322799343765
   target nu stat err =       0.000544440418
   target dn stat err =       0.003152624559
      target stat err =       0.002723056406
              std dev =       0.669450346876
             le_variance =       0.448163766933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746835330236        initial  <--
     2.4414e+30     2.4414e+31             0.0000e+00        -0.746835330236
     9.7656e+30     9.7656e+31             0.0000e+00        -0.746835330236
     3.9062e+31     3.9062e+32             0.0000e+00        -0.746835330236

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.3288
  </log>
  <optVariables href="FORM2.s044.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2192e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6359
    reference variance = 0.348239
====================================================
  Execution time = 4.6277e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6847e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5204e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468582029222
                                         uncertainty =       0.009859136724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468582029222
                                         uncertainty =       0.009859136724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483979219
  error estimate for blocks of size 2^( 2) =       0.000506950025
  error estimate for blocks of size 2^( 3) =       0.000528198956
  error estimate for blocks of size 2^( 4) =       0.000543589365
  error estimate for blocks of size 2^( 5) =       0.000553455275
  error estimate for blocks of size 2^( 6) =       0.000557923573
  error estimate for blocks of size 2^( 7) =       0.000558945567

      target function =      -0.730044503269
              le_mean =     -22.662420290351
             les_mean =     514.053764951473
             stat err =       0.000553478445
             autocorr =       1.307820062199
   target nu stat err =       0.000553478445
   target dn stat err =       0.010296350444
      target stat err =       0.008302815337
              std dev =       0.684449975659
             le_variance =       0.468471769179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266242029035e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+31, overlap shift 2.4414e+32 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.730136722662       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.730136722662       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+31, overlap shift 9.7656e+32 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.730136722662       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.730136722662       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+32, overlap shift 3.9062e+33 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.730136722662       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.730136722662       residual = 7.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.897791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1492e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.658
    reference variance = 0.192054
====================================================
  Execution time = 4.5953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5203e-01
  Total weights = 2.0000e+06
  Execution time = 3.6625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452059640648
                                         uncertainty =       0.003256987974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452059640648
                                         uncertainty =       0.003256987974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475408441
  error estimate for blocks of size 2^( 2) =       0.000499133449
  error estimate for blocks of size 2^( 3) =       0.000520627806
  error estimate for blocks of size 2^( 4) =       0.000536940242
  error estimate for blocks of size 2^( 5) =       0.000545089481
  error estimate for blocks of size 2^( 6) =       0.000548600253
  error estimate for blocks of size 2^( 7) =       0.000552037381

      target function =      -0.743591379901
              le_mean =     -22.662884156017
             les_mean =     514.058344414750
             stat err =       0.000545666839
             autocorr =       1.317411185460
   target nu stat err =       0.000545666839
   target dn stat err =       0.003158770365
      target stat err =       0.002707226137
              std dev =       0.672329065055
             le_variance =       0.452026371718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452059640648
                                         uncertainty =       0.003256987974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452059640648
                                         uncertainty =       0.003256987974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475408441
  error estimate for blocks of size 2^( 2) =       0.000499133449
  error estimate for blocks of size 2^( 3) =       0.000520627806
  error estimate for blocks of size 2^( 4) =       0.000536940242
  error estimate for blocks of size 2^( 5) =       0.000545089481
  error estimate for blocks of size 2^( 6) =       0.000548600253
  error estimate for blocks of size 2^( 7) =       0.000552037381

      target function =      -0.743591379901
              le_mean =     -22.662884156017
             les_mean =     514.058344414750
             stat err =       0.000545666839
             autocorr =       1.317411185460
   target nu stat err =       0.000545666839
   target dn stat err =       0.003158770365
      target stat err =       0.002707226137
              std dev =       0.672329065055
             le_variance =       0.452026371718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452059640648
                                         uncertainty =       0.003256987974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452059640648
                                         uncertainty =       0.003256987974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475408441
  error estimate for blocks of size 2^( 2) =       0.000499133449
  error estimate for blocks of size 2^( 3) =       0.000520627806
  error estimate for blocks of size 2^( 4) =       0.000536940242
  error estimate for blocks of size 2^( 5) =       0.000545089481
  error estimate for blocks of size 2^( 6) =       0.000548600253
  error estimate for blocks of size 2^( 7) =       0.000552037381

      target function =      -0.743591379901
              le_mean =     -22.662884156017
             les_mean =     514.058344414750
             stat err =       0.000545666839
             autocorr =       1.317411185460
   target nu stat err =       0.000545666839
   target dn stat err =       0.003158770365
      target stat err =       0.002707226137
              std dev =       0.672329065055
             le_variance =       0.452026371718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452059640648
                                         uncertainty =       0.003256987974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452059640648
                                         uncertainty =       0.003256987974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475408441
  error estimate for blocks of size 2^( 2) =       0.000499133449
  error estimate for blocks of size 2^( 3) =       0.000520627806
  error estimate for blocks of size 2^( 4) =       0.000536940242
  error estimate for blocks of size 2^( 5) =       0.000545089481
  error estimate for blocks of size 2^( 6) =       0.000548600253
  error estimate for blocks of size 2^( 7) =       0.000552037381

      target function =      -0.743591379901
              le_mean =     -22.662884156017
             les_mean =     514.058344414750
             stat err =       0.000545666839
             autocorr =       1.317411185460
   target nu stat err =       0.000545666839
   target dn stat err =       0.003158770365
      target stat err =       0.002707226137
              std dev =       0.672329065055
             le_variance =       0.452026371718


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743591379901        initial  <--
     2.4414e+31     2.4414e+32             0.0000e+00        -0.743591379901
     9.7656e+31     9.7656e+32             0.0000e+00        -0.743591379901
     3.9062e+32     3.9062e+33             0.0000e+00        -0.743591379901

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2495
  </log>
  <optVariables href="FORM2.s045.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2575e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.5838
    reference variance = 0.324734
====================================================
  Execution time = 4.4337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.9148e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5101e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491455462132
                                         uncertainty =       0.035622512989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491455462132
                                         uncertainty =       0.035622512989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495719891
  error estimate for blocks of size 2^( 2) =       0.000518471759
  error estimate for blocks of size 2^( 3) =       0.000539103560
  error estimate for blocks of size 2^( 4) =       0.000553201720
  error estimate for blocks of size 2^( 5) =       0.000562691601
  error estimate for blocks of size 2^( 6) =       0.000567703117
  error estimate for blocks of size 2^( 7) =       0.000569161458

      target function =      -0.711021244245
              le_mean =     -22.662569580377
             les_mean =     514.083536159606
             stat err =       0.000563189474
             autocorr =       1.290732862977
   target nu stat err =       0.000563189474
   target dn stat err =       0.036065379311
      target stat err =       0.027562596824
              std dev =       0.701053792456
             le_variance =       0.491476419916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266256958038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+32, overlap shift 2.4414e+33 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712082172505       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712082172505       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712082172505       residual = 8.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712082172504       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712082172505       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711170616984       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.871482638489       residual = 1.25e+03           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+32 is 3.088514e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+32, overlap shift 9.7656e+33 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712082172505       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712082172505       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712082172505       residual = 8.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712082172505       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712082172496       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.712081427791       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       4.441195011139       residual = 1.32e+04           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+32 is 7.721286e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+33, overlap shift 3.9062e+34 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.712082172505       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.712082172505       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.712082172505       residual = 8.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.712082172504       residual = 4.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.712082172505       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.711170616984       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+33 is 1.930322e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.900290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9447e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6413
    reference variance = 0.640224
====================================================
  Execution time = 4.4346e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.6000e-01
  Total weights = 2.0000e+06
  Execution time = 3.6475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459985366908
                                         uncertainty =       0.010309563633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459985366908
                                         uncertainty =       0.010309563633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479582175
  error estimate for blocks of size 2^( 2) =       0.000503327919
  error estimate for blocks of size 2^( 3) =       0.000525086636
  error estimate for blocks of size 2^( 4) =       0.000540527457
  error estimate for blocks of size 2^( 5) =       0.000548941967
  error estimate for blocks of size 2^( 6) =       0.000553973586
  error estimate for blocks of size 2^( 7) =       0.000559351886

      target function =      -0.736914966228
              le_mean =     -22.662576708205
             les_mean =     514.052380950158
             stat err =       0.000550698724
             autocorr =       1.318566612988
   target nu stat err =       0.000550698724
   target dn stat err =       0.010406726586
      target stat err =       0.008551455970
              std dev =       0.678231615940
             le_variance =       0.459998124860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459985366908
                                         uncertainty =       0.010309563633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459985366908
                                         uncertainty =       0.010309563633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479582175
  error estimate for blocks of size 2^( 2) =       0.000503327919
  error estimate for blocks of size 2^( 3) =       0.000525086636
  error estimate for blocks of size 2^( 4) =       0.000540527457
  error estimate for blocks of size 2^( 5) =       0.000548941967
  error estimate for blocks of size 2^( 6) =       0.000553973586
  error estimate for blocks of size 2^( 7) =       0.000559351886

      target function =      -0.736914966228
              le_mean =     -22.662576708205
             les_mean =     514.052380950158
             stat err =       0.000550698724
             autocorr =       1.318566612990
   target nu stat err =       0.000550698724
   target dn stat err =       0.010406726586
      target stat err =       0.008551455970
              std dev =       0.678231615940
             le_variance =       0.459998124860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459985366908
                                         uncertainty =       0.010309563633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459985366908
                                         uncertainty =       0.010309563633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479582175
  error estimate for blocks of size 2^( 2) =       0.000503327919
  error estimate for blocks of size 2^( 3) =       0.000525086636
  error estimate for blocks of size 2^( 4) =       0.000540527457
  error estimate for blocks of size 2^( 5) =       0.000548941967
  error estimate for blocks of size 2^( 6) =       0.000553973586
  error estimate for blocks of size 2^( 7) =       0.000559351886

      target function =      -0.736914966228
              le_mean =     -22.662576708205
             les_mean =     514.052380950158
             stat err =       0.000550698724
             autocorr =       1.318566612990
   target nu stat err =       0.000550698724
   target dn stat err =       0.010406726586
      target stat err =       0.008551455970
              std dev =       0.678231615940
             le_variance =       0.459998124860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459985366908
                                         uncertainty =       0.010309563633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.459985366908
                                         uncertainty =       0.010309563633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000479582175
  error estimate for blocks of size 2^( 2) =       0.000503327919
  error estimate for blocks of size 2^( 3) =       0.000525086636
  error estimate for blocks of size 2^( 4) =       0.000540527457
  error estimate for blocks of size 2^( 5) =       0.000548941967
  error estimate for blocks of size 2^( 6) =       0.000553973586
  error estimate for blocks of size 2^( 7) =       0.000559351886

      target function =      -0.736914966228
              le_mean =     -22.662576708205
             les_mean =     514.052380950158
             stat err =       0.000550698724
             autocorr =       1.318566612990
   target nu stat err =       0.000550698724
   target dn stat err =       0.010406726586
      target stat err =       0.008551455970
              std dev =       0.678231615940
             le_variance =       0.459998124860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736914966228        initial  <--
     2.4414e+32     2.4414e+33             3.0885e-36        -0.736914966228
     9.7656e+32     9.7656e+33             7.7213e-37        -0.736914966228
     3.9062e+33     3.9062e+34             1.9303e-37        -0.736914966228

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6310
  </log>
  <optVariables href="FORM2.s046.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2208e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6487
    reference variance = 0.359301
====================================================
  Execution time = 4.4933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5456e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452548314557
                                         uncertainty =       0.003881782170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.452548314557
                                         uncertainty =       0.003881782170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475703413
  error estimate for blocks of size 2^( 2) =       0.000499303739
  error estimate for blocks of size 2^( 3) =       0.000521094119
  error estimate for blocks of size 2^( 4) =       0.000535784647
  error estimate for blocks of size 2^( 5) =       0.000544295859
  error estimate for blocks of size 2^( 6) =       0.000549962377
  error estimate for blocks of size 2^( 7) =       0.000551952634

      target function =      -0.743125812016
              le_mean =     -22.662601296952
             les_mean =     514.046084792828
             stat err =       0.000545498879
             autocorr =       1.314968018521
   target nu stat err =       0.000545498879
   target dn stat err =       0.003543526204
      target stat err =       0.003015949598
              std dev =       0.672746218520
             le_variance =       0.452587474533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266260129695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+33, overlap shift 2.4414e+34 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743137085449       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743137085449       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+33, overlap shift 9.7656e+34 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743137085449       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743137085449       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+34, overlap shift 3.9062e+35 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743137085449       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743137085449       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.901331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0397e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6102
    reference variance = 0.48983
====================================================
  Execution time = 4.6138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5052e-01
  Total weights = 2.0000e+06
  Execution time = 3.6535e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450469521078
                                         uncertainty =       0.003743270851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450469521078
                                         uncertainty =       0.003743270851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474614105
  error estimate for blocks of size 2^( 2) =       0.000498505944
  error estimate for blocks of size 2^( 3) =       0.000520040955
  error estimate for blocks of size 2^( 4) =       0.000536258875
  error estimate for blocks of size 2^( 5) =       0.000544660758
  error estimate for blocks of size 2^( 6) =       0.000550853245
  error estimate for blocks of size 2^( 7) =       0.000553841138

      target function =      -0.744855916515
              le_mean =     -22.662445670994
             les_mean =     514.036960662177
             stat err =       0.000546403504
             autocorr =       1.325396044075
   target nu stat err =       0.000546403504
   target dn stat err =       0.003781643287
      target stat err =       0.003224665954
              std dev =       0.671205703691
             le_variance =       0.450517096668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450469521078
                                         uncertainty =       0.003743270851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450469521078
                                         uncertainty =       0.003743270851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474614105
  error estimate for blocks of size 2^( 2) =       0.000498505944
  error estimate for blocks of size 2^( 3) =       0.000520040955
  error estimate for blocks of size 2^( 4) =       0.000536258875
  error estimate for blocks of size 2^( 5) =       0.000544660758
  error estimate for blocks of size 2^( 6) =       0.000550853245
  error estimate for blocks of size 2^( 7) =       0.000553841138

      target function =      -0.744855916515
              le_mean =     -22.662445670994
             les_mean =     514.036960662177
             stat err =       0.000546403504
             autocorr =       1.325396044077
   target nu stat err =       0.000546403504
   target dn stat err =       0.003781643287
      target stat err =       0.003224665954
              std dev =       0.671205703691
             le_variance =       0.450517096668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450469521078
                                         uncertainty =       0.003743270851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450469521078
                                         uncertainty =       0.003743270851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474614105
  error estimate for blocks of size 2^( 2) =       0.000498505944
  error estimate for blocks of size 2^( 3) =       0.000520040955
  error estimate for blocks of size 2^( 4) =       0.000536258875
  error estimate for blocks of size 2^( 5) =       0.000544660758
  error estimate for blocks of size 2^( 6) =       0.000550853245
  error estimate for blocks of size 2^( 7) =       0.000553841138

      target function =      -0.744855916515
              le_mean =     -22.662445670994
             les_mean =     514.036960662177
             stat err =       0.000546403504
             autocorr =       1.325396044077
   target nu stat err =       0.000546403504
   target dn stat err =       0.003781643287
      target stat err =       0.003224665954
              std dev =       0.671205703691
             le_variance =       0.450517096668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450469521078
                                         uncertainty =       0.003743270851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450469521078
                                         uncertainty =       0.003743270851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474614105
  error estimate for blocks of size 2^( 2) =       0.000498505944
  error estimate for blocks of size 2^( 3) =       0.000520040955
  error estimate for blocks of size 2^( 4) =       0.000536258875
  error estimate for blocks of size 2^( 5) =       0.000544660758
  error estimate for blocks of size 2^( 6) =       0.000550853245
  error estimate for blocks of size 2^( 7) =       0.000553841138

      target function =      -0.744855916515
              le_mean =     -22.662445670994
             les_mean =     514.036960662177
             stat err =       0.000546403504
             autocorr =       1.325396044077
   target nu stat err =       0.000546403504
   target dn stat err =       0.003781643287
      target stat err =       0.003224665954
              std dev =       0.671205703691
             le_variance =       0.450517096668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744855916515        initial  <--
     2.4414e+33     2.4414e+34             0.0000e+00        -0.744855916515
     9.7656e+33     9.7656e+34             0.0000e+00        -0.744855916515
     3.9062e+34     3.9062e+35             0.0000e+00        -0.744855916515

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.4235
  </log>
  <optVariables href="FORM2.s047.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2483e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6244
    reference variance = 0.471108
====================================================
  Execution time = 4.6098e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4938e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5247e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449373329534
                                         uncertainty =       0.003171663517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449373329534
                                         uncertainty =       0.003171663517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474016769
  error estimate for blocks of size 2^( 2) =       0.000497422071
  error estimate for blocks of size 2^( 3) =       0.000519012323
  error estimate for blocks of size 2^( 4) =       0.000534940726
  error estimate for blocks of size 2^( 5) =       0.000542922341
  error estimate for blocks of size 2^( 6) =       0.000548437683
  error estimate for blocks of size 2^( 7) =       0.000552874020

      target function =      -0.745806452439
              le_mean =     -22.662577661806
             les_mean =     514.041809847310
             stat err =       0.000544793692
             autocorr =       1.320920650777
   target nu stat err =       0.000544793692
   target dn stat err =       0.003435628883
      target stat err =       0.002948378839
              std dev =       0.670360943533
             le_variance =       0.449383794615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266257766181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+34, overlap shift 2.4414e+35 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745817076055       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745817076055       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+34, overlap shift 9.7656e+35 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745817076055       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745817076055       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+35, overlap shift 3.9062e+36 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745817076055       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745817076055       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.902448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1353e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8418
    reference variance = 0.650599
====================================================
  Execution time = 4.4436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4915e-01
  Total weights = 2.0000e+06
  Execution time = 3.6489e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449131719195
                                         uncertainty =       0.003428907465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449131719195
                                         uncertainty =       0.003428907465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473894478
  error estimate for blocks of size 2^( 2) =       0.000497869915
  error estimate for blocks of size 2^( 3) =       0.000519740879
  error estimate for blocks of size 2^( 4) =       0.000535213916
  error estimate for blocks of size 2^( 5) =       0.000543296321
  error estimate for blocks of size 2^( 6) =       0.000547039675
  error estimate for blocks of size 2^( 7) =       0.000547039937

      target function =      -0.746005276167
              le_mean =     -22.662459295432
             les_mean =     514.036213044361
             stat err =       0.000543147462
             autocorr =       1.313627446487
   target nu stat err =       0.000543147462
   target dn stat err =       0.002975872511
      target stat err =       0.002572566555
              std dev =       0.670187997374
             le_variance =       0.449151951825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449131719195
                                         uncertainty =       0.003428907465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449131719195
                                         uncertainty =       0.003428907465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473894478
  error estimate for blocks of size 2^( 2) =       0.000497869915
  error estimate for blocks of size 2^( 3) =       0.000519740879
  error estimate for blocks of size 2^( 4) =       0.000535213916
  error estimate for blocks of size 2^( 5) =       0.000543296321
  error estimate for blocks of size 2^( 6) =       0.000547039675
  error estimate for blocks of size 2^( 7) =       0.000547039937

      target function =      -0.746005276167
              le_mean =     -22.662459295432
             les_mean =     514.036213044361
             stat err =       0.000543147462
             autocorr =       1.313627446479
   target nu stat err =       0.000543147462
   target dn stat err =       0.002975872511
      target stat err =       0.002572566555
              std dev =       0.670187997374
             le_variance =       0.449151951825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449131719195
                                         uncertainty =       0.003428907465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449131719195
                                         uncertainty =       0.003428907465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473894478
  error estimate for blocks of size 2^( 2) =       0.000497869915
  error estimate for blocks of size 2^( 3) =       0.000519740879
  error estimate for blocks of size 2^( 4) =       0.000535213916
  error estimate for blocks of size 2^( 5) =       0.000543296321
  error estimate for blocks of size 2^( 6) =       0.000547039675
  error estimate for blocks of size 2^( 7) =       0.000547039937

      target function =      -0.746005276167
              le_mean =     -22.662459295432
             les_mean =     514.036213044361
             stat err =       0.000543147462
             autocorr =       1.313627446479
   target nu stat err =       0.000543147462
   target dn stat err =       0.002975872511
      target stat err =       0.002572566555
              std dev =       0.670187997374
             le_variance =       0.449151951825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449131719195
                                         uncertainty =       0.003428907465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449131719195
                                         uncertainty =       0.003428907465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473894478
  error estimate for blocks of size 2^( 2) =       0.000497869915
  error estimate for blocks of size 2^( 3) =       0.000519740879
  error estimate for blocks of size 2^( 4) =       0.000535213916
  error estimate for blocks of size 2^( 5) =       0.000543296321
  error estimate for blocks of size 2^( 6) =       0.000547039675
  error estimate for blocks of size 2^( 7) =       0.000547039937

      target function =      -0.746005276167
              le_mean =     -22.662459295432
             les_mean =     514.036213044361
             stat err =       0.000543147462
             autocorr =       1.313627446479
   target nu stat err =       0.000543147462
   target dn stat err =       0.002975872511
      target stat err =       0.002572566555
              std dev =       0.670187997374
             le_variance =       0.449151951825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746005276167        initial  <--
     2.4414e+34     2.4414e+35             0.0000e+00        -0.746005276167
     9.7656e+34     9.7656e+35             0.0000e+00        -0.746005276167
     3.9062e+35     3.9062e+36             0.0000e+00        -0.746005276167

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.6932
  </log>
  <optVariables href="FORM2.s048.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2405e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6279
    reference variance = 0.307601
====================================================
  Execution time = 4.4245e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5147e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456777192383
                                         uncertainty =       0.004802250543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456777192383
                                         uncertainty =       0.004802250543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477836572
  error estimate for blocks of size 2^( 2) =       0.000501680497
  error estimate for blocks of size 2^( 3) =       0.000523074369
  error estimate for blocks of size 2^( 4) =       0.000538140021
  error estimate for blocks of size 2^( 5) =       0.000547006498
  error estimate for blocks of size 2^( 6) =       0.000551338700
  error estimate for blocks of size 2^( 7) =       0.000553907556

      target function =      -0.739746278915
              le_mean =     -22.662227672556
             les_mean =     514.033218433617
             stat err =       0.000547598194
             autocorr =       1.313303923476
   target nu stat err =       0.000547598194
   target dn stat err =       0.005170523388
      target stat err =       0.004311298900
              std dev =       0.675762960811
             le_variance =       0.456655579204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266222767256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+35, overlap shift 2.4414e+36 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739770058696       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739770058696       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739770058696       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739770058696       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+35 is 3.476977e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+35, overlap shift 9.7656e+36 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739770058696       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739770058696       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739770058696       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739770174026       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750000000000       residual = 2.02e+08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750000000000       residual = 2.74e+08           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+35 is 5.719121e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+36, overlap shift 3.9062e+37 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739770058696       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739770058696       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739770058696       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739769935608       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739770058696       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739769948313       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+36 is 2.776328e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.904519 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9400e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.7196
    reference variance = 0.691439
====================================================
  Execution time = 4.3759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5673e-01
  Total weights = 2.0000e+06
  Execution time = 3.6359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456808456786
                                         uncertainty =       0.004692113861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456808456786
                                         uncertainty =       0.004692113861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477876497
  error estimate for blocks of size 2^( 2) =       0.000501415149
  error estimate for blocks of size 2^( 3) =       0.000523168750
  error estimate for blocks of size 2^( 4) =       0.000537629027
  error estimate for blocks of size 2^( 5) =       0.000547063982
  error estimate for blocks of size 2^( 6) =       0.000552511833
  error estimate for blocks of size 2^( 7) =       0.000556864500

      target function =      -0.739697607598
              le_mean =     -22.661646926258
             les_mean =     514.006973074479
             stat err =       0.000548517335
             autocorr =       1.317496203757
   target nu stat err =       0.000548517335
   target dn stat err =       0.004883823578
      target stat err =       0.004073224911
              std dev =       0.675819422973
             le_variance =       0.456731892467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456808456786
                                         uncertainty =       0.004692113861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456808456786
                                         uncertainty =       0.004692113861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477876497
  error estimate for blocks of size 2^( 2) =       0.000501415149
  error estimate for blocks of size 2^( 3) =       0.000523168750
  error estimate for blocks of size 2^( 4) =       0.000537629027
  error estimate for blocks of size 2^( 5) =       0.000547063982
  error estimate for blocks of size 2^( 6) =       0.000552511833
  error estimate for blocks of size 2^( 7) =       0.000556864500

      target function =      -0.739697607598
              le_mean =     -22.661646926258
             les_mean =     514.006973074479
             stat err =       0.000548517335
             autocorr =       1.317496203757
   target nu stat err =       0.000548517335
   target dn stat err =       0.004883823578
      target stat err =       0.004073224911
              std dev =       0.675819422973
             le_variance =       0.456731892467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456808456786
                                         uncertainty =       0.004692113861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456808456786
                                         uncertainty =       0.004692113861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477876497
  error estimate for blocks of size 2^( 2) =       0.000501415149
  error estimate for blocks of size 2^( 3) =       0.000523168750
  error estimate for blocks of size 2^( 4) =       0.000537629027
  error estimate for blocks of size 2^( 5) =       0.000547063982
  error estimate for blocks of size 2^( 6) =       0.000552511833
  error estimate for blocks of size 2^( 7) =       0.000556864500

      target function =      -0.739697607598
              le_mean =     -22.661646926258
             les_mean =     514.006973074479
             stat err =       0.000548517335
             autocorr =       1.317496203757
   target nu stat err =       0.000548517335
   target dn stat err =       0.004883823578
      target stat err =       0.004073224911
              std dev =       0.675819422973
             le_variance =       0.456731892467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456808456786
                                         uncertainty =       0.004692113861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456808456786
                                         uncertainty =       0.004692113861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477876497
  error estimate for blocks of size 2^( 2) =       0.000501415149
  error estimate for blocks of size 2^( 3) =       0.000523168750
  error estimate for blocks of size 2^( 4) =       0.000537629027
  error estimate for blocks of size 2^( 5) =       0.000547063982
  error estimate for blocks of size 2^( 6) =       0.000552511833
  error estimate for blocks of size 2^( 7) =       0.000556864500

      target function =      -0.739697607598
              le_mean =     -22.661646926258
             les_mean =     514.006973074479
             stat err =       0.000548517335
             autocorr =       1.317496203757
   target nu stat err =       0.000548517335
   target dn stat err =       0.004883823578
      target stat err =       0.004073224911
              std dev =       0.675819422973
             le_variance =       0.456731892467


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739697607598        initial  <--
     2.4414e+35     2.4414e+36             3.4770e-40        -0.739697607598
     9.7656e+35     9.7656e+36             5.7191e-41        -0.739697607598
     3.9062e+36     3.9062e+37             2.7763e-41        -0.739697607598

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9782
  </log>
  <optVariables href="FORM2.s049.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2138e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.6525
    reference variance = 0.326365
====================================================
  Execution time = 4.6052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5105e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5634e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451082626488
                                         uncertainty =       0.002486465201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451082626488
                                         uncertainty =       0.002486465201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474894986
  error estimate for blocks of size 2^( 2) =       0.000498855760
  error estimate for blocks of size 2^( 3) =       0.000520897214
  error estimate for blocks of size 2^( 4) =       0.000535999439
  error estimate for blocks of size 2^( 5) =       0.000545016136
  error estimate for blocks of size 2^( 6) =       0.000550418226
  error estimate for blocks of size 2^( 7) =       0.000554698402

      target function =      -0.744428524380
              le_mean =     -22.661583973017
             les_mean =     513.998438435468
             stat err =       0.000546533050
             autocorr =       1.324456479100
   target nu stat err =       0.000546533050
   target dn stat err =       0.002689116318
      target stat err =       0.002327751355
              std dev =       0.671602929494
             le_variance =       0.451050494905


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266158397302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+36, overlap shift 2.4414e+37 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744434763268       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744434763268       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+36, overlap shift 9.7656e+37 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744434763268       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744434763268       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+37, overlap shift 3.9062e+38 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744434763268       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744434763268       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.905618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1704e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.67
    reference variance = 0.447773
====================================================
  Execution time = 4.4702e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5509e-01
  Total weights = 2.0000e+06
  Execution time = 3.6365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455137783601
                                         uncertainty =       0.006640425108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455137783601
                                         uncertainty =       0.006640425108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477016504
  error estimate for blocks of size 2^( 2) =       0.000500783952
  error estimate for blocks of size 2^( 3) =       0.000522258195
  error estimate for blocks of size 2^( 4) =       0.000537951848
  error estimate for blocks of size 2^( 5) =       0.000545545999
  error estimate for blocks of size 2^( 6) =       0.000549302111
  error estimate for blocks of size 2^( 7) =       0.000550903821

      target function =      -0.741039389566
              le_mean =     -22.661637217166
             les_mean =     514.004890624407
             stat err =       0.000545925945
             autocorr =       1.309786948781
   target nu stat err =       0.000545925945
   target dn stat err =       0.006341852421
      target stat err =       0.005283632062
              std dev =       0.674603208922
             le_variance =       0.455089489489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455137783601
                                         uncertainty =       0.006640425108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455137783601
                                         uncertainty =       0.006640425108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477016504
  error estimate for blocks of size 2^( 2) =       0.000500783952
  error estimate for blocks of size 2^( 3) =       0.000522258195
  error estimate for blocks of size 2^( 4) =       0.000537951848
  error estimate for blocks of size 2^( 5) =       0.000545545999
  error estimate for blocks of size 2^( 6) =       0.000549302111
  error estimate for blocks of size 2^( 7) =       0.000550903821

      target function =      -0.741039389566
              le_mean =     -22.661637217166
             les_mean =     514.004890624407
             stat err =       0.000545925945
             autocorr =       1.309786948781
   target nu stat err =       0.000545925945
   target dn stat err =       0.006341852421
      target stat err =       0.005283632062
              std dev =       0.674603208922
             le_variance =       0.455089489489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455137783601
                                         uncertainty =       0.006640425108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455137783601
                                         uncertainty =       0.006640425108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477016504
  error estimate for blocks of size 2^( 2) =       0.000500783952
  error estimate for blocks of size 2^( 3) =       0.000522258195
  error estimate for blocks of size 2^( 4) =       0.000537951848
  error estimate for blocks of size 2^( 5) =       0.000545545999
  error estimate for blocks of size 2^( 6) =       0.000549302111
  error estimate for blocks of size 2^( 7) =       0.000550903821

      target function =      -0.741039389566
              le_mean =     -22.661637217166
             les_mean =     514.004890624407
             stat err =       0.000545925945
             autocorr =       1.309786948781
   target nu stat err =       0.000545925945
   target dn stat err =       0.006341852421
      target stat err =       0.005283632062
              std dev =       0.674603208922
             le_variance =       0.455089489489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455137783601
                                         uncertainty =       0.006640425108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455137783601
                                         uncertainty =       0.006640425108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477016504
  error estimate for blocks of size 2^( 2) =       0.000500783952
  error estimate for blocks of size 2^( 3) =       0.000522258195
  error estimate for blocks of size 2^( 4) =       0.000537951848
  error estimate for blocks of size 2^( 5) =       0.000545545999
  error estimate for blocks of size 2^( 6) =       0.000549302111
  error estimate for blocks of size 2^( 7) =       0.000550903821

      target function =      -0.741039389566
              le_mean =     -22.661637217166
             les_mean =     514.004890624407
             stat err =       0.000545925945
             autocorr =       1.309786948781
   target nu stat err =       0.000545925945
   target dn stat err =       0.006341852421
      target stat err =       0.005283632062
              std dev =       0.674603208922
             le_variance =       0.455089489489


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741039389566        initial  <--
     2.4414e+36     2.4414e+37             0.0000e+00        -0.741039389566
     9.7656e+36     9.7656e+37             0.0000e+00        -0.741039389566
     3.9062e+37     3.9062e+38             0.0000e+00        -0.741039389566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.9062
  </log>
  <optVariables href="FORM2.s050.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2462e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7483
    reference variance = 0.418146
====================================================
  Execution time = 4.4951e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6400e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5226e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463990681595
                                         uncertainty =       0.015992034909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463990681595
                                         uncertainty =       0.015992034909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481665306
  error estimate for blocks of size 2^( 2) =       0.000504848183
  error estimate for blocks of size 2^( 3) =       0.000526143790
  error estimate for blocks of size 2^( 4) =       0.000541295343
  error estimate for blocks of size 2^( 5) =       0.000549472586
  error estimate for blocks of size 2^( 6) =       0.000552010644
  error estimate for blocks of size 2^( 7) =       0.000552757187

      target function =      -0.733528998499
              le_mean =     -22.661863553834
             les_mean =     514.024062434602
             stat err =       0.000548883940
             autocorr =       1.298584804770
   target nu stat err =       0.000548883940
   target dn stat err =       0.016309243678
      target stat err =       0.013246914502
              std dev =       0.681177608275
             le_variance =       0.464002934015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266186355383e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+37, overlap shift 2.4414e+38 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733765411014       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733765411014       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+37, overlap shift 9.7656e+38 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733765411014       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733765411014       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+38, overlap shift 3.9062e+39 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733765411014       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733765411014       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.906714 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0184e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6413
    reference variance = 0.428577
====================================================
  Execution time = 4.3787e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5568e-01
  Total weights = 2.0000e+06
  Execution time = 3.6363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455696584413
                                         uncertainty =       0.003763829271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455696584413
                                         uncertainty =       0.003763829271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477326750
  error estimate for blocks of size 2^( 2) =       0.000501028885
  error estimate for blocks of size 2^( 3) =       0.000523488348
  error estimate for blocks of size 2^( 4) =       0.000539029846
  error estimate for blocks of size 2^( 5) =       0.000548433088
  error estimate for blocks of size 2^( 6) =       0.000552128097
  error estimate for blocks of size 2^( 7) =       0.000555846477

      target function =      -0.740558872679
              le_mean =     -22.662534851002
             les_mean =     514.046167296778
             stat err =       0.000548859377
             autocorr =       1.322180142573
   target nu stat err =       0.000548859377
   target dn stat err =       0.003326139069
      target stat err =       0.002820181818
              std dev =       0.675041962945
             le_variance =       0.455681651736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455696584413
                                         uncertainty =       0.003763829271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455696584413
                                         uncertainty =       0.003763829271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477326750
  error estimate for blocks of size 2^( 2) =       0.000501028885
  error estimate for blocks of size 2^( 3) =       0.000523488348
  error estimate for blocks of size 2^( 4) =       0.000539029846
  error estimate for blocks of size 2^( 5) =       0.000548433088
  error estimate for blocks of size 2^( 6) =       0.000552128097
  error estimate for blocks of size 2^( 7) =       0.000555846477

      target function =      -0.740558872679
              le_mean =     -22.662534851002
             les_mean =     514.046167296778
             stat err =       0.000548859377
             autocorr =       1.322180142573
   target nu stat err =       0.000548859377
   target dn stat err =       0.003326139069
      target stat err =       0.002820181818
              std dev =       0.675041962945
             le_variance =       0.455681651736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455696584413
                                         uncertainty =       0.003763829271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455696584413
                                         uncertainty =       0.003763829271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477326750
  error estimate for blocks of size 2^( 2) =       0.000501028885
  error estimate for blocks of size 2^( 3) =       0.000523488348
  error estimate for blocks of size 2^( 4) =       0.000539029846
  error estimate for blocks of size 2^( 5) =       0.000548433088
  error estimate for blocks of size 2^( 6) =       0.000552128097
  error estimate for blocks of size 2^( 7) =       0.000555846477

      target function =      -0.740558872679
              le_mean =     -22.662534851002
             les_mean =     514.046167296778
             stat err =       0.000548859377
             autocorr =       1.322180142573
   target nu stat err =       0.000548859377
   target dn stat err =       0.003326139069
      target stat err =       0.002820181818
              std dev =       0.675041962945
             le_variance =       0.455681651736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455696584413
                                         uncertainty =       0.003763829271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455696584413
                                         uncertainty =       0.003763829271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477326750
  error estimate for blocks of size 2^( 2) =       0.000501028885
  error estimate for blocks of size 2^( 3) =       0.000523488348
  error estimate for blocks of size 2^( 4) =       0.000539029846
  error estimate for blocks of size 2^( 5) =       0.000548433088
  error estimate for blocks of size 2^( 6) =       0.000552128097
  error estimate for blocks of size 2^( 7) =       0.000555846477

      target function =      -0.740558872679
              le_mean =     -22.662534851002
             les_mean =     514.046167296778
             stat err =       0.000548859377
             autocorr =       1.322180142573
   target nu stat err =       0.000548859377
   target dn stat err =       0.003326139069
      target stat err =       0.002820181818
              std dev =       0.675041962945
             le_variance =       0.455681651736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740558872679        initial  <--
     2.4414e+37     2.4414e+38             0.0000e+00        -0.740558872679
     9.7656e+37     9.7656e+38             0.0000e+00        -0.740558872679
     3.9062e+38     3.9062e+39             0.0000e+00        -0.740558872679

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9971
  </log>
  <optVariables href="FORM2.s051.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2219e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6701
    reference variance = 0.254072
====================================================
  Execution time = 4.4711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6435e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5671e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464390075594
                                         uncertainty =       0.009137633079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464390075594
                                         uncertainty =       0.009137633079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481843510
  error estimate for blocks of size 2^( 2) =       0.000505213388
  error estimate for blocks of size 2^( 3) =       0.000526935367
  error estimate for blocks of size 2^( 4) =       0.000542300241
  error estimate for blocks of size 2^( 5) =       0.000552012214
  error estimate for blocks of size 2^( 6) =       0.000558308881
  error estimate for blocks of size 2^( 7) =       0.000563193165

      target function =      -0.733404007461
              le_mean =     -22.662140595454
             les_mean =     514.036962471750
             stat err =       0.000553953625
             autocorr =       1.321705783742
   target nu stat err =       0.000553953625
   target dn stat err =       0.009092950602
      target stat err =       0.007402183511
              std dev =       0.681429626454
             le_variance =       0.464346335809


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266214059545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+38, overlap shift 2.4414e+39 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733478501931       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733478501931       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+38, overlap shift 9.7656e+39 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733478501931       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733478501931       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+39, overlap shift 3.9062e+40 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733478501931       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733478501931       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.907832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0389e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6613
    reference variance = 0.717419
====================================================
  Execution time = 4.4046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5036e-01
  Total weights = 2.0000e+06
  Execution time = 3.6309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450331248695
                                         uncertainty =       0.002672074247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450331248695
                                         uncertainty =       0.002672074247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474532933
  error estimate for blocks of size 2^( 2) =       0.000498349338
  error estimate for blocks of size 2^( 3) =       0.000519994384
  error estimate for blocks of size 2^( 4) =       0.000535476315
  error estimate for blocks of size 2^( 5) =       0.000543915681
  error estimate for blocks of size 2^( 6) =       0.000548688112
  error estimate for blocks of size 2^( 7) =       0.000551967746

      target function =      -0.744990827145
              le_mean =     -22.662458398535
             les_mean =     514.037383448822
             stat err =       0.000545011963
             autocorr =       1.319104964218
   target nu stat err =       0.000545011963
   target dn stat err =       0.002775144534
      target stat err =       0.002403365251
              std dev =       0.671090909404
             le_variance =       0.450363008684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450331248695
                                         uncertainty =       0.002672074247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450331248695
                                         uncertainty =       0.002672074247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474532933
  error estimate for blocks of size 2^( 2) =       0.000498349338
  error estimate for blocks of size 2^( 3) =       0.000519994384
  error estimate for blocks of size 2^( 4) =       0.000535476315
  error estimate for blocks of size 2^( 5) =       0.000543915681
  error estimate for blocks of size 2^( 6) =       0.000548688112
  error estimate for blocks of size 2^( 7) =       0.000551967746

      target function =      -0.744990827145
              le_mean =     -22.662458398535
             les_mean =     514.037383448822
             stat err =       0.000545011963
             autocorr =       1.319104964218
   target nu stat err =       0.000545011963
   target dn stat err =       0.002775144534
      target stat err =       0.002403365251
              std dev =       0.671090909404
             le_variance =       0.450363008684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450331248695
                                         uncertainty =       0.002672074247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450331248695
                                         uncertainty =       0.002672074247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474532933
  error estimate for blocks of size 2^( 2) =       0.000498349338
  error estimate for blocks of size 2^( 3) =       0.000519994384
  error estimate for blocks of size 2^( 4) =       0.000535476315
  error estimate for blocks of size 2^( 5) =       0.000543915681
  error estimate for blocks of size 2^( 6) =       0.000548688112
  error estimate for blocks of size 2^( 7) =       0.000551967746

      target function =      -0.744990827145
              le_mean =     -22.662458398535
             les_mean =     514.037383448822
             stat err =       0.000545011963
             autocorr =       1.319104964218
   target nu stat err =       0.000545011963
   target dn stat err =       0.002775144534
      target stat err =       0.002403365251
              std dev =       0.671090909404
             le_variance =       0.450363008684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450331248695
                                         uncertainty =       0.002672074247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450331248695
                                         uncertainty =       0.002672074247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474532933
  error estimate for blocks of size 2^( 2) =       0.000498349338
  error estimate for blocks of size 2^( 3) =       0.000519994384
  error estimate for blocks of size 2^( 4) =       0.000535476315
  error estimate for blocks of size 2^( 5) =       0.000543915681
  error estimate for blocks of size 2^( 6) =       0.000548688112
  error estimate for blocks of size 2^( 7) =       0.000551967746

      target function =      -0.744990827145
              le_mean =     -22.662458398535
             les_mean =     514.037383448822
             stat err =       0.000545011963
             autocorr =       1.319104964218
   target nu stat err =       0.000545011963
   target dn stat err =       0.002775144534
      target stat err =       0.002403365251
              std dev =       0.671090909404
             le_variance =       0.450363008684


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744990827145        initial  <--
     2.4414e+38     2.4414e+39             0.0000e+00        -0.744990827145
     9.7656e+38     9.7656e+39             0.0000e+00        -0.744990827145
     3.9062e+39     3.9062e+40             0.0000e+00        -0.744990827145

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.7720
  </log>
  <optVariables href="FORM2.s052.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2417e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.723
    reference variance = 0.450686
====================================================
  Execution time = 4.4289e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4894e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5264e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448980592062
                                         uncertainty =       0.002790481249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448980592062
                                         uncertainty =       0.002790481249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473782462
  error estimate for blocks of size 2^( 2) =       0.000497145809
  error estimate for blocks of size 2^( 3) =       0.000518961985
  error estimate for blocks of size 2^( 4) =       0.000534505557
  error estimate for blocks of size 2^( 5) =       0.000543373500
  error estimate for blocks of size 2^( 6) =       0.000546143348
  error estimate for blocks of size 2^( 7) =       0.000547023630

      target function =      -0.746194058795
              le_mean =     -22.661648784957
             les_mean =     513.999265070222
             stat err =       0.000542761509
             autocorr =       1.312381566027
   target nu stat err =       0.000542761509
   target dn stat err =       0.002795365100
      target stat err =       0.002423714773
              std dev =       0.670029582885
             le_variance =       0.448939641941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266164878496e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+39, overlap shift 2.4414e+40 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746200944011       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746200944011       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746200944011       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746215820312       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+39 is 2.182851e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+39, overlap shift 9.7656e+40 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746200944011       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746200944011       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746200944011       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746215820312       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+39 is 5.457127e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+40, overlap shift 3.9062e+41 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746200944011       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746200944011       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746200944011       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746215820312       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+40 is 1.364282e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.909423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9577e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6854
    reference variance = 0.461337
====================================================
  Execution time = 4.3746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4980e-01
  Total weights = 2.0000e+06
  Execution time = 3.6413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449806748684
                                         uncertainty =       0.002814228288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449806748684
                                         uncertainty =       0.002814228288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474234875
  error estimate for blocks of size 2^( 2) =       0.000497800056
  error estimate for blocks of size 2^( 3) =       0.000520008995
  error estimate for blocks of size 2^( 4) =       0.000535128060
  error estimate for blocks of size 2^( 5) =       0.000543723240
  error estimate for blocks of size 2^( 6) =       0.000549663355
  error estimate for blocks of size 2^( 7) =       0.000553487111

      target function =      -0.745472496816
              le_mean =     -22.661766933163
             les_mean =     514.005477740872
             stat err =       0.000545500441
             autocorr =       1.323132192245
   target nu stat err =       0.000545500441
   target dn stat err =       0.002982535241
      target stat err =       0.002572365923
              std dev =       0.670669391557
             le_variance =       0.449797432771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449806748684
                                         uncertainty =       0.002814228288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449806748684
                                         uncertainty =       0.002814228288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474234875
  error estimate for blocks of size 2^( 2) =       0.000497800056
  error estimate for blocks of size 2^( 3) =       0.000520008995
  error estimate for blocks of size 2^( 4) =       0.000535128060
  error estimate for blocks of size 2^( 5) =       0.000543723240
  error estimate for blocks of size 2^( 6) =       0.000549663355
  error estimate for blocks of size 2^( 7) =       0.000553487111

      target function =      -0.745472496816
              le_mean =     -22.661766933163
             les_mean =     514.005477740872
             stat err =       0.000545500441
             autocorr =       1.323132192245
   target nu stat err =       0.000545500441
   target dn stat err =       0.002982535241
      target stat err =       0.002572365923
              std dev =       0.670669391557
             le_variance =       0.449797432771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449806748684
                                         uncertainty =       0.002814228288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449806748684
                                         uncertainty =       0.002814228288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474234875
  error estimate for blocks of size 2^( 2) =       0.000497800056
  error estimate for blocks of size 2^( 3) =       0.000520008995
  error estimate for blocks of size 2^( 4) =       0.000535128060
  error estimate for blocks of size 2^( 5) =       0.000543723240
  error estimate for blocks of size 2^( 6) =       0.000549663355
  error estimate for blocks of size 2^( 7) =       0.000553487111

      target function =      -0.745472496816
              le_mean =     -22.661766933163
             les_mean =     514.005477740872
             stat err =       0.000545500441
             autocorr =       1.323132192245
   target nu stat err =       0.000545500441
   target dn stat err =       0.002982535241
      target stat err =       0.002572365923
              std dev =       0.670669391557
             le_variance =       0.449797432771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449806748684
                                         uncertainty =       0.002814228288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449806748684
                                         uncertainty =       0.002814228288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474234875
  error estimate for blocks of size 2^( 2) =       0.000497800056
  error estimate for blocks of size 2^( 3) =       0.000520008995
  error estimate for blocks of size 2^( 4) =       0.000535128060
  error estimate for blocks of size 2^( 5) =       0.000543723240
  error estimate for blocks of size 2^( 6) =       0.000549663355
  error estimate for blocks of size 2^( 7) =       0.000553487111

      target function =      -0.745472496816
              le_mean =     -22.661766933163
             les_mean =     514.005477740872
             stat err =       0.000545500441
             autocorr =       1.323132192245
   target nu stat err =       0.000545500441
   target dn stat err =       0.002982535241
      target stat err =       0.002572365923
              std dev =       0.670669391557
             le_variance =       0.449797432771


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745472496816        initial  <--
     2.4414e+39     2.4414e+40             2.1829e-44        -0.745472496816
     9.7656e+39     9.7656e+40             5.4571e-45        -0.745472496816
     3.9062e+40     3.9062e+41             1.3643e-45        -0.745472496816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.9689
  </log>
  <optVariables href="FORM2.s053.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2155e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6561
    reference variance = 0.414548
====================================================
  Execution time = 4.4616e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5477e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5285e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454826852439
                                         uncertainty =       0.004140085738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.454826852439
                                         uncertainty =       0.004140085738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476847520
  error estimate for blocks of size 2^( 2) =       0.000500705052
  error estimate for blocks of size 2^( 3) =       0.000522500133
  error estimate for blocks of size 2^( 4) =       0.000538361037
  error estimate for blocks of size 2^( 5) =       0.000547635255
  error estimate for blocks of size 2^( 6) =       0.000552266809
  error estimate for blocks of size 2^( 7) =       0.000554917888

      target function =      -0.741306910840
              le_mean =     -22.662624971168
             les_mean =     514.049337470687
             stat err =       0.000548295248
             autocorr =       1.322117053327
   target nu stat err =       0.000548295248
   target dn stat err =       0.004400192374
      target stat err =       0.003700640834
              std dev =       0.674364229673
             le_variance =       0.454767114262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266262497117e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+40, overlap shift 2.4414e+41 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741324464752       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741324464752       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741324464752       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741324464752       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741324464752       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741324457955       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 7.36e+11           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+40 is 3.068648e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+40, overlap shift 9.7656e+41 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741324464752       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741324464752       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741324464752       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741324464752       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741324464752       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741324351270       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.706376597256       residual = 5.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+40 is 7.671620e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+41, overlap shift 3.9062e+42 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741324464752       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741324464752       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741324464752       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741324464752       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741324464752       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741324457955       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 7.36e+11           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+41 is 1.917905e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.912051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9912e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6885
    reference variance = 0.367719
====================================================
  Execution time = 4.4710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5171e-01
  Total weights = 2.0000e+06
  Execution time = 3.9052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451721816088
                                         uncertainty =       0.005689072267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451721816088
                                         uncertainty =       0.005689072267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475239536
  error estimate for blocks of size 2^( 2) =       0.000499349697
  error estimate for blocks of size 2^( 3) =       0.000521994801
  error estimate for blocks of size 2^( 4) =       0.000538211899
  error estimate for blocks of size 2^( 5) =       0.000547487286
  error estimate for blocks of size 2^( 6) =       0.000551571384
  error estimate for blocks of size 2^( 7) =       0.000555184019

      target function =      -0.743841713752
              le_mean =     -22.662601149105
             les_mean =     514.045195850539
             stat err =       0.000548113647
             autocorr =       1.330197429728
   target nu stat err =       0.000548113647
   target dn stat err =       0.005870163163
      target stat err =       0.004940347072
              std dev =       0.672090197043
             le_variance =       0.451705232962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451721816088
                                         uncertainty =       0.005689072267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451721816088
                                         uncertainty =       0.005689072267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475239536
  error estimate for blocks of size 2^( 2) =       0.000499349697
  error estimate for blocks of size 2^( 3) =       0.000521994801
  error estimate for blocks of size 2^( 4) =       0.000538211899
  error estimate for blocks of size 2^( 5) =       0.000547487286
  error estimate for blocks of size 2^( 6) =       0.000551571384
  error estimate for blocks of size 2^( 7) =       0.000555184019

      target function =      -0.743841713752
              le_mean =     -22.662601149105
             les_mean =     514.045195850539
             stat err =       0.000548113647
             autocorr =       1.330197429728
   target nu stat err =       0.000548113647
   target dn stat err =       0.005870163163
      target stat err =       0.004940347072
              std dev =       0.672090197043
             le_variance =       0.451705232962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451721816088
                                         uncertainty =       0.005689072267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451721816088
                                         uncertainty =       0.005689072267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475239536
  error estimate for blocks of size 2^( 2) =       0.000499349697
  error estimate for blocks of size 2^( 3) =       0.000521994801
  error estimate for blocks of size 2^( 4) =       0.000538211899
  error estimate for blocks of size 2^( 5) =       0.000547487286
  error estimate for blocks of size 2^( 6) =       0.000551571384
  error estimate for blocks of size 2^( 7) =       0.000555184019

      target function =      -0.743841713752
              le_mean =     -22.662601149105
             les_mean =     514.045195850539
             stat err =       0.000548113647
             autocorr =       1.330197429728
   target nu stat err =       0.000548113647
   target dn stat err =       0.005870163163
      target stat err =       0.004940347072
              std dev =       0.672090197043
             le_variance =       0.451705232962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451721816088
                                         uncertainty =       0.005689072267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451721816088
                                         uncertainty =       0.005689072267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000475239536
  error estimate for blocks of size 2^( 2) =       0.000499349697
  error estimate for blocks of size 2^( 3) =       0.000521994801
  error estimate for blocks of size 2^( 4) =       0.000538211899
  error estimate for blocks of size 2^( 5) =       0.000547487286
  error estimate for blocks of size 2^( 6) =       0.000551571384
  error estimate for blocks of size 2^( 7) =       0.000555184019

      target function =      -0.743841713752
              le_mean =     -22.662601149105
             les_mean =     514.045195850539
             stat err =       0.000548113647
             autocorr =       1.330197429728
   target nu stat err =       0.000548113647
   target dn stat err =       0.005870163163
      target stat err =       0.004940347072
              std dev =       0.672090197043
             le_variance =       0.451705232962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743841713752        initial  <--
     2.4414e+40     2.4414e+41             3.0686e-45        -0.743841713752
     9.7656e+40     9.7656e+41             7.6716e-46        -0.743841713752
     3.9062e+41     3.9062e+42             1.9179e-46        -0.743841713752

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6931
  </log>
  <optVariables href="FORM2.s054.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2361e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7029
    reference variance = 0.38222
====================================================
  Execution time = 4.6227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4974e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5295e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449843848335
                                         uncertainty =       0.002742793787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449843848335
                                         uncertainty =       0.002742793787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474204539
  error estimate for blocks of size 2^( 2) =       0.000498169237
  error estimate for blocks of size 2^( 3) =       0.000520341299
  error estimate for blocks of size 2^( 4) =       0.000536090687
  error estimate for blocks of size 2^( 5) =       0.000545285084
  error estimate for blocks of size 2^( 6) =       0.000551535281
  error estimate for blocks of size 2^( 7) =       0.000553757948

      target function =      -0.745516565822
              le_mean =     -22.662117008192
             les_mean =     514.021286958204
             stat err =       0.000546667250
             autocorr =       1.328968538177
   target nu stat err =       0.000546667250
   target dn stat err =       0.002962284320
      target stat err =       0.002557852062
              std dev =       0.670626490738
             le_variance =       0.449739890079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266211700819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+41, overlap shift 2.4414e+42 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745524301229       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745524301229       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745524301229       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+41 is 2.134623e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+41, overlap shift 9.7656e+42 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745524301229       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745524301229       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+41 is 2.635443e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+42, overlap shift 3.9062e+43 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745524301229       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745524301229       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745524301229       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745117187500       residual = 9.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+42 is 1.334139e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.913390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1529e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7432
    reference variance = 0.361794
====================================================
  Execution time = 4.4114e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4906e-01
  Total weights = 2.0000e+06
  Execution time = 3.6400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449030868592
                                         uncertainty =       0.004260041542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449030868592
                                         uncertainty =       0.004260041542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473843499
  error estimate for blocks of size 2^( 2) =       0.000497966841
  error estimate for blocks of size 2^( 3) =       0.000519827371
  error estimate for blocks of size 2^( 4) =       0.000535976758
  error estimate for blocks of size 2^( 5) =       0.000545139657
  error estimate for blocks of size 2^( 6) =       0.000549398498
  error estimate for blocks of size 2^( 7) =       0.000551616103

      target function =      -0.746076882581
              le_mean =     -22.662694493608
             les_mean =     514.046776808624
             stat err =       0.000545532754
             autocorr =       1.325475820335
   target nu stat err =       0.000545532754
   target dn stat err =       0.003963288123
      target stat err =       0.003386052132
              std dev =       0.670115902324
             le_variance =       0.449055322547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449030868592
                                         uncertainty =       0.004260041542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449030868592
                                         uncertainty =       0.004260041542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473843499
  error estimate for blocks of size 2^( 2) =       0.000497966841
  error estimate for blocks of size 2^( 3) =       0.000519827371
  error estimate for blocks of size 2^( 4) =       0.000535976758
  error estimate for blocks of size 2^( 5) =       0.000545139657
  error estimate for blocks of size 2^( 6) =       0.000549398498
  error estimate for blocks of size 2^( 7) =       0.000551616103

      target function =      -0.746076882581
              le_mean =     -22.662694493608
             les_mean =     514.046776808624
             stat err =       0.000545532754
             autocorr =       1.325475820336
   target nu stat err =       0.000545532754
   target dn stat err =       0.003963288123
      target stat err =       0.003386052132
              std dev =       0.670115902324
             le_variance =       0.449055322547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449030868592
                                         uncertainty =       0.004260041542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449030868592
                                         uncertainty =       0.004260041542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473843499
  error estimate for blocks of size 2^( 2) =       0.000497966841
  error estimate for blocks of size 2^( 3) =       0.000519827371
  error estimate for blocks of size 2^( 4) =       0.000535976758
  error estimate for blocks of size 2^( 5) =       0.000545139657
  error estimate for blocks of size 2^( 6) =       0.000549398498
  error estimate for blocks of size 2^( 7) =       0.000551616103

      target function =      -0.746076882581
              le_mean =     -22.662694493608
             les_mean =     514.046776808624
             stat err =       0.000545532754
             autocorr =       1.325475820336
   target nu stat err =       0.000545532754
   target dn stat err =       0.003963288123
      target stat err =       0.003386052132
              std dev =       0.670115902324
             le_variance =       0.449055322547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449030868592
                                         uncertainty =       0.004260041542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.449030868592
                                         uncertainty =       0.004260041542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473843499
  error estimate for blocks of size 2^( 2) =       0.000497966841
  error estimate for blocks of size 2^( 3) =       0.000519827371
  error estimate for blocks of size 2^( 4) =       0.000535976758
  error estimate for blocks of size 2^( 5) =       0.000545139657
  error estimate for blocks of size 2^( 6) =       0.000549398498
  error estimate for blocks of size 2^( 7) =       0.000551616103

      target function =      -0.746076882581
              le_mean =     -22.662694493608
             les_mean =     514.046776808624
             stat err =       0.000545532754
             autocorr =       1.325475820336
   target nu stat err =       0.000545532754
   target dn stat err =       0.003963288123
      target stat err =       0.003386052132
              std dev =       0.670115902324
             le_variance =       0.449055322547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746076882581        initial  <--
     2.4414e+41     2.4414e+42             2.1346e-46        -0.746076882581
     9.7656e+41     9.7656e+42             2.6354e-47        -0.746076882581
     3.9062e+42     3.9062e+43             1.3341e-47        -0.746076882581

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.3255
  </log>
  <optVariables href="FORM2.s055.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2386e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.627
    reference variance = 0.332951
====================================================
  Execution time = 4.4953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5031e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5189e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450363389771
                                         uncertainty =       0.003451922850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450363389771
                                         uncertainty =       0.003451922850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474505903
  error estimate for blocks of size 2^( 2) =       0.000498474273
  error estimate for blocks of size 2^( 3) =       0.000520553499
  error estimate for blocks of size 2^( 4) =       0.000535735561
  error estimate for blocks of size 2^( 5) =       0.000544179554
  error estimate for blocks of size 2^( 6) =       0.000549066764
  error estimate for blocks of size 2^( 7) =       0.000550190625

      target function =      -0.745032751215
              le_mean =     -22.662207885821
             les_mean =     514.025977738883
             stat err =       0.000544793126
             autocorr =       1.318196029164
   target nu stat err =       0.000544793126
   target dn stat err =       0.003542007772
      target stat err =       0.003027925324
              std dev =       0.671052683386
             le_variance =       0.450311703880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266220788582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+42, overlap shift 2.4414e+43 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745044100784       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745044100784       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+42, overlap shift 9.7656e+43 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745044100784       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745044100784       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745044708252       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+42 is 3.163823e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+43, overlap shift 3.9063e+44 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745044100784       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745044100784       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745040893555       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+43 is 7.909557e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.914630 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0150e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.5763
    reference variance = 0.462621
====================================================
  Execution time = 4.3850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.7117e-01
  Total weights = 2.0000e+06
  Execution time = 3.6494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471286601470
                                         uncertainty =       0.016455288598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471286601470
                                         uncertainty =       0.016455288598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485373613
  error estimate for blocks of size 2^( 2) =       0.000508975375
  error estimate for blocks of size 2^( 3) =       0.000530842043
  error estimate for blocks of size 2^( 4) =       0.000546105635
  error estimate for blocks of size 2^( 5) =       0.000555242575
  error estimate for blocks of size 2^( 6) =       0.000559010243
  error estimate for blocks of size 2^( 7) =       0.000561551251

      target function =      -0.727744278769
              le_mean =     -22.662236578993
             les_mean =     514.048141615851
             stat err =       0.000555477426
             autocorr =       1.309726163127
   target nu stat err =       0.000555477426
   target dn stat err =       0.016210863991
      target stat err =       0.012968115999
              std dev =       0.686421946889
             le_variance =       0.471175089171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471286601470
                                         uncertainty =       0.016455288598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471286601470
                                         uncertainty =       0.016455288598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485373613
  error estimate for blocks of size 2^( 2) =       0.000508975375
  error estimate for blocks of size 2^( 3) =       0.000530842043
  error estimate for blocks of size 2^( 4) =       0.000546105635
  error estimate for blocks of size 2^( 5) =       0.000555242575
  error estimate for blocks of size 2^( 6) =       0.000559010243
  error estimate for blocks of size 2^( 7) =       0.000561551251

      target function =      -0.727744278769
              le_mean =     -22.662236578993
             les_mean =     514.048141615851
             stat err =       0.000555477426
             autocorr =       1.309726163127
   target nu stat err =       0.000555477426
   target dn stat err =       0.016210863991
      target stat err =       0.012968115999
              std dev =       0.686421946889
             le_variance =       0.471175089171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471286601470
                                         uncertainty =       0.016455288598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471286601470
                                         uncertainty =       0.016455288598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485373613
  error estimate for blocks of size 2^( 2) =       0.000508975375
  error estimate for blocks of size 2^( 3) =       0.000530842043
  error estimate for blocks of size 2^( 4) =       0.000546105635
  error estimate for blocks of size 2^( 5) =       0.000555242575
  error estimate for blocks of size 2^( 6) =       0.000559010243
  error estimate for blocks of size 2^( 7) =       0.000561551251

      target function =      -0.727744278769
              le_mean =     -22.662236578993
             les_mean =     514.048141615851
             stat err =       0.000555477426
             autocorr =       1.309726163127
   target nu stat err =       0.000555477426
   target dn stat err =       0.016210863991
      target stat err =       0.012968115999
              std dev =       0.686421946889
             le_variance =       0.471175089171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471286601470
                                         uncertainty =       0.016455288598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471286601470
                                         uncertainty =       0.016455288598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485373613
  error estimate for blocks of size 2^( 2) =       0.000508975375
  error estimate for blocks of size 2^( 3) =       0.000530842043
  error estimate for blocks of size 2^( 4) =       0.000546105635
  error estimate for blocks of size 2^( 5) =       0.000555242575
  error estimate for blocks of size 2^( 6) =       0.000559010243
  error estimate for blocks of size 2^( 7) =       0.000561551251

      target function =      -0.727744278769
              le_mean =     -22.662236578993
             les_mean =     514.048141615851
             stat err =       0.000555477426
             autocorr =       1.309726163127
   target nu stat err =       0.000555477426
   target dn stat err =       0.016210863991
      target stat err =       0.012968115999
              std dev =       0.686421946889
             le_variance =       0.471175089171


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.727744278769        initial  <--
     2.4414e+42     2.4414e+43             0.0000e+00        -0.727744278769
     9.7656e+42     9.7656e+43             3.1638e-48        -0.727744278769
     3.9062e+43     3.9063e+44             7.9096e-49        -0.727744278769

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.1232
  </log>
  <optVariables href="FORM2.s056.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2228e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.703
    reference variance = 0.542638
====================================================
  Execution time = 4.6418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5806e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5161e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458161440066
                                         uncertainty =       0.005526962542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.458161440066
                                         uncertainty =       0.005526962542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478571573
  error estimate for blocks of size 2^( 2) =       0.000501723692
  error estimate for blocks of size 2^( 3) =       0.000522780676
  error estimate for blocks of size 2^( 4) =       0.000536845054
  error estimate for blocks of size 2^( 5) =       0.000546181176
  error estimate for blocks of size 2^( 6) =       0.000550462220
  error estimate for blocks of size 2^( 7) =       0.000553070268

      target function =      -0.738573082755
              le_mean =     -22.662545134768
             les_mean =     514.049013257726
             stat err =       0.000546639679
             autocorr =       1.304693531849
   target nu stat err =       0.000546639679
   target dn stat err =       0.005880500818
      target stat err =       0.004878974866
              std dev =       0.676802409401
             le_variance =       0.458061501371


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266254513477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+43, overlap shift 2.4414e+44 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738604007831       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738604007831       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+43, overlap shift 9.7656e+44 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738604007831       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738604007831       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+44, overlap shift 3.9063e+45 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738604007831       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738604007831       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9063e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.915741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1587e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.658
    reference variance = 0.504629
====================================================
  Execution time = 4.5612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5591e-01
  Total weights = 2.0000e+06
  Execution time = 3.6390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455939173490
                                         uncertainty =       0.003491022476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455939173490
                                         uncertainty =       0.003491022476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477444641
  error estimate for blocks of size 2^( 2) =       0.000501039076
  error estimate for blocks of size 2^( 3) =       0.000522824235
  error estimate for blocks of size 2^( 4) =       0.000540120148
  error estimate for blocks of size 2^( 5) =       0.000548262152
  error estimate for blocks of size 2^( 6) =       0.000555178302
  error estimate for blocks of size 2^( 7) =       0.000556690145

      target function =      -0.740373118019
              le_mean =     -22.662497192024
             les_mean =     514.044685521430
             stat err =       0.000550062687
             autocorr =       1.327328211908
   target nu stat err =       0.000550062687
   target dn stat err =       0.003399473424
      target stat err =       0.002878162688
              std dev =       0.675208686920
             le_variance =       0.455906770892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455939173490
                                         uncertainty =       0.003491022476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455939173490
                                         uncertainty =       0.003491022476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477444641
  error estimate for blocks of size 2^( 2) =       0.000501039076
  error estimate for blocks of size 2^( 3) =       0.000522824235
  error estimate for blocks of size 2^( 4) =       0.000540120148
  error estimate for blocks of size 2^( 5) =       0.000548262152
  error estimate for blocks of size 2^( 6) =       0.000555178302
  error estimate for blocks of size 2^( 7) =       0.000556690145

      target function =      -0.740373118019
              le_mean =     -22.662497192024
             les_mean =     514.044685521430
             stat err =       0.000550062687
             autocorr =       1.327328211908
   target nu stat err =       0.000550062687
   target dn stat err =       0.003399473424
      target stat err =       0.002878162688
              std dev =       0.675208686920
             le_variance =       0.455906770892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455939173490
                                         uncertainty =       0.003491022476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455939173490
                                         uncertainty =       0.003491022476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477444641
  error estimate for blocks of size 2^( 2) =       0.000501039076
  error estimate for blocks of size 2^( 3) =       0.000522824235
  error estimate for blocks of size 2^( 4) =       0.000540120148
  error estimate for blocks of size 2^( 5) =       0.000548262152
  error estimate for blocks of size 2^( 6) =       0.000555178302
  error estimate for blocks of size 2^( 7) =       0.000556690145

      target function =      -0.740373118019
              le_mean =     -22.662497192024
             les_mean =     514.044685521430
             stat err =       0.000550062687
             autocorr =       1.327328211908
   target nu stat err =       0.000550062687
   target dn stat err =       0.003399473424
      target stat err =       0.002878162688
              std dev =       0.675208686920
             le_variance =       0.455906770892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455939173490
                                         uncertainty =       0.003491022476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455939173490
                                         uncertainty =       0.003491022476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477444641
  error estimate for blocks of size 2^( 2) =       0.000501039076
  error estimate for blocks of size 2^( 3) =       0.000522824235
  error estimate for blocks of size 2^( 4) =       0.000540120148
  error estimate for blocks of size 2^( 5) =       0.000548262152
  error estimate for blocks of size 2^( 6) =       0.000555178302
  error estimate for blocks of size 2^( 7) =       0.000556690145

      target function =      -0.740373118019
              le_mean =     -22.662497192024
             les_mean =     514.044685521430
             stat err =       0.000550062687
             autocorr =       1.327328211908
   target nu stat err =       0.000550062687
   target dn stat err =       0.003399473424
      target stat err =       0.002878162688
              std dev =       0.675208686920
             le_variance =       0.455906770892


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740373118019        initial  <--
     2.4414e+43     2.4414e+44             0.0000e+00        -0.740373118019
     9.7656e+43     9.7656e+44             0.0000e+00        -0.740373118019
     3.9063e+44     3.9063e+45             0.0000e+00        -0.740373118019

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.8521
  </log>
  <optVariables href="FORM2.s057.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2546e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.5934
    reference variance = 0.287391
====================================================
  Execution time = 4.4134e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5736e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4957e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457432053728
                                         uncertainty =       0.004570729033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457432053728
                                         uncertainty =       0.004570729033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478206779
  error estimate for blocks of size 2^( 2) =       0.000501758900
  error estimate for blocks of size 2^( 3) =       0.000523334767
  error estimate for blocks of size 2^( 4) =       0.000538755500
  error estimate for blocks of size 2^( 5) =       0.000547374112
  error estimate for blocks of size 2^( 6) =       0.000550874041
  error estimate for blocks of size 2^( 7) =       0.000556466358

      target function =      -0.739163684939
              le_mean =     -22.662261271249
             les_mean =     514.035449145241
             stat err =       0.000548367503
             autocorr =       1.314958243704
   target nu stat err =       0.000548367503
   target dn stat err =       0.004884336458
      target stat err =       0.004071576183
              std dev =       0.676286512943
             le_variance =       0.457363447589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266226127125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+44, overlap shift 2.4414e+45 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739185477648       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739185477648       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+44, overlap shift 9.7656e+45 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739185477648       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739185477648       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+45, overlap shift 3.9063e+46 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739185477648       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739185477648       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9063e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.916827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9098e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.604
    reference variance = 0.292507
====================================================
  Execution time = 4.3629e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5764e-01
  Total weights = 2.0000e+06
  Execution time = 3.6367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457368383330
                                         uncertainty =       0.006293932833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457368383330
                                         uncertainty =       0.006293932833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478352282
  error estimate for blocks of size 2^( 2) =       0.000502286130
  error estimate for blocks of size 2^( 3) =       0.000523604417
  error estimate for blocks of size 2^( 4) =       0.000539170195
  error estimate for blocks of size 2^( 5) =       0.000548043051
  error estimate for blocks of size 2^( 6) =       0.000553492290
  error estimate for blocks of size 2^( 7) =       0.000555446155

      target function =      -0.738906924386
              le_mean =     -22.662875661480
             les_mean =     514.063574830204
             stat err =       0.000549037923
             autocorr =       1.317373689383
   target nu stat err =       0.000549037923
   target dn stat err =       0.006197766002
      target stat err =       0.005145730427
              std dev =       0.676492284762
             le_variance =       0.457641811342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457368383330
                                         uncertainty =       0.006293932833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457368383330
                                         uncertainty =       0.006293932833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478352282
  error estimate for blocks of size 2^( 2) =       0.000502286130
  error estimate for blocks of size 2^( 3) =       0.000523604417
  error estimate for blocks of size 2^( 4) =       0.000539170195
  error estimate for blocks of size 2^( 5) =       0.000548043051
  error estimate for blocks of size 2^( 6) =       0.000553492290
  error estimate for blocks of size 2^( 7) =       0.000555446155

      target function =      -0.738906924386
              le_mean =     -22.662875661480
             les_mean =     514.063574830204
             stat err =       0.000549037923
             autocorr =       1.317373689383
   target nu stat err =       0.000549037923
   target dn stat err =       0.006197766002
      target stat err =       0.005145730427
              std dev =       0.676492284762
             le_variance =       0.457641811342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457368383330
                                         uncertainty =       0.006293932833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457368383330
                                         uncertainty =       0.006293932833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478352282
  error estimate for blocks of size 2^( 2) =       0.000502286130
  error estimate for blocks of size 2^( 3) =       0.000523604417
  error estimate for blocks of size 2^( 4) =       0.000539170195
  error estimate for blocks of size 2^( 5) =       0.000548043051
  error estimate for blocks of size 2^( 6) =       0.000553492290
  error estimate for blocks of size 2^( 7) =       0.000555446155

      target function =      -0.738906924386
              le_mean =     -22.662875661480
             les_mean =     514.063574830204
             stat err =       0.000549037923
             autocorr =       1.317373689383
   target nu stat err =       0.000549037923
   target dn stat err =       0.006197766002
      target stat err =       0.005145730427
              std dev =       0.676492284762
             le_variance =       0.457641811342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457368383330
                                         uncertainty =       0.006293932833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457368383330
                                         uncertainty =       0.006293932833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478352282
  error estimate for blocks of size 2^( 2) =       0.000502286130
  error estimate for blocks of size 2^( 3) =       0.000523604417
  error estimate for blocks of size 2^( 4) =       0.000539170195
  error estimate for blocks of size 2^( 5) =       0.000548043051
  error estimate for blocks of size 2^( 6) =       0.000553492290
  error estimate for blocks of size 2^( 7) =       0.000555446155

      target function =      -0.738906924386
              le_mean =     -22.662875661480
             les_mean =     514.063574830204
             stat err =       0.000549037923
             autocorr =       1.317373689383
   target nu stat err =       0.000549037923
   target dn stat err =       0.006197766002
      target stat err =       0.005145730427
              std dev =       0.676492284762
             le_variance =       0.457641811342


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738906924386        initial  <--
     2.4414e+44     2.4414e+45             0.0000e+00        -0.738906924386
     9.7656e+44     9.7656e+45             0.0000e+00        -0.738906924386
     3.9063e+45     3.9063e+46             0.0000e+00        -0.738906924386

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8282
  </log>
  <optVariables href="FORM2.s058.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2094e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6579
    reference variance = 0.360469
====================================================
  Execution time = 4.4321e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5646e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5071e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456500596824
                                         uncertainty =       0.004242766977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.456500596824
                                         uncertainty =       0.004242766977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477732458
  error estimate for blocks of size 2^( 2) =       0.000501681694
  error estimate for blocks of size 2^( 3) =       0.000523096080
  error estimate for blocks of size 2^( 4) =       0.000537670810
  error estimate for blocks of size 2^( 5) =       0.000546639477
  error estimate for blocks of size 2^( 6) =       0.000551610241
  error estimate for blocks of size 2^( 7) =       0.000554073329

      target function =      -0.739914978001
              le_mean =     -22.662300309059
             les_mean =     514.036311672451
             stat err =       0.000547498464
             autocorr =       1.313397885207
   target nu stat err =       0.000547498464
   target dn stat err =       0.004471386122
      target stat err =       0.003742990869
              std dev =       0.675615721174
             le_variance =       0.456456602698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266230030906e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+45, overlap shift 2.4414e+46 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739932804185       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739932804185       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+45, overlap shift 9.7656e+46 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739932804185       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739932804185       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9063e+46, overlap shift 3.9063e+47 and omega -2.3325e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739932804185       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739932804185       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9063e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.917911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9400e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6326
    reference variance = 0.49135
====================================================
  Execution time = 4.5983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5081e-01
  Total weights = 2.0000e+06
  Execution time = 3.6403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450894621291
                                         uncertainty =       0.004051609187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450894621291
                                         uncertainty =       0.004051609187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474768202
  error estimate for blocks of size 2^( 2) =       0.000498567629
  error estimate for blocks of size 2^( 3) =       0.000520016358
  error estimate for blocks of size 2^( 4) =       0.000535907085
  error estimate for blocks of size 2^( 5) =       0.000545750376
  error estimate for blocks of size 2^( 6) =       0.000548673173
  error estimate for blocks of size 2^( 7) =       0.000551511354

      target function =      -0.744614722438
              le_mean =     -22.662337024889
             les_mean =     514.032328896351
             stat err =       0.000545460497
             autocorr =       1.319967867649
   target nu stat err =       0.000545460497
   target dn stat err =       0.003465416483
      target stat err =       0.002962629599
              std dev =       0.671423630881
             le_variance =       0.450809692106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450894621291
                                         uncertainty =       0.004051609187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450894621291
                                         uncertainty =       0.004051609187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474768202
  error estimate for blocks of size 2^( 2) =       0.000498567629
  error estimate for blocks of size 2^( 3) =       0.000520016358
  error estimate for blocks of size 2^( 4) =       0.000535907085
  error estimate for blocks of size 2^( 5) =       0.000545750376
  error estimate for blocks of size 2^( 6) =       0.000548673173
  error estimate for blocks of size 2^( 7) =       0.000551511354

      target function =      -0.744614722438
              le_mean =     -22.662337024889
             les_mean =     514.032328896351
             stat err =       0.000545460497
             autocorr =       1.319967867649
   target nu stat err =       0.000545460497
   target dn stat err =       0.003465416483
      target stat err =       0.002962629599
              std dev =       0.671423630881
             le_variance =       0.450809692106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450894621291
                                         uncertainty =       0.004051609187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450894621291
                                         uncertainty =       0.004051609187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474768202
  error estimate for blocks of size 2^( 2) =       0.000498567629
  error estimate for blocks of size 2^( 3) =       0.000520016358
  error estimate for blocks of size 2^( 4) =       0.000535907085
  error estimate for blocks of size 2^( 5) =       0.000545750376
  error estimate for blocks of size 2^( 6) =       0.000548673173
  error estimate for blocks of size 2^( 7) =       0.000551511354

      target function =      -0.744614722438
              le_mean =     -22.662337024889
             les_mean =     514.032328896351
             stat err =       0.000545460497
             autocorr =       1.319967867649
   target nu stat err =       0.000545460497
   target dn stat err =       0.003465416483
      target stat err =       0.002962629599
              std dev =       0.671423630881
             le_variance =       0.450809692106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450894621291
                                         uncertainty =       0.004051609187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450894621291
                                         uncertainty =       0.004051609187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474768202
  error estimate for blocks of size 2^( 2) =       0.000498567629
  error estimate for blocks of size 2^( 3) =       0.000520016358
  error estimate for blocks of size 2^( 4) =       0.000535907085
  error estimate for blocks of size 2^( 5) =       0.000545750376
  error estimate for blocks of size 2^( 6) =       0.000548673173
  error estimate for blocks of size 2^( 7) =       0.000551511354

      target function =      -0.744614722438
              le_mean =     -22.662337024889
             les_mean =     514.032328896351
             stat err =       0.000545460497
             autocorr =       1.319967867649
   target nu stat err =       0.000545460497
   target dn stat err =       0.003465416483
      target stat err =       0.002962629599
              std dev =       0.671423630881
             le_variance =       0.450809692106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744614722438        initial  <--
     2.4414e+45     2.4414e+46             0.0000e+00        -0.744614722438
     9.7656e+45     9.7656e+46             0.0000e+00        -0.744614722438
     3.9063e+46     3.9063e+47             0.0000e+00        -0.744614722438

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 64.2324
  </log>
  <optVariables href="FORM2.s059.opt.xml">
 uu_0                 2.838404e-01 1 1  ON 0
 uu_1                 1.229783e-01 1 1  ON 1
 uu_2                 2.240682e-02 1 1  ON 2
 uu_3                -3.875457e-02 1 1  ON 3
 uu_4                -7.679882e-02 1 1  ON 4
 uu_5                -1.029633e-01 1 1  ON 5
 uu_6                -1.217123e-01 1 1  ON 6
 uu_7                -1.319064e-01 1 1  ON 7
 uu_8                -1.317422e-01 1 1  ON 8
 uu_9                -1.063265e-01 1 1  ON 9
 ud_0                 3.457250e-01 1 1  ON 10
 ud_1                 1.052482e-01 1 1  ON 11
 ud_2                -1.430449e-02 1 1  ON 12
 ud_3                -7.732870e-02 1 1  ON 13
 ud_4                -1.129687e-01 1 1  ON 14
 ud_5                -1.341891e-01 1 1  ON 15
 ud_6                -1.459524e-01 1 1  ON 16
 ud_7                -1.467459e-01 1 1  ON 17
 ud_8                -1.353398e-01 1 1  ON 18
 ud_9                -9.980083e-02 1 1  ON 19
 eC_0                -5.035171e-01 1 1  ON 20
 eC_1                -3.822330e-01 1 1  ON 21
 eC_2                -1.704219e-01 1 1  ON 22
 eC_3                -4.727996e-02 1 1  ON 23
 eC_4                 8.717432e-04 1 1  ON 24
 eC_5                 1.115951e-01 1 1  ON 25
 eC_6                 2.466777e-01 1 1  ON 26
 eC_7                 3.628932e-01 1 1  ON 27
 eC_8                 2.925542e-01 1 1  ON 28
 eC_9                 8.341330e-02 1 1  ON 29
 eO_0                -1.035101e+00 1 1  ON 30
 eO_1                -7.309131e-01 1 1  ON 31
 eO_2                -3.263487e-01 1 1  ON 32
 eO_3                -2.647238e-02 1 1  ON 33
 eO_4                 1.666346e-01 1 1  ON 34
 eO_5                 3.246363e-01 1 1  ON 35
 eO_6                 3.821800e-01 1 1  ON 36
 eO_7                 4.017125e-01 1 1  ON 37
 eO_8                 3.880063e-01 1 1  ON 38
 eO_9                 3.146116e-01 1 1  ON 39
eH1_0                -2.165016e-01 1 1  ON 40
eH1_1                -1.156747e-01 1 1  ON 41
eH1_2                -7.306073e-02 1 1  ON 42
eH1_3                -5.233900e-02 1 1  ON 43
eH1_4                 1.450140e-02 1 1  ON 44
eH1_5                 6.611621e-02 1 1  ON 45
eH1_6                 9.412026e-02 1 1  ON 46
eH1_7                 5.342467e-02 1 1  ON 47
eH1_8                 8.008752e-03 1 1  ON 48
eH1_9                 4.262252e-02 1 1  ON 49
eH2_0                -2.155647e-01 1 1  ON 50
eH2_1                -1.132831e-01 1 1  ON 51
eH2_2                -7.209152e-02 1 1  ON 52
eH2_3                -5.230176e-02 1 1  ON 53
eH2_4                 1.377596e-02 1 1  ON 54
eH2_5                 6.585188e-02 1 1  ON 55
eH2_6                 9.573237e-02 1 1  ON 56
eH2_7                 6.229798e-02 1 1  ON 57
eH2_8                 2.577629e-02 1 1  ON 58
eH2_9                 5.371124e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2364e+02 secs
  Total Execution time = 7.4204e+03 secs

=========================================================
  A new xml input file : FORM2.s059.cont.xml
